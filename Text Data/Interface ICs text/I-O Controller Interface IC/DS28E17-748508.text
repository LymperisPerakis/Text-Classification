DS28E17                                                                             1-Wire-to-I2C Master Bridge
General Description                                                   Benefits and Features
The DS28E17 is a 1-Wire slave to I2C master bridge                    ●● Converts 1-Wire Communication Protocol to I2C
device that interfaces directly to I2C slaves at standard                 Master I/O
(100kHz max) or fast (400kHz max). Data transfers seri-                   • Operates I2C Slave Peripherals over the Single-
ally by means of the 1-Wire® protocol, which requires only                  Contact, 1-Wire Interface
a single data lead and a ground return. Every DS28E17                 ●● Extend I2C Communication Distance with 1-Wire Protocol
is guaranteed to have a unique 64-bit ROM registration                    • 100 Meters (typ) in Standard Speed for a
number that serves as a node address in the 1-Wire net-                     Properly Configured Network
work. Multiple DS28E17 devices can coexist with other
devices in the 1-Wire network and be accessed individu-               ●● Flexible 1-Wire Slave and I2C Master Operational Modes
ally without affecting other devices. The DS28E17 allows                  • Supports 15kbps and 77kbps 1-Wire Protocol with
using complex I2C devices such as display controllers,                      Packetized I2C Data Payloads
ADCs, DACs, I2C sensors, etc. in a 1-Wire environment.                    • Factory-Programmed, Unique 64-Bit 1-Wire ROM
Each self-timed DS28E17 provides 1-Wire access for a                        ID Provides Unalterable Serial Number to End
single I2C interface.                                                       Equipment
                                                                          • Standard 100kHz and 400kHz Communication
Applications                                                                Rates for I2C
                                                                          • I2C Clock Stretching Automatically Supported
●●  Accessory Identification and Control
●●  I2C Sensors                                                       ●● Low Power Consumption
●●  Display Controllers                                                   • 0.3µA (typ) in Sleep Mode
●●  ADCs/DACs                                                             • 2.6mA (typ) when Operational
                                                                          • Separate Pins for Sleep and Wakeup Flexibility
                                                                          • Remote Power Controlled by an Awake Pin
Ordering Information appears at end of data sheet.                        • Sleep Mode Enabled by Sleep Pin or a 1-Wire
                                                                            Device Command
                                                                      ●● Easy to Integrate
                                                                          • 3.3V(nom) Supply, Small 4mm x 4mm x 0.75mm
                                                                            TQFN Package, -40°C to +85°C Operation
                                                                          • Evaluation HW and SW Available
Typical Operating Circuit
                               VDD                                VDD
                                                                                                   VDD
                                                                 VDD                               VDD
                                            RPUP           RESET        SCL                 SCL
                                                                        SDA                 SDA
                                    GPIO                   IO
                                                                     AWAKE                  SLP_N
                                µC                            DS28E17                           I2C SLAVE
                                                           WAKEUP BUSY
                                                           SLEEP         XD
                                                           ED         REG18
                                                                 GND                               GND
1-Wire is a registered trademark of Maxim Integrated Products, Inc.
19-7681; Rev 1; 12/15


DS28E17                                                                                                                        1-Wire-to-I2C Master Bridge
Absolute Maximum Ratings
Voltage Range on VDD with Respect to GND.......-0.3V to +3.6V                                         Operating Temperature Range........................... -40°C to +85°C
Voltage Range on Any Lead with                                                                        Storage Temperature Range............................. -65°C to +150°C
    Respect to GND ......................................-0.3V to VDD + 0.5V                          Lead Temperature (soldering, 10s).................................. +300°C
Continuous Output Current for Any Single I/O Pin ........... 32mA                                     Lead Temperature (reflow)...............................................+260°C
Continuous Output Current for All I/O Pins Combined ......32mA
Stresses beyond those listed under “Absolute Maximum Ratings” may cause permanent damage to the device. These are stress ratings only, and functional operation of the device at these
or any other conditions beyond those indicated in the operational sections of the specifications is not implied. Exposure to absolute maximum rating conditions for extended periods may affect
device reliability.
Package Thermal Characteristics (Note 1)
TQFN
    Junction-to-Ambient Thermal Resistance (θJA)...........40°C/W
    Junction-to-Case Thermal Resistance (θJC)..................6°C/W
Note 1: Package thermal resistances were obtained using the method described in JEDEC specification JESD51-7, using a four-layer
             board. For detailed information on package thermal considerations, refer to www.maximintegrated.com/thermal-tutorial.
Electrical Characteristics
(TA = -40°C to +85°C, VDD = VPUP, unless otherwise noted.) (Note 2)
            PARAMETER                        SYMBOL                                   CONDITIONS                                      MIN          TYP            MAX             UNITS
 Supply Voltage                                   VDD            (Note 3)                                                            2.45                           3.6              V
 1.8V Internal Regulator                      VREG18                                                                                 1.62          1.72            1.98              V
 Supply Current                                    IDD                                                                                              2.6             4.5             mA
                                                                 TA = 25°C                                                                          0.3              3
 Sleep Mode Current                               ISLP           TA = 0 to +75°C                                                                     1              12              µA
                                                                 TA = -40 to +85°C                                                                   2              16
 Sleep Mode Resume                             tSLPON                                                                                                2                              µs
 IO PIN: GENERAL
 1-Wire Pullup Resistance                        RPUP            (Note 3, 4)                                                          300                         2200               W
 Input Capacitance                                 CIO           (Notes 4)                                                                                          15              pF
 Input Hysteresis                               VIHYS            (Notes 5)                                                                         300                              mV
 Input Leakage Current                              IL                                                                               -100                         +100              nA
                                                                                                                                                                  0.3 x
 Input Low Voltage                                 VIL           (Notes 3, 6, 7)                                                                                                     V
                                                                                                                                                                   VDD
                                                                                                                                     0.7 x
 Input Low Voltage                                 VIH           (Notes 3, 8)                                                                                                        V
                                                                                                                                     VDD
                                                                 VDD = 3.6V, IOL = 11mA                                                             0.4             0.5              V
 Output Low Voltage                                VOL
                                                                 VDD = 2.45V, IOL = 8mA                                                             0.4             0.5              V
 Recovery Time                                                   Standard speed, RPUP = 2200Ω                                           5
                                                  tREC                                                                                                                              µs
 (Notes 3, 9)                                                    Overdrive speed, RPUP = 2200Ω                                          8
 Time Slot Duration                                              Standard speed                                                        65
                                                 tSLOT                                                                                                                              µs
 (Notes 3, 10)                                                   Overdrive speed                                                       13
www.maximintegrated.com                                                                                                                                           Maxim Integrated │ 2


DS28E17                                                                      1-Wire-to-I2C Master Bridge
Electrical Characteristics (continued)
(TA = -40°C to +85°C, VDD = VPUP, unless otherwise noted.) (Note 2)
        PARAMETER             SYMBOL                    CONDITIONS               MIN   TYP  MAX        UNITS
 IO PIN: 1-Wire RESET, PRESENSE-DETECT CYCLE
 Reset Low Time                           Standard speed                         480         640
                               tRSTL                                                                     µs
 (Note 3)                                 Overdrive speed                         48          80
                                          Standard speed                          15          60
 Presence Detect High Time      tPDH                                                                     µs
                                          Overdrive speed                          2           6
                                          Standard speed                          60         240
 Presence Detect Low Time        tPDL                                                                    µs
                                          Overdrive speed                          8          24
 Presence-Detect Sample                   Standard speed                          60          75
                                tMSP                                                                     µs
 Time (Notes 3, 11)                       Overdrive speed                          6          10
 IO PIN: 1-Wire WRITE
 Write-Zero Low Time                      Standard speed                          60         120
                                tW0L                                                                     µs
 (Notes 3, 12)                            Overdrive speed                          5          16
 Write-One Low Time                       Standard speed                           1          15
                                tW1L                                                                     µs
 (Notes 3, 12)                            Overdrive speed                        0.7           2
 IO PIN: 1-Wire READ
 Read Low Time                            Standard speed                           5        15 - d
                                  tRL                                                                    µs
 (Notes 3, 13)                            Overdrive speed                        0.7         2-d
 Read Sample Time                         Standard speed                       tRL + d        15
                                tMSR                                                                     µs
 (Notes 3, 13)                            Overdrive speed                      tRL + d         2
 ROM
 Data Retention                   tDR     TA = 25°C                              100                   Years
 ED, BUSY, XD, AWAKE OUTPUT PINS
                                          VDD = 3.6V, IOL = 11mA                       0.4   0.5          V
 Output Low Voltage              VOL
                                          VDD = 2.45V, IOL = 8mA                       0.4   0.5          V
                                                                                VDD -
 Output High Voltage            VOH       IOH = -2mA                                                      V
                                                                                0.5V
 WAKEUP, SLEEP, RESET INPUT PINS
                                                                                            0.3 x
 Input Low Voltage               VIL1     (Notes 3, 6)                                                    V
                                                                                            VDD
                                                                                0.7 x
 Input Low Voltage              VIH1      (Notes 3, 8)                                                    V
                                                                                VDD
 Input Capacitance              CIO1      (Notes 4)                                           15         pF
 Input Leakage Current             IL1    Not including RESET                   -100        +100         nA
 Input Pullup Resistance         RPU      RESET only, VDD = 3.0V, VOL = 0.4V      16    28    39         kW
 Wakeup                         tWAK                                                   300               µs
www.maximintegrated.com                                                                     Maxim Integrated │ 3


DS28E17                                                                             1-Wire-to-I2C Master Bridge
Electrical Characteristics (continued)
(TA = -40°C to +85°C, VDD = VPUP, unless otherwise noted.) (Note 2)
         PARAMETER            SYMBOL                     CONDITIONS                    MIN   TYP    MAX        UNITS
 I2C  GENERAL (i.e., SCL, SDA PINS)
                                          Supply voltages that mismatch I2C bus
                                                                                                    0.3 x
 Input Low Voltage             VIL_I2C    levels must relate input levels to the RP    -0.5                      V
                                                                                                     VDD
                                          pullup voltage
                                          Supply voltages that mismatch I2C bus
                                                                                      0.7 x         VDD +
 Input High Voltage            VIH_I2C    levels must relate input levels to the RP                              V
                                                                                       VDD            0.5
                                          pullup voltage
 Output Logic-Low (Open
                               VOL_I2C    VDD > 2V, 3mA sink current                     0        0.4            V
 Drain or Open Collector)
 Pulse Width of Spike
 Filtering That Must Be        tSP_I2C    Applies to fast mode only                      0         50            ns
 Supressed by Input Filter
 Input Current on I/O           IIN_I2C   Input voltage from 0.1 x VDD to 0.9 x VDD    -10        +10            µA
 I/O Capacitance               CIO_I2C                                                             10            pF
 I2C BUS CONTROLLER TIMING (FIGURE 7)
 I2C Bus Operating                        Standard mode                                  0        100
                                  fI2C                                                                          kHz
 Frequency                                Fast mode                                               400
 Hold Time After (Repeated)               Standard mode                                 4.0
                               tHD:STA                                                                           µs
 START                                    Fast mode                                     0.6
                                          Standard mode                                 4.7
 Clock Low Period             tLOW_I2C                                                                           µs
                                          Fast mode                                     1.3
                                          Standard mode                                 4.0
 Clock High Period            tHIGH_I2C                                                                          µs
                                          Fast mode                                     0.6
 Setup Time for Repeated                  Standard mode                                 4.7
                               tSU:STA                                                                           µs
 START                                    Fast mode                                     0.6
                                          Standard mode                                  0           3.45
 Hold Time for Data            tHD:DAT                                                                           µs
                                          Fast mode                                      0            0.9
                                          Standard mode                                250
 Setup Time for Data           tSU:DAT                                                                           ns
                                          Fast mode                                    100
                                          Standard mode                                              300
 SDA/SCL Fall Time               tF_I2C                                                20 +                      ns
                                          Fast mode                                                  300
                                                                                      0.1CB
www.maximintegrated.com                                                                             Maxim Integrated │ 4


DS28E17                                                                                     1-Wire-to-I2C Master Bridge
Electrical Characteristics (continued)
(TA = -40°C to +85°C, VDD = VPUP, unless otherwise noted.) (Note 2)
        PARAMETER                SYMBOL                      CONDITIONS                         MIN        TYP       MAX        UNITS
                                              Standard mode                                                          1000
 SDA/SCL Rise Time                 tR_I2C                                                       20 +                               ns
                                              Fast mode                                                               300
                                                                                               0.1CB
                                              Standard mode                                      4.0
 Setup Time for STOP              tSU:STO                                                                                          µs
                                              Fast mode                                          0.6
 Bus Free Time Between                        Standard mode                                      4.7
                                    tBUF                                                                                           µs
 STOP and START                               Fast mode                                          1.3
 Capacitive Load for Each
                                     CB                                                                            400             pF
 Bus Line
 Noise Margin at the Low
 Level for Each Connected                                                                       0.1 x
                                  VnL_I2C                                                                                          V
 Device (Including                                                                              VDD
 Hysteresis)
 Noise Margin at the High
 Level for Each Connected                                                                       0.2 x
                                  VnH_I2C                                                                                          V
 Device (Including                                                                              VDD
 Hysteresis)
Note 2: Limits are 100% production tested at TA = +25°C and TA = +70°C. Limits over the operating temperature range and relevant
          supply voltage range are guaranteed by design and characterization. Typical values are at TA = +25°C.
Note 3: System requirement.
Note 4: Maximum allowable pullup resistance is a function of the number of 1-Wire devices in the system and 1-Wire recovery
          times. The specified value here applies to systems with only one device and with the minimum 1-Wire recovery times. The
          pullup resistance power should be applied at the same time or after VDD to minimize back charging.
Note 5: Guaranteed by design and/or characterization only. Not production tested.
Note 6: Voltage below which, during a falling edge on IO, a logic-zero is detected.
Note 7: The voltage on IO must be less than or equal to VILMAX at all times the master is driving IO to a logic-zero level.
Note 8: Voltage above which, during a rising edge on IO, a logic-one is detected.
Note 9: Applies to a single device attached to a 1-Wire line.
Note 10: Defines maximum possible bit rate. Equal to 1/(tW0LMIN + tRECMIN).
Note 11: Interval after tRSTL during which a bus master can read a logic 0 on IO if there is a DS28E17 present. The power-up pres-
          ence detect pulse could be outside this interval but will be complete within 2ms after power-up.
Note 12: ε in Figure 5 represents the time required for the pullup circuitry to pull the voltage on IO up from VIL to VIH. The actual
          maximum duration for the master to pull the line low is tW1LMAX + tF - ε and tW0LMAX + tF - ε, respectively.
Note 13: δ in Figure 6 represents the time required for the pullup circuitry to pull the voltage on IO up from VIL to the input-high
          threshold of the bus master. The actual maximum duration for the master to pull the line low is tRLMAX + tF.
www.maximintegrated.com                                                                                              Maxim Integrated │ 5


DS28E17                                                                                         1-Wire-to-I2C Master Bridge
Pin Configurations
                                                       SDA   SCL    XD      BUSY
                                                        16   15     14      13
                                       RESET       1   +                           12   AWAKE
                                           IO      2                               11   N.C.
                                                   3
                                                             DS28E17               10   N.C.
                                      WAKEUP
                                        SLEEP      4                   EP*         9    N.C.
                                                        5    6      7       8
                                                        ED    VDD
                                                                    REG18
                                                                            GND
                                                *EP = EXPOSED PAD.
Pin Description
    PIN         NAME      TYPE                                                          FUNCTION
                                   Active-Low Reset. This bidirectional pin recognizes external active-low reset inputs and
                                   employs an internal pullup resistor to allow for a combination of wired-OR external reset
                                   sources. An RC is not required for power-up, as this function is provided internally. This
     1         RESET      Input
                                   pin also acts as an output when the source of the reset is internal to the device (e.g.,
                                   power-up, power-fail, etc.). In this case, the pin is low while the DS28E17 is in a reset
                                   state, and returns high as the device exits this state.
                          Open     1-Wire Bus Interface. This is an open-drain pin that requires an external pullup resistor
     2           IO
                          drain    (RPUP).
                                   Wakeup. This pin, on a single rising edge, wakes up the device from sleep mode. The
     3        WAKEUP      Input
                                   pin only looks for a rising edge during sleep mode.
     4         SLEEP      Input    Sleep. This pin, on a single falling edge, sets the sleep mode.
                                   Error Detected. This push-pull pin drives low when an error is detected. Errors include
     5           ED       Output   invalid command, bad CRC16, and when an I2C command is not acknowledged (i.e.,
                                   NACK’d). The pin is reset on a 1-Wire reset command.
     6           VDD      Power    Digital Supply Voltage. This power pin requires power from 2.45V to 3.6V.
                                   Regulator Capacitor. This pin is nominally 1.72V and requires a 1uF cap. Only minimal
     7         REG18        —
                                   loads of less than 200uA should use this pin.
     8          GND         —      Digital Ground
  9, 10, 11      N.C.       —      No Connection
                                   Awake. This push-pull pin drives high when DS28E17 is awake and drives low when
     12        AWAKE      Output   asleep. Can be used to awaken or put to sleep other devices (e.g. processor, sensor,
                                   etc) on the peripheral based on the state of DS28E17 (i.e. Sleep mode or awake).
                                   Busy. This push-pull pin drives low after receiving the packet’s CRC16 and remains low
     13         BUSY      Output   until the entire I2C transaction has completed. All 1-Wire communication is ignored when
                                   this signal is low.
                                   Expecting Data. This push-pull pin drives low after receiving a Device command and
                                   remains low until the entire transmitted 1-Wire packet is received. This pin returns high
     14          XD       Output
                                   after the CRC16. Note: Pin does not toggle for Device commands that are not
                                   1-Wire packets.
www.maximintegrated.com                                                                                       Maxim Integrated │ 6


DS28E17                                                                                     1-Wire-to-I2C Master Bridge
Pin Description (continued)
     PIN          NAME             TYPE                                                 FUNCTION
                                             I2C Serial-Clock. Must be connected to the I2C bus supply voltage through a pullup
      15           SCL             Output
                                             resistor.
                                             I2C Serial-DataInput/Output. Must be connected to the I2C bus supply voltage through a
      16           SDA               IO
                                             pullup resistor.
                                             Exposed Pad. Solder or thermally connect the Exposed Pad to GND or an electrically
      —             EP               —
                                             unconnected pad to achieve specified thermal characteristics.
Detailed Description                                                       Overview
The DS28E17 combines a 1-Wire front end, an I2C bus                        Figure 1 shows the hierarchical structure of the 1-Wire
controller, and functionality to bridge these two interfaces               protocol. The bus master must first provide one of the
for data communication in a single chip. Data is trans-                    seven ROM function commands: Read ROM, Match
ferred serially through the 1-Wire protocol, which requires                ROM, Search ROM, Skip ROM, Resume, Overdrive-Skip
only a single data lead and a ground return for signaling.                 ROM, or Overdrive-Match ROM. Upon completion of an
The DS28E17 has a transparent buffer to write and read                     Overdrive-Skip ROM or Overdrive-Match ROM command
to the I2C bus controller. I2C data is written and read back               byte executed at standard speed, the device enters over-
by sending 1-Wire packets. As well, a ROM ID acces-                        drive mode where all subsequent communication occurs
sible from 1-Wire command protocol guarantees unique                       at a higher speed. All data is read and written least
identification and is also used to address the device in                   significant bit first.
a multidrop 1-Wire network environment, where multiple
devices reside on a common 1-Wire bus and operate
independently of each other.
                  DS28E17 COMMAND LEVEL:               AVAILABLE COMMANDS                  DATA FIELD AFFECTED:
                                                       READ ROM [33h]                       64-BIT REG. #, RC-FLAG
                                                       MATCH ROM [55h]                      64-BIT REG. #, RC-FLAG
                                                       SEARCH ROM [F0h]                     64-BIT REG. #, RC-FLAG
                       1-Wire ROM FUNCTION             SKIP ROM [CCh]                       RC-FLAG
                            COMMANDS                   RESUME [A5h]                         RC-FLAG
                                                       OVERDRIVE SKIP [3Ch]                 RC-FLAG, OD-FLAG
                                                       OVERDRIVE MATCH [69h]                64-BIT REG. #, RC-FLAG, OD-FLAG
                                                       WRITE DATA WITH STOP [4Bh]           S, AD_0, xxh, P
                                                       WRITE DATA NO STOP [5Ah]             S, AD_0, xxh
                                                       WRITE DATA ONLY [69h]                xxh,
                                                       WRITE DATA ONLY WITH STOP [78h]      xxh, P
                     DS28E17-SPECIFIC DEVICE           READ DATA WITH STOP [87h]            S, AD_1, [xxh], P
                            COMMANDS                   WRITE, READ DATA WITH STOP [2Dh]     S, AD_0, xxh, P, S, AD_1, [xxh], P
                                                       WRITE CONFIGURATION [D2h]            WRITE SPD BITS
                                                       READ CONFIGURATION [E1h]             READ SPD BITS
                                                       ENABLE SLEEP MODE [1Eh]              SLEEP ON, WAKEUP LOOKS FOR EDGE
                                                       READ DEVICE REVISION [C3h]           READ MAJOR AND MINOR REVISION
Figure 1. Hierarchical Structure for 1-Wire Protocol
www.maximintegrated.com                                                                                                        Maxim Integrated │ 7


DS28E17                                                                                    1-Wire-to-I2C Master Bridge
64-Bit ROM ID                                                            1-Wire Bus System
Each DS28E17 contains a unique ROM ID that is 64 bits                    The 1-Wire bus is a system that has a single bus master
long. The first 8 bits are a 1-Wire family code. The next                and one or more slaves. In all instances the DS28E17 is
48 bits are a unique serial number. The last 8 bits are a                a slave device. The bus master is typically a microcon-
cyclic redundancy check (CRC) of the first 56 bits. See                  troller. The discussion of this bus system is broken down
Figure 2 for details. The 1-Wire CRC is generated using                  into three topics: hardware configuration, transaction
a polynomial generator consisting of a shift register and                sequence, and 1-Wire signaling (signal types and timing).
XOR gates as shown in Figure 3. The polynomial is X8 +                   The 1-Wire protocol defines bus transactions in terms of
X5 + X4 + 1. Additional information about the 1-Wire CRC                 the bus state during specific time slots, which are initiated
is available in Application Note 27: Understanding and                   on the falling edge of sync pulses from the bus master.
Using Cyclic Redundancy Checks with Maxim iButton®
Products.                                                                Hardware Configuration
The shift register bits are initialized to 0. Then, starting             The 1-Wire bus has only a single line by definition; it is
with the least significant bit of the family code, one bit at            important that each device on the bus be able to drive
a time is shifted in. After the 8th bit of the family code has           it at the appropriate time. To facilitate this, each device
been entered, the serial number is entered. After the last               attached to the 1-Wire bus must have open-drain or
bit of the serial number has been entered, the shift reg-                three-state outputs. The 1-Wire port (i.e., IO pin) of the
ister contains the CRC value. Shifting in the 8 bits of the              DS28E17 is open drain or an input to read data.
CRC returns the shift register to all 0s.
             MSb                                                                                                            LSb
                   8-BIT                                                                                  8-BIT FAMILY CODE
                                                       48-BIT SERIAL NUMBER
                CRC CODE                                                                                         (19h)
             MSb         LSb MSb                                                                   LSb MSb                  LSb
Figure 2. 64-Bit ROM ID
                                                     POLYNOMIAL = X8 + X5 + X4 + 1
              1ST         2ND        3RD        4TH                      5TH                   6TH        7TH           8TH
             STAGE       STAGE      STAGE     STAGE                     STAGE                STAGE       STAGE         STAGE
        X0            X1         X2        X3                       X4                    X5         X6           X7          X8
                                                                                                                  INPUT DATA
Figure 3. 1-Wire CRC Generator
iButton is a registered trademark of Maxim Integrated Products, Inc.
www.maximintegrated.com                                                                                               Maxim Integrated │ 8


DS28E17                                                                           1-Wire-to-I2C Master Bridge
A multidrop bus consists of a 1-Wire bus with multiple          number, and 8-bit CRC. This command can only be used
slaves attached. The DS28E17 supports both a standard           if there is a single slave on the bus. If more than one
and overdrive communication speed of 15kbps (max) and           slave is present on the bus, a data collision occurs when
77kbps (max), respectively. The value of the pullup resis-      all slaves try to transmit at the same time (open drain
tor primarily depends on the network size and load condi-       produces a wired-AND result). The resultant family code
tions. The DS28E17 requires a pullup resistor of 2.2kΩ          and 48-bit serial number result in a mismatch of the CRC.
(max) at any speed.
                                                                Match ROM [55h]
The idle state for the 1-Wire bus is high. If for any reason
                                                                The Match ROM command, followed by a 64-bit ROM
a transaction needs to be suspended, the bus must be left
                                                                sequence, allows the bus master to address a specific
in the idle state if the transaction is to resume. If this does
                                                                DS28E17 on a multidrop bus. Only the DS28E17 that
not occur and the bus is left low, one or more devices on
                                                                exactly matches the 64-bit ROM sequence responds to
the bus could be reset.
                                                                the subsequent Device command. All other slaves wait for
Transaction Sequence                                            a reset pulse. This command can be used with a single
The protocol for accessing the DS28E17 through the              device or multiple devices on the bus.
1-Wire port is as follows:                                      Search ROM [F0h]
●●    Initialization                                            When a system is initially brought up, the bus master
●●    ROM function command                                      might not know the number of devices on the 1-Wire bus
                                                                or their ROM ID numbers. By taking advantage of the
●●    Device command
                                                                wired-AND property of the bus, the master can use a pro-
●●    Transaction/data                                          cess of elimination to identify the ID of all slave devices.
Initialization                                                  For each bit in the ID number, starting with the least sig-
                                                                nificant bit, the bus master issues a triplet of time slots.
All transactions on the 1-Wire bus begin with an initializa-
                                                                On the first slot, each slave device participating in the
tion sequence. The initialization sequence consists of a
                                                                search outputs the true value of its ID number bit. On the
reset pulse transmitted by the bus master followed by
                                                                second slot, each slave device participating in the search
presence pulse(s) transmitted by the slave(s). The pres-
                                                                outputs the complemented value of its ID number bit. On
ence pulse lets the bus master know that the DS28E17 is
                                                                the third slot, the master writes the true value of the bit
on the bus and is ready to operate.
                                                                to be selected. All slave devices that do not match the
1-Wire ROM Function Commands                                    bit written by the master stop participating in the search.
Once the bus master has detected a presence, it can             If both of the read bits are zero, the master knows that
issue one of the seven ROM function commands that the           slave devices exist with both states of the bit. By choos-
DS28E17 supports. All ROM function commands are 8               ing which state to write, the bus master branches in the
bits long. A list of these commands follows. See the flow-      search tree. After one complete pass, the bus master
chart in Figure 4a and Figure 4b.                               knows the ROM ID number of a single device. Additional
                                                                passes identify the ID numbers of the remaining devices.
Read ROM [33h]                                                  Refer to Application Note 187: 1-Wire Search Algorithm
The Read ROM command allows the bus master to read              for a detailed discussion, including an example.
the DS28E17’s 8-bit family code, unique 48-bit serial
www.maximintegrated.com                                                                                 Maxim Integrated │ 9


DS28E17                                                                                              1-Wire-to-I2C Master Bridge
                                                               BUS MASTER Tx
                                                                RESET PULSE
                                                                                                                  FROM FIGURE 4B
                             FROM DEVICE COMMANDS
                                                                     OD             N
                                                               RESET PULSE?                 OD = 0
                                                                    Y
                BUS MASTER Tx ROM                                DS28E17 Tx
                FUNCTION COMMAND                              PRESENCE PULSE
                                                                                                                    TO FIGURE 4B
                        33h                        55h                                 F0h                 CCh
                    READ ROM         N        MATCH ROM               N           SEARCH ROM       N     SKIP ROM     N
                   COMMAND?                    COMMAND?                            COMMAND?             COMMAND?
                           Y                          Y                                   Y                    Y
                      RC = 0                     RC = 0                              RC = 0               RC = 0
                                                                                DS28E17 Tx BIT 0
                   DS28E17 Tx                                                   DS28E17 Tx BIT 0
                  FAMILY CODE               MASTER Tx BIT 0
                                                                                MASTER Tx BIT 0
                     (1 BYTE)
                                                  BIT 0           N       N           BIT 0
                                                MATCH?                              MATCH?
                                                            Y                                   Y
                                                                                DS28E17 Tx BIT 1
                   DS28E17 Tx
                 SERIAL NUMBER               MASTER Tx BIT 1                    DS28E17 Tx BIT 1
                    (6 BYTES)                                                    MASTER Tx Bit 1
                                                  BIT 1           N       N           BIT 1
                                                MATCH?                              MATCH?
                                                           Y                                    Y
                                                                                DS28E17 Tx BIT 63
                   DS28E17 Tx
                                            MASTER Tx BIT 63                    DS28E17 Tx BIT 63
                    CRC BYTE
                                                                                MASTER Tx BIT 63
                                                                  N       N
                                                 BIT 63                              BIT 63
                                                MATCH?                              MATCH?
                                                           Y                                    Y
                                                 RC = 1                              RC = 1
                                                                                                                     TO FIGURE 4B
                                                                                                                  FROM FIGURE 4B
                                                                      TO DEVICE COMMANDS
Figure 4a. ROM Functions Flow Chart
www.maximintegrated.com                                                                                                    Maxim Integrated │ 10


DS28E17                                                                                        1-Wire-to-I2C Master Bridge
              TO FIGURE 4A
              FROM FIGURE 4A            A5H           N                      3CH        N             69H          N
                                     RESUME                              OVERDRIVE             OVERDRIVE MATCH
                                   COMMAND?                              SKIP ROM?                   ROM?
                                           Y                                     Y                        Y
                                                                        RC = 0 ; OD = 1          RC = 0 ; OD = 1
                                                                                                MASTER Tx BIT 0
                                                                                                                              1)
                                                                                         Y                           N
                                                                          MASTER                      BIT 0
                                                                                                                       OD = 0
                                                                         Tx RESET ?                 MATCH?
                                                                                                           Y
                                                                                   N
                                                                                                MASTER Tx BIT 1
                                                                                                                              1)
                                                      N                                               BIT 1        N
                                        RC = 1 ?                                                                       OD = 0
                                                                                                    MATCH?
                                        Y                                                                  Y
                                                            MASTER        Y
                                                                                                MASTER Tx BIT 63
                                                           Tx RESET ?
                                                                 N
                                                                                                                              1)
                                                                                                     BIT 63        N
                                                                                                    MATCH?             OD = 0
                                                                                                                 Y
                                                                                                     RC = 1
              FROM FIGURE 4A
               TO FIGURE 4A
           1) THE OD FLAG REMAINS AT 1 IF THE DEVICE WAS ALREADY AT OVERDRIVE SPEED BEFORE THE
           OVERDRIVE MATCH ROM COMMAND WAS ISSUED.
Figure 4b. ROM Functions Flow Chart (continued)
www.maximintegrated.com                                                                                                Maxim Integrated │ 11


DS28E17                                                                      1-Wire-to-I2C Master Bridge
Skip ROM [CCh]                                              device, a reset pulse at overdrive speed must be issued
This command can save time in a single-drop bus sys-        followed by a Match ROM or Search ROM command
tem by allowing the bus master to access the Device         sequence. This speeds up the time for the search pro-
commands without providing the 64-bit ROM ID. If more       cess. If more than one slave supporting overdrive is pres-
than one slave is present on the bus and, for example,      ent on the bus and the Overdrive-Skip ROM command
a read command is issued following the Skip ROM com-        is followed by a read command, data collision occurs on
mand, data collision occurs on the bus as multiple slaves   the bus as multiple slaves transmit simultaneously (open-
transmit simultaneously (open-drain pulldowns produce a     drain pulldowns produce a wired-AND result).
wired-AND result).                                          Overdrive-Match ROM [69h]
Resume [A5h]                                                The Overdrive-Match ROM command followed by a
To maximize the data throughput in a multidrop environ-     64-bit ROM sequence transmitted at overdrive speed
ment, the Resume command is available. This command         allows the bus master to address a specific DS28E17 on
checks the status of the RC bit and, if it is set, directly a multidrop bus and to simultaneously set it in overdrive
transfers control to the Device commands, similar to a      mode. Only the DS28E17 that exactly matches the 64-bit
Skip ROM command. The only way to set the RC bit is         ROM sequence responds to the subsequent Device com-
through successfully executing the Match ROM, Search        mand. Slaves already in overdrive mode from a previ-
ROM, or Overdrive-Match ROM command. Once the RC            ous Overdrive-Skip ROM or successful Overdrive-Match
bit is set, the device can repeatedly be accessed through   ROM command remain in overdrive mode. All overdrive-
the Resume command. Accessing another device on the         capable slaves return to standard speed at the next reset
bus clears the RC bit, preventing two or more devices       pulse of minimum 480μs duration. The Overdrive-Match
from simultaneously responding to the Resume com-           ROM command can be used with a single device or mul-
mand.                                                       tiple devices on the bus.
Overdrive-Skip ROM [3Ch]                                    1-Wire Signaling
On a single-drop bus this command can save time by          The DS28E17 requires strict protocols to ensure data
allowing the bus master to access the Device commands       integrity. The protocol consists of four types of signaling
without providing the 64-bit ROM ID. Unlike the normal      on one line: reset sequence with reset pulse and presence
Skip ROM command, the Overdrive-Skip ROM command            pulse, write-zero, write-one, and read-data. Except for the
sets the DS28E17 into the overdrive mode (OD = 1). All      presence pulse, the bus master initiates all falling edges.
communication following this command must occur at          The DS28E17 can communicate at two different speeds:
overdrive speed until a reset pulse of minimum 480μs        standard speed and overdrive speed. If not explicitly set
duration resets all devices on the bus to standard speed    into the overdrive mode, the DS28E17 communicates at
(OD = 0).                                                   standard speed. While in overdrive mode, the fast timing
When issued on a multidrop bus, this command sets all       applies to all waveforms.
overdrive-supporting devices into overdrive mode. To        To get from idle to active, the voltage on the 1-Wire line
subsequently address a specific overdrive-supporting        needs to fall from above VIHMIN to below VILMAX. To get
www.maximintegrated.com                                                                            Maxim Integrated │ 12


DS28E17                                                                            1-Wire-to-I2C Master Bridge
from active to idle, the voltage needs to rise from below      The tRSTH window must be at least the sum of tPDH-
VILMAX to above VIHMIN. The time it takes for the voltage      MAX, tPDLMAX, and tRECMIN. Immediately after tRSTH is
to make this rise is seen in Figure 5 as ε, and its dura-      expired, the DS28E17 is ready for data communication. In
tion depends on the pullup resistor (RPUP) used and the        a mixed population network, tRSTH should be extended to
capacitance of the 1-Wire network attached. The voltage        minimum 480μs at standard speed and 48μs at overdrive
VILMAX is relevant for the DS28E17 when determining            speed to accommodate other 1-Wire devices.
a logical level, not triggering any events. For more infor-
mation on the capacitance of a 1-Wire network, refer to        Read/Write Time Slots
Application 6208: Extending I2C Communication Distance         Data communication with the DS28E17 takes place in
with the DS28E17.                                              time slots that carry a single bit each. Write time slots
                                                               transport data from bus master to slave. Read time slots
Figure 5 shows the initialization sequence required to
                                                               transfer data from slave to master. Figure 6 illustrates the
begin any communication with the DS28E17. A reset
                                                               definitions of the write and read time slots.
pulse followed by a presence pulse indicates that the
DS28E17 is ready to receive data, given the correct ROM        All communication begins with the master pulling the data
and Device command. If the bus master uses slew-rate           line low. As the voltage on the 1-Wire line falls below
control on the falling edge, it must pull down the line for    VIL, the DS28E17 starts its internal timing generator that
tRSTL + tF to compensate for the edge. A tRSTL duration        determines when the data line is sampled during a write
of 480μs or longer exits the overdrive mode, returning         time slot and how long data is valid during a read time
the device to standard speed. If the DS28E17 is in over-       slot.
drive mode and tRSTL is no longer than 80μs, the device
                                                               Master-to-Slave
remains in overdrive mode. If the device is in overdrive
mode and tRSTL is between 80μs and 480μs, the device           For a write-one time slot, the voltage on the data line
resets, but the communication speed is undetermined.           must have crossed the VIL threshold before the write-one
                                                               low time tW1LMAX is expired. For a write-zero time slot,
After the bus master has released the line it goes into        the voltage on the data line must stay below the VILMAX
receive mode. Now the 1-Wire bus is pulled to VPUP             until the write-zero low time tW0LMIN is expired. For the
through the pullup resistor or, in the case of a special       most reliable communication, the voltage on the data line
driver chip, through the active circuitry. When the thresh-    should not exceed VILMAX during the entire tW0L or tW1L
old VIH is crossed, the DS28E17 waits for tPDH and then        window. After the VIH threshold has been crossed, the
transmits a presence pulse by pulling the line low for tPDL.   DS28E17 needs a recovery time tREC before it is ready
To detect a presence pulse, the master must test the logi-     for the next time slot.
cal state of the 1-Wire line at tMSP.
                                   MASTER Tx "RESET PULSE"                  MASTER Rx "PRESENCE PULSE"
                                                             ε         tMSP
                     VPUP
               VIHMASTER
                  VIL(MAX)
                       0V
                                                     tRSTL                                     tREC
                               tF
                                                                                 tRSTH
                                      RESISTOR                  MASTER                              DS28E17
Figure 5. Initialization Procedure: Reset and Presence Pulse
www.maximintegrated.com                                                                                     Maxim Integrated │ 13


DS28E17                                                                   1-Wire-to-I2C Master Bridge
              WRITE-ONE TIME SLOT
                                       tW1L
                   VPUP
             VIHMASTER
                VIL(MAX)
                     0V
                              tF
                                              ε
                                                               tSLOT
                                        RESISTOR                   MASTER
              WRITE-ZERO TIME SLOT
                                                          tW0L
                   VPUP
             VIHMASTER
                VIL(MAX)
                     0V
                                                                           ε
                              tF                                                tREC
                                                               tSLOT
                                        RESISTOR                   MASTER
              READ-DATA TIME SLOT
                                            tMSR
                                   tRL
                   VPUP
             VIHMASTER
                                                   MASTER
                                                  SAMPLING
                                                   WINDOW
                VIL(MAX)
                     0V
                                                δ
                               tF                                            tREC
                                                               tSLOT
                                     RESISTOR                    MASTER              DS28E17
Figure 6. Read/Write Timing Diagrams
www.maximintegrated.com                                                                      Maxim Integrated │ 14


DS28E17                                                                                              1-Wire-to-I2C Master Bridge
Slave-to-Master                                                                  The device supports only the master protocols. In the
A read-data time slot begins like a write-one time slot. The                     master mode, the device has ownership of the I2C bus,
voltage on the data line must remain below VILMAX until                          drives the clock, and generates the START and STOP
the read low time tRL is expired. During the tRL window,                         signals per Figure 7. This allows it to send data to a slave
when responding with a 0, the DS28E17 starts pulling                             or receive data from a slave as required.
the data line low; its internal timing generator determines                      Clock stretching is automatically accepted when SCL is
when this pulldown ends and the voltage starts rising                            held low by an I2C slave. In other words, the DS28E17
again. When responding with a 1, the DS28E17 does not                            that is communicating with the I2C slave does not finish
hold the data line low at all, and the voltage starts rising                     the transmission of the current bit, but waits until the SCL
as soon as tRL is over.                                                          signal actually goes logic-high.
The sum of tRL + δ (rise time) on one side and the internal
timing generator of the DS28E17 on the other side define                         Device Commands
the master sampling window (tMSRMIN to tMSRMAX), in                              This section describes the 8-bit long Device commands.
which the master must perform a read from the data line.                         The Device commands are as follows:
For the most reliable communication, tRL should be as                            ●●   Write data with stop (4Bh)
short as permissible, and the master should read close
                                                                                 ●●   Write data no stop (5Ah)
to but no later than tMSRMAX. After reading from the data
line, the master must wait until tSLOT is expired. This                          ●●   Write data only (69h)
guarantees sufficient recovery time tREC for the DS28E17                         ●●   Write data only with stop (78h)
to get ready for the next time slot. Note that tREC speci-                       ●●   Read data with stop (87h)
fied herein applies only to a single DS28E17 attached to a
1-Wire line. For multidevice configurations, tREC must be                        ●●   Write, read data with stop (2Dh)
extended to accommodate the additional 1-Wire device                             ●●   Write configuration (D2h)
input capacitance. Alternatively, an interface that performs                     ●●   Read configuration (E1h)
active pullup during the 1-Wire recovery time such as the
                                                                                 ●●   Enable sleep mode (1Eh)
special 1-Wire line drivers can be used.
                                                                                 ●●   Read device revision (C3h)
I2C Bus Signaling                                                                Device commands 1 through 6 exercise the I2C interface
The I2C bus is a 2-wire, bidirectional bus using two bus                         for writing, reading and write/reading I2C data from/to the
lines—the serial data line (SDA) and the serial clock line                       1-Wire. Send these 1-Wire Device commands and formed
(SCL)—and a ground line. Both the SDA and SDL lines                              1-Wire packet, after first sending a 1-Wire ROM function
must be driven as open-collector/drain outputs. External                         command that addresses the device. Follow the Device
resistors are required to pull the lines to a logic-high state.                  command by several write data bytes (e.g., I2C Slave
                           S                                                             Sr                             P       S
             SDA
                                                                                                                           tBUF
                    tF_I2C                      tR_I2C         tSU:DAT                       tSU:STA
                             tLOW_I2C
             SCL
                               tHD:STA                                 tHIGH_I2C
                                           tHD:DAT                                                            tSU:STO
             NOTE: TIMING REFERENCED TO VIH_I2C(MIN) AND VIL_I2C(MAX).
Figure 7. I2C Bus Controller Timing Diagram
www.maximintegrated.com                                                                                                   Maxim Integrated │ 15


DS28E17                                                                         1-Wire-to-I2C Master Bridge
Address, Write Length, Write Data, CRC16, etc.) that form      Table 1. 1-Wire Color Legend
the write portion of the packet. Upon completion of the
                                                                1-Wire COLOR CODES
Device command and write data bytes, it is important for
the host to wait a predetermined delay or poll the BUSY         Host Writes
pin or continuously perform 1-Wire bit reads until the sig-     Host Reads
naling of all done by receiving a single 0b timeslot from       Host delay or BUSY pin polling or single 0b timeslot polling
the device. When using a delay or monitoring the BUSY
pin, a single-bit read timeslot is still required before read-
ing data bytes. The provided time allows the device to
                                                               Table 2. I2C Character Legend
complete execution of Device command. Lastly, the host                 LEGEND                    I2C EQUIVALENT
performs reading of the data bytes (e.g., Status, Write         S                     Start
Status, Read Data, etc.). The reading of the data bytes
                                                                Sr                    Repeated start
completes the formed packet (i.e., transaction/data) and
the device returns to the initialization sequence waiting for   AD, 0                 Write address
a 1-Wire reset and presence pulse per Figure 4a.                AD, 1                 Read address
Device specific settings are readable and configurable          xxh[#]                Write data
through Device commands 7 through 10. The Write                 [xxh][#]              Read data
Configuration and Read Configuration commands set the           P                     Stop
I2C speed. In addition to the sleep pin, the Enable Sleep
Mode command puts the device into sleep mode. While             ACK                   Acknowledged
in this mode, the device monitors the wakeup input pin for      NACK                  Not acknowledged
a rising edge. Lastly, the Read Device Revision command         (idle)                Bus not busy
provides reading of the revision of the device.
Device Commands to Exercise the                                #: Number of bytes.
I2C Interface
Follow the legend in Table 1 for 1-Wire and in Table 2 for     Table 3. I2C Data Direction Codes
I2C as to understand the signaling occurring.                                      I2C COLOR CODES
In general, the device commands that exercise the I2C           Master to slave
interface follow this format from the 1-Wire vantage point      Slave to master
per Table 4.
www.maximintegrated.com                                                                                  Maxim Integrated │ 16


DS28E17                                                                                       1-Wire-to-I2C Master Bridge
Table 4. General 1-Wire Sequence for the I2C Interface
      INITIALIZATION           ADDRESSING                        FORMED 1-Wire PACKET
    1-Wire       Presence      ROM Function                 Device
                                                                                Delay        Read Bytes
     Reset          Pulse         Command           Command, Data, etc.
Write Data with Stop
   Device Command         4Bh
     Typical Usage        This is used to address and write 1–255 bytes to an I2C slave in one transaction.
      I2C Features        Start, Address, Write Data, Stop
                          No 1-Wire commands or 1-Wire data is accepted during execution of the I2C communication (i.e.,
                          during the delay). If polling is used, the host issues single-bit read timeslots and receives a 0b when I2C
       Restriction        communication completes.
                          When using a delay or monitoring the BUSY pin a single-bit read timeslot is still required before reading the
                          Status or Write Status bytes.
Formed 1-Wire Packet
   Command        I2C Slave        Write          Write                        Delay or                      Write
                                                               CRC16[4]                       Status[6]
      4Bh        Address[1]       Length[2]       Data[3]                    Busy Poll[5]                  Status[7]
[1] Defines the 7-bit I2C address to be written. The least significant bit must be zero, indicating an I2C write.
[2] Defines number of data bytes to be written ranging from 01h to FFh. A value of zero asserts the error detected pin
(ED), and the device returns waiting for a valid 1-Wire reset.
[3] Send the user defined write data ranging from 1–255 bytes.
[4] CRC16 of command, I2C slave address, write length, and write data.
[5] Host waits a predetermined delay or polls the busy pin or continuously performs 1-Wire bit reads until receiving a 0b
timeslot. The 0b timeslot must read out regardless of the method used before reading the Status and Write Status bytes.
[6] and [7] are optional to read, but recommend as to know if success of the I2C transaction occurred or not.
www.maximintegrated.com                                                                                              Maxim Integrated │ 17


DS28E17                                                                                      1-Wire-to-I2C Master Bridge
Expected Output on I2C
    S       AD, 0     ACK       xxh[1]     ACK         …       xxh[255]     ACK         P
Write Data No Stop
   Device Command         5Ah
                          Addresses and writes 1–255 bytes to an I2C slave without completing the transaction with a stop. This
     Typical Usage        command allows writing large amounts of data at one time when used in conjunction with the Write Data
                          Only or Write Data Only with Stop Device commands.
      I2C Features        Start, Address, Write Data
                          No 1-Wire commands or 1-Wire data is accepted during execution of the I2C communication (i.e. during
                          the delay). If polling is used, the host issues single-bit read timeslots and receives a 0b when I2C
       Restriction        communication completes.
                          When using a delay or monitoring the BUSY pin a single-bit read timeslot is still required before reading the
                          Status or Write Status bytes.
Formed 1-Wire Packet
   Command        I2C Slave        Write            Write                      Delay or                     Write
                                                               CRC16[4]                       Status[6]
      5Ah        Address[1]       Length[2]        Data[3]                   Busy Poll[5]                  Status[7]
[1] Defines the 7-bit I2C address to be written. The least significant bit automatically clears indicating an I2C write.
[2] Defines number of data bytes to be written ranging from 01h to FFh. A value of zero asserts the error detected pin
(ED), and the device returns waiting for a valid 1-Wire reset.
[3] Send the user defined write data ranging from 1–255 bytes.
[4] CRC16 of command, I2C slave address, write length, and write data.
[5] Host waits a predetermined delay or polls the busy pin or continuously performs 1-Wire bit reads until receiving a 0b
timeslot. The 0b timeslot must read out regardless of the method used before reading the Status and Write Status bytes.
[6] and [7] are optional to read, but recommend as to know if success of the I2C transaction occurred or not.
www.maximintegrated.com                                                                                              Maxim Integrated │ 18


DS28E17                                                                                      1-Wire-to-I2C Master Bridge
Expected Output on I2C
    S       AD, 0    ACK      xxh[1]     ACK          …       xxh[255]     ACK
Expected Output on I2C with Repeated Start
    S       AD, 0    ACK      xxh[1]     ACK          …       xxh[255]     ACK
…Continues by repeating the command…
                                                       Sr      AD, 0      ACK      xxh[1]     ACK        …       xxh[255]   ACK
Write Data Only
   Device Command        69h
                         Used when a start and I2C address have previously been issued with a Write Data No Stop Device
                         command. This command writes 1–255 bytes to an I2C slave without completing the transaction with a stop
     Typical Usage
                         and enables writing large amounts of data at one time when used with the Write Data Only or a last Write
                         Data Only with Stop Device commands.
      I2C Features       Write Data
                         No 1-Wire commands or 1-Wire data is accepted during execution of the I2C communication (i.e.,
                         during the delay). If polling is used, the host issues single bit read timeslots and receives a 0b when I2C
       Restriction       communication completes.
                         When using a delay or monitoring the BUSY pin a single-bit read timeslot is still required before reading the
                         Status or Write Status bytes.
Formed 1-Wire Packet
   Command         Write          Write                        Delay or                      Write
                                              CRC16[3]                       Status[5]
       69h        Length[1]      Data[2]                     Busy Poll[4]                   Status[6]
[1] Defines number of data bytes to be written ranging from 01h to FFh. A value of zero asserts the error detected pin
(ED), and the device returns waiting for a valid 1-Wire reset.
[2] Send the user defined write data ranging from 1–255 bytes.
[3] CRC16 of command, write length, and write data.
[4] Host waits a predetermined delay or polls the busy pin or continuously performs 1-Wire bit reads until receiving a 0b
timeslot. The 0b timeslot must read out regardless of the method used before reading the Status and Write Status bytes.
[5] and [6] are optional to read, but recommend as to know if success of the I2C transaction occurred or not.
www.maximintegrated.com                                                                                             Maxim Integrated │ 19


DS28E17                                                                                      1-Wire-to-I2C Master Bridge
Expected Output on I2C
  xxh[1]    ACK       …       xxh[255]     ACK
Write Data Only with Stop
   Device Command        78h
                         Used when a start and I2C address have previously been issued with a Write Data No Stop Device
     Typical Usage
                         command. This command writes 1–255 bytes to an I2C slave completing the transaction with a stop.
      I2C Features       Write Data, Stop
                         No 1-Wire commands or 1-Wire data is accepted during execution of the I2C communication (i.e.,
                         during the delay). If polling is used, the host issues single-bit read timeslots and receives a 0b when I2C
       Restriction       communication completes.
                         When using a delay or monitoring the BUSY pin a single-bit read timeslot is still required before reading the
                         Status or Write Status bytes.
Formed 1-Wire Packet
   Command         Write          Write                       Delay or                       Write
                                              CRC16[3]                       Status[5]
       78h        Length[1]      Data[2]                     Busy Poll[4]                   Status[6]
[1] Defines number of data bytes to be written ranging from 01h to FFh. A value of zero asserts the error detected pin
(ED), and the device returns waiting for a valid 1-Wire reset.
[2] Send the user defined write data ranging from 1–255 bytes.
[3] CRC16 of command, write length, and write data.
[4] Host waits a predetermined delay or polls the busy pin or continuously performs 1-Wire bit reads until receiving a 0b
timeslot. The 0b timeslot must read out regardless of the method used before reading the Status and Write Status bytes.
[5] and [6] are optional to read, but recommend as to know if success of the I2C transaction occurred or not.
www.maximintegrated.com                                                                                             Maxim Integrated │ 20


DS28E17                                                                                       1-Wire-to-I2C Master Bridge
Expected Output on I2C
  xxh[1]    ACK        …       xxh[255]      ACK          P
Read Data with Stop
   Device Command         87h
     Typical Usage        This is used to address and read 1–255 bytes from an I2C slave in one transaction.
      I2C Features        Start, Address, Read Data, Stop
                          No 1-Wire commands or 1-Wire data is accepted during execution of the I2C communication (i.e.,
                          during the delay). If polling is used, the host issues single-bit read timeslots and receives a 0b when I2C
       Restriction        communication completes.
                          When using a delay or monitoring the BUSY pin a single-bit read timeslot is still required before reading the
                          Status and Read Data.
Formed 1-Wire Packet
   Command        I2C Slave       # of Bytes                     Delay or                     Read
                                                 CRC16[3]                      Status[5]
       87h       Address[1]       to Read[2]                   Busy Poll[4]                   Data[6]
[1] Defines the 7-bit I2C address to be written. The least significant bit must be set, indicating an I2C read.
[2] Defines number of data bytes to be read ranging from 01h to FFh. A value of zero asserts the error detected pin (ED),
and the device returns waiting for a valid 1-Wire reset.
[3] CRC16 of command, I2C slave address, and number of bytes read.
[4] Host waits a predetermined delay or polls the busy pin or continuously performs 1-Wire bit reads until receiving a 0b
timeslot. The 0b timeslot must read out regardless of the method used before reading the Status and Write Status bytes.
[5] Read the Status to verify if success of the I2C transaction occurred or not.
[6] Receive the expected number of I2C read bytes set in the # of Bytes to Read field.
www.maximintegrated.com                                                                                              Maxim Integrated │ 21


DS28E17                                                                                      1-Wire-to-I2C Master Bridge
Expected Output on I2C
      S     AD, 1     ACK      [xxh][1]     ACK         …      [xxh][255]    NACK        P
Write, Read Data with Stop
       Device
                   2Dh
     Command
                   This is used to first address and write 1–255 bytes to an I2C slave. Secondly, it addresses and reads 1–255 bytes
  Typical Usage
                   from an I2C slave and issues a stop.
   I2C Features    Start, Address, Write Data, repeat Start, Address, Read Data, Stop
                   No 1-Wire commands or 1-Wire data is accepted during execution of the I2C communication (i.e., during the
                   delay). If polling is used, the host issues single-bit read timeslots and receives a 0b when I2C communication
    Restriction    completes.
                   When using a delay or monitoring the BUSY pin a single-bit read timeslot is still required before reading the
                   Status or Write Status bytes.
Formed 1-Wire Packet
                                                                                           Delay
   Command       I2C Slave         Write         Write      # of Bytes                                             Write        Read
                                                                            CRC16[5]      or Busy     Status[7]
       2Dh       Address[1]      Length[2]       Data[3]    to Read[4]                                            Status[8]    Data[9]
                                                                                           Poll[6]
[1] Defines the 7-bit I2C address to be written. The least significant bit automatically clears indicating an I2C write during
the I2C write sequence and automatically is set for the I2C read sequence.
[2] Defines number of data bytes to be written ranging from 01h to FFh. A value of zero asserts the error detected pin
(ED), and the device returns waiting for a valid 1-Wire reset.
[3] Send the user defined write data ranging from 1–255 bytes.
[4] Defines number of data bytes to be read ranging from 01h to FFh. A value of zero asserts the error detected pin (ED),
and the device returns waiting for a valid 1-Wire reset.
[5] CRC16 of command, I2C slave address, write length, write data and # of bytes to read. For the CRC16 calculation,
the least significant bit of the I2C slave address is expected to be zero.
[6] Host waits a predetermined delay or polls the busy pin or continuously performs 1-Wire bit reads until receiving a
0b timeslot. The 0b timeslot must read out regardless of the method used before reading the Status, Write Status, and
Read Data bytes.
[7] and [8] read to know if success of the I2C transaction occurred or not.
[9] Receive the expected number of I2C read bytes set in the # of Bytes to Read field.
Expected Output on I2C
      S     AD, 0     ACK       xxh[1]     ACK         ...    xxh[255]      ACK       Sr
   ... Continues with the I2C read …
                                                   AD, 1     ACK       [xxh][1]    ACK        ...    [xxh][255]  NACK        P
www.maximintegrated.com                                                                                            Maxim Integrated │ 22


DS28E17                                                                            1-Wire-to-I2C Master Bridge
Status Register Description for I2C Interface
Status Byte
       BIT 7            BIT 6          BIT 5          BIT 4          BIT 3          BIT 2          BIT 1            BIT 0
         0                 0             0              0            Start            0           Address          CRC16
Any of the Device commands that interact with the I2C bus return a Status byte that describes success or not of the I2C
transaction. As well, the ED pin asserts when any of the bits in the Status byte are set. The ED pin clears when a valid
1-Wire reset is received.
Here are the meanings of the bits:
CRC16 (Bit 0)
Indicates the received 1-Wire packet data does not match the corresponding CRC16. When set, the device responds
with an invalid Write Status byte of FFh since no I2C communication was initiated.
0 = Valid CRC16
1 = Invalid CRC16.
Address (Bit 1)
If this bit is set, only the I2C address was sent, but no write data was transmitted do to the byte not being acknowledged
by the I2C slave device. The device responds with an invalid Write Status byte of FFh.
0 = I2C slave device acknowledged the I2C address
1 = I2C slave device does not acknowledge the I2C address
Start (Bit 3)
0 = Start
1 = Invalid start
Write Status Byte
       BIT 7            BIT 6          BIT 5          BIT 4          BIT 3          BIT 2          BIT 1            BIT 0
       WB7               WB6           WB5            WB4            WB3            WB2             WB1             WB0
Write Byte (Byte 7:0)
Indicates which write byte did not acknowledge. A value of 00h indicates all bytes were acknowledged by the slave. A
non-zero value indicates the byte number that did not acknowledge.
Device Commands for Specific Settings
These 1-Wire commands configure the I2C speed of the device. The 1-Wire sequence follows the color codes in Table 1.
www.maximintegrated.com                                                                                  Maxim Integrated │ 23


DS28E17                                                                                   1-Wire-to-I2C Master Bridge
Write Configuration Command
  Device Command        D2h
                        This is used to write the settings of the I2C speed bits per the formatting of the Configuration register. After
    Typical Usage       selecting the device by a ROM function command, send this Device command followed by the desired byte
                        setting for the Configuration register.
      Features          Writing to the SPD bits.
     Restriction        Write only command.
Configuration Register
     BIT 7           BIT 6             BIT 5             BIT 4            BIT 3             BIT 2           BIT 1             BIT 0
       0               0                 0                 0                0                 0              SPD               SPD
SPD (Bits 1:0)
00b = I2C speed set to 100kHz
01b = I2C speed set to 400kHz (power-on default)
10b = I2C speed set to 900kHz
11b = Not used
1-Wire Sequence
   1-Wire      Presence      ROM Function       Command
                                                                Write Byte
    Reset        Pulse         Command              D2h
Read Configuration
  Device Command        E1h
                        This is used to read the settings of the I2C speed bits from the Configuration register. After addressing
    Typical Usage       the device by a ROM function command, this Device command, followed by a read data byte returns the
                        setting of the Configuration register.
      Features          Reading the SPD bits
     Restriction        Read only command
1-Wire Sequence
   1-Wire      Presence      ROM Function       Command
                                                                Read Byte
    Reset        Pulse        Command              E1h
Enable Sleep Mode
  Device Command        1Eh
                        In addition to the SLEEP_N pin, the Enable Sleep Mode command puts the device into a low current mode.
    Typical Usage       All 1-Wire communication is ignored until woken up. Immediately after the command, the device monitors
                        the WAKEUP input pin and exits sleep mode on a rising edge.
      Features           Reduces current (i.e., < 16µA )
                        This is a write only command. Therefore, the only way to return to normal operation is by a rising edge on
     Restriction
                        the WAKEUP pin.
www.maximintegrated.com                                                                                           Maxim Integrated │ 24


DS28E17                                                                                                  1-Wire-to-I2C Master Bridge
1-Wire Sequence
     1-Wire         Presence        ROM Function          Command
     Reset            Pulse             Command              1Eh
Read Device Revision
    Device Command              C3h
                                The command reads the device revision. Send this 1-Wire Device command and read data byte, after first
     Typical Usage              sending a 1-Wire ROM function command that addresses the device. The read data byte contains the
                                major revision in the upper nibble of the bytes and the minor revision in the lower nibble of the byte.
        Features                 Reads the device revision
       Restriction              Only reads the revision of code in the die but does not provide any information about the package revision.
1-Wire Sequence
     1-Wire         Presence        ROM Function          Command
                                                                          Read Byte
     Reset            Pulse             Command              C3h
CRC-16 Generation
The DS28E17 uses two types of CRCs.
One CRC is an 8-bit type and is stored in the most significant byte of the 64-bit ROM ID. The bus master can compute a
CRC value from the first 56 bits of the 64-bit ROM ID and compare it to the value stored within the DS28E17 to determine
if the ROM data has been received error-free. The equivalent polynomial function of this CRC is X8 + X5 + X4 + 1. This
8-bit CRC is received in the true (noninverted) form as shown previously in Figure 3.
The other CRC is a 16-bit type, generated according to the standardized CRC-16 polynomial function X16 + X15 + X2 + 1.
This CRC in DS28E17 is used for fast verification of a data transfer when receiving a formed 1-Wire packet. In contrast to
the 8-bit CRC, the 16-bit CRC is always communicated in the inverted form. A CRC generator inside the DS28E17 device
(Figure 8) calculates a new 16- bit CRC, and compares it to the received CRC from the host. The DS28E17 compares
the CRC value read from the host to the one it calculates from the 1-Wire formed packet and decides whether to continue
with an I2C operation or to set the CRC16-bit error flag. When the CRC16 flag is set, the ED pin goes high since an error
was detected. For more information on generating CRC values, refer to Application Note 27: Understanding and Using
Cyclic Redundancy Checks with Maxim iButton® Products.
                                                              POLYNOMIAL = X16 + X15 + X2 + 1
                 1ST            2ND                      3RD          4TH           5TH             6TH      7TH            8TH
                STAGE         STAGE                     STAGE        STAGE         STAGE           STAGE    STAGE         STAGE
           X0            X1                        X2           X3           X4               X5         X6          X7
               9TH           10TH         11TH         12TH         13TH         14TH             15TH                   16TH
              STAGE         STAGE        STAGE        STAGE        STAGE        STAGE            STAGE                  STAGE
        X8            X9            X10         X11           X12          X13            X14                     X15           X16     CRC OUTPUT
                                                                                                                    INPUT DATA
Figure 8. CRC-16 Hardware Description and Polynomial
www.maximintegrated.com                                                                                                            Maxim Integrated │ 25


DS28E17                                                                     1-Wire-to-I2C Master Bridge
Ordering Information                                   Chip Information
     PART           TEMP RANGE           PIN-PACKAGE   PROCESS: CMOS
                                          16 TQFN-EP*
 DS28E17Q+T          -40°C to 85°C
                                            (2.5k pcs) Package Information
                                                       For the latest package outline information and land patterns
+Denotes a lead(Pb)-free/RoHS-compliant package.
                                                       (footprints), go to www.maximintegrated.com/packages. Note
T = Tape and reel.                                     that a “+”, “#”, or “-” in the package code indicates RoHS status
*EP = Exposed pad.                                     only. Package drawings may show a different suffix character, but
                                                       the drawing pertains to the package regardless of RoHS status.
                                                           PACKAGE          PACKAGE        OUTLINE           LAND
                                                             TYPE               CODE          NO.        PATTERN NO.
                                                          16 TQFN-EP          T1644+4       21-0139         90-0070
www.maximintegrated.com                                                                            Maxim Integrated │ 26


DS28E17                                                                                                      1-Wire-to-I2C Master Bridge
Revision History
  REVISION           REVISION                                                                                                                       PAGES
                                                                             DESCRIPTION
   NUMBER               DATE                                                                                                                     CHANGED
        0                7/15        Initial release                                                                                                    —
        1               12/15        Updated Benefits and Features and 1-Wire Signaling sections                                                     1, 13
For pricing, delivery, and ordering information, please contact Maxim Direct at 1-888-629-4642, or visit Maxim Integrated’s website at www.maximintegrated.com.
Maxim Integrated cannot assume responsibility for use of any circuitry other than circuitry entirely embodied in a Maxim Integrated product. No circuit patent licenses
are implied. Maxim Integrated reserves the right to change the circuitry and specifications without notice at any time. The parametric values (min and max limits)
shown in the Electrical Characteristics table are guaranteed. Other parametric values quoted in this data sheet are provided for guidance.
Maxim Integrated and the Maxim Integrated logo are trademarks of Maxim Integrated Products, Inc.                 © 2015 Maxim Integrated Products, Inc. │ 27


Mouser Electronics
Authorized Distributor
Click to View Pricing, Inventory, Delivery & Lifecycle Information:
Maxim Integrated:
 DS28E17Q+T DS28E17Q+U DS28E17Q+
