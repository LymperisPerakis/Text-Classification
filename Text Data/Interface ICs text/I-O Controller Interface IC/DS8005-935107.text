                                                                                                                        EVALUATION KIT AVAILABLE
DS8005                                                                                                        Smart Card Interface
General Description                                                             Features
The DS8005 dual smart card interface is a low-cost, dual                        ●● Analog Interface and Level Shifting for IC Card
analog front-end for an IC card reader interface that needs                         Communication
to communicate with two smart cards in a mutually exclu-                        ●● ±8kV (min) ESD (HBM) Protection on Card Interfaces
sive fashion. The analog interface is designed for use in
ISO 7816, EMV®, and B-CAS applications. The device is                           ●● Ultra-Low Stop-Mode Current, Less than 10nA
functionally similar to two DS8024s with external multi-                            Typical
plexing to select the active interface, but also includes low                   ●● Internal IC Card Supply-Voltage Generation
power and 1.8V card support. Additionally, the device is                            • 5.0V ±5%, 80mA (max)
designed for applications where the C4/C8 (AUX1/AUX2)                               • 3.0V ±8%, 65mA (max)
contacts are not required on either card interface.                                 • 1.8V ±10%, 30mA (max)
The device is provided in 28-pin SO and TSSOP packag-                           ●● Automatic Card Activation and Deactivation
es. The pinout is backwards compatible with the DS8313,                             Controlled by Dedicated Internal Sequencer
allowing applications to use the same footprint and PCB                         ●● I/O Lines from Host Directly Level Shifted for Smart
for applications that communicate with either one or two                            Card Communication
smart cards.
                                                                                ●● Flexible Card Clock Generation, Supporting External
The device is designed to be used with microcontrollers                             Crystal Frequency Divided by 1, 2, 4, or 8
that contain an ISO 7816 UART, or have the bandwidth
                                                                                ●● High-Current, Short-Circuit and High-Temperature
to run this protocol in software by bit-banging IO ports. If
                                                                                    Protection
the microcontroller does not have the capability of running
the ISO 7816 UART, the DS8007 is the more appropriate                           ●● Low Active-Mode Current
product selection.                                                              ●● Internal Multiplexing Allows One ISO 7816 UART
                                                                                ●● Implementation to Control Two Smart Card Sockets
Applications
●●  Set-Top Box Conditional Access
●●  Telecommunications
●●  Pay Television
●●  Access Control
●●  Financial Terminals
Ordering Information
                     CARD VOLTAGES            LOW POWER             LOW POWER                                                                 PIN-
      PART                                                                                PRES_POLARITY           TEMP RANGE
                       SUPPORTED               STOP MODE           ACTIVE MODE                                                            PACKAGE
 DS8005-RRX+             1.8V, 3V, 5V               Yes                    Yes                   Positive         -40°C to +85°C             28 SO
 DS8005-RJX+             1.8V, 3V, 5V               Yes                    Yes                   Positive         -40°C to +85°C          28 TSSOP
+Denotes lead(Pb)-free/RoHS-compliant package.
Typical Application Circuit appears at end of data sheet.
EMV is a registered trademark of EMVCo LLC.
Note: Some revisions of this device may incorporate deviations from published specifications known as errata. Multiple revisions of any device may be
simultaneously available through various sales channels. For information about device errata, go to: www.maximintegrated.com/errata.
19-5257; Rev 2; 9/17


DS8005                                                                                                                                        Smart Card Interface
Absolute Maximum Ratings
Voltage Range on VDD Relative to GND...............-0.5V to +6.5V                                     Maximum Junction Temperature.......................................+125°C
Voltage Range on VDDA Relative to GND.............-0.5V to +6.5V                                      Maximum Power Dissipation Range (TA = -25°C to +85°C)..700mW
Voltage Range on CLKA, RSTA, I/OA......-0.5V to (VCCA + 0.5V)                                         Storage Temperature Range..............................-55°C to +150°C
Voltage Range on CLKB, RSTB, I/OB......-0.5V to (VCCB + 0.5V)                                         Lead Temperature (soldering, 10s)...................................+300°C
Voltage Range on All Other Pins                                                                       Soldering Temperature (reflow)........................................+260°C
    Relative to GND.....................................-0.5V to (VDD + 0.5V)
Stresses beyond those listed under “Absolute Maximum Ratings” may cause permanent damage to the device. These are stress ratings only, and functional operation of the device at these
or any other conditions beyond those indicated in the operational sections of the specifications is not implied. Exposure to absolute maximum rating conditions for extended periods may affect
device reliability.
Recommended DC Operating Conditions
(VDD = +3.3V, VDDA = +5.0V, TA = +25°C, unless otherwise noted. All specifications apply to the device, unless otherwise noted in the
CONDITIONS column.) (Note 1)
                      PARAMETER                                     SYMBOL                                CONDITIONS                             MIN         TYP         MAX        UNITS
 POWER SUPPLY
 Digital Supply Voltage                                                 VDD                                                                       2.7                     6.0          V
 Card Voltage-Generator Supply Voltage                                 VDDA             Must be ≥ VDD                                           4.75                      6.0          V
                                                                       VTH2             Threshold voltage (falling)                             2.20         2.45        2.65          V
 Reset Voltage Thresholds
                                                                      VHYS2             Hysteresis                                                50         100          200         mV
 CURRENT CONSUMPTION
 Active VDD Current 5V Cards                                                            ICC = 80mA, fXTAL = 20MHz,
                                                                     IDD_50V                                                                                80.75          85         mA
 (Including 80mA Draw from 5V Card)                                                     fCLK = 10MHz, VDDA = 5.0V
 Active VDD Current 5V Cards (Current                                                   ICC = 80mA, fXTAL = 20MHz,
                                                                      IDD_IC                                                                                 0.75           5         mA
 Consumed by Device Only)                                                               fCLK = 10MHz, VDDA = 5.0V (Note 2)
 Active VDD Current 3V Cards                                                            ICC = 65mA, fXTAL = 20MHz,
                                                                     IDD_30V                                                                                65.75          70         mA
 (Including 65mA Draw from 3V Card)                                                     fCLK = 10MHz, VDDA = 5.0V
 Active VDD Current 3V Cards (Current                                                   ICC = 65mA, fXTAL = 20MHz,
                                                                      IDD_IC                                                                                 0.75           5         mA
 Consumed by Device Only)                                                               fCLK = 10MHz, VDDA = 5.0V (Note 2)
 Active VDD Current 1.8V Cards                                                          ICC = 30mA, fXTAL = 20MHz,
                                                                     IDD_18V                                                                                30.75          40         mA
 (Including 30mA Draw from 1.8V Card)                                                   fCLK = 10MHz, VDDA = 5.0V
 Active VDD Current 1.8V Cards (Current                                                 ICC = 30mA, fXTAL = 20MHz,
                                                                      IDD_IC                                                                                 0.75           5         mA
 Consumed by Device Only)                                                               fCLK = 10MHz, VDDA = 5.0V (Note 2)
                                                                                        Card inactive, active-high PRES_,
 Inactive-Mode Current                                                  IDD                                                                                   50          400         µA
                                                                                        device not in stop mode
                                                                                        Device in ultra-low-power stop mode
 Stop-Mode Current                                                 IDD_STOP             (CMDVCC, 5V/3V, and 1_8V set to                                      0.01           2         µA
                                                                                        logic 1) (Note 3)
www.maximintegrated.com                                                                                                                                           Maxim Integrated │ 2


DS8005                                                                                            Smart Card Interface
Recommended DC Operating Conditions (continued)
(VDD = +3.3V, VDDA = +5.0V, TA = +25°C, unless otherwise noted. All specifications apply to the device, unless otherwise noted in the
CONDITIONS column.) (Note 1)
                PARAMETER                    SYMBOL                   CONDITIONS                    MIN      TYP    MAX      UNITS
 CLOCK SOURCE
 Crystal Frequency                              fXTAL    External crystal (Note 1)                     0              20      MHz
                                               fXTAL1    (Note 1)                                      0              20      MHz
                                                                                                                    0.3 x
                                             VIL_XTAL1   Low-level input on XTAL1                   -0.3
 XTAL1 Operating Conditions                                                                                          VDD
                                                                                                                                V
                                                                                                    0.7 x           VDD +
                                            VIH_XTAL1    High-level input on XTAL1
                                                                                                    VDD              0.3
                                              CXTAL1,
 External Capacitance for Crystal                                                                                     15       pF
                                              CXTAL2
 Internal Oscillator                              fINT                                               2.2     2.7     3.4      MHz
 SHUTDOWN TEMPERATURE
 Shutdown Temperature                            TSD                                                        +150               °C
 RSTA AND RSTB PINS
                       Output Low Voltage    VOL_RST1    IOL_RST = 1mA                                               0.3        V
 Card-Inactive Mode
                       Output Current        IOL_RST1    VOL_RST = 0V                                                 -1       mA
                       Output Low Voltage    VOL_RST2    IOL_RST = 200µA                                             0.3        V
                       Output High                                                                 VCC -
                                            VOH_RST2     IOH_RST = -200µA                                                       V
                       Voltage                                                                       0.5
 Card-Active Mode      Rise Time              tR_RST     CL = 30pF (Note 1)                                          0.1       µs
                       Fall Time              tF_RST     CL = 30pF (Note 1)                                          0.1       µs
                       Current Limitation   IRST(LIMIT)                                              -20             +20       mA
                       RSTIN to RST Delay tD(RSTIN-RST)                                                                2       µs
 CLKA AND CLKB PINS
                       Output Low Voltage    VOL_CLK1    IOLCLK = 1mA                                                0.3        V
 Card-Inactive Mode
                       Output Current        IOL_CLK1    VOLCLK = 0V                                                  -1       mA
                       Output Low Voltage    VOL_CLK2    IOLCLK = 200µA                                              0.3        V
                       Output High                                                                 VCC -
                                            VOH_CLK2     IOHCLK = -200µA                                                        V
                       Voltage                                                                       0.5
                       Rise Time              tR_CLK     CL = 30pF (Notes 1, 4)                                        8       ns
 Card-Active Mode      Fall Time              tF_CLK     CL = 30pF (Notes 1, 4)                                        8       ns
                       Current Limitation   ICLK(LIMIT)                                              -75             +75       mA
                       Clock Frequency           fCLK    Operational                                   0              10      MHz
                       Duty Factor                  δ    CL = 30pF                                    45              55       %
                       Slew Rate                   SR    CL = 30pF (Note 1)                          0.2                      V/ns
 VCCA AND VCCB PINS
                       Output Low Voltage       VCC1     ICC = 1mA                                                   0.3        V
 Card-Inactive Mode
                       Output Current            ICC1    VCC = 0V                                      0              -1       mA
www.maximintegrated.com                                                                                         Maxim Integrated │ 3


DS8005                                                                                            Smart Card Interface
Recommended DC Operating Conditions (continued)
(VDD = +3.3V, VDDA = +5.0V, TA = +25°C, unless otherwise noted. All specifications apply to the device, unless otherwise noted in the
CONDITIONS column.) (Note 1)
               PARAMETER                     SYMBOL                   CONDITIONS                    MIN      TYP     MAX      UNITS
                                                         Device: ICC(5V) < 30mA,
                                                                                                    4.65       5     5.25
                                                         VDDA = 4.75V (Note 1)
                                                         Device: ICC(5V) < 80mA                     4.75       5     5.25
                                                         Device: ICC(3V) < 65mA                     2.78       3     3.24
                                                         Device: ICC(1.8V) < 30mA                   1.64      1.8    1.98
                                                         5V card; current pulses of 40nC
                                                         with I < 200mA, t < 400ns,                  4.6              5.4
                        Output Low Voltage     VCC2                                                                              V
                                                         f < 20MHz
                                                         3V card; current pulses of 24nC
                                                         with I < 200mA, t < 400ns,                 2.75             3.25
 Card-Active Mode                                        f < 20MHz
                                                         1.8V card; current pulses of 12nC
                                                         with I < 200mA, t < 400ns,                 1.62             1.98
                                                         f < 20MHz
                                                         VCC(5V) = 0 to 5V                                            -80
                        Output Current          ICC2     VCC(3V) = 0 to 3V                                            -65       mA
                                                         VCC(1.8V) = 0 to 1.8V                                        -30
                        Shutdown Current
                                              ICC(SD)    (Note 1)                                            120                mA
                        Threshold
                        Slew Rate             VCCSR      Up/down; C < 300nF (Note 5)                0.05     0.16    0.22      V/µs
 DATA LINES (I/O_ AND I/OIN)
 I/O_ Û I/OIN Falling Edge Delay            tD(IO-IOIN)  (Note 1)                                                     200       ns
 Pullup Pulse Active Time                        tPU     (Note 1)                                                     100       ns
 Maximum Frequency                            fIOMAX                                                                    1      MHz
 Input Capacitance                                CI                                                                   10       pF
 I/OA AND I/OB PINS
                        Output Low Voltage   VOL_IO1     IOL_IO = 1mA                                                 0.3        V
                        Output Current        IOL_IO1    VOL_IO = 0V                                  0                -1       mA
 Card-Inactive Mode
                        Internal Pullup
                                              RPU_IO     To VCC                                       6       11       19       kΩ
                        Resistor
                        Output Low Voltage   VOL_IO2     IOL_IO = 1mA                                                 0.3        V
                                                         IOH_IO = < -20µA                           0.8 x VCC
                        Output High Voltage  VOH_IO2                                                                             V
                                                         IOH_IO = < -40µA (3V/5V)                  0.75 x VCC
 Card-Active Mode       Output Rise/Fall
                                                 tOT     CL = 30pF (Note 1)                                           0.1       µs
                        Time
                        Input Low Voltage      VIL_IO                                               -0.3             +0.8
                                                                                                                                 V
                        Input High Voltage     VIH_IO                                                1.5             VCC
www.maximintegrated.com                                                                                          Maxim Integrated │ 4


DS8005                                                                                            Smart Card Interface
Recommended DC Operating Conditions (continued)
(VDD = +3.3V, VDDA = +5.0V, TA = +25°C, unless otherwise noted. All specifications apply to the device, unless otherwise noted in the
CONDITIONS column.) (Note 1)
                PARAMETER                   SYMBOL                    CONDITIONS                    MIN      TYP    MAX      UNITS
                       Input Low Current      IIL_IO     VIL_IO = 0V                                                 700       µA
                       Input High Current     IIH_IO     VIH_IO = VCC                                -20             +20       µA
 Card-Active Mode
                       Input Rise/Fall Time      tIT                                                                 1.2       µs
                       Current Limitation   IIO(LIMIT)   CL = 30pF                                   -15             +15       mA
 I/OIN PIN
 Output Low Voltage                            VOL       IOL = 1mA                                                   0.3        V
                                                                                                   0.75 x           VDD +
 Output High Voltage                           VOH       IOH < -40µA                                                            V
                                                                                                    VDD              0.1
 Output Rise/Fall Time                          tOT      CL = 30pF, 10% to 90%                                       0.1       µs
                                                                                                                    +0.3 x
 Input Low Voltage                              VIL                                                 -0.3                        V
                                                                                                                     VDD
                                                                                                    0.7 x           VDD +
 Input High Voltage                             VIH                                                                             V
                                                                                                    VDD              0.3
 Input Low Current                            IIL_IO     VIL = 0V                                                    700       µA
 Input High Current                           IIH_IO     VIH = VDD                                   -10             +10       µA
 Input Rise/Fall Time                            tIT     VIL to VIH                                                  1.2       µs
 Integrated Pullup Resistor                    RPU       Pullup to VDD                                 6      11      19       kΩ
 CONTROL PINS (CLKDIV1, CLKDIV2, CMDVCC, RSTIN, 5V/3V, 1_8V)
                                                                                                                    +0.3 x
 Input Low Voltage                              VIL                                                 -0.3                        V
                                                                                                                     VDD
                                                                                                    0.7 x           VDD +
 Input High Voltage                             VIH                                                                             V
                                                                                                    VDD              0.3
 Input Low Current                            IIL_IO     0 < VIL < VDD                                -5              +5       µA
 Input High Current                           IIH_IO     0 < VIH < VDD                                -5              +5       µA
 INTERRUPT OUTPUT PINS (OFF AND OFF2)
 Output Low Voltage                            VOL       IOL = 2mA                                                   0.3        V
                                                                                                   0.75 x
 Output High Voltage                           VOH       IOH = -15µA                                                            V
                                                                                                    VDD
 Integrated Pullup Resistor                    RPU       Pullup to VDD                                12      24      38       kΩ
 PRESA AND PRESB PINS
                                                                                                                    0.3 x
 Input Low Voltage                          VIL_PRES                                                                            V
                                                                                                                     VDD
                                                                                                    0.7 x
 Input High Voltage                         VIH_PRES                                                                            V
                                                                                                    VDD
 Input Low Current                          IIL_PRES     VIL_PRES = 0V                                -5              +5       µA
 Input High Current                         IIH_PRES     VIH_PRES = VDD                                               10       µA
www.maximintegrated.com                                                                                         Maxim Integrated │ 5


DS8005                                                                                            Smart Card Interface
Recommended DC Operating Conditions (continued)
(VDD = +3.3V, VDDA = +5.0V, TA = +25°C, unless otherwise noted. All specifications apply to the device, unless otherwise noted in the
CONDITIONS column.) (Note 1)
                PARAMETER                     SYMBOL                   CONDITIONS                   MIN      TYP     MAX      UNITS
 TIMING
 Activation Time                                  tACT                                               50      160      220       µs
 Deactivation Time                              tDEACT                                               50       80      100       µs
 CLK_ to Card Start      Window Start               t3                                               50       95      130
                                                                                                                                µs
 Time                    Window End                 t5                                              140      160      220
 PRES Debounce Time                          tDEBOUNCE                                                5        8       11       ms
Note  1:  Operation guaranteed at -40°C and +85°C but not tested.
Note  2:  IDD_IC measures the amount of current used by the device to provide the smart card current minus the load.
Note  3:  Stop mode is enabled by setting CMDVCC, 5V/3V, and 1_8V to a logic-high.
Note  4:  Parameters are guaranteed to meet all ISO 7816, GSM11-11, and EMV 2000 requirements. For the 1.8V card, the maxi-
          mum rise and fall time is 10ns.
Note 5: Parameter is guaranteed to meet all ISO 7816, GSM11-11, and EMV 2000 requirements. For the 1.8V card, the minimum
          slew rate is 0.05V/μs and the maximum slew rate is 0.5V/μs.
www.maximintegrated.com                                                                                          Maxim Integrated │ 6


DS8005                                                                                             Smart Card Interface
Pin Configuration
                                          TOP VIEW
                                       CLKDIV1 1                                  28 SEL_AB
                                       CLKDIV2 2                                  27 OFF2
                                          5V/3V 3                                 26 I/OIN
                                           1_8V 4                                 25 XTAL2
                                           VCCB 5                                 24 XTAL1
                                                                DS8005
                                           VDDA 6                                 23 OFF
                                          RSTB 7                                  22 GND
                                          CLKB 8                                  21 VDD
                                          CGND 9                                  20 RSTIN
                                         PRESA 10                                 19 CMDVCC
                                            I/OA 11                               18 VDDA2
                                            I/OB 12                               17 VCCA
                                         PRESB 13                                 16 RSTA
                                          CGND 14                                 15 CLKA
                                                              SO/TSSOP
Pin Description
    PIN         NAME                                                       FUNCTION
              CLKDIV1,  Clock Divider. Determines the divided-down input clock frequency (presented at XTAL1 or from a crystal
    1, 2
               CLKDIV2  at XTAL1 and XTAL2) on the CLK_ output pin. Dividers of 1, 2, 4, and 8 are available.
                        5V/3V Selection Pin. Allows selection of 5V or 3V for communication with an IC card. Logic-high selects
     3           5V/3V  5V operation; logic-low selects 3V operation. The 1_8V pin overrides the setting on this pin if active. See
                        Table 3 for a complete description of choosing card voltages.
                        1.8V Operation Selection. This active-high input puts the device into 1.8V smart card communication
     4           1_8V   mode. The selected interface (when activated) powers a card with a 1.8V supply and all I/O lines
                        operate at 1.8V.
                        Smart Card Supply Voltage, Interface B. Decouple to CGND (card ground) with 2 x 100nF or 100 +
     5           VCCB
                        200nF capacitors (ESR < 100mΩ).
                        Smart Card Interface Supply. Connect to a 5V power supply to support 1.8V, 3.0V, and 5.0V cards. If
     6           VDDA   VDD ≥ 4.9V, this pin can be connected directly to VDD. Decouple this pin to GND using 100nF and 10µF
                        capacitors.
     7           RSTB   Smart Card Reset, Interface B. Card reset output from contact C2.
     8           CLKB   Smart Card Clock, Interface B. Card clock, contact C3.
   9, 14        CGND    Smart Card Ground
                        Interface A Card Presence Indicator. Active-high card presence input for the first card interface. When the
    10          PRESA   presence indicator becomes active, a debounce timeout begins. After 8ms (typ), the OFF signal becomes
                        active if the first card interface is selected (SEL_AB low), else the OFF2 signal becomes active.
www.maximintegrated.com                                                                                          Maxim Integrated │ 7


DS8005                                                                                             Smart Card Interface
Pin Description (continued)
    PIN         NAME                                                       FUNCTION
                        Smart Card Data-Line Output, Interface A. Card data communication line, contact C7. This pin is
     11           I/OA  only active if the first card interface is selected (SEL_AB low) and the interface has gone through an
                        activation sequence.
                        Smart Card Data-Line Output, Interface B. Card data communication line, contact C7. This pin is only
    12            I/OB  active if the second card interface is selected (SEL_AB high) and the interface has gone through an
                        activation sequence.
                        Interface B Card Presence Indicator. Active-high card presence input for the second card interface.
                        When the presence indicator becomes active, a debounce timeout begins. After 8ms (typ), the OFF
    13          PRESB
                        signal becomes active if the second card interface is selected (SEL_AB high), else the OFF2 signal
                        becomes active.
    15           CLKA   Smart Card Clock, Interface A. Card clock, contact C3.
    16           RSTA   Smart Card Reset, Interface A. Card reset output from contact C2.
                        Smart Card Supply Voltage, Interface A. Decouple to CGND (card ground) with 2 x 100nF or 100 +
    17           VCCA
                        220nF capacitors (ESR < 100mΩ).
                        Smart Card Interface Supply. Connect to a 5V power supply to support 1.8V, 3.0V, and 5.0V cards. If
    18          VDDA2   VDD ≥ 4.9V, this pin can be connected directly to VDD. Decouple this pin to GND using 100nF and 10µF
                        capacitors.
    19         CMDVCC   Activation Sequence Initiate. Active-low input from host.
    20          RSTIN   Card Reset Input. Reset input from the host.
    21            VDD   Supply Voltage
    22           GND    Digital Ground
                        Status Output for Selected Interface. Active-low interrupt output to the host. Includes a 20kΩ integrated
                        pullup resistor to VDD. This pin reflects fault events and PRES_ events on the currently selected
    23            OFF
                        interface only (behaving as if it were a DS8024 with only one interface). The OFF2 pin should be used
                        to monitor presence events on the nonselected interface.
                XTAL1,  Crystal/Clock Input. Connect an input from an external clock to XTAL1 or connect a crystal across
   24, 25
                XTAL2   XTAL1 and XTAL2. Leave XTAL2 disconnected if driving XTAL1 from an external clock source.
    26           I/OIN  I/O Input. Host-to-interface chip data I/O line.
                        Status Output for Nonselected Interface. This pin passes through the presence signal for the
                        nonselected interface. If SEL_AB is low (the A interface is selected), this pin reflects the state of the
    27           OFF2
                        PRESB input. If SEL_AB is high (the B interface is selected), this pin reflects the state of the PRESA
                        input.
                        Interface Selection. This pin selects the interface the input pins (I/OIN, RSTIN, etc.) communicate with
                        and control. If SEL_AB is low, the A interface is selected. Activation sequences power up VCCA and
    28         SEL_AB   communication occurs with CLKA, I/OA, and RSTA. If SEL_AB is high, the B interface is selected. Both
                        interfaces can be powered and clocking at the same time. See the Switching A/B Interfaces section for
                        more information.
www.maximintegrated.com                                                                                         Maxim Integrated │ 8


DS8005                                                                                           Smart Card Interface
                           1_8V                                                                         CGND
                          5V/3V                                                                         I/OA
                                        REGULATOR
                           VDDA                                                                         VCCA
                                                                                      CARD
                         VDDA2                                                                          RSTA
                                                                                  INTERFACE A
                                                                                                        CLKA
                       CLKDIV1
                                                                                                        PRESA
                       CLKDIV2            CLOCK
                         XTAL1         GENERATION
                                                                                                        I/OB
                         XTAL2
                                                                                                        VCCB
                                                                                      CARD
                         RSTIN              I/O                                                         RSTB
                                                                                  INTERFACE B
                           I/OIN           XCVR                                                         CLKB
                                                                                                        PRESB
                        SEL_AB           CONTROL      QSEL_AB
                      CMDVCC           SEQUENCER
                                               QSEL_AB
                                                                                     DS8005
                            OFF         INTERRUPT
                          OFF2         GENERATION
                                                              FAULT                  POWER              VDD
                                                            DETECTION                SUPPLY             GND
Figure 1. Functional Diagram
Detailed Description                                                  Power Supply
The DS8005 is an analog front-end for communicat-                     The device has dual supplies. The supply pins for the
ing with 1.8V, 3V, and 5V dual smart cards. It is a dual              device are VDD, GND, and VDDA. VDD should be in the
input-voltage device, requiring one supply to match that              2.7V to 6.0V range, and is the supply for signals that inter-
of a host microcontroller and a separate +5V supply for               face with the host controller. It should, therefore, be the
generating correct smart card supply voltages. The device             same supply as used by the host controller. All smart card
translates all communication lines to the correct voltage             contacts remain inactive during power-on or power-off.
level and provides power for smart card operation. It                 The internal circuits are kept in the reset state until VDD
is a low-power device, consuming very little current in               reaches VTH2 + VHYS2 and for the duration of the inter-
active-mode operation (during a smart card communica-                 nal power-on reset pulse, tW. A deactivation sequence is
tion session), and is suitable for use in battery-powered             executed when VDD falls below VTH2.
devices such as laptops and PDAs, consuming only 10nA                 An internal regulator generates the 1.8V, 3V, or 5V card
in stop mode. The device is designed for applications that            supply voltage (VCC_). The regulator should be supplied
do not require communication using the C4 and C8 card                 separately by VDDA. VDDA should be connected to a
contacts (AUX1 and AUX2). It is suitable for SIM/SAM                  minimum 4.75V supply to provide the correct supply volt-
interfacing, as well as for applications where only the I/O           age for 5V smart cards.
line is used to communicate with a smart card.
www.maximintegrated.com                                                                                       Maxim Integrated │ 9


DS8005                                                                                    Smart Card Interface
Voltage Supervisor                                           The frequency change is synchronous: during a transi-
The voltage supervisor monitors the VDD supply. A 220μs      tion of the clock divider, no pulse is shorter than 45% of
reset pulse (tW) is used internally to keep the device inac- the smallest period, and the first and last clock pulses
tive during power-on or power-off of the VDD supply. See     about the instant of change have the correct width. When
Figure 2.                                                    changing the frequency dynamically, the change is effec-
                                                             tive for only eight periods of XTAL1 after the command.
The IC card interface remains inactive regardless of the
levels on the command lines until duration tW after VDD      The fXTAL duty factor depends on the input signal on
has reached a level higher than VTH2 + VHYS2. When           XTAL1. To reach a 45% to 55% duty factor on CLK_,
VDD falls below VTH2, the device executes a card deacti-     XTAL1 should have a 48% to 52% duty factor with transi-
vation sequence if the card interface is active.             tion times less than 5% of the period.
                                                             With a crystal, the duty factor on CLK_ can be 45% to
Clock Circuitry                                              55% depending on the circuit layout and on the crystal
The card clock signal (CLKA/CLKB) is derived from a          characteristics and frequency. In other cases, the duty
clock signal input to XTAL1 or from a crystal operating      factor on CLK_ is guaranteed between 45% and 55% of
at up to 20MHz connected between XTAL1 and XTAL2.            the clock period.
The output clock frequency of CLK_ is selectable through
inputs CLKDIV1 and CLKDIV2. The CLK signal frequency         I/O Transceivers
can be fXTAL, fXTAL/2, fXTAL/4, or fXTAL/8. See Table 1      I/O_ and I/OIN are pulled high with an 11kΩ resistor (I/O_
for the frequency generated on the CLK_ signal given the     to VCC_ and I/OIN to VDD) in the inactive state. The first
inputs to CLKDIV1 and CLKDIV2.                               side of the transceiver to receive a falling edge becomes
Note that CLKDIV1 and CLKDIV2 must not be changed            the master. When a falling edge is detected (and the mas-
simultaneously; a delay of 10ns minimum between chang-       ter is decided), the detection of falling edges on the line of
es is needed. The minimum duration of any state of CLK_      the other side is disabled; that side then becomes a slave.
is eight periods of XTAL1.                                   After a time delay tD(EDGE), an n transistor on the slave
                                                             side is turned on, thus transmitting the logic 0 present on
                                                             the master side.
Table 1. Clock Frequency Selection
                                                             When the master side asserts a logic 1, a p transistor on
      CLKDIV1                CLKDIV2             fCLK        the slave side is activated during the time delay tPU and
          0                     0              fXTAL/8       then both sides return to their inactive (pulled up) states.
          0                     1              fXTAL/4       This active pullup provides fast low-to-high transitions.
                                                             After the duration of tPU, the output voltage depends only
          1                     1              fXTAL/2
                                                             on the internal pullup resistor and the load current. Current
          1                     0                fXTAL       to and from the card I/O lines is limited internally to 15mA.
                                                             The maximum frequency on these lines is 1MHz.
                                                                                                        VTH2 + VHYS2
                                                                                                        VTH2
                         VDD
                      ALARM
           (INTERNAL SIGNAL)
                                                tW                       tW
                                             POWER ON              SUPPLY DROPOUT                     POWER OFF
Figure 2. Voltage Supervisor Behavior
www.maximintegrated.com                                                                               Maxim Integrated │ 10


DS8005                                                                                       Smart Card Interface
Inactive Mode                                                    If the card is in the reader (if PRES_ is active), the host
The device powers up with the card interface in the inac-        microcontroller can begin an activation sequence (start
tive mode. Minimal circuitry is active while waiting for the     a card session) by pulling CMDVCC low. The following
host to initiate a smart card session.                           events form an activation sequence (Figure 3):
•   All card contacts are inactive (approximately 200Ω to        1) CMDVCC is pulled low.
    GND).                                                        2) The internal oscillator changes to high frequency (t0).
•   The I/OIN pin in the high-impedance state (11kΩ              3) The voltage generator is started (between t0 and t1).
    pullup resistor to VDD).
                                                                 Table 2. Card Presence Indication
•   Voltage generators are stopped.
                                                                     SEL_AB       OFF       CMDVCC           STATUS
•   XTAL oscillator is running (if included in the device).
                                                                         Low      High        High    Card A present.
•   Voltage supervisor is active.
                                                                         Low       Low        High    Card A not present.
•   The internal oscillator is running at its low frequency.            High      High        High    Card B present.
                                                                        High       Low        High    Card B not present.
Activation Sequence
                                                                     SEL_AB       OFF2      CMDVCC           STATUS
After power-on and the reset delay, the host microcon-
                                                                         Low      High        High    Card B present.
troller can monitor card presence with signals OFF and
CMDVCC, as shown in Table 2.                                             Low       Low        High    Card B not present.
                                                                        High      High        High    Card A present.
                                                                        High       Low        High    Card A not present.
            CMDVCC
               VCC_
                 I/O_                                                                                ATR
               CLK_
              RSTIN
               RST_
               I/OIN
                                  t 0 t1   t2       t3      t4 t5 = tACT
Figure 3. Activation Sequence Using RSTIN and CMDVCC
www.maximintegrated.com                                                                                Maxim Integrated │ 11


DS8005                                                                                        Smart Card Interface
4) VCC_ rises from 0 to 5V, 3V, or 1.8V with a controlled        An internal overload detector triggers at approximately
    slope (t2 = t1 + 1.5 × T). T is 64 times the internal oscil- 120mA. Current samples to the detector are filtered. This
    lator period (approximately 25μs).                           allows spurious current pulses (with a duration of a few
5) I/O_ pin is enabled (t3 = t1 + 4T) (they were previously      μs) up to 200mA to be drawn without causing deactiva-
    pulled low).                                                 tion. The average current must stay below the specified
                                                                 maximum current value. To maintain VCC voltage accura-
6) The CLK_ signal is applied to the C3 contact (t4).            cy, a 100nF capacitor (with an ESR < 100mΩ) should be
7) RST_ is enabled (t5 = t1 + 7T).                               connected to CGND and placed near the VCC_ pin, and a
To apply the clock to the card interface:                        100nF or 220nF capacitor (220nF is the best choice) with
                                                                 the same ESR should be connected to CGND and placed
1) Set RSTIN high.
                                                                 near the smart card reader’s C1 contact.
2) Set CMDVCC low.
3) Set RSTIN low between t3 and t5; CLK_ now starts.             Fault Detection
4) RST_ stays low until t5, then RST becomes the copy            The following fault conditions are monitored:
    of RSTIN.                                                    •   Short-circuit or high current on VCC_
5) RSTIN has no further effect on CLK_ after t5.                 •   Removal of a card during a transaction
If the applied clock is not needed, set CMDVCC low with          •   VDD dropping
RSTIN low. In this case, CLK_ starts at t3 (minimum              •   Card voltage generator operating out of the specified
200ns after the transition on I/O; see Figure 4); after t5,          values (VDDA too low or current consumption too high)
RSTIN can be set high to obtain an answer to request
                                                                 •   Overheating
(ATR) from an inserted smart card. Do not perform activa-
tion with RSTIN held permanently high.                           There are two different cases (Figure 6):
                                                                 •   CMDVCC High Outside a Card Session. Output
Active Mode                                                          OFF_ is low if a card is not in the card reader and
When the activation sequence is completed, the card                  high if a card is in the reader. The VDD supply is
interface is in active mode. The host microcontroller and            monitored—a decrease in input voltage generates an
the smart card exchange data on the I/O lines.                       internal power-on reset pulse but does not affect the
                                                                     OFF_ signal. Short-circuit and temperature detection
Deactivation Sequence                                                is disabled because the card is not powered up.
When a session is completed, the host microcontroller            •   CMDVCC Low Within a Card Session. Output
sets the CMDVCC line high to execute an automatic                    OFF_ goes low when a fault condition is detected,
deactivation sequence and returns the card interface to              and an emergency deactivation is performed auto-
the inactive mode (Figure 5).                                        matically (Figure 7). When the system controller resets
1) RST_ goes low (t10).                                              CMDVCC to high, it may sense the OFF_ level again
2) CLK_ is held low (t12 = t10 + 0.5 × T) where T is 64              after completing the deactivation sequence. This dis-
    times the period of the internal oscillator (approxi-            tinguishes between a card extraction and a hardware
    mately 25μs).                                                    problem (OFF_ goes high again if a card is present).
                                                                     Depending on the connector’s card-present switch
3) I/O_ pin is pulled low (t13 = t10 + T).                           (normally closed or normally open) and the mechani-
4) VCC starts to fall (t14 = t10 + 1.5 × T).                         cal characteristics of the switch, bouncing can occur
5) When VCC_ reaches its inactive state, the deactivation            on the PRES_ signals at card insertion or withdrawal.
    sequence is complete (at tDE).                               The device has a debounce feature with an 8ms typical
6) All card contacts become low impedance to GND; I/OIN          duration (Figure 6). When a card is inserted, output OFF_
    remains at VDD (pulled up through an 11kΩ resistor).         goes high after the debounce time delay. When the card is
                                                                 extracted, an automatic deactivation sequence of the card
7) The internal oscillator returns to its lower frequency.       is performed on the first true/false transition on PRES_
                                                                 and output OFF_ goes low.
VCC Generator
Each VCC_ generator has a capacity to supply up to
80mA continuously at 5V, 65mA at 3V, and 30mA at 1.8V.
www.maximintegrated.com                                                                                 Maxim Integrated │ 12


DS8005                                                                  Smart Card Interface
           CMDVCC
               VCC_
                 I/O_                                                        ATR
               CLK_
                                                    200ns
              RSTIN
               RST_
               I/OIN
                                  t 0 t1 t2  t3 t4        t5 = tACT
Figure 4. Activation Sequence at t3
           CMDVCC
               RST_
               CLK_
                 I/O_
               VCC_
                                 t10        t12      t13      t14   t15
                                                tDE
Figure 5. Deactivation Sequence
www.maximintegrated.com                                                        Maxim Integrated │ 13


DS8005                                                                           Smart Card Interface
             PRES_
               OFF_
           CMDVCC
                        DEBOUNCE                                    DEBOUNCE
               VCC_
                                            DEACTIVATION CAUSED                 DEACTIVATION CAUSED
                                            BY CARD WITHDRAWAL                    BY SHORT CIRCUIT
Figure 6. Behavior of PRES_, OFF_, CMDVCC, and VCC_
             OFF_
            PRES_
             RST_
             CLK_
               I/O_
              VCC_
                                t10              t12       t13  t14         t15
                                                     tDE
Figure 7. Emergency Deactivation Sequence (Card Extraction)
www.maximintegrated.com                                                                        Maxim Integrated │ 14


DS8005                                                                                      Smart Card Interface
Stop Mode (Low-Power Mode)                                    internal 220μs (typ) power-up delay and the 8ms PRES_
A low-power state, stop mode, can be entered by forcing       debounce delay are in effect and OFF_ is asserted to
the CMDVCC, 5V/3V, and 1_8V input pins to a logic-high        allow the internal circuitry to stabilize. This prevents smart
state. Stop mode can only be entered when the smart           card access from occurring after leaving stop mode.
card interface is inactive. In stop mode, all internal analog Figure 8 shows the control sequence for entering and
circuits are disabled. The OFF_ pin follows the status of     exiting stop mode. Note that an in-progress deactivation
the PRES_ pin. To exit stop mode, change the state of         sequence always finishes before the device enters low-
one or more of the three control pins to a logic-low. An      power stop mode.
                     DEACTIVATE INTERFACE
             CMDVCC
                1_8V                            ACTIVATE         DEACTIVATE
                                               STOP MODE         STOP MODE
               5V/3V
                                                                220µs DELAY
                                                                                    8ms DEBOUNCE
          STOP MODE
                                                                              OFF_ ASSERTED TO
                                                                               WAIT FOR DELAY
                OFF_
                               OFF_ FOLLOWS
                             PRES IN STOP MODE
              PRES_
                VCC_
Figure 8. Stop-Mode Sequence
www.maximintegrated.com                                                                                  Maxim Integrated │ 15


DS8005                                                                                        Smart Card Interface
Smart Card Power Select                                          must be exercised when switching from one VCC power
The device supports three smart card VCC voltages: 1.8V,         selection to the other. If both 1_8V and 5V/3V are high
3V, and 5V. The power select is controlled by the 1_8V           with CMDVCC high at the same time, the device enters
and 5V/3V signals as shown in Table 3. The 1_8V signal           stop mode. To avoid accidental entry into stop mode, the
has priority over 5V/3V. When 1_8V is asserted high,             state of 1_8V and 5V/3V must not be changed simulta-
1.8V is applied to VCC when the smart card is active.            neously. A minimum delay of 100ns should be observed
When 1_8V is deasserted, 5V/3V dictates VCC power                between changing the states of 1_8V and 5V/3V. See
range. VCC is 5V if 5V/3V is asserted to a logic-high state,     Figure 9 for the recommended sequence of changing the
and VCC is 3V if 5V/3V is pulled to a logic-low state. Care      VCC range.
Table 3. VCC Select and Operation Mode
        1_8V               5V/3V             CMDVCC          VCC SELECT (V)              CARD INTERFACE STATUS
          0                  0                   0                    3                             Activated
          0                  0                   1                    3                            Inactivated
          0                  1                   0                    5                             Activated
          0                  1                   1                    5                            Inactivated
          1                  0                   0                   1.8                            Activated
          1                  0                   1                   1.8                           Inactivated
          1                  1                   0                   1.8                       Reserved (Activated)
          1                  1                   1                   1.8                  Not Applicable—Stop Mode
          VCC SELECT          1.8V              3V            5V              3V          1.8V          STOP MODE
             CMDVCC
                 1_8V
                5V/3V
Figure 9. Smart Card Power Select
www.maximintegrated.com                                                                                   Maxim Integrated │ 16


DS8005                                                                                      Smart Card Interface
Switching A/B Interfaces                                       without the need for a card deactivation and activation
One of the device’s key features is the ability to manage      sequence.
two card slots at the same time. The multiplexing control      When switching interfaces, the host must reset the con-
signal SEL_AB is used to determine which interface is          trol pins in the same configuration that was last used
active for communication, though it is possible to leave       for that interface. Approximately 78µs after the SEL_AB
both interfaces powered at the same time.                      transition, the device compares its internal state for the
When switching between interfaces, the device preserves        selected interface to the present state of the control pins.
the state of control signals CLKDIV1, CLKDIV2, 1.8V,           If the present state of the control pins does not match the
5V/3V, CMDVCC, and RSTIN by latching the pin states.           previously latched state, the device does not perform the
This allows the now inactive interface to stay powered         switchover correctly and enters an un­known state. This
while the other interface is activated for communication,      means that the host must always record the state of the
and it also allows for fast switching between card interfaces  control pins for the current interface before performing a
                                                               switchover.
                                                                                  REG A           VCCA
               1_8V, 5V/3V, CLKDIV1,                          TRANSPARENT
                                                                 LATCH A         CLKA DIV         CLKA
                   CLKDIV2, RST, I/O
                                                                                                  RSTA, I/OA, GNDA
                             SEL_AB                                  ENA
                                     TRANSITION
                                      SENSOR                                      REG B           VCCB
                                                              TRANSPARENT
                                                                 LATCH B         CLKB DIV         CLKB
                                       DELAY                                                      RSTB, I/OB, GNDB
                                                                     ENA
                                                                                SMART CARD
                                                               1                                  PRESA
                                                                                 STATUS 1
                                OFF
                                                                                SMART CARD
                                                               0                                  PRESB
                                                                                 STATUS 2
                                                               1
                               OFF2
                                                                                DS8005
                                                               0
Figure 10. Switching A/B Interfaces
www.maximintegrated.com                                                                                   Maxim Integrated │ 17


DS8005                                                                                   Smart Card Interface
The following procedure summarizes the procedure when        Application recommendations include the following:
switching from card A to card B, and vice versa:             •  Ensure there is ample ground area around the device
Note: The host must have previously recorded the state          and the connector; place the device very near to the
of the control pins for the card B interface.                   connector; decouple the VDD and VDDA lines sepa-
1)   The host must record the state of the control pins for     rately. These lines are best positioned under the con-
     the card A interface.                                      nector.
2)   Ensure that the control pin configuration does not      •  The device and the host microcontroller must use the
     change state less than 220µs before changing the           same VDD supply. Pins CLKDIV1, CLKDIV2, RSTIN,
     SEL_AB pin.                                                PRES_, I/OIN, 5V/3V, 1_8V, CMDVCC, and OFF are
                                                                referenced to VDD; if pin XTAL1 is to be driven by an
3)   Switch SEL_AB to the desired valued.
                                                                external clock, also reference this pin to VDD.
4)   Within 78µs, the host must restore the control pins
                                                             •  Trace C3 (CLK) should be placed as far as possible
     the state previously recorded for the card B interface.
                                                                from the other traces.
5)   Wait at least 42µs before reconfiguring the control
                                                             •  The trace connecting CGND to C5 (GND) should be
     pins to change card B to a new state.
                                                                straight (the two capacitors on C1 (VCC_) should be
Note that the behavior of the OFF and OFF2 pins is depen-       connected to this ground trace).
dent on the SEL_AB pin. OFF always refers to the active
                                                             •  Avoid ground loops between CGND and GND.
interface, and OFF2 always reports events on the inactive
interface. This allows the device to monitor for card inser- •  Decouple VDDA and VDD separately. If two supplies
tion and removal on both interfaces simultaneously. See         are the same in the application, they should be con-
Figure 10 for details on the behavior of the SEL_AB, OFF,       nected in a star on the main trace
and OFF2 pins with regard to card presence.                  With all these layout precautions, noise should be kept to
                                                             an acceptable level and jitter on C3 (CLK_) should be less
Applications Information                                     than 100ps. Reference layouts are available on request.
Performance can be affected by the layout of the applica-
tion. For example, an additional cross-capacitance of 1pF    Technical Support
between card reader contacts C2 (RST_) and C3 (CLK_)         For technical support, go to https://support.maximinte-
or C2 (RST_) and C7 (I/O_) can cause contact C2 to be        grated.com/micro.
polluted with high-frequency noise from C3 (or C7). In
this case, include a 100pF capacitor between contacts
C2 and CGND.
www.maximintegrated.com                                                                             Maxim Integrated │ 18


DS8005                                                                                                             Smart Card Interface
Typical Application Circuit
                                                 VDD ≥ 4.9V TO SUPPORT 1.8V, 3.0V, AND 5.0V CARDS.
                                                                              VDD           VDD
                                                                        100nF          100nF
                                                                VDD
                                 33pF             33pF     100nF
                                                                                                                 +3.3V
                                                                        10µF           10µF
                                                                                                                      100kΩ**
                                     XTAL1   XTAL2     GND      VDD GND     VDDA2 GND       VDDA
                                                                                                   PRES
       MAXQ1103                                                                                    VCCA
                           CLKDIV1
                  GPIO
                           CLKDIV2                                                                 RSTA
                     ...      5V/3V                                              INTERFACE A       CLKA                       100nF*   220nF*
                               1_8V                                                                I/OA
                     ...     RSTIN
                           CMDVCC                                              PRESA               CGND
                  GPIO
                               I/OIN
              ISO_DATA
                                                                                                   VCCB
                            SEL_AB
                  GPIO
                                                                                 INTERFACE B       RSTB
                                                                                                   CLKB
                                OFF                                                                                           100nF*   220nF*
                  GPIO                                                                             I/OB
                              OFF2
                  GPIO                                                         PRESB
                                                                                                   PRESB
                                                                  DS8005
                                                                                                                100kΩ**
                                                                                                           +3.3V
           *PLACE A 100nF CAPACITOR CLOSE TO THE DS8005 AND PLACE A 220nF CAPACITOR CLOSE TO CARD CONTACT.
           **SCHEMATIC ASSUMES A NORMALLY CLOSED CONNECTION TO GROUND IN THE SOCKET. INSERTING A CARD BREAKS THE CONNECTION AND PULLS PRES HIGH.
Package Information
For the latest package outline information and land patterns (footprints), go to www.maximintegrated.com/packages. Note that a “+”,
“#”, or “-” in the package code indicates RoHS status only. Package drawings may show a different suffix character, but the drawing
pertains to the package regardless of RoHS status.
         PACKAGE TYPE                           PACKAGE CODE                                  OUTLINE NO.                  LAND PATTERN NO.
                28 SO                                  W28+1                                     21-0042                         90-0109
              28 TSSOP                                 U28+1                                     21-0066                         90-0171
www.maximintegrated.com                                                                                                        Maxim Integrated │ 19


DS8005                                                                                                                      Smart Card Interface
Revision History
 REVISION          REVISION                                                                                                                           PAGES
                                                                              DESCRIPTION
  NUMBER               DATE                                                                                                                         CHANGED
        0              4/10        Initial release                                                                                                        —
                                   Added 28 TSSOP package, clarified function of VDDA and VDDA2 pins, added VDDA2
        1              7/15                                                                                                                         1, 7, 8, 19
                                   pin by passing and clarified default state of PRES pins in Typical Application Circuit
        2              9/17        Updated Switching Interfaces A/B section                                                                             17, 18
For pricing, delivery, and ordering information, please contact Maxim Direct at 1-888-629-4642, or visit Maxim Integrated’s website at www.maximintegrated.com.
Maxim Integrated cannot assume responsibility for use of any circuitry other than circuitry entirely embodied in a Maxim Integrated product. No circuit patent licenses
are implied. Maxim Integrated reserves the right to change the circuitry and specifications without notice at any time. The parametric values (min and max limits)
shown in the Electrical Characteristics table are guaranteed. Other parametric values quoted in this data sheet are provided for guidance.
Maxim Integrated and the Maxim Integrated logo are trademarks of Maxim Integrated Products, Inc.                 © 2017 Maxim Integrated Products, Inc. │ 20


Mouser Electronics
Authorized Distributor
Click to View Pricing, Inventory, Delivery & Lifecycle Information:
Maxim Integrated:
 DS8005-RRX+T
