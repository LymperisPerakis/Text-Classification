                                                                                                    DS2148/DS21Q48
                                                                    5V E1/T1/J1 Line Interface Unit
www.maxim-ic.com
FEATURES                                                                    PIN CONFIGURATION
    Complete E1, T1, or J1 Line Interface Unit                                 TOP VIEW
    (LIU)                                                                                            44
    Supports Both Long- and Short-Haul Trunks
    Internal Software-Selectable Receive-Side                                                  1
    Termination for 75Ω/100Ω/120Ω
                                                                                                            DS2148
    5V Power Supply
    32-Bit or 128-Bit Crystal-Less Jitter
    Attenuator Requires Only a 2.048MHz
    Master Clock for Both E1 and T1 with
    Option to Use 1.544MHz for T1
    Generates the Appropriate Line Build-Outs,                                                            44 TQFP
    With and Without Return Loss, for E1 and
    DSX-1 and CSU Line Build-Outs for T1
    AMI, HDB3, and B8ZS, Encoding/Decoding                                                                DS2148
    16.384MHz, 8.192MHz, 4.096MHz, or
    2.048MHz Clock Output Synthesized to
    Recovered Clock
    Programmable Monitor Mode for Receiver                                                               49 CSBGA
    Loopbacks and PRBS Pattern Generation/                                                             (7mm x 7mm)
    Detection with Output for Received Errors
    Generates/Detects In-Band Loop Codes, 1 to                                 See Section 8 for 144-pin CSBGA pinout.
    16 Bits including CSU Loop Codes
    8-Bit Parallel or Serial Interface with
    Optional Hardware Mode                                                  ORDERING INFORMATION
    Multiplexed and Nonmultiplexed Parallel                                                                       TEMP            PIN-
                                                                                PART           CHANNEL
    Bus Supports Intel or Motorola                                                                                RANGE           PACKAGE
    Detects/Generates Blue (AIS) Alarms                                     DS2148TN            Single        -40°C to +85°C      44 TQFP
    NRZ/Bipolar Interface for Tx/Rx Data I/O                                DS2148TN+           Single        -40°C to +85°C      44 TQFP
    Transmit Open-Circuit Detection                                         DS2148T             Single         0°C to +70°C       44 TQFP
    Receive Carrier Loss (RCL) Indication                                   DS2148T+            Single         0°C to +70°C       44 TQFP
    (G.775)                                                                 DS2148GN            Single        -40°C to +85°C      49 CSBGA
    High-Z State for TTIP and TRING                                         DS2148GN             Single       -40°C to +85°C      49 CSBGA
    50mA (RMS) Current Limiter                                              DS2148G              Single        0°C to +70°C       49 CSBGA
                                                                            DS2148G+             Single        0°C to +70°C       49 CSBGA
                                                                            DS21Q48N              Four        -40°C to +85°C      144 CSBGA
                                                                            DS21Q48               Four         0°C to +70°C       144 CSBGA
                                                                            + Denotes lead-free/RoHS-compliant package.
 Note: Some revisions of this device may incorporate deviations from published specifications known as errata. Multiple revisions of any device
 may be simultaneously available through various sales channels. For information about device errata, click here: www.maxim-ic.com/errata.
                                                          1 of 73                                                               REV: 011206


                                                                                                                                  DS2148/DS21Q48
                                               TABLE OF CONTENTS
1    DETAILED DESCRIPTION .................................................................................................. 5
  1.1   FUNCTION DESCRIPTION..................................................................................................................5
  1.2   DOCUMENT REVISION HISTORY .......................................................................................................6
2    PIN DESCRIPTION............................................................................................................ 10
3    HARDWARE MODE .......................................................................................................... 23
  3.1   REGISTER MAP .............................................................................................................................23
  3.2   PARALLEL PORT OPERATION .........................................................................................................24
  3.3   SERIAL PORT OPERATION..............................................................................................................24
4    CONTROL REGISTERS .................................................................................................... 28
  4.1   DEVICE POWER-UP AND RESET .....................................................................................................31
5    STATUS REGISTERS ....................................................................................................... 34
6    DIAGNOSTICS .................................................................................................................. 39
  6.1 IN-BAND LOOP CODE GENERATION AND DETECTION ......................................................................39
  6.2 LOOPBACKS ..................................................................................................................................43
    6.2.1 Remote Loopback (RLB) ......................................................................................................43
    6.2.2   Local Loopback (LLB) ...........................................................................................................43
    6.2.3   Analog Loopback (ALB) ........................................................................................................44
    6.2.4 Dual Loopback (DLB)............................................................................................................44
  6.3 PRBS GENERATION AND DETECTION ............................................................................................44
  6.4 ERROR COUNTER ..........................................................................................................................44
    6.4.1 Error Counter Update............................................................................................................45
  6.5 ERROR INSERTION ........................................................................................................................45
7    ANALOG INTERFACE ...................................................................................................... 46
  7.1   RECEIVER .....................................................................................................................................46
  7.2   TRANSMITTER ...............................................................................................................................47
  7.3   JITTER ATTENUATOR .....................................................................................................................47
  7.4   G.703 SYNCHRONIZATION SIGNAL .................................................................................................48
8    DS21Q48 QUAD LIU ......................................................................................................... 55
9    DC CHARACTERISTICS ................................................................................................... 59
  9.1   THERMAL CHARACTERISTICS ................................................................................................60
10 AC CHARACTERISTICS ................................................................................................... 61
11 PACKAGE INFORMATION ............................................................................................... 70
  11.1 44-PIN TQFP (56-G4012-001) .....................................................................................................70
  11.2 49-BALL CSGBA (7MM X 7MM) (56-G6006-001) ...........................................................................71
  11.3 144-BALL CSBGA (17MM X 17MM) (56-G6011-001) .....................................................................72
                                                                  2 of 73


                                                                                                                               DS2148/DS21Q48
                                                 LIST OF FIGURES
Figure 1-1. DS2148 Block Diagram ............................................................................................................7
Figure 1-2. Receive Logic...........................................................................................................................8
Figure 1-3. Transmit Logic..........................................................................................................................9
Figure 2-1. Parallel Port Mode Pinout (BIS1 = 0, BIS0 = 1 or 0) (TQFP Package) ..................................21
Figure 2-2. Serial Port Mode Pinout (BIS1 = 1, BIS0 = 0) (TQFP Package) ............................................21
Figure 2-3. Hardware Mode Pinout (BIS1 = 1, BIS0 = 1) (TQFP Package) .............................................22
Figure 3-1. Serial Port Operation for Read Access (R = 1) Mode 1 .........................................................25
Figure 3-2. Serial Port Operation for Read Access Mode 2 .....................................................................25
Figure 3-3. Serial Port Operation for Read Access Mode 3 .....................................................................26
Figure 3-4. Serial Port Operation for Read Access Mode 4 .....................................................................26
Figure 3-5. Serial Port Operation for Write Access (R = 0) Modes 1 and 2..............................................27
Figure 3-6. Serial Port Operation for Write Access (R = 0) Modes 3 and 4..............................................27
Figure 7-1. Basic Interface .......................................................................................................................49
Figure 7-2. Protected Interface Using Internal Receive Termination........................................................50
Figure 7-3. Protected Interface Using External Receive Termination.......................................................51
Figure 7-4. E1 Transmit Pulse Template ..................................................................................................52
Figure 7-5. T1 Transmit Pulse Template ..................................................................................................53
Figure 7-6. Jitter Tolerance ......................................................................................................................54
Figure 7-7. Jitter Attenuation ....................................................................................................................54
Figure 8-1. 144-Pin CSBGA (17mm x 17mm) Pinout ...............................................................................58
Figure 10-1. Intel Bus Read Timing (PBTS = 0, BIS1 = 0, BIS0 = 0) .......................................................62
Figure 10-2. Intel Bus Write Timing (PBTS = 0, BIS1 = 0, BIS0 = 0) .......................................................62
Figure 10-3. Motorola Bus Timing (PBTS = 1, BIS1 = 0, BIS0 = 0)..........................................................63
Figure 10-4. Intel Bus Read Timing (PBTS = 0, BIS1 = 0, BIS0 = 1) .......................................................65
Figure 10-5. Intel Bus Write Timing (PBTS = 0, BIS1 = 0, BIS0 = 1) .......................................................65
Figure 10-6. Motorola Bus Read Timing (PBTS = 1, BIS1 = 0, BIS0 = 1) ................................................66
Figure 10-7. Motorola Bus Write Timing (PBTS = 1, BIS1 = 0, BIS0 = 1) ................................................66
Figure 10-8. Serial Bus Timing (BIS1 = 1, BIS0 = 0) ................................................................................67
Figure 10-9. Receive Side Timing ............................................................................................................68
Figure 10-10. Transmit Side Timing .........................................................................................................69
                                                                3 of 73


                                                                                                                               DS2148/DS21Q48
                                                  LIST OF TABLES
Table 2-1. Bus Interface Selection ...........................................................................................................10
Table 2-2. Pin Assignment in Parallel Port Mode .....................................................................................10
Table 2-3. Pin Descriptions in Parallel Port Mode (Sorted by Pin Name, DS2148T) ...............................12
Table 2-4. Pin Assignment in Serial Port Mode ........................................................................................14
Table 2-5. Pin Descriptions in Serial Port Mode (Sorted by Pin Name, DS2148T) ..................................15
Table 2-6. Pin Assignment in Hardware Mode .........................................................................................17
Table 2-7. Pin Description in Hardware Mode (Sorted by Pin Name, DS2148T) .....................................18
Table 2-8. Loopback Control in Hardware Mode ......................................................................................20
Table 2-9. Transmit Data Control in Hardware Mode ...............................................................................20
Table 2-10. Receive Sensitivity Settings ..................................................................................................20
Table 2-11. Monitor Gain Settings ............................................................................................................20
Table 2-12. Internal Rx Termination Select ..............................................................................................20
Table 2-13. MCLK Selection.....................................................................................................................20
Table 3-1. Register Map ...........................................................................................................................23
Table 4-1. MCLK Selection.......................................................................................................................29
Table 4-2. Receive Sensitivity Settings ....................................................................................................31
Table 4-3. Backplane Clock Select...........................................................................................................32
Table 4-4. Monitor Gain Settings ..............................................................................................................32
Table 4-5. Internal Rx Termination Select ................................................................................................33
Table 5-1. Received Alarm Criteria ..........................................................................................................35
Table 5-2. Receive Level Indication .........................................................................................................38
Table 6-1. Transmit Code Length .............................................................................................................40
Table 6-2. Receive Code Length..............................................................................................................40
Table 6-3. Definition of Received Errors...................................................................................................44
Table 6-4. Function of ECRS Bits and RNEG Pin ....................................................................................45
Table 7-1. Line Build-Out Select for E1 in Register CCR4 (ETS = 0).......................................................48
Table 7-2. Line Build-Out Select for T1 in Register CCR4 (ETS = 1).......................................................48
Table 7-3. Transformer Specifications for 5V Operation ..........................................................................48
Table 8-1. DS21Q48 Pin Assignment.......................................................................................................55
Table 9-1. Recommended DC Operating Conditions ...............................................................................59
Table 9-2. Capacitance ............................................................................................................................59
Table 9-3. DC Characteristics ..................................................................................................................59
Table 9-4. Thermal Characteristics—DS21Q48 CSBGA Package...........................................................60
Table 9-5. Theta-JA (θJA) vs. Airflow ........................................................................................................60
Table 10-1. AC Characteristics—Multiplexed Parallel Port (BIS1 = 0, BIS0 = 0) ....................................61
Table 10-2. AC Characteristics—Nonmultiplexed Parallel Port (BIS1 = 0, BIS0 = 1)..............................64
Table 10-3. AC Characteristics—Serial Port (BIS1 = 1, BIS0 = 0) ...........................................................67
Table 10-4. AC Characteristics—Receive Side ........................................................................................68
Table 10-5. AC Characteristics—Transmit Side .......................................................................................69
                                                                4 of 73


                                                                                             DS2148/DS21Q48
1 DETAILED DESCRIPTION
The DS2148 is a complete selectable E1 or T1 Line Interface Unit (LIU) for short- and long-haul
applications. Throughout the data sheet, J1 is represented wherever T1 exists. Receive sensitivity adjusts
automatically to the incoming signal and can be programmed for 0dB to 12dB or 0dB to 43dB for E1
applications and 0dB to 30dB or 0dB to 36dB for T1 applications. The device can generate the necessary
G.703 E1 waveshapes in 75Ω or 120Ω applications and DSX-1 line built-outs or CSU line built-outs of
0dB, -7.5dB, -15dB, and -22.5dB for T1 applications. The crystal-less onboard jitter attenuator requires
only a 2.048MHz MCLK for both E1 and T1 applications (with the option of using a 1.544MHz MCLK
in T1 applications). The jitter attenuator FIFO is selectable to either 32 bits or 128 bits in depth and can
be placed in either the transmit or receive data paths. An X 2.048MHz output clock synthesized to RCLK
is available for use as a backplane system clock (where n = 1, 2, 4, or 8). The DS2148 has diagnostic
capabilities such as loopbacks and PRBS pattern generation/detection. 16-bit loop-up and loop-down
codes can be generated and detected. The device can be controlled via an 8-bit parallel muxed or
nonmuxed port, serial port or used in hardware mode. The device fully meets all of the latest E1 and T1
specifications including ANSI T1.403-1999, ANSI T1.408, AT&T TR 62411, ITU G.703, G.704, G.706,
G.736, G.775, G.823, I.431, O.151, O.161, ETSI ETS 300 166, JTG.703, JTI.431, JJ-20.1, TBR12,
TBR13, and CTR4.
1.1 Function Description
The analog AMI/HDB3 waveform off the E1 line or the AMI/B8ZS waveform off the T1 line is
transformer coupled into the RTIP and RRING pins of the DS2148. The user has the option to use
internal software-selectable receive-side termination for 75Ω/100Ω/120Ω applications or external
termination. The device recovers clock and data from the analog signal and passes it through the jitter
attenuation MUX outputting the received line clock at RCLK and bipolar or NRZ data at RPOS and
RNEG. The DS2148 contains an active filter that reconstructs the analog-received signal for the nonlinear
losses that occur in transmission. The receive circuitry also is configurable for various monitor
applications. The device has a usable receive sensitivity of 0dB to -43dB (E1) and 0dB to -36dB (T1),
which allows the device to operate on 0.63mm (22AWG) cables up to 2.5km (E1) and 6k feet (T1) in
length. Data input at TPOS and TNEG is sent via the jitter attenuation MUX to the waveshaping circuitry
and line driver. The DS2148 will drive the E1 or T1 line from the TTIP and TRING pins via a coupling
transformer. The line driver can handle both CEPT 30/ISDN-PRI lines for E1 and long-haul (CSU) or
short-haul (DSX-1) lines for T1.
                                                    5 of 73


                                                                                         DS2148/DS21Q48
1.2 Document Revision History
1)  100Ω/60Ω termination reversed in Internal Rx Termination Select tables, 091799.
2)  Add DS21Q48 pinout, 092899.
3)  Correct VSM pin number in Q48 (12 x 12 BGA) from G5 to G4, 120699.
4)  Add timing diagram for Status Register (write access mode); Add mechanical dimensions for the
    quad version, 032900.
5) Timing diagram for Status Register (write access mode) added; elaboration on burst mode bit; add
    mechanical dimensions for the quad version, 050300.
6) Changes to datasheet to indicate 5V only part, 011801.
7) Added supply current measurement; added thermal characteristics of quad package, 092001.
8) Corrected typos and removed instances of 3V operation, 082504.
9) In Absolute Maximum Ratings, changed the spec for soldering temperature from IPC/JEDEC J-STD-
    020A to J-STD-020; defined the storage temperature range as –55°C to +125°C.
10) Added lead-free packages to Ordering Information table on page 1; updated style of data sheet,
    011206.
                                                 6 of 73


                                                                                                                                                                                                                                                                                                                            DS2148/DS21Q48
Figure 1-1. DS2148 Block Diagram
                                                         VSM                                                                                                                                                                                                                 MCLK
                         VSS                       VDD
                  2              2
                                                                                                                                               JACLK                                         Jitter
                                                                                                                                                                                             Attenuator
                     Power Connections                                                                                                                                                       MUX                                                                        2.048MHz to                          16.384MHz or
                                                                                                                                                                                                                                                                       1.544MHz PLL                          8.192MHz or
                                                                                                                                                                                                                                                                                                             4.096MHz or
                                                                                                                          VCO / PLL
                                                                                                                                                                                                                                                                                                             2.048MHz
                                                                                                                                                                                                                                                                                                                            BPCLK
                                                                                                                                                                                                                                                                                                             Synthesizer
                                                                                                                                                                                                                                                                                              MUX
           Optional                                                                                                       Clock / Data
                                                                                        Peak Detect
   RRING                                                                                                                                                                                                                                                                                                                    RPOS
                                                                                                                                                           Remote Loopback (Dual Mode)
                                                                Filter
                                                                                                                                                                                                                                  Jitter Attenuation
                                                                                                                                                                                                                                                                                                        See Figure 3-2      RCLK
    RTIP   Termination                                                                                                     Recovery                                                                                                                                                                                         RNEG
                                                                                                                                                                                                                                                                            Remote Loopback
                                 Analog Loopback
                                                                                                                                                                                                                                                                                                                            PBEO
                                                                                 Unframed
                                                                                                                                                                                                                  (can be placed in either transmit or receive path)
                                                                                 All Ones
                                                                                                                                                                                              Local Loopback
                                                                                 Insertion
                                                                                                                                                                                                                                                                                                              MUX           RCL/LOTC
                                                                                                                                Wave Shaping
                                                               Line Drivers
                                                                                                                                                                                                                                                                                                                            TPOS
                                                                                                 CSU Filters
   TRING
                                                                                                                                                                                                                                                                                                        See Figure 3-3      TCLK
   TTIP                                                                                                                                                                                                                                                                                                                     TNEG
                                                                                                                                                                                                                                                                                                                            HRST*
    BIS1                                                                                                                                                                                                                                                                                        Control and Test Port
                                               MUX (the Serial, Parallel, and Hardware Interfaces share device pins)                                                                                                                                                                            (routed to all blocks)      TEST
   BIS0
                         Serial Interface                                                                                                                                                        Control and                                                           Hardware
                                                                                                    Parallel Interface                                                                                                                                                 Interface
                                                                                                                                                                                                  Interrupt
                                                                                                                                                                                         8                                                                                          21
                                                                                                                                                    5
                                                         SDO
                                                                                                               RD*(DS*)
                                                                                     WR*(R/W*)
                          SCLK                                                                                                                                    D0 to D7 /
                                                                                                                              ALE(AS)
                                                   SDI                                                                                                                                                  CS*    INT*
                                                                                                                                                A0 to A4
                                                                              PBTS
                                                                                                                                                                 AD0 to AD7
                                                                                                                                                                                              7 of 73


                                                                                                        DS2148/DS21Q48
Figure 1-2. Receive Logic
                                 Clock
                                 Invert                                                                           RCLK
 From           Routed to
 Remote         All Blocks       CCR2.0
 Loopback
                                                                                                                  RPOS
                                                                                                         mux
                                      B8ZS/HDB3             NRZ Data                                              RNEG
                                      Decoder
                                                             BPV/CV/EXZ
                                                                                                        CCR1.6
                                                                                                                  PBEO
                                CCR2.3              All Ones       Loop Code   PRBS
           4 or 8 Zero Detect                       Detector       Detector    Detector
                                    CCR6.2/ RIR1.5
             16 Zero Detect         CCR6.0/
                                    CCR6.1
                                                   SR.4 RIR1.3    SR.6   SR.7  SR.0
                                                                                           mux        CCR6.0
          RIR1.7         RIR1.6
                                                                                        16-Bit Error
                                                                              CCR1.4
                                                                                        Counter (ECR)      rx bd
                                                           8 of 73


                                                                                                               DS2148/DS21Q48
Figure 1-3. Transmit Logic
                  CCR1.6                                                CCR3.3    CCR3.4
                                      CCR2.2
                                                                                                   PRBS Generator
                                                          CCR3.0
                      OR
          CCR3.1      Gate
                                                                               mux            Loop Code Generator
                           1
                                      B8ZS/               Logic
                                      HDB3                Error                                                            TPOS
                                                                                                     OR
                                      Coder               Insert                                     Gate
                                                                                                                           TNEG
           BPV         mux
 To        Insert
 Remote
 Loopback
                           0
                                    0                   0
                                                                                                              Clock        TCLK
                                                 mux                                                          Invert
                                                                                        JACLK
                              mux                       1                               (derived
                                                                                        from                  CCR2.1
           Routed to                             OR                                     MCLK)
           All Blocks                   RCLK     Gate
                                    1
                             CCR1.1                  AND
                                                     Gate
                                                                                    Loss Of Transmit
                                             CCR1.2                                 Clock Detect
                                                    CCR1.0
                                                                                                                tx bd
                                                                 To LOTC Output Pin           SR.5
                                                        9 of 73


                                                                                           DS2148/DS21Q48
2 PIN DESCRIPTION
The DS2148 can be controlled in a parallel port mode, a serial port mode, or a hardware mode (Table 2-1,
Table 2-2, and Table 2-3). The parallel and serial port modes are described in Section 3.2 and 3.3, and the
hardware mode is described below.
Table 2-1. Bus Interface Selection
 BIS1       BIS0      PBTS       BUS INTERFACE TYPE
   0          0         0                Muxed Intel
   0          0         1              Muxed Motorola
   0          1         0              Nonmuxed Intel
   0          1         1           Nonmuxed Motorola
   1          0         -                 Serial Port
   1          1         -                 Hardware
Table 2-2. Pin Assignment in Parallel Port Mode
   DS2148T          DS2148G                              PARALLEL
                                          I/O
    PIN #             PIN#                             PORT MODE
       1                C3                  I                  CS
       2                C2                  I              RD(DS)
       3                B1                  I              WR(R/W)
       4                D2                  I              ALE(AS)
       5                C1                  I                 NA
       6                D3                  I                 NA
       7                D1                I/O                  A4
       8                E1                  I                  A3
       9                F2                  I                  A2
      10                F1                  I                  A1
      11                G1                  I                  A0
      12                E3                I/O              D7/AD7
      13                F3                I/O              D6/AD6
      14                G2                I/O              D5/AD5
      15                F4                I/O              D4/AD4
      16                G3                I/O              D3/AD3
      17                E4                I/O              D2/AD2
      18                G4                I/O              D1/AD1
      19                F5                I/O              D0/AD0
      20                G5                  I                VSM
      21                F6                  -                 VDD
      22                G6                  -                 VSS
      23                E5                I/O                 INT
      24                E6                 O                PBEO
      25                F7                 O             RCL/LOTC
      26                D6                  I                TEST
      27                D5                  I                RTIP
      28                D7                  I               RRING
                                                  10 of 73


                                    DS2148/DS21Q48
DS2148T DS2148G            PARALLEL
                I/O
 PIN #   PIN#            PORT MODE
  29      C6      I           HRST
  30      C7      I          MCLK
  31      B6     O           BPCLK
  32      B7      I           BIS0
  33      A7      I           BIS1
  34      C5     O            TTIP
  35      B5      -            VSS
  36      A6      -            VDD
  37      B4     O           TRING
  38      C4     O            RPOS
  39      A4     O           RNEG
  40      B3     O           RCLK
  41      A3      I           TPOS
  42      B2      I          TNEG
  43      A2      I          TCLK
  44      A1      I           PBTS
                    11 of 73


                                                                                         DS2148/DS21Q48
Table 2-3. Pin Descriptions in Parallel Port Mode (Sorted by Pin Name,
DS2148T)
   NAME       PIN    I/O                                      FUNCTION
     A0        11          Address Bus. In nonmultiplexed bus operation (BIS1 = 0, BIS0 = 1),
     to        to      I   serves as the address bus. In multiplexed bus operation (BIS1 = 0, BIS0 =
     A4         7          0), these pins are not used and should be tied low.
                           Address Latch Enable (Address Strobe). When using the parallel port
                           (BIS1 = 0) in multiplexed bus mode (BIS0 = 0), serves to demultiplex the
  ALE(AS)       4      I
                           bus on a positive-going edge. In nonmultiplexed bus mode (BIS0 = 1),
                           should be tied low.
                           Bus Interface Select Bits 0 & 1. Used to select bus interface option. See
 BIS0/BIS1   32/33     I
                           Table 2-1 for details.
                           Backplane Clock. A 16.384MHz, 8.192MHz, 4.096MHz, or 2.048MHz
  BPCLK        31     O    clock output that is referenced to RCLK selectable via CCR5.7 and
                           CCR5.6. In hardware mode, defaults to 16.384MHz output.
     CS         1      I   Active-Low Chip Select. Must be low to read or write to the device.
  D0/AD0       19          Data Bus/Address/Data Bus. In non-multiplexed bus operation (BIS1 =
     to        to    I/O   0, BIS0 = 1), serves as the data bus. In multiplexed bus operation (BIS1 =
  D7/AD7       12          0, BIS0 = 0), serves as an 8-bit multiplexed address/data bus.
                           Active-Low Hardware Reset. Bringing HRST low will reset the DS2148
   HRST        29      I
                           setting all control bits to their default state of all zeros.
                           Active-Low Interrupt. Flags host controller during conditions and
    INT        23     O    change of conditions defined in the Status Register. Active low, open
                           drain output.
                           Master Clock. A 2.048MHz (±50ppm) clock source with TTL levels is
                           applied at this pin. This clock is used internally for both clock/data
   MCLK        30      I   recovery and for jitter attenuation. Use of a T1 1.544MHz clock source is
                           optional.
                           See Note 1 on clock accuracy at the end of this table.
    NA          -      I   Not Assigned. Should be tied low.
                           PRBS Bit Error Output. The receiver will constantly search for a 215-1 or
                           a 220-1 PRBS depending on the ETS bit setting (CCR1.7). Remains high if
                           out of synchronization with the PRBS pattern. Goes low when
   PBEO        24     O    synchronized to the PRBS pattern. Any errors in the received pattern after
                           synchronization will cause a positive going pulse (with same period as E1
                           or T1 clock) synchronous with RCLK. PRBS bit errors can also be
                           reported to the ECR1 and ECR2 registers by setting CCR6.2 to a logic 1.
                           Parallel Bus Type Select. When using the parallel port (BIS1 = 0), set
                           high to select Motorola bus timing, set low to select Intel bus timing. This
   PBTS        44      I   pin controls the function of the RD(DS), ALE(AS), and WR(R/W) pins. If
                           PBTS = 1 and BIS1 = 0, then these pins assume the Motorola function
                           listed in parenthesis (). In serial port mode, this pin should be tied low.
                           Receive Clock. Buffered recovered clock from the line. Synchronous to
   RCLK        40     O
                           MCLK in absence of signal at RTIP and RRING.
                           Active-Low Read Input (Data Strobe). DS is active low when in
  RD(DS)        2      I   nonmultiplexed, Motorola mode. See the bus timing diagrams in Section
                           10.
                           Receive Carrier Loss/Loss of Transmit Clock. An output which will
                           toggle high during a receive carrier loss (CCR2.7 = 0) or will toggle high
 RCL/LOTC      25     O
                           if the TCLK pin has not been toggled for 5µs ±2µs (CCR2.7 = 1). CCR2.7
                           defaults to logic 0 when in hardware mode.
                                          12 of 73


                                                                                  DS2148/DS21Q48
  NAME      PIN  I/O                                   FUNCTION
                     Receive Negative Data. Updated on the rising edge (CCR2.0 = 0) or the
                     falling edge (CCR2.0 = 1) of RCLK with the bipolar data out of the line
                     interface. Set NRZE (CCR1.6) to a one for NRZ applications. In NRZ
  RNEG       39   O
                     mode, data will be output on RPOS while a received error will cause a
                     positive-going pulse synchronous with RCLK at RNEG. See Section 6.4
                     for details.
                     Receive Positive Data. Updated on the rising edge (CCR2.0 = 0) or the
                     falling edge (CCR2.0 = 1) of RCLK with bipolar data out of the line
                     interface. Set NRZE (CCR1.6) to a one for NRZ applications. In NRZ
   RPOS      38   O
                     mode, data will be output on RPOS while a received error will cause a
                     positive-going pulse synchronous with RCLK at RNEG. See Section 6.2
                     for details.
                     Receive Tip and Ring. Analog inputs for clock recovery circuitry. These
RTIP/RRING 27/28   I
                     pins connect via a 1:1 transformer to the line. See Section 5 for details.
                     Transmit Clock. A 2.048MHz or 1.544MHz primary clock. Used to clock
   TCLK      43    I data through the transmit side formatter. Can be sourced internally by
                     MCLK or RCLK. See Common Control Register 1 and Figure 1-3.
                     Tri-state Control. Set high to tri-state all outputs and I/O pins (including
   TEST      26    I the parallel control port). Set low for normal operation. Useful in board
                     level testing.
                     Transmit Negative Data. Sampled on the falling edge (CCR2.1 = 0) or
   TNEG      42    I the rising edge (CCR2.1 = 1) of TCLK for data to be transmitted out onto
                     the line.
                     Transmit Positive Data. Sampled on the falling edge (CCR2.1 = 0) or the
   TPOS      41    I rising edge (CCR2.1 = 1) of TCLK for data to be transmitted out onto the
                     line.
                     Transmit Tip and Ring. Analog line driver outputs. These pins connect
TTIP/TRING 34/37  O
                     via a step-up transformer to the line. See Section 5 for details.
    VDD    21/36   - 5.0V ±5% Positive Supply
    VSM      20    I Voltage Supply Mode. Should be tied high for 5V operation
     VSS   22/35   - Signal Ground
    WR               Active-Low Write Input (Read/Write). See the bus timing diagrams in
             3     I
   (R/W)             Section 10.
                                    13 of 73


                                                     DS2148/DS21Q48
Table 2-4. Pin Assignment in Serial Port Mode
  DS2148T       DS2148G                      SERIAL
                              I/O
   PIN #         PIN#                     PORT MODE
     1            C3            I                CS
     2            C2            I               NA
     3            B1            I               NA
     4            D2            I               NA
     5            C1            I             SCLK
     6            D3            I               SDI
     7            D1          I/O              SDO
     8            E1            I              ICES
     9            F2            I             OCES
    10            F1            I               NA
    11            G1            I               NA
    12            E3          I/O               NA
    13            F3          I/O               NA
    14            G2          I/O               NA
    15            F4          I/O               NA
    16            G3          I/O               NA
    17            E4          I/O               NA
    18            G4          I/O               NA
    19            F5          I/O               NA
    20            G5            I              VSM
    21            F6            -               VDD
    22            G6            -               VSS
    23            E5          I/O               INT
    24            E6           O              PBEO
    25            F7           O            RCL/LOTC
    26            D6            I              TEST
    27            D5            I              RTIP
    28            D7            I             RRING
    29            C6            I             HRST
    30            C7            I             MCLK
    31            B6           O             BPCLK
    32            B7            I              BIS0
    33            A7            I              BIS1
    34            C5           O               TTIP
    35            B5            -               VSS
    36            A6            -               VDD
    37            B4           O              TRING
    38            C4           O              RPOS
    39            A4           O              RNEG
    40            B3           O              RCLK
    41            A3            I              TPOS
    42            B2            I             TNEG
    43            A2            I             TCLK
    44            A1            I               NA
                                    14 of 73


                                                                                         DS2148/DS21Q48
Table 2-5. Pin Descriptions in Serial Port Mode (Sorted by Pin Name,
DS2148T)
  NAME        PIN    I/O                                     FUNCTION
                           Bus Interface Select Bits 0 & 1. Used to select bus interface option. See
 BIS0/BIS1   32/33     I
                           Table 2-1 for details.
                           Backplane Clock. A 16.384MHz, 8.192MHz, 4.096MHz, or 2.048MHz
  BPCLK        31     O    clock output that is referenced to RCLK selectable via CCR5.7 and
                           CCR5.6. In hardware mode, defaults to 16.384MHz output.
     CS         1      I   Active-Low Chip Select. Must be low to read or write to the device.
                           Hardware Reset. Bringing HRST low will reset the DS2148 setting all
   HRST        29      I
                           control bits to their default state of all zeros.
                           Input Clock Edge Select. Selects whether the serial port data input (SDI)
   ICES         8      I
                           is sampled on rising (ICES =0) or falling edge (ICES = 1) of SCLK.
                           Active-Low Interrupt. Flags host controller during conditions and change
    INT        23     O
                           of conditions defined in the Status Register. Active low, open drain output.
                           Master Clock. A 2.048MHz (±50ppm) clock source with TTL levels is
                           applied at this pin. This clock is used internally for both clock/data
  MCLK         30      I
                           recovery and for jitter attenuation. Use of a T1 1.544MHz clock source is
                           optional. See Note 1 on clock accuracy at the end of this table.
    NA          -      I   Not Assigned. Should be tied low.
                           Output Clock Edge Select. Selects whether the serial port data output
   OCES         9      I   (SDO) is valid on the rising (OCES = 1) or falling edge (OCES = 0) of
                           SCLK.
                           PRBS Bit Error Output. The receiver will constantly search for a 215-1
                           or a 220-1 PRBS depending on the ETS bit setting (CCR1.7). Remains
                           high if out of synchronization with the PRBS pattern. Goes low when
   PBEO        24     O    synchronized to the PRBS pattern. Any errors in the received pattern after
                           synchronization will cause a positive going pulse (with same period as E1
                           or T1 clock) synchronous with RCLK. PRBS bit errors can also be
                           reported to the ECR1 and ECR2 registers by setting CCR6.2 to a logic 1.
                           Receive Clock. Buffered recovered clock from the line. Synchronous to
   RCLK        40     O
                           MCLK in absence of signal at RTIP and RRING.
                           Receive Carrier Loss/Loss of Transmit Clock. An output which will
                           toggle high during a receive carrier loss (CCR2.7 = 0) or will toggle high
 RCL/LOTC      25     O
                           if the TCLK pin has not been toggled for 5 µs ± 2 µs (CCR2.7 = 1).
                           CCR2.7 defaults to logic 0 when in hardware mode.
                           Receive Negative Data. Updated on the rising edge (CCR2.0 = 0) or the
                           falling edge (CCR2.0 = 1) of RCLK with the bipolar data out of the line
                           interface. Set NRZE (CCR1.6) to a one for NRZ applications. In NRZ
   RNEG        39     O
                           mode, data will be output on RPOS while a received error will cause a
                           positive-going pulse synchronous with RCLK at RNEG. See Section 6.4
                           for details.
                           Receive Positive Data. Updated on the rising edge (CCR2.0 = 0) or the
                           falling edge (CCR2.0 = 1) of RCLK with bipolar data out of the line
                           interface. Set NRZE (CCR1.6) to a one for NRZ applications. In NRZ
   RPOS        38     O
                           mode, data will be output on RPOS while a received error will cause a
                           positive-going pulse synchronous with RCLK at RNEG. See Section 6.4
                           for details.
                           Receive Tip and Ring. Analog inputs for clock recovery circuitry. These
RTIP/RRING   27/28     I
                           pins connect via a 1:1 transformer to the line. See Section 5 for details.
   SCLK         5      I   Serial Clock. Serial bus clock input.
                                          15 of 73


                                                                                  DS2148/DS21Q48
  NAME      PIN  I/O                                   FUNCTION
                     Serial Data Input. Sampled on rising edge (ICES = 0) or the falling edge
    SDI       6    I
                     (ICES = 1) of SCLK.
                     Serial Data Output. Valid on the falling edge (OCES = 0) or the rising
    SDO      7    O
                     edge (OCES = 1) of SCLK.
                     Transmit Clock. A 2.048 MHz or 1.544 MHz primary clock. Used to
   TCLK      43    I clock data through the transmit side formatter. Can be sourced internally
                     by MCLK or RCLK. See Common Control Register 1 and Figure 1-3.
                     Tri-State Control. Set high to tri-state all outputs and I/O pins (including
   TEST      26    I the parallel control port). Set low for normal operation. Useful in board
                     level testing.
                     Transmit Negative Data. Sampled on the falling edge (CCR2.1 = 0) or
   TNEG      42    I the rising edge (CCR2.1 = 1) of TCLK for data to be transmitted out onto
                     the line.
                     Transmit Positive Data. Sampled on the falling edge (CCR2.1 = 0) or the
   TPOS      41    I rising edge (CCR2.1 = 1) of TCLK for data to be transmitted out onto the
                     line.
                     Transmit Tip and Ring . Analog line driver outputs. These pins connect
TTIP/TRING 34/37  O
                     via a step-up transformer to the line. See Section 5 for details.
    VDD    21/36   - 5.0V ±5% Positive Supply
   VSM       20    I Voltage Supply Mode. Should be tied high for 5V operation.
     VSS   22/35   - Signal Ground
                                    16 of 73


                                                  DS2148/DS21Q48
Table 2-6. Pin Assignment in Hardware Mode
  DS2148T       DS2148G                 HARDWARE
                              I/O
   PIN #         PIN#                      MODE
     1            C3            I            EGL
     2            C2            I             ETS
     3            B1            I           NRZE
     4            D2            I          SCLKE
     5            C1            I              L2
     6            D3            I              L1
     7            D1          I/O              L0
     8            E1            I            DJA
     9            F2            I          JAMUX
    10            F1            I             JAS
    11            G1            I            HBE
    12            E3          I/O            CES
    13            F3          I/O            TPD
    14            G2          I/O             TX0
    15            F4          I/O             TX1
    16            G3          I/O          LOOP0
    17            E4          I/O          LOOP1
    18            G4          I/O            MM0
    19            F5          I/O            MM1
    20            G5            I            VSM
    21            F6            -             VDD
    22            G6            -             VSS
    23            E5          I/O             RT1
    24            E6           O            PBEO
    25            F7           O             RCL
    26            D6            I            TEST
    27            D5            I            RTIP
    28            D7            I          RRING
    29            C6            I           HRST
    30            C7            I           MCLK
    31            B6           O           BPCLK
    32            B7            I            BIS0
    33            A7            I            BIS1
    34            C5           O             TTIP
    35            B5            -             VSS
    36            A6            -             VDD
    37            B4           O            TRING
    38            C4           O            RPOS
    39            A4           O            RNEG
    40            B3           O            RCLK
    41            A3            I            TPOS
    42            B2            I           TNEG
    43            A2            I           TCLK
    44            A1            I             RT0
                                  17 of 73


                                                                                           DS2148/DS21Q48
Table 2-7. Pin Description in Hardware Mode (Sorted by Pin Name, DS2148T)
   NAME     PIN   I/O                                       FUNCTION
                       Bus Interface Select Bits 0 & 1. Used to select bus interface option. BIS0 = 1
 BIS0/BIS1 32/33    I
                       and BIS1 = 1 selects hardware mode.
  BPCLK      31    O   Backplane Clock. 16.384MHz output.
                       Receive & Transmit Clock Edge Select. Selects which RCLK edge to update
                       RPOS and RNEG and which TCLK edge to sample TPOS and TNEG.
                       0 = update RNEG/RPOS on rising edge of RCLK; sample TPOS/TNEG on
    CES      12     I
                       falling edge of TCLK
                       1 = update RNEG/RPOS on falling edge of RCLK; sample TPOS/TNEG on
                       rising edge of TCLK
                       Disable Jitter Attenuator
    DJA       8     I  0 = jitter attenuator enabled
                       1 = jitter attenuator disabled
                       Receive Equalizer Gain Limit. This pin controls the sensitivity of the receive
                       equalizer.
                       EGL E1 (ETS = 0)
                       0 = -12dB (short haul)
    EGL       1     I
                       1 = -43dB (long haul)
                       EGL T1 (ETS = 1)
                       0 = -36dB (long haul)
                       1 = -30dB (limited long haul)
                       E1/T1 Select.
    ETS       2     I  0 = E1
                       1 = T1
                       Receive & Transmit HDB3/B8ZS Enable.
    HBE      11     I  0 = enable HDB3 (E1)/B8ZS (T1)
                       1 = disable HDB3 (E1)/B8ZS (T1)
   HRST      29     I  Hardware Reset. Bringing HRST low will reset the DS2148.
                       Jitter Attenuator MUX. Controls the source for JACLK. See Figure 1-1 and
                       Table 2-13.
                          E1 (ETS = 0)           JAMUX
  JAMUX       9     I  MCLK = 2.048MHz              0
                          T1 (ETS = 1)
                       MCLK = 2.048MHz              1
                       MCLK = 1.544MHz              0
                       Jitter Attenuator Select
    JAS      10     I  0 = place the jitter attenuator on the receive side
                       1 = place the jitter attenuator on the transmit side
                       Transmit LIU Waveshape Select Bits 0 & 1 [H/W Mode]. These inputs
 L0/L1/L2   7/6/5   I
                       determine the waveshape of the transmitter. See Table 7-1 and Table 7-2.
  LOOP0/               Loopback Select Bits 0 & 1 [H/W Mode]. These inputs determine the active
           16/17    I
  LOOP1                loopback mode (if any). See Table 2-8.
                       Master Clock. A 2.048MHz (±50ppm) clock source with TTL levels is applied
                       at this pin. This clock is used internally for both clock/data recovery and for jitter
   MCLK      30     I  attenuation. Use of a T1 1.544MHz clock source is optional. G.703 requires an
                       accuracy of ±50ppm for both T1 and E1. TR62411 and ANSI specs require an
                       accuracy of ±32ppm for T1 interfaces.
                       Monitor Mode Select Bits 0 & 1 [H/W Mode]. These inputs determine if the
MM0/MM1    18/19    I
                       receive equalizer is in a monitor mode. See Table 2-11.
    NA        -     I  Not Assigned. Should be tied low.
                                             18 of 73


                                                                                                                 DS2148/DS21Q48
    NAME            PIN        I/O                                           FUNCTION
                                        NRZ Enable [H/W Mode]
                                        0 = Bipolar data at RPOS/RNEG and TPOS/TNEG
    NRZE              3          I
                                        1 = NRZ data at RPOS and TPOS or TNEG; RNEG outputs a positive going
                                        pulse when device receives a BPV, CV, or EXZ.
                                        PRBS Bit Error Output. The receiver will constantly search for a QRSS (T1)
                                        or a 215-1 (E1) PRBS depending on whether T1 or E1 mode is selected. Remains
                                        high if out of synchronization with the PRBS pattern. Goes low when
    PBEO             24         O
                                        synchronized to the PRBS pattern. Any errors in the received pattern after
                                        synchronization will cause a positive going pulse (with same period as E1 or T1
                                        clock) synchronous with RCLK.
                                        Receive Clock. Buffered recovered clock from the line. Synchronous to MCLK
    RCLK             40         O
                                        in absence of signal at RTIP and RRING.
                                        Receive Carrier Loss. An output which will toggle high during a receive carrier
     RCL             25         O
                                        loss.
                                        Receive Negative Data. Updated on the rising edge (CES = 0) or the falling
                                        edge (CES = 1) of RCLK with the bipolar data out of the line interface. Set
    RNEG             39         O       NRZE to a one for NRZ applications. In NRZ mode, data will be output on
                                        RPOS while a received error will cause a positive-going pulse synchronous with
                                        RCLK at RNEG. See Section 6.4 for details.
                                        Receive Positive Data. Updated on the rising edge (CES = 0) or the falling edge
                                        (CES = 1) of RCLK with bipolar data out of the line interface. Set NRZE pin to a
    RPOS             38         O       one for NRZ applications. In NRZ mode, data will be output on RPOS while a
                                        received error will cause a positive-going pulse synchronous with RCLK at
                                        RNEG. See Section 6.4 for details.
                                        Receive LIU Termination Select Bits 0 & 1 [H/W Mode]. These inputs
  RT0/RT1          44/23         I
                                        determine the receive termination. See Table 2-12.
     RTIP/                              Receive Tip and Ring. Analog inputs for clock recovery circuitry. These pins
                   27/28         I
    RRING                               connect via a 1:1 transformer to the line. See Section 5 for details.
                                        Receive & Transmit Synchronization Clock Enable.
   SCLKE              4          I      0 = disable 2.048MHz synchronization transmit and receive mode
                                        1 = enable 2.048MHz synchronization transmit and receive mode
                                        Transmit Clock. A 2.048MHz or 1.544MHz primary clock. Used to clock data
    TCLK             43          I
                                        through the transmit side formatter.
                                        Tri-State Control. Set high to tri-state all outputs and I/O pins (including the
     TEST            26          I
                                        parallel control port). Set low for normal operation. Useful in board level testing.
                                        Transmit Negative Data. Sampled on the falling edge (CES = 0) or the rising
    TNEG             42          I      edge (CES = 1) of TCLK for data to be transmitted out onto the line.
                                        Transmit Power-Down
      TPD            13          I      0 = normal transmitter operation
                                        1 = powers down the transmitter and tri-states the TTIP and TRING pins
                                        Transmit Positive Data. Sampled on the falling edge (CES = 0) or the rising
     TPOS            41          I
                                        edge (CES = 1) of TCLK for data to be transmitted out onto the line.
     TTIP/                              Transmit Tip and Ring. Analog line driver outputs. These pins connect via a
                   34/37        O
    TRING                               step-up transformer to the line. See Section 5 for details.
                                        Transmit Data Source Select Bits 0 & 1 [H/W Mode]. These inputs determine
  TX0/TX1          14/15         I
                                        the source of the transmit data. See Table 2-9.
      VDD          21/36         -      5.0V ±5% Positive Supply
     VSM             20          I      Voltage Supply Mode. Should be tied high for 5V operation
      VSS          22/35         -      Signal Ground
Note 1: G.703 requires an accuracy of ±50ppm for both T1 and E1. TR62411 and ANSI specs require an accuracy of ±32ppm for T1
interfaces.
                                                              19 of 73


                                                                                    DS2148/DS21Q48
Table 2-8. Loopback Control in Hardware Mode
     LOOPBACK              SYMBOL          CONTROL BIT               LOOP1           LOOP0
 Remote Loopback              RLB               CCR6.6                   1              1
 Local Loopback               LLB               CCR6.7                   1              0
 Analog Loopback              ALB               CCR6.4                   0              1
 No Loopback                   –                    –                    0              0
Table 2-9. Transmit Data Control in Hardware Mode
                                                         CONTROL
         TRANSMIT DATA                    SYMBOL                              TX1        TX0
                                                              BIT
 Transmit Unframed All Ones                 TUA1            CCR3.7             1           1
 Transmit Alternating Ones and Zeros        TAOZ            CCR3.5             1           0
 Transmit PRBS                             TPRBSE           CCR3.4             0           1
 TPOS and TNEG                                –                –               0           0
Table 2-10. Receive Sensitivity Settings
          EGL                          ETS                   RECEIVE SENSITIVITY
        (CCR4.4)                    (CCR1.7)
            0                         0 (E1)              -12dB (short haul)
            1                         0 (E1)              -43dB (long haul)
            1                         1 (T1)              -30dB (limited long haul)
            0                         1 (T1)              -36dB (long haul)
Table 2-11. Monitor Gain Settings
     MM1            MM0           INTERNAL LINEAR
  (CCR5.5)        (CCR5.4)         GAIN BOOST (dB)
       0              0         Normal operation (no boost)
       0              1                      20
       1              0                      26
       1              1                      32
Table 2-12. Internal Rx Termination Select
     RT1             RT0                INTERNAL RECEIVE
  (CCR5.1)        (CCR5.0)      TERMINATION CONFIGURATION
       0              0        Internal receive-side termination disabled
       0              1        Internal receive-side 120Ω enabled
       1              0        Internal receive-side 100Ω enabled
       1              1        Internal receive-side 75Ω enabled
Table 2-13. MCLK Selection
                     JAMUX             ETS
    MCLK
                    (CCR1.3)        (CCR1.7)
   2.048MHz             0                0
   2.048MHz             1                1
   1.544MHz             0                1
                                                20 of 73


                                                                                                                                                                                                                                                          DS2148/DS21Q48
Figure 2-1. Parallel Port Mode Pinout (BIS1 = 0, BIS0 = 1 or 0) (TQFP
Package)
                                       44 PBTS           43 TCLK          42 TNEG          41 TPOS          40 RCLK          39 RNEG          38 RPOS           37 TRING
                                                                                                                                                                                  36 VDD             35 VSS         34 TTIP
                     1 CS*                                                                                                                                                                                                      BIS1 33 tie low
                     2 RD (DS)                                                                                                                                                                                                  BIS0 32 tie low (MUX) or high (non-MUX)
                     3 WR* (R/W*)                                                                                                                                                                                             BPCLK 31
                     4 ALE (AS)                                                                                                                                                                                                MCLK 30
                     5 NA                                                                        DS2148                                                                                                                       HRST* 29
                                                                                               Parallel Port
                     6 NA                                                                                                                                                                                                     RRING 28
                                                                                                Operation
                     7 A4                                                                                                                                                                                                       RTIP 27
                                                                                      (Note: tie all NA pins low)
                     8 A3                                                                                                                                                                                                      TEST 26
                     9 A2                                                                                                                                                                                           RCL/LOTC 25
                     10 A1                                                                                                                                                                                                     PBEO 24
                                       AD7/D7 12         AD6/D6 13        AD5/D5 14        AD4/D4 15        AD3/D3 16        AD2/D2 17        AD1/D1 18         AD0/D0 19
                     11 A0                                                                                                                                                                                                      INT* 23
                                                                                                                                                                                  VSM 20             VDD 21         VSS 22
                                                                                                                                                                                 tie high
Figure 2-2. Serial Port Mode Pinout (BIS1 = 1, BIS0 = 0) (TQFP Package)
                             tie low
                             44 PBTS           43 TCLK          42 TNEG          41 TPOS          40 RCLK          39 RNEG          38 RPOS          37 TRING
                                                                                                                                                                       36 VDD           35 VSS            34 TTIP
                   1 CS*                                                                                                                                                                                                      BIS1 33   tie high
                   2 NA                                                                                                                                                                                                       BIS0 32   tie low
                   3 NA                                                                                                                                                                                             BPCLK 31
                   4 NA                                                                                                                                                                                                MCLK 30
                   5 SCLK                                                                   DS2148                                                                                                                     HRST* 29
                                                                                           Serial Port
                   6 SDI                                                                                                                                                                                              RRING 28
                                                                                           Operation
                   7 SDO                                                                                                                                                                                                  RTIP 27
                                                                             (Note: tie all NA pins low)
                   8 ICES                                                                                                                                                                                               TEST 26
                   9 OCES                                                                                                                                                                               RCL/LOTC 25
                   10 NA                                                                                                                                                                                               PBEO 24
                   11 NA                                                                                                                                                                                                      INT* 23
                             NA 12             NA 13            NA 14            NA 15            NA 16            NA 17            NA 18            NA 19             VSM 20               VDD 21        VSS 22
                                                                                                                                                                      tie high
                                                                                                                    21 of 73


                                                                                                                                                                        DS2148/DS21Q48
Figure 2-3. Hardware Mode Pinout (BIS1 = 1, BIS0 = 1) (TQFP Package)
                          44 RT0
                                   43 TCLK   42 TNEG   41 TPOS    40 RCLK    39 RNEG    38 RPOS   37 TRING
                                                                                                              36 VDD           35 VSS   34 TTIP
               1 EG L                                                                                                                              BIS1 33   tie high
               2 ET S                                                                                                                              BIS0 32   tie high
               3 NRZE                                                                                                                             BPCLK 31
               4 SCLKE                                                                                                                            M CLK 30
               5 L2                                               D S2148                                                                         HRST* 29
                                                                 H ardware
               6 L1                                                                                                                               RRING 28
                                                                 Operation
               7 L0                                                                                                                                RTIP 27
               8 DJA                                                                                                                               TEST 26
               9 JAM UX                                                                                                                             RCL 25
               10 JAS                                                                                                                             PBEO 24
               11 HBE                                                                                                                               RT1 23
                                                                  LOOP0 16   LOOP1 17   MM0 18    MM1 19
                                                                                                             VSM 20 tie high
                          CES 12   TPD 13    TX0 14    TX1 15                                                                  VDD 21   VSS 22
                                                                              22 of 73


                                                                                                 DS2148/DS21Q48
3 HARDWARE MODE
In hardware mode (BIS1 = 1, BIS0 = 1), pins 1-19, 23, 25, 31, and 44 are redefined to be used for
initializing the DS2148. BPCLK (pin 31) defaults to a 16.384MHz output when in hardware mode. The
RCL/LOTC (pin 25) is designated to RCL when in hardware mode. JABDS (CCR4.2) defaults to logic 0.
The RHBE (CCR2.3) and THBE (CCR2.2) control bits are combined and controlled by HBE at pin 11
while the RSCLKE (CCR5.3) and TSCLKE (CCR5.2) bits are combined and controlled by SCLKE at
pin 4. TCES (CCR2.1) and RCES (CCR2.0) are combined and controlled by CES at pin 12. The
transmitter functions are combined and controlled by TX1 (pin 15) and TX0 (pin 14). LOOP1 (pin 17)
and LOOP0 (pin 16) control the loopback functions. All other control bits default to the logic 0 setting.
3.1 Register Map
Table 3-1. Register Map
                                                                                                SERIAL PORT
                                                                            PARALLEL                MODE
   NAME                       REGISTER NAME                     R/W
                                                                           PORT MODE              (Notes 2–5)
                                                                                                 (msb)     (lsb)
    CCR1         Common Control Register 1                      R/W               00h             B000 000A
    CCR2         Common Control Register 2                      R/W               01h             B000 001A
    CCR3         Common Control Register 3                      R/W               02h             B000 010A
    CCR4         Common Control Register 4                      R/W               03h             B000 011A
    CCR5         Common Control Register 5                      R/W               04h             B000 100A
    CCR6         Common Control Register 6                      R/W               05h             B000 101A
      SR         Status Register                                  R               06h             B000 110A
     IMR         Interrupt Mask Register                        R/W               07h             B000 111A
    RIR1         Receive Information Register 1                   R               08h             B001 000A
    RIR2         Receive Information Register 2                   R               09h             B001 001A
    IBCC         In-Band Code Control Register                  R/W               0Ah             B001 010A
    TCD1         Transmit Code Definition Register 1            R/W               0Bh             B001 011A
    TCD2         Transmit Code Definition Register 2            R/W               0Ch             B001 100A
  RUPCD1         Receive Up Code Definition Register 1          R/W               0Dh             B001 101A
  RUPCD2         Receive Up Code Definition Register 2          R/W               0Eh             B001 110A
  RDNCD1         Receive Down Code Definition Register 1        R/W               0Fh             B001 111A
  RDNCD2         Receive Down Code Definition Register 2        R/W               10h             B010 000A
    ECR1         Error Count Register 1                           R               11h             B010 001A
    ECR2         Error Count Register 2                           R               12h             B010 010A
   TEST1         Test 1                                         R/W               13h             B010 011A
   TEST2         Test 2                                         R/W               14h             B010 100A
   TEST3         Test 3                                         R/W               15h             B010 101A
       –                               –                          –             Note 1                  –
NOTES:
1) Register addresses 16h to 1Fh do not exist.
2) In the Serial Port Mode, the LSB is on the right hand side.
3) In the Serial Port Mode, data is read and written LSB first.
4) In the Serial Port Mode, the A bit (the LSB) determines whether the access is a read (A = 1) or a write
     (A = 0).
5) In the Serial Port Mode, the B bit (the MSB) determines whether the access is a burst access (B = 1) or a single
     register access (B = 0).
                                                      23 of 73


                                                                                                DS2148/DS21Q48
3.2 Parallel Port Operation
When using the parallel interface on the DS2148 (BIS1 = 0) the user has the option for either multiplexed
bus operation (BIS1 = 0, BIS0 = 0) or nonmultiplexed bus operation (BIS1 = 0, BIS0 = 1). The DS2148
can operate with either Intel or Motorola bus timing configurations. If the PBTS pin is tied low, Intel
timing will be selected; if tied high, Motorola timing will be selected. All Motorola bus signals are listed
in parentheses. See the timing diagrams in Section 10 for more details.
3.3 Serial Port Operation
Setting BIS1 = 1 and BIS0 = 0 enables the serial bus interface on the DS2148. Port read/write timing is
unrelated to the system transmit and receive timing, allowing asynchronous reads or writes by the host.
See Section 10 for the AC timing of the serial port. All serial port accesses are LSB first. See Figure 3-1,
Figure 3-2, Figure 3-3, and Figure 3-4 for more details.
Reading or writing to the internal registers requires writing one address/command byte prior to
transferring register data. The first bit written (LSB) of the address/command byte specifies whether the
access is a read (1) or a write (0). The next 5 bits identify the register address. Bit 7 is reserved and must
be set to 0 for proper operation.
The last bit (MSB) of the address/command byte is the burst mode bit. When the burst bit is enabled
(B = 1) and a READ operation is performed, addresses 0 through 15h are read sequentially, starting at
address 0h. And when the burst bit is enabled and a WRITE operation is performed, addresses 0 through
16h are written sequentially, starting at address 0h. Burst operation is stopped once address 15h is read.
See Figure 3-5 and Figure 3-6 for more details.
All data transfers are initiated by driving the CS input low. When input clock-edge select (ICES) is low,
input data is latched on the rising edge of SCLK and when ICES is high, input data is latched on the
falling edge of SCLK. When output clock-edge select (OCES) is low, data is output on the falling edge of
SCLK and when OCES is high, data is output on the rising edge of SCLK. Data is held until the next
falling or rising edge. All data transfers are terminated if the CS input transitions high. Port control logic
is disabled and SDO is tri-stated when CS is high.
                                                    24 of 73


                                                                                                                                 DS2148/DS21Q48
 Figure 3-1. Serial Port Operation for Read Access (R = 1) Mode 1
 ICES = 1 (sample SDI on the falling edge of SCLK)
 OCES = 1 (update SDO on rising edge of SCLK)
SCLK       1         2     3     4     5     6     7      8       9        10       11       12       13       14       15       16
CS
SDI
             1       A0    A1    A2    A3    A4     0      B
       (lsb)                                             (msb)
           READ ACCESS ENABLED
  SDO
                                                                  D0       D1       D2       D3       D4       D5       D6       D7
                                                                  (lsb)                                                        (msb)
 Figure 3-2. Serial Port Operation for Read Access Mode 2
 ICES = 1 (sample SDI on the falling edge of SCLK)
 OCES = 0 (update SDO on falling edge of SCLK)
   SCLK        1        2     3     4     5     6     7       8       9       10       11       12       13       14       15       16
   CS
   SDI
                1       A0    A1    A2    A3    A4     0       B
               (lsb)                                        (msb)
   SDO
                                                                        D0       D1       D2       D3       D4       D5       D6       D7
                                                                        (lsb)                                                        (msb)
                                                                 25 of 73


                                                                                                                        DS2148/DS21Q48
 Figure 3-3. Serial Port Operation for Read Access Mode 3
 ICES = 0 (sample SDI on the rising edge of SCLK)
 OCES = 0 (update SDO on falling edge of SCLK)
  SCLK          1       2       3      4      5     6       7       8        9    10    11    12    13    14    15       16
  CS
  SDI
            1        A0      A1     A2     A3    A4     0        B
          (lsb)                                               (msb)
  SDO
                                                                      D0       D1    D2    D3    D4    D5    D6     D7
                                                                      (lsb)                                       (msb)
 Figure 3-4. Serial Port Operation for Read Access Mode 4
 ICES = 0 (sample SDI on the rising edge of SCLK)
 OCES = 1 (update SDO on rising edge of SCLK)
SCLK         1        2       3      4     5     6     7        8      9       10    11    12    13   14    15   16
CS
SDI
        1         A0      A1     A2     A3    A4     0      B
      (lsb)                                               (msb)
SDO
                                                                        D0     D1    D2    D3    D4    D5   D6    D7
                                                                       (lsb)                                    (msb)
                                                             D0
                                                                        26 of 73


                                                                                                                             DS2148/DS21Q48
 Figure 3-5. Serial Port Operation for Write Access (R = 0) Modes 1 and 2
 ICES = 1 (sample SDI on the falling edge of SCLK)
SCLK         1      2     3     4     5     6     7         8         9        10      11     12     13     14      15       16
CS
  SDI
               0    A0    A1    A2    A3    A4     0         B        DO        D1     D2     D3     D4      D5      D6       D7
         (lsb)                                            (msb)       (lsb)                                                (msb)
           WRITE ACCESS ENABLED
  SDO
 Figure 3-6. Serial Port Operation for Write Access (R = 0) Modes 3 and 4
 ICES = 0 (sample SDI on the rising edge of SCLK)
SCLK     1        2     3     4     5     6     7       8         9         10      11     12     13     14      15       16
CS
SDI
         0       A0    A1    A2    A3    A4    0       B        DO          D1     D2     D3     D4     D5      D6       D7
   (lsb)                                             (msb)      (lsb)                                                  (msb)
     WRITE ACCESS ENABLED
  SDO
                                                                   27 of 73


                                                                           DS2148/DS21Q48
4 CONTROL REGISTERS
CCR1 (00H): COMMON CONTROL REGISTER 1
 (MSB)                                                                           (LSB)
  ETS     NRZE     RCLA   ECUE         JAMUX           TTOJ        TTOR        LOTCMC
  SYMBOL       POSITION DESCRIPTION
     ETS        CCR1.7  E1/T1 Select.
                        0 = E1
                        1 = T1
    NRZE        CCR1.6  NRZ Enable.
                        0 = Bipolar data at RPOS/RNEG and TPOS/TNEG
                        1 = NRZ data at RPOS and TPOS or TNEG; RNEG outputs a
                        positive going pulse when device receives a BPV, CV, or EXZ.
                        See Figure 1-2 and Figure 1-3.
    RCLA        CCR1.5  Receive Carrier Loss Alternate Criteria.
                        0 = RCL declared upon 255 (E1) or 192 (T1) consecutive zeros
                        1 = RCL declared upon 2048 (E1) or 1544 (T1) consecutive
                        zeros
    ECUE        CCR1.4  Error Counter Update Enable. A 0 to 1-transition forces the
                        next clock cycle to load the error counter registers with the
                        latest counts and reset the counters. The user must wait a
                        minimum of two clocks cycles (976ns for E1 and 1296ns for
                        T1) before reading the error count registers to allow for a proper
                        update. See Section 4 and Figure 1-2 for details.
   JAMUX        CCR1.3  Jitter Attenuator MUX. Controls the source for JACLK. See
                        Figure 1-1.
                        0 = JACLK sourced from MCLK (2.048MHz or 1.544MHz at
                        MCLK)
                        1 = JACLK sourced from internal PLL (2.048MHz at MCLK)
    TTOJ        CCR1.2  TCLK to JACLK. Internally connects TCLK to JACLK. See
                        Figure 1-3.
                        0 = disabled
                        1 = enabled
    TTOR        CCR1.1  TCLK to RCLK. Internally connects TCLK to RCLK. See
                        Figure 1-3.
                        0 = disabled
                        1 = enabled
  LOTCMC        CCR1.0  Loss Of Transmit Clock Mux Control. Determines whether
                        the transmit logic should switch to JACLK if the TCLK input
                        should fail to transition. See Figure 1-3.
                        0 = do not switch to JACLK if TCLK stops
                        1 = switch to JACLK if TCLK stops
                                28 of 73


                                                                                DS2148/DS21Q48
Table 4-1. MCLK Selection
                 JAMUX         ETS
   MCLK
                (CCR1.3)   (CCR1.7)
  2.048MHz          0            0
  2.048MHz          1            1
  1.544MHz          0            1
CCR2 (01H): COMMON CONTROL REGISTER 2
 (MSB)                                                                                (LSB)
  P25S      N/A       SCLD    CLDS            RHBE       THBE           TCES          RCES
   SYMBOL         POSITION  DESCRIPTION
     P25S          CCR2.7   Pin 25 Select. Forced to logic 0 in hardware mode.
                            0 = toggles high during a Receive Carrier Loss condition
                            1 = toggles high if TCLK does not transition for at least 5µs.
       -           CCR2.6   Not Assigned. Should be set to zero when written to.
     SCLD          CCR2.5   Short Circuit Limit Disable (ETS = 0). Controls the 50mA
                            (RMS) current limiter.
                            0 = enable 50mA current limiter
                            1 = disable 50mA current limiter
     CLDS          CCR2.4   Custom Line Driver Select. Setting this bit to a one will
                            redefine the operation of the transmit line driver. When this bit
                            is set to a one and CCR4.5 = CCR4.6 = CCR4.7 = 0, then the
                            device will generate a square wave at the TTIP and TRING
                            outputs instead of a normal waveform. When this bit is set to a
                            one and CCR4.5 = CCR4.6 = CCR4.7 ≠ 0, then the device will
                            force TTIP and TRING outputs to become open drain drivers
                            instead of their normal push-pull operation. This bit should be
                            set to zero for normal operation of the device. Contact the
                            factory for more details on how to use this bit.
     RHBE          CCR2.3   Receive HDB3/B8ZS Enable. See Figure 1-2.
                            0 = enable HDB3 (E1)/B8ZS (T1)
                            1 = disable HDB3 (E1)/B8ZS (T1)
     THBE          CCR2.2   Transmit HDB3/B8ZS Enable. See Figure 1-3.
                            0 = enable HDB3 (E1)/B8ZS (T1)
                            1 = disable HDB3 (E1)/B8ZS (T1)
     TCES          CCR2.1   Transmit Clock Edge Select. Selects which TCLK edge to
                            sample TPOS and TNEG. See Figure 1-3.
                            0 = sample TPOS and TNEG on falling edge of TCLK
                            1 = sample TPOS and TNEG on rising edge of TCLK
     RCES          CCR2.0   Receive Clock Edge Select. Selects which RCLK edge to
                            update RPOS and RNEG. See Figure 1-2.
                            0 = update RPOS and RNEG on rising edge of RCLK
                            1 = update RPOS and RNEG on falling edge of RCLK
                                      29 of 73


                                                                                 DS2148/DS21Q48
CCR3 (02H): COMMON CONTROL REGISTER 3
 (MSB)                                                                                  (LSB)
 TUA1    ATUA1     TAOZ      TPRBSE           TLCE         LIRST           IBPV          IBE
 SYMBOL      POSITION   DESCRIPTION
   TUA1       CCR3.7    Transmit Unframed All Ones. The polarity of this bit is set such
                        that the device will transmit an all ones pattern on power-up or
                        device reset. This bit must be set to a one to allow the device to
                        transmit data. The transmission of this data pattern is always timed
                        off of the JACLK (See Figure 1-1).
                        0 = transmit all ones at TTIP and TRING
                        1 = transmit data normally
  ATUA1       CCR3.6    Automatic Transmit Unframed All Ones. Automatically transmit
                        an unframed all ones pattern at TTIP and TRING during a receive
                        carrier loss (RCL) condition or a receive all ones condition.
                        0 = disabled
                        1 = enabled
   TAOZ       CCR3.5    Transmit Alternate Ones and Zeros. Transmit a …101010…
                        pattern at TTIP and TRING. The transmission of this data pattern is
                        always timed off of TCLK (See Figure 1-1).
                        0 = disabled
                        1 = enabled
  TPRBSE      CCR3.4    Transmit PRBS Enable. Transmit a 215 - 1 (E1) or a 220 - 1 (T1)
                        PRBS at TTIP and TRING. See Figure 1-3.
                        0 = disabled
                        1 = enabled
   TLCE       CCR3.3    Transmit Loop Code Enable. Enables the transmit side to
                        transmit the loop up code in the Transmit Code Definition registers
                        (TCD1 and TCD2). See Section 4 and Figure 1-3 for details.
                        0 = disabled
                        1 = enabled
   LIRST      CCR3.2    Line Interface Reset. Setting this bit from a zero to a one will
                        initiate an internal reset that resets the clock recovery state machine
                        and re-centers the jitter attenuator. Normally this bit is only toggled
                        on power-up. Must be cleared and set again for a subsequent reset.
   IBPV       CCR3.1    Insert BPV. A 0 to 1 transition on this bit will cause a single
                        Bipolar Violation (BPV) to be inserted into the transmit data
                        stream. Once this bit has been toggled from a 0 to a 1, the device
                        waits for the next occurrence of three consecutive ones to insert the
                        BPV. This bit must be cleared and set again for a subsequent error
                        to be inserted. See Figure 1-3.
    IBE       CCR3.0    Insert Bit Error. A 0 to 1 transition on this bit will cause a single
                        logic error to be inserted into the transmit data stream. This bit
                        must be cleared and set again for a subsequent error to be inserted.
                        See Figure 1-3.
                                      30 of 73


                                                                                             DS2148/DS21Q48
4.1 Device Power-Up and Reset
The DS2148 will reset itself upon power-up, setting all writeable registers to 00h and clearing the status
and information registers. CCR3.7 (TUA1) = 0 results in the LIU transmitting unframed all ones. After
the power supplies have settled following power-up, initialize all control registers to the desired settings,
then toggle the LIRST bit (CCR3.2). The DS2148 can be reset at anytime to the default settings by
bringing HRST (pin 29) low (level triggered) or by powering down and powering up again.
CCR4 (03H): COMMON CONTROL REGISTER 4
   (MSB)                                                                                           (LSB)
    L2           L1            L0          EGL              JAS        JABDS          DJA           TPD
    SYMBOL             POSITION          DESCRIPTION
        L2               CCR4.7          Line Build-Out Select Bit 2. Sets the transmitter build out
                                         (Table 7-1 for E1 and Table 7-2 for T1)
        L1               CCR4.6          Line Build-Out Select Bit 1. Sets the transmitter build out
                                         (Table 7-1 for E1 and Table 7-2 for T1)
        L0               CCR4.5          Line Build-Out Select Bit 0. Sets the transmitter build out
                                         (Table 7-1 for E1 and Table 7-2 for T1)
       EGL               CCR4.4          Receive Equalizer Gain Limit. This bit controls the sensitivity
                                         of the receive equalizer (Table 4-2).
       JAS               CCR4.3          Jitter Attenuator Select.
                                         0 = place the jitter attenuator on the receive side
                                         1 = place the jitter attenuator on the transmit side
     JABDS               CCR4.2          Jitter Attenuator Buffer Depth Select.
                                         0 = 128 bits
                                         1 = 32 bits (use for delay sensitive applications)
       DJA               CCR4.1          Disable Jitter Attenuator.
                                         0 = jitter attenuator enabled
                                         1 = jitter attenuator disabled
       TPD               CCR4.0          Transmit Power-Down.
                                         0 = normal transmitter operation
                                         1 = powers down the transmitter and tri-states the TTIP and
                                         TRING pins
Table 4-2. Receive Sensitivity Settings
    EGL             ETS
                                 RECEIVE SENSITIVITY
  (CCR4.4)       (CCR1.7)
      0            0 (E1)       -12dB (short haul)
      1            0 (E1)       -43dB (long haul)
      1            1 (T1)       -30dB (limited long haul)
      0            1 (T1)       -36dB (long haul)
                                                   31 of 73


                                                                                 DS2148/DS21Q48
CCR5 (04H): COMMON CONTROL REGISTER 5
  (MSB)                                                                                 (LSB)
  BPCS1     BPCS0     MM1          MM0          RSCLKE       TSCLKE         RT1           RT0
  SYMBOL      POSITION   DESCRIPTION
    BPCS1      CCR5.7    Backplane Clock Select 1. See Table 4-3 for details.
    BPCS0      CCR5.6    Backplane Clock Select 0. See Table 4-3 for details.
    MM1        CCR5.5    Monitor Mode 1. See Table 4-4.
    MM0        CCR5.4    Monitor Mode 0. See Table 4-4.
  RSCLKE       CCR5.3    Receive Synchronization Clock Enable. This control bit determines
                         whether the line receiver should handle normal T1/E1 signals or a
                         synchronized signal.
                         E1 mode:
                         0 = receive normal E1 signal (Section 6 of G.703)
                         1 = receive 2.048 MHz synchronization signal (Section 10 of G.703)
                         T1 mode:
                         0 = receive normal T1 signal
                         1 = receive 1.544 MHz synchronization signal
   TSCLKE      CCR5.2    Transmit Synchronization Clock Enable. This control bit determines
                         whether the transmitter should transmit normal T1/E1 signals or a
                         synchronized signal.
                         E1 mode:
                         0 = transmit normal E1 signal (Section 6 of G.703)
                         1 = transmit 2.048 MHz synchronization signal (Section 10 of G.703)
                         T1 mode:
                         0 = transmit normal T1 signal
                         1 = transmit 1.544 MHz synchronization signal
     RT1       CCR5.1    Receive Termination 1. See Table 4-5 for details.
     RT0       CCR5.0    Receive Termination 0. See Table 4-5 for details.
Table 4-3. Backplane Clock Select
  BPCS1      BPCS0         BPCLK
 (CCR5.7)   (CCR5.6)   FREQUENCY
     0         0         16.384MHz
     0         1          8.192MHz
     1         0          4.096MHz
     1         1          2.048MHz
Table 4-4. Monitor Gain Settings
   MM1        MM0       INTERNAL LINEAR GAIN
 (CCR5.5)   (CCR5.4)             BOOST (dB)
     0         0          Normal operation (no boost)
     0         1                      20
     1         0                      26
     1         1                      32
                                          32 of 73


                                                                                        DS2148/DS21Q48
Table 4-5. Internal Rx Termination Select
   RT1         RT0                 INTERNAL RECEIVE
(CCR5.1)     (CCR5.0)      TERMINATION CONFIGURATION
     0          0       Internal receive-side termination disabled
     0          1       Internal receive-side 120Ω enabled
     1          0       Internal receive-side 100Ω enabled
     1          1       Internal receive-side 75Ω enabled
CCR6 (05H): COMMON CONTROL REGISTER 6
  (MSB)                                                                                       (LSB)
   LLB       RLB      ARLBE          ALB             RJAB        ECRS2         ECRS1          ECRS0
 SYMBOL       POSITION    DESCRIPTION
    LLB        CCR6.7     Local Loopback. In Local Loopback (LLB), transmit data will be
                          looped back to the receive path passing through the jitter attenuator if it
                          is enabled. Data in the transmit path will act as normal. See Figure 1-1
                          and Section 6.2.2 for details.
                          0 = loopback disabled
                          1 = loopback enabled
    RLB        CCR6.6     Remote Loopback. In Remote Loopback (RLB), data output from the
                          clock/data recovery circuitry will be looped back to the transmit path
                          passing through the jitter attenuator if it is enabled. Data in the receive
                          path will act as normal while data presented at TPOS and TNEG will be
                          ignored. See Figure 1-1 and Section 6.2.1 for details.
                          0 = loopback disabled
                          1 = loopback enabled
  ARLBE        CCR6.5     Automatic Remote Loopback Enable and Reset. When this bit is set
                          high, the device will automatically go into remote loopback when it
                          detects loop-up code programmed into the receive loop-up code
                          definition registers (RUPCD1 and RUPCD2) for a minimum of 5
                          seconds and it will also set the RIR2.1 status bit. Once in a RLB state, it
                          will remain in this state until it has detected the loop code programmed
                          into the receive loop-down code definition registers (RDNCD1 and
                          RDNCD2) for a minimum of 5 seconds at which point it will force the
                          device out of RLB and clear RIR2.1. Toggling this bit from a 1 to a 0
                          can reset the automatic RLB circuitry. The action of the automatic
                          remote loopback circuitry is logically ORed with the RLB (CCR6.6)
                          control bit (i.e., either one can cause a RLB to occur).
    ALB        CCR6.4     Analog Loopback. In analog loopback (ALB), signals at TTIP and
                          TRING will be internally connected to RTIP and RRING. The incoming
                          signals, from the line, at RTIP and RRING will be ignored. The signals
                          at TTIP and TRING will be transmitted as normal. See Figure 1-1 and
                          Section 6.2.3 for more details.
                          0 = loopback disabled
                          1 = loopback enabled
                                             33 of 73


                                                                                              DS2148/DS21Q48
 SYMBOL           POSITION         DESCRIPTION
    RJAB            CCR6.3         RCLK Jitter Attenuator Bypass. This control bit allows the recovered
                                   received clock and data to bypass the jitter attenuation while still
                                   allowing the BPCLK output to use the jitter attenuator. See Figure 1-1
                                   and Section 7.1 for details.
                                   0 = disabled
                                   1 = enabled
   ECRS2            CCR6.2         Error Count Register Select 2. See Section 6.4 for details.
   ECRS1            CCR6.1         Error Count Register Select 1. See Section 6.4 for details.
   ECRS0            CCR6.0         Error Count Register Select 0. See Section 6.4 for details.
5 STATUS REGISTERS
There are three registers that contain information on the current real-time status of the device, status
register (SR), and receive information registers 1 and 2 (RIR1/RIR2). When a particular event has
occurred (or is occurring), the appropriate bit in one of these three registers will be set to a one. Some of
the bits in SR, RIR1, and RIR2 are latched bits and some are real-time bits. The register descriptions
below list which status bits are latched and which are real-time bits. For latched status bits, when an event
or an alarm occurs the bit is set to a one and will remain set until the user reads that bit. The bit will be
cleared when it is read and it will not be set again until the event has occurred again. Two of the latched
status bits (RUA1 & RCL) will remain set after reading if the alarm is still present.
The user will always precede a read of any of the three status registers with a write. The byte written to
the register will inform the DS2148 which bits the user wishes to read and have cleared. The user will
write a byte to one of these registers with a one in the bit positions to be read and a zero in the other bit
positions. When a one is written to a bit location, that location will be updated with the latest information.
When a zero is written to a bit position, that bit position will not be updated and the previous value will
be held. A write to the status and information registers will be immediately followed by a read of the
same register. The read result should be logically ANDed with the mask byte that was just written and
this value should be written back into the same register to ensure that bit does indeed clear. This second
write step is necessary because the alarms and events in the status registers occur asynchronously with
respect to their access via the parallel port. This write-read-write scheme allows an external
microcontroller or microprocessor to individually poll certain bits without disturbing the other bits in the
register. This operation is key in controlling the DS2148 with higher-order software languages.
The bits in the SR register have the unique ability to initiate a hardware interrupt via the INT output pin.
Each of the alarms and events in the SR can be either masked or unmasked from the interrupt pin via the
interrupt mask register (IMR). The interrupts caused by the RCL, RUA1, and LOTC bits in SR act
differently than the interrupts caused by the other status bits in SR. The RCL, RUA1 and LOTC bits will
force the INT pin low whenever they change state (i.e., go active or inactive). The INT pin will be
allowed to return high (if no other interrupts are present) when the user reads the alarm bit that caused the
interrupt to occur even if the alarm is still present. The other status bits in SR can force the INT pin low
when they are set. The INT pin will be allowed to return high (if no other interrupts are present) when the
user reads the event bit that caused the interrupt to occur.
                                                    34 of 73


                                                                                           DS2148/DS21Q48
Table 5-1. Received Alarm Criteria
   ALARM               E1/T1                SET CRITERIA                      CLEAR CRITERIA
                                    Less than two zeros in two          More than two zeros in two
    RUA1                 E1
                                    frames (512 bits)                   frames (512 bits)
                                    Over a 3ms window, five or less     Over a 3ms window, six or more
    RUA1                 T1
                                    zeros are received                  zeros are received
                                    255 (or 2048)2 consecutive zeros    In 255 bit times, at least 32 ones
     RCL1                E1         received                            are received
                                    (G.775)
                                    192 (or 1544)2 consecutive zeros    14 or more ones out of 112
          1                         are received                        possible bit positions are
     RCL                 T1
                                                                        received starting with the first
                                                                        one received
NOTES:
1) Receive carrier loss (RCL) is also known as loss-of-signal (LOS) or Red Alarm in T1.
2) See CCR1.5 for details.
SR (06H): STATUS REGISTER
  (MSB)                                                                                            (LSB)
   LUP         LDN          LOTC           RUA1            RCL        TCLE          TOCD          PRBSD
   SYMBOL               POSITION         DESCRIPTION
       LUP                 SR.7          Loop Up Code Detected. Set when the loop up code defined in
    (latched)                            registers RUPCD1 and RUPCD2 is being received. See Section
                                         4 for details.
      LDN                  SR.6          Loop Down Code Detected. Set when the loop down code
    (latched)                            defined in registers RDNCD1 and RDNCD2 is being received.
                                         See Section 4 for details.
      LOTC                 SR.5          Loss of Transmit Clock. Set when the TCLK pin has not
   (real time)                           transitioned for 5µsec (±2µsec). Will force the LOTC pin high.
      RUA1                 SR.4          Receive Unframed All Ones. Set when an unframed all ones
    (latched)                            code is received at RRING and RTIP. See Table 5-1 for details.
       RCL                 SR.3          Receive Carrier Loss. Set when a receive carrier loss condition
    (latched)                            exists at RRING and RTIP. See Table 5-1 for details.
      TCLE                 SR.2          Transmit Current Limit Exceeded. Set when the 50mA
   (real time)                           (RMS) current limiter is activated whether the current limiter is
                                         enabled or not.
     TOCD                  SR.1          Transmit Open Circuit Detect. Set when the device detects
   (real time)                           that the TTIP and TRING outputs are open circuited.
     PRBSD                 SR.0          PRBS Detect. Set when the receive-side detects a 215-1 (E1) or
   (real time)                           a 220-1 (T1) Pseudo Random Bit Sequence (PRBS).
                                                  35 of 73


                                                                 DS2148/DS21Q48
IMR (07H): INTERRUPT MASK REGISTER
  (MSB)                                                                (LSB)
   LUP      LDN     LOTC  RUA1             RCL    TCLE      TOCD      PRBSD
   SYMBOL       POSITION DESCRIPTION
      LUP         IMR.7  Loop Up Code Detected.
                         0 = interrupt masked
                         1 = interrupt enabled
      LDN         IMR.6  Loop Down Code Detected.
                         0 = interrupt masked
                         1 = interrupt enabled
     LOTC         IMR.5  Loss of Transmit Clock.
                         0 = interrupt masked
                         1 = interrupt enabled
     RUA1         IMR.4  Receive Unframed All Ones.
                         0 = interrupt masked
                         1 = interrupt enabled
      RCL         IMR.3  Receive Carrier Loss.
                         0 = interrupt masked
                         1 = interrupt enabled
     TCLE         IMR.2  Transmit Current Limiter Exceeded.
                         0 = interrupt masked
                         1 = interrupt enabled
     TOCD         IMR.1  Transmit Open Circuit Detect.
                         0 = interrupt masked
                         1 = interrupt enabled
    PRBSD         IMR.0  PRBS Detection.
                         0 = interrupt masked
                         1 = interrupt enabled
                                  36 of 73


                                                                              DS2148/DS21Q48
RIR1 (08H): RECEIVE INFORMATION REGISTER 1
 (MSB)                                                                              (LSB)
  ZD         16ZD     HBD    RCLC          RUA1C         JALT          N/A           N/A
  SYMBOL          POSITION DESCRIPTION
      ZD           RIR1.7  Zero Detect. Set when a string of at least four (ETS = 0) or
   (latched)               eight (ETS = 1) consecutive zeros (regardless of the length of
                           the string) have been received. Will be cleared when read.
     16ZD          RIR1.6  Sixteen Zero Detect. Set when at least 16 consecutive zeros
   (latched)               (regardless of the length of the string) have been received. Will
                           be cleared when read.
     HBD           RIR1.5  HDB3/B8ZS Word Detect. Set when an HDB3 (ETS = 0) or
   (latched)               B8ZS (ETS = 1) code word is detected independent of whether
                           the receive HDB3/B8ZS mode (CCR4.6) is enabled. Will be
                           cleared when read. Useful for automatically setting the line
                           coding.
     RCLC          RIR1.4  Receive Carrier Loss Clear. Set when the RCL alarm has met
   (latched)               the clear criteria defined in Error! Reference source not
                           found.. Will be cleared when read.
   RUA1C           RIR1.3  Receive Unframed All Ones Clear. Set when the unframed all
   (latched)               ones signal is no longer detected. Will be cleared when read.
                           See Error! Reference source not found..
     JALT          RIR1.2  Jitter Attenuator Limit Trip. Set when the jitter attenuator
   (latched)               FIFO reaches to within 4 bits of its useful limit. Will be cleared
                           when read. Useful for debugging jitter attenuation operation.
      N/A          RIR1.1  Not Assigned. Could be any value when read.
      N/A          RIR1.0  Not Assigned. Could be any value when read.
                                    37 of 73


                                                                                  DS2148/DS21Q48
RIR2 (09H): RECEIVE INFORMATION REGISTER 2
 (MSB)                                                                                  (LSB)
  RL3           RL2     RL1        RL0            N/A           N/A        ARLB          SEC
  SYMBOL            POSITION    DESCRIPTION
       RL3           RIR2.7     Receive Level Bit 3. See Table 5-2.
   (real time)
       RL2           RIR2.6     Receive Level Bit 2. See Table 5-2.
   (real time)
       RL1           RIR2.5     Receive Level Bit 1. See Table 5-2.
   (real time)
       RL0           RIR2.4     Receive Level Bit 0. See Table 5-2.
   (real time)
       N/A           RIR2.3     Not Assigned. Could be any value when read.
       N/A           RIR2.2     Not Assigned. Could be any value when read.
     ARLB            RIR2.1     Automatic Remote Loopback Detected. This bit will be set to
   (real time)                  a one when the automatic Remote Loopback (RLB) circuitry
                                has detected the presence of a loop up code for 5 seconds. It
                                will remain set until the automatic RLB circuitry has detected
                                the loop down code for 5 seconds. See Section 4 for more
                                details. This bit will be forced low when the automatic RLB
                                circuitry is disabled (CCR6.5 = 0).
       SEC           RIR2.0     One-Second Timer. This bit will be set to a one on one-second
    (latched)                   boundaries as timed by the device based on the RCLK. It will
                                be cleared when read.
Table 5-2. Receive Level Indication
                                       RECEIVE LEVEL
 RL3          RL2    RL1     RL0
                                                (dB)
   0           0      0       0                 < -2.5
   0           0      0       1              -2.5 to -5.0
   0           0      1       0              -5.0 to -7.5
   0           0      1       1             -7.5 to -10.0
   0           1      0       0            -10.0 to -12.5
   0           1      0       1            -12.5 to -15.0
   0           1      1       0            -15.0 to -17.5
   0           1      1       1            -17.5 to -20.0
   1           0      0       0            -20.0 to -22.5
   1           0      0       1            -22.5 to -25.0
   1           0      1       0            -25.0 to -27.5
   1           0      1       1            -27.5 to -30.0
   1           1      0       0            -30.0 to -32.5
   1           1      0       1            -32.5 to -35.0
   1           1      1       0            -35.0 to -37.5
   1           1      1       1                > -37.5
                                         38 of 73


                                                                                            DS2148/DS21Q48
6 DIAGNOSTICS
6.1 In-Band Loop Code Generation and Detection
The DS2148 can generate and detect a repeating bit pattern that is from one to eight or sixteen bits in
length. To transmit a pattern, the user will load the pattern to be sent into the Transmit Code Definition
(TCD1 and TCD2) registers and select the proper length of the pattern by setting the TC0 and TC1 bits in
the In-Band Code Control (IBCC) register. When generating a 1, 2, 4, 8, or 16 bit pattern both the
transmit code registers (TCD1 and TCD2) must be filled with the proper code. Generation of a 1, 3, 5, or
7-bit pattern only requires TCD1 to be filled. Once this is accomplished, the pattern will be transmitted as
long as the TLCE control bit (CCR3.3) is enabled. As an example, if the user wished to transmit the
standard “loop up” code for Channel Service Units which is a repeating pattern of ...10000100001... then
80h would be loaded into TCD1 and the length would set using TC1 and TC0 in the IBCC register to 5
bits.
The DS2148 can detect two separate repeating patterns to allow for both a loop-up code and a loop-down
code to be detected. The user will program the codes to be detected in the Receive Up Code Definition
(RUPCD1 and RUPCD2) registers and the Receive Down Code Definition (RDNCD1 and RDNCD2)
registers and the length of each pattern will be selected via the IBCC register. The DS2148 will detect
repeating pattern codes with bit error rates as high as 1x10-2. The code detector has a nominal integration
period of 48ms, hence, after about 48ms of receiving either code, the proper status bit (LUP at SR.7 and
LDN at SR.6) will be set to a one. Normally codes are sent for a period of 5 seconds. It is recommended
that the software poll the DS2148 every 100ms to 1000ms until 5 seconds has elapsed to ensure that the
code is continuously present.
IBCC (0AH): IN–BAND CODE CONTROL REGISTER
   (MSB)                                                                                          (LSB)
    TC1          TC0          RUP2          RUP1          RUP0        RDN2          RDN1          RDN0
    SYMBOL               POSITION          DESCRIPTION
        TC1                IBCC.7          Transmit Code Length Definition Bit 1. See Table 6-1.
        TC0                IBCC.6          Transmit Code Length Definition Bit 0. See Table 6-1.
       RUP2                IBCC.5          Receive Up Code Length Definition Bit 2. See Table 6-2.
       RUP1                IBCC.4          Receive Up Code Length Definition Bit 1. See Table 6-2.
       RUP0                IBCC.3          Receive Up Code Length Definition Bit 0. See Table 6-2.
       RDN2                IBCC.2          Receive Down Code Length Definition Bit 2. See Table 6-2.
       RDN1                IBCC.1          Receive Down Code Length Definition Bit 1. See Table 6-2.
       RDN0                IBCC.0          Receive Down Code Length Definition Bit 0. See Table 6-2.
                                                   39 of 73


                                                                                  DS2148/DS21Q48
Table 6-1. Transmit Code Length
              LENGTH SELECTED
TC1    TC0
                    (BITS)
 0      0              5
 0      1             6/3
 1      0              7
 1      1          16/8/4/2/1
Table 6-2. Receive Code Length
                                                  LENGTH
RUP2/RDN2    RUP1/RDN1      RUP0/RDN0           SELECTED
                                                   (BITS)
     0           0              0                     1
     0           0              1                     2
     0           1              0                     3
     0           1              1                     4
     1           0              0                     5
     1           0              1                     6
     1           1              0                     7
     1           1              1                    16/8
TCD1 (0BH): TRANSMIT CODE DEFINITION REGISTER 1
 (MSB)                                                                                 (LSB)
   C7        C6         C5          C4             C3      C2              C1            C0
  SYMBOL         POSITION        DESCRIPTION
      C7           TCD1.7        Transmit Code Definition Bit 7. First bit of the repeating
                                 pattern.
      C6           TCD1.6        Transmit Code Definition Bit 6.
      C5           TCD1.5        Transmit Code Definition Bit 5.
      C4           TCD1.4        Transmit Code Definition Bit 4.
      C3           TCD1.3        Transmit Code Definition Bit 3.
      C2           TCD1.2        Transmit Code Definition Bit 2. A Don’t Care if a 5-bit
                                 length is selected.
      C1           TCD1.1        Transmit Code Definition Bit 1. A Don’t Care if a 5 or 6 bit
                                 length is selected.
      C0           TCD1.0        Transmit Code Definition Bit 0. A Don’t Care if a 5, 6 or 7
                                 bit length is selected.
                                          40 of 73


                                                                          DS2148/DS21Q48
TCD2 (0CH): TRANSMIT CODE DEFINITION REGISTER 2
 (MSB)                                                                         (LSB)
  C15      C14     C13     C12             C11     C10            C9             C8
  SYMBOL       POSITION  DESCRIPTION
     C15        TCD2.7   Transmit Code Definition Bit 15
     C14        TCD2.6   Transmit Code Definition Bit 14
     C13        TCD2.5   Transmit Code Definition Bit 13
     C12        TCD2.4   Transmit Code Definition Bit 12
     C11        TCD2.3   Transmit Code Definition Bit 11
     C10        TCD2.2   Transmit Code Definition Bit 10
      C9        TCD2.1   Transmit Code Definition Bit 9
      C8        TCD2.0   Transmit Code Definition Bit 8
RUPCD1 (0DH): RECEIVE UP CODE DEFINITION REGISTER 1
 (MSB)                                                                         (LSB)
  C7       C6       C5      C4             C3      C2             C1             C0
  SYMBOL       POSITION  DESCRIPTION
      C7       RUPCD1.7  Receive Up Code Definition Bit 7. First bit of the repeating
                         pattern.
      C6       RUPCD1.6  Receive Up Code Definition Bit 6. A Don’t Care if a 1-bit
                         length is selected.
      C5       RUPCD1.5  Receive Up Code Definition Bit 5. A Don’t Care if a 1 or 2
                         bit length is selected.
      C4       RUPCD1.4  Receive Up Code Definition Bit 4. A Don’t Care if a 1 to 3
                         bit length is selected.
      C3       RUPCD1.3  Receive Up Code Definition Bit 3. A Don’t Care if a 1 to 4
                         bit length is selected.
      C2       RUPCD1.2  Receive Up Code Definition Bit 2. A Don’t Care if a 1 to 5
                         bit length is selected.
      C1       RUPCD1.1  Receive Up Code Definition Bit 1. A Don’t Care if a 1 to 6
                         bit length is selected.
      C0       RUPCD1.0  Receive Up Code Definition Bit 0. A Don’t Care if a 1 to 7
                         bit length is selected.
                                  41 of 73


                                                                        DS2148/DS21Q48
RUPCD2 (0EH): RECEIVE UP CODE DEFINITION REGISTER 2
 (MSB)                                                                        (LSB)
  C15     C14      C13     C12             C11     C10           C9             C8
  SYMBOL       POSITION  DESCRIPTION
     C15       RUPCD2.7  Receive Up Code Definition Bit 15
     C14       RUPCD2.6  Receive Up Code Definition Bit 14
     C13       RUPCD2.5  Receive Up Code Definition Bit 13
     C12       RUPCD2.4  Receive Up Code Definition Bit 12
     C11       RUPCD2.3  Receive Up Code Definition Bit 11
     C10       RUPCD2.2  Receive Up Code Definition Bit 10
      C9       RUPCD2.1  Receive Up Code Definition Bit 9
      C8       RUPCD2.0  Receive Up Code Definition Bit 8
RDNCD1 (0FH): RECEIVE DOWN CODE DEFINITION REGISTER 1
 (MSB)                                                                        (LSB)
  C7      C6        C5      C4             C3      C2            C1             C0
  SYMBOL       POSITION  DESCRIPTION
      C7       RDNCD1.7  Receive Down Code Definition Bit 7. First bit of the
                         repeating pattern.
      C6       RDNCD1.6  Receive Down Code Definition Bit 6. A Don’t Care if a 1-bit
                         length is selected.
      C5       RDNCD1.5  Receive Down Code Definition Bit 5. A Don’t Care if a 1 or
                         2 bit length is selected.
      C4       RDNCD1.4  Receive Down Code Definition Bit 4. A Don’t Care if a 1 to 3
                         bit length is selected.
      C3       RDNCD1.3  Receive Down Code Definition Bit 3. A Don’t Care if a 1 to 4
                         bit length is selected.
      C2       RDNCD1.2  Receive Down Code Definition Bit 2. A Don’t Care if a 1 to 5
                         bit length is selected.
      C1       RDNCD1.1  Receive Down Code Definition Bit 1. A Don’t Care if a 1 to 6
                         bit length is selected.
      C0       RDNCD1.0  Receive Down Code Definition Bit 0. A Don’t Care if a 1 to 7
                         bit length is selected.
                                  42 of 73


                                                                                         DS2148/DS21Q48
RDNCD2 (10H): RECEIVE DOWN CODE DEFINITION REGISTER 2
   (MSB)                                                                                      (LSB)
     C15           C14          C13          C12            C11      C10          C9            C8
     SYMBOL              POSITION          DESCRIPTION
         C15              RDNCD2.7         Receive Down Code Definition Bit 15
         C14              RDNCD2.6         Receive Down Code Definition Bit 14
         C13              RDNCD2.5         Receive Down Code Definition Bit 13
         C12              RDNCD2.4         Receive Down Code Definition Bit 12
         C11              RDNCD2.3         Receive Down Code Definition Bit 11
         C10              RDNCD2.2         Receive Down Code Definition Bit 10
         C9               RDNCD2.1         Receive Down Code Definition Bit 9
         C8               RDNCD2.0         Receive Down Code Definition Bit 8
6.2 Loopbacks
6.2.1 Remote Loopback (RLB)
 When RLB (CCR6.6) is enabled, the DS2148 is placed into remote loopback. In this loopback, data from
the clock/data recovery state machine will be looped back to the transmit path passing through the jitter
attenuator if it is enabled. The data at the RPOS and RNEG pins will be valid while data presented at
TPOS and TNEG will be ignored (Figure 1-1).
If the Automatic Remote Loopback Enable (CCR6.5) is set to a one, the DS2148 will automatically go
into remote loopback when it detects the loop up code programmed in the Receive Up Code Definition
Registers (RUPCD1 and RUPCD2) for a minimum of 5 seconds. When the DS2148 detects the loop
down code programmed in the Receive Loop Down Code Definition registers (RDNCD1 and RDNCD2)
for a minimum of 5 seconds, the DS2148 will come out of remote loopback. Setting ARLBE to a zero
also can disable the ARLB.
6.2.2 Local Loopback (LLB)
When LLB (CCR6.7) is set to a one, the DS2148 is placed into local loopback. In this loopback, data on
the transmit-side will continue to be transmitted as normal. TCLK and TPOS/TNEG will pass through the
jitter attenuator (if enabled) and be output at RCLK and RPOS/RNEG. Incoming data from the line at
RTIP and RRING will be ignored. If Transmit Unframed All Ones (CCR3.7) is set to a one while in LLB,
TTIP and TRING will transmit all ones while TCLK and TPOS/TNEG will be looped back to RCLK and
RPOS/RNEG (Figure 1-1).
                                                   43 of 73


                                                                                           DS2148/DS21Q48
6.2.3 Analog Loopback (ALB)
Setting ALB (CCR6.4) to a one puts the DS2148 in Analog Loopback. Signals at TTIP and TRING will
be internally connected to RTIP and RRING. The incoming signals at RTIP and RRING will be ignored.
The signals at TTIP and TRING will be transmitted as normal. (See Figure 1-1.)
6.2.4 Dual Loopback (DLB)
Setting both CCR6.7 and CCR6.6 to a one, LLB and RLB respectively, puts the DS2148 into dual
loopback operation. The TCLK and TPOS/TNEG signals will be looped back through the jitter attenuator
(if enabled) and output at RCLK and RPOS/RNEG. Clock and data recovered from RTIP and RRING
will be looped back to the transmit-side and output at TTIP and TRING. This mode of operation is not
available when implementing hardware operation. (See Figure 1-1.)
6.3 PRBS Generation and Detection
Setting TPRBSE (CCR3.4) = 1 enables the DS2148 to transmit a 215-1 (E1) or a 220-1 (T1) Pseudo
Random Bit Sequence (PRBS) depending on the ETS bit setting in CCR1.7. The receive-side of the
DS2148 will always search for these PRBS patterns independent of CCR3.4. The PRBS Bit Error Output
(PBEO) will remain high until the receiver has synchronized to one of the two patterns (64 bits received
without an error) at which time PBEO will go low and the PRBSD bit in the status register (SR) will be
set. Once synchronized, any bit errors received will cause a positive going pulse at PBEO, synchronous
with RCLK. This output can be used with external circuitry to keep track of bit error rates during the
PRBS testing. Setting CCR6.0 (ECRS) = 1 will allow the PRBS errors to be accumulated in the 16-bit
counter in registers ECR1 and ECR2. The PRBS synchronizer will remain in sync until it experiences 6
bit errors or more within a 64-bit span. Both PRBS patterns comply with the ITU-T O.151 specifications.
6.4 Error Counter
Error Count Register 1 (ECR1) is the most significant word and ECR2 is the least significant word of a
user-selectable 16-bit counter that records incoming errors including Bipolar Violations (BPV), Code
Violations (CV), Excessive Zero violations (EXZ) and/or PRBS Errors. See Table 6-3 and Table 6-4 and
Figure 1-2 for details.
Table 6-3. Definition of Received Errors
 ERROR        E1 OR T1                        DEFINITION OF RECEIVED ERRORS
                           Two consecutive marks with the same polarity. Will ignore BPVs due to
    BPV         E1/T1      HDB3 and B8ZS zero suppression when CCR2.3 = 0. Typically used with
                           AMI coding (CCR2.3 = 1). ITU-T O.161.
                           When HDB3 is enabled (CCR2.3 = 0) and the receiver detects two
    CV            E1
                           consecutive BPVs with the same polarity. ITU-T O.161.
    EXZ           E1       When four or more consecutive zeros are detected.
                           When receiving AMI coded signals (CCR2.3 = 1), detection of 16 or more
                           zeros or a BPV. ANSI T1.403 1999.
    EXZ           T1
                           When receiving B8ZS coded signals (CCR2.3 = 0), detection of 8 or more
                           zeros or a BPV. ANSI T1.403 1999.
                           A bit error in a received PRBS pattern. See Section 6.3 for details.
   PRBS         E1/T1
                           ITU-T O.151.
                                                   44 of 73


                                                                                            DS2148/DS21Q48
Table 6-4. Function of ECRS Bits and RNEG Pin
 E1 or T1       ECRS2        ECRS1        ECRS0          RHBE               FUNCTION OF ECR
(CCR1.7)      (CCR6.2)      (CCR6.1)     (CCR6.0)      (CCR2.3)             COUNTERS/RNEG1
     0             0             0            0             X      CVs
     0             0             0            1             X      BPVs (HDB3 codewords not counted)
     0             0             1            0             X      CVs + EXZs
     0             0             1            1             X      BPVs + EXZs
     1             0            X             0              0     BPVs (B8ZS codewords not counted)
     1             0            X             1              0     BPVs + 8 EXZs
     1             0            X             0              1     BPVs
     1             0            X             1              1     BPVs + 16 EXZs
     X             1            X             X             X      PRBS Errors2
NOTES:
1) RNEG outputs error data only when in NRZ mode (CCR1.6 = 1).
2) PRBS errors will always be output at PBEO independent of ECR control bits and NRZ mode and will
    not be present at RNEG.
6.4.1 Error Counter Update
A transition of the ECUE (CCR1.4) control bit from 0 to 1 will update the ECR registers with the current
values and reset the counters. ECUE must be set back to zero and another 0 to 1 transition must occur for
subsequent reads/resets of the ECR registers. Note that the DS2148 can report errors at RNEG when in
NRZ mode (CCR1.6 = 1) by outputting a pulse for each error occurrence. The counter saturates at 65,535
and will not rollover.
ECR1 (11H): UPPER ERROR COUNT REGISTER 1
ECR2 (12H): LOWER ERROR COUNT REGISTER 2
 (MSB)                                                                                 (LSB)
   E15          E14          E13        E12          E11        E10          E9          E8       ECR1
    E7           E6          E5          E4           E3         E2          E1          E0       ECR2
    SYMBOL               POSITION          DESCRIPTION
        E15                 ECR1.7         MSB of the 16-bit error count.
        E0                  ECR2.0         LSB of the 16-bit error count.
6.5 Error Insertion
When IBPV (CCR3.1) is transitioned from a zero to a one, the device waits for the next occurrence of
three consecutive ones to insert a BPV. IBPV must be cleared and set again for another BPV error
insertion. See Figure 1-3 for details on the insertion of the BPV into the datastream.
When IBE (CCR3.0) is transitioned from a zero to a one, the device will insert a logic error. IBE must be
cleared and set again for another logic error insertion. See Figure 1-3 for details on the insertion of the
logic error into the datastream.
                                                    45 of 73


                                                                                             DS2148/DS21Q48
7 ANALOG INTERFACE
7.1 Receiver
The DS2148 contains a digital clock recovery system. The DS2148 couples to the receive E1 or T1
twisted pair (or coaxial cable in 75Ω E1 applications) via a 1:1 transformer. See Table 7-3 or transformer
details. Figure 7-1, Figure 7-2, and Figure 7-3 along with Table 7-1 and Table 7-2 show the receive
termination requirements. The DS2148 has the option of using internal termination resistors.
The DS2148 is designed to be fully software-selectable for E1 and T1 without the need to change any
external resistors for the receive-side. The receive-side will allow the user to configure the DS2148 for
75Ω, 100Ω, or 120Ω receive termination by setting the RT1 (CCR5.1) and RT0 (CCR5.0) bits. When
using the internal termination feature, the Rr resistors should be 60Ω each (Figure 7-1). If external
termination is required, RT1 and RT0 should be set to 0 and both Rr resistors in Figure 7-1 will need to
be 37.5Ω, 50Ω, or 60Ω each depending on the line impedance.
The resultant E1 or T1 clock derived from the 2.048/1.544 PLL (JACLK in Figure 1-1) is internally
multiplied by 16 via another internal PLL and fed to the clock recovery system. The clock recovery
system uses the clock from the PLL circuit to form a 16 times oversampler, which is used to recover the
clock and data. This oversampling technique offers outstanding performance to meet jitter tolerance
specifications shown in Figure 7-6.
Normally, the clock that is output at the RCLK pin is the recovered clock from the E1 AMI/HDB3 or T1
AMI/B8ZS waveform presented at the RTIP and RRING inputs. When no signal is present at RTIP and
RRING, a Receive Carrier Loss (RCL) condition will occur and the RCLK will be derived from the
JACLK source (Figure 1-1). If the jitter attenuator is placed in the receive path (as is the case in most
applications), the jitter attenuator restores the RCLK to an approximate 50% duty cycle. If the jitter
attenuator is either placed in the transmit path or is disabled, the RCLK output can exhibit slightly shorter
high cycles of the clock. This is due to the highly oversampled digital clock recovery circuitry. See the
Receive AC Timing Characteristics in Section 10 for more details.
The receive-side circuitry also contains a clock synthesizer, which outputs a user configurable clock (up
to 16.384MHz) synthesized to RCLK at BPCLK (pin 31). See Table 4-3 for details on output clock
frequencies at BPCLK. In hardware mode, BPCLK defaults to a 16.384MHz output.
The DS2148 has a bypass mode for the receive side clock and data. This allows the BPCLK to be derived
from RCLK after the jitter attenuator while the clock and data presented at RCLK, RPOS, and RNEG go
unaltered. This is intended for applications where the receive side jitter attenuation will be done after the
LIU. Setting RJAB (CCR6.3) to a logic 1 will enable the bypass. Be sure that the jitter attenuator is in the
receive path (CCR4.3 = 0). See Figure 1-1 for details.
The DS2148 will report the signal strength at RTIP and RRING in 2.5dB increments via RL3-RL0
located in the Receive Information Register 2. This feature is helpful when trouble shooting line
performance problems. See Table 5-2 for details.
Monitor applications in both E1 and T1 require various flat gain settings for the receive-side circuitry.
The DS2148 can be programmed to support these applications via the Monitor Mode control bits MM1
and MM0. When the monitor modes are enabled, the receiver will tolerate normal line loss up to –6dB.
See Table 4-4 for details.
                                                    46 of 73


                                                                                                 DS2148/DS21Q48
7.2 Transmitter
The DS2148 uses a set of laser-trimmed delay lines along with a precision digital-to-analog converter
(DAC) to create the waveforms that are transmitted onto the E1 or T1 line. The waveforms created by the
DS2148 meet the latest ETSI, ITU, ANSI, and AT&T specifications. The user will select which
waveform is to be generated by setting the ETS bit (CCR1.7) for E1 or T1 operation, then programming
the L2/L1/L0 bits in Common Control Register 4 for the appropriate application. See Table 7-1 and
Table 7-2 for the proper L2/L1/L0 settings.
A 2.048MHz or 1.544MHz TTL clock is required at TCLK for transmitting data at TPOS and TNEG.
ITU specification G.703 requires an accuracy of ±50ppm for both T1 and E1. TR62411 and ANSI specs
require an accuracy of ±32ppm for T1 interfaces. The clock can be sourced internally by RCLK or
JACLK. See CCR1.2, CCR1.1, CCR1.0, and Figure 1-3 for details. Because of the nature of the DS2148
transmitter design, very little jitter (less than 0.005UIP-P broadband from 10Hz to 100kHz) is added to the
jitter present on TCLK. Also, the waveforms created are independent of the duty cycle of TCLK. The
transmitter in the DS2148 couples to the E1 or T1 transmit twisted pair (or coaxial cable in some E1
applications) via a 1:1.36 step-up transformer. In order for the device to create the proper waveforms, the
transformer used must meet the specifications listed in Table 7-3.
The DS2148 has automatic short-circuit limiter that limits the source current to 50mA (RMS) into a 1Ω
load. This feature can be disabled by setting the SCLD bit (CCR2.5) = 1. When the current limiter is
activated, TCLE (SR.2) will be set even if short circuit limiter is disabled. The TPD bit (CCR4.0) will
power-down the transmit line driver and tri-state the TTIP and TRING pins. The DS2148 also can detect
when the TTIP or TRING outputs are open-circuited. When an open circuit is detected, TOCD (SR.1)
will be set.
7.3 Jitter Attenuator
The DS2148 contains an on-board jitter attenuator that can be set to a depth of either 32 bits or 128 bits
via the JABDS bit (CCR4.2). In hardware mode the depth is 128 bits and cannot be changed. The 128-bit
mode is used in applications where large excursions of wander are expected. The 32-bit mode is used in
delay sensitive applications. The characteristics of the attenuation are shown in Figure 7-7. The jitter
attenuator can be placed in either the receive path or the transmit path by appropriately setting or clearing
the JAS bit (CCR4.3). Also, the jitter attenuator can be disabled (in effect, removed) by setting the DJA
bit (CCR4.1). In order for the jitter attenuator to operate properly, a 2.048MHz or 1.544MHz clock must
be applied at MCLK. ITU specification G.703 requires an accuracy of ±50ppm for both T1 and E1.
TR62411 and ANSI specs require an accuracy of ±32ppm for T1 interfaces. There is an onboard PLL for
the jitter attenuator, which will convert the 2.048MHz clock to a 1.544MHz rate for T1 applications.
Setting JAMUX (CCR1.3) to a logic 0 bypasses this PLL. On-board circuitry adjusts either the recovered
clock from the clock/data recovery block or the clock applied at the TCLK pin to create a smooth jitter-
free clock that is used to clock data out of the jitter attenuator FIFO. It is acceptable to provide a
gapped/bursty clock at the TCLK pin if the jitter attenuator is placed on the transmit side. If the incoming
jitter exceeds either 120UIP-P (buffer depth is 128 bits) or 28UIP-P (buffer depth is 32 bits), then the
DS2148 will divide the internal nominal 32.768MHz (E1) or 24.704MHz (T1) clock by either 15 or 17
instead of the normal 16 to keep the buffer from overflowing. When the device divides by either 15 or 17,
it also sets the jitter attenuator limit trip (JALT) bit in the receive information register 1 (RIR1).
                                                      47 of 73


                                                                                              DS2148/DS21Q48
7.4 G.703 Synchronization Signal
The DS2148 is capable of receiving a 2.048MHz square-wave synchronization clock as specified in
Section 13 of ITU G.703 (10/98). To use the DS2148 in this mode, set the receive synchronization clock
enable (CCR5.3) = 1. The DS2148 can also transmit the 2.048MHz square-wave synchronization clock as
specified in Section 10 of G.703. To transmit the 2.048MHz clock, set the transmit synchronization clock
enable (CCR5.2) = 1.
Table 7-1. Line Build-Out Select for E1 in Register CCR4 (ETS = 0)
  L2         L1         L0        VDD            APPLICATION             N         RETURN LOSS         Rt
   0         0           0         5V      75Ω normal                  1:1.36            N.M.          0Ω
   0         0           1         5V      120Ω normal                 1:1.36            N.M.          0Ω
   1         0           0         5V      75Ω w/ high return loss     1:1.36            21dB         18Ω
   1         0           1         5V      120Ω w/ high return loss    1:1.36            21dB         27Ω
N.M. = Not meaningful
Note: See Figure 7-1, Figure 7-2, and Figure 7-3.
Table 7-2. Line Build-Out Select for T1 in Register CCR4 (ETS = 1)
  L2         L1         L0        VDD            APPLICATION             N         RETURN LOSS         Rt
                                           DSX-1 (0 to 133 feet) /
   0         0           0         5V                                  1:1.36            N.M.          0Ω
                                           0dB CSU
   0         0           1         5V      DSX-1 (133 to 266 feet)     1:1.36            N.M.         0Ω
   0         1           0         5V      DSX-1 (266 to 399 feet)     1:1.36            N.M.         0Ω
   0         1           1         5V      DSX-1 (399 to 533 feet)     1:1.36            N.M.         0Ω
   1         0           0         5V      DSX-1 (533 to 655 feet)     1:1.36            N.M.         0Ω
   1         0           1         5V      -7.5dB CSU                  1:1.36            N.M.         0Ω
   1         1           0         5V      -15dB CSU                   1:1.36            N.M.         0Ω
   1         1           1         5V      -22.5dB CSU                 1:1.36            N.M.         0Ω
N.M. = Not meaningful
Note: See Figure 7-1, Figure 7-2, and Figure 7-3..
Table 7-3. Transformer Specifications for 5V Operation
                SPECIFICATION                                    RECOMMENDED VALUE
Turns Ratio 5V Applications                             1:1(receive) and 1:1.36(transmit) ±2%
Primary Inductance                                      600µH minimum
Leakage Inductance                                      1.0µH maximum
Interwinding Capacitance                                40pF maximum
Transmit Transformer DC Resistance
         Primary (Device Side)                          1.2Ω maximum
         Secondary                                      1.2Ω maximum
Receive Transformer DC Resistance
         Primary (Device Side)                          1.2Ω maximum
         Secondary                                      1.2Ω maximum
                                                          48 of 73


                                                                                                                           DS2148/DS21Q48
Figure 7-1. Basic Interface
                                                                                     DS2148                               +VDD
                                                     Rt                                                       0.1µF
                                                                              TTIP         VDD (21)
   Transmit                                               0.47µF
                                                           (non                            VSS (22)
     Line                                                polarized)                                       0.01µF      10µF
                                                                              TRING
                                                     Rt
                                     N:1                                                                   0.1µF
                               (larger winding                                              VDD (36)
                            toward the network)
                                                                                           VSS (35)
                                                                                                                      10µF
                                                                                              MCLK             2.048MHz
                                                                              RTIP
    Receive                                                                                                    (this clock can also
     Line                                                                                                      be 1.544MHz for T1
                                                                              RRING                            only applications)
                                       1:1
                                                Rr      Rr
                                               0.1µF
NOTES:
1) All resistor values are ±1%.
2) In E1 applications, the Rt resistors are used to increase the transmitter return loss (Table 7-1). No return loss is required for T1
   applications.
3) The Rr resistors should be set to 60Ω each if the internal receive-side termination feature is enabled. When this feature is disabled, Rr
   = 37.5Ω for 75Ω, 60Ω for 120Ω E1 systems, or 50Ω for 100Ω T1 lines.
4) See Table 7-1 and Table 7-2 for the appropriate transmit transformer turns ratio (N).
                                                                    49 of 73


                                                                                                                           DS2148/DS21Q48
Figure 7-2. Protected Interface Using Internal Receive Termination
                                                                          +VDD
                      (optional)                                    D1       D2       DS2148                            +VDD
                    Fuse       Rp
                                                          Rt                                                 0.1uF
                                                                                 TTIP    VDD (21)
     Transmit                                         S       0.47uF
                                                               (non-                     VSS (22)
        Line                                                 polarized)  C1                             0.01uF     10uF
                                                                                 TRING                                       68uF
                                                          Rt                             VDD (36)
                    Fuse       Rp                                                                            0.1uF
                                        N:1                       D3         D4          VSS (35)
                                  (larger winding                                                                   10uF
                                toward the network)
                                                                          +VDD
                                                                    D5      D6
                    Fuse       Rp
                                                                                            MCLK              2.048MHz
                                                                                 RTIP
      Receive                                                                                                 (this clock can also
                                                      S                                                       be 1.544MHz for T1
        Line                                                             C2
                                                                                 RRING                        only applications)
                     Fuse      Rp
                                          1:1
                       (optional)                                           D8
                                                     60        60 D7
                                                    0.1uF
NOTES:
1) All resistor values are ±1%.
2) C1 = C2 = 0.1µF.
3) S is a 6V transient suppresser.
4) D1 to D8 are Schottky diodes.
5) The fuses are optional to prevent AC power line crosses from compromising the transformers.
6) Rp resistors exist to keep the Fuses from opening during a surge. If they are used, then the 60Ω receive termination resistance must
   be adjusted to match the line impedance.
7) The Rt resistors are used to increase the transmitter return loss (Table 7-1). No return loss is required for T1 applications.
8) The transmit transformer turns ratio (N) would be 1:1.36 for 5V operation.
9) The 68µF is used to keep the local power plane potential within tolerance during a surge.
                                                                        50 of 73


                                                                                                                           DS2148/DS21Q48
Figure 7-3. Protected Interface Using External Receive Termination
                                                                         +VDD
                    (optional)                                    D1        D2      DS2148                                 +VDD
                  Fuse       Rp
                                                       Rt                                                      0.1µF
                                                                               TTIP        VDD (21)
    Transmit                                         S      0.47µF
                                                             (non-                         VSS (22)
      Line                                                 polarized)   C1                                0.01µF      10µF
                                                                               TRING                                             68µF
                                                       Rt                                  VDD (36)
                  Fuse       Rp                                                                                0.1µF
                                       N:1                       D3         D4             VSS (35)
                                 (larger winding
                               toward the network)                                                                     10µF
                   Fuse       Rp
                                                           470                                MCLK               2.048MHz
                                                                               RTIP
     Receive                                                                                                     (this clock can also
      Line                                                                                                       be 1.544MHz for T1
                                                                               RRING                             only applications)
                   Fuse       Rp                           470
                                         1:1
                     (optional)
                                                  Rr      Rr
                                                 0.1µF
NOTES:
1) All resistor values are ±1%.
2) C1 = 0.1µF.
3) S is a 6V transient suppresser.
4) D1 to D4 are Schottky diodes.
5) The fuses are optional to prevent AC power line crosses from compromising the transformers.
6) Rp resistors exist to keep the Fuses from opening during a surge. If they are used, then Rr must be adjusted to match the line
    impedance.
7) Rr = 37.5Ω for 75Ω, 60Ω for 120Ω E1 systems, or 50Ω for 100Ω T1 lines.
8) The Rt resistors are used to increase the transmitter return loss (Table 7-1). No return loss is required for T1 applications.
9) The transmit transformer turns ratio (N) would be 1:1.36 for 5V operation.
10) The 68µF is used to keep the local power plane potential within tolerance during a surge.
                                                                      51 of 73


                                                                                                                                                               DS2148/DS21Q48
Figure 7-4. E1 Transmit Pulse Template
                                                                          1.2
                                                                          1.1                                                              269ns
                                                                          1.0
                     (in 75 ohm systems, 1.0 on the scale = 2.37Vpeak
                                                                          0.9
                                                                          0.8
                                                                          0.7                                                               G.703
  SCALED AMPLITUDE
                                                                                                                  194ns                    Template
                                                                          0.6
                                                                          0.5
                                                                                                                  219ns
                                                                          0.4
                     in 120 ohm systems, 1.0 on the scale = 3.00Vpeak)
                                                                          0.3
                                                                          0.2
                                                                          0.1
                                                                           0
                                                                         -0.1
                                                                         -0.2
                                                                                -250   -200   -150   -100   -50      0        50   100   150       200   250
                                                                                                                  TIME (ns)
                                                                                                                   52 of 73


                                                                                                                            DS2148/DS21Q48
Figure 7-5. T1 Transmit Pulse Template
                            1.2
                                                                              MAXIMUM CURVE            MINIMUM CURVE
                            1.1                                                UI  Time Amp.           UI   Time Amp.
                            1.0                                               -0.77   -500   0.05    -0.77   -500   -0.05
                                                                              -0.39   -255   0.05    -0.23   -150   -0.05
                            0.9                                               -0.27   -175   0.80    -0.23   -150   0.50
                                                                              -0.27   -175   1.15    -0.15   -100   0.95
                            0.8                                               -0.12   -75    1.15     0.00   0      0.95
                                                                               0.00   0      1.05     0.15   100    0.90
                                                                               0.27   175    1.05     0.23   150    0.50
                            0.7                                                0.35   225    -0.07    0.23   150    -0.45
                                                                               0.93   600    0.05     0.46   300    -0.45
                            0.6                                                1.16   750    0.05     0.66   430    -0.20
    NORMALIZED AMPLITUDE
                                                                                                      0.93   600    -0.05
                            0.5                                                                       1.16   750    -0.05
                            0.4
                            0.3
                            0.2
                            0.1
                             0
                           -0.1
                                      T1.102/87, T1.403,
                           -0.2       CB 119 (Oct. 79), &
                                      I.431 Template
                           -0.3
                           -0.4
                           -0.5
                              -500 -400 -300   -200 -100    0   100   200      300      400      500     600        700
                                                                TIME (ns)
                                                                   53 of 73


                                                                                                                                     DS2148/DS21Q48
Figure 7-6. Jitter Tolerance
                                                        1K
                               UNIT INTERVALS (UIpp)
                                                       100
                                                                                                 DS2148
                                                                  TR 62411 (Dec. 90)             Tolerance
                                                        10
                                                                             ITU-T G.823
                                                         1
                                                        0.1
                                                              1   10              100        1K                10K            100K
                                                                                   FREQUENCY (Hz)
Figure 7-7. Jitter Attenuation
                                                       0dB
                                                                                                       ITU G.7XX
                                                                               TBR12                 Prohibited Area
          JITTER ATTENUATION (dB)
                                                                              Prohibited
                                                                                Area
                                           -20dB
                                                                                      C
                                                                                       urve
                                                                                           A
                                                                        E1       T1
                                                                                                         TR 62411 (Dec. 90)
                                                                                                          Prohibited Area
                                           -40dB
                                                                        Cu
                                                                             B
                                                                         rve
                                           -60dB
                                                              1    10             100         1K                10K           100K
                                                                                  FREQUENCY (Hz)
                                                                                      54 of 73


                                                                                      DS2148/DS21Q48
8 DS21Q48 QUAD LIU
The DS21Q48 is a quad version of the DS2148G utilizing CSBGA on carrier packaging technology. The
four LIUs are controlled via the parallel port mode. Serial and hardware modes are unavailable in this
package.
Table 8-1. DS21Q48 Pin Assignment
   DS21Q48                  PARALLEL PORT
                  I/O
     PIN#                         MODE
       J1            I         Connect to VSS
      K3             I         Connect to VSS
       J2            I            RD(DS)
      H1             I           WR(R/W)
      K2             I           ALE(AS)
      K1           I/O               A4
      L1             I               A3
     H11             I               A2
     H12             I               A1
     G12             I               A0
      J10          I/O            D7/AD7
     H10           I/O            D6/AD6
     G11           I/O            D5/AD5
       J9          I/O            D4/AD4
      E3           I/O            D3/AD3
      D4           I/O            D2/AD2
      F3           I/O            D1/AD1
      D5           I/O            D0/AD0
      G4             I             VSM
      K9           I/O              INT
      K7             I             TEST
      L9             I             HRST
       J6            I            MCLK
      L7             I             BIS0
      M8             I             BIS1
     M12             I             PBTS
       J3            I              CS1
      D3             I              CS2
     D10             I              CS3
     K10             I              CS4
      K5            O             PBEO1
      G3            O             PBEO2
      E10           O             PBEO3
      K8            O             PBEO4
      L6            O           RCL/LOTC1
      D7            O           RCL/LOTC2
      F9            O           RCL/LOTC3
                                                55 of 73


                                  DS2148/DS21Q48
DS21Q48     PARALLEL PORT
        I/O
 PIN#           MODE
   J7    O    RCL/LOTC4
  A1      I      RTIP1
  A4      I      RTIP2
  A7      I      RTIP3
  A10     I      RTIP4
  B2      I     RRING1
  B5      I     RRING2
  B8      I     RRING3
  B11     I     RRING4
  H4     O     BPCLK1
  D6     O     BPCLK2
  F10    O     BPCLK3
  L8     O     BPCLK4
  A2     O       TTIP1
  A5     O       TTIP2
  A8     O       TTIP3
  A11    O       TTIP4
  B3     O      TRING1
  B6     O      TRING2
  B9     O      TRING3
  B12    O      TRING4
  K4     O      RPOS1
  E1     O      RPOS2
  D11    O      RPOS3
  K11    O      RPOS4
  G2     O      RNEG1
  E2     O      RNEG2
  F11    O      RNEG3
  M10    O      RNEG4
  H3     O      RCLK1
  F1     O      RCLK2
  E11    O      RCLK3
  L11    O      RCLK4
  G1      I      TPOS1
  F2      I      TPOS2
  E12     I      TPOS3
  M11     I     TPOS4
  H2      I     TNEG1
  M1      I     TNEG2
  D12     I     TNEG3
  K12     I     TNEG4
  M2      I     TCLK1
  L2      I     TCLK2
  F12     I     TCLK3
                         56 of 73


                                  DS2148/DS21Q48
DS21Q48     PARALLEL PORT
        I/O
 PIN#           MODE
  L12     I     TCLK4
   J5     -      VDD1
  D2      -      VDD2
  G9      -      VDD3
  M9      -      VDD4
  L5      -      VDD1
  E4      -      VDD2
  D8      -      VDD3
   J8     -      VDD4
   J4     -      VSS1
  D1      -      VSS2
  E9      -      VSS3
  L10     -      VSS4
  M4      -      VSS1
  F4      -      VSS2
  D9      -      VSS3
  H9      -      VSS4
                         57 of 73


                                                                                 DS2148/DS21Q48
Figure 8-1. 144-Pin CSBGA (17mm x 17mm) Pinout
           1       2       3      4       5        6        7     8     9    10    11     12
   A    RTIP     TTIP     NC    RTIP    TTIP      NC      RTIP  TTIP   NC   RTIP  TTIP    NC
           1       1              2       2                 3     3           4     4
   B     NC    RRING TRING       NC    RRING TRING         NC  RRING TRING   NC  RRING TRING
                   1       1              2        2              3     3           4      4
   C     NC       NC      NC     NC      NC       NC       NC    NC    NC    NC    NC     NC
   D     VSS     VDD     CS2    D2/      D0/    BPCLK RCL/      VDD   VSS   CS3  RPOS    TNEG
           2       2            AD2     AD0        2     LOTC2    3     3           3      3
   E   RPOS     RNEG      D3/   VDD      NC       NC       NC    NC   VSS  PEBO  RCLK    TPOS
           2       2     AD3      2                                     3     3     3      3
   F    RCLK    TPOS      D1/   VSS      NC       NC       NC    NC   RCL/ BPCLK RNEG    TCLK
           2       2     AD1      2                                  LOTC3    3     3      3
   G    TPOS    RNEG    PEBO    VSM      NC       NC       NC    NC   VDD    NC   D5/     A0
           1       1       2                                            3         AD5
   H     WR     TNEG    RCLK BPCLK       NC       NC       NC    NC   VSS   D6/    A2     A1
        (R/W)      1       1      1                                     4   AD6
   J     See      RD     CS1    VSS     VDD     MCLK      RCL/  VDD   D4/   D7/    NC     NC
       Note 2    (DS)             1       1              LOTC4    4   AD4   AD7
   K      A4     ALE     See   RPOS    PEBO       NC      TEST PEBO   INT   CS4  RPOS    TNEG
                 (AS)   Note 2    1       1                       4                 4      4
   L      A3    TCLK      NC     NC     VDD      RCL/     BIS0 BPCLK HRST   VSS  RCLK    TCLK
                   2                      1     LOTC1             4           4     4      4
   M    TNEG    TCLK      NC    VSS      NC       NC       NC   BIS1  VDD  RNEG  TPOS    PBTS
           2       1              1                                     4     4     4
NOTES:
1) Shaded areas are signals common to all four devices.
2) Connect to VSS.
                                                58 of 73


                                                                                                                         DS2148/DS21Q48
9 DC CHARACTERISTICS
ABSOLUTE MAXIMUM RATINGS*
Voltage Range on Any Pin Relative to Ground……………………………………………..-1.0V to +6.0V
Operating Temperature Range for DS2148TN……………………………………………..-40°C to +85°C
Storage Temperature Range……………………………………………………………….-55°C to +125°C
Soldering Temperature………………………………………….See IPC/JEDEC J-STD-020 Specification
* This is a stress rating only and functional operation of the device at these or any other conditions beyond those indicated in the operation
sections of this specification is not implied. Exposure to absolute maximum rating conditions for extended periods of time can affect device
reliability.
Table 9-1. Recommended DC Operating Conditions
(TA = -40°C to +85°C)
         PARAMETER                          SYMBOL               MIN              TYP           MAX            UNITS             NOTES
Logic 1                                          VIH               2.0                            5.5              V
Logic 0                                          VIL              –0.3                           +0.8              V
Supply for 5V Operation                         VDD               4.75              5            5.25              V                  1
Table 9-2. Capacitance
(TA = +25°C)
         PARAMETER                          SYMBOL               MIN              TYP           MAX            UNITS             NOTES
Input Capacitance                                CIN                                5                             pF
Output Capacitance                              COUT                                7                             pF
Table 9-3. DC Characteristics
(VDD = 5.0V ±5%, TA = -40°C to +85°C.)
         PARAMETER                          SYMBOL               MIN              TYP           MAX            UNITS             NOTES
Input Leakage                                    IIL              –1.0                           +1.0             µA                  3
Output Leakage                                   ILO                                              1.0             µA                  4
Output Current (2.4V)                            IOH              –1.0                                           mA
Output Current (0.4V)                            IOL              +4.0                                           mA
Supply Current                                   IDD                -              95            125             mA                 2, 5
NOTES:
1)   Applies to VDD.
2)   TCLK = MCLK = 2.048MHz.
3)   0.0V < VIN < VDD.
4)   Applied to INT when tri-stated.
5)   Power dissipation with TTIP and TRING driving a 30Ω load, for an all-ones data density.
                                                                   59 of 73


                                                                                          DS2148/DS21Q48
9.1 THERMAL CHARACTERISTICS
Table 9-4. Thermal Characteristics—DS21Q48 CSBGA Package
        PARAMETER                     MIN           TYP         MAX        NOTES
Ambient Temperature                   -40ºC           -        +85ºC          1
Junction Temperature                     -            -        +125ºC
Theta-JA (θJA) in Still Air              -        +24ºC/W         -           2
Theta-JC (θJC) in Still Air              -        +4.1ºC/W        -           3
NOTES:
1) The package is mounted on a four-layer JEDEC-standard test board.
2) Theta-JA (θJA) is the junction to ambient thermal resistance, when the package is mounted on a four-
   layer JEDEC-standard test board.
3) While Theta-JC (θJC) is commonly used as the thermal parameter that provides a correlation between the
   junction temperature (Tj) and the average temperature on top center of four of the chip-scale BGA
   packages (TC), the proper term is Psi-JT. It is defined by:
                              (TJ - TC) / overall package power
   The method of measurement of the thermal parameters is defined in EIA/JEDEC-standard document
   EIA-JESD51-2.
Table 9-5. Theta-JA (θJA) vs. Airflow
 FORCED AIR (m/s)           THETA-JA (θJA)
           0                    24ºC/W
           1                    21ºC/W
          2.5                   19ºC/W
                                                   60 of 73


                                                                                DS2148/DS21Q48
10 AC CHARACTERISTICS
Table 10-1. AC Characteristics—Multiplexed Parallel Port
(BIS1 = 0, BIS0 = 0)
(VDD = 5.0V ±5%, TA = -40°C to +85°C.) (See Figure 10-1, Figure 10-2, and Figure 10-3.)
       PARAMETER             SYMBOL        MIN       TYP       MAX       UNITS       NOTES
Cycle Time                       tCYC      200                              ns
Pulse Width, DS Low or RD
                                PWEL       100                              ns
High
Pulse Width, DS High or RD
                                PWEH       100                              ns
Low
Input Rise/Fall times           tR, tF                          20          ns
R/W Hold Time                   tRWH        10                              ns
R/W Setup Time Before DS
                                 tRWS       50                              ns
High
CS Setup Time Before DS,
                                  tCS       20                              ns
WR or RD Active
CS Hold Time                      tCH       0                               ns
Read Data Hold Time              tDHR       10                  50          ns
Write Data Hold Time            tDHW        0                               ns
Muxed Address Valid to AS
                                 tASL       15                              ns
or ALE Fall
Muxed Address Hold Time          tAHL       10                              ns
Delay Time DS, WR or RD to
                                 tASD       20                              ns
AS or ALE Rise
Pulse Width AS or ALE High     PWASH        30                              ns
Delay Time, AS or ALE to
                                tASED       10                              ns
DS, WR or RD
Output Data Delay Time
                                 tDDR       20                  80          ns
From DS or RD
Data Setup Time                  tDSW       50                              ns
                                           61 of 73


                                                                          DS2148/DS21Q48
Figure 10-1. Intel Bus Read Timing (PBTS = 0, BIS1 = 0, BIS0 = 0)
                                               t CYC
       ALE
                              PWASH
              t ASD
       WR*
                                      t ASED
                          t ASD
                                                         PWEH
       RD*
                        PWEL        t CS                         t CH
       CS*
                          t ASL                      t DDR            t DHR
     AD0-AD7
                                     t AHL
Figure 10-2. Intel Bus Write Timing (PBTS = 0, BIS1 = 0, BIS0 = 0)
                                               t CYC
        ALE
                              PWASH
              t ASD
        RD*
                    t ASD               t ASED
                                                        PWEH
        WR*
                         PWEL         t CS                       t CH
        CS*
                          t ASL                                       t DHW
     AD0-AD7
                                    t AHL                  t DSW
                                      62 of 73


                                                                                   DS2148/DS21Q48
Figure 10-3. Motorola Bus Timing (PBTS = 1, BIS1 = 0, BIS0 = 0)
                             PWASH
        AS
                                        t ASED                      PWEH
                   t ASD
        DS
              PWEL
                                                           t CYC
                                      t RWS                                  t RWH
        R/W*
                         t ASL                         t DDR               t DHR
     AD0-AD7
      (read)
                                t AHL                                t CH
                                                   t CS
       CS*
                                                              t DSW
                          t ASL
     AD0-AD7
      (write)
                              t AHL                                      t DHW
                                            63 of 73


                                                                                DS2148/DS21Q48
Table 10-2. AC Characteristics—Nonmultiplexed Parallel Port
(BIS1 = 0, BIS0 = 1)
(VDD = 5.0V ±5%, TA = -40°C to +85°C.) (See Figure 10-4, Figure 10-5, Figure 10-6, and
Figure 10-7.)
         PARAMETER              SYMBOL        MIN       TYP      MAX       UNITS     NOTES
Setup Time for A0 to A4, Valid
                                   t1            0                           ns
to CS Active
Setup Time for CS Active to
                                   t2            0                           ns
Either RD, WR, or DS Active
Delay Time From Either RD or
                                   t3                              75        ns
DS Active to Data Valid
Hold Time From Either RD,
WR, or DS Inactive to CS           t4            0                           ns
Inactive
Hold Time From CS Inactive to
                                   t5            5                 20        ns
Data Bus tri-state
Wait Time From Either WR or
                                   t6           75                           ns
DS Active to Latch Data
Data Setup Time To Either WR
                                   t7           10                           ns
or DS Inactive
Data Hold Time From Either
                                   t8           10                           ns
WR or DS Inactive
Address Hold From Either WR
                                   t9           10                           ns
or DS Inactive
                                           64 of 73


                                                                                     DS2148/DS21Q48
Figure 10-4. Intel Bus Read Timing (PBTS = 0, BIS1 = 0, BIS0 = 1)
     A0 to A4                 Address Valid
     D0 to D7                                          Data Valid
                                                     5ns min. / 20ns max.     t5
      WR*
                       t1     0ns min.
      CS*
                     0ns min.   t2       t3                         t4    0ns min.
                                       75ns max.
      RD*
Figure 10-5. Intel Bus Write Timing (PBTS = 0, BIS1 = 0, BIS0 = 1)
      A0 to A4                Address Valid
      D0 to D7
                                                             t7           t8
         RD*                                                10ns       10ns
                          t1                                min.       min.
                                0ns min.
         CS*
                                   t2           t6                     t4   0ns min.
                       0ns min.
                                               75ns min.
        WR*
                                            65 of 73


                                                                                DS2148/DS21Q48
Figure 10-6. Motorola Bus Read Timing (PBTS = 1, BIS1 = 0, BIS0 = 1)
    A0 to A4                 Address Valid
    D0 to D7                                           Data Valid
                                                  5ns min. / 20ns max.    t5
     R/W*
                     t1
                           0ns min.
      CS*
                  0ns min.   t2        t3                         t4   0ns min.
                                    75ns max.
      DS*
Figure 10-7. Motorola Bus Write Timing (PBTS = 1, BIS1 = 0, BIS0 = 1)
    A0 to A4                Address Valid
    D0 to D7
                                                     10ns            10ns
                                                     min.     t7 t8  min.
     R/W*
                    t1     0ns min.
      CS*
                             t2              t6                   t4   0ns min.
                  0ns min.
                                          75ns min.
      DS*
                                           66 of 73


                                                                                                     DS2148/DS21Q48
Table 10-3. AC Characteristics—Serial Port (BIS1 = 1, BIS0 = 0)
(VDD = 5.0V ±5%, TA = -40°C to +85°C.) (See Figure 10-8)
      PARAMETER                     SYMBOL              MIN           TYP      MAX       UNITS            NOTES
Setup Time CS to SCLK                     tCSS           50                                   ns
Setup Time SDI to SCLK                    tSSS           50                                   ns
Hold Time SCLK to SDI                     tSSH           50                                   ns
SCLK High/Low Time                        tSLH          200                                   ns
SCLK Rise/Fall Time                       tSRF                                  50            ns
SCLK to CS Inactive                       tLSC           50                                   ns
CS Inactive Time                          tCM           250                                   ns
SCLK to SDO Valid                         tSSV                                  50            ns
SCLK to SDO Tri-state                     tSSH                        100                     ns
CS Inactive to SDO Tri-state              tCSH                        100                     ns
Figure 10-8. Serial Bus Timing (BIS1 = 1, BIS0 = 0)
                                                                                            tCM
               CS*
                                                   tSRF   tSLH                      tLSC
                           tCSS
            SCLK1
             SCLK2
                           tSSS            tSSH
                                                                                                tCSH
               SDI             LSB                       MSB      LSB               MSB
                                                                          tSSV         tSSH
              SDO                           HIGH Z                LSB              MSB        HIGH Z
            NOTE 1: OCES =1 AND ICES = 0.
            NOTE 2: OCES = 0 AND ICES = 1.
                                                         67 of 73


                                                                                        DS2148/DS21Q48
Table 10-4. AC Characteristics—Receive Side
(VDD = 5.0V ±5%, TA = -40°C to +85°C.) (See Figure 10-9)
         PARAMETER                       SYMBOL          MIN   TYP       MAX       UNITS     NOTES
                                                               488                   ns         1
RCLK Period                                  tCP
                                                               648                   ns         2
                                             tCH          200                        ns         3
RCLK Pulse Width
                                             tCL          200                        ns         3
                                             tCH          150                        ns         4
RCLK Pulse Width
                                             tCL          150                        ns         4
Delay RCLK to RPOS, RNEG,
                                             tDD                          50         ns
PBEO, RBPV Valid
NOTES:
1) E1 Mode.
2) T1 or J1 Mode.
3) Jitter attenuator enabled in the receive path.
4) Jitter attenuator disabled or enabled in the transmit path.
Figure 10-9. Receive Side Timing
                      RCLK1
                                                                     t CL     t CH
                      RCLK2
                              t DD                                         t CP
                RPOS, RNEG
                                         bit                    PRBS Detector Out of Sync
                     PBEO
                                         error
                                      t DD
                     RNEG3                       BPV/                   BPV/
                                                 EXZ/                   EXZ/
                                                 CV                     CV
       NOTE 1: RCES = 1 (CCR2.0) OR CES = 1.
       NOTE 2: RCES = 0 (CCR2.0) OR CES = 0.
       NOTE 3: RNEG IS IN NRZ MODE (CCR1.6 = 1).
                                                      68 of 73


                                                                                            DS2148/DS21Q48
Table 10-5. AC Characteristics—Transmit Side
(VDD = 5.0V ±5%, TA = -40°C to +85°C.) (See Figure 10-10.)
         PARAMETER                      SYMBOL        MIN           TYP         MAX    UNITS     NOTES
                                                                    488                  ns         1
TCLK Period                                  tCP
                                                                    648                  ns         2
                                            tCH         75                               ns
TCLK Pulse Width
                                            tCL         75                               ns
TPOS/TNEG Setup to TCLK
                                            tSU         20                               ns
Falling or Rising
TPOS/TNEG Hold From TCLK
                                            tHD         20                               ns
Falling or Rising
TCLK Rise and Fall Times                   tR, tF                                 25     ns
NOTES:
1) E1 Mode.
2) T1 or J1 Mode.
Figure 10-10. Transmit Side Timing
                                                                             t CP
                                                                        t CL      t CH
                          tR               tF
                TCLK1
                TCLK2
                                                           t SU
             TPOS, TNEG
                                                               t HD
            NOTE 1: TCES = 0 (CCR2.1) OR CES = 0.
            NOTE 2: TCES = 1 (CCR2.1) OR CES = 1.
                                                  69 of 73


                                                                                                         DS2148/DS21Q48
11 PACKAGE INFORMATION
(The package drawing(s) in this data sheet may not reflect the most current specifications. The package number provided for
each package is a link to the latest package outline information.)
11.1 44-Pin TQFP (56-G4012-001)
                                                                         SUGGESTED PAD LAYOUT
                                                                         44 PIN TQFP, 10*10*1.0
                     SEE DETAIL "A"
                                              DIMENSIONS ARE IN MILLIMETERS
                                                             70 of 73


                                              DS2148/DS21Q48
11.2 49-Ball CSGBA (7mm x 7mm) (56-G6006-001)
                                71 of 73


                                                                                                         DS2148/DS21Q48
11.3 144-Ball CSBGA (17mm x 17mm) (56-G6011-001)
                A1 CORNER   3
                                                                                                    A1 CORNER
                                                                    12 11 10   9   8   7    6   5    4    3   2 1
                                                                                                                    A B C D E F G H I J K L
                                                          1.27
 17.00
                                                      13.97
                                            0.20
                                                   1.52
         Y                             4
                   17.00                                                               1.27
         X                                                                                 13.97
                                                                  1.52
                                                                 DETAIL A
             TOP VIEW (DIE SIDE)                                     BOTTOM VIEW (BALL SIDE)
                                                                    0.05
                2.60
                REF                                                                    1.99
                                                                            0.59
                                            0.76                    0.61
                       Z
                                DETAIL B
                                           SIDE VIEW
                                            72 of 73


                                                                                                                                               DS2148/DS21Q48
                                                           SOLDER BALL
                                                               φ 0.76 REF                          φ 0.76       L        X         Y        Z
                                                                                                   φ 0.76       L        Z
                                                                        DETAIL A
                                         0.05 LABEL THICKNESS
                                                                                                                      //        0.24       Z
2.60                                                                                                                                           //       0.17    Z
REF
                                                                                                                                                              0.10
                                                                                SEATING PLANE
                                                                                                               2
                                                                                                                                                       Z
                           0.76
                           REF
                                                                        DETAIL B
                                                                            73 of 73
 Maxim/Dallas Semiconductor cannot assume responsibility for use of any circuitry other than circuitry entirely embodied in a Maxim/Dallas Semiconductor product.
 No circuit patent licenses are implied. Maxim/Dallas Semiconductor reserves the right to change the circuitry and specifications without notice at any time.
 Maxim Integrated Products, 120 San Gabriel Drive, Sunnyvale, CA 94086 408-737-7600
                                                       © 2006 Maxim Integrated Products • Printed USA
    The Maxim logo is a registered trademark of Maxim Integrated Products, Inc. The Dallas logo is a registered trademark of Dallas Semiconductor Corporation.


Mouser Electronics
Authorized Distributor
Click to View Pricing, Inventory, Delivery & Lifecycle Information:
Maxim Integrated:
 DS21Q50L-W+ DS2148DK DS2148G+ DS2148GN+ DS2148T+ DS2148TN+ DS21Q48A3N DS21Q50L
DS2148GB DS2148GN DS21Q48C DS21Q48NB DS2148TA2 DS2148T DS2148G DS2148GNB DS21Q48B
