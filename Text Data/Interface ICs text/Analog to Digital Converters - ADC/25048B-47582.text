                                                                    MCP3903
                   Six Channel Delta Sigma A/D Converter
Features                                            Description
• Six Synchronous Sampling 16/24-bit Resolution     The MCP3903 is a six-channel Analog Front End (AFE)
  Delta-Sigma A/D Converters with Proprietary       containing three pairs made out of two synchronous
  Multi-Bit Architecture                            sampling Delta-Sigma Analog-to-Digital Converters
• 91 dB SINAD, -100 dBc Total Harmonic Distortion   (ADC) with PGA, a phase delay compensation block,
  (THD) (up to 35th harmonic), 102 dB Spurious-free internal voltage reference, and high-speed 10 MHz SPI
  Dynamic Range (SFDR) for Each Channel             compatible serial interface. The converters contain a
• Programmable Data Rate up to 64 ksps              proprietary dithering algorithm for reduced idle tones
                                                    and improved THD.
• Ultra Low-Power Shutdown Mode with <2 μA
• -115 dB Crosstalk Between any Two Channels        The internal register map contains 24-bit wide ADC
                                                    data words, a modulator output register as well as six
• Low Drift Internal Voltage Reference: 5 ppm/°C
                                                    24-bit writable control registers to program gain,
• Differential Voltage Reference Input Pins         over-sampling ratio, phase, resolution, dithering,
• High Gain PGA on Each Channel (up to 32 V/V)      shut-down, reset and several communication features.
• Phase Delay Compensation Between Each Pair        The communication is largely simplified with various
  of Channels with 1 μs Time Resolution             Continuous Read modes that can be accessed by the
• High-Speed Addressable 10 MHz SPI Interface       Direct Memory Access (DMA) of an MCU and with
  with Mode 0,0 and 1,1 Compatibility               separate Data Ready pins that can directly be
• Independent Analog and Digital Power Supplies     connected to the Interrupt Request (IRQ) input of an
  4.5V - 5.5V AVDD, 2.7V - 3.6V DVDD                MCU. The MCP3903 is capable of interfacing to a large
• Available in Small 28-lead SSOP Package           variety of voltage and current sensors including shunts,
                                                    current transformers, Rogowski coils, and Hall-effect
• Extended Temperature Range: -40°C to +125°C
                                                    sensors.
Applications
                                                    Package Type
• Energy Metering and Power Measurement
                                                                     28-Lead SSOP
• Portable Instrumentation
• Medical and Power Monitoring                                        AVDD   1     28  DVDD
                                                                      CH0+   2     27  RESET
                                                                      CH0-   3     26  SDI
                                                                      CH1-   4     25  SDO
                                                                      CH1+   5     24  SCK
                                                                      CH2+   6     23  CS
                                                                      CH2-   7     22  OSC2
                                                                      CH3-   8      21 OSC1
                                                                      CH3+   9     20  DRC
                                                                      CH4+  10     19  DRB
                                                                      CH4-  11     18  DRA
                                                                      CH5-  12      17 DGND
                                                                      CH5+  13     16  AGND
                                                                REFIN/OUT+ 14      15  REFIN-
© 2011 Microchip Technology Inc.                                                           DS25048B-page 1


MCP3903
Functional Block Diagram
                                             AVDD     DVDD
 REFIN/OUT+
                  Voltage    VREFEXT                                         AMCLK                     Xtal Oscillator
                 Reference                                                                            MCLK             OSC1
                  +                                                                       Clock
                           VREF                                                        Generation                      OSC2
                  -                                                      DMCLK/DRCLK
     REFIN -
                                 VREF- VREF+ ANALOG DIGITAL
                                                                                      DMCLK       OSR<1:0>
                                                                                                  PRE<1:0>
                                                        SINC3
       CH0+                       +                                    DATA_CH0<23:0>
       CH0-                        -
                                    PGA      Δ -Σ
                                            Modulator
                                                               Phase     PHASEA <7:0>
                                                          Φ    Shifter                                                 DRA
       CH1+                       +                                    DATA_CH1<23:0>
       CH1-                       -
                                   PGA       Δ -Σ       SINC3
                                            Modulator
                                DUAL DS ADC
                                                        SINC3
       CH2+                        +                                   DATA_CH2<23:0>
        CH2-                       -
                                    PGA      Δ -Σ
                                            Modulator
                                                               Phase     PHASEB <7:0>
                                                          Φ    Shifter
                                                                                        Digital SPI                    DRB
                                                                                         Interface
       CH3+                       +                                    DATA_CH3<23:0>
        CH3-                      -
                                   PGA       Δ -Σ        SINC3
                                            Modulator
                                DUAL DS ADC
                                                        SINC3
       CH4+                        +                                   DATA_CH4<23:0>
        CH4-                       -
                                    PGA      Δ -Σ
                                            Modulator                                                                  DRC
                                                               Phase     PHASEC <7:0>
                                                          Φ
                                                               Shifter
       CH5+                       +                                    DATA_CH5<23:0>                                  SDO
        CH5-                       -                                                                                   RESET
                                    PGA      Δ -Σ        SINC3
                                            Modulator                                                                  SDI
                                                                                                                       SCK
                                DUAL DS ADC                                                                            CS
                  POR
                                                        POR
                  AVDD
                Monitoring
                                         AGND          DGND
DS25048B-page 2                                                                             © 2011 Microchip Technology Inc.


                                                                                                                             MCP3903
1.0        ELECTRICAL                                                     1.1           RELIABILITY TARGETS
          CHARACTERISTICS
                                                                          ABSOLUTE MAXIMUM RATINGS †
The Reliability Targets section includes the absolute
maximum ratings for the device, defining the values                       VDD ................................................................................... 7.0V
                                                                          Digital inputs and outputs w.r.t. AGND ........-0.6V to VDD +0.6V
that will cause no long term damage regardless of
                                                                          Analog input w.r.t. AGND..................................... ....-6V to +6V
duration.                                                                 VREF input w.r.t. AGND................................-0.6V to VDD +0.6V
These tables also represent the testing requirements                      Storage temperature ..................................... -65°C to +150°C
per the Max. and Min. columns.                                            Ambient temp. with power applied................ -65°C to +125°C
                                                                          Soldering temperature of leads (10 seconds)............. +300°C
                                                                          ESD on the analog inputs (HBM,MM)................. 5.0 kV, 500V
                                                                          ESD on all other pins (HBM,MM)........................ 5.0 kV, 500V
TABLE 1-1:            ANALOG SPECIFICATIONS TARGET TABLE
 Electrical Specifications: Unless otherwise indicated, all parameters apply at AVDD = 4.5 to 5.5V, DVDD = 2.7 to
 3.6V, Internal VREF, MCLK = 4 MHz;PRESCALE = 1; OSR = 64; fS = 1 MHz; fD = 15.625 ksps; TA = -40°C to +125°C,
 GAIN = 1, VIN = 1VPP = 353mVRMS @ 50/60 Hz.
  Param.
                Symbol                Characteristic            Min.     Typ.        Max.            Units                     Test Conditions
   Num.
 Internal Voltage Reference
 A001            VREF       Voltage                             -2%      2.35        +2%                 V          VREFEXT = 0
 A002           TCREF       Tempco                                —        5           —            ppm/°C VREFEXT = 0
 A003         ZOUTREF Output Impedance                                     7           —                kΩ          AVDD=5V,
                                                                                                                    VREFEXT = 0
 Voltage Reference Input
 A004                       Input Capacitance                     —       —            10               pF
 A005            VREF       Differential Input Voltage           2.2      —           2.6                V          VREF = (VREF+ - VREF-),
                            Range (VREF+ - VREF-)                                                                   VREFEXT = 1
 A006            VREF+      Absolute Voltage on REFIN+           1.9      —           2.9                V          VREFEXT = 1
                            pin
 A007            VREF-      Absolute Voltage on REFIN-          -0.3      —          +0.3                V          VREF- should be connected
                            pin                                                                                     to AGND when VREFEXT=0
 ADC Performance
 A008                       Resolution (No Missing                        24                           bits         OSR = 256 (see Table 5-2)
                            Codes)
 A009              fS       Sampling Frequency                       See Table 4-2                     kHz          fS = DMCLK = MCLK / (4 x
                                                                                                                    PRESCALE)
 A010              fD       Output Data Rate                         See Table 4-2                    ksps          fD = DRCLK= DMCLK / OSR
                                                                                                                    = MCLK / (4 x PRESCALE x
                                                                                                                    OSR)
 Note 1:    This specification implies that the ADC output is valid over this entire differential range, i.e. there is no distortion or
           instability across this input range. Dynamic Performance is specified at -0.5 dB below the maximum signal range,
           VIN = -0.5 dBFS @ 50/60 Hz = 333 mVRMS, VREF = 2.4V.
       2:  See terminology section for definition.
       3:  This parameter is established by characterization and not 100% tested.
       4:  For these operating currents, the following configuration bit settings apply: Config Register Settings:
           SHUTDOWN<5:0> = 000000, RESET<5:0> = 000000; VREFEXT = 0, CLKEXT = 0.
       5:  For these operating currents, the following configuration bit settings apply: Config Register Settings:
           SHUTDOWN<5:0> = 111111, VREFEXT = 1, CLKEXT = 1.
       6:  Applies to all gains. Offset error is dependant on PGA gain setting.
       7:  Outside of this range, ADC accuracy is not specified. An extended input range of +/- 6V can be applied continuously to
           the part with no risk for damage.
       8:  For proper operation and to keep ADC accuracy, AMCLK should always be in the range of 1 to 5 MHz with BOOST bits
           off. With BOOST bits on, AMCLK should be in the range of 1 to 8.192 MHz. AMCLK = MCLK/PRESCALE. When using a
           crystal, CLKEXT bit should be equal to ‘0’.
© 2011 Microchip Technology Inc.                                                                                                           DS25048B-page 3


MCP3903
TABLE 1-1:            ANALOG SPECIFICATIONS TARGET TABLE (CONTINUED)
 Electrical Specifications: Unless otherwise indicated, all parameters apply at AVDD = 4.5 to 5.5V, DVDD = 2.7 to
 3.6V, Internal VREF, MCLK = 4 MHz;PRESCALE = 1; OSR = 64; fS = 1 MHz; fD = 15.625 ksps; TA = -40°C to +125°C,
 GAIN = 1, VIN = 1VPP = 353mVRMS @ 50/60 Hz.
  Param.
                Symbol                Characteristic            Min.     Typ.      Max.        Units             Test Conditions
   Num.
 A011            CHn+-      Analog Input Absolute                 -1                 +1            V      All analog input channels,
                            Voltage                                                                       measured to AGND
                                                                                                          (Note 7)
 A012             AIN       Analog Input Leakage                           1                      nA      (Note 4)
                            Current
 A013           (CHn+-      Differential Input Voltage                             500 /        mVP       (Note 1)
                 CHn-)      Range                                                  GAIN
 A014             VOS       Offset Error                          -3                  3          mV       (Note 6)(Note 2)
 A015                       Offset Error Drift                             1                    μV/C      From -40°C to 125°C
 A016             GE        Gain Error                            -3                  3           %       All Gains
 A017                       Gain Error Drift                      —        2          —       ppm/°C From -40°C to 125°C
 A018             INL       Integral Non-Linearity                        15                    ppm       GAIN = 1, DITHER = ON
 A019              ZIN      Input Impedance                     350        —          —          kΩ       Proportional to 1/AMCLK
 A020           SINAD       Signal-to-Noise and                  89       91          —           dB      T = 25°C
                            Distortion Ratio                     80      81.5                     dB
 A021             THD       Total Harmonic Distortion                    -100       -97           dB      OSR = 256, DITHER = ON;
                                                                                                          (Note 2)(Note 3)
                                                                          -90        -87          dB
 A022             SNR       Signal To Noise Ratio                90      91.5                     dB      T = 25°C
                                                                 80      81.5                     dB
 A023            SFDR       Spurious Free Dynamic                         102                     dB      OSR = 256, DITHER = ON;
                            Range                                                                         (Note 2) (Note 3)
                                                                          91                      dB
 A024           CTALK       Crosstalk (50 / 60 Hz)                —      -115         —           dB      OSR = 256, DITHER = ON;
                                                                                                          (Note 2)(Note 3)
 A025         AC PSRR AC Power Supply Rejection                   —       -68         —           dB      AVDD = 5V + 1Vpp @ 50 Hz
 A026         DC PSRR DC Power Supply Rejection                   —       -68         —           dB      AVDD = 4.5 to 5.5V, DVDD =
                                                                                                          3.3V
 A027           CMRR        DC Common Mode Rejection              —       -75         —           dB      VCM varies from -1V to +1V;
                            Ratio                                                                         (Note 2)
 Oscillator Input
 Note 1:    This specification implies that the ADC output is valid over this entire differential range, i.e. there is no distortion or
           instability across this input range. Dynamic Performance is specified at -0.5 dB below the maximum signal range,
           VIN = -0.5 dBFS @ 50/60 Hz = 333 mVRMS, VREF = 2.4V.
       2:  See terminology section for definition.
       3:  This parameter is established by characterization and not 100% tested.
       4:  For these operating currents, the following configuration bit settings apply: Config Register Settings:
           SHUTDOWN<5:0> = 000000, RESET<5:0> = 000000; VREFEXT = 0, CLKEXT = 0.
       5:  For these operating currents, the following configuration bit settings apply: Config Register Settings:
           SHUTDOWN<5:0> = 111111, VREFEXT = 1, CLKEXT = 1.
       6:  Applies to all gains. Offset error is dependant on PGA gain setting.
       7:  Outside of this range, ADC accuracy is not specified. An extended input range of +/- 6V can be applied continuously to
           the part with no risk for damage.
       8:  For proper operation and to keep ADC accuracy, AMCLK should always be in the range of 1 to 5 MHz with BOOST bits
           off. With BOOST bits on, AMCLK should be in the range of 1 to 8.192 MHz. AMCLK = MCLK/PRESCALE. When using a
           crystal, CLKEXT bit should be equal to ‘0’.
DS25048B-page 4                                                                                         © 2011 Microchip Technology Inc.


                                                                                                                MCP3903
TABLE 1-1:            ANALOG SPECIFICATIONS TARGET TABLE (CONTINUED)
 Electrical Specifications: Unless otherwise indicated, all parameters apply at AVDD = 4.5 to 5.5V, DVDD = 2.7 to
 3.6V, Internal VREF, MCLK = 4 MHz;PRESCALE = 1; OSR = 64; fS = 1 MHz; fD = 15.625 ksps; TA = -40°C to +125°C,
 GAIN = 1, VIN = 1VPP = 353mVRMS @ 50/60 Hz.
  Param.
                Symbol                Characteristic            Min.     Typ.      Max.        Units             Test Conditions
   Num.
 A028            MCLK       Master Clock Frequency                1       —       16.384        MHz       (Note 8)
                            Range
 Power Specifications
 P001             AVDD      Operating Voltage, Analog            4.5      —          5.5           V
 P002            DVDD       Operating Voltage, Digital           2.7      —          3.6           V
 P003             AIDD      Operating Current, Analog                     7.1         9          mA       BOOST bits low on all chan-
                            (Note 4)                                                                      nels
                                                                         12.3       16.8         mA       BOOST bits high on all
                                                                                                          channels
 P004             DIDD      Operating Current, Digital            —       1.2        1.7         mA       DVDD = 3.6V, MCLK =
                                                                                                          4 MHz
                                                                  —       2.4        3.4         mA       DVDD = 3.6V, MCLK =
                                                                                                          8.192 MHz
 P005            IDDS,A     Shutdown Current, Analog              —       —           1           μA      -40°C to 85°C, AVDD pin
                                                                                                          only, (Note 5)
                                                                  —       —           3           μA      -40°C to 125°C, AVDD pin
                                                                                                          only, (Note 5)
 P006            IDDS,D     Shutdown Current, Digital             —       —           1           μA      -40°C to 85°C, DVDD pin
                                                                                                          only, (Note 5)
                                                                  —       —           5           μA      -40°C to 125°C, DVDD pin
                                                                                                          only, (Note 5)
 Note 1:    This specification implies that the ADC output is valid over this entire differential range, i.e. there is no distortion or
           instability across this input range. Dynamic Performance is specified at -0.5 dB below the maximum signal range,
           VIN = -0.5 dBFS @ 50/60 Hz = 333 mVRMS, VREF = 2.4V.
       2:  See terminology section for definition.
       3:  This parameter is established by characterization and not 100% tested.
       4:  For these operating currents, the following configuration bit settings apply: Config Register Settings:
           SHUTDOWN<5:0> = 000000, RESET<5:0> = 000000; VREFEXT = 0, CLKEXT = 0.
       5:  For these operating currents, the following configuration bit settings apply: Config Register Settings:
           SHUTDOWN<5:0> = 111111, VREFEXT = 1, CLKEXT = 1.
       6:  Applies to all gains. Offset error is dependant on PGA gain setting.
       7:  Outside of this range, ADC accuracy is not specified. An extended input range of +/- 6V can be applied continuously to
           the part with no risk for damage.
       8:  For proper operation and to keep ADC accuracy, AMCLK should always be in the range of 1 to 5 MHz with BOOST bits
           off. With BOOST bits on, AMCLK should be in the range of 1 to 8.192 MHz. AMCLK = MCLK/PRESCALE. When using a
           crystal, CLKEXT bit should be equal to ‘0’.
© 2011 Microchip Technology Inc.                                                                                          DS25048B-page 5


MCP3903
1.2        SERIAL INTERFACE CHARACTERISTICS
SERIAL INTERFACE SPECIFICATIONS
  Electrical Specifications: Unless otherwise indicated, all parameters apply at AVDD = 4.5 to 5.5V,
  DVDD = 2.7 to 3.6V, -40°C < TA <+125°C, CLOAD = 30 pF.
                 Parameters                     Sym       Min    Typ       Max    Units          Conditions
 Serial Clock frequency                         fSCK       —      —         10    MHz 2.7 ≤ DVDD < 3.6
 CS setup time                                  tCSS       50     —         —      ns    2.7 ≤ DVDD < 3.6
 CS hold time                                   tCSH      100     —         —      ns    2.7 ≤ DVDD < 3.6
 CS disable time                                tCSD       50     —         —      ns    —
 Data setup time                                 tSU       10     —         —      ns    2.7 ≤ DVDD < 3.6
 Data hold time                                   tHD      20     —         —      ns    2.7 ≤ DVDD < 3.6
 Serial Clock high time                            tHI     40     —         —      ns    2.7 ≤ DVDD < 3.6
 Serial Clock low time                            tLO      40     —         —      ns    2.7 ≤ DVDD < 3.6
 Serial Clock delay time                         tCLD      50     —         —      ns    —
 Serial Clock enable time                        tCLE      50     —         —      ns    —
 Output valid from SCK low                        tDO      —      —         50     ns    2.7 ≤ DVDD < 3.6
 Output hold time                                 tHO      0      —         —      ns
 Output disable time                             tDIS      —      —         50     ns    2.7 ≤ DVDD < 3.6
 Reset Pulse Width (RESET)                     tMCLR      100     —         —      ns    2.7 ≤ DVDD < 3.6
 Data Transfer Time to DR (Data Ready)         tDODR              —         50     ns    2.7 ≤ DVDD < 3.6
 Data Ready Pulse Low Time                      tDRP              1/        —      µs    2.7 ≤ DVDD < 3.6
                                                                DMCLK
 Schmitt Trigger High-level Input voltage       VIH1   .7 DVDD    —     DVDD +1     V
 (All digital inputs)
 Schmitt Trigger Low-level input voltage        VIL1      -0.3    —        0.25     V
 (All digital inputs)                                                     DVDD
 Hysteresis of Schmitt Trigger Inputs           VHYS       50     —                mV
 (All digital inputs)
 Low-level output voltage, SDO pin              VOL        —      —         0.4     V    SDO pin only, IOL = 2 mA,
                                                                                         DVDD = 3.3V
 Low-level output voltage, DRn pins             VOL                         0.4     V    DRn pins only,
                                                                                         IOL = +1.5 mA, DVDD =3.3V
 High-level output voltage, SDO pin             VOH     DVDD -    —         —       V    SDO pin only,
                                                          0.5                            IOH = -2 mA, DVDD = 3.3V
 High-level output voltage, DRn pins            VOH     DVDD -    —         —       V    DRn pins only,
 only                                                     0.5                            IOH = -1.5 mA, DVDD=3.3V
 Input leakage current                             ILI     —      —         ±1     µA    CS = DVDD, Inputs tied to
                                                                                         DVDD OR DGND
 Output leakage current                          ILO       —      —         ±1     µA    CS = DVDD, Inputs tied to
                                                                                         DVDD OR DGND
 Internal capacitance (all inputs and           CINT       —      —          7     pF    TA = 25°C, SCK = 1.0 MHz
 outputs)                                                                                DVDD = 3.3V (Note 1)
 Note 1:       This parameter is periodically sampled and not 100% tested.
DS25048B-page 6                                                                         © 2011 Microchip Technology Inc.


                                                                                            MCP3903
TEMPERATURE CHARACTERISTICS
 Electrical Specifications: Unless otherwise indicated, all parameters apply at AVDD = 4.5 to 5.5V, DVDD = 2.7 to
 3.3 V.
           Parameters                   Sym        Min     Typ    Max         Units              Conditions
Temperature Ranges
Operating Temperature Range              TA        -40      —    +125           °C                 (Note 1)
Storage Temperature Range                TA        -65      —    +150           °C
Thermal Package Resistances
Thermal Resistance, 28-lead              θJA        —       71     —          °C/W
SSOP
Note 1:     The internal junction temperature (TJ) must not exceed the absolute maximum specification of +150°C.
   CS
                              fSCK                                                             tCSH
                          tHI       tLO
                                                                                                          Mode 1,1
  SCK                                                                                                     Mode 0,0
                                   tDO                                                         tDIS
                                                                         tHO
 SDO                  MSB out                                                                LSB out
                                                 Don’t Care
   SDI
FIGURE 1-1:             Serial Output Timing Diagram.
                                                                                                tCSD
    CS                                                                                             tCLE
                   tCSS                          fSCK
                                                                                    tCSH         tCLD
                                             tHI      tLO
           Mode 1,1
    SCK    Mode 0,0
                      tSU      tHD
    SDI                MSB in                                                  LSB in
                                                 HI-Z
    SDO
FIGURE 1-2:               Serial Input Timing Diagram.
© 2011 Microchip Technology Inc.                                                                       DS25048B-page 7


MCP3903
H
                                                            1 / DRCLK
     DR
                                                                                                      tDRP
                         tDODR
     SCK
     SDO
FIGURE 1-3:           Data Ready Pulse Timing Diagram.
H
                       Timing Waveform for tDO                             Timing Waveform for tDIS
         SCK                                                                   VIH
                                                                  CS
                                 tDO
                                                                                         90%
         SDO                                                      SDO
                                                                                tDIS                    HI-Z
                                                                                           10%
                    Timing Waveform for MDAT0/1
                            Modulator Output
         OSC1/CLKI
                                          tDOMDAT
         MDAT0/1
FIGURE 1-4:           Specific Timing Diagrams.
                             CLKEXT            PRESCALE<1:0>                             OSR<1:0>
            Digital Buffer                                                     fS ADC                    fD ADC
                                                                               Sampling                  Output
                            1                                                  Rate                      Data Rate
                                                   1/               1/4                   1 / OSR
                                               Prescale
  OSC1                                  MCLK              AMCLK                DMCLK                     DRCLK
                            0
  OSC2
                            Multiplexer      Clock Divider       Clock Divider          Clock Divider
            Crystal
            Oscillator
FIGURE 1-5:           MCP3903 Clock Detail.
DS25048B-page 8                                                                       © 2011 Microchip Technology Inc.


                                                                                             MCP3903
2.0     TYPICAL PERFORMANCE CURVES
  Note:    The graphs and tables provided following this note are a statistical summary based on a limited number of
           samples and are provided for informational purposes only. The performance characteristics listed herein
           are not tested or guaranteed. In some graphs or tables, the data presented may be outside the specified
           operating range (e.g., outside specified power supply range) and therefore outside the warranted range.
Note: Unless otherwise indicated, AVDD = 5.0V, DVDD = 3.3 V; Internal VREF; TA = +25°C, MCLK = 4 MHz; PRESCALE
= 1; OSR = 64; GAIN = 1; Dithering OFF; VIN = -0.5 dBFS @ 60 Hz.
.
FIGURE 2-1:            Spectral Response.                      FIGURE 2-4:            Spectral Response.
FIGURE 2-2:            Spectral Response.                      FIGURE 2-5:            Spectral Response.
FIGURE 2-3:            Spectral Response.                      FIGURE 2-6:            Spectral Response.
© 2011 Microchip Technology Inc.                                                                     DS25048B-page 9


MCP3903
Note: Unless otherwise indicated, AVDD = 5.0V, DVDD = 3.3 V; TA = +25°C, MCLK = 4 MHz; PRESCALE = 1; OSR =
64; GAIN = 1; Dithering OFF; VIN = -0.5 dBFS @ 60 Hz.
.
                                                                                                100
                                                                                                 95
                                                                                                 90
                                                                                                                                   OSR = 256
                                                                                                 85
                                                                                   SINAD
                                                                                     NAD (dB)
                                                                                           B)
                                                                                                 80
                                                                                                 75             OSR = 64
                                                                                                                                                      OSR = 128
                                                                                                 70
                                                                                                 65                  OSR = 32
                                                                                                 60
                                                                                                 55
                                                                                                 50
                                                                                                                1         2        4      8       16       32
                                                                                                                                  GAIN (V/V)
FIGURE 2-7:                                      Spectral Response.               FIGURE 2-10:         Signal-to-Noise and
                                                                                  Distortion vs. Gain (Dithering OFF).
                              120                                                                         100
                                                               Dithering ON
      Spurious
         rious Free Dynamic
                         ic
                                                                                                           95
                              100                                                                                                    OSR = 256
                                                                                                           90
                                                              Dithering OFF                                85
                                  80
                                                                                            SINAD
                                                                                               AD (dB))
                                                                                                           80
                                                                                                                                                 OSR = 128
                                  60                                                                       75
            Range
              nge (dB)
                    B)
                                                                                                           70
                                  40                                                                                 OSR = 64
                                                                                                           65
                                  20                                                                       60
                                                                                                                     OSR = 32
                                                                                                           55
                                   0                                                                       50
                                          32         64      128        256                                      1         2       4      8      16       32
                                               Oversampling Ratio (OSR)                                                           GAIN (V/V)
FIGURE 2-8:      Spurious Free Dynamic                                            FIGURE 2-11:         Signal-to-Noise and
Range vs Oversampling Ratio.                                                      Distortion vs. Gain (Dithering ON).
                 120
                 100                                               Dithering ON
                                       Dithering OFF
    SINAD
      NAD (dB)
            B)
                      80
                      60
                      40
                      20
                              0
                                       32        64        128       256
                                            Oversampling Ratio (OSR)
FIGURE 2-9:          Signal-to-Noise and
Distortion vs. Oversampling Ratio.                                                FIGURE 2-12:       Total Harmonic Distortion
                                                                                  vs. Oversampling Ratio.
DS25048B-page 10                                                                                                                © 2011 Microchip Technology Inc.


                                                                                                                                                 MCP3903
Note: Unless otherwise indicated, AVDD = 5.0V, DVDD = 3.3 V; TA = +25°C, MCLK = 4 MHz; PRESCALE = 1; OSR =
64; GAIN = 1; Dithering OFF; VIN = -0.5 dBFS @ 60 Hz.
.
                                           -60                                                                          120
                                                                                  fs=15.625KHz                                                             fs=15.625KHz
             Total Harmonic
                        onic Distortion
                               stortion
                                     on
                                                                                  OSR 64
                                                                                  OSR=64                                                                   OSR=64
                                           -70                                                                          100
                                                                                                                         80
                                                                                                          SINAD
                                                                                                             AD (dB))
                                           -80
                                            80
                                                          Dithering OFF
                                           -90                                                                           60
                        dBc)
                       (dBc)
                                          -100                                                                           40
                                                          Dithering ON
                                          -110                                                                           20
                                          -120                                                                            0
                                                     20        50      100 200 500 1000 2000                                  -40    -20   0  25    45    85   105 125
                                                                    Input Frequency (Hz)                                                   Temperature (°C)
FIGURE 2-13:         Total Harmonic Distortion                                                     FIGURE 2-16:        Signal-to-Noise and
vs. Input Signal Frequency.                                                                        Distortion vs. Temperature.
                                            0                                                                   90
     Total Harmonic
              monic Distortion
                            on
                                                                                    fs=15.625KHz                80
                                          -20                                       OSR=64
                                                                                                                70
                                                                                                     SINAD
                                                                                                       NAD (dB)
                                                                                                             B)
                                                                                                                60
                                          -40
                                                                                                                50
                                          -60                                                                   40
               (dBc)
                                                                                                                30
                                          -80                                                                   20
                                    -100                                                                        10
                                                                                                                 0
                                    -120                                                                       -10
                                                     -40 -20         0  25 45 85        105 125                 0.00001              0.001       0.1       10       1000
                                                                     Temperature (°C)                                               Input Signal Amplitude (mV)
FIGURE 2-14:                                                        Total Harmonic Distortion      FIGURE 2-17:          Signal-to-Noise and
vs. Temperature.                                                                                   Distortion vs. Input Signal Amplitude.
                  100
                   90                                     Dithering OFF
                   80
                   70
    SINAD
      NAD (dB)
            B)
                                                           Dithering ON
                   60
                   50
                   40
                   30
                                                                                    fs=15 625KHz
                                                                                    fs=15.625KHz
                   20
                                                                                    OSR=64
                   10
                    0
                                                20        50     100 200 500 1000 2000
                                                               Input Frequency (Hz)
FIGURE 2-15:          Signal-to-Noise and
                                                                                                   FIGURE 2-18:         Signal-to-Noise and
Distortion vs. Input Signal Frequency.
                                                                                                   Distortion vs. Master Clock.
© 2011 Microchip Technology Inc.                                                                                                                        DS25048B-page 11


MCP3903
Note: Unless otherwise indicated, AVDD = 5.0V, DVDD = 3.3 V; TA = +25°C, MCLK = 4 MHz; PRESCALE = 1; OSR =
64; GAIN = 1; Dithering OFF; VIN = -0.5 dBFS @ 60 Hz.
                           1.40                                                                                                  2.360
                                                                                                    Int. Voltage
                                                                                                               e Reference
                                                                                                                     rence (V)
                                                                 G=8
                           1.20
                           1 20
                                                G=1
    Offset Error (mV)
                           1.00                                                                                                  2.355
                                                                            G=16
                           0.80
                           0.60                                             G=2
                                                                                                                                 2.350
                           0.40
                           0.20
                                                                                                                                 2.345
                           0.00
                           0 00               G=4
                          -0.20
                                               G=32
                          -0.40                                                                                                  2.340
                                        -40     -20    0  25 45 85         105 125                                                         -40   -20    0  25 45 85         105 125
                                                       Temperature (°C)                                                                                 Temperature (°C)
FIGURE 2-19:                                           Offset Error vs. Temperature   FIGURE 2-22:                                                     Internal Voltage Reference
(Channel 0).                                                                          vs. Temperature.
                        1.60                                                                                                     2.35473
                                                        CH1                  CH3
                        1.40
                        1 40                                                                                                     2.35472
                                                                                                                                 2 35472
                                                                                       Int.
                                                                                        nt. Voltage
                                                                                                age Reference
                                                                                                          nce (V)
 Offsett Errorr (mV)
                        1.20
                                                                                                                                 2.35471
                        1.00
                        1 00
                                        CH2            CH0                                                                       2.35470
                        0.80
                                                                              CH5
                        0.60
                        0 60                                                                                                     2.35469
                                                                                                                                 2 35469
                        0.40                                                CH4                                                  2.35468
                        0.20
                                                                                                                                 2.35467
                        0.00
                                                                                                                                 2 35466
                                                                                                                                 2.35466
                                        -40    -20     0  25 45 85         105 125
                                                                                                                                           4.5                 5                   5.5
                                                       Temperature (°C)
                                                                                                                                                        Power Supply (V)
FIGURE 2-20:      Channel-to-Channel Offset                                           FIGURE 2-23:        Internal Voltage Reference
Match vs. Temperature.                                                                vs. Supply Voltage.
                                0.00
                                -0.05                                G=1
                                                G=8
               Gain Error (%)
                                -0.10
                                              G=2             G=16
                                -0.15
                                              G=32
                                -0.20
                                               G=4
                                -0.25
                                -0.30
                                 0 30
                                         -40     -20   0  25 45 85         105 125
                                                       Temperature (°C)
FIGURE 2-21:                                           Gain Error vs. Temperature.
                                                                                      FIGURE 2-24:                                                     Noise Histogram.
DS25048B-page 12                                                                                                                                        © 2011 Microchip Technology Inc.


                                                                                   MCP3903
Note: Unless otherwise indicated, AVDD = 5.0V, DVDD = 3.3 V; TA = +25°C, MCLK = 4 MHz; PRESCALE = 1; OSR =
64; GAIN = 1; Dithering OFF; VIN = -0.5 dBFS @ 60 Hz.
                  50
                  40                                                 CH0
                  30
                  20
     INL
       L (ppm)
            m)
                  10
                               CH1
                   0
                  10
                 -10
                 -20
                  30
                 -30
                 -40
                 -50
                     -0.5        -0.25            0           0.25         0.5
                                         Input Voltage (V)
FIGURE 2-25:                             Integral Non-Linearity
(Dithering OFF).
                     50
                     40
                     30
                                                        CH0
                     20
                     10
INL (ppm)
                      0
                                                         CH1
                     10
                    -10
                    -20
                     30
                    -30
                    -40
                    -50
                        -0.5     -0.25           0          0.25           0.5
                                          Input Voltage (V)
FIGURE 2-26:                             Integral Non-Linearity
(Dithering ON).
                     9
                     8
                                AIDD Boost OFF
                     7
                     6
        IDD
          D (mA))
                     5
                     4
                     3
                     2
                                            DIDD
                     1
                     0
                         1             2          3                        4
                                     MCLK Frequency(MHz)
FIGURE 2-27:      Operating Current vs.
Master Clock (MCLK).
© 2011 Microchip Technology Inc.                                                         DS25048B-page 13


MCP3903
3.0        PIN DESCRIPTION
TABLE 3-1:          PIN FUNCTION TABLE
      Pin No.         Symbol                                               Function
         1              AVDD         Analog Power Supply Pin
         2              CH0+         Non-Inverting Analog Input Pin for Channel 0
         3              CH0-         Inverting Analog Input Pin for Channel 0
         4              CH1-         Inverting Analog Input Pin for Channel 1
         5              CH1+         Non-Inverting Analog Input Pin for Channel 1
         6              CH2+         Non-Inverting Analog Input Pin for Channel 2
         7              CH2-         Inverting Analog Input Pin for Channel 2
         8              CH3-         Inverting Analog Input Pin for Channel 3
         9              CH3+         Non-Inverting Analog Input Pin for Channel 3
        10              CH4+         Non-Inverting Analog Input Pin for Channel 4
        11              CH4-         Inverting Analog Input Pin for Channel 4
        12              CH5-         Inverting Analog Input Pin for Channel 5
        13              CH5+         Non-Inverting Analog Input Pin for Channel 5
        14          REFIN+/OUT       Non-Inverting Voltage Reference Input and Internal Reference Output Pin
        15             REFIN-        Inverting Voltage Reference Input Pin
        16              AGND         Analog Ground Pin, Return Path for internal analog circuitry
        17              DGND         Digital Ground Pin, Return Path for internal digital circuitry
        18              DRA          Data Ready Signal Output for channels pair A
        19              DRB          Data Ready Signal Output for channels pair B
        20              DRC          Data Ready Signal Output for channels pair C
        21             OSC1          Oscillator Crystal Connection Pin or Clock Input Pin
        22             OSC2          Oscillator Crystal Connection Pin
        23               CS          Chip Select for Serial Interface
        24              SCK          Serial Interface Clock Pin
        25              SDO          Serial Interface Data Output Pin
        26               SDI         Serial Interface Data Input Pin
        27             RESET         Master Reset Logic Input Pin
        28              DVDD         Digital Power Supply Pin
3.1        RESET                                                    enabled during a reset so that the part is fully
                                                                    operational just after a RESET rising edge. This input
This pin is active low and places the entire chip in a              is Schmitt triggered.
reset state when active.
When RESET=0, all registers are reset to their default              3.2      Digital VDD (DVDD)
value, no communication can take place, no clock is
distributed inside the part. This state is equivalent to a          DVDD is the power supply pin for the digital circuitry
POR state.                                                          within the MCP3903. This pin requires appropriate
                                                                    bypass capacitors and should be maintained between
Since the default state of the ADCs is on, the analog               2.7V and 3.6V for specified operation.
power consumption when RESET = 0 is equivalent to
when RESET = 1. Only the digital power consumption
is largely reduced because this current consumption is
essentially dynamic and is reduced drastically when
there is no clock running. All the analog biases are
DS25048B-page 14                                                                             © 2011 Microchip Technology Inc.


                                                                                           MCP3903
3.3       Analog VDD (AVDD)                                3.7       Inverting Reference Input (REFIN-)
AVDD is the power supply pin for the analog circuitry      This pin is the inverting side of the differential voltage
within the MCP3903.                                        reference input for both ADCs. When using an external
This pin requires appropriate bypass capacitors and        differential voltage reference, it should be connected to
should be maintained to 5V ±10% for specified              its VREF- pin. When using an external single-ended
operation.                                                 voltage reference, or when VREFEXT = 0 (Default)
                                                           and using the internal voltage reference, this pin should
                                                           be directly connected to AGND.
3.4       ADC Differential Analog
          Inputs(CHn+/CHn-)                                3.8       Digital Ground Connection
CHn- and CHn+, are the two fully-differential analog                 (DGND)
voltage inputs for the Delta-Sigma ADCs. There are six
channels in total grouped in three channel pairs.          DGND is the ground connection to internal digital
                                                           circuitry (SINC filters, oscillator, serial interface). To
The linear and specified region of the channels are        ensure accuracy and noise cancellation, DGND must
dependent on the PGA gain. This region corresponds         be connected to the same ground as AGND, preferably
to a differential voltage range of ±500 mV/GAIN with       with a star connection. If a digital ground plane is
VREF = 2.4V. The maximum absolute voltage, with            available, it is recommended that this pin be tied to this
respect to AGND, for each CHn+/- input pin is +/-1V        plane of the Printed Circuit Board (PCB). This plane
with no distortion and ±6V with no breaking after          should also reference all other digital circuitry in the
continuous voltage.                                        system.
3.5       Analog Ground (AGND)                             3.9       DRn (Data Ready Pins)
AGND is the ground connection to internal analog           The Data Ready pins indicate if a new conversion
circuitry (ADCs, PGA, voltage reference, POR). To          result is ready to be read on each of the A, B and C
ensure accuracy and noise cancellation, this pin must      pairs of ADCs. The default state of this pin is high when
be connected to the same ground as DGND, preferably        DR_HIZN=1 and is high impedance when DR_HIZN=0
with a star connection. If an analog ground plane is       (Default). After each conversion is finished, a low pulse
available, it is recommended that this pin be tied to this will take place on the data ready pins to indicate the
plane of the PCB. This plane should also reference all     conversion result is ready as an interrupt. This pulse is
other analog circuitry in the system.                      synchronous with the master clock and has a defined
                                                           and constant width.
3.6       Non-Inverting Reference Input,                   The Data Ready pins are independent of the SPI
          Internal Reference Output                        interface and act like an interrupt output.The Data
          (REFIN+/OUT)                                     Ready pins state is not latched and the pulse width
                                                           (and period) are both determined by the MCLK
This pin is the non-inverting side of the differential
                                                           frequency, over-sampling rate, and internal clock pre-
voltage reference input for all ADCs or the internal
                                                           scale settings. The DR pulse width is equal to one
voltage reference output. When VREFEXT = 1, and an
                                                           DMCLK period and the frequency of the pulses is equal
external voltage reference source can be used, the
                                                           to DRCLK (see Figure 1-3).
internal voltage reference is disabled. When using an
external differential voltage reference, it should be
connected to its VREF+ pin.                                   Note:      These pins should not be left floating
When using an external single-ended reference, it                        when DR_HIZ bit is low; a 100kΩ pull-up
should be connected to this pin.                                         resistor connected to DVDD is recom-
When VREFEXT = 0, the internal voltage reference is                      mended.
enabled and connected to this pin through a switch.
This voltage reference has minimal drive capability and
thus needs proper buffering and bypass capacitances
(10 μF tantalum in parallel with 0.1 μF ceramic) if used
as a voltage source.
For optimal performance, bypass capacitances should
be connected between this pin and AGND at all times
even when the internal voltage reference is used.
© 2011 Microchip Technology Inc.                                                                   DS25048B-page 15


MCP3903
3.10      Oscillator And Master Clock Input             3.12      SCK (Serial Data Clock)
          Pins (OSC1/CLKI, OSC2)                        This is the serial clock pin for SPI communication. Data
OSC1/CLKI and OSC2 provide the master clock for the     is clocked into the device on the RISING edge of SCK.
device. When CLKEXT = 0 (Default), a resonant           Data is clocked out of the device on the FALLING edge
crystal or clock source with a similar sinusoidal       of SCK. The MCP3903 interface is compatible with
waveform must be placed across these pins to ensure     both SPI 0,0 and 1,1 modes. The maximum clock
proper operation. The typical clock frequency specified speed specified is 10 MHz. This input is Schmitt
is 4 MHz. However, the clock frequency can be 1 MHz     triggered.
to 5 MHz without disturbing ADC accuracy. With the
current boost circuit enabled, the master clock can be  3.13      SDO (Serial Data Output)
used up to 8.192 MHz without disturbing ADC
accuracy. Appropriate load capacitance should be        This is the SPI data output pin. Data is clocked out of
connected to these pins for proper operation.           the device on the FALLING edge of SCK. This pin stays
                                                        at high impedance during the control byte. It also stays
                                                        at high impedance during the whole communication for
   Note:     When CLKEXT = 1, the crystal oscillator    write commands and when the CS pin is high or when
             is disabled, as well as the OSC2 input.    the RESET pin is low. This pin is active only when a
             The OSC1 becomes the master clock          read command is processed. Each read is processed
             input CLKI, direct path for an external    by a packet of 24 bits (size of each register), except on
             clock source, for example a clock source   the ADC output registers when WIDTH=0.
             generated by an MCU.
                                                        3.14      SDI (Serial Data Input)
3.11      CS (Chip Select)                              This is the SPI data input pin. Data is clocked into the
                                                        device on the RISING edge of SCK. When CS is low,
This pin is the SPI Chip Select that enables the serial this pin is used to communicate with a series of 8-bit
communication. When this pin is high, no                commands. The interface is half-duplex (inputs and
communication can take place. A chip select falling     outputs do not happen at the same time). Each
edge initiates the serial communication and a chip      communication starts with a chip select falling edge
select rising edge terminates the communication. No     followed by an 8-bit control byte entered through the
communication can take place even when CS is low        SDI pin. Each write is processed by packets of 24 bits
and when RESET is low.                                  (size of each register). Each command is either a Read
This input is Schmitt-triggered.                        or a Write command. Toggling SDI during a Read
                                                        command has no effect. This input is Schmitt-triggered.
DS25048B-page 16                                                                  © 2011 Microchip Technology Inc.


                                                                                                                MCP3903
4.0       TERMINOLOGY AND                                4.2       AMCLK - Analog Master Clock
          FORMULAS                                       This is the clock frequency that is present on the analog
This section defines the terms and formulas used         portion of the device, after prescaling has occurred via
throughout this data sheet. The following terms are      the CONFIG PRESCALE<1:0> register bits. The
defined:                                                 analog portion includes the PGAs and the two
                                                         sigma-delta modulators.
MCLK - Master Clock
AMCLK - Analog Master Clock                              EQUATION 4-1:
DMCLK - Digital Master Clock
                                                                                                                MCLK
DRCLK - Data Rate Clock                                                       AMCLK = -------------------------------
                                                                                                         PRESCALE
OSR - Oversampling Ratio
Offset Error                                             TABLE 4-1:                   MCP3903 OVERSAMPLING
Gain Error                                                                            RATIO SETTINGS
Integral Non-Linearity Error                                   Config                              Analog Master Clock
Signal-To-Noise Ratio (SNR)                                  PRE<1:0>                                             Prescale
Signal-To-Noise Ratio And Distortion (SINAD)                 0          0                  AMCLK = MCLK/ 1 (default)
Total Harmonic Distortion (THD)                              0          1                               AMCLK = MCLK/ 2
Spurious-Free Dynamic Range (SFDR)                           1          0                               AMCLK = MCLK/ 4
MCP3903 Delta-Sigma Architecture                             1          1                               AMCLK = MCLK/ 8
Idle Tones
                                                         4.3       DMCLK - Digital Master Clock
Dithering
                                                         This is the clock frequency that is present on the digital
Crosstalk
                                                         portion of the device, after prescaling and division by 4.
PSRR                                                     This is also the sampling frequency, that is the rate at
CMRR                                                     which the modulator outputs are refreshed. Each
                                                         period of this clock corresponds to one sample and one
ADC Reset Mode
                                                         modulator output.
Hard Reset Mode (RESET = 0)
ADC Shutdown Mode                                        EQUATION 4-2:
Full Shutdown Mode                                                                      AMCLK                             MCLK
                                                                  DMCLK = --------------------- = ----------------------------------------
                                                                                            4                    4 × PRESCALE
4.1       MCLK - Master Clock
This is the fastest clock present in the device. This is
the frequency of the crystal placed at the OSC1/OSC2
                                                         4.4       DRCLK - Data Rate Clock
inputs when CLKEXT = 0 or the frequency of the clock     This is the output data rate i.e. the rate at which the
input at the OSC1/CLKI when CLKEXT = 1.                  ADCs output new data. Each new data is signaled by a
                                                         data ready pulse on the DR pin.
                                                         This data rate is depending on the OSR and the
                                                         prescaler with the following formula:
                                                         EQUATION 4-3:
                                                                      DMCLK                AMCLK                                        MCLK
                                                          DRCLK = ---------------------- = --------------------- = -----------------------------------------------------------
                                                                        OSR                4 × OSR                 4 × OSR × PRESCALE
© 2011 Microchip Technology Inc.                                                                                             DS25048B-page 17


MCP3903
Since this is the output data rate, and since the           The following table describes the various combinations
decimation filter is a SINC (or notch) filter, there is a   of OSR and PRESCALE and their associated AMCLK,
notch in the filter transfer function at each integer       DMCLK and DRCLK rates.
multiple of this rate.
TABLE 4-2:          DEVICE DATA RATES IN FUNCTION OF MCLK, OSR, AND PRESCALE
        PRE                                                                                              DRCLK
                       OSR <1:0>      OSR            AMCLK       DMCLK               DRCLK
       <1:0>                                                                                              (ksps)
    1         1         1      1       256           MCLK/8     MCLK/32             MCLK/8192             0.4882
    1         1         1      0       128           MCLK/8     MCLK/32             MCLK/4096              0.976
    1         1         0      1        64           MCLK/8     MCLK/32             MCLK/2048              1.95
    1         1         0      0        32           MCLK/8     MCLK/32             MCLK/1024               3.9
    1         0         1      1       256           MCLK/4     MCLK/16             MCLK/4096              0.976
    1         0         1      0       128           MCLK/4     MCLK/16             MCLK/2048              1.95
    1         0         0      1        64           MCLK/4     MCLK/16             MCLK/1024               3.9
    1         0         0      0        32           MCLK/4     MCLK/16             MCLK/512              7.8125
    0         1         1      1       256           MCLK/2      MCLK/8             MCLK/2048              1.95
    0         1         1      0       128           MCLK/2      MCLK/8             MCLK/1024               3.9
    0         1         0      1        64           MCLK/2      MCLK/8             MCLK/512              7.8125
    0         1         0      0        32           MCLK/2      MCLK/8             MCLK/256              15.625
    0         0         1      1       256            MCLK       MCLK/4             MCLK/1024               3.9
    0         0         1      0       128            MCLK       MCLK/4             MCLK/512              7.8125
    0         0         0      1        64            MCLK       MCLK/4             MCLK/256              15.625
    0         0         0      0        32            MCLK       MCLK/4             MCLK/128               31.25
  Note:      For OSR = 32 and 64, DITHER = 0. For OSR = 128 and 256, DITHER = 1.
4.5       OSR - Oversampling Ratio                          4.6        Offset Error
The ratio of the sampling frequency to the output data      This is the error induced by the ADC when the inputs
rate is OSR = DMCLK/DRCLK. The default OSR is 64,           are shorted together (VIN = 0V). The specification
or with MCLK = 4 MHz, PRESCALE = 1, AMCLK = 4               incorporates both PGA and ADC offset contributions.
MHz, fS = 1 MHz, fD = 15.625 ksps. The following bits       This error varies with PGA and OSR settings. The
in the CONFIG1 register are used to change the              offset is different on each channel and varies from chip
oversampling ratio (OSR).                                   to chip. This offset error can easily be calibrated out by
                                                            a MCU with a subtraction. The offset is specified in mV.
TABLE 4-3:          MCP3903 OVERSAMPLING
                                                            The offset on the MCP3903 has a low temperature
                    RATIO SETTINGS
                                                            coefficient, see Section 2.0 “Typical Performance
     CONFIG               OVER SAMPLING RATIO               Curves”.
                                  (OSR)
    OSR<1:0>
                                                            4.7        Gain Error
    0         0                     32
                                                            This is the error induced by the ADC on the slope of the
    0         1               64 (DEFAULT)
                                                            transfer function. It is the deviation expressed in %
    1         0                    128                      compared to the ideal transfer function defined by
    1         1                    256                      Equation 5-3. The specification incorporates both PGA
                                                            and ADC gain error contributions, but not the VREF
                                                            contribution (it is measured with an external VREF).This
                                                            error varies with PGA and OSR settings.
                                                            The gain error on the MCP3903 has a low temperature
                                                            coefficient. See the typical performance curves for
                                                            more information.
DS25048B-page 18                                                                      © 2011 Microchip Technology Inc.


                                                                                                                                           MCP3903
4.8       Integral Non-Linearity Error                                                            4.11     Total Harmonic Distortion (THD)
Integral non-linearity error is the maximum deviation of                                          The total harmonic distortion is the ratio of the output
an ADC transition point from the corresponding point of                                           harmonics power to the fundamental signal power for a
an ideal transfer function, with the offset and gain                                              sinewave input and is defined by the following
errors removed, or with the end points equal to zero.                                             equation.
It is the maximum remaining error after calibration of
offset and gain errors for a DC input signal.                                                     EQUATION 4-7:
4.9       Signal-To-Noise Ratio (SNR)
                                                                                                        THD ( dB ) = 10 log ⎛ -----------------------------------------------------⎞
                                                                                                                                 HarmonicsPower
                                                                                                                            ⎝ FundamentalPower⎠
For the MCP3903 ADC, the signal-to-noise ratio is a
ratio of the output fundamental signal power to the
noise power (not including the harmonics of the signal),                                          The THD calculation includes the first 35 harmonics for
when the input is a sinewave at a predetermined                                                   the MCP3903 specifications. The THD is usually only
frequency. It is measured in dB. Usually, only the                                                measured with respect to the 10 first harmonics. THD
maximum signal to noise ratio is specified. The SNR                                               is sometimes expressed in %. For converting the THD
figure depends mainly on the OSR and DITHER                                                       in %, here is the formula:
settings of the device.
                                                                                                  EQUATION 4-8:
EQUATION 4-4:            SIGNAL-TO-NOISE RATIO
                                                                                                                                                     THD ( dB )
                                                                                                                                                     ------------------------
          SNR ( dB ) = 10 log ⎛⎝ ----------------------------------⎞⎠
                                      SignalPower                                                               THD ( % ) = 100 × 10                          20
                                       NoisePower
4.10      Signal-To-Noise Ratio And                                                               This specification depends mainly on the DITHER
                                                                                                  setting.
          Distortion (SINAD)
The most important figure of merit for the analog                                                 4.12      Spurious-Free Dynamic Range
performance of the ADCs present on the MCP3903 is
                                                                                                           (SFDR)
the     Signal-to-Noise        And                  Distortion                           (SINAD)
specification.                                                                                    SFDR is the ratio between the output power of the
Signal-to-noise and distortion ratio is similar to signal-                                        fundamental and the highest spur in the frequency
to-noise ratio, with the exception that you must include                                          spectrum. The spur frequency is not necessarily a
the harmonics power in the noise power calculation.                                               harmonic of the fundamental even though it is usually
The SINAD specification depends mainly on the OSR                                                 the case. This figure represents the dynamic range of
and DITHER settings.                                                                              the ADC when a full-scale signal is used at the input.
                                                                                                  This specification depends mainly on the DITHER
EQUATION 4-5:            SINAD EQUATION                                                           setting.
    SINAD ( dB ) = 10 log ⎛ --------------------------------------------------------------------⎞
                                             SignalPower
                          ⎝ Noise + HarmonicsPower⎠                                               EQUATION 4-9:
                                                                                                         SFDR ( dB ) = 10 log ⎛ -----------------------------------------------------⎞
                                                                                                                                    FundamentalPower
The calculated combination of SNR and THD per the                                                                                ⎝ HighestSpurPower ⎠
following formula also yields SINAD:
EQUATION 4-6:            SINAD, THD, AND SNR
                         RELATIONSHIP
                                            ⎛ SNR      -⎞              ⎛ –---------------
                                                                             THD⎞
                                            ⎝ ----------
                                                 10 ⎠                  ⎝ 10 -⎠
        SINAD ( dB ) = 10 log 10                           + 10
© 2011 Microchip Technology Inc.                                                                                                                               DS25048B-page 19


MCP3903
4.13       MCP3903 Delta-Sigma                             For power metering applications, idle tones can be very
           Architecture                                    disturbing because energy can be detected even at the
                                                           50 or 60 Hz frequency, depending on the DC offset of
The MCP3903 incorporates six Delta-Sigma ADCs with         the ADCs, while no power is really present at the
a multi-bit digital to analog converter as quantizer. A    inputs. The only practical way to suppress or attenuate
Delta-Sigma ADC is an oversampling converter that          idle tones phenomenon is to apply dithering to the
incorporates a built-in modulator which is digitizing the  ADC. The idle tones amplitudes are a function of the
quantity of charge integrated by the modulator loop        order of the modulator, the OSR and the number of
(see Figure 5-1). The quantizer is the block that is per-  levels in the quantizer of the modulator. A higher order,
forming the analog-to-digital conversion. The quantizer    a higher OSR, or a higher number of levels for the
is typically 1-bit, or a simple comparator which helps to  quantizer will attenuate the idle tones amplitude.
maintain the linearity performance of the ADC (the
DAC structure is inherently linear in this case).          4.15       Dithering
Multi-bit quantizers help to lower the quantization error
                                                           In order to suppress or attenuate the idle tones present
(the error fed back in the loop can be very large with
                                                           in any Delta-Sigma ADCs, dithering can be applied to
1-bit quantizers) without changing the order of the
                                                           the ADC. Dithering is the process of adding an error to
modulator or the OSR, which leads to better SNR
                                                           the ADC feedback loop in order to “decorrelate” the
figures. However, typically, the linearity of such
                                                           outputs and “break” the idle tone’s behavior. Usually a
architectures is more difficult to achieve since the DAC
                                                           random or pseudo-random generator adds an analog
is no more simple to realize and its linearity limits the
                                                           or digital error to the feedback loop of the delta-sigma
THD of such ADCs.
                                                           ADC in order to ensure that no tonal behavior can
The MCP3903’s 5-level quantizer is a flash ADC             happen at its outputs. This error is filter by the feedback
composed of 4 comparators arranged with equally            loop and typically has a zero average value so that the
spaced thresholds and a thermometer coding. The            converter static transfer function is not disturbed by the
MCP3903 also includes proprietary 5-level DAC              dithering process. However, the dithering process
architecture that is inherently linear for improved THD    slightly increases the noise floor (it adds noise to the
figures.                                                   part) while reducing its tonal behavior and thus
                                                           improving SFDR and THD. The dithering process
4.14       Idle Tones                                      scrambles the idle tones into baseband white noise and
                                                           ensures that dynamic specs (SNR, SINAD, THD,
A Delta-Sigma converter is an integrating converter. It    SFDR) are less signal dependent. The MCP3903
also has a finite quantization step (LSB) which can be     incorporates a proprietary dithering algorithm on all
detected by its quantizer. A DC input voltage that is      ADCs in order to remove idle tones and improve THD,
below the quantization step should only provide an all     which is crucial for power metering applications.
zeros result since the input is not large enough to be
detected. As an integrating device, any Delta-Sigma
will show, in this case, idle tones. This means that the
output will have spurs in the frequency content that are
depending on the ratio between quantization step
voltage and the input voltage. These spurs are the
result of the integrated sub-quantization step inputs
that will eventually cross the quantization steps after a
long enough integration. This will induce an AC
frequency at the output of the ADC and can be shown
in the ADC output spectrum.
These idle tones are residues that are inherent to the
quantization process and the fact that the converter is
integrating at all times without being reset. They are
residues of the finite resolution of the conversion
process. They are very difficult to attenuate and they
are heavily signal dependent. They can degrade both
SFDR and THD of the converter, even for DC inputs.
They can be localized in the baseband of the converter
and thus difficult to filter from the actual input signal.
DS25048B-page 20                                                                     © 2011 Microchip Technology Inc.


                                                                                                       MCP3903
4.16       Crosstalk                                                   EQUATION 4-11:
The crosstalk is defined as the perturbation caused by                                                      Δ V OUT
                                                                                    PSRR ( dB ) = 20 log ⎛ -------------------⎞
one ADC channel on the other ADC channel. It is a                                                        ⎝ Δ AVDD⎠
measurement of the isolation between the six ADCs
present in the chip.
                                                                       Where VOUT is the equivalent input voltage that the
This measurement is a two-step procedure:                              output code translates to with the ADC transfer
1.    Measure one ADC input with no perturbation on                    function. In the MCP3903 specification, AVDD varies
      any other ADC (ADC inputs shorted).                              from 4.5V to 5.5V, and for AC PSRR a 50/60 Hz
                                                                       sinewave is chosen, centered around 5V with a
2.    Measure the same ADC input with a
                                                                       maximum 500 mV amplitude. The PSRR specification
      perturbation sine wave signal on the other ADC
                                                                       is measured with DVDD = 3.3V.
      at a certain predefined frequency.
The crosstalk is then the ratio between the output                     4.18       CMRR
power of the ADC when the perturbation is present and
when it is not divided by the power of the perturbation                This is the ratio between a change in the
signal.                                                                Common-Mode input voltage and the ADC output
A lower crosstalk value implies more independence                      codes. It measures the influence of the Common-Mode
and isolation between the six channels.                                input voltage on the ADC outputs.
The measurement of this signal is performed under the                  The CMRR specification can be DC (the
following conditions:                                                  common-mode input voltage is taking multiple DC
                                                                       values) or AC (the common-mode input voltage is a
•   GAIN = 1,                                                          sinewave at a certain frequency with a certain common
•   PRESCALE = 1,                                                      mode). In AC, the amplitude of the sinewave is
•   OSR = 256,                                                         representing the change in the power supply.
•   MCLK = 4 MHz                                                       It is defined as:
Step 1                                                                 EQUATION 4-12:
• CH0+=CH0-=AGND                                                                                             Δ VOUT
                                                                                   CMRR ( dB ) = 20 log ⎛⎝ -----------------⎞⎠
• CHn+=CHn-=AGND, n different than 0                                                                          Δ VCM
Step 2                                                                 Where VCM= (CHn+ + CHn-)/2 is the Common-Mode
                                                                       input voltage and VOUT is the equivalent input voltage
• CH0+=CH0-=AGND
                                                                       that the output code translates to with the ADC transfer
• CHn+ - CHn-=1VP-P @ 50/60 Hz (Full-scale sine                        function. In the MCP3903 specification, VCM varies
    wave)                                                              from -1V to +1V, and for AC specification a 50/60 Hz
The crosstalk is then calculated with the following                    sinewave is chosen centered around 0V with a 500 mV
formula:                                                               amplitude.
EQUATION 4-10:                                                         4.19       ADC Reset Mode
                                   Δ CH0Power                          ADC Reset mode (called also soft reset mode) can only
          CTalk ( dB ) = 10 log ⎛⎝ ---------------------------------⎞⎠
                                   Δ CHnPower                          be entered through setting high the RESET<5:0> bits in
                                                                       the configuration register. This mode is defined as the
                                                                       condition where the converters are active but their
4.17       PSRR                                                        output is forced to 0.
This is the ratio between a change in the power supply                 The registers are not affected in this reset mode and
voltage and the ADC output codes. It measures the                      retain their values.
influence of the power supply voltage on the ADC                       The ADCs can immediately output meaningful codes
outputs.                                                               after leaving reset mode (and after the sinc filter settling
The PSRR specification can be DC (the power supply                     time of 3/DRCLK). This mode is both entered and
is taking multiple DC values) or AC (the power supply                  exited through setting of bits in the configuration
is a sinewave at a certain frequency with a certain                    register.
common mode). In AC, the amplitude of the sinewave                     Each converter can be placed in soft reset mode
is representing the change in the power supply.                        independently. The configuration registers are not
It is defined as:                                                      modified by the soft reset mode.
© 2011 Microchip Technology Inc.                                                                                        DS25048B-page 21


MCP3903
A data ready pulse will not be generated by any ADC        When an ADC exits ADC shutdown mode, any phase
while in reset mode.                                       delay present before shutdown was entered will still be
When an ADC exists ADC reset mode, any phase               present. If one ADC was not in shutdown, the ADC
delay present before reset was entered will still be       leaving shutdown mode will automatically resynchro-
present. If one ADC was not in reset, the ADC leaving      nize the phase delay relative to the other ADC channel,
reset mode will automatically resynchronize the phase      per the phase delay register block and give data ready
delay relative to the other ADC channel, per the phase     pulses accordingly.
delay register block and give data ready pulses accord-    If an ADC is placed in shutdown while others are con-
ingly.                                                     verting, then the internal clock will not shut down. When
If an ADC is placed in Reset mode while the other is       going back out of shutdown, it will be automatically
converting, it is not shutting down the internal clock.    resynchronized with the clock that did not stop during
When going back out of reset, it will be resynchronized    reset.
automatically with the clock that did not stop during      If all ADCs are in ADC reset or ADC shutdown modes,
reset.                                                     the clock is not distributed to the digital core for low
If all ADCs are in soft reset or shutdown modes, the       power operation. Once any of the ADC is back to nor-
clock is no longer distributed to the digital core for low mal operation, the clock is automatically distributed
power operation. Once the ADC is back to normal            again.
operation, the clock is automatically distributed again.
                                                           4.22      Full Shutdown Mode
4.20       Hard Reset Mode (RESET = 0)                     The lowest power consumption can be achieved when
This mode is only available during a POR or when the       SHUTDOWN<5:0>=111111, VREFEXT=CLKEXT= 1.
RESET pin is pulled low. The RESET pin low state           This mode is called “Full shutdown mode”, and no
places the device in a hard reset mode.                    analog circuitry is enabled. In this mode, the POR AVDD
                                                           monitoring circuit is also disabled. When the clock is
In this mode, all internal registers are reset to their    idle (OSC1 = high or low continuously), no clock is
default state.                                             propagated throughout the chip. All ADCs are in
The DC biases for the analog blocks are still active, i.e. shutdown, the internal voltage reference is disabled
the MCP3903 is ready to convert. However, this pin         and the internal oscillator is disabled.
clears all conversion data in the ADCs. The comparator     The only circuit that remains active is the SPI interface
outputs of all ADCs are forced to their reset state        but this circuit does not induce any static power
(0011). The SINC filters are all reset, as well as their   consumption. If SCK is idle, the only current
double output buffers. See serial timing for minimum       consumption comes from the leakage currents induced
pulse low time, in Section 1.0 “Electrical                 by the transistors and is less than 1 µA on each power
Characteristics”.                                          supply, for temperatures lower than 85°C.
During a hard reset, no communication with the part is     This mode can be used to power down the chip
possible. The digital interface is maintained in a reset   completely and avoid power consumption when there
state.                                                     is no data to convert at the analog inputs. Any SCK or
                                                           MCLK edge coming while in this mode will induce
4.21       ADC Shutdown Mode                               dynamic power consumption.
ADC shutdown mode is defined as a state where the          Once any of the SHUTDOWN, CLKEXT and VREFEXT
converters and their biases are off, consuming only        bits returns to 0, the POR AVDD monitoring block is
leakage current. After this is removed, start-up delay     back to operation and AVDD monitoring can take place.
time (SINC filter settling time) will occur before
outputting meaningful codes. The start-up delay is
needed to power-up all DC biases in the channel that
was in shutdown. This delay is the same than tPOR and
any DR pulse coming within this delay should be
discarded.
Each converter can be placed in shutdown mode
independently. The CONFIG registers are not modified
by the shutdown mode. This mode is only available
through programming of the SHUTDOWN<5:0> bits in
the CONFIG register.
The output data is flushed to all zeros while in ADC
shutdown. No data ready pulses are generated by any
ADC while in ADC shutdown mode.
DS25048B-page 22                                                                     © 2011 Microchip Technology Inc.


                                                                                         MCP3903
5.0       DEVICE OVERVIEW                               5.3        Delta-Sigma Modulator
5.1       Analog Inputs (CHn+/-)                        5.3.1         ARCHITECTURE
                                                        All ADCs are identical in the MCP3903 and they
The MCP3903 analog inputs can be connected directly     include a second-order modulator with a multi-bit DAC
to current and voltage transducers (such as shunts,     architecture (see Figure 5-1). The quantizer is a flash
current transformers, or Rogowski coils). Each input    ADC composed of 4 comparators with equally spaced
pin is protected by specialized ESD structures that are thresholds and a thermometer output coding. The
certified to pass 5 kV HBM and 500V MM contact          proprietary 5-level architecture ensures minimum
charge. These structures allow bipolar ±6V continuous   quantization noise at the outputs of the modulators
voltage with respect to AGND, to be present at their    without disturbing linearity or inducing additional
inputs without the risk of permanent damage.            distortion. The sampling frequency is DMCLK (typically
All channels have fully differential voltage inputs for 1 MHz with MCLK=4 MHz) so the modulator outputs
better noise performance. The absolute voltage at each  are refreshed at a DMCLK rate. The modulator outputs
pin relative to AGND should be maintained in the ±1V    are available in the MOD register.
range during operation in order to ensure the specified Each modulator also includes a dithering algorithm that
ADC accuracy. The Common-Mode signals should be         can be enabled through the DITHER<5:0> bits in the
adapted to respect both the previous conditions and     configuration register. This dithering process improves
the differential input voltage range. For best          THD and SFDR (for high OSR settings) while
performance, the Common-Mode signals should be          increasing slightly the noise floor of the ADCs. For
maintained to AGND.                                     power metering applications and applications that are
                                                        distortion-sensitive, it is recommended to keep
5.2       Programmable Gain Amplifiers                  DITHER enabled for all ADCs. In the case of power
          (PGA)                                         metering applications, THD and SFDR are critical
                                                        specifications to optimize SNR (noise floor). This is not
The six Programmable Gain Amplifiers (PGAs) reside      really problematic due to large averaging factor at the
at the front-end of each Delta-Sigma ADC. They have     output of the ADCs, therefore even for low OSR
two functions: translate the common-mode of the input   settings, the dithering algorithm will show a positive
from AGND to an internal level between AGND and         impact on the performance of the application.
AVDD, and amplify the input differential signal. The
translation of the common mode does not change the      Figure 5-1 represents a simplified block diagram of the
differential signal but recenters the common-mode so    Delta-Sigma ADC present on MCP3903.
that the input signal can be properly amplified.
The PGA block can be used to amplify very low signals,
but the differential input range of the delta-sigma                          Loop             Quantizer
                                                                             Filter
modulator must not be exceeded. The PGA is
                                                         Differential                                    Output
controlled by the PGA_CHn<2:0> bits in the GAIN                                Second-
                                                         Voltage Input                                  Bitstream
register. The following table represents the gain                                Order
                                                                                                5-level
                                                                              Integrator
settings for the PGA:                                                                      Flash ADC
TABLE 5-1:          PGA CONFIGURATION
                    SETTING
         Gain          Gain      Gain     VIN Range                                            DAC
  PGA_CHn<2:0>         (V/V)     (dB)          (V)
                                                                       MCP3903 Sigma-Delta Modulator
    0      0     0        1         0    ±0.5
                                                        FIGURE 5-1:              Simplified Delta-Sigma ADC
    0      0     1        2         6    ±0.25
                                                        Block Diagram.
    0      1     0        4        12    ±0.125
    0      1     1        8        18    ±0.0625
    1      0     0       16        24    ±0.03125
    1      0     1       32        30    ±0.015625
© 2011 Microchip Technology Inc.                                                                DS25048B-page 23


MCP3903
5.3.2          MODULATOR INPUT RANGE AND
               SATURATION POINT
For a specified voltage reference value of 2.4V, the
modulator specified differential input range is ±500 mV.
The input range is proportional to VREF and scales
according to the VREF voltage. This range ensures the
stability of the modulator over amplitude and frequency.
Outside of this range, the modulator is still functional,
however its stability is no longer guaranteed and
therefore it is not recommended to exceed this limit.
The saturation point for the modulator is VREF/3 since
the transfer function of the ADC includes a gain of 3 by
default (independent from the PGA setting. See
Section 5.5 “ADC OUTPUT CODING”).
5.3.3          BOOST MODE
The Delta-Sigma modulators also include an
independent BOOST mode for each channel. If the
corresponding BOOST<1:0> bit is enabled, the power
consumption of the modulator is multiplied by 2 and its
bandwidth is increased to be able to sustain AMCLK
clock frequencies up to 8.192 MHz while keeping the
ADC accuracy. When disabled, the power consumption
returns back to normal and the AMCLK clock
frequencies can only reach up to 5 MHz without
affecting ADC accuracy.
DS25048B-page 24                                          © 2011 Microchip Technology Inc.


                                                                                                                                                MCP3903
5.4       SINC3 Filter                                                           The Normal-Mode Rejection Ratio (NMRR), or gain of
                                                                                 the transfer function, is shown in the following equation:
All ADCs present in the MCP3903 include a decimation
filter that is a third-order sinc (or notch) filter. This filter
                                                                                 EQUATION 5-2:                                     MAGNITUDE OF
processes the multi-bit bitstream into 16 or 24 bits
                                                                                                                                   FREQUENCY RESPONSE
words (depending on the WIDTH configuration bit). The
settling time of the filter is 3 DMCLK periods. It is                                                                              H(f)
recommended to discard unsettled data to avoid data
                                                                                                                                                                        3
                                                                                                                        sin c ⎛ π ⋅ --------------------⎞
corruption which can be done easily by setting the                                                                                                     f
DR_LTY bit high in the STATUS/COM register.                                                                                        ⎝ DRCLK⎠
                                                                                                          NMRR ( f ) = ----------------------------------------------
                                                                                                                       sin c ⎛ π ⋅ ----------------------⎞
The resolution achievable at the output of the sinc filter                                                                                             f
                                                                                                                                  ⎝ DMCLK⎠
(the output of the ADC) is dependant on the OSR and
is summarized in the following table:
                                                                                 or:
TABLE 5-2:              ADC RESOLUTION VS. OSR
                                                                       ADC
                                                                                                                             sin c ⎛ π ⋅ -----⎞
                                                                                                                                                     f          3
                                                                    Resolution                                                          ⎝ f D⎠
      OSR<1:0>                            OSR                         (bits)                                    NMRR ( f ) = -----------------------------
                                                                                                                              sin c ⎛⎝ π ⋅ ----⎞⎠
                                                                                                                                                     f
                                                                    No Missing                                                                     fS
                                                                      Codes
      0           0                         32                         17
                                                                                 where:
      0           1                         64                         20
                                           128                         23                                                              sin ( x )
      1           0                                                                                                      sin c ( x ) = ---------------
                                                                                                                                             x
      1           1                        256                         24
For 24 -bit output mode (WIDTH = 1), the output of the                           Figure 5-2 shows the sinc filter frequency response:
sinc filter is padded with least significant zeros for any
resolution less than 24 bits.
For 16-bit output modes, the output of the sinc filter is                                           20
rounded to the closest 16-bit number in order to                                                     0
conserve only 16-bit words and to minimize truncation
                                                                                  Magnitude (dB)
                                                                                                    -20
error.
                                                                                                    -40
The gain of the transfer function of this filter is 1 at each
                                                                                                    -60
multiple of DMCLK (typically 1 MHz) so a proper
                                                                                                    -80
anti-aliasing filter must be placed at the inputs to
attenuate the frequency content around DMCLK, and                                                  -100
keep the desired accuracy over the baseband of the                                                 -120
                                                                                                          1         10          100         1000         10000      100000 1000000
converter. This anti-aliasing filter can be a simple                                                                           Input Frequency (Hz)
first-order RC network, with a sufficiently low time
constant to generate high rejection at DMCLK                                     FIGURE 5-2:     SINC Filter Response with
frequency.                                                                       MCLK = 4 MHz, OSR = 64, PRESCALE = 1.
EQUATION 5-1:                    SINC FILTER TRANSFER
                                 FUNCTION H(Z)
                                                                3
                          ⎛ 1 – z – OSR ⎞
                H ( z ) = ⎜ --------------------------------
                                                           -⎟
                          ⎝ OSR ( 1 – z –1 )⎠
Where:
                     z = exp ⎛ ----------------------⎞
                                     2πfj
                             ⎝ DMCLK⎠
© 2011 Microchip Technology Inc.                                                                                                                             DS25048B-page 25


MCP3903
5.5        ADC OUTPUT CODING                                              In case of positive saturation (CHn+ - CHn- > VREF/3),
                                                                          the output is locked to 7FFFFF for 24 bit mode (7FFF
The second order modulator, SINC3 filter, PGA, VREF                       for 16 bit mode). In case of negative saturation (CHn+
and analog input structure all work together to produce                   - CHn- <-VREF/3), the output code is locked to 800000
the device transfer function for the analog to digital con-               for 24-bit mode (8000 for 16 bit mode).
version, shown in Equation 5-3.
                                                                          Equation 5-3 is only true for DC inputs. For AC inputs,
The channel data is either a 16-bit or 24-bit word,                       this transfer function needs to be multiplied by the
presented in 23-bit or 15-bit plus sign, two’s                            transfer function of the SINC3 filter (see Equation 5-1
complement format and is MSB (left) justified.                            and Equation 5-2).
The ADC data is two or three bytes wide depending on
the WIDTH bit of the associated channel. The 16-bit
mode includes a round to the closest 16-bit word
(instead of truncation) in order to improve the accuracy
of the ADC data.
EQUATION 5-3:
                                ( CH n+ – CH n- )⎞
           DATA_CHn = ⎛ ------------------------------------
                                                           - × 8,388,608 × G × 3          (For 24-bit Mode Or WIDTH_CHn = 1)
                               ⎝ V REF+ – V REF- ⎠
                                ( CH n+ – CH n- )
          DATA_CHn = ⎛ -------------------------------------⎞ × 32, 768 × G × 3          (For 16-bit Mode Or WIDTH_CHn = 0)
                              ⎝ V REF+ – V REF- ⎠
5.5.1         ADC RESOLUTION AS A FUNCTION
              OF OSR
The ADC resolution is a function of the OSR
(Section 5.4 “SINC3 Filter”). The resolution is the
same for both channels. No matter what the resolution
is, the ADC output data is always presented in 24-bit
words, with added zeros at the end if the OSR is not
large enough to produce 24-bit resolution (left
justification).
TABLE 5-3:          OSR = 256 OUTPUT CODE EXAMPLES
                        ADC Output Code (MSB First)                                        Hexadecimal              Decimal
 0  1   1  1    1 1  1 1     1  1  1  1      1    1    1    1   1 1  1  1     1  1  1  1     0x7FFFFF            + 8,388,607
 0  1   1  1    1 1  1 1     1  1  1  1      1    1    1    1   1 1  1  1     1  1  1  0     0x7FFFFE            + 8,388,606
 0  0   0  0    0 0  0 0     0  0  0  0      0    0    0    0   0 0  0  0     0  0  0  0      0x000000                   0
 1  1   1  1    1 1  1 1     1  1  1  1      1    1    1    1   1 1  1  1     1  1  1  1     0xFFFFFF                   -1
 1  0   0  0    0 0  0 0     0  0  0  0      0    0    0    0   0 0  0  0     0  0  0  1      0x800001            - 8,388,607
 1  0   0  0    0 0  0 0     0  0  0  0      0    0    0    0   0 0  0  0     0  0  0  0      0x800000            - 8,388,608
TABLE 5-4:          OSR = 128 OUTPUT CODE EXAMPLES
                                                                                                                   Decimal
                       ADC Output Code (MSB First)                                       Hexadecimal
                                                                                                             23-bit Resolution
 0  1   1  1    1 1 1  1     1  1  1  1     1    1    1    1    1 1 1  1     1  1  1  0     0x7FFFFE            + 4,194,303
 0  1   1  1    1 1 1  1     1  1  1  1     1    1    1    0    1 1 1  1     1  1  0  0    0x7FFFFC             + 4,194,302
 0  0   0  0    0 0 0  0     0  0  0  0     0    0    0    0    0 0 0  0     0  0  0  0      0x000000                   0
 1  1   1  1    1 1 1  1     1  1  1  1     1    1    1    1    1 1 1  1     1  1  1  0    0xFFFFFE                    -1
 1  0   0  0    0 0 0  0     0  0  0  0     0    0    0    0    0 0 0  0     0  0  1  0     0x800002             - 4,194,303
 1  0   0  0    0 0 0  0     0  0  0  0     0    0    0    0    0 0 0  0     0  0  0  0     0x800000             - 4,194,304
DS25048B-page 26                                                                                    © 2011 Microchip Technology Inc.


                                                                                                MCP3903
TABLE 5-5:         OSR = 64 OUTPUT CODE EXAMPLES
                                                                                                       Decimal
                       ADC Output code (MSB First)                             Hexadecimal
                                                                                                  20-bit resolution
 0  1 1  1    1  1  1  1    1 1  1   1    1 1 1  1    1  1 1 1    0  0  0  0     0x7FFFF0            + 524, 287
 0  1 1  1    1  1  1  1    1 1  1   1    1 1 1  1    1  1 1 0    0  0  0  0     0x7FFFE0            + 524, 286
 0  0 0  0    0  0  0  0    0 0  0   0    0 0 0  0    0  0 0 0    0  0  0  0      0x000000                  0
 1  1 1  1    1  1  1  1    1 1  1   1    1 1 1  1    1  1 1 1    0  0  0  0     0xFFFFF0                  -1
 1  0 0  0    0  0  0  0    0 0  0   0    0 0 0  0    0  0 0 1    0  0  0  0      0x800010            - 524,287
 1  0 0  0    0  0  0  0    0 0  0   0    0 0 0  0    0  0 0 0    0  0  0  0      0x800000            - 524, 288
TABLE 5-6:         OSR = 32 OUTPUT CODE EXAMPLES
                                                                                                       Decimal
                       ADC Output code (MSB First)                              Hexadecimal
                                                                                                  17-bit resolution
 0  1 1  1     1 1   1 1    1  1  1  1    1 1  1 1     1 0 0 0    0  0  0  0      0x7FFF80             + 65, 535
 0  1 1  1     1 1   1 1    1  1  1  1    1 1  1 1     0 0 0 0    0  0  0  0      0x7FFF00             + 65, 534
 0  0 0  0     0 0   0 0    0  0  0  0    0 0  0 0     0 0 0 0    0  0  0  0       0x000000                 0
 1  1 1  1     1 1   1 1    1  1  1  1    1 1  1 1     1 0 0 0    0  0  0  0      0xFFFF80                 -1
 1  0 0  0     0 0   0 0    0  0  0  0    0 0  0 0     1 0 0 0    0  0  0  0      0x800080              - 65,535
 1  0 0  0     0 0   0 0    0  0  0  0    0 0  0 0     0 0 0 0    0  0  0  0      0x800000             - 65, 536
5.6      Voltage Reference                                     These bypass capacitors are not mandatory for correct
                                                               ADC operation, but removing these capacitors may
5.6.1       INTERNAL VOLTAGE REFERENCE                         degrade accuracy of the ADC. The bypass capacitors
                                                               also help for applications where the voltage reference
The MCP3903 contains an internal voltage reference
                                                               output is connected to other circuits. In this case,
source specially designed to minimize drift over
                                                               additional buffering may be needed as the output drive
temperature. In order to enable the internal voltage
                                                               capability of this output is low.
reference, the VREFEXT bit in the configuration
register must be set to 0 (default mode). This internal
                                                               5.6.2        DIFFERENTIAL EXTERNAL
VREF supplies reference voltage to both channels. The
                                                                            VOLTAGE INPUTS
typical value of this voltage reference is 2.35V ±2%.
The internal reference has a very low typical                  When the VREFEXT bit is high, the two reference pins
temperature coefficient of ±5 ppm/°C, allowing the out-        (REFIN+/OUT, REFIN-) become a differential voltage
put codes to have minimal variation with respect to            reference input. The voltage at the REFIN+/OUT is
temperature since they are proportional to (1/VREF).           noted VREF+ and the voltage at the REFIN- pin is noted
                                                               VREF-. The differential voltage input value is shown in
The noise of the internal voltage reference is low
                                                               the following equation:
enough not to significantly degrade the SNR of the
ADC if compared to a precision external low-noise
voltage reference.                                             EQUATION 5-4:
The output pin for the internal voltage reference is                              VREF=VREF+ - VREF-
REFIN+/OUT.
When the internal voltage reference is enabled,                The specified VREF range is from 2.2V to 2.6V. The
REFIN- pin should always be connected to AGND.                 REFIN- pin voltage (VREF-) should be limited to ±0.3V.
                                                               Typically, for single-ended reference applications, the
For optimal ADC accuracy, appropriate bypass
                                                               REFIN- pin should be directly connected to AGND.
capacitors should be placed between REFIN+/OUT
and AGND. De-coupling at the sampling frequency,
around 1 MHz, is important for any noise around this
frequency will be aliased back into the conversion data.
0.1 µF ceramic and 10 µF tantalum capacitors are
recommended.
© 2011 Microchip Technology Inc.                                                                     DS25048B-page 27


MCP3903
5.7        Power-on Reset                                   5.8       RESET Effect On Delta Sigma
The MCP3903 contains an internal POR circuit that
                                                                      Modulator/SINC Filter
monitors analog supply voltage AVDD during operation.       When the RESET pin is low, both ADCs will be in Reset
The typical threshold for a power-up event detection is     and output code 0x0000h. The RESET pin performs a
4.2V ±5%. The POR circuit has a built-in hysteresis for     hard reset (DC biases still on, part ready to convert)
improved transient spikes immunity that has a typical       and clears all charges contained in the sigma delta
value of 200 mV. Proper decoupling capacitors (0.1 µF       modulators. The comparator outputs are 0011 for each
ceramic and 10 µF tantalum) should be mounted as            ADC.
close as possible to the AVDD pin, providing additional
                                                            The SINC filters are all reset, as well as their double
transient immunity.
                                                            output buffers. This pin is independent of the serial
Figure 5-3 illustrates the different conditions at          interface. It brings the CONFIG registers to the default
power-up and a power-down event, in typical                 state. When RESET is low, any write with the SPI
conditions. All internal DC biases are not settled until at interface will be disabled and will have no effect. All
least 50 µs after system POR. Any data ready pulses         output pins (SDO, DR, MDAT0/1) are high impedance,
during this time after system reset should be ignored.      and no clock is propagated through the chip.
After POR, data ready pulses are present at the pin
with all the default conditions in the configuration regis- 5.9       Phase Delay Block
ters.
Both AVDD and DVDD power supplies are independent.          The MCP3903 incorporates a phase delay generator
Since AVDD is the only power supply that is monitored,      which ensures that the six ADCs are converting the
it is highly recommended to power up DVDD first as a        inputs with a fixed delay between them. The six ADCs
power-up sequence. If AVDD is powered up first, it is       are synchronously sampling but the averaging of
highly recommended to keep the RESET pin low during         modulator outputs is delayed so that the SINC filter
the whole power-up sequence.                                outputs (thus the ADC outputs) show a fixed phase
                                                            delay, as determined by the PHASE register setting.
                                                            The phase register is composed of three bytes:
    AVDD                                                    PHASEC<7:0>, PHASEB<7:0>, PHASEA<7:0>. Each
                                                            byte is a 7 bit + sign MSB first, two's complement code
                                                            that represents the amount of delay between each pair
      5V                                                    of ADCs. The PHASEC byte represents the delay
    4.2V                                                    between Channel 4 and channel 5 (pair C). The
      4V
                                                            PHASEB byte represents the delay between Channel 2
                     50 µs
                                                            and channel 3 (pair B). The PHASEA byte represents
                                                            the delay between Channel 0 and channel 1 (pair A).
                      tPOR                                  The reference channel is the odd channel (channel 1/
                                                            3/5). When PHASEn<7:0> is positive, Channel 0/2/4 is
                                                            lagging versus channel 1/3/5 otherwise it is leading.
      0V                                              Time  The amount of delay between two ADC conversions is
 DEVICE                      PROPER      RESET
               RESET                                        given by the following formula:
  MODE                      OPERATION
FIGURE 5-3:                Power-on Reset Operation.        EQUATION 5-5:
                                                                                   Phase Register Code
                                                                         Delay = --------------------------------------------------
                                                                                               DMCLK
                                                            The timing resolution of the phase delay is 1/DMCLK or
                                                            1 µs in the default configuration with MCLK = 4 MHz.
                                                            The data ready signals are affected by the phase delay
                                                            settings. Typically, the time difference between the data
                                                            ready pulses of channel 0 and channel 1 is equal to the
                                                            phase delay setting.
                                                               Note:      A detailed explanation of the Data Ready
                                                                          pins (DRn) with phase delay is present in
                                                                          Section 6.10 “Data Ready Pulses
                                                                          (DRn)”.
DS25048B-page 28                                                                         © 2011 Microchip Technology Inc.


                                                                                               MCP3903
5.9.1        PHASE DELAY LIMITS                            5.10       Crystal Oscillator
The Phase delay can only go from -OSR/2 to +OSR/2 - 1.     The MCP3903 includes a Pierce-type crystal oscillator
This sets the fine phase resolution. The phase register is with very high stability and ensures very low tempco
coded with 2's complement.                                 and jitter for the clock generation. This oscillator can
If larger delays between the two channels from the         handle up to 16.384 MHz crystal frequencies, provided
same pair are needed, they can be implemented exter-       that proper load capacitances and quartz quality factor
nally to the chip with an MCU. A FIFO in the MCU can       are used.
save incoming data from the leading channel for a          For keeping specified ADC accuracy, AMCLK should
number N of DRCLK clocks. In this case, DRCLK              be kept between 1 and 5 MHz with BOOST off or 1 and
would represent the coarse timing resolution, and          8.192 MHz with BOOST on. Larger MCLK frequencies
DMCLK the fine timing resolution. The total delay will     can be used, provided the prescaler clock settings
then be equal to:                                          allow the AMCLK to respect these ranges.
      Delay = N/DRCLK + PHASE/DMCLK                        For a proper start-up, the load capacitors of the crystal
The Phase Delay register can be programmed once            should be connected between OSC1 and DGND and
with the OSR=256 setting and will adjust to the OSR        between OSC2 and DGND. They should also respect
automatically afterward without the need to change the     the following equation:
value of the PHASE register.
• OSR=256: the delay can go from -128 to +127.             EQUATION 5-6:
   PHASEn<7> is the sign bit. PHASEn<6> is the                                                                            2
                                                                         RM < 1.6 × 10 × ⎛ -----------------------------⎞
                                                                                        6               1
   MSB and PHASEn<0> the LSB.                                                                ⎝f × C                     ⎠
                                                                                                       LOAD
• OSR=128: the delay can go from -64 to +63.
   PHASEn<6> is the sign bit. PHASEn<5> is the              Where:
   MSB and PHASEn<0> the LSB.                                        f     =       crystal frequency in MHz
• OSR=64: the delay can go from -32 to +31.                   CLOAD        =       load capacitance in pF including
   PHASEn<5> is the sign bit. PHASEn<4> is the                                     parasitics from the PCB
   MSB and PHASEn<0> the LSB.
                                                                  RM       =       motional resistance in ohms of
• OSR=32: the delay can go from -16 to +15.                                        the quartz
   PHASEn<4> is the sign bit. PHASEn<3> is the
   MSB and PHASEn<0> the LSB.
                                                           When CLKEXT=1, the crystal oscillator is bypassed by
TABLE 5-7:          PHASE VALUES WITH                      a digital buffer to allow direct clock input for an external
                    MCLK = 4 MHZ, OSR = 256                clock.
                         Hex               Delay
  Phase Register
                                     (CH0/2/4 relative
       Value
                                       to CH1/3/5)
 0 1 1 1 1 1 1 1        0x7F             + 127 µs
 0 1 1 1 1 1 1 0        0x7E             + 126 µs
 0 0 0 0 0 0 0 1        0x01               + 1 µs
 0 0 0 0 0 0 0 0        0x00                0 µs
 1 1 1 1 1 1 1 1        0xFF               - 1 µs
 1 0 0 0 0 0 0 1        0x81             - 127 µs
 1 0 0 0 0 0 0 0        0x80              -128 µs
© 2011 Microchip Technology Inc.                                                                              DS25048B-page 29


MCP3903
6.0        SERIAL INTERFACE                               The default device address bits are 01. A read on
                                                          undefined addresses will give an all zeros output on the
          DESCRIPTION
                                                          first and all subsequent transmitted bytes. A write on an
                                                          undefined address will have no effect and will not incre-
6.1       OVERVIEW                                        ment the address counter either.
The MCP3903 device is compatible with SPI modes           The register map is defined in Section 7.1 “ADC
0,0 and 1,1. Data is clocked out of the MCP3903 on the    Channel Data Output Registers”.
falling edge of SCK, and data is clocked into the
MCP3903 on the rising edge of SCK. In these modes,        6.3        Reading from the Device
SCK can idle either high or low. Each SPI
communication starts with a CS falling edge and stops     The first data byte read is the one defined by the
with the CS rising edge. Each SPI communication is        address given in the CONTROL byte. After this first
independent. When CS is high, SDO is in high              byte is transmitted, if CS pin is maintained low, the
impedance, and transitions on SCK and SDI have no         communication continues and the address of the next
effect. Additional controls: RESET, DR are also           transmitted byte is determined by the status of the
provided      on    separate      pins   for   advanced   READ bits in the STATUS/COM register. Multiple
communication. The MCP3903 interface has a simple         looping configurations can be defined through the
command structure. The first byte transmitted is always   READ<1:0> bits for the address increment (see 6.6
the CONTROL byte that is 8 bits wide and is followed      “SPI MODE 1,1 - Clock Idle High, Read/Write
by data bytes that are 24 bits wide. Both ADCs are        Examples””).
continuously converting data by default and can be
reset or shutdown through a CONFIG register setting.      6.4        Writing to the Device
Since each ADC data is either 16 or 24 bits (depending    The first data byte written is the one defined by the
on the WIDTH bits), the internal registers can be         address given in the control byte. The write
grouped together with various configurations (through     communication automatically increments the address
the READ bits) in order to allow easy data retrieval      for subsequent bytes. The address of the next
within only one communication. For device reads, the      transmitted byte within the same communication (CS
internal address counter can be automatically incre-      stays low) is the next address defined on the register
mented in order to loop through groups of data within     map. At the end of the register map, the address loops
the register map. The SDO will then output the data       to the beginning of the register map. Writing a
located at the ADDRESS (A<4:0>) defined in the con-       non-writable register has no effect. SDO pin stays high
trol byte and then ADDRESS+1 depending on the             impedance during a write communication.
READ<1:0> bits which select the groups of registers.
These groups are defined in Section 7.1 “ADC Chan-
                                                          6.5        SPI MODE 0,0 - Clock Idle Low,
nel Data Output Registers” (Register Map). The Data
Ready pins (DRn) can be used as an interrupt for an                  Read/Write Examples
MCU and outputs pulses when new ADC channel data          In this SPI mode, the clock idles low. For the MCP3903,
is available. The RESET pin acts like a hard reset and    this means that there will be a rising edge before there
can reset the part to its default power-up configuration. is a falling edge.
6.2       CONTROL BYTE
The control byte of the MCP3903 contains two device
address bits A<6:5>, 5 register address bits A<4:0>,
and a read/write bit (R/W). The first byte transmitted to
the MCP3903 is always the control byte.
      A6   A5
                 A4    A3    A2    A1  A0    R/W
      (0)  (1)
                                              Read
                                             Write Bit
       Device              Register
     Address Bits         Address Bits
FIGURE 6-1:              Control Byte.
DS25048B-page 30                                                                    © 2011 Microchip Technology Inc.


                                                                                                                                                   MCP3903
     CS
                DATA TRANSITIONS ON
                   THE FALLING EDGE
         MCU AND MCP3901 LATCH
         BITS ON THE RISING EDGE
   SCK                                  1                                                                                                          32
    SDI                                  A6 A5 A4 A3 A2 A1 A0 R/W
                   HI-Z                            HI-Z                                                                                                                          HI-Z
  SDO                                                                   D23       22 21  20 19 18    17  16   D15    D07    06  05 04 03 02 01  00   D23 (OF ADDRESS + 1 DATA)
                                                                     (ADDRESS) 24 BIT DATA
  Note:
FIGURE 6-2:                         Device Read (SPI MODE 0,0 - Clock Idles Low).
     CS
                  DATA TRANSITIONS ON
                       THE FALLING EDGE
            MCU AND MCP3901 LATCH
            BITS ON THE RISING EDGE
    SCK                                    1                                                                                                          32
    SDI                                     A6 A5 A4 A3 A2 A1  A0 R/W      D23       22 21  20 19 18    17 16    D15     D7   D6 D5 D4 D3 D2   D1 D0   D23 OF (ADDRESS + 1) DATA
                        HI-Z
                                                                               (ADDRESS) DATA                                                                                    HI-Z
   SDO                                                                                          HI-Z
FIGURE 6-3:                         Device Write (SPI Mode 0,0 - Clock Idles Low).
6.6       SPI MODE 1,1 - Clock Idle High,
          Read/Write Examples
In this SPI mode, the clock idles High. For the
MCP3903, this means that there will be a falling edge
before there is a rising edge.
       CS
           DATA TRANSITIONS ON
               THE FALLING EDGE
         MCU AND MCP3901 LATCH
        BITS ON THE RISING EDGE
     SCK                                   1                                                                                                          32
     SDI                                      A6 A5 A4 A3 A2 A1 A0 R/W
                         HI-Z                           HI-Z                                                                                                                        HI-Z
    SDO                                                                            23 22 21   20 19 18    17  D16     D8     D7 D6 D5 D4 D3 D2 D1             D0
                                                                                 (ADDRESS) DATA
FIGURE 6-4:                         Device Read (SPI Mode 1,1 - Clock Idles High).
© 2011 Microchip Technology Inc.                                                                                                                                 DS25048B-page 31


MCP3903
      CS
                DATA TRANSITIONS ON
                    THE FALLING EDGE
             MCU AND MCP3901 LATCH
            BITS ON THE RISING EDGE
                                     1                                                                                       32
    SCK
                                       A6 A5 A4 A3 A2 A1 A0   R/W     23 22 21 20 19 18  17 D16   D08 D7 D6 D5 D4 D3 D2 D1     D0
     SDI
                     HI-Z                                             (ADDRESS) DATA                                                       HI-Z
   SDO                                                                           HI-Z
FIGURE 6-5:                      Device Write (SPI Mode 1,1 - Clock Idles High).
6.7       Read Continuously Channel Data,                                            The STATUS/COM register contains the loop settings
          LOOPING ON ADDRESS SETS                                                    for the internal address counter (READ<1:0>). The
                                                                                     internal address counter can either stay constant
If the user wishes to read back any of the ADC                                       (READ<1:0>=00) and continuously read the same
channels continuously, or all channels continuously,                                 byte, or it can auto-increment and loop through the
the internal address counter of the MCP3903 can be                                   register groups defined below (READ<1:0>=01),
set to loop on specific register sets. In this case, there                           register types (READ<1:0>=10) or the entire register
is only one control byte on SDI to start the                                         map (READ<1:0>=11).
communication. The part stays within the same loop
                                                                                     Each channel is configured independently as either a
until CS returns high.
                                                                                     16-bit or 24-bit data word, depending on the setting of
This internal address counter allows the following                                   the corresponding WIDTH bit in the CONFIG register.
functionality:
                                                                                     For continuous reading, in the case of WIDTH=0
• Read one ADC channel data continuously                                             (16-bit), the lower byte of the ADC data is not accessed
• Read all ADC channel data continuously (all ADC                                    and the part jumps automatically to the following
   data can be independent or linked with                                            address (the user does not have to clock out the lower
   DRn_MODE settings)                                                                byte since it becomes undefined for WIDTH=0).
• Read continuously the entire register map                                          The following figure represents a typical continuous
• Read continuously each separate register                                           read communication with the default settings
• Read continuously all configuration registers                                      (DRMODE<1:0>=00, READ<1:0>=10) for both
• Write all configuration registers in one                                           WIDTH settings. This configuration is typically used for
   communication (see Figure 6-6)                                                    power metering applications.
                                                            CH5   CH5     5                                      CH5     CH5      5
FIGURE 6-6:                      Typical Continuous Read Communication.
DS25048B-page 32                                                                                                   © 2011 Microchip Technology Inc.


                                                                                              MCP3903
6.7.1        CONTINUOUS READ                               After these temporary resets, the ADCs go back to
                                                           normal operation with no need for an additional
All ADCs are powered up with their default
                                                           command. These are also the settings where the DR
configurations, and begin to output data ready pulses
                                                           position is affected. The phase register can be used to
immediately (RESET<5:0> and SHUTDOWN<5:0>
                                                           soft reset the ADC without using the RESET bits in the
bits are off by default). The default output codes for
                                                           configuration register.
both ADCs are all zeros.The default modulator output
for both ADCs is 0011 (corresponding to a theoretical
zero voltage at the inputs). The default phase is zero     6.9        Line Cycle Sampling Options
between the two channels. It is recommended to enter       Since the AMCLK range can go up to 5 MHz, the
into ADC reset mode for both ADCs just after power-up      MCP3903 is able to accommodate 256 output samples
because the desired MCP3903 register configuration         per line cycles with line frequencies up to 76.2Hz at
may not be the default one and in this case, the ADC       OSR=64.
would output undesired data. Within the ADC reset
                                                           .
mode (RESET<5:0>=111111), the user can configure           TABLE 6-1:            MCLK FREQUENCIES FOR
the whole part with a single communication. The write                            LINE SAMPLING
commands automatically increment the address so the
user can start writing the PHASE register and finish          OUTPUT          FLINE = 45 HZ          FLINE = 65 HZ
                                                             SAMPLES             OSR = 64              OSR = 64
with the CONFIG register in only one communication             / LINE
(see Figure 6-6). The RESET<5:0> bits are in the               CYCLE         FD         MCLK         FD        MCLK
CONFIG register to allow it to exit soft reset mode and
                                                                  64      2.8 ksps    737.28 kHz 4.2 ksps    1.075 MHz
have the whole part configured and ready to run in only
                                                                 128     5.76 ksps    1.475 MHz   8.4 ksps    2.15 MHz
one command.
                                                                 256      11.5 ksps   2.949 MHz  16.7 ksps     4.3 MHz
TABLE 6-1:          REGISTER GROUPS
                                                           Figure 6-7 illustrates operating the part in this manner
          GROUP                     ADDRESSES              (timings not to scale, functional description only).
 Pair A, CHANNEL 0/1                 0x00 - 0x01           All channels are continuously converting during normal
 Pair B, CHANNEL 2/3                 0x02 - 0x03           operation of the device except when it is in Sleep Mode
 Pair C, CHANNEL 4/5                 0x04 - 0x05           by using the RESET bit, or if RESET is low. The
                                                           following figure represents the clocking scheme and
 MOD, PHASE, GAIN                    0x06 - 0x08           how the CONFIG PRESCALE<1:0> bits and
 STATUS, CONFIG                      0x09 - 0x0A           OSR<1:0> bits registers is used to modify the clock
                                                           prescale and oversampling ratio.
The following internal registers are defined as types:
                                                           For example, if a data ready pulse occurs while ADC
TABLE 6-2:          REGISTER TYPES                         data (a) is being transmitted on SPI, this data will not
                                                           be corrupt in any way. After CS is toggled low to begin
        TYPE                     ADDRESSES                 another transmission, the next data (b) would be
 ADC DATA                         0x00 - 0x05              present in the output buffer ready for transmission.
 CONTROL                          0x06 - 0x0A
6.8       Situations that Reset ADC Data
Immediately after the following actions, the ADCs are
reset and automatically restarted in order to provide
proper operations:
         1: Change in phase register
         2: Change in the OSR setting
         3: Change in the PRESCALER setting
         4: Overwrite of identical PHASE register
             value
         5: Change in EXTCLK bit in the CONFIG
             register modifying internal oscillator state.
© 2011 Microchip Technology Inc.                                                                    DS25048B-page 33


MCP3903
                                                           • DRn_MODE<1:0> = 11: Both Data Ready pulses
                               1 / fDATA                     from ADC Channel 0/2/4 and ADC Channel 1/3/5
                                                             are output on DR pin.
                                                           • DRn_MODE<1:0> = 10: Data Ready pulses from
                                                             ADC Channel 1/3/5 are output on the correspond-
                                                             ing DRn pin. Data Ready pulses from ADC Chan-
                                                             nel 0/2/4 are not present on the pin.
                                                           • DRn_MODE<1:0> = 01: Data Ready pulses from
                         1 / fLINE                           ADC Channel 0/2/4 are output on the correspond-
                                                             ing DRn pin. Data Ready pulses from ADC Chan-
                                                             nel 1/3/5 are not present on the pin.
                                                           • DRn_MODE<1:0> = 00: (Recommended, and
 OSC1/MCLKI                                                  Default Mode). Data Ready pulses from the
                                                             lagging ADC between the two are output on DR
                            1 / fDATA                        pin. The lagging ADC depends on the phase
       DRn                                                   register and on the OSR. In this mode the two
                                                             ADCs are linked together so their data is latched
       CS                                                    together when the lagging ADC output is ready.
       SCK                                                 6.10.2     DR PULSES WITH SHUTDOWN OR
 SPI                                                                  RESET CONDITIONS
       SDI
                                                           There will be no data ready pulses if
       SDO                                                 DRn_MODE<1:0>=00 when either one or both of the
                                                           ADCs of the corresponding pair are in reset or shut-
FIGURE 6-7:            Standard Device Operation.          down. In Mode 00, a data ready pulse only happens
                                                           when both ADCs of the corresponding pair are ready.
                                                           Any data ready pulse will correspond to one data on
6.10        Data Ready Pulses (DRn)                        both ADCs. The two ADCs are linked together and act
To ensure that all channel ADC data are present at the     as if there was only one channel with the combined
same time for SPI read, regardless of phase delay set-     data of both ADCs. This mode is very practical when
tings for either or both channels, there are two sets of   both ADC channel data retrieval and processing need
latches in series with both the data ready and the ‘read   to be synchronized, as in power metering applications.
start’ triggers.                                           Figure 6-8 represents the behavior of the data ready
The first set of latches holds each output when data is    pin with the different DRn_MODE and DR_LTY
ready and latches both outputs together when               configurations, while shutdown or resets are applied.
DRMODE<1:0>=00. When this mode is on, both ADCs
                                                             Note:    If DRn_MODE<1:0>=11, the user will still
work together and produce one set of available data
                                                                      be able to retrieve the data ready pulse for
after each data ready pulse (that corresponds to the
                                                                      the ADC not in shutdown or reset, i.e. only
lagging ADC data ready). The second set of latches
                                                                      1 ADC channel needs to be awake.
ensures that when reading starts on an ADC output, the
corresponding data is latched so that no data
corruption can occur.
If an ADC read has started, in order to read the
following ADC output, the current reading needs to be
completed (all bits must be read from the ADC output
data registers).
6.10.1       DATA READY PINS (DRn) CONTROL
             USING DRn_MODE BITS
There are four modes that control the data ready
pulses, and these modes are set with the
DRn_MODE<1:0> bits in the STATUS/COM register.
For      power       metering        applications,
DRn_MODE<1:0>=00 is recommended (default
mode).
The position of data ready pulses vary with respect to
this mode, to the OSR and to the PHASE settings:
DS25048B-page 34                                                                  © 2011 Microchip Technology Inc.


                                                                                                                                                                                                                                                                                                                                                                                  DS25048B-page 35
MCP3903
                                                              3*DRCLK period                                                                                                                                                                                                                                         3*DRCLK period
                                                                                                                                                                                                                                                                         Internal reset synchronisation
                                                 DRCLK period                                                                                            1 DMCLK period    DRCLK period                                                                                        (1 DMCLK period)           DRCLK period
                                  RESET
                            RESET<0> or
                        SHUTDOWN<0>
                            RESET<1> or
                        SHUTDOWN<1>
                      DRMODE=00; DR
                                                                       D0        D1        D2                                                  D3         D4              D5         D6                                  D7          D8          D9          D10              D11                                          D12         D13         D14
                      DRMODE=01; DR
          PHASE > 0
                                                             D0             D1        D2                                                  D3        D4         D5              D6          D7          D8          D9          D10         D11         D12         D13                                              D14          D15         D16
                      DRMODE=10; DR
                                                                       D0        D1        D2           D3            D4             D5        D6         D7              D8         D9                                  D10         D11         D12         D13              D14                                          D15         D16         D17
                      DRMODE=11; DR
                                                             D0        D1 D2     D3 D4     D5           D6            D7             D8 D9     D10 D11    D12 D13     D14 D15        D16 D17           D18         D19   D20 D21     D22 D23     D24 D25     D26 D27          D28                                   D29    D30 D31     D32 D33     D34
                      DRMODE=00; DR
                                                             D0             D1        D2                                                  D3        D4         D5              D6                                              D7          D8          D9          D10                                              D11          D12         D13
                      DRMODE=01; DR
          PHASE = 0
                                                             D0             D1        D2                                                  D3        D4         D5              D6          D7          D8          D9          D10         D11         D12         D13                                              D14          D15         D16
                      DRMODE=10; DR
                                                             D0             D1        D2        D3           D4            D5             D6        D7         D8              D9                                              D10         D11         D12         D13                                              D14          D15         D16
                                                                                                                                                                                                                                                                                                                                                         Data Ready Behavior.
                      DRMODE=11; DR
                                                             D0             D1        D2        D3           D4            D5             D6        D7         D8              D9          D10         D11         D12         D13         D14         D15         D16                                              D17          D18         D19
                      DRMODE=00; DR
                                                                       D0        D1        D2                                        D3        D4         D5              D6         D7                                              D8          D9          D10              D11                                          D12         D13         D14
                      DRMODE=01; DR
                                                                                                                                                                                                                                                                                                                                                                                © 2011 Microchip Technology Inc.
                                                                       D0        D1        D2                                        D3        D4         D5              D6         D7          D8          D9          D10         D11         D12         D13              D14                                          D15         D16         D17
          PHASE < 0
                      DRMODE=10; DR
                                                             D0             D1        D2        D3           D4            D5             D6        D7         D8              D9                                              D10         D11         D12         D13                                              D14          D15         D16
                      DRMODE=11; DR
                                                             D0        D1 D2     D3 D4     D5 D6             D7            D8        D9 D10    D11 D12    D13 D14     D15 D16        D17         D18         D19         D20 D21     D22 D23     D24 D25     D26 D27          D28                                   D29    D30 D31     D32 D33     D34
                                                                                                                                                                                                                                                                                                                                                         FIGURE 6-8:
                      DRMODE=00 : Select the lagging Data Ready                             Data Ready pulse that appears only when DR_LTY=0
                      DRMODE=01 : Select the Data Ready on channel 0
                      DRMODE=10 : Select the Data Ready on channel 1
                      DRMODE=11 : Select both Data ready


MCP3903
6.11      DATA READY PULSE WITH                              6.11.1        DATA READY LINK
          PHASE DELAY                                        When DRLINK=0, the three pairs of ADCs are
                                                             independent from each other. The data readys and the
To ensure that both channel ADC data from the same           latches for the output data only depend on both ADCs
pair are present at the same time for SPI read, regard-      in the pair. When another ADC (not in the pair) is put in
less of phase delay settings for either or both channels,    SHUTDOWN or RESET, it has no effect.
there are two sets of latches in series with both the data
ready and the reading start triggers. The first latch is set When DRLINK=1, all ADCs are linked together. The
on whichever channel is the lagging channel (relative to     DRn_MODE<1:0> are all set internally to 00. All
the other channel, in a single channel pair). The second     DRn_MODE<1:0> bits are not taken into account.
latch is set when an ADC output read command is              All six channel ADC data are latched synchronously
issued, ensuring synchronized data ready pulses.             with the most lagging ADC channel of the six.
                                                             All three DRA, DRB and DRC data ready pins are
                                                             giving the same output that is synchronized with the
      CHn ADC            LATCH                               most lagging ADC of the six channels. Only one pin can
                                           SPI Serial        be connected to the MCU in this mode, which saves
                                           Interface         two connection ports on the MCU.
      CHn ADC             LATCH                              In this mode, if any channel is in SHUTDOWN or
                                                             RESET mode, no data ready is present on any of the
                                                             DRA/DRB/DRC pins. The part acts as if there was only
                                      Synchronized           one ADC channel with 6x24 bits.
                                    data ready pulses        Depending on the read modes, the ADC data can be
                                                             retrieved by pair (Read by GROUP) or all together
FIGURE 6-9:              Internal Latches                    (Read by TYPE). Any time a new read command is per-
Synchronizing Data Ready Pulses with Phase                   formed, the ADC outputs are re-latched. In order to
Delay Present (Single Channel Pair Shown).                   avoid loss of data or bad synchronization, the read
                                                             mode by TYPES is recommended (READ<1:0>=10) so
                                                             that all data can be latched once at the beginning of the
                                                             read. In the read mode by GROUP (READ<1:0>=01)
                                                             mode, the data will be relatched every time the part
                                                             accesses to each group or pair of ADCs.
DS25048B-page 36                                                                       © 2011 Microchip Technology Inc.


                                                                                                                              MCP3903
7.0        INTERNAL REGISTERS
The addresses associated with the internal registers
are listed below. All registers are 24 bits long and can
be addressed separately. A detailed description of the
registers follows.                                                                              .
TABLE 7-1:        INTERNAL REGISTER SUMMARY
  Address             Name                   Bits     R/W                                                       Description
    0x00          CHANNEL 0                  24       R                              Channel 0 ADC Data <23:0>, MSB first, left justified
    0x01          CHANNEL 1                  24       R                              Channel 1 ADC Data <23:0>, MSB first, left justified
    0x02          CHANNEL 2                  24       R                              Channel 2 ADC Data <23:0>, MSB first, left justified
    0x03          CHANNEL 3                  24       R                              Channel 3 ADC Data <23:0>, MSB first, left justified
    0x04          CHANNEL 4                  24       R                              Channel 4 ADC Data <23:0>, MSB first, left justified
    0x05          CHANNEL 5                  24       R                              Channel 5 ADC Data <23:0>, MSB first, left justified
    0x06              MOD                    24       R/W                            Delta Sigma Modulators Output Value
    0x07             PHASE                   24       R/W                            Phase Delay Configuration Register
    0x08              GAIN                   24       R/W                            Gain Configuration Register
    0x09         STATUS/COM                  24       R/W                            Status/Communication Register
    0x0A            CONFIG                   24       R/W                            Configuration Register
The following table shows how the internal address                                              7.1      Channel Output Registers
counter will loop on specific register groups and types.
TABLE 7-2:        CONTINUOUS READ                                                               TABLE 7-3:         ADC OUTPUT REGISTERS
                  OPTIONS, LOOPING ON
                                                                                                      Name           Bits        Address      Cof
                  INTERNAL ADDRESSES
                                                                                                    CHANNEL 0        24           0x00         R
                                READ<1:0>
                             = “01”          = “10”    =“11”
                                                                                                    CHANNEL 1        24           0x01         R
  Function      Address
                                                                                                    CHANNEL 2        24           0x02         R
CHANNEL 0         0x00                                                                              CHANNEL 3        24           0x03         R
                            GROUP
CHANNEL 1         0x01                                                                              CHANNEL 4        24           0x04         R
                                                          LOOP ENTIRE REGISTER MAP
CHANNEL 2         0x02                                                                              CHANNEL 5        24           0x05         R
CHANNEL 3         0x03
                            GROUP              TYPE                                             The ADC Channel data output registers always contain
CHANNEL 4         0x04                                                                          the most recent A/D conversion data for each channel.
                            GROUP                                                               These registers are read-only. They can be accessed
CHANNEL 5         0x05
                                                                                                independently or linked together (with READ<1:0>
      MOD         0x06                                                                          bits). These registers are latched when an ADC read
                               GROUP GROUP
   PHASE          0x07                                                                          communication occurs. When a data ready event
                                                                                                occurs during a read communication, the most current
                                               TYPE
      GAIN        0x08
                                                                                                ADC data is also latched to avoid data corruption
  STATUS/         0x09                                                                          issues. The three bytes of each channel are updated
   COM
                                                                                                synchronously at a DRCLK rate. The three bytes can
  CONFIG          0x0A                                                                          be accessed separately if needed, but are refreshed
                                                                                                synchronously. The coding is 23-bit + sign two’s
                                                                                                complement (see Section 5.5).
© 2011 Microchip Technology Inc.                                                                                                     DS25048B-page 37


MCP3903
REGISTER 7-1:           CHANNEL REGISTER
       R-0           R-0             R-0           R-0          R-0             R-0         R-0            R-0
   D23 (MSB)         D22            D21           D20           D19             D18         D17           D16
 bit 23                                                                                                       bit 16
       R-0           R-0             R-0           R-0          R-0             R-0         R-0            R-0
       D15           D14            D13           D12           D11             D10           D9           D8
 bit 15                                                                                                        bit 8
       R-0           R-0             R-0           R-0          R-0             R-0         R-0            R-0
        D7            D6             D5            D4            D3             D2            D1           D0
 bit 7                                                                                                         bit 0
 Legend:
 R = Readable bit              W = Writable bit            U = Unimplemented bit, read as ‘0’
 -n = Value at POR             ‘1’ = Bit is set            ‘0’ = Bit is cleared        x = Bit is unknown
 bit 23:0        24-bit ADC output data of the corresponding channel
DS25048B-page 38                                                                     © 2011 Microchip Technology Inc.


                                                                                                MCP3903
7.2       Mod Register                                          The MOD register contains the most recent modulator
                                                                data output. The default value corresponds to an
                                                                equivalent input of 0V on each ADC. Each bit in this
TABLE 7-4:         MODULATOR OUTPUT                             register corresponds to one comparator output on one
                   REGISTER                                     of the channels.
      Name           Bits          Address        Cof           This register should be used as a read-only register.
       MOD            24             0x06         R/W           (Note 1). This register is updated at the refresh rate of
                                                                DMCLK (typically 1 MHz with MCLK = 4 MHz). The
                                                                default       state     for      this      register      is
                                                                001100110011001100110011.
REGISTER 7-2:          MOD REGISTER
     R/W-0         R/W-0           R/W-1          R/W-1       R/W-0            R/W-0           R/W-1           R/W-1
  COMP3_CH5      COMP2_CH5       COMP1_CH5      COMP0_CH5   COMP3_CH4        COMP2_CH4       COMP1_CH4       COMP0_CH4
 bit 23                                                                                                             bit 16
     R/W-0         R/W-0           R/W-1          R/W-1       R/W-0            R/W-0           R/W-1           R/W-1
  COMP3_CH3      COMP2_CH3       COMP1_CH3      COMP0_CH3   COMP3_CH2        COMP2_CH2       COMP1_CH2       COMP0_CH2
 bit 15                                                                                                              bit 8
     R/W-0         R/W-0           R/W-1          R/W-1       R/W-0            R/W-0           R/W-1           R/W-1
  COMP3_CH1      COMP2_CH1       COMP1_CH1      COMP0_CH1   COMP3_CH1        COMP2_CH0       COMP1_CH0       COMP0_CH0
 bit 7                                                                                                               bit 0
 Legend:
 R = Readable bit              W = Writable bit           U = Unimplemented bit, read as ‘0’
 -n = Value at POR             ‘1’ = Bit is set           ‘0’ = Bit is cleared             x = Bit is unknown
 bit 23:20      COMPn_CH5: Comparator Outputs from ADC Channel 5
 bit 19:16      COMPn_CH4: Comparator Outputs from ADC Channel 4
 bit 15:12      COMPn_CH3: Comparator Outputs from ADC Channel 3
 bit 11:8       COMPn_CH2: Comparator Outputs from ADC Channel 2
 bit 7:4        COMPn_CH1: Comparator Outputs from ADC Channel 1
 bit 3:0        COMPn_CH0: Comparator Outputs from ADC Channel 0
© 2011 Microchip Technology Inc.                                                                        DS25048B-page 39


MCP3903
7.3       Phase Register                                         The reference channel is the odd channel (Channel 1/
                                                                 3/5). When PHASEn<7:0> is positive, Channel 0/2/4 is
TABLE 7-5:           PHASE REGISTER                              lagging versus channel 1/3/5 otherwise it is leading.
      Name             Bits          Address         Cof         The delay is calculated by the following formula:
     PHASE              24             0x07         R/W          Delay = PHASE Register Code / DMCLK.
The phase register is composed of three bytes:
PHASEC<7:0>, PHASEB<7:0>, PHASEA<7:0>. Each
byte is a 7 bit + sign MSB first, two's complement code
that represents the amount of delay between each pair
of ADCs. The PHASEC byte represents the delay
between Channel 4 and Channel 5 (pair C). The
PHASEB byte represents the delay between Channel 2
and Channel 3 (pair B). The PHASEA byte represents
the delay between Channel 0 and Channel 1 (pair A).
REGISTER 7-3:               PHASE REGISTER
      R/W-0           R/W-0            R/W-0          R/W-0     R/W-0            R/W-0         R/W-0           R/W-0
   PHASEC7          PHASEC6          PHASEC5        PHASEC4  PHASEC3          PHASEC2        PHASEC1        PHASEC0
 bit 23                                                                                                            bit 16
      R/W-0           R/W-0            R/W-0          R/W-0     R/W-0            R/W-0         R/W-0           R/W-0
   PHASEB7          PHASEB6          PHASEB5        PHASEB4  PHASEB3          PHASEB2        PHASEB1        PHASEB0
 bit 15                                                                                                             bit 8
      R/W-0           R/W-0            R/W-0          R/W-0     R/W-0            R/W-0         R/W-0           R/W-0
   PHASEA7          PHASEA6          PHASEA5        PHASEA4  PHASEA3          PHASEA2        PHASEA1        PHASEA0
 bit 7                                                                                                              bit 0
 Legend:
 R = Readable bit                  W = Writable bit         U = Unimplemented bit, read as ‘0’
 -n = Value at POR                 ‘1’ = Bit is set         ‘0’ = Bit is cleared           x = Bit is unknown
 bit 23:16         PHASECn: CH4 relative to CH5 phase delay
 bit 15:8          PHASEBn: CH2 relative to CH3 phase delay
 bit 7:0           PHASEAn: CH0 relative to CH1 phase delay
DS25048B-page 40                                                                         © 2011 Microchip Technology Inc.


                                                                                          MCP3903
7.4       Gain Configuration Register
TABLE 7-6:         GAIN REGISTER
       Name          Bits         Address       Cof
       GAIN           24            0x08        R/W
This register contains the gain register
REGISTER 7-4:            GAIN REGISTER
     R/W-0        R/W-0          R/W-0         R/W-0         R/W-0           R/W-0       R/W-0          R/W-0
  PGA2_CH5      PGA1_CH5      PGA0_CH5       BOOST_ CH5  BOOST_ CH4        PGA2_CH4   PGA1_CH4       PGA0_CH4
 bit 23                                                                                                     bit 16
     R/W-0        R/W-0          R/W-0         R/W-0         R/W-0           R/W-0       R/W-0          R/W-0
  PGA2_CH3      PGA1_CH3      PGA0_CH3       BOOST_ CH3  BOOST_ CH2        PGA2_CH2   PGA1_CH2       PGA0_CH2
 bit 15                                                                                                      bit 8
     R/W-0        R/W-0          R/W-0         R/W-0         R/W-0           R/W-0       R/W-0          R/W-0
  PGA2_CH1      PGA1_CH1      PGA0_CH1       BOOST_ CH1  BOOST_ CH0        PGA2_CH0   PGA1_CH0       PGA0_CH0
 bit 7                                                                                                       bit 0
 Legend:
 R = Readable bit           W = Writable bit            U = Unimplemented bit, read as ‘0’
 -n = Value at POR          ‘1’ = Bit is set            ‘0’ = Bit is cleared         x = Bit is unknown
 bit           PGA_CHn: PGA Setting for Channel n
               111 = Reserved (Gain = 1)
               110 = Reserved (Gain = 1)
               101 = Gain is 32
               100 = Gain is 16
               011 = Gain is 8
               010 = Gain is 4
               001 = Gain is 2
               000 = Gain is 1
 bit           BOOST_CHn Current Scaling for high speed operation for channel n
               1 = Channel has current x 2
               0 = Channel has normal current
© 2011 Microchip Technology Inc.                                                                 DS25048B-page 41


MCP3903
7.5         STATUS/COM Register - Status                       If one of the channels is in reset or shutdown, only one
            and Communication Register                         of the data ready pulses is present and the situation is
                                                               similar to DRn_MODE<1:0> = 01 or 10. In the 01,10
TABLE 7-7:          STATUS/COM Register                        and 11 modes, the data is latched at the beginning of a
                                                               reading, in order to prevent the case of erroneous data
        Name             Bits        Address      Cof
                                                               when a data ready pulse happens when reading.
  STATUS/COM             24            0x09       R/W
                                                               7.5.4        DATA READY STATUS FLAG -
7.5.1         DATA READY LATENCY - DR_LTY                                   DRSTATUS_CHN
This bit determines if the data ready pulses correspond        These bits indicate the data ready status of each chan-
to settled data or unsettled data from each SINC3 filter.      nel. These flags are set to logic high after being the
Unsettled data will provide data ready pulses every            STATUS/COM register has been read. These bits are
DRCLK period. Settled data will wait for 3 DRCLK               cleared when a data ready event has happened on its
periods before giving data ready pulses and will then          respective ADC. Writing these bits has no effect.
give data ready pulses every DRCLK period.
                                                                  Note:     These bits are useful if multiple devices
7.5.2         DATA READY HIGH Z MODE -                                      share the same DRn output pin
              DR_HIZ                                                        (DR_HIZ=0) in order to understand which
                                                                            device the data ready event occured from.
Using this bit, the user can connect multiple chips with                    In case the DRn_MODE=00 (Linked
the same data ready pin with a pull up resistor                             ADCs), these data ready status bits will be
(DR_HIZ=0) or a single chip with no external compo-                         updated synchronously upon the same
nent (DR_HIZ=1)                                                             event (lagging ADC is ready). These bits
                                                                            are also useful in systems where the DRn
7.5.3         DATA READY MODE - DRN_MODE                                    pins are not used to save MCU I/O.
These bits control which ADC data ready is present on
the data ready pin. When the bits are set to 00, the
output of the two ADCs are latched synchronously at
the moment of the data ready event. This prevents bad
synchronization between the two ADCs. The output is
also latched at the beginning of a reading, in order not
to be updated during a read, and not to give erroneous
data.
REGISTER 7-5:                  STATUS/COM REGISTER
      R/W-1        R/W-0          R/W-0         R/W-0       R/W-0             R/W-0           R/W-0          R/W-0
     READ1        READ0          WMODE        WIDTH_CH5   WIDTH_CH4        WIDTH_CH3       WIDTH_CH2       WIDTH_CH1
 bit 23                                                                                                            bit 16
      R/W-0        R/W-1          R/W-0         R/W-0       R/W-0             R/W-0           R/W-0          R/W-0
 WIDTH_CH0        DR_LTY         DR_HIZ        DR_LINK    DRC_MODE1        DRC_MODE0       DRB_MODE1       DRB_MODE0
 bit 15                                                                                                             bit 8
      R/W-0        R/W-0           R-1           R-1          R-1              R-1              R-1           R-1
 DRA_MODE1     DRA_MODE0      DRSTATUS_CH5 DRSTATUS_CH4 DRSTATUS_CH3 DRSTATUS_CH2 DRSTATUS_CH1 DRSTATUS_CH0
 bit 7                                                                                                              bit 0
 bit 23:22     READ[1:0]: Address Loop Setting
               11 = Address counter incremented, cycle through entire register map
               10 = Address counter loops on register TYPES (DEFAULT)
               01 = Address counter loops on register GROUPS
               00 = Address not incremented, continually read single register
 bit 21        WMODE: Write Mode Bit (internal use only)
               1 = Static addressing Write Mode
               0 = Incremental addressing Write Mode (DEFAULT)
DS25048B-page 42                                                                        © 2011 Microchip Technology Inc.


                                                                                         MCP3903
REGISTER 7-5:               STATUS/COM REGISTER (CONTINUED)
bit 20:15    WIDTH_CHn ADC Channels output data word width control
             1 = 24-bit mode for the corresponding channel
             0 = 16-bit mode for the corresponding channel (default)
bit 14       DR_LTY: Data Ready Latency Control for DRA, DRB, and DRC pins
             1 = True “No Latency” Conversion, data ready pulses after 3 DRCLK periods (DEFAULT)
             0 = Unsettled Data is available after every DRCLK period
bit 13       DR_HIZ: Data Ready Pin Inactive State Control for DRA, DRB, and DRC pins
             1 = The Default state is a logic high when data is NOT ready
             0 = The Default state is high impedance when data is NOT ready (DEFAULT)
bit 12       DR_LINK Data Ready Link Control
             1 = Data Ready Link turned ON, all channels linked and data ready pulses from the most lagging ADC
                  are present on each DRn pin
             0 = Data Ready Link tunred OFF (DEFAULT)
bit 11:10    DRC_MODE[1:0]
             11 = Both Data Ready pulses from CH4 and CH5 are output on DRC pin.
             10 = Data Ready pulses from CH5 are output on DRC pin. Data Ready pulses R from CH4 are not pres-
                  ent on the pin.
             01 = Data Ready pulses from CH4 are output on DRC pin. Data Ready pulses from CH5 are not present
                  on the pin.
             00 = Data Ready pulses from the lagging ADC channel between the two are output on DRC pin. The
                  lagging ADC channel depends on the phase register and on the OSR. (DEFAULT)
bit 9:8      DRB_MODE[1:0]
             11 = Both Data Ready pulses from CH2 and CH3 are output on DRB pin.
             10 = Data Ready pulses from CH3 are output on DRB pin. Data Ready pulses from CH2 are not present
                  on the pin.
             01 = Data Ready pulses from CH2 are output on DRB pin. Data Ready pulses from CH3 are not present
                  on the pin.
             00 = Data Ready pulses from the lagging ADC channel between the two are output on DRB pin. The
                  lagging ADC channel depends on the phase register and on the OSR. (DEFAULT)
bit 7:6      DRA_MODE[1:0]
             11 = Both Data Ready pulses from CH0 and CH1 are output on DRA pin.
             10 = Data Ready pulses from CH1 are output on DRA pin. Data Ready pulses from CH0 are not present
                  on the pin.
             01 = Data Ready pulses from CH0 are output on DRA pin. Data Ready pulses from CH1 are not present
                  on the pin.
             00 = Data Ready pulses from the lagging ADC channel between the two are output on DRA pin. The
                  lagging ADC channel depends on the phase register and on the OSR. (DEFAULT)
bit 5:0      DRSTATUS_CHn: Data Ready Status
             1 = Data Not Ready (default)
             0 = Data Ready
© 2011 Microchip Technology Inc.                                                                DS25048B-page 43


MCP3903
7.6           Config Register - Configuration
              Register
TABLE 7-8:           CONFIG Register
       Name             Bits        Address         Cof
     CONFIG              24           0x0A          R/W
REGISTER 7-6:             CONFIG REGISTER
      R/W-0         R/W-0           R/W-0             R/W-0         R/W-0      R/W-0      R/W-0            R/W-0
  RESET_CH5       RESET_CH4      RESET_CH3         RESET_CH2    RESET_CH1 RESET_CH0 SHUTDOWN_CH5      SHUTDOWN_CH4
 bit 23                                                                                                           bit 16
      R/W-0         R/W-0           R/W-0             R/W-0         R/W-1      R/W-1      R/W-1            R/W-1
 SHUTDOWN_       SHUTDOWN_     SHUTDOWN_CH1      SHUTDOWN_CH0    DITHER_CH5 DITHER_CH4 DITHER_CH3       DITHER_CH2
       CH3           CH2
       bit 15                                                                                               bit 8
      R/W-1         R/W-1           R/W-0             R/W-1         R/W-0      R/W-0      R/W-0            R/W-0
 DITHER_CH1      DITHER_CH0         OSR1              OSR0       PRESCALE1 PRESCALE0    EXTVREF           EXTCLK
 bit 7                                                                                                             bit 0
 bit 23:18       RESET_CHn: Reset mode setting for ADCs
                 1 = Reset mode for the corresponding ADC channel ON
                 0 = Reset mode for the corresponding ADC chnnel OFF (default)
 bit 17:12       SHUTDOWN_CHn: Shutdown mode setting for ADCs
                 1 = Shutdown mode for the corresponding ADC channel ON
                 0 = Shutdown mode for the corresponding ADC channel OFF(default)
 bit 11:6        DITHER_CHn: Control for dithering circuit for idle tones cancellation
                 1 = Dithering circuit for the corresponding ADC channel ON (default)
                 0 = Dithering circuit for the corresponding ADC channel OFF
 bit 5:4         OSR[1:0] Oversampling Ratio for Delta Sigma A/D Conversion (ALL CHANNELS, fd / fS)
                 11 = 256
                 10 = 128
                 01 = 64 (default)
                 00 = 32
 bit 3:2         PRESCALE[1:0] Internal Master Clock (AMCLK) Prescaler Value
                 11 = AMCLK = MCLK/ 8
                 10 = AMCLK = MCLK/ 4
                 01 = AMCLK = MCLK/ 2
                 00 = AMCLK = MCLK (DEFAULT)
 bit 1           EXTVREF Internal Voltage Reference Shutdown Control
                 1 = Internal Voltage Reference Disabled
                 0 = Internal Voltage Reference Enabled (default)
 bit 0           EXTCLK Clock Mode
                 1 = CLOCK Mode (Internal Oscillator Disabled - Lower Power)
                 0 = XT Mode - A crystal must be placed between OSC1/OSC2 (default)
DS25048B-page 44                                                                       © 2011 Microchip Technology Inc.


                                                                                             MCP3903
8.0     PACKAGING INFORMATION
8.1     Package Marking Information
           28-Lead SSOP (5.30 mm)                                               Example
                                                                                         MCP3903
                                                                                          E/SS e3
                                                                                          1124256
           28-Lead SSOP (5.30 mm)                                                 Example
                                                                                         MCP3903
                                                                                         I/SS    e3
                                                                                          1124256
                 Legend: XX...X      Customer-specific information
                            Y        Year code (last digit of calendar year)
                            YY       Year code (last 2 digits of calendar year)
                            WW       Week code (week of January 1 is week ‘01’)
                            NNN      Alphanumeric traceability code
                             e3      Pb-free JEDEC designator for Matte Tin (Sn)
                            *        This package is Pb-free. The Pb-free JEDEC designator ( e3 )
                                     can be found on the outer packaging for this package.
                 Note:   In the event the full Microchip part number cannot be marked on one line, it will
                         be carried over to the next line, thus limiting the number of available
                         characters for customer-specific information.
© 2011 Microchip Technology Inc.                                                                      DS25048B-page 45


MCP3903
/HDG3ODVWLF6KULQN6PDOO2XWOLQH 66 ±PP%RG\>6623@
   1RWH     )RUWKHPRVWFXUUHQWSDFNDJHGUDZLQJVSOHDVHVHHWKH0LFURFKLS3DFNDJLQJ6SHFLILFDWLRQORFDWHGDW
             KWWSZZZPLFURFKLSFRPSDFNDJLQJ
                                         D
                        N
                                                                     E
                                                               E1
                        1 2
                              b
                 NOTE 1
                                                        e
                                                                             c
          A                                                         A2
                                                                                                                   φ
            A1
                                                                                     L1                               L
                                                                8QLWV               0,//,0(7(56
                                                    'LPHQVLRQ/LPLWV        0,1          120            0$;
                    1XPEHURI3LQV                                1                        
                    3LWFK                                         H                    %6&
                    2YHUDOO+HLJKW                                $          ±              ±           
                    0ROGHG3DFNDJH7KLFNQHVV                     $                             
                    6WDQGRII                                    $                     ±             ±
                    2YHUDOO:LGWK                                 (                             
                    0ROGHG3DFNDJH:LGWK                         (                             
                    2YHUDOO/HQJWK                                '                           
                    )RRW/HQJWK                                   /                             
                    )RRWSULQW                                    /                    5()
                    /HDG7KLFNQHVV                                F                     ±           
                    )RRW$QJOH                                                                      
                    /HDG:LGWK                                    E                     ±           
1RWHV
 3LQYLVXDOLQGH[IHDWXUHPD\YDU\EXWPXVWEHORFDWHGZLWKLQWKHKDWFKHGDUHD
 'LPHQVLRQV'DQG(GRQRWLQFOXGHPROGIODVKRUSURWUXVLRQV0ROGIODVKRUSURWUXVLRQVVKDOOQRWH[FHHGPPSHUVLGH
 'LPHQVLRQLQJDQGWROHUDQFLQJSHU$60(<0
       %6& %DVLF'LPHQVLRQ7KHRUHWLFDOO\H[DFWYDOXHVKRZQZLWKRXWWROHUDQFHV
       5() 5HIHUHQFH'LPHQVLRQXVXDOO\ZLWKRXWWROHUDQFHIRULQIRUPDWLRQSXUSRVHVRQO\
                                                                                            0LFURFKLS 7HFKQRORJ\ 'UDZLQJ &%
DS25048B-page 46                                                                                  © 2011 Microchip Technology Inc.


                                                                                         MCP3903
  Note:    For the most current package drawings, please see the Microchip Packaging Specification located at
           http://www.microchip.com/packaging
© 2011 Microchip Technology Inc.                                                                 DS25048B-page 47


MCP3903
DS25048B-page 48 © 2011 Microchip Technology Inc.


                                              MCP3903
APPENDIX A:            REVISION HISTORY
Revision B (July 2011)
• Added Section 2.0, Typical Performance
  Curves, with characterization graphs.
Revision A (June 2011)
• Original data sheet for the MCP3903 device.
© 2011 Microchip Technology Inc.                DS25048B-page 51


MCP3903
NOTES:
DS25048B-page 52 © 2011 Microchip Technology Inc.


                                                                                                               MCP3903
PRODUCT IDENTIFICATION SYSTEM
To order or obtain information, e.g., on pricing or delivery, refer to the factory or the listed sales office.
  PART NO.                           X              X              /XX                  Examples:
    Device                                                                              a)     MCP3903T-E/SS:  Tape and Reel,
                               Tape and Temperature             Package
                                   Reel                                                                        Six Channel ΔΣ A/D
                                                Range
                                                                                                               Converter,
                                                                                                               SSOP-28 package
  Device:                MCP3903:       Six Channel ΔΣ A/D Converter                    b)     MCP3903T-I/SS:  Tape and Reel,
                                                                                                               Six Channel ΔΣ A/D
                                                                                                               Converter,
                         * Default option. Contact Microchip factory for other                                 SSOP-28 package
                         address options
  Tape and Reel:         T    = Tape and Reel
  Temperature Range:     I    = -40°C to +85°C
                         E    = -40°C to +125°C
  Package:               SS = Small Shrink Output Package (SSOP-28)
© 2011 Microchip Technology Inc.                                                                                    DS25048B-page 53


MCP3903
NOTES:
DS25048B-page 54 © 2011 Microchip Technology Inc.


 Note the following details of the code protection feature on Microchip devices:
 •     Microchip products meet the specification contained in their particular Microchip Data Sheet.
 •     Microchip believes that its family of products is one of the most secure families of its kind on the market today, when used in the
       intended manner and under normal conditions.
 •     There are dishonest and possibly illegal methods used to breach the code protection feature. All of these methods, to our
       knowledge, require using the Microchip products in a manner outside the operating specifications contained in Microchip’s Data
       Sheets. Most likely, the person doing so is engaged in theft of intellectual property.
 •     Microchip is willing to work with the customer who is concerned about the integrity of their code.
 •     Neither Microchip nor any other semiconductor manufacturer can guarantee the security of their code. Code protection does not
       mean that we are guaranteeing the product as “unbreakable.”
 Code protection is constantly evolving. We at Microchip are committed to continuously improving the code protection features of our
 products. Attempts to break Microchip’s code protection feature may be a violation of the Digital Millennium Copyright Act. If such acts
 allow unauthorized access to your software or other copyrighted work, you may have a right to sue for relief under that Act.
Information contained in this publication regarding device                  Trademarks
applications and the like is provided only for your convenience
                                                                            The Microchip name and logo, the Microchip logo, dsPIC,
and may be superseded by updates. It is your responsibility to
                                                                            KEELOQ, KEELOQ logo, MPLAB, PIC, PICmicro, PICSTART,
ensure that your application meets with your specifications.
                                                                            PIC32 logo, rfPIC and UNI/O are registered trademarks of
MICROCHIP MAKES NO REPRESENTATIONS OR
                                                                            Microchip Technology Incorporated in the U.S.A. and other
WARRANTIES OF ANY KIND WHETHER EXPRESS OR                                   countries.
IMPLIED, WRITTEN OR ORAL, STATUTORY OR
OTHERWISE, RELATED TO THE INFORMATION,                                      FilterLab, Hampshire, HI-TECH C, Linear Active Thermistor,
INCLUDING BUT NOT LIMITED TO ITS CONDITION,                                 MXDEV, MXLAB, SEEVAL and The Embedded Control
QUALITY, PERFORMANCE, MERCHANTABILITY OR                                    Solutions Company are registered trademarks of Microchip
FITNESS FOR PURPOSE. Microchip disclaims all liability                      Technology Incorporated in the U.S.A.
arising from this information and its use. Use of Microchip                 Analog-for-the-Digital Age, Application Maestro, chipKIT,
devices in life support and/or safety applications is entirely at           chipKIT logo, CodeGuard, dsPICDEM, dsPICDEM.net,
the buyer’s risk, and the buyer agrees to defend, indemnify and             dsPICworks, dsSPEAK, ECAN, ECONOMONITOR,
hold harmless Microchip from any and all damages, claims,                   FanSense, HI-TIDE, In-Circuit Serial Programming, ICSP,
suits, or expenses resulting from such use. No licenses are                 Mindi, MiWi, MPASM, MPLAB Certified logo, MPLIB,
conveyed, implicitly or otherwise, under any Microchip                      MPLINK, mTouch, Omniscient Code Generation, PICC,
intellectual property rights.                                               PICC-18, PICDEM, PICDEM.net, PICkit, PICtail, REAL ICE,
                                                                            rfLAB, Select Mode, Total Endurance, TSHARC,
                                                                            UniWinDriver, WiperLock and ZENA are trademarks of
                                                                            Microchip Technology Incorporated in the U.S.A. and other
                                                                            countries.
                                                                            SQTP is a service mark of Microchip Technology Incorporated
                                                                            in the U.S.A.
                                                                            All other trademarks mentioned herein are property of their
                                                                            respective companies.
                                                                            © 2011, Microchip Technology Incorporated, Printed in the
                                                                            U.S.A., All Rights Reserved.
                                                                                 Printed on recycled paper.
                                                                            ISBN: 978-1-61341-402-6
                                                                            Microchip received ISO/TS-16949:2009 certification for its worldwide
                                                                            headquarters, design and wafer fabrication facilities in Chandler and
                                                                            Tempe, Arizona; Gresham, Oregon and design centers in California
                                                                            and India. The Company’s quality system processes and procedures
                                                                            are for its PIC® MCUs and dsPIC® DSCs, KEELOQ® code hopping
                                                                            devices, Serial EEPROMs, microperipherals, nonvolatile memory and
                                                                            analog products. In addition, Microchip’s quality system for the design
                                                                            and manufacture of development systems is ISO 9001:2000 certified.
© 2011 Microchip Technology Inc.                                                                                             DS25048B-page 55


                          Worldwide Sales and Service
AMERICAS                  ASIA/PACIFIC               ASIA/PACIFIC                EUROPE
Corporate Office          Asia Pacific Office        India - Bangalore           Austria - Wels
2355 West Chandler Blvd.  Suites 3707-14, 37th Floor Tel: 91-80-3090-4444        Tel: 43-7242-2244-39
Chandler, AZ 85224-6199   Tower 6, The Gateway       Fax: 91-80-3090-4123        Fax: 43-7242-2244-393
Tel: 480-792-7200         Harbour City, Kowloon                                  Denmark - Copenhagen
                                                     India - New Delhi
Fax: 480-792-7277         Hong Kong                                              Tel: 45-4450-2828
                                                     Tel: 91-11-4160-8631
Technical Support:        Tel: 852-2401-1200                                     Fax: 45-4485-2829
                                                     Fax: 91-11-4160-8632
http://www.microchip.com/ Fax: 852-2401-3431
                                                     India - Pune                France - Paris
support
                          Australia - Sydney         Tel: 91-20-2566-1512        Tel: 33-1-69-53-63-20
Web Address:
                          Tel: 61-2-9868-6733        Fax: 91-20-2566-1513        Fax: 33-1-69-30-90-79
www.microchip.com
                          Fax: 61-2-9868-6755                                    Germany - Munich
Atlanta                                              Japan - Yokohama
                          China - Beijing                                        Tel: 49-89-627-144-0
Duluth, GA                                           Tel: 81-45-471- 6166
                          Tel: 86-10-8569-7000                                   Fax: 49-89-627-144-44
Tel: 678-957-9614                                    Fax: 81-45-471-6122
                          Fax: 86-10-8528-2104                                   Italy - Milan
Fax: 678-957-1455                                    Korea - Daegu
                          China - Chengdu                                        Tel: 39-0331-742611
Boston                                               Tel: 82-53-744-4301
                          Tel: 86-28-8665-5511                                   Fax: 39-0331-466781
Westborough, MA                                      Fax: 82-53-744-4302
                          Fax: 86-28-8665-7889                                   Netherlands - Drunen
Tel: 774-760-0087                                    Korea - Seoul
Fax: 774-760-0088         China - Chongqing          Tel: 82-2-554-7200          Tel: 31-416-690399
                          Tel: 86-23-8980-9588       Fax: 82-2-558-5932 or       Fax: 31-416-690340
Chicago
Itasca, IL                Fax: 86-23-8980-9500       82-2-558-5934               Spain - Madrid
Tel: 630-285-0071         China - Hangzhou                                       Tel: 34-91-708-08-90
                                                     Malaysia - Kuala Lumpur
Fax: 630-285-0075         Tel: 86-571-2819-3180      Tel: 60-3-6201-9857         Fax: 34-91-708-08-91
Cleveland                 Fax: 86-571-2819-3189      Fax: 60-3-6201-9859         UK - Wokingham
Independence, OH          China - Hong Kong SAR                                  Tel: 44-118-921-5869
                                                     Malaysia - Penang
Tel: 216-447-0464         Tel: 852-2401-1200                                     Fax: 44-118-921-5820
                                                     Tel: 60-4-227-8870
Fax: 216-447-0643         Fax: 852-2401-3431         Fax: 60-4-227-4068
Dallas                    China - Nanjing            Philippines - Manila
Addison, TX               Tel: 86-25-8473-2460       Tel: 63-2-634-9065
Tel: 972-818-7423         Fax: 86-25-8473-2470       Fax: 63-2-634-9069
Fax: 972-818-2924
                          China - Qingdao            Singapore
Detroit                   Tel: 86-532-8502-7355      Tel: 65-6334-8870
Farmington Hills, MI
                          Fax: 86-532-8502-7205      Fax: 65-6334-8850
Tel: 248-538-2250
Fax: 248-538-2260         China - Shanghai           Taiwan - Hsin Chu
                          Tel: 86-21-5407-5533       Tel: 886-3-6578-300
Indianapolis              Fax: 86-21-5407-5066       Fax: 886-3-6578-370
Noblesville, IN
Tel: 317-773-8323         China - Shenyang           Taiwan - Kaohsiung
Fax: 317-773-5453         Tel: 86-24-2334-2829       Tel: 886-7-213-7830
                          Fax: 86-24-2334-2393       Fax: 886-7-330-9305
Los Angeles
Mission Viejo, CA         China - Shenzhen           Taiwan - Taipei
Tel: 949-462-9523         Tel: 86-755-8203-2660      Tel: 886-2-2500-6610
Fax: 949-462-9608         Fax: 86-755-8203-1760      Fax: 886-2-2508-0102
Santa Clara               China - Wuhan              Thailand - Bangkok
Santa Clara, CA           Tel: 86-27-5980-5300       Tel: 66-2-694-1351
Tel: 408-961-6444         Fax: 86-27-5980-5118       Fax: 66-2-694-1350
Fax: 408-961-6445         China - Xian
Toronto                   Tel: 86-29-8833-7252
Mississauga, Ontario,     Fax: 86-29-8833-7256
Canada                    China - Xiamen
Tel: 905-673-0699         Tel: 86-592-2388138
Fax: 905-673-6509         Fax: 86-592-2388130
                          China - Zhuhai
                          Tel: 86-756-3210040
                                                                                                   05/02/11
                          Fax: 86-756-3210049
DS25048B-page 56                                                             © 2011 Microchip Technology Inc.


Mouser Electronics
Authorized Distributor
Click to View Pricing, Inventory, Delivery & Lifecycle Information:
Microchip:
 MCP3903-E/SS MCP3903-I/SS MCP3903T-I/SS
