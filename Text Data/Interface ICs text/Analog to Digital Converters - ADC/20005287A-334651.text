                                                                   MCP3918
                        3V Single-Channel Analog Front End
Features:                                           Description:
• One 24-bit Resolution Delta-Sigma A/D Converter   The MCP3918 is a 3V single-channel Analog Front End
                                                    (AFE), containing one delta-sigma, Analog-to-Digital
• 93.5 dB SINAD, -107 dBc Total Harmonic
                                                    Converter (ADC), one programmable gain amplifier
  Distortion (THD) (up to 35th harmonic), 112 dB
                                                    (PGA), phase delay compensation block, low-drift
  Spurious-Free Dynamic Range (SFDR)
                                                    internal voltage reference, digital offset and gain errors
• Flexible Serial Interface that Includes Both SPI  calibration registers, and high-speed 20 MHz
  and a Simple 2-Wire Interface Ideal for Polyphase SPI-compatible serial interface.
  Shunt Energy Meters
                                                    The MCP3918 ADC is fully configurable with features
• Advanced Security Features:                       such as: 16-/24-bit resolution, Oversampling Ratio
  - 16-bit Cyclic Redundancy Check (CRC)            (OSR) from 32 to 4096, gain from 1x to 32x,
     Checksum on All Communications for Secure      independent Shutdown and Reset, dithering and
     Data Transfers                                 auto-zeroing. Communication is largely simplified with
  - 16-bit CRC Checksum and Interrupt Alert for     8-bit commands, including various continuous
     Register-Map Configuration                     read/write modes and 16-/24-/32-bit data formats that
  - Register-Map Lock with 8-bit Secure Key         can be accessed by the Direct Memory Access (DMA)
• 2.7V – 3.6V AVDD, DVDD                            of an 8-/16-/32-bit MCU, and with the separate Data
                                                    Ready pin that can be directly connected to an Interrupt
• Programmable Data Rate, up to 125 ksps:
                                                    Request (IRQ) input of an MCU.
  - 4 MHz Maximum Sampling Frequency
                                                    The MCP3918 includes advanced security features to
  - 16 MHz Maximum Master Clock                     secure the communications and the configuration
• Oversampling Ratio, up to 4096                    settings, such as a CRC-16 checksum on both serial
• Ultra Low-Power Shutdown Mode with < 10 µA        data outputs and on the register-map static
• Low-Drift 1.2V Internal Voltage Reference:        configuration. It also includes a register-map lock
  9 ppm/°C                                          through an 8-bit password to avoid the processing of
                                                    any unwanted write commands.
• Differential Voltage Reference Input Pins
                                                    For polyphase shunt-based energy meters, the
• High-Gain Programmable Gain Amplifier (PGA)
                                                    MCP3918 2-Wire serial interface greatly reduces
  (up to 32 V/V)
                                                    system cost, requiring only a single bidirectional
• Phase Delay Compensation with 1 µs Time           isolator per phase.
  Resolution
                                                    The MCP3918 is capable of interfacing a variety of
• Separate Data Ready Pin for Easy                  voltage and current sensors, including shunts, current
  Synchronization                                   transformers, Rogowski coils and Hall effect sensors.
• Individual 24-bit Digital Offset and Gain Error
  Correction                                        Applications:
• High-Speed 20 MHz SPI Interface with Mode 0,0
  and 1,1 Compatibility                             •  Single-Phase and Polyphase Energy Meters
• Continuous Read/Write Modes for Minimum           •  Energy Metering and Power Measurement
  Communication with Dedicated 16-/32-bit Modes     •  Automotive
• Available in 20-lead QFN and SSOP Packages        •  Portable Instrumentation
• Extended Temperature Range: -40°C to +125°C       •  Medical and Power Monitoring
  (all specifications are valid down to -45°C)      •  Audio/Voice Recognition
                                                    •  Isolator Sensor Application
 2014 Microchip Technology Inc.                                                         DS20005287A-page 1


MCP3918
Package Type
                             MCP3918                                                                                                    MCP3918
                              SSOP                                                                                                      4 x 4 QFN*
                                                                                                                                            RESET/OSR0
   RESET/OSR0                1                20      SDI/OSR1
                                                                                                                                                          SDI/OSR1
         DVDD                2                19      SDO
          AVDD               3                18      SCK/MCLK
                                                                                                                      AVDD         DVDD
         CH0+                4                17      CS/BOOST                                                                                                       SDO
          CH0-               5                16      OSC2/MODE                                                       20 19 18 17 16
            NC               6                15      OSC1/CLKI/GAIN0
           NC                                                                                            CH0+ 1                                                              15 SCK/MCLK
                             7                14      DR/GAIN1
         AGND                8                13      MDAT0                                              CH0- 2                                                              14 CS/BOOST
                                                                                                                                              EP
     REFIN+/OUT              9                12      NC                                                    NC 3                              21                             13 OSC2/MODE
              REFIN-     10                   11      DGND                                                  NC 4                                                             12 OSC1/CLKI/GAIN0
                                                                                                        AGND 5                                                               11 DR/GAIN1
                                                                                                                         6          7         8             9 10
                                                                                                                                   REFIN-
                                                                                                                      REFIN+/OUT
                                                                                                                                            DGND
                                                                                                                                                           NC
                                                                                                                                                                     MDAT0
     * Includes Exposed Thermal Pad (EP); see Table 3-1.
Functional Block Diagram
                                                        AVDD             DVDD
 REFIN+/OUT
                  Voltage           VREFEXT                                                               AMCLK                                                               Xtal Oscillator
                 Reference                                                                                                                                                                      OSC1/CLKI/GAIN0
                                                                                                                                                            Clock             MCLK
                  +
                             VREF                                                                                                                         Generation                            OSC2/MODE
                  -                                                                                     DMCLK/DRCLK
    REFIN-
                                      Vref-   Vref+      ANALOG      DIGITAL
                                                                                                                                                 DMCLK                   OSR<2:0>
                                                                                                                                                                         PRE<1:0>
                                                                             SINC3+             OFFCAL_CH0 GAINCAL_CH0
                                                                             SINC1                 <23:0>     <23:0>
    CH0+                                +                         MOD<3:0>                                           DATA_CH0
    CH0-
                                                                                                    +             X    <23:0>
                                         -                                                                                                                                                      DR/GAIN1
                                          PGA           '6                                                                                                                                    SDO
                                                      Modulator
                                                                         Φ            Phase
                                                                                      Shifter
                                                                                                          PHASE <11:0>
                                                                                                                                                             Digital
                                     Single-Channel '6ADC                                                                                                Interfaces                           RESET/OSR0
                                                                                                                                                         (SPI & 2-wire)                         SDI/OSR1
                                                                                                                                                                                                SCK
                                                                                                                                                                                                CS/BOOST
                                                                                                                                                                        EN_MDAT
                                                                             MOD <3:0>
                                                                                                                                                          Modulator                             MDAT0
                    POR                                                                              POR                                                 Output Block
                    AVDD                                                                             DVDD
                  Monitoring                                                                       Monitoring
                                                         AGND           DGND
DS20005287A-page 2                                                                                                                                                    2014 Microchip Technology Inc.


                                                                                                                                MCP3918
1.0           ELECTRICAL                                                                      † Notice: Stresses above those listed under “Absolute
                                                                                              Maximum Ratings” may cause permanent damage to
              CHARACTERISTICS
                                                                                              the device. This is a stress rating only and functional
                                                                                              operation of the device at those or any other
Absolute Maximum Ratings †                                                                    conditions, above those indicated in the operational
VDD ..................................................................... -0.3V to 4.0V       listings of this specification, is not implied. Exposure to
Digital inputs and outputs w.r.t. AGND ................ --0.3V to 4.0V                        maximum rating conditions for extended periods may
Analog input w.r.t. AGND ..................................... ....-2V to +2V                 affect device reliability.
VREF input w.r.t. AGND ............................... -0.6V to VDD +0.6V
Storage temperature .....................................-65°C to +150°C
Ambient temp. with power applied ................-65°C to +125°C
Soldering temperature of leads (10 seconds) ............. +300°C
ESD on the analog inputs (HBM, MM) ................ 4.0 kV, 200V
ESD on all other pins (HBM, MM) ....................... 4.0 kV, 200V
1.1           Electrical Specifications
TABLE 1-1:                    ANALOG SPECIFICATIONS
 Electrical Specifications: Unless otherwise indicated, all parameters apply at AVDD = DVDD = 3V, MCLK = 4 MHz;
 PRE<1:0> = 00; OSR = 256; GAIN = 1; VREFEXT = 0, CLKEXT = 1, DITHER<1:0> = 11; BOOST<1:0> = 10,
 VCM = 0V; TA = -40°C to +125°C (Note 1); VIN = 1.2 VPP = -0.5 dBFS @ 50/60 Hz on all channels.
        Characteristic                                Sym.                    Min.      Typ.     Max.         Units               Conditions
 ADC Performance
 Resolution                                                                    24        —         —            bits   OSR = 256 or greater
 (No Missing Codes)
 Sampling Frequency                             fS(DMCLK)                      —          1         4          MHz     For maximum condition,
                                                                                                                       BOOST<1:0> = 11
 Output Data Rate                                fD(DRCLK)                     —          4       125          ksps    For maximum condition,
                                                                                                                       BOOST<1:0> = 11,
                                                                                                                       OSR = 32
 Analog Input Absolute                              CH0+/-                     -1        —         +1            V     All analog input channels,
 Voltage on CH0+/- pins                                                                                                measured to AGND
 Analog Input                                           IIN                    —        +/-1       —            nA     RESET<0> = 1,
 Leakage Current                                                                                                       MCLK running continuously
 Differential Input                            (CH0+-CH0-) -600/GAIN                     —   +600/GAIN          mV     VREF = 1.2V,
 Voltage Range                                                                                                         proportional to VREF
 Offset Error                                          VOS                     -1        0.2        1           mV     Note 5
 Offset Error Drift                                                            —         0.5       —          µV/°C
 Gain Error                                             GE                     -4        —         +4            %     Note 5
 Gain Error Drift                                                              —          1        —         ppm/°C
 Integral Non-Linearity                                INL                     —          5        —           ppm
 Note 1:          All specifications are valid down to -45°C.
          2:      This specification implies that the ADC output is valid over this entire differential range and that there is no distortion or
                  instability across this input range. Dynamic Performance specified at -0.5 dB below the maximum signal range,
                  VIN = 1.2 VPP = 424 mVRMS, VREF = 1.2V @ 50/60 Hz. See Section 4.0 “Terminology and Formulas” for definition.
                  This parameter is established by characterization and not 100% tested.
          3:      For these operating currents, the following configuration bit settings apply: SHUTDOWN<0> = 0, RESET<0> = 0,
                  VREFEXT = 0, CLKEXT = 0.
          4:      For these operating currents, the following configuration bit settings apply: SHUTDOWN<0> = 1, VREFEXT = 1,
                  CLKEXT = 1.
          5:      Applies to all gains. Offset and gain errors depend on the PGA gain setting. See Section 2.0 “Typical Performance
                  Curves” for typical performance.
          6:      Outside this range, the ADC accuracy is not specified. An extended input range of +/-2V can be applied continuously to
                  the part, with no damage.
          7:      For proper operation and for optimizing the ADC accuracy, AMCLK should be limited to the maximum frequency defined
                  in Table 5-2, as a function of the BOOST and PGA setting chosen. MCLK can take larger values as long as the
                  prescaler settings (PRE<1:0>) limit AMCLK = MCLK/PRESCALE within the defined range in Table 5-2.
 2014 Microchip Technology Inc.                                                                                                      DS20005287A-page 3


MCP3918
TABLE 1-1:            ANALOG SPECIFICATIONS (CONTINUED)
 Electrical Specifications: Unless otherwise indicated, all parameters apply at AVDD = DVDD = 3V, MCLK = 4 MHz;
 PRE<1:0> = 00; OSR = 256; GAIN = 1; VREFEXT = 0, CLKEXT = 1, DITHER<1:0> = 11; BOOST<1:0> = 10,
 VCM = 0V; TA = -40°C to +125°C (Note 1); VIN = 1.2 VPP = -0.5 dBFS @ 50/60 Hz on all channels.
       Characteristic                 Sym.           Min.       Typ.         Max.          Units                Conditions
 Measurement Error                     ME              —         0.1          —              %       Measured with a 10,000:1
                                                                                                     dynamic range (from
                                                                                                     600 mVPeak to 6 µVPeak),
                                                                                                     AVDD = DVDD = 3V,
                                                                                                     measurement points averaging
                                                                                                     time: 20 seconds.
 Differential Input                     ZIN           232         —           —             k       G = 1, proportional to 1/AMCLK
 Impedance                                            142         —           —             k       G = 2, proportional to 1/AMCLK
                                                       72         —           —             k       G = 4, proportional to 1/AMCLK
                                                       38         —           —             k       G = 8, proportional to 1/AMCLK
                                                       36         —           —             k       G = 16, proportional to 1/AMCLK
                                                       33         —           —             k       G = 32, proportional to 1/AMCLK
 Signal-to-Noise and                 SINAD             92       93.5          —             dB
 Distortion Ratio (Note 2)
 Total Harmonic Distor-                THD             —        -107         -103           dBc      Includes the first
 tion (Note 2)                                                                                       35 harmonics
 Signal-to-Noise Ratio                 SNR             92        94            —            dB
 (Note 2)
 Spurious-Free Dynamic                SFDR             —         112           —           dBFS
 Range (Note 2)
 AC Power Supply                   AC PSRR             —         -73          —             dB       AVDD = DVDD = 3V + 0.6VPP
 Rejection                                                                                           50/60 Hz, 100/120 Hz
 DC Power Supply                   DC PSRR             —         -73          —             dB       AVDD = DVDD = 2.7V to 3.6V
 Rejection
 DC Common Mode                   DC CMRR              —        -105          —             dB       VCM from -1V to +1V
 Rejection
 Note 1:     All specifications are valid down to -45°C.
        2:   This specification implies that the ADC output is valid over this entire differential range and that there is no distortion or
             instability across this input range. Dynamic Performance specified at -0.5 dB below the maximum signal range,
             VIN = 1.2 VPP = 424 mVRMS, VREF = 1.2V @ 50/60 Hz. See Section 4.0 “Terminology and Formulas” for definition.
             This parameter is established by characterization and not 100% tested.
        3:   For these operating currents, the following configuration bit settings apply: SHUTDOWN<0> = 0, RESET<0> = 0,
             VREFEXT = 0, CLKEXT = 0.
        4:   For these operating currents, the following configuration bit settings apply: SHUTDOWN<0> = 1, VREFEXT = 1,
             CLKEXT = 1.
        5:   Applies to all gains. Offset and gain errors depend on the PGA gain setting. See Section 2.0 “Typical Performance
             Curves” for typical performance.
        6:   Outside this range, the ADC accuracy is not specified. An extended input range of +/-2V can be applied continuously to
             the part, with no damage.
        7:   For proper operation and for optimizing the ADC accuracy, AMCLK should be limited to the maximum frequency defined
             in Table 5-2, as a function of the BOOST and PGA setting chosen. MCLK can take larger values as long as the
             prescaler settings (PRE<1:0>) limit AMCLK = MCLK/PRESCALE within the defined range in Table 5-2.
DS20005287A-page 4                                                                                       2014 Microchip Technology Inc.


                                                                                                              MCP3918
TABLE 1-1:            ANALOG SPECIFICATIONS (CONTINUED)
 Electrical Specifications: Unless otherwise indicated, all parameters apply at AVDD = DVDD = 3V, MCLK = 4 MHz;
 PRE<1:0> = 00; OSR = 256; GAIN = 1; VREFEXT = 0, CLKEXT = 1, DITHER<1:0> = 11; BOOST<1:0> = 10,
 VCM = 0V; TA = -40°C to +125°C (Note 1); VIN = 1.2 VPP = -0.5 dBFS @ 50/60 Hz on all channels.
       Characteristic                 Sym.           Min.       Typ.         Max.          Units                Conditions
 Internal Voltage Reference
 Tolerance                            VREF           1.176       1.2        1.224            V       VREFEXT = 0,
                                                                                                     TA = +25°C only
 Temperature Coefficient            TCVREF             —           9          —           ppm/°C TA = -40°C to +125°C,
                                                                                                     VREFEXT = 0
 Output Impedance                 ZOUTVREF             —         0.6          —             k       VREFEXT = 0
 Internal Voltage Refer-           AIDDVREF            —         54           —             µA       VREFEXT = 0,
 ence Operating Current                                                                              SHUTDOWN<0> = 1
 Voltage Reference Input
 Input Capacitance                                     —         —            10             pF
 Differential Input Voltage           VREF            1.1        —            1.3            V       VREFEXT = 1
 Range (VREF+ – VREF-)
 Absolute Voltage                     VREF+       VREF- + 1.1    —      VREF- + 1.3          V       VREFEXT = 1
 on REFIN+ pin
 Absolute Voltage                     VREF-           -0.1       —           +0.1            V       REFIN- should be connected to
 on REFIN- pin                                                                                       AGND when VREFEXT = 0
 Master Clock Input
 Master Clock Input                   fMCLK                      —            20           MHz       CLKEXT = 1 (Note 7)
 Frequency Range
 Crystal Oscillator                    fXTAL           1         —            20           MHz       CLKEXT = 0 (Note 7)
 Operating Frequency
 Range
 Analog Master Clock                AMCLK              —         —            16           MHz       Note 7
 Crystal Oscillator               DIDDXTAL             —         80           —             µA       CLKEXT = 0
 Operating Current
 Power Supply
 Operating Voltage, Analog            AVDD            2.7        —            3.6            V
 Operating Voltage, Digital           DVDD            2.7        —            3.6            V
 Operating Current, Analog             IDD,A           —         0.8           1            mA       BOOST<1:0> = 00
 (Note 3)                                              —           1          1.2           mA       BOOST<1:0> = 01
                                                       —         1.3          1.7           mA       BOOST<1:0> = 10
                                                       —         2.2          2.9           mA       BOOST<1:0> = 11
 Note 1:     All specifications are valid down to -45°C.
        2:   This specification implies that the ADC output is valid over this entire differential range and that there is no distortion or
             instability across this input range. Dynamic Performance specified at -0.5 dB below the maximum signal range,
             VIN = 1.2 VPP = 424 mVRMS, VREF = 1.2V @ 50/60 Hz. See Section 4.0 “Terminology and Formulas” for definition.
             This parameter is established by characterization and not 100% tested.
        3:   For these operating currents, the following configuration bit settings apply: SHUTDOWN<0> = 0, RESET<0> = 0,
             VREFEXT = 0, CLKEXT = 0.
        4:   For these operating currents, the following configuration bit settings apply: SHUTDOWN<0> = 1, VREFEXT = 1,
             CLKEXT = 1.
        5:   Applies to all gains. Offset and gain errors depend on the PGA gain setting. See Section 2.0 “Typical Performance
             Curves” for typical performance.
        6:   Outside this range, the ADC accuracy is not specified. An extended input range of +/-2V can be applied continuously to
             the part, with no damage.
        7:   For proper operation and for optimizing the ADC accuracy, AMCLK should be limited to the maximum frequency defined
             in Table 5-2, as a function of the BOOST and PGA setting chosen. MCLK can take larger values as long as the
             prescaler settings (PRE<1:0>) limit AMCLK = MCLK/PRESCALE within the defined range in Table 5-2.
 2014 Microchip Technology Inc.                                                                                    DS20005287A-page 5


MCP3918
TABLE 1-1:            ANALOG SPECIFICATIONS (CONTINUED)
 Electrical Specifications: Unless otherwise indicated, all parameters apply at AVDD = DVDD = 3V, MCLK = 4 MHz;
 PRE<1:0> = 00; OSR = 256; GAIN = 1; VREFEXT = 0, CLKEXT = 1, DITHER<1:0> = 11; BOOST<1:0> = 10,
 VCM = 0V; TA = -40°C to +125°C (Note 1); VIN = 1.2 VPP = -0.5 dBFS @ 50/60 Hz on all channels.
        Characteristic                 Sym.           Min.      Typ.         Max.          Units                Conditions
 Operating Current, Digital            IDD,D           —         0.2          0.3           mA       MCLK = 4 MHz,
                                                                                                     proportional to MCLK
                                                       —         0.7          —             mA       MCLK = 16 MHz,
                                                                                                     proportional to MCLK
 Shutdown Current, Analog             IDDS,A           —         —             1            µA       AVDD pin only (Note 4)
 Shutdown Current, Digital            IDDS,D           —         —             2            µA       DVDD pin only (Note 4)
 Pull-Down Current                     IOSC2           —         35           —             µA       CLKEXT = 1
 on OSC2 Pin
 (External Clock Mode)
 Note 1:     All specifications are valid down to -45°C.
         2:  This specification implies that the ADC output is valid over this entire differential range and that there is no distortion or
             instability across this input range. Dynamic Performance specified at -0.5 dB below the maximum signal range,
             VIN = 1.2 VPP = 424 mVRMS, VREF = 1.2V @ 50/60 Hz. See Section 4.0 “Terminology and Formulas” for definition.
             This parameter is established by characterization and not 100% tested.
         3:  For these operating currents, the following configuration bit settings apply: SHUTDOWN<0> = 0, RESET<0> = 0,
             VREFEXT = 0, CLKEXT = 0.
         4:  For these operating currents, the following configuration bit settings apply: SHUTDOWN<0> = 1, VREFEXT = 1,
             CLKEXT = 1.
         5:  Applies to all gains. Offset and gain errors depend on the PGA gain setting. See Section 2.0 “Typical Performance
             Curves” for typical performance.
         6:  Outside this range, the ADC accuracy is not specified. An extended input range of +/-2V can be applied continuously to
             the part, with no damage.
         7:  For proper operation and for optimizing the ADC accuracy, AMCLK should be limited to the maximum frequency defined
             in Table 5-2, as a function of the BOOST and PGA setting chosen. MCLK can take larger values as long as the
             prescaler settings (PRE<1:0>) limit AMCLK = MCLK/PRESCALE within the defined range in Table 5-2.
1.2         Serial Interface Characteristics
TABLE 1-2:            SERIAL DC CHARACTERISTICS
 Electrical Specifications: Unless otherwise indicated, all parameters apply at DVDD = 2.7 to 3.6 V,
 TA = -40°C to +125°C (Note 1), CLOAD = 30 pF, applies to all digital I/O.
         Characteristic                 Sym.         Min.       Typ.        Max.           Units                Conditions
 High-Level Input Voltage                VIH       0.7 DVDD       —           —              V       Schmitt-Triggered
 Low-Level Input Voltage                 VIL           —          —      0.3 DVDD            V       Schmitt-Triggered
 Input Leakage Current                    ILI          —          —           ±1            µA       CS = DVDD,
                                                                                                     VIN = DGND to DVDD
 Output Leakage Current                  ILO           —          —           ±1            µA       CS = DVDD,
                                                                                                     VOUT = DGND or DVDD
 Hysteresis                             VHYS           —         300          —             mV       DVDD = 3.3V only (Note 3)
 of Schmitt-Triggered Inputs
 Low-Level Output Voltage                VOL           —          —          0.4V            V       IOL = +1.7 mA, DVDD = 3.3V
 High-Level Output Voltage               VOH      DVDD - 0.5      —           —              V       IOH = -1.7 mA, DVDD = 3.3V
 Internal Capacitance                    CINT          —          —            7            pF       TA = +25°C, SCK = 1.0 MHz,
 (All Inputs and Outputs)                                                                            DVDD = 3.3V (Note 2)
 Note 1:     All specifications are valid down to -45°C.
         2:  This parameter is periodically sampled and not 100% tested.
         3:  This parameter is established by characterization and not production tested.
DS20005287A-page 6                                                                                      2014 Microchip Technology Inc.


                                                                                             MCP3918
TABLE 1-3:         SERIAL AC CHARACTERISTICS
 Electrical Specifications: Unless otherwise indicated, all parameters apply at DVDD = 2.7 to 3.6 V,
 TA = -40°C to +125°C (Note 1), GAIN = 1, CLOAD = 30 pF.
        Characteristic              Sym        Min             Typ          Max           Units       Conditions
 Serial Clock Frequency             fSCK         —              —             20          MHz
 CS Setup Time                      tCSS         25             —             —            ns
 CS Hold Time                       tCSH         50             —             —            ns
 CS Disable Time                    tCSD         50             —             —            ns
 Data Setup Time                     tSU          5             —             —            ns
 Data Hold Time                      tHD         10             —             —            ns
 Serial Clock High Time               tHI        20             —             —            ns
 Serial Clock Low Time               tLO         20             —             —            ns
 Serial Clock Delay Time            tCLD         50             —             —            ns
 Serial Clock Enable Time           tCLE         50             —             —            ns
 Output Valid from SCK Low           tDO         —              —             25           ns
 Output Hold Time                    tHO          0             —             —            ns
 Output Disable Time                 tDIS        —              —             25           ns
 Reset Pulse Width (RESET)         tMCLR        100             —             —            ns
 Data Transfer Time to DR          tDODR         —              —             25           ns      Note 2
 (Data Ready)
 Modulator Mode Entry to          tMODSU         —              —            100           ns
 Modulator Data Present
 Data Ready Pulse Low Time          tDRP         —       1/(2 x DMCLK)        —            µs
 2-Wire Mode Enable Time           tMODE         —              —             50           ns
 2-Wire Mode                      tWATCH        3.5             —             35           µs
 Watchdog Timer
 Note 1:    All specifications are valid down to -45°C.
        2:  This parameter is established by characterization and not production tested.
TABLE 1-4:         TEMPERATURE SPECIFICATIONS
 Electrical Specifications: Unless otherwise indicated, all parameters apply at AVDD = 2.7 to 3.6V,
 DVDD = 2.7 to 3.6V.
              Parameters                   Sym.     Min.      Typ.     Max.         Units           Conditions
 Temperature Ranges
 Operating Temperature Range                 TA      -40       —       +125           °C     Note 1, Note 2
 Storage Temperature Range                   TA      -65       —       +150           °C
 Thermal Package Resistances
 Thermal Resistance, 20L 4x4 QFN            JA       —       46.2      —           °C/W
 Thermal Resistance, 20L SSOP               JA      —       87.3      —           °C/W
 Note 1:    The internal junction temperature (TJ) must not exceed the absolute maximum specification of +150°C.
        2:  All specifications are valid down to -45°C.
 2014 Microchip Technology Inc.                                                                 DS20005287A-page 7


MCP3918
   CS
                           fSCK                                                    tCSH
                       tHI      tLO
                                                                                               Mode 1,1
  SCK                                                                                          Mode 0,0
                               tDO                                                 tDIS
                                                               tHO
 SDO               MSB out                                                       LSB out
                                    DON’T CARE
   SDI
FIGURE 1-1:          Serial Output Timing Diagram.
                                                                                    tCSD
    CS                                                                                tCLE
                 tCSS                      fSCK
                                                                        tCSH         tCLD
                                       tHI     tLO
          Mode 1,1
    SCK   Mode 0,0
                   tSU      tHD
    SDI             MSB in                                         LSB in
                                          Hi-Z
    SDO
FIGURE 1-2:          Serial Input Timing Diagram.
                                                    1/fD                                   tDRP
        DR
                        tDODR
      SCK
     SDO
FIGURE 1-3:          Data Ready Pulse/Sampling Timing Diagram.
DS20005287A-page 8                                                          2014 Microchip Technology Inc.


                                                                        MCP3918
          Timing Waveform for tDO                   Waveform for tDIS
           SCK                                                 VIH
                                                    CS
                                 tDO
                                                                      90%
          SDO                                                  tDIS             Hi-Z
                                                   SDO
                                                                       10%
FIGURE 1-4:            Timing Diagrams, continued.
   AVDD, DVDD
                      SPI           2-Wire
                     Mode            Mode
        OSC2/
                     0
        MODE
   SCK/MCLK                          0
                     Hi-Z
          SDO
                                     0
                             tMODE
FIGURE 1-5:            Entering 2-Wire Interface
Mode Timing Diagram.
 2014 Microchip Technology Inc.                                           DS20005287A-page 9


MCP3918
NOTES:
DS20005287A-page 10  2014 Microchip Technology Inc.


                                                                                                                                                    MCP3918
2.0                           TYPICAL PERFORMANCE CURVES
           Note:               The graphs and tables provided following this note are a statistical summary based on a limited number of
                               samples and are provided for informational purposes only. The performance characteristics listed herein
                               are not tested or guaranteed. In some graphs or tables, the data presented may be outside the specified
                               operating range (e.g., outside specified power supply range) and therefore outside the warranted range.
Note: Unless otherwise indicated, AVDD = 3V, DVDD = 3V; TA = +25°C, MCLK = 4 MHz; PRESCALE = 1;
OSR = 256; GAIN = 1; Dithering = Maximum; VIN = -0.5 dBFS @ 60 Hz on all channels, VREFEXT = 0; CLKEXT = 1;
BOOST<1:0> = 10.
                     0                                                                                               0
                                                        Vin = -0.5 dBFS @ 60 Hz
                    -20                                                                                                                                 Vin = -60 dBFS @ 60 Hz
                                                        fD = 3.9 ksps                                              -20                                  fD = 3.9 ksps
                                                        OSR = 256
                    -40                                 Dithering = Off                                            -40                                  OSR = 256
  Amplitude (dB)                                                                          Am
                                                                                           mplitud
                                                                                                 de (dB))
                    -60                                 16 ksamples FFT                                                                                 Dithering = Maximum
                                                                                                                   -60                                  16 ksamples FFT
                    -80                                                                                            -80
                   -100                                                                                           -100
                   -120                                                                                           -120
                   -140
                    140                                                                                           -140
                   -160                                                                                           -160
                   -180                                                                                           -180
                          0          500        1000           1500               2000
                                                                                                                             0         500        1000         1500            2000
                                           Frequency (Hz)
                                                                                                                                             Frequency (Hz)
FIGURE 2-1:                                Spectral Response.                            FIGURE 2-4:                                         Spectral Response.
                     0                                                                                                1.0%
                                                       Vin = -60 dBFS @ 60 Hz
                     20
                    -20                                fD = 3.9 ksps                                                                                     % Error Channel 0,1
                                                                                          Measurement Error (%)
                                                       OSR = 256
                    -40                                Dithering = Off                                                0.5%
Amplitude (dB
            B)
                    -60                                16 ksamples FFT
                    -80
                                                                                                                      0.0%
                   -100
                   -120
                   -140                                                                                           -0.5%
                   -160
                   -180                                                                                           -1.0%
                          0         500         1000      1500               2000                                      0.01          0.1      1         10      100      1000
                                           Frequency (Hz)                                                                        Current Channel Input Amplitude (mVPeak)
FIGURE 2-2:                                Spectral Response.                            FIGURE 2-5:          Measurement Error
                                                                                         with 1-Point Calibration.
                                                                                                                      1.0%
                     0
                                                       Vin = -0.5 dBFS @ 60 Hz                                                                           % Error Channel 0,1
                                                                                              Measurement Error (%)
                    -20                                fD = 3.9 ksps
                    -40                                OSR = 256                                                      0.5%
                                                       Dithering = Maximum
  Amplitude (dB)
                    -60                                16 ksamples FFT
                    -80
                                                                                                                      0.0%
                   -100
                   -120
                   -140
                    140                                                                                               -0.5%
                   -160
                   -180
                          0         500         1000          1500           2000                                     -1.0%
                                           Frequency (Hz)                                                                  0.01       0.1      1        10      100     1000
                                                                                                                                  Current Channel Input Amplitude (mVPeak)
FIGURE 2-3:                                Spectral Response.                            FIGURE 2-6:          Measurement Error
                                                                                         with 2-Point Calibration.
 2014 Microchip Technology Inc.                                                                                                                        DS20005287A-page 11


MCP3918
Note: Unless otherwise indicated, AVDD = 3V, DVDD = 3V; TA = +25°C, MCLK = 4 MHz; PRESCALE = 1;
OSR = 256; GAIN = 1; Dithering = Maximum; VIN = -0.5 dBFS @ 60 Hz on all channels, VREFEXT = 0; CLKEXT = 1;
BOOST<1:0> = 10.
                                                                                                                                                  Standar deviation = 78 LSB
 F
 Freque
      ency off Occurrence
                        e                                                               Frequ
                                                                                            uency of Occurrence
                                                                                                                                                  Noise = 7.4ȝVrms
                                                                                                                                                  16 ksamples
                                                                                                                    448
                                                                                                                    481
                                                                                                                    514
                                                                                                                    548
                                                                                                                    581
                              -108.2     -107.8    -107.4  -107.0    -106.6    -106.2
                                                                                                                    614
                                                                                                                    647
                                                                                                                    680
                                                                                                                    714
                                                                                                                    747
                                                                                                                    780
                                                                                                                    813
                                                                                                                    846
                                                                                                                    880
                                                                                                                    913
                                                                                                                    946
                                          Total Harmonic Distortion (-dBc)
                                                                    ( dBc)
                                                                                                                    979
                                                                                                                  1,012
                                                                                                                  1,046
                                                                                                                  1,079
                                                                                                                  1,112
                                                                                                                                      Output Noise (LSB)
FIGURE 2-7:                                         THD Repeatability                   FIGURE 2-10:                                     Output Noise Histogram.
Histogram.
                                                                                                                     -90
                                                                                        Total Harmonic Distortion
                                                                                                                                                       Dithering=Maximum
                                                                                                                                                       Dithering=Medium
    Freq
       quency of Occurrence
                                                                                                                     -95
                                                                                                                                                       Dithering=Minimum
                                                                                                                    -100                               Dithering=Off
                                                                                                                    -105
                                                                                                                    -110
                                                                                                  (dBc)
                                                                                                                    -115
                                                                                                                    -120
                                                                                                                    -125
                                                                                                                    -130
                              111.7    112.3 112.9 113.5 114.1 114.7 115.3      115.9                                       32    64 128 256 512 1024 2048 4096
                                         Spurious Free Dynamic Range (dBFS)
                                                                                                                                    Oversampling Ratio (OSR)
FIGURE 2-8:        Spurious-Free Dynamic                                                FIGURE 2-11:                                     THD vs.OSR.
Range Repeatability Histogram.
                                                                                                                  110
 Frequency o
           of Occu
                 urrence
                       e
                                                                                                                  105
                                                                                          Signal-to-N
                                                                                                    Noise and
                                                                                                                  100
                                                                                                                   95
                                                                                                                   90
                                                                                                                   85
                                                                                                                   80
                                                                                          Disto
                                                                                              ortion R
                                                                                                     Ratio (d
                                                                                                            dB)
                                                                                                                   75                                      Dithering Maximu
                                                                                                                                                           Dithering=Maximu
                                                                                                                   70                                      m
                                                                                                                                                           Dithering=Medium
                                                                                                                   65
                                                                                                                   60
                               93.3       93.4      93.5     93.6     93.7      93.8                                       32    64     128 256 512 1024 2048 4096
                                         Signal to Noise and Distortion (dB)                                                          Oversampling Ratio (OSR)
FIGURE 2-9:                                          SINAD Repeatability                FIGURE 2-12:                                     SINAD vs. OSR.
Histogram.
DS20005287A-page 12                                                                                                                        2014 Microchip Technology Inc.


                                                                                                                                                                MCP3918
Note: Unless otherwise indicated, AVDD = 3V, DVDD = 3V; TA = +25°C, MCLK = 4 MHz; PRESCALE = 1;
OSR = 256; GAIN = 1; Dithering = Maximum; VIN = -0.5 dBFS @ 60 Hz on all channels, VREFEXT = 0; CLKEXT = 1;
BOOST<1:0> = 10.
                                110                                                                                             100
                                105                                                                                               95
                                                                                                      Sig
                                                                                                        gnal-to
                                                                                                              o-Noisee and
 Signal-to--Noise Ratio ((dB)
                                100
                                                                                                                                  90
                                 95
                                                                                                                                  85
                                                                                                          Disttortion
                                 90
                                 85                                                                                               80
                                 80
                                                                                                              (dB)
                                                                                                                                  75
                                 75                                          Dithering Maximum
                                                                             Dithering=Maximum
                                 70                                          Dithering=Medium                                     70
                                                                             Dithering=Minimum                                                                                   Boost = 00
                                 65                                          Dithering=Off                                        65                                             Boost = 01
                                 60                                                                                                                                              Boost = 10
                                                                                                                                  60
                                           32       64        128 256 512 1024 2048 4096                                                2      4       6  8    10 12 14         16        18
                                                             O
                                                             Oversampling
                                                                     li   Ratio
                                                                          R ti (OSR)                                                                   MCLK Frequency (MHz)
FIGURE 2-13:                                                   SNR vs.OSR.                            FIGURE 2-16:                                         SINAD vs. MCLK.
                                  120                                                                                           100
 Spurio
      ous Fre
            ee Dyn
                 namic
                                  115                                                                                           95
                                                                                                       Signal-to-Noise Rattio
                                  110                                                                                           90
                                  105                                                                                           85
                                  100                                                                                           80
     Range ((dBFS))
     R
                                      95
                                                                                                                (dB))
                                                                                    g
                                                                            Dithering=Maximum
                                                                                                                                75
                                      90                                    Dithering=Medium                                    70
                                                                            Dithering=Minimum                                                                                  Boost = 00
                                      85                                                                                                                                       Boost = 01
                                                                            Dithering=Off
                                                                            Dithering Off                                       65                                             Boost = 10
                                      80                                                                                                                                       Boost = 11
                                               32       64     128 256 512 1024 2048 4096                                       60
                                                                                                                                       2       4       6    8   10 12 14 16               18
                                                             Oversampling
                                                             O       li   Ratio
                                                                          R ti (OSR)
                                                                                                                                                           MCLK Frequency (MHz)
FIGURE 2-14:                                                   SFDR vs. OSR.                          FIGURE 2-17:                                         SNR vs. MCLK.
                                                                                                                                  120
                                  -60
                                                                                    Boost = 00
                                                                                                          Spurio
                                                                                                               ous Fre
                                                                                                                     ee Dynamic
                                  -65
 Tota
    al Harmonic Distortion
                                                                                    Boost = 01                                    110
                                                                                    Boost = 10
                                  -70                                               Boost = 11
                                  -75                                                                                             100
                                                                                                                  Range
                                  -80
                                  -85                                                                                             90
           (dB)
                                  -90
                                                                                                                                  80
                                                                                                                 (dBFFS)
                                  -95
                                                                                                                                                                              Boost = 00
                                  100
                                 -100                                                                                                                                         Boost = 01
                                                                                                                                  70                                          Boost = 10
                                 -105
                                                                                                                                                                              Boost = 11
                                 -110                                                                                             60
                                           2        4    6      8   10   12   14   16   18       20                                        2       4   6   8 10 12 14 16             18        20
                                                              MCLK Frequency (MHz)                                                                      MCLK Frequency (MHz)
FIGURE 2-15:                                                   THD vs. MCLK.                          FIGURE 2-18:                                         SFDR vs. MCLK.
 2014 Microchip Technology Inc.                                                                                                                                   DS20005287A-page 13


MCP3918
Note: Unless otherwise indicated, AVDD = 3V, DVDD = 3V; TA = +25°C, MCLK = 4 MHz; PRESCALE = 1;
OSR = 256; GAIN = 1; Dithering = Maximum; VIN = -0.5 dBFS @ 60 Hz on all channels, VREFEXT = 0; CLKEXT = 1;
BOOST<1:0> = 10.
                                    0                                                                                     140
                                                                                         Spurious-Free Dynamic Range
 Total Harmonic Distortion (dB)
                                                                          OSR = 32
                                   -20                                    OSR = 64                                        120
                                                                          OSR = 128
                                                                          OSR = 256
                                   -40                                    OSR = 512                                       100
                                                                          OSR = 1024
                                   -60                                    OSR = 2048                                       80
                                                                          OSR = 4096
                                                                                                    (dBFS)
                                   -80                                                                                     60                                        OSR = 32
                                                                                                                                                                     OSR = 64
                                                                                                                                                                     OSR = 128
                                  -100                                                                                     40                                        OSR = 256
                                                                                                                                                                     OSR = 512
                                  -120                                                                                     20                                        OSR = 1024
                                                                                                                                                                     OSR = 2048
                                                                                                                                                                     OSR = 4096
                                  -140                                                                                      0
                                         1         2        4       8     16      32                                                 1        2      4       8      16       32
                                                            Gain (V/V)                                                                               Gain (V/V)
FIGURE 2-19:                                              THD vs. GAIN.                 FIGURE 2-22:                                              SFDR vs. GAIN.
                                  120                                                                                      -20
                                                                                                                                                                      GAIN = 1x
                                                                                         Total Harmonic Distortion (dB)
 Signal-to-Noise and Distortion
                                                                                                                                                                      GAIN = 2x
                                  100                                                                                      -40                                        GAIN = 4x
                                                                                                                                                                      GAIN = 8x
                                    80                                                                                                                                GAIN = 16x
                                                                                                                           -60                                        GAIN = 32x
                                    60
                                             OSR = 32
           Ratio (dB)
                                             OSR = 64
                                                                                                                           -80
                                    40       OSR = 128
                                             OSR = 256
                                             OSR = 512                                                                    -100
                                    20       OSR = 1024
                                             OSR = 2048
                                             OSR = 4096
                                     0                                                                                    -120
                                         1         2        4       8     16      32                                         0.001       0.01     0.1     1     10     100       1000
                                                            Gain (V/V)                                                                     Input Signal Amplitude (mVPK)
FIGURE 2-20:                                              SINAD vs. GAIN.               FIGURE 2-23:                                              THD vs. Input Signal
                                                                                        Amplitude.
                                  120                                                                                      100
                                                                                         Signal-to-Noise and Distortion
 Signal-to-Noise Ratio (dB)
                                  100                                                                                       80
                                   80                                                                                       60
                                   60                                                                                       40
                                                                                                   Ratio (dB)
                                                                           OSR = 32                                                                                 GAIN = 1x
                                                                           OSR = 64
                                                                                                                            20                                      GAIN = 2x
                                   40                                      OSR = 128
                                                                           OSR = 256                                                                                GAIN = 4x
                                                                           OSR = 512                                                                                GAIN = 8x
                                   20                                      OSR = 1024                                        0                                      GAIN = 16x
                                                                           OSR = 2048                                                                               GAIN = 32x
                                                                           OSR = 4096
                                    0                                                                                      -20
                                         1        2         4       8     16      32                                         0.001       0.01    0.1     1      10    100        1000
                                                            Gain (V/V)                                                                     Input Signal Amplitude (mVPK)
FIGURE 2-21:                                              SNR vs. GAIN.                 FIGURE 2-24:                                              SINAD vs. Input Signal
                                                                                        Amplitude.
DS20005287A-page 14                                                                                                                                2014 Microchip Technology Inc.


                                                                                                                                                                        MCP3918
Note: Unless otherwise indicated, AVDD = 3V, DVDD = 3V; TA = +25°C, MCLK = 4 MHz; PRESCALE = 1;
OSR = 256; GAIN = 1; Dithering = Maximum; VIN = -0.5 dBFS @ 60 Hz on all channels, VREFEXT = 0; CLKEXT = 1;
BOOST<1:0> = 10.
                         100                                                                                                    0
                                                                                              Total Harmonic Distortion (dB)
                                                                                                                                              GAIN = 1x
 Signal-to-Noise Ratio (dB)
                              80                                                                                               -20            GAIN = 2x
                                                                                                                                              GAIN = 4x
                                                                                                                                              GAIN = 8x
                              60                                                                                               -40            GAIN = 16x
                                                                                                                                              GAIN = 32x
                              40                                                                                               -60
                                                                            GAIN = 1x
                              20                                            GAIN = 2x
                                                                            GAIN = 4x                                          -80
                                                                            GAIN = 8x
                               0                                            GAIN = 16x                                    -100
                                                                            GAIN = 32x
                              -20
                                                                                                                          -120
                                0.001         0.01    0.1      1      10     100     1000
                                                                                                                                     -50        -25        0       25    50      75   100   125
                                                 Input Signal Amplitude (mVPK)                                                                                  Temperature (°C)
FIGURE 2-25:                                            SNR vs. Input Signal                FIGURE 2-28:                                                        THD vs. Temperature.
Amplitude.
                                    140                                                                                        100
 Spurious-Free Dynamic Range                                                                 Signal-to-Noise and Distortion
                                                                                                                                90
                                    120
                                                                                                                                80
                                    100                                                                                         70
                                     80                                                                                         60
                                                                           GAIN = 1x                                            50
            (dBFS)
                                     60                                                                                                        GAIN = 1x
                                                                                                       Ratio (dB)
                                                                           GAIN = 2x                                            40
                                                                                                                                               GAIN = 2x
                                                                           GAIN = 4x
                                     40                                    GAIN = 8x
                                                                                                                                30             GAIN = 4x
                                                                           GAIN = 16x                                           20             GAIN = 8x
                                     20                                    GAIN = 32x                                                          GAIN = 16x
                                                                                                                                10
                                                                                                                                               GAIN = 32x
                                      0                                                                                             0
                                      0.001     0.01    0.1     1      10    100     1000                                               -50      -25        0      25    50      75   100   125
                                                 Input Signal Amplitude (mVPK)                                                                                  Temperature (°C)
FIGURE 2-26:                                            SFDR vs. Input Signal               FIGURE 2-29:                                                        SINAD vs. Temperature.
Amplitude.
                               120                                          OSR = 32
                                                                                                                      100
   Signal-to-Noise and Distortion
                                                                            OSR = 64                                           90
                               100                                          OSR = 128
                                                                                              Signal-to-Noise Ratio (dB)
                                                                            OSR = 256                                          80
                                                                            OSR = 512                                          70
                                    80                                      OSR = 1024
                                                                            OSR = 2048                                         60
                                                                            OSR = 4096
                                    60                                                                                         50
                                                                                                                                           GAIN = 1x
             Ratio (dB)
                                                                                                                               40          GAIN = 2x
                                    40
                                                                                                                               30          GAIN = 4x
                                                                                                                               20          GAIN = 8x
                                    20                                                                                                     GAIN = 16x
                                                                                                                               10          GAIN = 32x
                                     0                                                                                         0
                                         10        100       1000      10000       100000                                           -50        -25      0         25    50     75     100   125
                                                     Signal Frequency (Hz)                                                                                      Temperature (°C)
FIGURE 2-27:                                            SINAD vs. Input Frequency.          FIGURE 2-30:                                                        SNR vs. Temperature.
 2014 Microchip Technology Inc.                                                                                                                                           DS20005287A-page 15


MCP3918
Note: Unless otherwise indicated, AVDD = 3V, DVDD = 3V; TA = +25°C, MCLK = 4 MHz; PRESCALE = 1;
OSR = 256; GAIN = 1; Dithering = Maximum; VIN = -0.5 dBFS @ 60 Hz on all channels, VREFEXT = 0; CLKEXT = 1;
BOOST<1:0> = 10.
                      120                                                                                                                   1.2
                                                                                                         Internal Voltage Reference (V)
 Spurious-Free Dynamic Range
                      100
                               80                                                                                                         1.199
                               60
                                           GAIN = 1x
            (dBFS)
                                           GAIN = 2x                                                                                      1.198
                               40
                                           GAIN = 4x
                                           GAIN = 8x
                               20
                                           GAIN = 16x
                                           GAIN = 32x
                                0                                                                                                         1.197
                                    -50         -25           0      25    50      75     100     125                                             -40   -20     0   20 40 60 80            100 120 140
                                                                  Temperature (°C)                                                                                  Temperature (°C)
FIGURE 2-31:                                                      SFDR vs. Temperature.                 FIGURE 2-34:                                                 Internal Voltage Reference
                                                                                                        vs. Temperature.
                  1000                                                                                                                     1.1969
                                                                                        GAIN = 1x
                                                                                                         Internal Voltage Reference (V)
                    800                                                                 GAIN = 2x                                          1.1968
                    600                                                                 GAIN = 4x
                                                                                        GAIN = 8x                                          1.1967
                    400
 Offset (µV)
                                                                                        GAIN = 16x                                         1.1966
                    200                                                                 GAIN = 32x
                                0                                                                                                          1.1965
                  -200                                                                                                                     1.1964
                  -400                                                                                                                     1.1963
                  -600
                                                                                                                                           1.1962
                  -800
          -1000                                                                                                                            1.1961
                                    -40     -20           0       20  40    60     80   100     120                                                 2.5 2.6 2.7 2.8 2.9 3 3.1 3.2 3.3 3.4 3.5 3.6
                                                                  Temperature (°C)                                                                                     AVDD (V)
FIGURE 2-32:                                                      Offset vs. Temperature vs.            FIGURE 2-35:        Internal Voltage Reference
Gain.                                                                                                   vs. Supply Voltage.
                                                                                                                                            10
                   9                                                                    GAIN = 1x
                                                                                                          Integral Non-Linearity Error
                                                                                        GAIN = 2x                                            8
                   7                                                                    GAIN = 4x                                            6
                                                                                        GAIN = 8x
                                                                                                                                             4
 Gain Error (%)
                   5                                                                    GAIN = 16x
                                                                                        GAIN = 32x                                           2
                   3                                                                                                                         0
                                                                                                                     (ppm)
                   1                                                                                                                        -2
                                                                                                                                            -4
                  -1
                                                                                                                                            -6
                  -3                                                                                                                        -8
                  -5                                                                                                                       -10
                               -40        -20         0       20  40    60     80       100     120                                           -0.6       -0.4       -0.2     0.0     0.2     0.4   0.6
                                                              Temperature (°C)                                                                                        Input Voltage (V)
FIGURE 2-33:                                                      Gain Error vs. Temperature            FIGURE 2-36:      Integral Non-Linearity
vs. Gain.                                                                                               (Dithering Maximum).
DS20005287A-page 16                                                                                                                                                    2014 Microchip Technology Inc.


                                                                                                      MCP3918
Note: Unless otherwise indicated, AVDD = 3V, DVDD = 3V; TA = +25°C, MCLK = 4 MHz; PRESCALE = 1;
OSR = 256; GAIN = 1; Dithering = Maximum; VIN = -0.5 dBFS @ 60 Hz on all channels, VREFEXT = 0; CLKEXT = 1;
BOOST<1:0> = 10.
                                10
                                8
 Integral Non-Linearity Error
                                6
                                4
                                2
                                0
            (ppm)
                                -2
                                -4
                                -6
                                -8
                         -10
                            -0.6                -0.4      -0.2    0.0     0.2            0.4    0.6
                                                           Input Voltage (V)
FIGURE 2-37:                                               Integral Non-Linearity
(Dithering Off).
                      3
                   2.75
                    2.5
                                         AIDD Boost = 2
                   2.25
                      2
  IDD (mA)
                   1.75
                    1.5                                      AIDD Boost = 1
                   1.25
                                                              AIDD Boost = 0.66
                      1
                   0.75
                    0.5                   AIDD Boost = 0.5
                   0.25                                                           DIDD
                      0
                                     2      4      6     8   10 12 14 16                 18    20
                                                       MCLK Frequency (MHz)
FIGURE 2-38:       Operating Current vs. MCLK
Frequency vs. Boost, VDD = 3.0V.
 2014 Microchip Technology Inc.                                                                      DS20005287A-page 17


MCP3918
NOTES:
DS20005287A-page 18  2014 Microchip Technology Inc.


                                                                                                    MCP3918
3.0       PIN DESCRIPTION
The descriptions of the pins are listed in Table 3-1.
TABLE 3-1:          SIX-CHANNEL MCP3918 PIN FUNCTION TABLE
  MCP3918      MCP3918
                                   Symbol                                          Function
    SSOP           QFN
       1            18           RESET/OSR0        Master Reset Logic Input Pin or OSR0 Logic Input Pin
       2            19               DVDD          Digital Power Supply Pin
       3            20               AVDD          Analog Power Supply Pin
       4             1               CH0+          Non-Inverting Analog Input Pin for Channel 0
       5             2               CH0-          Inverting Analog Input Pin for Channel 0
       6             3                NC           Not connected
       7             4                NC           Not connected
       8             5               AGND          Analog Ground Pin, Return Path for internal analog circuitry
       9             6           REFIN+/OUT         Non-Inverting Voltage Reference Input and Internal Reference
                                                   Output Pin
      10             7              REFIN-         Inverting Voltage Reference Input Pin
      11             8               DGND          Digital Ground Pin, Return Path for internal digital circuitry
      12             9                NC           Not connected
      13            10              MDAT0          Modulator Data Output Pin for Channel 0
      14            11            DR/GAIN1          Data Ready Signal Output Pin or GAIN1 Logic Input Pin
      15            12        OSC1/CLKI/GAIN0      Oscillator Crystal Connection Pin or External Clock Input Pin or
                                                   GAIN0 Logic Input Pin
      16            13           OSC2/MODE         Oscillator Crystal Connection Input Pin or Serial Interface Mode
                                                   Logic Input Pin
      17            14            CS/BOOST         Serial Interface Chip Select Input Pin or BOOST Logic Input Pin
      18            15            SCK/MCLK         Serial Interface Clock Pin or Master Clock Input Pin
      19            16               SDO           Serial Interface Data Input Pin
      20            17            SDI/OSR1         Serial Interface Data Input Pin or OSR1 Logic Input Pin
      —             21                EP           Exposed Thermal Pad
3.1       Master Reset/OSR0 Logic Input                           If MCLK is applied when RESET is logic low, all the
          (RESET/OSR0)                                            analog biases are enabled during a reset, so that the
                                                                  part is fully operational just after a RESET rising edge.
In SPI mode, this pin is active low and places the entire         If MCLK is not applied, there is a time after a hard reset
chip in a Reset state when active.                                when the conversion may not accurately correspond to
When RESET is logic low, all registers are reset to their         the start-up of the input structure.
default value, no communication can take place, and               This input is Schmitt-triggered.
no clock is distributed inside the part, except in the
                                                                  In 2-Wire Interface mode, this is the OSR0 logic select
input structure if MCLK is applied (if MCLK is idle, then
                                                                  pin (see Section 7.0 “2-Wire Serial Interface
no clock is distributed). This state is equivalent to a
                                                                  Description” for the logic input table for OSR0 and
Power-On Reset (POR) state.
                                                                  OSR1). The pin state is latched when the MODE
Since the default state of the ADC is on, the analog              changes to 2-Wire Interface mode, and is relatched at
power consumption when RESET is logic low is                      each watchdog timer reset.
equivalent to when RESET is logic high. Only the digital
power consumption is largely reduced because this
current consumption is essentially dynamic and is
reduced drastically when there is no clock running.
 2014 Microchip Technology Inc.                                                                       DS20005287A-page 19


MCP3918
3.2       Digital VDD (DVDD)                               3.6        Non-Inverting Reference Input,
DVDD is the power supply voltage for the digital circuitry
                                                                      Internal Reference Output
within the MCP3918. For optimal performance, it is                    (REFIN+/OUT)
recommended to connect appropriate bypass                  This pin is the non-inverting side of the differential
capacitors (typically a 10 µF in parallel with a 0.1 µF    voltage reference input for the ADC or the internal
ceramic). DVDD should be maintained between 2.7V           voltage reference output.
and 3.6V for specified operation.
                                                           When VREFEXT = 1, an external voltage reference
                                                           source can be used, and the internal voltage reference
3.3       Analog Power Supply (AVDD)
                                                           is disabled. When using an external differential voltage
AVDD is the power supply voltage for the analog            reference, it should be connected to its VREF+ pin.
circuitry within the MCP3918. It is recommended to         When using an external single-ended reference, it
connect appropriate bypass capacitors (typically a         should be connected to this pin.
10 µF in parallel with a 0.1 µF ceramic). AVDD should      When VREFEXT = 0, the internal voltage reference is
be maintained between 2.7V and 3.6V for specified          enabled and connected to this pin through a switch.
operation.                                                 This voltage reference has minimal drive capability and
                                                           thus needs proper buffering and bypass capacitances
3.4       ADC Differential Analog Inputs                   (a 0.1 µF ceramic capacitor is sufficient in most cases),
          (CH0+/CH0-)                                      if used as a voltage source.
The CH0+/- pins are the fully differential analog voltage  If the voltage reference is only used as an internal
inputs for the delta-sigma ADC.                            VREF, adding bypass capacitance on REFIN+/OUT is
                                                           not necessary for keeping ADC accuracy, but a minimal
The linear and specified region of the channels is         0.1 µF ceramic capacitance can be connected to avoid
dependent on the PGA gain. This region corresponds         EMI/EMC susceptibility issues due to the antenna
to a differential voltage range of ±600 mV/GAIN with       created by the REFIN+/OUT pin if left floating.
VREF = 1.2V.
The maximum absolute voltage, with respect to AGND,        3.7        Inverting Reference Input (REFIN-)
for each CH0+/- input pin is ±1V with no distortion and
±2V with no breaking after continuous voltage. This        This pin is the inverting side of the differential voltage
maximum absolute voltage is not proportional to the        reference input for the ADC. When using an external
VREF voltage.                                              differential voltage reference, it should be connected to
                                                           its VREF- pin. When using an external single-ended
3.5       Analog Ground (AGND)                             voltage reference, or when VREFEXT = 0 (default) and
                                                           using the internal voltage reference, the pin should be
AGND is the ground reference voltage for the analog        directly connected to AGND.
circuitry within the MCP3918. For optimal performance,
it is recommended to connect it to the same ground
                                                           3.8        Digital Ground Connection (DGND)
node voltage as DGND, preferably with a star
connection.                                                DGND is the ground reference voltage for the digital
If an analog ground plane is available, it is              circuitry within the MCP3918. For optimal performance,
recommended that these pins be tied to this plane of       it is recommended to connect it to the same ground
the Printed Circuit Board (PCB). This plane should also    node voltage as AGND, preferably with a star
reference all other analog circuitry in the system.        connection.
                                                           If a digital ground plane is available, it is recommended
                                                           that this pin be tied to this plane of the PCB. This plane
                                                           should also reference all other digital circuitry in the
                                                           system.
DS20005287A-page 20                                                                    2014 Microchip Technology Inc.


                                                                                        MCP3918
3.9       Modulator Output                               3.11     Crystal Oscillator/Master Clock
          (MDAT0)                                                 Input/GAIN0 Logic Input
MDAT0 is the output pin for the modulator serial bit
                                                                  (OSC1/CLKI/GAIN0)
streams of the ADC. This pin is high-impedance when      In SPI mode, OSC1/CLKI and OSC2 provide the
the EN_MDAT bit is logic low. When the EN_MDAT bit       master clock for the device. When CLKEXT = 0, a
is enabled, the modulator bit stream of the ADC is       resonant crystal or clock source with a similar
present on the pin and updated at the AMCLK              sinusoidal waveform must be placed across the OSC1
frequency (see Section 5.3.5 “Modulator Output           and OSC2 pins to ensure proper operation.
Block” for a complete description of the modulator
                                                         The typical clock frequency specified is 4 MHz. For
output). This pin can be directly connected to an MCU
                                                         proper operation and in order to optimize ADC
or a DSP when a specific digital filtering is needed.
                                                         accuracy, AMCLK should be limited to the maximum
When the MDAT0 output pin is enabled, the DR output
                                                         frequency defined in Table 5-2 for the function of the
is disabled. In 2-Wire Interface mode, this pin is
                                                         BOOST and PGA setting chosen. MCLK can take
automatically inactive. Its state is high-impedance
                                                         larger values as long as the prescaler settings
during the 2-Wire mode (therefore this pin can be left
                                                         (PRE<1:0>) limit AMCLK = MCLK/PRESCALE in the
grounded in applications using exclusively the 2-Wire
                                                         defined range in Table 5-2. Appropriate load
Interface mode; this configuration improves the
                                                         capacitance should be connected to these pins for
EMI/EMC susceptibility of the device).
                                                         proper operation.
3.10      Data Ready Output/GAIN1 Logic                  In 2-Wire Interface mode, this is the GAIN0 logic select
                                                         pin. See Section 7.0 “2-Wire Serial Interface
          Input (DR/GAIN1)
                                                         Description” for the logic input table for GAIN0 and
In SPI mode, the Data Ready pin indicates if a new       GAIN1. The pin state is latched when the MODE
conversion result is ready to be read. The default state changes to 2-Wire Interface mode, and is relatched at
of this pin is logic high when DR_HIZ = 1 and is         each watchdog timer reset.
high-impedance when DR_HIZ = 0 (default). After
each conversion is finished, a logic low pulse will take    Note:    When CLKEXT = 1, the crystal oscillator
place on the Data Ready pin to indicate the conversion               is disabled. OSC1 becomes the master
result is ready as an interrupt. This pulse is                       clock input CLKI, a direct path for an
synchronous with the master clock and has a defined                  external clock source. One example
and constant width.                                                  would be a clock source generated by an
The Data Ready pin is independent from the SPI                       MCU.
interface and acts like an interrupt output. The Data
Ready pin state is not latched, and the pulse width (and 3.12     Crystal Oscillator Output/
period) are both determined by the MCLK frequency,                Interface MODE Logic Input
oversampling rate, and internal clock prescale settings.          (OSC2/MODE)
The Data Ready pulse width is equal to half a DMCLK
period and the frequency of the pulses is equal to       When CLKEXT = 0 (default), a resonant crystal or
DRCLK (see Figure 1-3).                                  clock source with a similar sinusoidal waveform must
                                                         be placed across the OSC1 and OSC2 pins to ensure
In 2-Wire Interface mode, this is the GAIN1 logic select proper operation. Appropriate load capacitance should
pin. See Section 7.0 “2-Wire Serial Interface            be connected to these pins for proper operation.
Description” for the logic input table for GAIN0 and
GAIN1. The pin state is latched when the MODE            When CLKEXT = 1 (default condition at POR), this pin
changes to 2-Wire Interface mode, and is relatched at    is the MODE selection pin for the digital interface.
each watchdog timer reset.                               When MODE is logic low, the SPI interface is selected
                                                         (see Section 6.0 “SPI Serial Interface Description”).
                                                         When MODE is logic high, the 2-Wire interface is
   Note:    This pin should not be left floating when
                                                         selected (see Section 7.0 “2-Wire Serial Interface
            the DR_HIZ bit is low; a 100 k pull-up
                                                         Description”). The MODE input is latched after a
            resistor    connected      to   DVDD      is
                                                         POR, a Master Reset and/or a Watchdog Timer Reset.
            recommended.
 2014 Microchip Technology Inc.                                                            DS20005287A-page 21


MCP3918
3.13       Chip Select/ Boost Logic Input                  3.16      Serial Data/OSR1 Logic Input
           (CS/BOOST)                                                (SDI/OSR1)
In SPI mode, this pin is the SPI chip select that enables  In SPI mode, this is the SPI data input pin. Data is
serial communication. When this pin is logic high, no      clocked into the device on the rising edge of SCK.
communication can take place. A chip select falling        When CS is logic low, this pin is used to communicate
edge initiates serial communication, and a chip select     with 8-bit commands followed by data bytes that can be
rising edge terminates the communication. No               16-/24- or 32-bit wide. The interface is half-duplex
communication can take place even when CS is logic         (inputs and outputs do not happen at the same time).
low, if RESET is also logic low.                           Each communication starts with a chip select falling
This input is Schmitt-triggered.                           edge followed by an 8-bit command word, entered
In the 2-Wire Interface mode, this is the Boost logic      through the SDI pin. Each command is either a Read or
select pin. See Section 7.0 “2-Wire Serial Interface       a Write command. Toggling SDI during a Read
Description” for the logic input table for Boost. The pin  command has no effect.
state is latched when the mode changes to 2-Wire           This input is Schmitt-triggered.
Interface mode, and is re-latched at each watchdog         In 2-Wire Interface mode, this is the OSR1 logic select
timer reset.                                               pin. See Section 7.0 “2-Wire Serial Interface
                                                           Description” for the logic input table for OSR0 and
3.14       Serial Data Clock/                              OSR1. The pin state is latched when the mode
           Master Clock Input (SCK/MCLK)                   changes to 2-Wire Interface Mode, and is relatched at
                                                           each watchdog timer reset.
In SPI mode, this is the serial clock pin for SPI
communication. Data is clocked into the device on the
rising edge of SCK. Data is clocked out of the device on
                                                           3.17      Exposed Pad (EP)
the falling edge of SCK.                                   Exposed Thermal Pad. This pin must be connected to
The MCP3918 SPI interface is compatible with SPI 0,0       AGND for optimal accuracy and thermal performance.
and 1,1 modes. SPI modes can be changed during a           This pad can also be left floating if necessary.
CS high time.                                              Connecting it to AGND is preferable for the lowest noise
                                                           performance and best thermal behavior.
The maximum clock speed specified is 20 MHz. SCK
and MCLK are two different and asynchronous clocks;
SCK is only required when a communication happens,
while MCLK is continuously required when the part is
converting analog inputs.
This input is Schmitt-triggered.
In the 2-Wire Interface mode, this pin is defining the
master clock of the device (MCLK) and the serial clock
(SCK) for the interface simultaneously. In this mode,
the clock has to be provided continuously to ensure
proper operation. See Section 7.0 “2-Wire Serial
Interface Description” for more information and
timing diagrams of the 2-Wire interface protocol.
3.15       Serial Data Output (SDO)
This is the SPI data output pin. Data is clocked out of
the device on the falling edge of SCK.
This pin remains in a high-impedance state during the
command byte. It also stays high-impedance during the
entire communication for Write commands and when
the CS pin is logic high or when the RESET pin is logic
low. This pin is active only when a Read command is
processed. The interface is half-duplex (inputs and
outputs do not happen at the same time).
In the 2-Wire Interface Mode, this pin is the only digital
output pin, and sends synchronous frames at each
data ready with data bits clocked out on the falling edge
of SCK.
DS20005287A-page 22                                                                   2014 Microchip Technology Inc.


                                                                                                                                                        MCP3918
4.0       TERMINOLOGY AND                                                                        4.1           MCLK – Master Clock
          FORMULAS                                                                               This is the fastest clock present on the device. This is
This section defines the terms and formulas used                                                 the frequency of the crystal placed at the OSC1/OSC2
throughout this data sheet. The following terms are                                              inputs when CLKEXT = 0 or the frequency of the clock
defined:                                                                                         input at the OSC1/CLKI when CLKEXT = 1. In the 2-
                                                                                                 Wire mode, this is the frequency present at the SCK
•  MCLK – Master Clock                                                                           input pin. See Figure 4-1.
•  AMCLK – Analog Master Clock
•  DMCLK – Digital Master Clock                                                                  4.2           AMCLK – Analog Master Clock
•  DRCLK – Data Rate Clock
                                                                                                 AMCLK is the clock frequency that is present on the
•  OSR – Oversampling Ratio                                                                      analog portion of the device, after prescaling has
•  Offset Error                                                                                  occurred via the PRE<1:0> bits in the CONFIG0
•  Gain Error                                                                                    register (see Equation 4-1). The analog portion
•  Integral Non-Linearity Error                                                                  includes the PGA and one delta-sigma modulator.
•  Signal-to-Noise Ratio (SNR)                                                                   EQUATION 4-1:
•  Signal-to-Noise and Distortion Ratio (SINAD)                                                                                                         MCLK
                                                                                                                      AMCLK = -------------------------------
•  Total Harmonic Distortion (THD)                                                                                                               PRESCALE
•  Spurious-Free Dynamic Range (SFDR)
                                                                                                 TABLE 4-1:                   MCP3918 OVERSAMPLING
•  MCP3918 Delta-Sigma Architecture
                                                                                                                              RATIO SETTINGS
•  Idle Tones
                                                                                                      CONFIG0                              Analog Master Clock
•  Dithering
•  PSRR                                                                                               PRE<1:0>                                            Prescale
•  CMRR                                                                                               0          0                 AMCLK = MCLK/1 (default)
•  ADC Reset Mode                                                                                     0          1                               AMCLK = MCLK/2
•  Hard Reset Mode (RESET = 0)
                                                                                                      1          0                               AMCLK = MCLK/4
•  ADC Shutdown Mode
                                                                                                      1          1                               AMCLK = MCLK/8
•  Full Shutdown Mode
                                          MODE
  SCK                                                                             CLKEXT            PRE<1:0>                                                      OSR<2:0>
                                       1
                                                      OUT
                                       0
                                                                                 1
                                       Multiplexer                                           MCLK               AMCLK                               DMCLK                                     DRCLK
                                                                                        OUT          1/PRESCALE                   1/4                                  1/OSR
  OSC1                                                                           0
  OSC2
           Xtal Oscillator                                                       Multiplexer      Clock Divider            Clock Divider                   Clock Divider
FIGURE 4-1:                Clock Sub-Circuitry.
4.3       DMCLK – Digital Master Clock                                                           4.4           DRCLK – Data Rate Clock
This is the clock frequency that is present on the digital                                       This is the output data rate, i.e. the rate at which the
portion of the device, after prescaling and division by                                          ADC outputs new data. Each new data is signaled by a
four (Equation 4-2). This is also the sampling                                                   Data Ready pulse on the Data Ready pin.
frequency, which is the rate at which the modulator                                              This data rate is dependent on the OSR and the
outputs are refreshed. Each period of this clock                                                 prescaler with the formula in Equation 4-3.
corresponds to one sample and one modulator output.
See Figure 4-1.                                                                                  EQUATION 4-3:
EQUATION 4-2:                                                                                                   DMCLK              AMCLK                                        MCLK
                                                                                                  DRCLK = ---------------------- = --------------------- = -----------------------------------------------------------
                                                                                                                 OSR               4  OSR                 4  OSR  PRESCALE
                       AMCLK                        MCLK
        DMCLK = --------------------- = ----------------------------------------
                           4            4  PRESCALE
 2014 Microchip Technology Inc.                                                                                                                           DS20005287A-page 23


MCP3918
Since this is the output data rate, and because the            Table 4-2 describes the various combinations of OSR
decimation filter is a sinc (or notch) filter, there is a      and PRESCALE, and their associated AMCLK,
notch in the filter transfer function at each integer          DMCLK and DRCLK rates.
multiple of this rate.
TABLE 4-2:          DEVICE DATA RATES IN FUNCTION OF MCLK, OSR AND PRESCALE,
                    MCLK = 4 MHZ
                                                                                                            ENOB
                                                                                                  SINAD      from
                                                                                      DRCLK
 PRE<1:0>         OSR<2:0>         OSR       AMCLK        DMCLK         DRCLK                      (dB)     SINAD
                                                                                       (ksps)
                                                                                                  Note 1     (bits)
                                                                                                            Note 1
  1      1       1     1    1      4096      MCLK/8       MCLK/32    MCLK/131072        0.035     102.5       16.7
  1      1       1     1    0      2048      MCLK/8       MCLK/32    MCLK/65536         0.061       100       16.3
  1      1       1     0    1      1024      MCLK/8       MCLK/32    MCLK/32768         0.122       97        15.8
  1      1       1     0    0       512      MCLK/8       MCLK/32    MCLK/16384         0.244       96        15.6
  1      1       0     1    1       256      MCLK/8       MCLK/32     MCLK/8192         0.488       95        15.5
  1      1       0     1    0       128      MCLK/8       MCLK/32     MCLK/4096         0.976       90        14.7
  1      1       0     0    1        64      MCLK/8       MCLK/32     MCLK/2048         1.95        83        13.5
  1      1       0     0    0        32      MCLK/8       MCLK/32     MCLK/1024           3.9       70        11.3
  1      0       1     1    1      4096      MCLK/4       MCLK/16    MCLK/65536         0.061     102.5       16.7
  1      0       1     1    0      2048      MCLK/4       MCLK/16    MCLK/32768         0.122       100       16.3
  1      0       1     0    1      1024      MCLK/4       MCLK/16    MCLK/16384         0.244       97        15.8
  1      0       1     0    0       512      MCLK/4       MCLK/16     MCLK/8192         0.488       96        15.6
  1      0       0     1    1       256      MCLK/4       MCLK/16     MCLK/4096         0.976       95        15.5
  1      0       0     1    0       128      MCLK/4       MCLK/16     MCLK/2048          1.95       90        14.7
  1      0       0     0    1        64      MCLK/4       MCLK/16     MCLK/1024           3.9       83        13.5
  1      0       0     0    0        32      MCLK/4       MCLK/16      MCLK/512       7.8125        70        11.3
  0      1       1     1    1      4096      MCLK/2       MCLK/8     MCLK/32768         0.122     102.5       16.7
  0      1       1     1    0      2048      MCLK/2       MCLK/8     MCLK/16384         0.244       100       16.3
  0      1       1     0    1      1024      MCLK/2       MCLK/8      MCLK/8192         0.488       97        15.8
  0      1       1     0    0       512      MCLK/2       MCLK/8      MCLK/4096         0.976       96        15.6
  0      1       0     1    1       256      MCLK/2       MCLK/8      MCLK/2048          1.95       95        15.5
  0      1       0     1    0       128      MCLK/2       MCLK/8      MCLK/1024           3.9       90        14.7
  0      1       0     0    1        64      MCLK/2       MCLK/8       MCLK/512       7.8125        83        13.5
  0      1       0     0    0        32      MCLK/2       MCLK/8       MCLK/256       15.625        70        11.3
  0      0       1     1    1      4096        MCLK       MCLK/4     MCLK/16384         0.244     102.5       16.7
  0      0       1     1    0      2048        MCLK       MCLK/4      MCLK/8192         0.488       100       16.3
  0      0       1     0    1      1024        MCLK       MCLK/4      MCLK/4096         0.976       97        15.8
  0      0       1     0    0       512        MCLK       MCLK/4      MCLK/2048          1.95       96        15.6
  0      0       0     1    1       256        MCLK       MCLK/4      MCLK/1024           3.9       95        15.5
  0      0       0     1    0       128        MCLK       MCLK/4       MCLK/512       7.8125        90        14.7
  0      0       0     0    1        64        MCLK       MCLK/4       MCLK/256       15.625        83        13.5
  0      0       0     0    0        32        MCLK       MCLK/4       MCLK/128         31.25       70        11.3
   Note 1: For OSR = 32 and 64, DITHER = None. For OSR = 128 and higher, DITHER = Maximum. The SINAD
              values are given for GAIN = 1.
DS20005287A-page 24                                                                    2014 Microchip Technology Inc.


                                                                                                    MCP3918
4.5        OSR – Oversampling Ratio                       4.8       Integral Non-Linearity Error
This is the ratio of the sampling frequency to the output Integral non-linearity error is the maximum deviation of
data rate: OSR = DMCLK/DRCLK. The default OSR is          an ADC transition point from the corresponding point of
256,      with      MCLK = 4 MHz,       PRESCALE = 1,     an ideal transfer function, with the offset and gain
AMCLK = 4 MHz, fS = 1 MHz, and fD = 3.90625 ksps.         errors removed, or with the end points equal to zero.
The bits in Table 4-3, available in the CONFIG0           It is the maximum remaining error after calibration of
register, are used to change the oversampling ratio       offset and gain errors for a DC input signal.
(OSR).
TABLE 4-3:           MCP3918 OVERSAMPLING                 4.9       Signal-to-Noise Ratio (SNR)
                     RATIO SETTINGS                       For the MCP3918 ADC, the signal-to-noise ratio is a
          CONFIG0                                         ratio of the output fundamental signal power to noise
                                Oversampling Ratio
                                                          power (not including the harmonics of the signal), when
          OSR<2:0>                      (OSR)
                                                          the input is a sine wave at a predetermined frequency
 0         0          0                    32             (see Equation 4-4). It is measured in dB. Usually, only
                                                          the maximum signal-to-noise ratio is specified. The
 0         0          1                    64
                                                          SNR figure depends mainly on the OSR and DITHER
 0         1          0                   128             settings of the device.
 0         1          1              256 (Default)
 1         0          0                   512             EQUATION 4-4:            SIGNAL-TO-NOISE RATIO
 1         0          1                  1024
                                                                     SNR  dB  = 10 log  ----------------------------------
                                                                                                    SignalPower
 1         1          0                  2048                                                        NoisePower
 1         1          1                  4096
4.6        Offset Error                                   4.10      Signal-to-Noise and Distortion
                                                                    Ratio (SINAD)
This is the error induced by the ADC when the inputs
are shorted together (VIN = 0V). The specification        The most important figure of merit for the analog
incorporates both PGA and ADC offset contributions.       performance of the ADC present on the MCP3918 is
This error varies with PGA and OSR settings. The          the     Signal-to-Noise        and                  Distortion                          (SINAD)
offset is different on each channel and varies from chip  specification.
to chip. The offset is specified in µV. The offset error  The Signal-to-Noise and Distortion ratio is similar to
can be digitally compensated independently on each        signal-to-noise ratio, with the exception that you must
channel through the OFFCAL_CH0 register with a            include the harmonics power in the noise power
24-bit calibration word.                                  calculation     (see    Equation 4-5).                               The                  SINAD
The offset on the MCP3918 has a low temperature           specification depends mainly on the OSR and DITHER
coefficient.                                              settings.
4.7        Gain Error                                     EQUATION 4-5:            SINAD EQUATION
This is the error induced by the ADC on the slope of the
                                                              SINAD  dB  = 10 log  ---------------------------------------------------------------------
                                                                                                       SignalPower
transfer function. It is the deviation expressed in %,                               Noise + HarmonicsPower
compared to the ideal transfer function defined in
Equation 5-3. The specification incorporates both PGA
                                                          The calculated combination of SNR and THD per the
and ADC gain error contributions, but not the VREF
                                                          following formula also yields SINAD (see Equation 4-
contribution (it is measured with an external VREF).
                                                          6).
This error varies with PGA and OSR settings. The gain
error can be digitally compensated independently on       EQUATION 4-6:            SINAD, THD AND SNR
each channel through the GAINCAL_CH0 register with
                                                                                   RELATIONSHIP
a 24-bit calibration word.
                                                                                                       SNR      -              –   THD
The gain error on the MCP3918 has a low temperature                                                    ----------
                                                                                                           10                    ---------------
                                                                                                                                        10 
                                                                                                                                                 -
coefficient.                                                      SINAD  dB  = 10 log 10                           + 10
 2014 Microchip Technology Inc.                                                                               DS20005287A-page 25


MCP3918
4.11       Total Harmonic Distortion (THD)                                             Multi-bit quantizers help lower the quantization error
                                                                                       (the error fed back in the loop can be very large with
The total harmonic distortion is the ratio of the output                               1-bit quantizers) without changing the order of the
harmonics power to the fundamental signal power for a                                  modulator or the OSR, which leads to better SNR
sine wave input, and is defined in Equation 4-7.                                       figures. However, typically, the linearity of such
                                                                                       architectures is more difficult to achieve since the DAC
EQUATION 4-7:                                                                          linearity is as difficult to attain, and its linearity limits the
                                                                                       THD of such ADC.
        THD  dB  = 10 log  -----------------------------------------------------
                                 HarmonicsPower
                             FundamentalPower                                        The 5-level quantizer present in MCP3918 is a Flash
                                                                                       ADC composed of four comparators arranged with
                                                                                       equally spaced thresholds and a thermometer coding.
The THD calculation includes the first 35 harmonics for                                For improved THD figures, the MCP3918 also includes
the MCP3918 specifications. The THD is usually only                                    proprietary 5-level DAC architecture that is inherently
measured with respect to the first ten harmonics. THD                                  linear.
is sometimes expressed as percentage. Equation 4-8
converts the THD in percentage.                                                        4.14       Idle Tones
EQUATION 4-8:                                                                          A delta-sigma converter is an integrating converter. It
                                                                                       also has a finite quantization step (LSB) which can be
                                                 THD  dB                             detected by its quantizer. A DC input voltage that is
                                                 ------------------------
               THD  %  = 100  10                       20
                                                                                       below the quantization step should only provide an
                                                                                       all zeros result, since the input is not large enough to
This specification depends mainly on the DITHER                                        be detected. As an integrating device, any delta-sigma
setting.                                                                               ADC will show idle tones. This means that the output
                                                                                       will have spurs in the frequency content that depend on
                                                                                       the ratio between the quantization step voltage and the
4.12       Spurious-Free Dynamic Range                                                 input voltage. These spurs are the result of the
           (SFDR)                                                                      integrated sub-quantization step inputs that will
SFDR is the ratio between the output power of the                                      eventually cross the quantization steps after a long
fundamental and the highest spur in the frequency                                      enough integration. This will induce an AC frequency at
spectrum (see Equation 4-9). The spur frequency is not                                 the output of the ADC, and can be shown in the ADC
necessarily a harmonic of the fundamental, even                                        output spectrum.
though this is usually the case. This figure represents                                These idle tones are residues that are inherent to the
the dynamic range of the ADC when a full-scale signal                                  quantization process and to the fact that the converter
is used at the input. This specification depends mainly                                is integrating at all times without being reset. They are
on the DITHER setting.                                                                 residues of the finite resolution of the conversion
                                                                                       process. They are very difficult to attenuate and they
EQUATION 4-9:                                                                          are heavily signal-dependent. They can degrade the
                                                                                       SFDR and THD of the converter, even for DC inputs.
       SFDR  dB  = 10 log  -----------------------------------------------------
                                FundamentalPower                                       They can be localized in the baseband of the converter
                                 HighestSpurPower                                      and are thus difficult to filter from the actual input signal.
                                                                                       For power metering applications, idle tones can be very
4.13       MCP3918 Delta-Sigma                                                         disturbing, because energy can be detected even at
                                                                                       the 50 or 60 Hz frequency, depending on the DC offset
           Architecture
                                                                                       of the ADC, while no power is really present at the
The MCP3918 incorporates one delta-sigma ADC with                                      inputs. The only practical way to suppress or attenuate
a multi-bit architecture. A delta-sigma ADC is an                                      the idle tones phenomenon is to apply dithering to the
oversampling converter that incorporates a built-in                                    ADC. The amplitudes of the idle tones are a function of
modulator, which digitizes the quantity of charges                                     the order of the modulator, the OSR and the number of
integrated by the modulator loop (see Figure 5-1). The                                 levels in the quantizer of the modulator. A higher order,
quantizer is the block that performs the                                               a higher OSR, or a higher number of levels for the
analog-to-digital conversion. The quantizer is typically                               quantizer will attenuate the amplitudes of the idle
1-bit, or a simple comparator, which helps maintain the                                tones.
linearity performance of the ADC (the DAC structure is,
in this case, inherently linear).
DS20005287A-page 26                                                                                                  2014 Microchip Technology Inc.


                                                                                         MCP3918
4.15       Dithering                                     The CMRR specification can be DC (the
                                                         common-mode input voltage takes multiple DC values)
In order to suppress or attenuate the idle tones present or AC (the common-mode input voltage is a sine wave
in any delta-sigma ADC, dithering can be applied to the  at a certain frequency with a certain common-mode). In
ADC. Dithering is the process of adding an error to the  AC, the amplitude of the sine wave represents the
ADC feedback loop in order to “decorrelate” the outputs  change in the power supply. It is defined in Equation 4-
and “break” the idle tone’s behavior. Usually a random   11.
or pseudo-random generator adds an analog or digital
error to the feedback loop of the delta-sigma ADC in
                                                         EQUATION 4-11:
order to ensure that no tonal behavior can happen at its
outputs. This error is filtered by the feedback loop and                                      VOUT
typically has a zero average value, so that the                       CMRR  dB  = 20 log  -----------------
                                                                                             VCM 
converter’s static transfer function is not disturbed by
the dithering process. However, the dithering process
                                                         Where VCM = (CH0+ + CH0-)/2 is the common-mode
slightly increases the noise floor (it adds noise to the
                                                         input voltage and VOUT is the equivalent input voltage
part) while reducing its tonal behavior and thus
                                                         that the output code translates to, with the ADC transfer
improving SFDR and THD. The dithering process
                                                         function. In the MCP3918 specification, VCM varies
scrambles the idle tones into baseband white noise and
                                                         from -1V to +1V.
ensures that dynamic specs (SNR, SINAD, THD,
SFDR) are less signal-dependent. The MCP3918             4.18       ADC Reset Mode
incorporates a proprietary dithering algorithm on the
ADC in order to remove idle tones and improve THD,       ADC Reset mode (also called Soft Reset mode) can
which is crucial for power metering applications.        only be entered in SPI mode by setting the RESET<0>
                                                         bit high in the CONFIG1 register. This mode is defined
                                                         as the condition where the converter is active, but its
4.16       PSRR                                          output is forced to 0.
This is the ratio between a change in the power supply   The registers are not affected in this Reset mode and
voltage and the ADC output codes. It measures the        retain their state, except for the data registers of the
influence of the power supply voltage on the ADC         corresponding channel, which are reset to 0.
outputs.
                                                         The ADC can immediately output meaningful codes
The PSRR specification can be DC (the power supply       after leaving the Reset mode (and after the sinc filter
takes multiple DC values) or AC (the power supply is a   settling time). This mode is both entered and exited
sine wave at a certain frequency with a certain          through bit settings in CONFIG1 register.
common-mode). In AC, the amplitude of the sine wave
                                                         The configuration registers are not modified by the Soft
represents the change in the power supply. It is defined
                                                         Reset mode. While in Reset mode, no Data Ready
in Equation 4-10.
                                                         pulse will be generated by the ADC.
EQUATION 4-10:                                           When the ADC exits ADC Reset mode, any phase
                                                         delay present before reset was entered will still be
                                      V OUT
             PSRR  dB  = 20 log  ------------------- present.
                                    AVDD
                                                         However, when the ADC is in Soft Reset mode, the
                                                         input structure is still clocking if MCLK is applied in
Where VOUT is the equivalent input voltage that the      order to properly bias the inputs, so that no leakage
output code translates to, with the ADC transfer         current is observed. If MCLK is not applied, large
function.                                                analog input leakage currents can be observed for
In the MCP3918 specification, AVDD varies from 2.7V      highly negative input voltages (typically below -0.6V
to 3.6V, and for AC PSRR a 50/60 Hz sine wave            referred to AGND).
centered around 3.0V is chosen, with a maximum
amplitude of 300 mV. The PSRR specification is
measured with AVDD = DVDD.
4.17       CMRR
CMRR is the ratio between a change in the
common-mode input voltage and the ADC output
codes. It measures the influence of the common-mode
input voltage on the ADC outputs.
 2014 Microchip Technology Inc.                                                               DS20005287A-page 27


MCP3918
4.19       Hard Reset Mode (RESET = 0)                     When the ADC exits ADC Shutdown mode, any phase
                                                           delay present before Shutdown was entered will still be
This mode is only available during a POR or when the       present.
RESET pin is pulled low in the SPI mode. The RESET
pin logic-low state places the device in Hard Reset        If the ADC is in Shutdown mode, the clock is not
mode. In this mode, all internal registers are reset to    distributed to the input structure or to the digital core for
their default state. In the 2-Wire Interface mode, the     low-power operation. This can potentially cause high
RESET pin functionality is not available and the user      analog input leakage currents at the analog inputs if the
must use a watchdog timer reset to be able to fully reset  input voltage is highly negative (typically below -0.6V
the part (see Section 7.4 “Watchdog Timer Reset,           referred to AGND). Once the ADC is back to normal
Resetting the Part when in 2-Wire Mode”).                  operation, the clock is automatically distributed again.
The DC biases for the analog blocks are still active, i.e.
                                                           4.21       Full Shutdown Mode
the MCP3918 is ready to convert. However, this pin
clears all conversion data in the ADC. The                 The lowest power consumption can be achieved when
comparators’ outputs of the ADC are forced to their        SHUTDOWN<0> = 1, VREFEXT = CLKEXT = 1. This
Reset state (0011). The sinc filter as well as its double  mode is called Full Shutdown mode, and no analog
output buffers are all reset. See serial timing for        circuitry is enabled. In this mode, both AVDD and DVDD
minimum pulse low time in Section 1.0 “Electrical          POR monitoring are also disabled, and no clock is
Characteristics”. During a Hard Reset, no                  propagated throughout the chip. The ADC is in
communication with the part is possible. The digital       Shutdown mode, and the internal voltage reference is
interface is maintained in a Reset state.                  disabled. This mode can only be entered during SPI
During this state, the clock MCLK can be applied to the    mode.
part in order to properly bias the input structures of all The clock is no longer distributed to the input structure
channels. If not applied, large analog input leakage       either. This can potentially cause high analog input
currents can be observed for highly negative input         leakage currents at the analog inputs, if the input
signals, and, after removing the Hard Reset state, a       voltage is highly negative (typically below -0.6V
certain start-up time is necessary to properly bias the    referred to AGND).
input structure. During this delay, the ADC conversions
                                                           The only circuit that remains active is the SPI interface,
can be inaccurate.
                                                           but this circuit does not induce any static power
4.20       ADC Shutdown Mode                               consumption. If SCK is idle, the only current
                                                           consumption comes from the leakage currents induced
ADC Shutdown mode is defined as a state where the          by the transistors and is less than 5 µA on each power
converters and their biases are off, consuming only        supply.
leakage current. When the Shutdown bit is reset to ‘0’,
the analog biases will be enabled, as well as the clock    This mode can be used to power down the chip
and the digital circuitry. The ADC will give a data ready  completely and to avoid power consumption when
after the sinc filter settling time has occurred. However, there is no data to convert at the analog inputs. Any
since the analog biases are not completely settled at      SCK or MCLK edge occurring while in this mode will
the beginning of the conversion, the sampling may not      induce dynamic power consumption.
be accurate for about 1 ms (corresponding to the           Once any of the SHUTDOWN, CLKEXT and VREFEXT
settling time of the biasing under worst-case              bits returns to ‘0’, the two POR monitoring blocks are
conditions). In order to ensure accuracy, the Data         operational, and AVDD and DVDD monitoring can take
Ready pulse within the delay of 1 ms + settling time of    place.
the sinc filter should be discarded.
The configuration registers are not modified by the
Shutdown mode. This mode is only available in SPI
mode through programming the SHUTDOWN<1:0>
bits in the CONFIG1 register.
The output data is flushed to all zeros while in ADC
Shutdown mode. While in ADC Shutdown mode, no
Data Ready pulse will be generated by the ADC.
DS20005287A-page 28                                                                    2014 Microchip Technology Inc.


                                                                                                                                                                                                                MCP3918
4.22          Measurement Error                                                                                                                                                   Figure 2-5 shows the typical measurement error
                                                                                                                                                                                  curves obtained with the samples acquired by the
The measurement error specification is typically used                                                                                                                             MCP3918, using the default settings with 1-point and
in power metering applications. This specification is a                                                                                                                           2-point calibration. These calibrations are detailed in
measurement of the linearity of the active energy of a                                                                                                                            Section 8.6 “Energy Measurement Error Consider-
given power meter across its dynamic range.                                                                                                                                       ations”.
For this measurement, the goal is to measure the
active energy of one phase when the voltage Root
Mean Square (RMS) value is fixed, and the current
RMS value is sweeping across the dynamic range
specified by the meter. The measurement error is the
non-linearity error of the energy power across the
current dynamic range. It is expressed in percent (%).
Equation 4-12 shows the formula that calculates the
measurement error:
EQUATION 4-12:
                              Measured Active Energy – Active Energy present at inputs
 Measurement Error  I RMS = --------------------------------------------------------------------------------------------------------------------------------------------  100%
                                                               Active Energy present at inputs
In the present device, the calculation of the active
energy is done externally, as a post-processing step
that typically happens in the microcontroller,
considering, for example, one ADC as current channel
and the other MCP3918 ADC as voltage channel. The
voltage channel is fed with a full-scale sine wave at
600 mV peak and is configured with GAIN = 1 and
DITHER = Maximum. To obtain the active energy
measurement error graphs, the current channel is fed
with sine waves with amplitudes that vary from 600 mV
peak to 60 µV peak, representing a 10,000:1 dynamic
range. The offset is removed on both current and
voltage channels, and the channels are multiplied
together to give instantaneous power. The active
energy is calculated by multiplying the current and
voltage channel, and averaging the results of this
power during 20 seconds, to extract the active energy.
The sampling frequency is chosen as a multiple integer
of line frequency (coherent sampling). Therefore, the
calculation does not take into account any residue
coming from bad synchronization.
The measurement error is a function of IRMS, varies
with the OSR, averaging time, MCLK frequency and is
tightly coupled with the noise and linearity
specifications. The measurement error is a function of
the linearity and THD of the ADC, while the standard
deviation of the measurement error is a function of the
noise specification of the ADC. Overall, the low THD
specification enables low measurement error on a very
large dynamic range (e.g. 10,000:1). A low noise and
high SNR specification enables the decrease of the
measurement time and, therefore, of the calibration
time, to obtain a reliable measurement error
specification.
 2014 Microchip Technology Inc.                                                                                                                                                                                    DS20005287A-page 29


MCP3918
NOTES:
DS20005287A-page 30  2014 Microchip Technology Inc.


                                                                                                 MCP3918
5.0        DEVICE OVERVIEW                                   TABLE 5-1:            PGA CONFIGURATION
                                                                                   SETTING
5.1        Analog Inputs (CH0+/-)
                                                                     Gain              Gain     Gain
                                                                                                         VIN Range (V)
The MCP3918 analog inputs can be connected directly            PGA_CH0<2:0>            (V/V)    (dB)
to current and voltage transducers (such as shunts,             0       0       0        1        0    ±0.6
current transformers or Rogowski coils). Each input pin
is protected by specialized ESD structures that allow           0       0       1        2        6    ±0.3
bipolar ±2V continuous voltage, with respect to AGND,           0       1       0        4       12    ±0.15
to be present at their inputs without the risk of perma-        0       1       1        8       18    ±0.075
nent damage.
                                                                1       0       0       16       24    ±0.0375
The ADC has fully differential voltage inputs for better        1       0       1       32       30    ±0.01875
noise performance. The absolute voltage at each pin
relative to AGND should be maintained in the ±1V range          Note: The two undefined settings are G = 1. This
during operation in order to ensure the specified ADC                     table is defined with VREF = 1.2V.
accuracy. The common mode signals should be
adapted to respect both the previous conditions and
                                                             5.3        Delta-Sigma Modulator
the differential input voltage range. For best
                                                             5.3.1          ARCHITECTURE
performance, the common mode signals should be
maintained to AGND.                                          The ADC includes a proprietary second-order
                                                             modulator with a multi-bit 5-level DAC architecture (see
   Note:      If the analog inputs are held to a potential   Figure 5-1). The quantizer is a Flash ADC composed of
              of -0.6 to -1V for extended periods of time,   four comparators with equally spaced thresholds and a
              MCLK must be present inside the device         thermometer output coding. The proprietary five-level
              in order to avoid large leakage currents at    architecture ensures minimum quantization noise at
              the analog inputs. This is true even during    the outputs of the modulators without disturbing
              Hard Reset mode or during the Soft Reset       linearity or inducing additional distortion. The sampling
              of the ADC. However, during the                frequency is DMCLK (typically 1 MHz with
              Shutdown mode of the ADC or during the         MCLK = 4 MHz) so the modulators are refreshed at a
              POR state, the clock is not distributed        DMCLK rate.
              inside the circuit. During these states, it is Figure 5-1 represents a simplified block diagram of the
              recommended to keep the analog input           delta-sigma ADC present on MCP3918.
              voltages above -0.6V referred to AGND in
              order to avoid high analog inputs leakage
              currents.
                                                                                    Loop             Quantizer
                                                                                    Filter
5.2        Programmable Gain Amplifiers                       Differential                                      Output
           (PGA)                                                                      Second-
                                                              Voltage Input            Order                   Bit Stream
                                                                                     Integrator      5-level
The Programmable Gain Amplifier (PGA) resides at the                                             Flash ADC
front-end of the delta-sigma ADC. It has two functions:
translate the common-mode voltage of the input from
AGND to an internal level between AGND and AVDD, and
amplify the input differential signal. The translation of                                             DAC
the common-mode voltage does not change the
differential signal, but recenters the common mode so                      MCP3918 Delta-Sigma Modulator
that the input signal can be properly amplified.
The PGA block can be used to amplify very low signals,       FIGURE 5-1:                 Simplified Delta-Sigma ADC
but the differential input range of the delta-sigma          Block Diagram.
modulator must not be exceeded. The PGA of the ADC
is controlled by the PGA_CH0<2:0> bits in the GAIN
register. Table 5-1 displays the gain settings for the
PGA.
 2014 Microchip Technology Inc.                                                                    DS20005287A-page 31


MCP3918
5.3.2          MODULATOR INPUT RANGE AND                         5.3.3       BOOST SETTINGS
               SATURATION POINT                                  The delta-sigma modulator includes a programmable
For a specified voltage reference value of 1.2V, the             biasing circuit, in order to further adjust the power
modulator specified differential input range is ±600 mV.         consumption to the sampling speed applied through
The input range is proportional to VREF and scales               the MCLK. This can be programmed through the
according to the VREF voltage. This range ensures the            BOOST<1:0> bits, which are applied to all channels
stability of the modulator over amplitude and frequency.         simultaneously.
Outside this range, the modulator is still functional;           The maximum achievable analog master clock speed
however, its stability is no longer ensured and therefore        (AMCLK), the maximum sampling frequency (DMCLK)
it is not recommended to exceed this limit. The                  and the maximum achievable data rate (DRCLK) highly
saturation point for the modulator is VREF/1.5, since the        depend on the BOOST<1:0> and PGA_CH0<2:0>
transfer function of the ADC includes a gain of 1.5 by           settings. Table 5-2 specifies the maximum AMCLK
default (independent from the PGA setting). See                  possible to keep optimal accuracy with respect to the
Section 5.5 “ADC Output Coding”.                                 BOOST<1:0> and PGA_CH0<2:0> settings.
TABLE 5-2:          MAXIMUM AMCLK LIMITS AS A FUNCTION OF BOOST AND PGA GAIN
                                       VDD = 3.0V to 3.6V,                            VDD = 2.7V to 3.6V,
     Conditions
                                    TA from -40°C to +125°C                        TA from -40°C to +125°C
                           Maximum AMCLK           Maximum AMCLK          Maximum AMCLK            Maximum AMCLK
                                 (MHz)                   (MHz)                  (MHz)                    (MHz)
   Boost        Gain
                         (SINAD within -3 dB     (SINAD within -5 dB    (SINAD within -3 dB      (SINAD within -5 dB
                          from its maximum)       from its maximum)      from its maximum)        from its maximum)
 0.5x             1                 4                       4                      4                        4
 0.66x            1               6.4                      7.3                    6.4                      7.3
 1x               1               11.4                    11.4                   10.6                     10.6
 2x               1                16                      16                     16                       16
 0.5x             2                 4                       4                      4                        4
 0.66x            2               6.4                      7.3                    6.4                      7.3
 1x               2               11.4                    11.4                   10.6                     10.6
 2x               2                16                      16                    13.3                     14.5
 0.5x             4                2.9                     2.9                    2.9                      2.9
 0.66x            4               6.4                      6.4                    6.4                      6.4
 1x               4               10.7                    10.7                    9.4                     10.7
 2x               4                16                      16                     16                       16
 0.5x             8                2.9                      4                     2.9                       4
 0.66x            8               7.3                       8                     6.4                      7.3
 1x               8               11.4                    12.3                     8                       8.9
 2x               8                16                      16                     10                      11.4
 0.5x            16                2.9                     2.9                    2.9                      2.9
 0.66x           16               6.4                      7.3                    6.4                      7.3
 1x              16               11.4                    11.4                    9.4                     10.6
 2x              16               13.3                     16                     8.9                     11.4
 0.5x            32                2.9                     2.9                    2.9                      2.9
 0.66x           32               7.3                      7.3                    7.3                      7.3
 1x              32               10.6                    12.3                    9.4                     10,6
 2x              32               13.3                     16                     10                      11.4
DS20005287A-page 32                                                                       2014 Microchip Technology Inc.


                                                                                           MCP3918
5.3.4          DITHER SETTINGS                             TABLE 5-3:         DELTA-SIGMA MODULATOR
The modulator includes a dithering algorithm that can                         CODING
be enabled through the DITHER<1:0> bits in the
                                                              Comp<3:0>         Modulator         MDAT Serial
CONFIG0 register. This dithering process improves
                                                                 Code          Output Code           Stream
THD and SFDR (for high OSR settings), while slightly
increasing the noise floor of the ADC. For power                  1111               +2               1111
metering applications and applications that are                   0111               +1               0111
distortion-sensitive, it is recommended to keep
                                                                  0011                 0              0011
DITHER at maximum settings for best THD and SFDR
performance. In the case of power metering                        0001                -1              0001
applications, THD and SFDR are critical specifications.           0000                -2              0000
Optimizing SNR (noise floor) is not problematic due to
the large averaging factor at the output of the ADC.
Therefore, even for low OSR settings, the dithering                        COMP COMP COMP COMP
                                                                             <3>     <2>     <1>    <0>
algorithm will show a positive impact on the
performance of the application.
                                                             AMCLK
5.3.5          MODULATOR OUTPUT BLOCK
If the user wishes to use the modulator output of the        DMCLK
device, the EN_MDAT bit in the STATUSCOM register
must be set to enable.
When the EN_MDAT bit is enabled, the modulator               MDAT+2
output is present at the MDAT0 output pin as soon as
the command is placed. Additionally, the corresponding
sinc filter is disabled in order to consume less current.    MDAT+1
The corresponding Data Ready pulse is not present
either at the DR output pin. When the EN_MDAT bit is
cleared, the sinc filter is back to normal operation and     MDAT+0
the MDAT0 output is high-impedance. The data ready
output pin is then placed in high-impedance regardless
                                                             MDAT-1
of the DR_HIZ setting, so that the user can tie this pin
to an external supply or ground for lower noise
behavior.
Since the delta-sigma modulator has a five-level output      MDAT-2
given by the state of the four comparators with
thermometer coding, its output can be represented on       FIGURE 5-2:             MDAT0 Serial Output with
four bits, each bit giving the state of the corresponding  Respect to the Modulator Output Code.
comparator (see Table 5-3). These bits are present in
                                                           Since the Reset and Shutdown SPI commands are
the MOD register and are updated at the DMCLK rate.
                                                           asynchronous, the MDAT0 pin is resynchronized with
In order to output the result of the comparator on a       DMCLK after each time the part goes out of reset and
separate pin (MDAT0), this comparator output bit has       shutdown.
been arranged to be serially output at the AMCLK rate      This means that, after a soft reset or a shutdown, the
(see Figure 5-2).                                          first output of MDAT0 is always 0011 after the first
This 1-bit serial bit stream is the same that would be     DMCLK rising edge.
produced by a 1-bit DAC modulator with a sampling          The MDAT0 output pin is high-impedance if the RESET
frequency of AMCLK. The modulator can either be            pin is low and in 2-wire interface mode.
considered as a five-level output at DMCLK rate or a
1-bit output at AMCLK rate. These two representations
are interchangeable. The MDAT0 output can therefore
be used in any application that requires 1-bit modulator
outputs. Such applications will often integrate and filter
the 1-bit output with sinc or more complex decimation
filters computed by a MCU or a DSP.
 2014 Microchip Technology Inc.                                                              DS20005287A-page 33


MCP3918
5.4         SINC3 + SINC1 Filter
The decimation filter present in the MCP3918 is a
cascade of two sinc filters (SINC3 + SINC1): a
third-order sinc filter with a decimation ratio of OSR3,
followed by a first-order sinc filter with a decimation
ratio of OSR1 (moving average of OSR1 values).
Figure 5-3 represents the decimation filter architecture.
                                                                                                                          OSR1 = 1
                                                                                                                                                       Decimation Filter
                  Modulator                                                                    SINC3                       SINC1
                                                                                                                                                             Output
                       Output
                                                 4                                                                                                       16 (WIDTH = 0)
                                                                                                                                                         24 (WIDTH = 1)
                                                                                                  OSR3                      OSR1
                                                                                                             Decimation Filter
FIGURE 5-3:                                  MCP3918 Decimation Filter Block Diagram.
Equation 5-1 calculates the filter z-domain transfer                                                                        keep the desired accuracy over the baseband of the
function.                                                                                                                   converter. This anti-aliasing filter can be a simple,
                                                                                                                            first-order RC network, with a sufficiently low time
EQUATION 5-1:                                SINC FILTER TRANSFER                                                           constant to generate high rejection at the DMCLK
                                             FUNCTION                                                                       frequency.
                               - OSR 3 3                                    - OSR 1  OSR 3                                 Any unsettled data is automatically discarded to avoid
                1 – z                                       1 – z                                                
                                                                                                                        data corruption. Each Data Ready pulse corresponds
   H  z  = ----------------------------------------------  ---------------------------------------------------------
              OSR  1 – z                 –  1       3                                         -   OSR                   to fully settled data at the output of the decimation filter.
                           3                                  OSR   1 – z                                      3
                                                                                                                            The first data available at the output of the decimation
                                                                          1                                        
          Where z = EXP   2   j  f in    DMCLK                                                                    filter is present after the complete settling time of the
                                                                                                                            filter (see Table 5-4). After the first data has been
                                                                                                                            processed, the delay between two Data Ready pulses
Equation 5-2 calculates the settling time of the ADC as
                                                                                                                            is one DRCLK period. The data stream from input to
a function of DMCLK periods.
                                                                                                                            output is delayed by an amount equal to the settling
EQUATION 5-2:                                                                                                               time of the filter (which is the group delay of the filter).
 SettlingTime  DMCLKperiods = 3  OSR +  OSR – 1   OSR                                                                 The resolution achievable, the -3 dB bandwidth and the
                                                                           3                   1                        3
                                                                                                                            settling time at the output of the decimation filter (the
The SINC1 filter following the SINC3 filter is only                                                                         output of the ADC) are dependent on the OSR of each
enabled for the high OSR settings. This SINC1 filter                                                                        sinc filter and are summarized in Table 5-4.
provides additional rejection at a low cost with little
modification to the -3 dB bandwidth. The resolution
(number of significant bits) of the digital filter is 24-bit
maximum for any OSR and data format choice. The
resolution depends only on the OSR<2:0> settings in
the CONFIG0 register per Table 5-4. Once the OSR is
chosen, the resolution is fixed and the output code
respects the data format defined by the
WIDTH_DATA<1:0> setting in the STATUSCOM
register (see Section 5.5 “ADC Output Coding”).
The gain of the transfer function of this filter is 1 at each
multiple of DMCLK (typically 1 MHz), so a proper anti-
aliasing filter must be placed at the inputs. This will
attenuate the frequency content around DMCLK and
DS20005287A-page 34                                                                                                                                     2014 Microchip Technology Inc.


                                                                                                                                    MCP3918
TABLE 5-4:                           OVERSAMPLING RATIO AND SINC FILTER SETTLING TIME
                                                                                  Resolution in Bits
             OSR<2:0>                    OSR3      OSR1     Total OSR                                          Settling Time              -3 dB Bandwidth
                                                                                  (No Missing Code)
  0                         0   0         32        1              32                    17                       96/DMCLK                    0.26*DRCLK
  0                         0   1         64        1              64                    20                      192/DMCLK                    0.26*DRCLK
  0                         1   0        128        1             128                    23                      384/DMCLK                    0.26*DRCLK
  0                         1   1        256        1             256                    24                      768/DMCLK                    0.26*DRCLK
  1                         0   0        512        1             512                    24                     1536/DMCLK                    0.26*DRCLK
  1                         0   1        512        2             1024                   24                     2048/DMCLK                    0.37*DRCLK
  1                         1   0        512        4             2048                   24                     3072/DMCLK                    0.42*DRCLK
  1                         1   1        512        8             4096                   24                     5120/DMCLK                    0.43*DRCLK
                                                                                          5.5         ADC Output Coding
                       0
                                                                                          The second-order modulator, SINC3+SINC1 filter,
                     -20                                                                  PGA, VREF and the analog input structure all work
                                                                                          together to produce the device transfer function for the
  Ma
   agnitude (dB)
                     -40
                                                                                          analog-to-digital conversion (see Equation 5-3).
                     -60
                                                                                          The output data is calculated on 24-bit (23-bit plus sign)
                     -80                                                                  and coded in two's complement format, MSB first. The
                                                                                          output format can then be modified by the
                   -100
                                                                                          WIDTH_DATA<1:0> settings in the STATUSCOM
                   -120                                                                   register to allow 16-, 24- or 32-bit formats compatibility
                            1       10       100     1000       10000    100000           (see Section 9.5 “STATUSCOM Register - Status
                                         Input Frequency (Hz)                             and Communication Register” for more information).
                                                                                          In case of positive saturation (CH0+ – CH0-
FIGURE 5-4:      Sinc Filter Frequency
                                                                                           > VREF/1.5), the output code is locked to 7FFFFF for
Response, OSR = 256, MCLK = 4 MHz,
                                                                                          24-bit mode. In case of negative saturation
PRE<1:0> = 00.                                                                            (CH0+ - CH0- < -VREF/1.5), the output code is locked
                                                                                          to 800000 for 24-bit mode.
                       0
                                                                                          Equation 5-3 is only true for DC inputs. For AC inputs,
                      -20                                                                 this transfer function needs to be multiplied by the
                      -40                                                                 transfer function of the SINC3+SINC1 filter (see
    Magnitude (dB)
                      -60                                                                 Equations 5-1 and 5-3).
                      -80
                                                                                          EQUATION 5-3:
                     -100
                                                                                                          CH n+ – CH n-
                     -120                                                                 DATA_CH0 =  -------------------------------------  8 388 608  G  1.5
                                                                                                        V REF+ – V REF-
                     -140
                     -160                                                                  For 24-bit Mode, WIDTH_DATA<1:0> = 01 (Default)
                            1            100         10000          1000000
                                           Input Frequency (Hz)
                                                                                          For data formats other than the default 24-bit format,
FIGURE 5-5:       Sinc Filter Frequency                                                   Equation 5-3 should be multiplied by a scaling factor,
Response, OSR = 4096 (in pink), OSR = 512 (in                                             depending on the data format used (defined by
blue), MCLK = 4 MHz, PRE<1:0> = 00.                                                       WIDTH_DATA<1:0>). The data format and the
                                                                                          associated scaling factors are given in Figure 5-6.
 2014 Microchip Technology Inc.                                                                                                         DS20005287A-page 35


MCP3918
                                                                       23                                  0
                        Unformatted ADC data                            DATA DATA DATA
                                                                       <23:16> <15:8> <7:0>
                                                                                                                          Scaling
                                                                                                                          Factor
                                                                       15                   0
                    WIDTH_DATA<1:0> = 00                                DATA DATA               DATA
                                   16-bit                              <23:16> <15:8>            <7>                      x1/256
                                                                                                 Rounded
                                                                       23                                  0
                    WIDTH_DATA<1:0> = 01                                DATA DATA DATA
                                   24-bit                              <23:16> <15:8> <7:0>                               x1
                                                                       31                                             0
                    WIDTH_DATA<1:0> = 10                                DATA DATA DATA
                     32-bit with zeros padded                          <23:16> <15:8> <7:0>                    0x00       x256
                                                            31                                             0
                    WIDTH_DATA<1:0> = 11                        DATA DATA DATA DATA                                       x1
                    32-bit with sign extension                  <23> <23:16> <15:8> <7:0>
FIGURE 5-6:                 Output Data Formats.
The ADC resolution is a function of the OSR
(Section 5.4 “SINC3 + SINC1 Filter”). The resolution
is the same for all channels. No matter what the
resolution is, the ADC output data is always calculated
in 24-bit words, with added zeros at the end if the OSR
is not large enough to produce 24-bit resolution (left
justification).
TABLE 5-5:              OSR = 256 (AND HIGHER) OUTPUT CODE EXAMPLES
                                                                                                                                   Decimal,
                            ADC Output Code (MSB First)                                                Hexadecimal
                                                                                                                               24-bit Resolution
0   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1      1   1    1   1   1   1   1     1        0x7FFFFF               + 8,388,607
0   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1      1   1    1   1   1   1   1     0        0x7FFFFE               + 8,388,606
0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0      0   0    0   0   0   0   0     0         0x000000                    0
1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1      1   1    1   1   1   1   1     1        0xFFFFFF                    -1
1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0      0   0    0   0   0   0   0     1        0x800001               - 8,388,607
1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0      0   0    0   0   0   0   0     0        0x800000               - 8,388,608
TABLE 5-6:              OSR = 128 OUTPUT CODE EXAMPLES
                                                                                                                                   Decimal,
                            ADC Output Code (MSB First)                                                Hexadecimal
                                                                                                                               23-bit Resolution
0   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1     1    1    1   1   1   1   1   0       0x7FFFFE                 + 4,194,303
0   1   1   1   1   1   1   1   1   1   1   1   1   1   1   0     1    1    1   1   1   1   0   0       0x7FFFFC                 + 4,194,302
0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0     0    0    0   0   0   0   0   0        0x000000                      0
1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1     1    1    1   1   1   1   1   0       0xFFFFFE                      -1
1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0     0    0    0   0   0   0   1   0       0x800002                 - 4,194,303
1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0     0    0    0   0   0   0   0   0       0x800000                 - 4,194,304
TABLE 5-7:              OSR = 64 OUTPUT CODE EXAMPLES
                                                                                                                                   Decimal,
                            ADC Output Code (MSB First)                                                Hexadecimal
                                                                                                                               20-bit Resolution
0   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1     1    1    1   1   0   0   0    0      0x7FFFF0                  + 524, 287
0   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1     1    1    1   0   0   0   0    0      0x7FFFE0                  + 524, 286
0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0     0    0    0   0   0   0   0    0       0x000000                      0
1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1     1    1    1   1   0   0   0    0      0xFFFFF0                      -1
1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0     0    0    0   1   0   0   0    0      0x800010                  - 524,287
1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0     0    0    0   0   0   0   0    0      0x800000                  - 524, 288
DS20005287A-page 36                                                                                                2014 Microchip Technology Inc.


                                                                                               MCP3918
TABLE 5-8:         OSR = 32 OUTPUT CODE EXAMPLES
                                                                                                        Decimal,
                       ADC Output Code (MSB First)                             Hexadecimal
                                                                                                   17-bit Resolution
 0   1 1  1    1 1  1  1    1  1 1  1    1  1  1  1    1 0 0 0     0  0  0 0     0x7FFF80               + 65, 535
 0   1 1  1    1 1  1  1    1  1 1  1    1  1  1  1    0 0 0 0     0  0  0 0     0x7FFF00               + 65, 534
 0   0 0  0    0 0  0  0    0  0 0  0    0  0  0  0    0 0 0 0     0  0  0 0      0x000000                    0
 1   1 1  1    1 1  1  1    1  1 1  1    1  1  1  1    1 0 0 0     0  0  0 0     0xFFFF80                    -1
 1   0 0  0    0 0  0  0    0  0 0  0    0  0  0  0    1 0 0 0     0  0  0 0      0x800080               - 65,535
 1   0 0  0    0 0  0  0    0  0 0  0    0  0  0  0    0 0 0 0     0  0  0 0      0x800000               - 65, 536
5.6       Voltage Reference                                    5.6.2        DIFFERENTIAL EXTERNAL
                                                                            VOLTAGE INPUTS
5.6.1        INTERNAL VOLTAGE REFERENCE
                                                               When the VREFEXT bit is set to ‘1’, the two reference
The MCP3918 contains an internal voltage reference             pins (REFIN+/OUT, REFIN-) become a differential
source specially designed to minimize drift over               voltage reference input. The voltage at the
temperature. In order to enable the internal voltage           REFIN+/OUT is noted VREF+, and the voltage at the
reference, the VREFEXT bit in the CONFIG1 register             REFIN- pin is noted VREF-. The differential voltage
must be set to ‘0’ (default mode). This internal VREF          input value is given by Equation 5-4.
supplies reference voltage to all channels. The typical
value of this voltage reference is 1.2V ± 2%. The              EQUATION 5-4:
internal reference has a very low typical temperature
coefficient of ±7 ppm/°C, allowing the output to have                            VREF = VREF+ – VREF-
minimal variation, with respect to temperature, since
they are proportional to (1/VREF).                             The specified VREF ranges from 1.1V to 1.3V. The
The noise of the internal voltage reference is low             REFIN- pin voltage (VREF-) should be limited to ±0.1V,
enough not to significantly degrade the SNR of the             with respect to AGND. Typically, for single-ended
ADC, if compared to a precision external low-noise             reference applications, the REFIN- pin should be
voltage reference. The output pin for the internal             directly connected to AGND, with its own separate track
voltage reference is REFIN+/OUT.                               to avoid any spike due to switching noise.
If the voltage reference is only used as an internal           5.6.3        TEMPERATURE COMPENSATION
VREF, adding bypass capacitance on REFIN+/OUT is                            (VREFCAL<7:0>)
not necessary for keeping ADC accuracy, but a minimal
0.1 µF ceramic capacitance can be connected to avoid           The internal voltage reference consists of a proprietary
EMI/EMC susceptibility issues due to the antenna               circuit and algorithm to compensate for first-order and
created by the REFIN+/OUT pin, if left floating.               second-order        temperature       coefficients.  The
                                                               compensation enables very low temperature
The bypass capacitors also help in applications where          coefficients (typically 9 ppm/°C) on the entire range of
the voltage reference output is connected to other             temperatures, from - 40°C to +125°C. This temperature
circuits. In this case, additional buffering may be            coefficient varies from part to part.
needed, since the output drive capability of this output
is low.                                                        This temperature coefficient can be adjusted on each
                                                               part through the VREFCAL<7:0> bits present in the
Adding too much capacitance on the REFIN+/OUT pin              CONFIG0 register (bits 7 to 0). These register settings
may slightly degrade the THD performance of the ADC.           are only for advanced users. The VREFCAL<7:0> bits
                                                               should not be modified unless the user wants to
                                                               calibrate the temperature coefficient of the whole
                                                               system or application. The default value of this register
                                                               is set to 0x50. The default value (0x50) was chosen to
                                                               optimize the standard deviation of the tempco across
                                                               process variation. The value can be slightly improved
                                                               to around 7 ppm/°C if the VREFCAL<7:0> bits are
                                                               written at 0x42, but this setting degrades the standard
                                                               deviation of the VREF tempco.The typical variation of
                                                               the temperature coefficient of the internal voltage
                                                               reference with respect to the VREFCAL register code
                                                               is given by Figure 5-6. Modifying the value stored in the
                                                               VREFCAL<7:0> bits may also vary the voltage
                                                               reference, in addition to the temperature coefficient.
 2014 Microchip Technology Inc.                                                                   DS20005287A-page 37


MCP3918
                                                                                           5.7         Power-on Reset
                         60
                                                                                           The MCP3918 contains an internal POR circuit that
                         50
                                                                                           monitors both analog and digital supply voltages during
      VREF Drift (ppm)
                         40                                                                operation. The typical threshold for a power-up event
                                                                                           detection is 2.0V ± 5% and a typical start-up time
                         30                                                                (tPOR) of 50 µs. The POR circuit has a built-in
                                                                                           hysteresis for improved transient spike immunity that
                         20
                                                                                           has a typical value of 200 mV. Proper decoupling
                         10                                                                capacitors (0.1 µF ceramic and 10 µF) should be
                                                                                           mounted as close as possible to the AVDD and DVDD
                         0                                                                 pins, providing additional transient immunity.
                              0         64          128        192        256
                                  VREFCAL Register Trim Code (Decimal)                     Figure 5-8 illustrates the different conditions at a
                                                                                           power-up and a power-down event under typical
    FIGURE 5-7:                              VREF Tempco vs. VREFCAL                       conditions. All internal DC biases are settled at least
    Trim Code Chart.                                                                       1 ms after system POR, under worst-case conditions.
                                                                                           In order to ensure proper accuracy, any Data Ready
    5.6.4                         VOLTAGE REFERENCE BUFFER                                 pulse occurring within 1 ms plus the sinc filter settling
    The MCP3918 ADC includes a voltage reference buffer                                    time after system reset should be ignored. After POR,
    tied to the REFIN+/OUT pin, which allows the device to                                 Data Ready pulses are present at the pin with all the
    properly charge the internal capacitors with the voltage                               default conditions in the configuration registers.
    reference signals, even in the case of an external                                     Both AVDD and DVDD are monitored, so either power
    voltage reference connection with weak load regulation                                 supply can sequence first.
    specifications. This ensures that the correct amount of
    current is sourced to each channel to guarantee their
    accuracy specifications, and diminishes the constraints
    on the voltage reference load regulation.
                                                Voltage
                                                                                                                     Any Data Ready pulse
                                                (AVDD, DVDD)                                                         occurring during this time
                                                                                                                     can yield inaccurate output
                                                                                                                     data. It is recommended to
                                                                                                                     discard them.
                POR Threshold
               up (2.0V typical)
                  (1.8V typical)
                                                       tPOR Analog biases SINC filter
                                                                          SINC filter
                                                               settling time    settling
                                                                                settling
                                                                                 time                        Time
                                                     POR                           Normal            POR
                                                     State      Power-Up          Operation          State
                                                                Biases are     Biases are settled.
                                                                 unsettled.   Conversions started
                                                               Conversions     here are accurate.
                                                             started here may
                                                             not be accurate.
    FIGURE 5-8:                              Power-On Reset Operation.
DS20005287A-page 38                                                                                             2014 Microchip Technology Inc.


                                                                                                                                             MCP3918
5.8       Hard Reset Effect on Delta-Sigma                                                                    5.9.1        PHASE DELAY LIMITS
          Modulator/Sinc Filter                                                                               The limits of the phase delays are determined by the
                                                                                                              OSR settings: the phase delays can only go from 0 to
In SPI mode, when the RESET pin is logic low, the ADC
                                                                                                              +(OSR-1) DMCLK periods when taking the last reset as
will be in Reset and the output code is 0x0000h. The
                                                                                                              a reference (same definition as MCP391X but not
RESET pin performs a hard reset (DC biases are still
                                                                                                              showing an odd channel reference here since there is
on, part is ready to convert) and clears all charges
                                                                                                              only one channel).
contained in the delta-sigma modulator. The
comparator’s output is ‘0011’ for the ADC.                                                                    If larger delays are needed, they can be implemented
                                                                                                              externally to the chip with an MCU. A FIFO in the MCU
The sinc filter is reset, as well as its double output
                                                                                                              can save incoming data from the ADC channel for a
buffers. This pin is independent of the serial interface.
                                                                                                              number N of DRCLK clocks. In this case, DRCLK
It brings all the registers to the default state. When
                                                                                                              would represent the coarse timing resolution, and
RESET is logic low, any write with the SPI interface will
                                                                                                              DMCLK the fine timing resolution. The total delay will
be disabled and will have no effect. All output pins
                                                                                                              then be equal to:
(SDO, DR) are high-impedance.
If MCLK is applied, the input structure is enabled and is                                                     EQUATION 5-6:
properly biasing the substrate of the input transistors.
                                                                                                                     Total Delay = N/DRCLK + OSR/2/DMCLK
In this case, the leakage current on the analog inputs is
low if the analog input voltages are kept between -1V
and +1V.
                                                                                                                  Note:    Rewriting the PHASE register with the
If MCLK is not applied when in Reset mode, the                                                                             same value automatically resets and
leakage can be high if the analog inputs are                                                                               restarts the ADC.
below -0.6V, as referred to AGND.
                                                                                                              The Phase delay register can be programmed once
5.9       Phase Delay Block                                                                                   with the OSR = 4096 setting, and will automatically
                                                                                                              adjust the OSR afterwards, without the need to change
The MCP3918 incorporates a phase delay generator                                                              the value of the PHASE register.
which ensures the ADC (CH0) converts the inputs after
a fixed delay, as determined by the PHASE register                                                            • OSR = 4096: The delay can go from 0 to +4095.
setting.                                                                                                          PHASE<11> is the sign bit. Phase<10> is the
                                                                                                                  MSB and PHASE<0> the LSB.
The PHASE register contains a 12-bit bank that
                                                                                                              • OSR = 2048: The delay can go from 0 to +2047.
represents group delay of the ADC channel (in addition
                                                                                                                  PHASE<10> is the sign bit. Phase<9> is the MSB
to the settling time of the sinc filter) expressed in
                                                                                                                  and PHASE<0> the LSB.
DMCLK periods with an offset of OSR/2 periods. It is
coded with a 11-bit plus sign, MSB-first two's                                                                • OSR = 1024: The delay can go from 0 to +1023.
complement code. This code indicates how many                                                                     PHASE<9> is the sign bit. Phase<8> is the MSB
DMCLK periods are induced as a delay (see                                                                         and PHASE<0> the LSB.
Equation 5-5).                                                                                                • OSR = 512: The delay can go from 0 to +511
                                                                                                                  PHASE<8> is the sign bit. Phase<7> is the MSB
EQUATION 5-5:                                                                                                     and PHASE<0> the LSB.
                                                                                                              • OSR = 256: The delay can go from 0 to +255.
                                                                                                  OSR             PHASE<7> is the sign bit. Phase<6> is the MSB
                   PHASE<11:0> Decimal Code + -----------
                                                                                                      2           and PHASE<0> the LSB.
   Total Delay = --------------------------------------------------------------------------------------------
                                                    DMCLK
                                                                                                              • OSR = 128: The delay can go from 0 to +127.
                                                                                                                  PHASE<6> is the sign bit. Phase<5> is the MSB
The timing resolution of the phase delay is 1/DMCLK or                                                            and PHASE<0> the LSB.
1 µs in the default configuration with MCLK = 4 MHz.                                                          • OSR = 64: The delay can go from 0 to +63.
Given the definition of DMCLK, the phase delay is                                                                 PHASE<5> is the sign bit. Phase<4> is the MSB
affected by a change in the prescaler settings                                                                    and PHASE<0> the LSB.
(PRE<1:0>) and the MCLK frequency. The Data Ready                                                             • OSR = 32: The delay can go from 0 to +31.
signal is affected by the phase delay settings.                                                                   PHASE<4> is the sign bit. Phase<3> is the MSB
                                                                                                                  and PHASE<0> the LSB.
 2014 Microchip Technology Inc.                                                                                                               DS20005287A-page 39


MCP3918
TABLE 5-9:          PHASE VALUES WITH                       5.11      Crystal Oscillator
                    MCLK = 4 MHZ, OSR = 4096,               The MCP3918 includes a Pierce-type crystal oscillator
                    PRE<1:0> = 00                           with very high stability and ensures very low tempco
       PHASE<11:0>            Hex             Delay         and jitter for the clock generation. This oscillator can
                                                            handle crystal frequencies up to 20 MHz, provided that
 0 1 1 1 1 1 1 1 1 1 1 1 0x7FF              4095 µs         proper load capacitances and quartz quality factor are
 0 1 1 1 1 1 1 1 1 1 1 0 0x7FE              4094 µs         used. The crystal oscillator is enabled when
 0 0 0 0 0 0 0 0 0 0 0 1 0x001              2049 µs         CLKEXT = 0 in the CONFIG1 register, therefore it
                                                            cannot be enabled during the 2-Wire Interface mode. It
 0 0 0 0 0 0 0 0 0 0 0 0 0x000              2048 µs         is only selectable in the SPI Mode.
 1 1 1 1 1 1 1 1 1 1 1 1 0xFFF              2047 µs
                                                            For a proper start-up, the load capacitors of the crystal
 1 0 0 0 0 0 0 0 0 0 0 1 0x801                 1 µs         should be connected between OSC1 and DGND and
 1 0 0 0 0 0 0 0 0 0 0 0 0x800                 0 µs         between OSC2 and DGND. They should also respect
                                                            Equation 5-7.
5.10       Data Ready Status Bit
In addition to the DR pin indicator, the MCP3918 device     EQUATION 5-7:
includes a separate Data Ready status bit. The ADC                                                                      2
                                                                          R M < 1.6  10   -------------------------
                                                                                        6               1
channel is associated to the corresponding                                                  f  C LOAD
DRSTATUS bit that can be read at all times in the
STATUSCOM register. This status bit can be used to            Where:
synchronize the data retrieval, in case the DR pin is not             f = crystal frequency in MHz
connected (see Section 6.8 “ADC Channel Latching
and Synchronization”).                                         CLOAD = load capacitance in pF, including
                                                                           parasitics from the PCB
The DRSTATUS bit is not writable; writing on it has no
                                                                   RM = motional resistance of the quartz, in
effect. It has a default value of '1', which indicates that
                                                                           ohms
the data of the corresponding ADC is not ready. This
means that the ADC output register has not been
updated since the last reading (or since the last reset).   When CLKEXT = 1, the crystal oscillator is bypassed
The DRSTATUS bit takes the '0' state, once the ADC          by a digital buffer, to allow direct clock input for an
channel register is updated (which happens at a             external clock (see Figure 4-1). In this case, OSC2
DRCLK rate). A simple read of the STATUSCOM                 becomes the MODE select input pin for the Interface
register clears the DRSTATUS bit to its default value       mode. When MODE = 0, the digital interface stays in
('1').                                                      SPI mode; when MODE = 1, the digital interface
                                                            toggles to the 2-Wire mode. A pull-down current forces
                                                            the MODE to be logic low (SPI mode) by default if the
                                                            OSC2 pin is floating.
                                                            For proper operation, the external clock should not be
                                                            higher      than      20 MHz             before               prescaling
                                                            (MCLK < 20 MHz).
                                                               Note:     In addition to the conditions defining the
                                                                         maximum MCLK input frequency range,
                                                                         the AMCLK frequency should be
                                                                         maintained inferior to the maximum limits
                                                                         defined in Table 5-2, to ensure the
                                                                         accuracy of the ADC. If these limits are
                                                                         exceeded, it is recommended to choose
                                                                         either a larger OSR or a larger prescaler
                                                                         value so that AMCLK can respect these
                                                                         limits.
DS20005287A-page 40                                                                    2014 Microchip Technology Inc.


                                                                                              MCP3918
5.12       Digital System Offset and Gain
           Errors
The MCP3918 incorporates two sets of additional
registers to perform system digital offset and gain error
calibration, which will modify the output result of the
channel, if calibration is enabled. The gain and offset
calibrations can be enabled or disabled through two
configuration bits (EN_OFFCAL and EN_GAINCAL).
When both calibrations are enabled, the output of the
ADC is modified per Equation 5-8. These calibrations
are not effective in 2-Wire interface mode.
EQUATION 5-8:            DIGITAL OFFSET AND GAIN ERROR CALIBRATION REGISTERS
                         CALCULATIONS
            DATA_CH0  post – cal  =  DATA_CH0  pre – cal  + OFFCAL_CH0    1 + GAINCAL_CH0 
5.12.1       DIGITAL OFFSET ERROR                           5.12.2        DIGITAL GAIN ERROR
             CALIBRATION                                                  CALIBRATION
The OFFCAL_CH0 register is 23-bit plus sign two’s           This register is a signed 24-bit MSB – first register
complement registers, whose LSB value is the same as        coded with a range of -1x to +(1 - 2-23)x (from
the Channel ADC Data. This register is then added bit       0x800000 to 0x7FFFFF). The gain calibration adds 1x
by bit to the ADC output codes, if the EN_OFFCAL bit        to this register and multiplies it to the output code of the
is enabled. Enabling the EN_OFFCAL bit does not             channel bit by bit, after offset calibration. Thus, the gain
create a pipeline delay; the offset addition is             calibration ranges from 0x to 1.9999999x (from
instantaneous. For low OSR values, only the significant     0x80000 to 0x7FFFFF). The LSB corresponds to a 2-23
digits are added to the output (up to the resolution of     increment in the multiplier.
the ADC; for example, at OSR = 32, only the first 17        Enabling EN_GAINCAL creates a pipeline delay of
bits are added).                                            24 DMCLK periods on all channels. All Data Ready
The offset is not added when the corresponding              pulses are delayed by 24 DMCLK periods, starting
channel is in Reset or Shutdown mode. The                   from data ready pulse following the command enabling
corresponding input voltage offset value added by each      EN_GAINCAL bit. The gain calibration is effective on
LSB in these 24-bit registers is:                           the next data ready pulse following the command
                                                            enabling EN_GAINCAL bit.
EQUATION 5-9:                                               The digital gain calibration does not function when the
                                                            corresponding channel is in Reset or Shutdown mode.
  OFFSET(1LSB) = VREF/(PGA_CHn x 1.5 x 8388608)
                                                            The gain multiplier value for an LSB in this 24-bit
                                                            register is:
This register is a “Don't Care” if EN_OFFCAL = 0
(offset calibration disabled), but its value is not cleared EQUATION 5-10:
by the EN_OFFCAL bit.                                                     GAIN (1LSB) = 1/8388608
                                                            This register is a “Don't Care” if EN_GAINCAL = 0
                                                            (offset calibration disabled), but its value is not cleared
                                                            by the EN_GAINCAL bit.
                                                            The output data is kept to either 7FFF or 8000 (16-bit
                                                            mode) or 7FFFFF or 800000 (24-bit mode) if the output
                                                            results are out of bounds after all calibrations are
                                                            performed.
 2014 Microchip Technology Inc.                                                                  DS20005287A-page 41


MCP3918
NOTES:
DS20005287A-page 42  2014 Microchip Technology Inc.


                                                                                            MCP3918
 6.0       SPI SERIAL INTERFACE                              The MCP3918 digital interface is capable of handling
                                                             various continuous read and write modes, which allow
           DESCRIPTION
                                                             the device to perform ADC data streaming or full
                                                             register map writing within only one communication
 6.1       Overview                                          (and therefore with only one unique Control byte). The
 The MCP3918 device includes a four-wire (CS, SCK,           internal registers can be grouped together with various
 SDI, SDO) digital serial interface that is compatible with  configurations through the READ<1:0> and WRITE
 SPI Modes 0,0 and 1,1. Data is clocked out of the           bits. The internal address counter of the serial interface
 MCP3918 on the falling edge of SCK, and data is             can be automatically incremented with no additional
 clocked into the MCP3918 on the rising edge of SCK.         Control byte needed, in order to loop through the
 In these modes, the SCK clock can idle either high (1,1)    various groups of registers within the register map. The
 or low (0,0). The digital interface is asynchronous with    groups are defined in Table 9-2.
 the MCLK clock that controls the ADC sampling and           The MCP3918 device also includes advanced security
 digital filtering. All the digital input pins are           features to secure each communication, to avoid
 Schmitt-triggered to avoid system noise perturbations       processing unwanted write commands in order to
 on the communications.                                      change the desired configuration, and to alert the user
 Each independent SPI communication starts with a CS         in case of a change in the desired configuration.
 falling edge and stops with the CS rising edge. When        Each SPI read communication can be secured through
 CS is logic high, SDO is in high-impedance, there are       a selectable CRC-16 checksum provided on the SDO
 transitions on SCK, and SDI has no effect. Changing         pin at the end of every communication sequence. This
 from an SPI Mode 1,1 to an SPI Mode 0,0 and vice            CRC-16 computation is compatible with the DMA CRC
 versa is possible and can be done while the CS pin is       hardware of the PIC24 and PIC32 MCUs, resulting in
 logic high. Any CS rising edge clears the                   no additional overhead for added security.
 communication and resets the SPI digital interface.         In order to secure the entire configuration of the device,
 Additional control pins (RESET, DR) are also provided       the MCP3918 includes an 8-bit lock code
 on separate pins for advanced communication                 (LOCK<7:0>), which blocks all write commands to the
 features. The Data Ready pin (DR) outputs pulses            full register map if the value of the LOCK<7:0> is not
 when a new ADC channel data is available for reading,       equal to a defined password (0xA5). The user can
 which can be used as an interrupt for an MCU. The           protect its configuration by changing the LOCK<7:0>
 master reset pin (RESET) acts like a hard reset and         value to 0x00 after the full programming, so that no
 can reset the part to its default power-up configuration    unwanted write command will result in a change in the
 (equivalent to a POR state).                                configuration (because LOCK<7:0> is different from
 The MCP3918 interface has a simple command                  the 0xA5 password).
 structure. Every command is either a Read command           An additional CRC-16 calculation is also running
 from a register or a Write command to a register. The       continuously in the background to ensure the integrity
 MCP3918 device includes nine registers defined in the       of the full register map. All writable registers of the
 register map in Table 9-1. The register map is fully        register map (except for the MOD register) are
 compatible with the MCP391X family to allow easy            processed through a CRC-16 calculation engine and
 porting of MCU code from one design to another inside       give a CRC-16 checksum that depends on the
 the MCP391X family. The first byte (8-bit wide)             configuration. This checksum is readable on the
 transmitted is always the Control byte that defines the     LOCK/CRC register and updated at all times. If a
 address of the register and the type of command (Read       change in this checksum occurs, a selectable interrupt
 or Write). It is followed by the register itself, which can can give a flag on the DR pin (the DR pin becomes logic
 be in a 16-, 24- or 32-bit format, depending on the         low) to warn the user that the configuration is
 multiple format settings defined in the STATUSCOM           corrupted.
 register. The MCP3918 is compatible with multiple
 formats that help reduce overhead in the data handling
 for most MCUs and processors available on the market
 (8-, 16- or 32-bit MCUs) and improve MCU-code
 compaction and efficiency.
 2014 Microchip Technology Inc.                                                                DS20005287A-page 43


MCP3918
6.2      Control Byte                                                                                                                                               6.3                                                 Reading from the Device
The Control byte of the MCP3918 contains two device                                                                                                                 The first register read on the SDO pin is the one defined
Address bits (A<6:5>), five register Address bits                                                                                                                   by the address (A<4:0>) given in the Control byte. After
(A<4:0>) and a Read/Write bit (R/W). The first byte                                                                                                                 this first register is fully transmitted, if the CS pin is
transmitted to the MCP3918 in any communication is                                                                                                                  maintained logic low, the communication continues
always the Control byte. During the Control byte                                                                                                                    without an additional Control byte and the SDO pin
transfer, the SDO pin is always in a high-impedance                                                                                                                 transmits another register with the address
state. The MCP3918 interface is device addressable                                                                                                                  automatically incremented.
(through A<6:5>), so that multiple chips can be present                                                                                                             Four different read mode configurations can be defined
on the same SPI bus with no data bus contention, even                                                                                                               through the READ<1:0> bits in the STATUSCOM
if they use the same CS pin and a provided half-duplex                                                                                                              register for the address increment (see Section 6.5
SPI interface, with a different address identifier. This                                                                                                            “Continuous Communications, Looping on
functionality enables, for example, a Serial EEPROM                                                                                                                 Register Sets” and Table 9-2). The data on SDO is
like 24AAXXX/24LCXXX or 24FCXXX. Moreover, it                                                                                                                       clocked out of the MCP3918 on the falling edge of
enables the MCP3918 to share all the SPI pins and to                                                                                                                SCK. The reading format for each register is defined in
consume less I/O pins in the application processor,                                                                                                                 Section 5.5 “ADC Output Coding”.
since all these Serial EEPROM circuits use
A<6:5> = 00.
 A<6> A<5> A<4> A<3> A<2> A<1> A<0> R/W
 Device                       Register Address                                             Read/
 Address                                                                                   Write
FIGURE 6-1:                    Control Byte.
The default device address bits are A<6:5> = 01
(contact the Microchip factory for other available device
address bits). For more information, see the Product
Identification System section. The register map is
defined in Table 9-1.
       CS
                                  Device latches SDI on rising edge                                      Device latches SDO on falling edge
      SCK
       SDI       Don’t care      A<6>   A<5>   A<4>   A<3>   A<2>   A<1>   A<0>      R/W                                                                                                                                             Don’t care
                                                                                              DATA<23>    DATA<22>   DATA<21>   DATA<20>   DATA<19>   DATA<18>   DATA<17>   DATA<16>   DATA<15>   DATA<14>   DATA<13>   DATA<12>   DATA<11>   DATA<10>   DATA<9>   DATA<8>   DATA<7>   DATA<6>    DATA<5>   DATA<4>   DATA<3>   DATA<2>   DATA<1>
                                           High
                                           Hi-Z Z                                                                                                                                                                                                                                                                                                             High
                                                                                                                                                                                                                                                                                                                                                               Hi-ZZ
      SDO                                                                                                                                                                                                                                                                                                                                           DATA<0>
                                                                                  READ Communication (SPI mode 1,1)
FIGURE 6-2:                    Read on a Single Register with 24-bit Format (WIDTH_DATA<1:0> = 01,
SPI Mode 1,1).
DS20005287A-page 44                                                                                                                                                                                                                                                                               2014 Microchip Technology Inc.


                                                                                                                                                                                                                                                                                                                                                        MCP3918
        CS
                                       Device latches SDI on rising edge                                                     Device latches SDO on falling edge
       SCK
        SDI       Don’t care       A<6>     A<5>     A<4>     A<3>     A<2>     A<1>     A<0>   R/W                                                                                                                                            Don’t care
                                                                                                                               DATA<22>     DATA<21>     DATA<20>     DATA<19>    DATA<18>    DATA<17>    DATA<16>    DATA<15>   DATA<14>   DATA<13>   DATA<12>   DATA<11>   DATA<10>   DATA<9>   DATA<8>   DATA<7>   DATA<6>    DATA<5>    DATA<4>    DATA<3>    DATA<2>    DATA<1>     DATA<0>
                                 High
                                 Hi-Z
                                      Z                                                                                                                                                                                                                                                                                                                                                                          High
                                                                                                                                                                                                                                                                                                                                                                                                                  Hi-Z Z
      SDO                                                                                              DATA<23>                                                                                                                                                                                                                                                                                     Don’t care
                                                                                                READ Communication (SPI mode 0,0)
FIGURE 6-3:                    Read on a Single Register with 24-bit Format (WIDTH_DATA<1:0> = 01,
SPI Mode 0,0).
6.4       Writing to the Device                                                                                                                                                                Two different write mode configurations for the address
                                                                                                                                                                                               increment can be defined through the WRITE bit in the
The first register written from the SDI pin to the device                                                                                                                                      STATUSCOM register (see Section 6.5 “Continuous
is the one defined by the address (A<4:0>) given in the                                                                                                                                        Communications, Looping on Register Sets” and
Control byte. After this first register is fully transmitted,                                                                                                                                  Table 9-2). The SDO pin stays in a high-impedance
if the CS pin is maintained logic low, the communication                                                                                                                                       state during a write communication. The data on SDI is
continues without an additional Control byte and the                                                                                                                                           clocked into the MCP3918 on the rising edge of SCK.
SDI pin transmits another register with the address                                                                                                                                            The writing format for each register is defined in
automatically incremented.                                                                                                                                                                     Section 5.5 “ADC Output Coding”. A write on an
                                                                                                                                                                                               undefined or non-writable address, such as the ADC
                                                                                                                                                                                               channel register address, will have no effect nor will it
                                                                                                                                                                                               increment the address counter.
       CS
                                 Device latches SDI on rising edge
      SCK
                                                                                                                  DATA<23>   DATA<22>     DATA<21>     DATA<20>     DATA<19>     DATA<18>    DATA<17>    DATA<16>    DATA<15>    DATA<14>   DATA<13>   DATA<12>   DATA<11>   DATA<10>   DATA<9>   DATA<8>   DATA<7>    DATA<6>    DATA<5>    DATA<4>    DATA<3>    DATA<2>     DATA<1>
                                                                                                                                                                                                                                                                                                                                                                                                                  Don’t
       SDI       Don’t care     A<6>      A<5>     A<4>     A<3>     A<2>     A<1>     A<0>           R/W                                                                                                                                                                                                                                                                                          DATA<0>
                                                                                                                                                                                                                                                                                                                                                                                                                  care
                                                                                                                                                                                 Hi-Z High Z
      SDO
                                                                                          WRITE Communication (SPI mode 1,1)
FIGURE 6-4:                    Write to a Single Register with 24-bit Format (WIDTH_CRC = 0, SPI Mode 1,1).
 2014 Microchip Technology Inc.                                                                                                                                                                                                                                                                                                                                             DS20005287A-page 45


MCP3918
      CS
                             Device latches SDI on rising edge
    SCK
                                                                                              DATA<22>   DATA<21>   DATA<20>   DATA<19>   DATA<18>   DATA<17>   DATA<16>   DATA<15>   DATA<14>   DATA<13>   DATA<12>   DATA<11>   DATA<10>   DATA<9>   DATA<8>   DATA<7>   DATA<6>   DATA<5>   DATA<4>   DATA<3>   DATA<2>   DATA<1>   DATA<0>
     SDI      Don’t care    A<6>   A<5>   A<4>   A<3>   A<2>   A<1>   A<0>   R/W   DATA<23>                                                                                                                                                                                                                                                      Don’t care
                                                                                                                                          High
                                                                                                                                          Hi-Z Z
    SDO
                                                                         WRITE Communication (SPI mode 0,0)
FIGURE 6-5:                Write to a Single Register with 24-bit Format (WIDTH_CRC = 0, SPI Mode 0,0).
DS20005287A-page 46                                                                                                                                                                                                                                                            2014 Microchip Technology Inc.


                                                                                                                                                                MCP3918
6.5       Continuous Communications,                                                                                pin returns logic high. The SPI internal register address
          Looping on Register Sets                                                                                  pointer starts by transmitting/receiving the address
                                                                                                                    defined in the Control byte. After this first
The MCP3918 digital interface can process                                                                           transmission/reception, the SPI internal register
communications in Continuous mode, without having                                                                   address pointer automatically increments to the next
to enter an SPI command between each read or write                                                                  available address in the register set for each
to a register. This feature allows the user to reduce                                                               transmission/reception. When it reaches the last
communication overhead to the strict minimum, which                                                                 address in the set, the communication sequence is
diminishes EMI emissions and reduces switching noise                                                                finished. The address pointer loops automatically back
in the system.                                                                                                      to the first address of the defined set and restarts a new
The registers can be grouped into multiple sets for                                                                 sequence with auto-increment (see Table 6-6). The
continuous communications. The grouping of the                                                                      undefined or unused addresses are automatically
registers in the different sets is defined by the                                                                   jumped by the address pointer (they are not considered
READ<1:0> and WRITE bits that control the internal                                                                  to be part of the register map by the address pointer).
SPI communication address pointer. For a graphical                                                                  This internal address pointer automatic selection
representation of the register map sets in the function                                                             allows the following functionality:
of the READ<1:0> and WRITE bits, please see                                                                         •  Read one ADC channel data continuously
Table 9-2.                                                                                                          •  Continuously read the entire register map
In the case of a continuous communication, there is                                                                 •  Continuously read or write each separate register
only one Control byte on SDI to start the                                                                           •  Continuously read or write all configuration
communication after a CS pin falling edge. The part                                                                    registers
stays within the same communication loop until the CS
    CS
                                                                                                                                                                        ADDRESS SET
  SCK                                8x            24x       24x                  ...           24x             24x          24x                  ...     24x         ADDR
                                                                                                                                                                     ADDR + 1
                                                                                                                                                                                 Complete
                                                                                                                                                                                 READ
                              CONTROL                                                                                                                                            sequence
   SDI    Don’t care
                                  BYTE
                                                                                                    Don’t care                                                          ...
                           Starts read sequence
                             at address ADDR
                                                                                                                                                                     ADDR + n
                                                                                                                                                                                 Roll-over
                     High Z
                      Hi-Z
  SDO                                             ADDR    ADDR + 1                ...        ADDR + n         ADDR        ADDR + 1                ...  ADDR + n
                                                           Complete READ sequence                                          Complete READ sequence
                                                 Continuous READ communication (24-bit format)
   CS
                                                                                                                                                                        ADDRESS SET
  SCK                              8x             24x       24x                  ...           24x             24x          24x                  ...     24x          ADDR
                                                                                                                                                                     ADDR + 1
                                                                                                                                                                                 Complete
                                                                                                                                                                                 WRITE
                            CONTROL                                                                                                                                              sequence
   SDI   Don’t care
                                 BYTE
                                                 ADDR    ADDR + 1                ...        ADDR + n         ADDR        ADDR + 1                ...  ADDR + n          ...
                          Starts write sequence              Complete WRITE sequence                                         Complete WRITE sequence
                            at address ADDR
                                                                                                                                                                     ADDR + n
                                                                                                                                                                                 Roll-over
                                                                                        High
                                                                                      Hi-Z   Z
 SDO
                                                Continuous WRITE communication (24-bit format)
FIGURE 6-6:                                  Continuous Communication Sequences.
 2014 Microchip Technology Inc.                                                                                                                                 DS20005287A-page 47


MCP3918
6.5.1        CONTINUOUS READ
                                                                                             Note:          For continuous reading of ADC data in
The STATUSCOM register contains the loop settings                                                           SPI Mode 0,0 (see Figure 6-7), once the
for the internal register address pointer (READ<1:0>                                                        data has been completely read after a
bits and WRITE bit). For the Continuous Read modes,                                                         data ready pulse, the SDO pin will take the
the address selection can take the four following                                                           MSB value of the previous data at the end
values:                                                                                                     of the reading (falling edge of the last SCK
TABLE 6-1:         ADDRESS SELECTION IN                                                                     clock). If SCK stays idle at logic low (by
                                                                                                            definition of Mode 0,0), the SDO pin will
                   CONTINUOUS READ
                                                                                                            be updated at the falling edge of the next
                   Register Address Set Grouping                                                            Data Ready pulse (synchronously with the
   READ<1:0>              for Continuous Read                                                               DR pin falling edge with an output timing
                            Communications                                                                  of tDODR) with the new MSB of the data
       00         Static (No incrementation)                                                                corresponding to the Data Ready pulse.
                                                                                                            This mechanism allows the MCP3918 to
       01         Groups                                                                                    continuously read ADC data outputs
       10         Types (Default)                                                                           seamlessly, even in SPI Mode (0,0).
       11         Full Register Map
                                                                                        In SPI Mode (1,1), the SDO pin stays in the last state
No SDI data coming after the Control byte is                                            (LSB of previous data) after a complete reading, which
considered during a continuous read communication.                                      also allows seamless Continuous Read mode (see
The following figures represent a typical, continuous                                   Figure 6-8).
read communication with the default settings
(READ<1:0> = 10, WIDTH_DATA<1:0> = 01) for SPI
Mode 0,0 (Figure 6-7) and SPI Mode 1,1 (Figure 6-8).
                        CS
                       SCK                          8x            24x                                  24x
                        SDI    Don’t care          0x01                                     Don’t care
                                          Starts read sequence at
                                               address 00000
                                          Hi-Z                                    Stays at
                       SDO                                      DATA_CH0
                                                                              DATA_CH<0>
                                                                                                   DATA_CH0
                                                         Complete READ sequence on           Complete READ sequence on
                                                           the ADC output channel               new ADC output channel
                        DR
FIGURE 6-7:             Typical Continuous Read Communication (WIDTH_DATA<1:0> = 01, SPI Mode 0,0).
                        CS
                      SCK                                 8x                24x                                        24x
                       SDI      Don’t care               0x01                                  Don’t care
                                              Starts read sequence at
                                                    address 00000
                                                        Hi-Z                            DATA_CH0 DATA_CH0
                      SDO                                              DATA_CH0             <23>         <23>      DATA_CH0
                                                                                           Old data    New data
FIGURE 6-8:             Typical Continuous Read Communication (WIDTH_DATA<1:0> = 01, SPI Mode 1,1).
DS20005287A-page 48                                                                                                         2014 Microchip Technology Inc.


                                                                                          MCP3918
6.5.2         CONTINUOUS WRITE                            6.7       Data Ready Pin (DR)
The STATUSCOM register contains the write loop            To communicate when channel data is ready for
settings for the internal register address pointer        transmission, the Data Ready signal is available on the
(WRITE). For the Continuous Write modes, the              Data Ready (DR) pin at the end of a conversion. The
address selection can take the two following values:      DR pin outputs an active-low pulse with a pulse width
                                                          equal to half a DMCLK clock period. After a Data Ready
TABLE 6-2:           ADDRESS SELECTION IN
                                                          pulse falling edge has occurred, the ADC output data is
                     CONTINUOUS WRITE                     updated within the tDODR timing and can then be read
                  Register Address Set Grouping for       through SPI communication.
   WRITE
                 Continuous Write Communications          The first Data Ready pulse after a Hard or a Soft Reset
       0       Static (No incrementation)                 is located after the settling time of the sinc filter (see
                                                          Table 5-4) plus the phase delay of the corresponding
       1       Types (Default)
                                                          channel (see Section 5.11 “Crystal Oscillator”).
SDO is always in a high-impedance state during a          Each subsequent pulse is then periodic, and the period
continuous write communication. Writing to a              is equal to a DRCLK clock period (see Equation 4-3
non-writable address (such as addresses 0x00 to 0x07      and Figure 1-3). The Data Ready pulse is always
or any of the unused register’s addresses) has no         synchronous with the internal DRCLK clock.
effect and does not increment the address pointer. In
                                                          The DR pin can be used as an interrupt pin when
this case, the user needs to stop the communication
                                                          connected to an MCU or DSP, which will synchronize
and restart a communication with a Control byte
                                                          the readings of the ADC data outputs. When not
pointing to a writable address (0x08 to 0x1F).
                                                          active-low, this pin can be either in high-impedance
                                                          (when DR_HIZ = 0) or in a defined logic high state
   Note:      When LOCK<7:0> is different from 0xA5,      (when DR_HIZ = 1). This is controlled through the
              all the addresses, except for 0x1F,         STATUSCOM register. This allows multiple devices to
              become non-writable (see Section 6.10       share the same DR pin (with a pull-up resistor
              “Locking/Unlocking Register Map             connected between DR and DVDD). If only the
              Write Access”)                              MCP3918 device is connected on the interrupt bus, the
                                                          DR pin does not require a pull-up resistor, and
6.6        Situations that Reset and Restart              therefore it is recommended to use the DR_HIZ = 1
           Active ADC                                     configuration for such applications.
Immediately after the following actions, the active ADC   The CS pin has no effect over the DR pin, which means
(the ones not in Soft Reset or Shutdown modes) is         that, even if the CS pin is logic high, the Data Ready
reset and automatically restarted in order to provide     pulses coming from the active ADC channels will still
proper operation:                                         be provided; the DR pin behavior is independent from
                                                          the SPI interface. While the RESET pin is logic low, the
1.    Change in PHASE register
                                                          DR pin is not active. The DR pin is latched in the logic
2.    Overwrite of the same PHASE register value          low state when the interrupt flag on the CRCREG is
3.    Change in the OSR<2:0> settings                     present to signal that the desired register configuration
4.    Change in the PRE<1:0> settings                     has been corrupted (see Section 6.11 “Detecting
5.    Change in the CLKEXT setting                        Configuration Change through CRC-16 Checksum
6.    Change in the VREFEXT setting                       on Register Map and its Associated Interrupt
                                                          Flag”).
After these temporary resets, the ADC goes back to
normal operation, with no need for an additional
command. Each ADC data output register is cleared
during this process. The PHASE register can be used
to serially soft reset the ADC, without using the RESET
bit in the CONFIG1 register, if the same value is written
in the PHASE register.
 2014 Microchip Technology Inc.                                                             DS20005287A-page 49


MCP3918
6.8         ADC Channel Latching and                      6.9       Securing Read Communications
            Synchronization                                         through CRC-16 Checksum
The ADC data output register (address 0x00) has a         Since power/energy metering systems can generate or
double buffer output structure. The two sets of latches   receive large EMI/EMC interferences and large
in series are triggered by the data ready signal and an   transient spikes, it is helpful to secure SPI
internal signal indicating the beginning of a read        communications as much as possible to maintain data
communication sequence (read start).                      integrity and desired configurations during the lifetime
The first set of latches holds the ADC channel data       of the application.
output register when the data is ready. This behavior is  The communication data on the SDO pin can be
synchronous with the MCLK clock.                          secured through the insertion of a Cyclic Redundancy
The second set of latches ensures that, when reading      Check (CRC) checksum at the end of each continuous
starts on an ADC output, the corresponding data is        reading sequence. The CRC checksum on the
latched, so that no data corruption can occur within a    communications can be enabled or disabled through
read. This behavior is synchronous with the SCK clock.    the EN_CRCCOM bit in the STATUSCOM register. The
If an ADC read has started, in order to read the          CRC message ensures the integrity of the read
following ADC output, the current reading needs to be     sequence bits transmitted on the SDO pin, and the
fully completed (all bits must be read on the SDO pin     CRC checksum is inserted in between each read
from the ADC output data registers).                      sequence (see Figure 6-10).
Since the double output buffer structure is triggered
with two events that depend on two asynchronous
clocks (data ready pulse with MCLK and read start with
SCK), it is recommended to implement one of the three
following methods on the MCU or the processor, in
order to synchronize the reading of the channels:
1.    Use the DR pin pulses as an interrupt: once a
      falling edge occurs on the DR pin, the data is
      available for reading on the ADC output
      registers after the tDODR timing. If this timing is
      not respected, data corruption can occur.
2.    Use a timer clocked with MCLK as a
      synchronization event: since the data ready
      pulse is synchronous with MCLK, the user can
      calculate the position of the data ready pulse
      depending on the PHASE, the OSR<2:0> and
      the PRE<1:0> settings. Again, the tDODR timing
      needs to be added to this calculation, to avoid
      data corruption.
3.    Poll the DRSTATUS bit in the STATUSCOM
      register: this method consists of continuously
      reading the STATUSCOM register and waiting
      for the DRSTATUS bit to be equal to '0'. When
      this event happens, the user can start a new
      communication to read the desired ADC data. In
      this case, no additional timing is required.
The first method is the preferred one, as it can be used
without adding additional MCU code space, but
requires connecting the DR pin to an I/O pin of the
MCU. The two last methods require more MCU code
space and execution time, but they allow synchronizing
the reading of the channels without connecting the DR
pin, which saves one I/O pin on the MCU.
DS20005287A-page 50                                                                2014 Microchip Technology Inc.


                                                                                                                                                                                                         MCP3918
    CS
                                                                                                                                                                                                 ADDRESS SET
                                                  16x/24x/32x      16x/24x/32x                      16x/24x/32x      16x/24x/32x   16x/24x/32x                    16x/24x/32x
   SCK                               8x          Depending on     Depending on          ...        Depending on     Depending on  Depending on         ...       Depending on                   ADDR
                                                  data format      data format                       data format      data format  data format                    data format
                                                                                                                                                                                              ADDR + 1
                                                                                                                                                                                                          Complete
                                                                                                                                                                                                          READ
                              CONTROL                                                                                                                                                                     sequence
    SDI    Don’t care
                                   BYTE
                                                                                                              Don’t care                                                                          ...
                            Starts read sequence
                              at address ADDR
                                                                                                                                                                                              ADDR + n
                                                                                                                                                                                                          Roll-over
                    High
                      Hi-ZZ
  SDO                                                ADDR           ADDR + 1            ...          ADDR + n           ADDR        ADDR + 1           ...         ADDR + n
                                                                     Complete READ sequence                                          Complete READ sequence
                        Continuous READ communication without CRC checksum (EN_CRCCOM=0)
    CS
                                                                                                                                                                                                                    ADDRESS SET
                                                  16x/24x/32x      16x/24x/32x                      16x/24x/32x       16x or 32x   16x/24x/32x    16x/24x/32x                  16x/24x/32x   16x or 32x
   SCK                                8x         Depending on     Depending on          ...        Depending on      Depending on Depending on   Depending on          ...    Depending on  Depending on          ADDR
                                                  data format      data format                       data format      CRC format   data format    data format                  data format   CRC format
                                                                                                                                                                                                                ADDR + 1
                                                                                                                                                                                                                              Complete
                                                                                                                                                                                                                              READ
                               CONTROL                                                                                                                                                                                        sequence
    SDI    Don’t care
                                   BYTE
                                                                                                              Don’t care                                                                                            ...
                            Starts read sequence
                              at address ADDR
                                                                                                                                                                                                                ADDR + n
                      High
                       Hi-Z    Z
   SDO                                               ADDR           ADDR + 1            ...           ADDR + n     CRC Checksum      ADDR          ADDR + 1            ...      ADDR + n   CRC Checksum     CRC Checksum   (not part of register map)
                                                                                                                                                                                                                              Roll-over
                                                        Complete READ sequence = Message for CRC Calculation           Checksum                            New Message                      New Checksum
                            Continuous READ communication with CRC checksum (EN_CRCCOM=1)
FIGURE 6-9:                                       Continuous Read Sequences With and Without CRC Checksum Enabled.
The CRC checksum in the MCP3918 device uses the                                                                                                The CRC computed by the MCP3918 device is fully
16-bit CRC-16 ANSI polynomial as defined in the IEEE                                                                                           compatible with the CRC hardware contained in the
802.3 standard: x16 + x15 + x2 + 1. This polynomial can                                                                                        Direct Memory Access (DMA) peripheral of the PIC24
also be noted as 0x8005. CRC-16 detects all single                                                                                             and PIC32 MCU product lines. The CRC message that
and double-bit errors, all errors with an odd number of                                                                                        should be considered in the PIC® device DMA is the
bits, all burst errors of length 16 or less, and most errors                                                                                   concatenation of the read sequence and its associated
for longer bursts. This allows an excellent coverage of                                                                                        checksum. When the DMA CRC hardware computes
the SPI communication errors that can happen in the                                                                                            this extended message, the resulting checksum should
system, and heavily reduces the risk of a                                                                                                      be 0x0000. Any other result indicates that a
miscommunication, even under noisy environments.                                                                                               miscommunication has happened and that the current
The CRC-16 format displayed on the SDO pin depends                                                                                             communication sequence should be stopped and
on the WIDTH_DATA<1> bit in the STATUSCOM                                                                                                      restarted.
register (see Figure 6-10). It can be either 16-bit or
32-bit format to be compatible with both 16-bit and                                                                                               Note:                 The CRC will be generated only at the end
32-bit MCUs. The CRCREG<15:0> bits calculated by                                                                                                                        of the selected address set, before the
the MCP3918 device are not dependent on the format                                                                                                                      rollover of the address pointer occurs (see
(the device always calculates only a 16-bit CRC                                                                                                                         Figure 6-10).
checksum).                   It              is          recommended                               to            keep
WIDTH_DATA<1> = WIDTH_CRC when the CRC
checksum is enabled. If a 32-bit MCU is used in the
application, it is recommended to use 32-bit formats
(WIDTH_DATA<1> = WIDTH_CRC = 1) only.
                                                   15                              0
  WIDTH_DATA<1> = 0                                 CRCCOM CRCCOM
           16-bit format                              <15:8>             <7:0>
                                                   31                                                                  0
  WIDTH_DATA<1> = 1                                 CRCCOM CRCCOM
           32-bit format                              <15:8>             <7:0>              0x00             0x00
FIGURE 6-10:                                      CRC Checksum Format.
 2014 Microchip Technology Inc.                                                                                                                                                                           DS20005287A-page 51


MCP3918
6.10       Locking/Unlocking Register Map                6.11       Detecting Configuration Change
           Write Access                                             through CRC-16 Checksum on
The MCP3918 digital interface includes an advanced
                                                                    Register Map and its Associated
security feature that allows locking or unlocking the               Interrupt Flag
register map write access. This feature prevents the     In order to prevent internal corruption of the register
miscommunications that can corrupt the desired           and to provide additional security on the register map
configuration of the device, especially an SPI read      configuration, the MCP3918 device includes an
becoming an SPI write because of the noisy               automatic and continuous CRC checksum calculation
environment.                                             on the full register map configuration bits. This
The last register address of the register map            calculation is not the same as the communication CRC
(0x1F: LOCK/CRC) contains the LOCK<7:0> bits. If         checksum described in Section 6.9 “Securing Read
these bits are equal to the password value (which is     Communications through CRC-16 Checksum”.
equal to the default value of 0xA5), the register map    This calculation takes the full register map as the CRC
write access is not locked. Any write can take place and message and outputs a checksum on the
communications are not protected.                        CRCREG<15:0> bits located in the LOCK/CRC
When the LOCK<7:0> bits are different from 0xA5, the     register (address 0x1F).
register map write access is locked. The register map    Since this feature is intended to protect the
and therefore the full device configuration are          configuration of the device, this calculation is run
write-protected. Any write to an address other than      continuously only when the register map is locked
0x1F will yield no result. All the register addresses,   (LOCK<7:0> different from 0xA5, see Section 6.10
except for 0x1F, become read-only. In this case, if the  “Locking/Unlocking Register Map Write Access”).
user wants to change the configuration, the              If the register map is unlocked, the CRCREG<15:0>
LOCK<7:0> bits have to be reprogrammed back to           bits are cleared and no CRC is calculated.
0xA5 before sending the desired write command.           The calculation is fully completed in ten DMCLK
The LOCK<7:0> bits are located in the last register, so  periods and refreshed every ten DMCLK periods
that the user can program the whole register map,        continuously. The CRCREG<15:0> bits are reset when
starting from 0x09 to 0x1E within one continuous write   a POR or a hard reset occurs. All the bits contained in
sequence, and then lock the configuration at the end of  the defined registers from addresses 0x09 to 0x1F are
the sequence with writing all zeros, for example in the  processed by the CRC engine to give the
0x1F address.                                            CRCREG<15:0>. The DRSTATUS bit is set to '1'
                                                         (default) and the CRCREG<15:0> bits are set to '0'
                                                         (default) for this calculation engine, as they could vary
                                                         during the calculation.
                                                         An interrupt flag can be enabled through the EN_INT
                                                         bit in the STATUSCOM register and provided on the DR
                                                         pin when the configuration has changed without a write
                                                         command being processed. This interrupt is a logic low
                                                         state. This interrupt is cleared when the register map is
                                                         unlocked (since CRC calculation is not processed
                                                         anymore).
                                                         At power-up, the interrupt is not present and the
                                                         register map is unlocked. As soon as the user finishes
                                                         writing its configuration, the user needs to lock the
                                                         register map (writing 0x00 for example in the LOCK
                                                         bits) to be able to use the interrupt flag. The
                                                         CRCREG<15:0> bits will be calculated for the first time
                                                         in 10 DMCLK periods. This first value will then be the
                                                         reference checksum value and will be latched
                                                         internally, until a hard reset, a POR or an unlocking of
                                                         the register map happens. The CRCREG<15:0> will
                                                         then be calculated continuously and checked against
                                                         the reference checksum. If the CRCREG<15:0> is
                                                         different from the reference, the interrupt sends a flag
                                                         by setting the DR pin to a logic low state until it is
                                                         cleared.
DS20005287A-page 52                                                                  2014 Microchip Technology Inc.


                                                       MCP3918
6.12      Interface Mode Selection
          (SPI or 2-Wire)
The MCP3918 includes two different digital interfaces:
a standard 4-wire half duplex SPI interface (see
Section 6.0 “SPI Serial Interface Description”) and
a 2-wire interface dedicated for digitally isolated
applications (see Section 7.0 “2-Wire Serial Interface
Description”).
The selection between these two interfaces is possible
only when the CLKEXT bit is high (CLKEXT = 1). This
is the case by default at POR. When the CLKEXT = 1
condition is true, the OSC2/MODE pin becomes the
selection input pin for the Interface mode.
When OSC2/MODE is logic low during the
CLKEXT = 1 condition, the SPI interface is selected.
When OSC2/MODE pin is logic high, the 2-Wire
Interface is selected (see Figure 1-5 for the 2-Wire
mode selection timing diagram).
If OSC2/MODE pin is left floating while CLKEXT = 1,
an internal pull-down (35 µA typical current)
automatically selects the SPI mode as the default
interface.
The MODE selection is not combinatorial, it is latched
at each POR, Hard Reset and Watchdog Time Reset.
In other words, to change from one interface mode to
another, the user needs to create one of these three
resets and change the OSC2/MODE logic input state
before exiting the applied reset.
 2014 Microchip Technology Inc.                        DS20005287A-page 53


MCP3918
NOTES:
DS20005287A-page 54  2014 Microchip Technology Inc.


                                                                                                        MCP3918
7.0       2-WIRE SERIAL INTERFACE                                      The SDO pin becomes the only output of the device
                                                                       and is fully synchronous with the serial/master clock.
          DESCRIPTION
                                                                       The SDO pin is never in high-impedance in this mode,
                                                                       and is by default at logic low when not transmitting
7.1       Overview                                                     data. The SDO pin idles logic low in this mode because
The 2-Wire Interface mode is designed for applications                 most of the digital isolator devices consume less
that require galvanic isolation. It allows a minimum                   current in a logic low state than in a logic high state.
number of digital isolator channels, specifically one                  This effectively reduces the total power consumption of
bi-directional or two unidirectional channels, to be                   a system with digital isolation devices.
connected to the MCP3918 when interfacing through                      When the part has entered 2-Wire mode, the logic pins
an isolation barrier. This functionality reduces the total             RESET, SDI, CS, OSC1 and DR become logic input
system cost in an isolated application system, like a                  pins for the configuration of the device (respectively
polyphase shunt-based energy meter. It is                              OSR0/OSR1/BOOST/GAIN0/GAIN1). These pins
recommended to use the MCP3918 with the 2-Wire                         need to have well-defined logic states for low-power
mode for digitally isolated applications and with the SPI              applications. These pins define the only settings that
mode for other applications where galvanic isolation is                can be modified in 2-Wire mode.
not required.                                                          The MDAT0 pin is always disabled and kept in a
The principle of this 2-Wire interface is simple: it has a             high-impedance state during the 2-Wire Interface
serial clock input pin (SCK/MCLK) and a serial data                    mode. This pin can be grounded for applications using
output pin (SDO), and it automatically sends output                    exclusively the 2-Wire Interface mode so that the
data in packets (frames) at a DRCLK data rate (every                   EMI/EMC susceptibility of the part is improved.
time new data is available on the ADC output). It has no
serial input pin to diminish the number of isolated
channels. At the same time, the serial clock pin SCK
also becomes the master clock (MCLK) input pin of the
device, and the part becomes fully synchronous with
SCK = MCLK. The system then becomes fully
synchronous and can be driven by only one master
clock for multiple phases, which ensures proper
synchronization and constant phase angle between
phases, which is important for an energy metering
application.
                                       ANALOG     DIGITAL
                                                                              SDO
                                                        SINC3                                            Isolator   To SPI Ports
   CH0+                       +                MOD<3:0>                                                              Of an MCU
                                                                           SCK/MCLK
   CH0-                       -
                               PGA      '6
                                     Modulator                  2-wire                                   Isolator
                                                              Interface
                                                                             GAIN0
                                                                             GAIN1         Logic inputs
                                                                             BOOST          connected
                                                                             OSR0           to DVDD or
                                                                             OSR1             DGND
                            MCP3918
                                                                                                                  Main MCU/
                                                                                                                  CPU Board
                                                                                                        Isolation
                                                                                                         Barrier
FIGURE 7-1:              MCP3918 2-Wire Interface Typical Application Schematic.
 2014 Microchip Technology Inc.                                                                            DS20005287A-page 55


MCP3918
7.2        2-Wire Mode Configuration                     7.2.3        GAIN1/GAIN0
           Settings                                      PGA Gain Setting Logic Pins. These inputs are
                                                         Schmitt-triggered.
When the user wants to exclusively use the 2-Wire
Interface mode in digitally isolated applications, the   TABLE 7-3:           CHANNEL 0 GAIN SETTINGS
OSC2 pin should always be in a logic high state,
starting from the power-up of the part. Otherwise, the       GAIN1              GAIN0          CH0 PGA GAIN
user can change the interface mode by toggling the              0                 0                    1
OSC2/MODE pin within a POR, a Hard Reset or a
                                                                0                 1                    8
Watchdog Timer Reset; the MODE is latched when
exiting one of these three types of reset. When the part        1                 0                   16
has entered 2-Wire mode, the entire part configuration          1                 1                   32
keeps its default settings (see Section 9.0 “MCP3918
Internal Registers” for the default settings of all      7.3       2-Wire Communication Protocol
internal registers), except for the configuration of the
Gain in Channel 0, the OSR and the BOOST settings.       In 2-Wire mode, the SCK/MCLK pin needs to be
                                                         clocked continuously at all times for proper operation.
In      2-Wire       mode,       the      input     pins Any change in the clock frequency will lead to
OSR0/OSR1/BOOST/GAIN0/GAIN1 are latched on               degraded THD/SFDR specifications. The part obeys
the OSC2/MODE rising edge and should typically be        the same timing specifications in both SPI and 2-Wire
directly connected to DVDD or DGND, depending on the     Interface mode for SCK/SDO pins. The MCLK
desired configuration. These pins define the only        maximum input frequency is 10 MHz in 2-Wire mode,
configurable settings in 2-Wire mode. If more settings   since the converter still respects Table 5-2 for
are required by the application, it is recommended to    maximum AMCLK frequency (provided the part has
use the SPI mode. The following tables describe the      entered 2-Wire mode at power-up). Since the MCLK is
configuration options for these five pins.               divided internally, the part accepts a wide range of duty
                                                         cycles for the SCK input, provided the serial interface
7.2.1        OSR1/OSR0
                                                         timings are respected.
OSR Setting Logic          Pins.   These     inputs  are
                                                         In 2-Wire Interface mode, communication uses framed
Schmitt-triggered.
                                                         data sets on the SDO to output data at a fixed data rate,
TABLE 7-1:          OSR SETTINGS                         synchronously with SCK, and using only one output
                                                         pin. The frame is different depending on the device and
      OSR1               OSR0                 OSR        the oversampling ratio (OSR) selected. When in
         0                  0                   64       OSR = 64 mode, the MCP3918 frame contains the
                                                         sync bytes (16-bit), one channel of 16-bit ADC data and
         0                  1                  128
                                                         a 16-bit CRC. For OSR = 128 and higher, each frame
         1                  0                  256       is a group of 7 bytes (56 bits), clocked by the serial
         1                  1                  512       clock SCK. Each frame is composed of a sync word (2
                                                         bytes), 24-bit data output word (3 bytes) and CRC. The
7.2.2        BOOST                                       sync word comes first, followed by Channel 0 ADC
                                                         output (DATA_CH0<23:0>) and 16-bit CRC. See
Current Boost Setting Logic Pin. This input is
                                                         Figures 7-1 and 7-2.
Schmitt-triggered.
                                                         As a verification feature, the sync word contains all
TABLE 7-2:          CURRENT BOOST SETTINGS               settings coming from the five logic input pins available
           BOOST PIN                     BOOST           (OSR0/1, GAIN0/1, BOOST), in order to provide the
                                                         user with the information about this configuration. It
                 0                          0.5x         also provides information about the count of the frame
                 1                           1x          through bits CNT0/1, which is useful when the SDO is
                                                         multiplexed at the output of the digital isolators (see
                                                         next paragraph). The sync word also contains an
                                                         additional sync byte (fixed at 0xA5 value) for additional
                                                         security in synchronization and communication.
DS20005287A-page 56                                                                 2014 Microchip Technology Inc.


                                                                                                                                                                                                                                                               MCP3918
             SCK/
             MCLK
                                  OSR1
                                                          CNT1
                                                                  CNT0
                                            G0    BOOST
             SDO          0       OSR0                             1              1
                                                                                  0
                                                                                  0                  1
                                                                                                     0
                                                                                                     1                                                         DATA_CH0<23:0>                                                                             CRCCOM<15:0>
                                   G1                              0
                                                 SYNC WORD (2 Bytes)                                                                               CHANNEL 0 ADC DATA (3 Bytes)                                                                       CRCCOM on Entire Frame (2 Bytes)
                                                                                                                                                                                                  SDO OUTPUT FRAME (7 Bytes, 56x clocks per Frame)
                                                                                                                     FRAME CLOCKING FOR OSR>64
             SCK/
             MCLK
                            0                             CNT1
                                                  BOOST
                                         G1
             SDO           OSR1          G0               CNT0                 0
                                                                               1
                                                                               0              0
                                                                                              1
                                                                                              0                1                         DATA_CH0<15:0>                                                                 CRCCOM<15:0>
                           OSR0                            1
                                                 SYNC WORD (2 Bytes)                                                             CHANNEL 0 ADC DATA (2 Bytes)                                                         CRCCOM on Entire Frame (2 Bytes)
                                                                                                                                           SDO OUTPUT FRAME (6 Bytes, 48x clocks per Frame)
                                                                                                                     FRAME CLOCKING FOR OSR=64
FIGURE 7-2:                                               Frame Word.
                                                                                                                                                                                  3), and retrieved on a single SDO line after the digital
TABLE 7-4:                                  FRAME COUNTER SETTINGS
                                                                                                                                                                                  isolators, provided that the isolators have a chip enable
       CNT1                                        CNT0                                              FRAME NUMBER                                                                 or a multiplexing feature. The frame counter can then
             0                                               0                                                     FRAME0                                                         be used to retrieve the information about which
                                                                                                                                                                                  MCP3918 part is actually being read. After the four
             0                                               1                                                     FRAME1
                                                                                                                                                                                  frames have been transmitted, the SDO pin idles logic
             1                                               0                                                     FRAME2                                                         low to reduce digital isolator power consumption until
             1                                               1                                                     FRAME3                                                         the next data is available. Figure 7-3 displays the
                                                                                                                                                                                  timing diagram for the 2-Wire Interface mode, showing
These four frames can be used to multiplex SDO at the                                                                                                                             all OSR possibilities. Note that the first set of frames is
output of the digital isolators. In this case, up to                                                                                                                              sent only when the first data is ready, which means that
four channels (typically three phases and one neutral                                                                                                                             the settling time of the sinc filter will be elapsed before
for energy metering applications) can be multiplexed.                                                                                                                             sending the first set of frames, as represented in
The output data of each individual MCP3918 device                                                                                                                                 Figure 7-3.
can be attributed to a different frame (FRAME0, 1, 2 or
  OSC2/                 2-Wire Mode
  MODE
                          256x      256x      256x                 256x         256x         256x          256x      256x       256x      256x         256x       256x          256x      256x      256x      256x        256x      256x      256x        256x      256x      256x      256x      256x      256x
                         clocks    clocks    clocks               clocks       clocks       clocks        clocks    clocks     clocks    clocks       clocks     clocks        clocks    clocks    clocks    clocks      clocks    clocks    clocks      clocks    clocks    clocks    clocks    clocks    clocks
 SCK/MCLK
                                                            FRAME0         FRAME0       FRAME0           FRAME0    FRAME0    FRAME0     FRAME0    FRAME0        FRAME0        FRAME0    FRAME0    FRAME0    FRAME0     FRAME0     FRAME0    FRAME0     FRAME0     FRAME0    FRAME0    FRAME0    FRAME0    FRAME0
   SDO       Hi-Z                                           FRAME1
                                                            FRAME2
                                                                           FRAME1
                                                                           FRAME2
                                                                                        FRAME1
                                                                                        FRAME2
                                                                                                         FRAME1
                                                                                                         FRAME2
                                                                                                                   FRAME1
                                                                                                                   FRAME2
                                                                                                                             FRAME1
                                                                                                                             FRAME2
                                                                                                                                        FRAME1
                                                                                                                                        FRAME2
                                                                                                                                                  FRAME1
                                                                                                                                                  FRAME2
                                                                                                                                                                FRAME1
                                                                                                                                                                FRAME2
                                                                                                                                                                              FRAME1
                                                                                                                                                                              FRAME2
                                                                                                                                                                                        FRAME1
                                                                                                                                                                                        FRAME2
                                                                                                                                                                                                  FRAME1
                                                                                                                                                                                                  FRAME2
                                                                                                                                                                                                            FRAME1
                                                                                                                                                                                                            FRAME2
                                                                                                                                                                                                                       FRAME1
                                                                                                                                                                                                                       FRAME2
                                                                                                                                                                                                                                  FRAME1
                                                                                                                                                                                                                                  FRAME2
                                                                                                                                                                                                                                            FRAME1
                                                                                                                                                                                                                                            FRAME2
                                                                                                                                                                                                                                                       FRAME1
                                                                                                                                                                                                                                                       FRAME2
                                                                                                                                                                                                                                                                  FRAME1
                                                                                                                                                                                                                                                                  FRAME2
                                                                                                                                                                                                                                                                            FRAME1
                                                                                                                                                                                                                                                                            FRAME2
                                                                                                                                                                                                                                                                                      FRAME1
                                                                                                                                                                                                                                                                                      FRAME2
                                                                                                                                                                                                                                                                                                FRAME1
                                                                                                                                                                                                                                                                                                FRAME2
                                                                                                                                                                                                                                                                                                          FRAME1
                                                                                                                                                                                                                                                                                                          FRAME2
  (OSR=64)
                                                            FRAME3         FRAME3       FRAME3           FRAME3    FRAME3    FRAME3     FRAME3    FRAME3        FRAME3        FRAME3    FRAME3    FRAME3    FRAME3     FRAME3     FRAME3    FRAME3     FRAME3     FRAME3    FRAME3    FRAME3    FRAME3    FRAME3
                    0               0            0
                         DATA=0                                  DATA=D1   DATA=D2 DATA=D3               DATA=D4   DATA=D5 DATA=D6      DATA=D7   DATA=D8       DATA=D9       DATA=D10 DATA=D11 DATA=D12 DATA=D13 DATA=D14 DATA=D15 DATA=D16 DATA=D17 DATA=D18 DATA=D19 DATA=D20 DATA=D21 DATA=D22
                                                                                                     FRAME0                  FRAME0               FRAME0                      FRAME0              FRAME0               FRAME0               FRAME0                FRAME0              FRAME0              FRAME0
   SDO       Hi-Z                                                                                    FRAME1                  FRAME1               FRAME1
                                                                                                                                                  FRAME2
                                                                                                                                                                              FRAME1
                                                                                                                                                                              FRAME2
                                                                                                                                                                                                  FRAME1
                                                                                                                                                                                                  FRAME2
                                                                                                                                                                                                                       FRAME1
                                                                                                                                                                                                                       FRAME2
                                                                                                                                                                                                                                            FRAME1
                                                                                                                                                                                                                                            FRAME2
                                                                                                                                                                                                                                                                  FRAME1
                                                                                                                                                                                                                                                                  FRAME2
                                                                                                                                                                                                                                                                                      FRAME1
                                                                                                                                                                                                                                                                                      FRAME2
                                                                                                                                                                                                                                                                                                          FRAME1
                                                                                                                                                                                                                                                                                                          FRAME2
 (OSR=128)                                                                                           FRAME2                  FRAME2
                                                                                                     FRAME3                  FRAME3               FRAME3                      FRAME3              FRAME3               FRAME3               FRAME3                FRAME3              FRAME3              FRAME3
                    0                0                      0                           0                             0                    0                       0                       0                   0                     0                    0                    0                  0
                                                                                                     DATA=D1                 DATA=D2              DATA=D3                     DATA=D4             DATA=D5               DATA=D6             DATA=D7               DATA=D8             DATA=D9             DATA=D10
                                                                                                                                                                              FRAME0                                   FRAME0                                     FRAME0                                  FRAME0
   SDO       Hi-Z                                                                                                                                                             FRAME1
                                                                                                                                                                              FRAME2
                                                                                                                                                                                                                       FRAME1
                                                                                                                                                                                                                       FRAME2
                                                                                                                                                                                                                                                                  FRAME1
                                                                                                                                                                                                                                                                  FRAME2
                                                                                                                                                                                                                                                                                                          FRAME1
                                                                                                                                                                                                                                                                                                          FRAME2
 (OSR=256)
                                                                                                                                                                              FRAME3                                   FRAME3                                     FRAME3                                  FRAME3
                    0                        0                                                       0                                            0                                                0                                         0                                         0
                                                                                                                                                                              DATA=D1                                   DATA=D2                                   DATA=D3                                 DATA=D4
                                                                                                                                                                                                                                                                                                          FRAME0
   SDO       Hi-Z                                                                                                                                                                                                                                                                                         FRAME1
                                                                                                                                                                                                                                                                                                          FRAME2
 (OSR=512)
                                                                                                                                                                                                                                                                                                          FRAME3
                    0                                                      0                                                                                              0                                                                                0
                                                                                                                                                                                                                                                                                                           DATA=D1
                        Internal data ready (Data is                                             Data Ready.
                        unsettled). No frame is transmitted                                      New data is available
FIGURE 7-3:                                               MCP3918 2-Wire Communication Protocol.
 2014 Microchip Technology Inc.                                                                                                                                                                                                                                    DS20005287A-page 57


MCP3918
7.4       Watchdog Timer Reset, Resetting
          the Part when in 2-Wire Mode
When the part has entered 2-Wire mode, the Hard
Reset mode functionality is not available because the
RESET pin becomes the logic input for OSR0. If the
user wants to execute a full reset of the part without
doing a POR, the 2-Wire mode incorporates an internal
watchdog timer that automatically performs a full reset
of the part, provided that the timer has elapsed.
The watchdog timer starts synchronously with each
rising edge of SCK/MCLK. If the SCK logic high state is
maintained for a time that is larger than tWATCH, the
watchdog timer circuit forces the full reset of the chip,
which then returns to its default configuration with the
ADC being reset. If the SCK logic high state is
maintained for a time shorter than tWATCH and then
SCK/MCLK toggles to logic low, the internal timer is
cleared, waiting for another rising edge to restart.
The watchdog timer functionality induces a restriction
in the usable range of frequencies on SCK/MCLK. In
order to avoid intermittent resets in all cases, the
minimum SCK/MCLK frequency in 2-Wire Interface
mode is equal to the inverse of the minimum tWATCH
time (1/(2 x 3.6 µs) = 138.9 kHz, if the duty cycle of the
SCK/MCLK is 50%).
The watchdog timer starts only on the rising edge of
SCK/MCLK, not on the falling edge. Maintaining
SCK/MCLK at a logic low state for large periods of time
does not create any watchdog timer resets. A
Watchdog Timer Reset is created only when the
SCK/MCLK state is maintained logic high during a long
enough period of time.
This watchdog timer period permits exiting the 2-Wire
interface, if desired, by toggling the OSC2/MODE pin to
logic low before creating the Watchdog Timer Reset
and maintaining it logic low until the reset occurs.
DS20005287A-page 58                                         2014 Microchip Technology Inc.


                                                                                                                                                                                                                             MCP3918
8.0       BASIC APPLICATION                                                                                                                        The isolator used between MCU and ADC needs to be
                                                                                                                                                   fast enough to support the high-speed clock between
          CONFIGURATION
                                                                                                                                                   MCU and ADC and the data coming from ADC to MCU.
One of the main applications for the MCP3918 is                                                                                                    This is typically the case in a polyphase shunt-based
energy/power measurement in systems where the                                                                                                      power/energy metering or monitoring application. In
ADC sampling the current needs to be isolated from the                                                                                             this case, each phase needs to be isolated from the
rest of the design. Figure 8-1 can be used as a starting                                                                                           rest of the design and, since the sensor is not providing
point for MCP3918 applications.                                                                                                                    this isolation, the isolation needs to be provided at the
For power measurements, since MCP3918 is a                                                                                                         output of the analog front-end.
1-channel ADC, it is recommended to use it for current                                                                                             The MCP3918 device is built to work seamlessly with a
samples acquisition and to use the MCU ADC for                                                                                                     large variety of two-channel unidirectional digital
voltage samples acquisition.                                                                                                                       isolators (opto-couplers, capacitive or inductive
                                                                                                                                                   integrated digital isolators with or without embedded
                                                                                                                                                   power supplies).
       A_3.3A            A_3.3D
                                      U18                                 U7                     5V                                                                   A_3.3D                            3.3D
                L2
                                      MCP1754-3.3V                        VBT1-S5-S5                                                     A_3.3D                                    U21                                          3.3D
                                  2                    3            5                        2                                                                                 8                   1
                                             GND
                                              ND
                                       VOUT VIN                            +Vout +Vin                                                                                               VDD2V
                                                                                                                                                                                        VDD1
                                                                 C63                              C22                                            C60                           7                   2                               C68
                                                                                                                                                              3910A_SDO             VIA VOA               3910A_SDO_MCU/RC3
                             C57                                 4.7uF      DC     DC             4.7uF                                          0.1uF                         6                   3                               0.1uF
                                                                                                                                                            3910A_CLKIN             VOB VIB             3910_CLKIN_MCU_A
                             0.1uF                                   4                       1                                                   0603                          5                   4                               0603
                                            1                              -Vout -Vin                                                                                               GND2G
                                                                                                                                                                                        GND1
                                                                                                                                     A_GNDD                                        FOD8012                                      GND              A_3.3D A_GNDD
                                        A_GNDD                                                  GND                                                               A_GNDD                               GND
                                                           NT3                                                                                                                                                                                  R80
                                                                                                                                                                                                                                           1k
                                                                                                                                                                                                                                                        OSR0
       A_GNDA                                                                                                                                                                                                                               HIGH       3 2 1
                                                                                                                                                                                                                                                               LOW
                                                                                                                                                                                                                                                J24
                                                                                                                                                                                                                                                        OSR1
                                                                                                                                                                                                                                                HIGH   3 2 1   LOW
                                                                                                                      A_GNDA                 A_GNDD
                                  A_GNDA                                         A_GNDA               A_3.3A               A_3.3D                                     U3                                                                        J25
                                                                                                                                                         C52      1                                            20
                                        R3                                                                                                                              RESET / OSR0           SDI / OSR1
                                                                                        C1                                                               0.1uF                                                                                         BOOST
                                                                                        0.1uF                             C43       R76                           2                                            19 R86                           HIGH   3 2 1   LOW
                     CP1                                                                                                  0.1uF     10
                                                                                                                                                                        DVDD                           SDO
                                                                                                                                                                                                                   10
                                                                                                                                                                                                                             3910A_SDO
                                                                                                                                                                                                                                                J26
                 Via_1.6x1              DNP
                                                                     R4                                        R100                                               3                                            18 R87
        LINE_SHUNT1                                                                                                                                                     AVDD                 SCK / MCLK                      3910A_CLKIN
                                                     FB2             1k                                        10                                                                                                  10                                  GAIN0
                                                                                                                                                                  4                                            17                               HIGH   3 2 1   LOW
                                                                                                                                                                        CH0+                  CS / BOOST
                                                                                                                                                                                                                                                J27
                                                                                                                                                                  5                                            16 R79
                                                                                                                                                                        CH0-                 OSC2 / MODE                       A_3.3D
                                                                     R5                                                                                                                                            1k                                  GAIN1
        LINE_SHUNT2
                                                     FB3             1k                                                                                           6                                            15                               HIGH   3 2 1   LOW
                                        R6                                                                                        A_GNDA                                NC                    OSC1/CLKI
                                                                                        C5                                                                                                                                                      J28
                 CP2                                                                    0.1uF                                                                     7                                            14
                 Via_1.6x1                                                                                                        A_GNDA                                NC                    DR / GAIN1
                                        DNP
                                                                                                                                                                  8                                            13
                                                                                                                                  A_GNDA                                AGND                     MDAT0
                                  A_GNDA                                         A_GNDA
                                                                                                                                                                  9                                            12
                                                                                                                                                                        RFIN/OUT+                MDAT1
                                                                                                                                          C46                    10                                            11
                                                                                                                                                                        RFIN-                      DGND
                                                                                                                                         0.1uF
                                                                                                                                                                      MCP3918A1T/ISS
                                                                                                                                          A_GNDA A_GNDA                                                             A_GNDD
                                                                                                                                                                               PHASE A
FIGURE 8-1:                                  MCP3918 Three-Phase Shunt Energy Meter – Typical Application Schematic for Each
Phase.
8.1       Power Supply Design and                                                                                                                  8.2                     Power Supply Design and
          Bypassing                                                                                                                                                        Bypassing
To power the isolated ADC, an isolated DC/DC                                                                                                       The MCP3918 device was designed to measure
converter that can be embedded with the isolated data                                                                                              positive and negative voltages that might be generated
communication channels (as in Figure 8-1) or other                                                                                                 by a current-sensing device. This current-sensing
structures that provide isolated power supplies (e.g.,                                                                                             device, with a common-mode voltage close to 0V, is
fly-back converter) can be used.                                                                                                                   referred to as AGND, which is a shunt or current
For single-phase designs where isolation between                                                                                                   transformer (CT) with burden resistors attached to
ADC and MCU is not required, the SPI connection is                                                                                                 ground.
also available. This SPI interface could also be used                                                                                              The high performance and good flexibility that
with isolators but this would require four isolators                                                                                               characterize this ADC enable it to be used in other
instead of two (for the 2-wire mode) and, therefore, this                                                                                          applications, as long as the absolute voltage on each
configuration is not preferred.                                                                                                                    pin, referred to AGND, stays in the -1V to +1V range.
 2014 Microchip Technology Inc.                                                                                                                                                                                                DS20005287A-page 59


MCP3918
In any system, the analog ICs (such as references or
operational amplifiers) are always connected to the                                                 ID
analog ground plane. The MCP3918 should also be
considered as a sensitive analog component, and                                                       IA
should be connected to the analog ground plane. The
ADC features two pairs of pins: AGND, AVDD, DGND and
                                                                                0.1 μF      0.1 μF   C
DVDD. For best performance, it is recommended to
                                                                                    AVDD DVDD             VA       VD
keep the two pairs connected to two different networks
(Figure 8-2). This way, the design will feature two                    MCU          MCP39XX
                                                                                    AGND  DGND
ground traces and two power supplies (Figure 8-3).
This means the analog circuitry (including MCP3918)                                              IA
and the digital circuitry (MCU) should have separate                             ID
power supplies and return paths to the external ground
reference, as described in Figure 8-2.                                                                   “Star” Point
An example of a typical power supply circuit, with                              D-=      A-=
different lines for analog and digital power, is shown in
Figure 8-3. A possible split example is shown in
                                                                FIGURE 8-2:              All Analog and Digital
Figure 8-4, where the ground star connection can be             Return Paths Need to Stay Separate with Proper
done at the bottom of the device with the exposed pad.          Bypass Capacitors.
The split between analog and digital can be done under
the device, and AVDD and DVDD can be connected
together with lines coming under the ground plane.
Another possibility, sometimes easier to implement in
terms of PCB layout, is to consider the MCP3918 as an
analog component and, therefore, to connect both
AVDD and DVDD together, and AGND and DGND
together, with a star connection. In this scheme, the
decoupling capacitors may be larger, due to the ripple
on the digital power supply (caused by the digital filters
and the SPI interface of the MCP3918) now causing
glitches on the analog power supply.
                         Note:    The “Net Tie” Object NT2 represents the start ground connection.
FIGURE 8-3:              Power Supply with Separate Lines for Analog and Digital Sections.
DS20005287A-page 60                                                                        2014 Microchip Technology Inc.


                                                                                               MCP3918
                                                            The ferrite bead between the digital and analog ground
                                                            planes helps keep high-frequency noise from entering
                                                            the device. This ferrite bead is recommended to be low
                                                            resistance; most often it is a THT component. Ferrite
                                                            beads are typically placed on the shunt inputs and into
                                                            the power supply circuit for additional protection.
                                                            8.3         SPI Interface Digital Crosstalk
                                                            The MCP3918 incorporates a high-speed 20-MHz SPI
                                                            digital interface. This interface can induce a crosstalk,
                                                            if it is running at its full speed without any precautions.
                                                            The crosstalk is caused by the switching noise created
                                                            by the digital SPI signals (also called ground bouncing).
                                                            This crosstalk would negatively impact the SNR in this
                                                            case. The noise is attenuated if a proper separation
                                                            between the analog and digital power supplies is put in
                                                            place (see Section 8.2 “Power Supply Design and
                                                            Bypassing”). In order to further remove the influence
FIGURE 8-4:                Separation of Analog and         of the SPI communication on measurement accuracy,
Digital Circuits on Layout.                                 it is recommended to add series resistors on the SPI
Figure 7-5 shows a more detailed example with a direct      lines to reduce the current spikes caused by the digital
connection to a high-voltage line (e.g., a two-wire 120V    switching noise (see Figure 8-1 where these resistors
or 220V system). A current-sensing shunt is used for        have been implemented). The resistors also help to
current measurement on the high/line side that also         keep the level of electromagnetic emissions low. The
supplies the ground for the system. This is necessary       measurement graphs provided in this data sheet have
as the shunt is directly connected to the channel input     been performed with 100series resistors connected
pins of the MCP3918. To reduce sensitivity to external      on each SPI I/O pin. Measurement accuracy distur-
influences, such as EMI, these two wires should form a      bances have not been observed even at the full speed
twisted pair, as noted in Figure 8-5. The power supply      of 20 MHz interfacing. The crosstalk performance is
and MCU are separated on the right side of the PCB,         dependent on the package choice due to the difference
surrounded by the digital ground plane. The MCP3918         in the pin arrangement (dual in-line or quad), and is
is kept on the left side, surrounded by the analog          improved in the QFN-20 package.
ground plane. There are two separate power supplies
going to the digital section of the system and the analog
section, including the MCP3918. With this placement,
there are two separate current supply paths and
current return paths, IA and ID.
                              IA
       Analog Ground Plane             Digital Ground Plane
                                              ID
        MCP3918                    MCU
                                      ID
                        IA                    VD VA
                                         Power Supply
                                             Circuitry
                                 “Star” Point
  Twisted
     Pair
            SHUNT
    LINE
   NEUTRAL
FIGURE 8-5:                Connection Diagram.
 2014 Microchip Technology Inc.                                                                  DS20005287A-page 61


MCP3918
8.4        Sampling Speed and Bandwidth
If ADC power consumption is not a concern in the
design, the boost settings can be increased for best
performance so that the OSR is always kept at the
maximum settings to improve the SINAD performance
(see Table 7-1). If the MCU cannot generate a clock
fast enough, it is possible to tap the OSC1/OSC2 pins
of the MCP3918 crystal oscillator directly to the crystal
of the microcontroller. When the sampling frequency is
enlarged, the phase resolution is improved, and with
the OSR increased, the phase compensation range             FIGURE 8-6:               First-Order Anti-Aliasing
can be kept in the same range as the default settings.      Filter for CT-Based Designs.
TABLE 8-1:           SAMPLING SPEED VS. MCLK                The di/dt current sensors, such as Rogowski coils, can
                     AND OSR, ADC PRESCALE                  be an alternative to current transformers. Since these
                     1:1                                    sensing      elements       are   highly    sensitive    to
                                              Sampling      high-frequency electromagnetic fields, using a
    MCLK                                                    second-order anti-aliasing filter is recommended to
                  Boost           OSR            Speed
     (MHz)                                                  increase the attenuation of potential perturbing RF
                                                 (ksps)
                                                            signals.
       16          0b11           1024            3.91
       14          0b11           1024            3.42
       12          0b11           1024            2.93
       10          0b10           1024            2.44
       8           0b10            512            3.91
       6           0b01            512            2.93
       4           0b01            256            3.91
8.5        Differential Inputs Anti-Aliasing                FIGURE 8-7:               Second-Order Anti-Aliasing
           Filter                                           Filter for Rogowski Coil-Based Designs.
Due to the nature of the ADC used in the MCP3918            The filter presented in Figure 8-7 is an anti-aliasing
(oversampling converter), each differential input of the    filter. The di/dt integrator can be created in firmware as
ADC channels requires an anti-aliasing filter so that the   a first-order low-pass filter with corner frequency much
oversampling frequency (DMCLK) is largely attenuated        lower than the input signal.
and does not generate any disturbances on the ADC           The MCP3918 is highly recommended in applications
accuracy. This anti-aliasing filter also needs to have a    using di/dt as current sensors because of the extremely
gain close to the one in the signal bandwidth of interest.  low noise floor at low frequencies. In such applications,
Typically, for 50/60 Hz measurement and default             a low-pass filter (LPF) with a cut-off frequency much
settings (DMCLK = 1 MHz), a simple RC filter with           lower than the signal frequency (50/60 Hz for metering)
1 k and 100 nF can be used. The anti-aliasing filter       is used to compensate for the 90 degree shift and for
used for the measurement graphs is a first-order RC         the 20 db/decade attenuation induced by the di/dt
filter with 1 k and 15 nF. The typical schematic for      sensor. Because of this filter, the SNR will be
connecting a current transformer to the ADC is shown        decreased, since the signal will be attenuated by a few
in Figure 8-6. If wires are involved, twisting them is also orders of magnitude, while the low-frequency noise will
recommended.                                                not be attenuated. Usually, a high-order high-pass filter
                                                            (HPF) is used to attenuate the low-frequency noise in
                                                            order to prevent a dramatic degradation of the SNR,
                                                            which can be very important in other parts. A high-order
                                                            filter will also consume a significant portion of the
                                                            computation power of the MCU. When using the
                                                            MCP3918, such a high-order HPF is not required, since
                                                            this part has a low noise floor at low frequencies. A
                                                            first-order HPF is enough to achieve very good
                                                            accuracy.
DS20005287A-page 62                                                                     2014 Microchip Technology Inc.


                                                          MCP3918
8.6       Energy Measurement Error
          Considerations
The measurement error is a typical representation of
the non-linearity of the ADC (see Section 4.0
“Terminology and Formulas” for the definition of
measurement error). The measurement error is
dependent on the THD and on the noise floor of the
ADC. The measurement error specification on the
MCP3918 can be improved by increasing the OSR (to
get a better SINAD and THD performance) and, to
some extent, the BOOST settings (if the bandwidth of
the measurements is too limited by the bandwidth of
the amplifiers in the sigma-delta ADC). In most of the
energy metering AC applications, high-pass filters are
used to cancel the offset on each ADC channel (current
and voltage channels), and therefore a single-point
calibration is necessary to calibrate the system for
active energy measurement. This calibration is a
system gain calibration, and the user can utilize the
EN_GAINCAL bit and the GAINCAL_CH0 register to
perform this digital calibration. After such calibration,
typical measurement error curves like the ones in
Figure 2-7 can be generated by sweeping the current
channel amplitude and measuring the energy at the
outputs (the energy calculations here are being
realized off-chip). The error is measured using a gain of
1x, as it is commonly used in most CT-based
applications.
At low signal amplitude values (typically 1000:1
dynamic range and higher), the crosstalk between
channels, mainly caused by the PCB, becomes a
significant part of the perturbation as the measurement
error increases. The 1-point measurement error curves
in Figure 2-5 have been performed with a full-scale
sine wave on all the inputs that are not measured,
which means that these channels induce a maximum
amount of crosstalk on the measurement error curve.
In order to avoid such behavior, a 2-point calibration
can be put in place in the calculation section.
This 2-point calibration can be a simple linear
interpolation between two calibration points (one at
high amplitudes, one at low amplitudes at each end of
the dynamic range) and helps to significantly lower the
effect of crosstalk between channels. A 2-point
calibration is very effective in maintaining the
measurement error close to zero on the whole dynamic
range, since the non-linearity and distortion of the
MCP3918 is very low. Figure 2-6 shows the
measurement error curves obtained with the same
ADC data taken for Figure 2-5, but where a 2-point
calibration has been applied. The difference is
significant only at the low end of the dynamic range,
where all the perturbing factors are a bigger part of the
ADC output signals. These curves show extremely tight
measurement error across the full dynamic range
(here, typically 10,000:1), which is required in
high-accuracy class meters.
 2014 Microchip Technology Inc.                           DS20005287A-page 63


MCP3918
NOTES:
DS20005287A-page 64  2014 Microchip Technology Inc.


                                                                                                    MCP3918
9.0       MCP3918 INTERNAL                                            The format of the data register (0x00) can be changed
                                                                      through the WIDTH_CRC and WIDTH_DATA<1:0> bits
          REGISTERS
                                                                      in the STATUSCOM register. The READ<1:0> and
The addresses associated with the internal registers                  WRITE bits define the groups and types of registers for
are listed in Table 9-1. This section also describes the              continuous read/write communication or looping on
registers in detail. All registers are 24-bit long registers,         address sets, as shown in Table 9-2.
which can be addressed and read separately.
TABLE 9-1:           MCP3918 REGISTER MAP
  Address             Name              Bits      R/W                                Description
    0x00           CHANNEL0              24         R      Channel 0 ADC Data <23:0>, MSB first
    0x01              Unused             24         U      Unused
    0x02              Unused             24         U      Unused
    0x03              Unused             24         U      Unused
    0x04              Unused             24         U      Unused
    0x05              Unused             24         U      Unused
    0x06              Unused             24         U      Unused
    0x07              Unused             24         U      Unused
    0x08               MOD               24       R/W      Delta-sigma Modulators Output Value
    0x09              PHASE              24         U      Phase Delay Configuration Register
   0x0A               Unused             24         U      Unused
   0x0B                GAIN              24       R/W      Gain Configuration Register
   0x0C          STATUSCOM               24       R/W      Status and Communication Register
   0x0D             CONFIG0              24       R/W      Configuration Register
   0x0E             CONFIG1              24       R/W      Configuration Register
   0x0F          OFFCAL_CH0              24       R/W      Offset Correction Register - Channel 0
    0x10        GAINCAL_CH0              24       R/W      Gain Correction Register - Channel 0
    0x11              Unused             24         U      Unused
    0x12              Unused             24         U      Unused
    0x13              Unused             24         U      Unused
    0x14              Unused             24         U      Unused
    0x15              Unused             24         U      Unused
    0x16              Unused             24         U      Unused
    0x17              Unused             24         U      Unused
    0x18              Unused             24         U      Unused
    0x19              Unused             24         U      Unused
   0x1A               Unused             24         U      Unused
   0x1B               Unused             24         U      Unused
   0x1C               Unused             24         U      Unused
   0x1D               Unused             24         U      Unused
   0x1E               Unused             24         U      Unused
   0x1F            LOCK/CRC              24       R/W      Security Register (password and CRC-16 on Register Map)
 2014 Microchip Technology Inc.                                                                        DS20005287A-page 65


MCP3918
TABLE 9-2:      REGISTER MAP GROUPING FOR ALL CONTINUOUS READ/WRITE MODES
                                                               READ<1:0>                                  WRITE
    Function          Address
                                = ‘11‘                      = ‘10‘   = ‘01‘   = ‘00‘       = ‘1‘            = ‘0‘
   CHANNEL 0          0x00                                  TYPE     GROUP    Static           Not Writable
                                 LOOP ENTIRE REGISTER MAP
      MOD             0x08                                                    Static                       Static
                                                                     GROUP
      GAIN            0x0B                                                    Static                       Static
  STATUSCOM           0x0C                                                    Static                       Static
    CONFIG0           0x0D                                           GROUP    Static                       Static
    CONFIG1           0x0E                                  TYPE              Static      TYPE             Static
  OFFCAL_CH0          0x0F                                                    Static                       Static
                                                                     GROUP
  GAINCAL_CH0         0x10                                                    Static                       Static
    LOCKCRC           0x1F                                           GROUP
                                                                              Static                       Static
DS20005287A-page 66                                                                     2014 Microchip Technology Inc.


                                                                                               MCP3918
9.1      CHANNEL Register –                                     The ADC Channel Data Output register always
         ADC Channel Data                                       contains the most recent A/D conversion data. This
                                                                register is read-only. This register is latched when an
         Output Register
                                                                ADC read communication occurs. When a data ready
                                                                event occurs during a read communication, the most
       Name            Bits        Address        Cof.
                                                                current ADC data is also latched to avoid data
   CHANNEL0             24           0x00          R            corruption issues. The three bytes of each channel are
                                                                updated synchronously at a DRCLK rate. They can be
                                                                accessed separately, if needed, but are refreshed
                                                                synchronously.
REGISTER 9-1:           CHANNEL REGISTER
      R-0             R-0              R-0           R-0         R-0             R-0            R-0             R-0
   DATA_CH0       DATA_CH0         DATA_CH0       DATA_CH0  DATA_CH0          DATA_CH0       DATA_CH0        DATA_CH0
  <23> (MSB)          <22>            <21>          <20>        <19>            <18>            <17>           <16>
bit 23                                                                                                            bit 16
      R-0             R-0              R-0           R-0         R-0             R-0            R-0             R-0
   DATA_CH0       DATA_CH0         DATA_CH0       DATA_CH0  DATA_CH0          DATA_CH0       DATA_CH0        DATA_CH0
      <15>            <14>            <13>          <12>        <11>            <10>            <9>             <8>
bit 15                                                                                                              bit 8
      R-0             R-0              R-0           R-0         R-0             R-0            R-0             R-0
   DATA_CH0       DATA_CH0         DATA_CH0       DATA_CH0  DATA_CH0          DATA_CH0       DATA_CH0        DATA_CH0
      <7>             <6>              <5>           <4>         <3>             <2>            <1>             <0>
bit 7                                                                                                               bit 0
Legend:
R = Readable bit                 W = Writable bit          U = Unimplemented bit, read as ‘0’
-n = Value at POR                ‘1’ = Bit is set          ‘0’ = Bit is cleared            x = Bit is unknown
bit 23-0         DATA_CH0: Output code from ADC. This data is post-calibration if the EN_OFFCAL or EN_GAINCAL
                 bits are enabled. This data can be formatted in 16-/24-/32-bit modes, depending on the WIDTH_-
                 DATA<1:0> settings. (See Section 5.5 “ADC Output Coding”.)
 2014 Microchip Technology Inc.                                                                   DS20005287A-page 67


MCP3918
9.2       MOD Register – Modulators                       The MOD register contains the most recent modulator
          Output Register                                 data output and is updated at a DMCLK rate. The
                                                          default value corresponds to an equivalent input of 0V
      Name          Bits      Address       Cof.          on the ADC. Each bit in this register corresponds to one
                                                          comparator output on one of the channels. This register
       MOD           24         0x08        R/W           should not be written to ensure ADC accuracy.
REGISTER 9-2:         MOD REGISTER
       U-0          U-0          U-0          U-0         U-0             U-0             U-0            U-0
        —            —           —            —           —                —               —              —
 bit 23                                                                                                     bit 16
       U-0          U-0          U-0          U-0         U-0             U-0             U-0            U-0
        —            —           —            —           —                —               —              —
 bit 15                                                                                                      bit 8
      R/W-0        R/W-0       R/W-0        R/W-0       R/W-0            R/W-0           R/W-1          R/W-1
        —            —           —            —     COMP3_CH0         COMP2_CH0      COMP1_CH0       COMP0_CH0
 bit 7                                                                                                       bit 0
 Legend:
 R = Readable bit          W = Writable bit         U = Unimplemented bit, read as ‘0’
 -n = Value at POR         ‘1’ = Bit is set         ‘0’ = Bit is cleared             x = Bit is unknown
 bit 23-4       Unimplemented: Read as ‘0’
 bit 3-0        COMPn_CH0: Comparator Outputs from ADC
DS20005287A-page 68                                                                 2014 Microchip Technology Inc.


                                                                                           MCP3918
9.3      PHASE Register – Phase                               Any write to this register automatically resets and
         Configuration Register                               restarts the active ADC.
     Name            Bits          Address        Cof.
    PHASE             24             0x0A         R/W
REGISTER 9-3:          PHASE REGISTER
      U-0            U-0               U-0            U-0        U-0             U-0        U-0            U-0
       —              —                 —              —         —                —          —             —
bit 23                                                                                                       bit 16
      U-0            U-0               U-0            U-0      R/W-0            R/W-0      R/W-0         R/W-0
       —              —                 —              —   PHASE<11> PHASE<10>          PHASE<9>       PHASE<8>
bit 15                                                                                                         bit 8
     R/W-0          R/W-0             R/W-0         R/W-0      R/W-0            R/W-0      R/W-0         R/W-0
 PHASE<7>         PHASE<6>         PHASE<5>       PHASE<4>  PHASE<3>         PHASE<2>   PHASE<1>       PHASE<0>
bit 7                                                                                                          bit 0
Legend:
R = Readable bit                 W = Writable bit          U = Unimplemented bit, read as ‘0’
-n = Value at POR                ‘1’ = Bit is set          ‘0’ = Bit is cleared         x = Bit is unknown
bit 23-12       Unimplemented: Read as ‘0’
bit 11-0        PHASE<11:0> Conversion Start delay. Delay = (PHASE<11:0> decimal code + OSR/2)/DMCLK.
 2014 Microchip Technology Inc.                                                              DS20005287A-page 69


MCP3918
9.4       GAIN Register – PGA Gain
          Configuration Register
      Name          Bits       Address      Cof.
      GAIN           24         0x0B        R/W
REGISTER 9-4:         GAIN REGISTER
       U-0          U-0          U-0          U-0       U-0             U-0          U-0            U-0
        —           —            —            —         —                —           —               —
 bit 23                                                                                                bit 16
       U-0          U-0          U-0          U-0       U-0             U-0          U-0            U-0
        —           —            —            —         —                —           —               —
 bit 15                                                                                                 bit 8
       U-0          U-0          U-0          U-0       U-0            R/W-0       R/W-0           R/W-0
        —           —            —            —         —           PGA_CH0<2>  PGA_CH0<1> PGA_CH0<0>
 bit 7                                                                                                  bit 0
 Legend:
 R = Readable bit          W = Writable bit       U = Unimplemented bit, read as ‘0’
 -n = Value at POR         ‘1’ = Bit is set       ‘0’ = Bit is cleared          x = Bit is unknown
 bit 23-3       Unimplemented: Read as ‘0’
 bit 2-0        PGA_CH0<2:0>: PGA Setting
                111 = Reserved (Gain = 1)
                110 = Reserved (Gain = 1)
                101 = Gain is 32
                100 = Gain is 16
                011 = Gain is 8
                010 = Gain is 4
                001 = Gain is 2
                000 = Gain is 1 (Default)
DS20005287A-page 70                                                            2014 Microchip Technology Inc.


                                                                                                MCP3918
9.5       STATUSCOM Register - Status and
          Communication Register
       Name            Bits       Address       Cof.
   STATUSCOM            24          0x0C        R/W
REGISTER 9-5:           STATUSCOM REGISTER
    R/W-1          R/W-0          R/W-1        R/W-0            U-0           R/W-0        R/W-0           R/W-1
   READ<1>        READ<0>         WRITE        DR_HIZ            —          WIDTH_ CRC WIDTH_ DATA<1> WIDTH_ DATA<0>
bit 23                                                                                                           bit 16
    R/W-0          R/W-0          R/W-0        R/W-0          R/W-0            U-0           U-0             U-0
 EN_CRCCOM         EN_INT        Reserved      Reserved      EN_MDAT            —             —               —
bit 15                                                                                                            bit 8
      U-0           U-0            U-0           U-0            U-0            U-0           R-1             R-1
       —             —              —             —              —              —             —          DRSTATUS<0>
bit 7                                                                                                             bit 0
Legend:
R = Readable bit              W = Writable bit            U = Unimplemented bit, read as ‘0’
-n = Value at POR             ‘1’ = Bit is set            ‘0’ = Bit is cleared         x = Bit is unknown
bit 23-22      READ<1:0>: Address counter increment setting for Read Communication
               11 = Address counter auto-increments, loops on the entire register map
               10 = Address counter auto-increments, loops on register TYPES (DEFAULT)
               01 = Address counter auto-increments, loops on register GROUPS
               00 =        Address not incremented, continually reads the same single-register address
bit 21         WRITE: Address counter increment setting for Write Communication
               1     = Address counter loops on writable part of the register map (Default)
               0     = Address not incremented, continually writes to the same single-register address
bit 20         DR_HIZ: Data Ready Pin Inactive State Control
               1     = The DR pin state is a logic high when data is NOT ready
               0     = The DR pin state is high-impedance when data is NOT ready (Default)
bit 19         Unimplemented: Read as ‘0’
bit 18         WIDTH_CRC Format for CRC-16 on communications
               1     = 32-bit (CRC-16 code is followed by sixteen zeros). This coding is compatible with CRC
                           implementation in most 32-bit MCUs (including PIC32 MCUs).
               0     = 16-bit (default)
bit 17-16      WIDTH_DATA<1:0>: ADC Data Format Settings for the ADC (see Section 5.5 “ADC Output Coding”)
               11 = 32-bit with sign extension
               10 = 32-bit with zeros padding
               01 = 24-bit (default)
               00 = 16-bit (with rounding)
bit 15         EN_CRCCOM: Enable CRC CRC-16 Checksum on Serial communications
               1     = CRC-16 Checksum is provided at the end of each communication sequence (therefore each
                          communication is longer). The CRC-16 Message is the complete communication sequence
                          (see section Section 6.9 “Securing Read Communications through CRC-16 Checksum”
                          for more details).
               0           =Disabled (Default)
 2014 Microchip Technology Inc.                                                                   DS20005287A-page 71


MCP3918
REGISTER 9-5:       STATUSCOM REGISTER (CONTINUED)
 bit 14      EN_INT: Enable the CRCREG interrupt function
             1    =   The interrupt flag for the CRCREG checksum verification is enabled. The Data Ready pin
                      (DR) will become logic low and stays logic low if a CRCREG checksum error happens. This
                      interrupt is cleared if the LOCK<7:0> value is made equal to the PASSWORD value (0xA5).
             0    = The interrupt flag for the CRCREG checksum verification is disabled. The CRCREG<15:0>
                      bits are still calculated properly and can still be read in this mode.
 bit 13-12   Reserved: These bits should be kept equal to '0' at all times.
 bit 11      EN_MDAT: Enable Modulator Output
             1    =   MDAT0 output is enabled
             0    =   MDAT0 output is disabled (DEFAULT)
 bit 10-1    Unimplemented: Read as ‘0’
 bit 0       DRSTATUS: Data Ready status bit
             DRSTATUS = 1 - Channel CH0 data is not ready (DEFAULT)
             DRSTATUS = 0 - Channel CH0 data is ready. The status bit is set back to '1' after reading the
                                   STATUSCOM register. The status bit is not set back to '1' by the read of the
                                   corresponding channel ADC data.
DS20005287A-page 72                                                                       2014 Microchip Technology Inc.


                                                                                                 MCP3918
9.6      CONFIG0 Register -
         Configuration Register 0
     Name            Bits          Address          Cof.
   CONFIG0            24             0x0D           R/W
REGISTER 9-6:          CONFIG0 REGISTER
    R/W-0          R/W-0           R/W-1           R/W-1        R/W-1           R/W-0         R/W-0           R/W-0
  EN_OFFCAL      EN_GAINCAL      DITHER<1>       DITHER<0>    BOOST<1>         BOOST<0>       PRE<1>          PRE<0>
bit 23                                                                                                            bit 16
    R/W-0          R/W-1           R/W-1            U-0          U-0             U-0           U-0             U-0
    OSR<2>         OSR<1>          OSR<0>            —            —               —              —              —
bit 15                                                                                                              bit 8
    R/W-0          R/W-1           R/W-0           R/W-1        R/W-0           R/W-0         R/W-0           R/W-0
 VREFCAL<7>      VREFCAL<6>     VREFCAL<5>      VREFCAL<4>   VREFCAL<3>       VREFCAL<2>    VREFCAL<1>     VREFCAL<0>
bit 7                                                                                                               bit 0
Legend:
R = Readable bit               W = Writable bit            U = Unimplemented bit, read as ‘0’
-n = Value at POR              ‘1’ = Bit is set            ‘0’ = Bit is cleared           x = Bit is unknown
bit 23          EN_OFFCAL: Enables the 24-bit digital offset error calibration on all channels
                1    = Enabled. This mode does not add any group delay to the ADC data.
                0 = Disabled (Default)
bit 22          EN_GAINCAL: Enables or disables the 24-bit digital gain error calibration on all channels
                1 = Enabled. This mode adds a group delay on all channels of 24 DMCLK periods. All Data Ready
                          pulses are delayed by 24 clock periods, compared to the mode with EN_GAINCAL = 0.
                0 = Disabled (Default)
bit 21-20       DITHER<1:0>: Control for dithering circuit for idle tones cancellation and improved THD on all channels
                11 = Dithering ON, Strength = Maximum (Default)
                10 = Dithering ON, Strength = Medium
                01 = Dithering ON, Strength = Minimum
                00 = Dithering turned OFF
bit 19-18       BOOST<1:0>: Bias Current Selection for the ADC (impacts achievable maximum sampling speed, see
                Table 5-2)
                11 = All channels have current x 2
                10 = All channels have current x 1 (Default)
                01 = All channels have current x 0.66
                00 = All channels have current x 0.5
bit 17-16       PRE<1:0> Analog Master Clock (AMCLK) Prescaler Value
                11 = AMCLK = MCLK/8
                10 = AMCLK = MCLK/4
                01 = AMCLK = MCLK/2
                00 = AMCLK = MCLK (Default)
 2014 Microchip Technology Inc.                                                                     DS20005287A-page 73


MCP3918
REGISTER 9-6:       CONFIG0 REGISTER (CONTINUED)
 bit 15-13    OSR<2:0> Oversampling Ratio for delta-sigma A/D Conversion (ALL CHANNELS, fD/fS)
              111 = 4096 (fD = 244 sps for MCLK = 4 MHz, fS = AMCLK = 1 MHz)
              110 = 2048 (fD = 488 sps for MCLK = 4 MHz, fS = AMCLK = 1 MHz)
              101 = 1024 (fD = 976 sps for MCLK = 4 MHz, fS = AMCLK = 1 MHz)
              100 = 512 (fD = 1.953 ksps for MCLK = 4 MHz, fS = AMCLK = 1 MHz)
              011 = 256 (fD = 3.90625 ksps for MCLK = 4 MHz, fS = AMCLK = 1 MHz) (Default)
              010 = 128 (fD = 7.8125 ksps for MCLK = 4 MHz, fS = AMCLK = 1 MHz)
              001 = 64 (fD = 15.625 ksps for MCLK = 4 MHz, fS = AMCLK = 1 MHz)
              000 = 32 (fD = 31.25 ksps for MCLK = 4 MHz, fS = AMCLK = 1 MHz)
 bit 12-8     Unimplemented: Read as ‘0’
 bit 7-0      VREFCAL<7:0>:    Internal Voltage Temperature coefficient VREFCAL<7:0> value. (See
                              Section 5.6.3 “Temperature Compensation (VREFCAL<7:0>)” for complete
                              description).
DS20005287A-page 74                                                             2014 Microchip Technology Inc.


                                                                                               MCP3918
9.7      CONFIG1 Register –
         Configuration Register 1
     Name            Bits          Address        Cof.
   CONFIG1            24              0x0E        R/W
REGISTER 9-7:          CONFIG1 REGISTER
      U-0            U-0               U-0            U-0              U-0            U-0            U-0          R/W-0
       —              —                 —              —                —             —               —         RESET<0>
bit 23                                                                                                                bit 16
      U-0            U-0               U-0            U-0              U-0            U-0            U-0          R/W-0
       —              —                 —              —                —             —               —        SHUTDOWN<0>
bit 15                                                                                                                  bit 8
     R/W-0          R/W-1              U-0            U-0              U-0            U-0            U-0           U-0
   VREFEXT         CLKEXT               —              —                —             —               —             —
bit 7                                                                                                                   bit 0
Legend:
R = Readable bit                 W = Writable bit                U = Unimplemented bit, read as ‘0’
-n = Value at POR                ‘1’ = Bit is set                ‘0’ = Bit is cleared          x = Bit is unknown
bit 23-17        Unimplemented: Read as ‘0’
bit 16           RESET<0>: Soft Reset mode setting for the ADC
                 = ADC Channel in Soft Reset mode
                 = ADC Channel not in Soft Reset mode
bit 15-9         Unimplemented: Read as ‘0’
bit 8            SHUTDOWN<0>: Shutdown mode setting for the ADC
                 = ADC Channel in Shutdown mode
                 = ADC Channel not in Shutdown mode
bit 7            VREFEXT: Internal Voltage Reference selection bit
                 1 = Internal Voltage Reference Disabled. An external reference voltage needs to be applied across the
                          REFIN+/- pins. The analog power consumption (AIDD) is slightly diminished in this mode since the
                          internal voltage reference is placed in Shutdown mode.
                 0 = Internal Reference enabled. For optimal accuracy, the REFIN+/OUT pin needs proper decoupling
                          capacitors. REFIN- pin should be connected to AGND, when in this mode.
bit 6            CLKEXT: Internal Clock selection bit
                 1 = MCLK is generated externally and should be provided on OSC1 pin: the crystal oscillator is disabled
                          and consumes no current (Default)
                 0 = Crystal oscillator enabled. A crystal must be placed between OSC1 and OSC2 with proper
                          decoupling capacitors. The digital power consumption (DIDD) is increased in this mode due to the
                          oscillator.
bit 5-0          Unimplemented: Read as ‘0’
 2014 Microchip Technology Inc.                                                                    DS20005287A-page 75


MCP3918
9.8       OFFCAL_CH0 and GAINCAL_CH0
          Registers – Digital Offset And
          Gain Error Calibration Registers
         Name          Bits     Address         Cof.
    OFFCAL_CH0         24         0x0F          R/W
   GAINCAL_CH0         24         0x10          R/W
REGISTER 9-8:         OFFCAL_CH0 REGISTER
      R/W-0        R/W-0          R/W-0           ...           R/W-0           R/W-0            R/W-0          R/W-0
  OFFCAL_CH0     OFFCAL_CH0 OFFCAL_CH0            ...       OFFCAL_CH0        OFFCAL_CH0 OFFCAL_CH0          OFFCAL_CH0
       <23>         <22>           <21>                          <3>              <2>              <1>            <0>
 bit 23                                                                                                               bit 0
 Legend:
 R = Readable bit            W = Writable bit            U = Unimplemented bit, read as ‘0’
 -n = Value at POR           ‘1’ = Bit is set            ‘0’ = Bit is cleared                x = Bit is unknown
 bit 23-0       OFFCAL_CH0: Digital Offset calibration value for the corresponding channel CH0. This register is
                                simply added to the output code of the channel bit by bit. This register is 24-bit two's
                                complement MSB first coding. CH0 Output Code = OFFCAL_CH0 + ADC CH0 Output
                                Code. This register is a Don't Care if EN_OFFCAL = 0 (Offset calibration disabled), but
                                its value is not cleared by the EN_OFFCAL bit.
REGISTER 9-9:         GAINCAL_CH0 REGISTER
      R/W-0         R/W-0           R/W-0          ...       R/W-0            R/W-0           R/W-0           R/W-0
 GAINCAL_CH0        GAIN-     GAINCAL_CH0          ...   GAINCAL_CH0 GAINCAL_CH0 GAINCAL_CH0 GAINCAL_CH0
       <23>      CAL_CH0<22>         <21>                      <3>             <2>              <1>             <0>
 bit 23                                                                                                             bit 0
 Legend:
 R = Readable bit             W = Writable bit          U = Unimplemented bit, read as ‘0’
 -n = Value at POR            ‘1’ = Bit is set          ‘0’ = Bit is cleared              x = Bit is unknown
 bit 23-0       GAINCAL_CH0: Digital gain error calibration value for the corresponding channel CH0. This register
                                  is signed 24-bit MSB first format with a range of -1x to +0.9999999x (from 0x80000
                                  to 0x7FFFFF). The gain calibration adds 1x to this register and multiplies it to the
                                  output code of the channel bit by bit, after offset calibration. The range of the gain
                                  calibration is thus from 0x to 1.9999999x (from 0x80000 to 0x7FFFFF). The LSB
                                  corresponds to a 2-23 increment in the multiplier.
                                  ADC Output Code = (GAINCAL_CH0+1)*ADC CH0 Output Code. This register is a
                                  Don't Care if EN_GAINCAL = 0 (Gain calibration disabled) but its value is not
                                  cleared by the EN_GAINCAL bit.
DS20005287A-page 76                                                                        2014 Microchip Technology Inc.


                                                                                                  MCP3918
9.9       SECURITY Register – Password
          and CRC-16 on Register Map
      Name            Bits         Address         Cof.
   LOCK/CRC            24            0x1F         R/W
REGISTER 9-10:         LOCK/CRC REGISTER
     R/W-1         R/W-0           R/W-1          R/W-0            R/W-0            R/W-1        R/W-0           R/W-1
  LOCK<7>         LOCK<6>        LOCK<5>         LOCK<4>         LOCK<3>          LOCK<2>      LOCK<1>         LOCK<0>
bit 23                                                                                                               bit 16
     R/W-0         R/W-0           R/W-0          R/W-0            R/W-0            R/W-0        R/W-0           R/W-0
 CRCREG<15>      CRCREG<14>     CRCREG<13>      CRCREG<12>      CRCREG<11>       CRCREG<10>    CRCREG<9>      CRCREG<8>
bit 15                                                                                                                 bit 8
     R/W-0         R/W-0           R/W-0          R/W-0            R/W-0            R/W-0        R/W-0           R/W-0
  CRCREG<7>      CRCREG<6>       CRCREG<5>      CRCREG<4>        CRCREG<3>        CRCREG<2>    CRCREG<1>      CRCREG<0>
bit 7                                                                                                                  bit 0
Legend:
R = Readable bit               W = Writable bit               U = Unimplemented bit, read as ‘0’
-n = Value at POR              ‘1’ = Bit is set               ‘0’ = Bit is cleared           x = Bit is unknown
bit 23-16       LOCKn<7:0>: Lock Code for the writable part of the register map
                LOCK<7:0> = PASSWORD = 0xA5 (Default value): The entire register map is writable. The
                              CRCREG<15:0> bits and the CRC Interrupt are cleared. No CRC-16 checksum on
                              register map is calculated.
                LOCK<7:0> different from 0xA5: The only writable register is the LOCK/CRC register. All other registers
                             will appear as undefined while in this mode. The CRCREG checksum is calculated
                             continuously and can generate interrupts if the CRC Interrupt EN_INT bit has been
                             enabled. If a write to a register needs to be performed, the user needs to unlock the register
                             map beforehand, by writing 0xA5 to the LOCK<7:0> bits.
bit 15-0        CRCREG<15:0>:         CRC-16 Checksum that is calculated with the writable part of the register map as
                                      a message. This is a read-only 16-bit code. This checksum is continuously
                                      recalculated and updated every 10 DMCLK periods. It is reset to its default value
                                      (0x0000) when LOCK<7:0> = 0xA5.
 2014 Microchip Technology Inc.                                                                       DS20005287A-page 77


MCP3918
NOTES:
DS20005287A-page 78  2014 Microchip Technology Inc.


                                                                                              MCP3918
10.0    PACKAGING INFORMATION
10.1    Package Marking Information
                    20-Lead QFN (4x4x0.9 mm)                                        Example
                                                                                      3918
                PIN 1                                                 PIN 1            A1
                                                                                    E/ML e^^3
                                                                                     415256
           20-Lead SSOP (5.30 mm)                                                        Example
                                                                                         MCP3918A1
                                                                                            E/SS e^^3
                                                                                           1415256
                Legend: XX...X      Customer-specific information
                           Y        Year code (last digit of calendar year)
                           YY       Year code (last 2 digits of calendar year)
                           WW       Week code (week of January 1 is week ‘01’)
                           NNN      Alphanumeric traceability code
                            e3      Pb-free JEDEC designator for Matte Tin (Sn)
                           *        This package is Pb-free. The Pb-free JEDEC designator ( e3 )
                                    can be found on the outer packaging for this package.
                Note:   In the event the full Microchip part number cannot be marked on one line, it will
                        be carried over to the next line, thus limiting the number of available
                        characters for customer-specific information.
 2014 Microchip Technology Inc.                                                                 DS20005287A-page 79


MCP3918
                                      !! " # $%
    &     = & ' !&" & +# *!( !!&    + %&  &#&
               && <>>***'    '> +
 
                                     D                                                          D2
                                                           EXPOSED
                                                                  PAD
                                                                                                                       e
                                                                       E2
                                                               E
                                                         2                  2                                       b
                                                         1                  1
                                                                                                                       K
                                              N                                        N
                                                                  NOTE 1                                       L
                               TOP VIEW                                               BOTTOM VIEW
                                                             A
       A3                                             A1
                                                                 ?&!               @@- -
                                                     '! @'&!        E          EJ          K
                     E"')  %!                                E                        
                     &                                                              /:;
                     J M &                                         Q                  
                     &# %%                                                               /
                     ; &&   +!!                           ,                    -=
                     J U#&                                  -                    :;
                     -$   !##U#&                            -         V                  Q
                     J @&                                                     :;
                     -$   !##@&                                    V                  Q
                     ; &&U#&                                  )         Q          /        ,
                     ; &&@&                                 @         ,                  /
                     ; &&& -$   !##                       X                     Y           Y
  &
  !"#$%&" ' ()"&'"!&) &#*& &  & # 
  +!!*!"&#
 , '! #&    -./
        :;< :!'!   &$&"! **& "&&  !
        -=< % '! ("!"*& "&&  (% % '&  " !! 
                                                                                                      * ;V:
DS20005287A-page 80                                                                                 2014 Microchip Technology Inc.


                                                                                      MCP3918
   &     = & ' !&" & +# *!( !!&    + %&  &#&
              && <>>***'    '> +
 2014 Microchip Technology Inc.                                                           DS20005287A-page 81


MCP3918
             '()* '! + * ''  ,- !! " # $''+ %
    &     = & ' !&" & +# *!( !!&    + %&  &#&
               && <>>***'    '> +
                                           D
                              N
                                                                      E
                                                               E1
          NOTE 1
                              1 2
                                                           e
                                 b
                                                                       c
                A                                              A2
                                                                                                                φ
                  A1
                                                                               L1                                   L
                                                                 ?&!               @@- -
                                                     '! @'&!        E         EJ          K
                     E"')  %!                                E                       
                     &                                                             V/:;
                     J M &                                          Y             Y         
                      ##+     +!!                          V/          /        Q/
                     &# %%                                            /            Y           Y
                     J U#&                                  -                  Q        Q
                      ##+U#&                          -        /          /,        /V
                     J @&                                         V                  /
                     =    &@&                                  @        //          /        /
                     =    & &                                   @                   /-=
                     @#     +!!                                                 Y         /
                     =    &                                            Z           Z          QZ
                     @#U#&                                     )                    Y         ,Q
  &
  !"#$%&" ' ()"&'"!&) &#*& &  & # 
  '! !#-#  &"#' #%!   & "! ! #%!   & "! !!  &$#''  !#
 , '! #&    -./
        :;< :!'!   &$&"! **& "&&  !
        -=< % '! ("!"*& "&&  (% % '&  " !! 
                                                                                                     * ;:
DS20005287A-page 82                                                                                2014 Microchip Technology Inc.


                                                                                           MCP3918
   Note:    For the most current package drawings, please see the Microchip Packaging Specification located at
            http://www.microchip.com/packaging
 2014 Microchip Technology Inc.                                                               DS20005287A-page 83


MCP3918
NOTES:
DS20005287A-page 84  2014 Microchip Technology Inc.


                                        MCP3918
APPENDIX A:            REVISION HISTORY
Revision A (May 2014)
• Original Release of this Document.
 2014 Microchip Technology Inc.         DS20005287A-page 85


                                                                                                                MCP3918
PRODUCT IDENTIFICATION SYSTEM
To order or obtain information, e.g., on pricing or delivery, refer to the factory or the listed sales office.
  PART NO.           XX              X              X              /XX           Examples:
    Device       Address       Tape and Temperature             Package          a)    MCP3918A1-E/ML:         Address Option A1,
                 Options           Reel         Range                                                          Extended Temperature,
                                                                                                               20LD QFN package
                                                                                 b)    MCP3918A1T-E/ML:        Address Option A1,
  Device:                MCP3918A1: One Channel Analog Font End Converter                                      Tape and Reel,
                                                                                                               Extended Temperature,
  Address Options:       XX           A6      A5                                                               20LD QFN package
                         A0      =    0       0
                         A1*     =    0       1                                  a)    MCP3918A1-E/SS:         Address Option A1,
                         A2      =    1       0
                                                                                                               Extended Temperature,
                                                                                                               20LD SSOP package
                         A3      =    1       1
                                                                                 b)    MCP3918A1T-E/SS:        Address Option A1,
                         * Default option. Contact Microchip factory for other                                 Tape and Reel,
                         address options
                                                                                                               Extended Temperature,
                                                                                                               20LD SSOP package
  Tape and Reel:         T    = Tape and Reel
  Temperature Range:     E    = -40°C to +125°C
  Package:               ML = 20-Lead Plastic Quad Flat, No Lead Package –
                                4x4 mm Body with 0.40 mm Contact Length
                                (QFN)
                         SS = 20-Lead Plastic Shrink Small Outline – 5.30
                                mm Body (SSOP)
 2014 Microchip Technology Inc.                                                                                   DS20005287A-page 86


 Note the following details of the code protection feature on Microchip devices:
 •     Microchip products meet the specification contained in their particular Microchip Data Sheet.
 •     Microchip believes that its family of products is one of the most secure families of its kind on the market today, when used in the
       intended manner and under normal conditions.
 •     There are dishonest and possibly illegal methods used to breach the code protection feature. All of these methods, to our
       knowledge, require using the Microchip products in a manner outside the operating specifications contained in Microchip’s Data
       Sheets. Most likely, the person doing so is engaged in theft of intellectual property.
 •     Microchip is willing to work with the customer who is concerned about the integrity of their code.
 •     Neither Microchip nor any other semiconductor manufacturer can guarantee the security of their code. Code protection does not
       mean that we are guaranteeing the product as “unbreakable.”
 Code protection is constantly evolving. We at Microchip are committed to continuously improving the code protection features of our
 products. Attempts to break Microchip’s code protection feature may be a violation of the Digital Millennium Copyright Act. If such acts
 allow unauthorized access to your software or other copyrighted work, you may have a right to sue for relief under that Act.
Information contained in this publication regarding device                  Trademarks
applications and the like is provided only for your convenience             The Microchip name and logo, the Microchip logo, dsPIC,
and may be superseded by updates. It is your responsibility to
                                                                            FlashFlex, KEELOQ, KEELOQ logo, MPLAB, PIC, PICmicro,
ensure that your application meets with your specifications.
                                                                            PICSTART, PIC32 logo, rfPIC, SST, SST Logo, SuperFlash
MICROCHIP MAKES NO REPRESENTATIONS OR                                       and UNI/O are registered trademarks of Microchip Technology
WARRANTIES OF ANY KIND WHETHER EXPRESS OR
                                                                            Incorporated in the U.S.A. and other countries.
IMPLIED, WRITTEN OR ORAL, STATUTORY OR
OTHERWISE, RELATED TO THE INFORMATION,                                      FilterLab, Hampshire, HI-TECH C, Linear Active Thermistor,
INCLUDING BUT NOT LIMITED TO ITS CONDITION,                                 MTP, SEEVAL and The Embedded Control Solutions
QUALITY, PERFORMANCE, MERCHANTABILITY OR                                    Company are registered trademarks of Microchip Technology
FITNESS FOR PURPOSE. Microchip disclaims all liability                      Incorporated in the U.S.A.
arising from this information and its use. Use of Microchip                 Silicon Storage Technology is a registered trademark of
devices in life support and/or safety applications is entirely at           Microchip Technology Inc. in other countries.
the buyer’s risk, and the buyer agrees to defend, indemnify and
                                                                            Analog-for-the-Digital Age, Application Maestro, BodyCom,
hold harmless Microchip from any and all damages, claims,
                                                                            chipKIT, chipKIT logo, CodeGuard, dsPICDEM,
suits, or expenses resulting from such use. No licenses are
                                                                            dsPICDEM.net, dsPICworks, dsSPEAK, ECAN,
conveyed, implicitly or otherwise, under any Microchip
                                                                            ECONOMONITOR, FanSense, HI-TIDE, In-Circuit Serial
intellectual property rights.
                                                                            Programming, ICSP, Mindi, MiWi, MPASM, MPF, MPLAB
                                                                            Certified logo, MPLIB, MPLINK, mTouch, Omniscient Code
                                                                            Generation, PICC, PICC-18, PICDEM, PICDEM.net, PICkit,
                                                                            PICtail, REAL ICE, rfLAB, Select Mode, SQI, Serial Quad I/O,
                                                                            Total Endurance, TSHARC, UniWinDriver, WiperLock, ZENA
                                                                            and Z-Scale are trademarks of Microchip Technology
                                                                            Incorporated in the U.S.A. and other countries.
                                                                            SQTP is a service mark of Microchip Technology Incorporated
                                                                            in the U.S.A.
                                                                            GestIC and ULPP are registered trademarks of Microchip
                                                                            Technology Germany II GmbH & Co. KG, a subsidiary of
                                                                            Microchip Technology Inc., in other countries.
                                                                            All other trademarks mentioned herein are property of their
                                                                            respective companies.
                                                                            © 2014, Microchip Technology Incorporated, Printed in the
                                                                            U.S.A., All Rights Reserved.
                                                                                 Printed on recycled paper.
                                                                            ISBN: 978-1-63276-214-6
  QUALITY MANAGEMENT SYSTEM                                                 Microchip received ISO/TS-16949:2009 certification for its worldwide
                                                                            headquarters, design and wafer fabrication facilities in Chandler and
                CERTIFIED BY DNV                                            Tempe, Arizona; Gresham, Oregon and design centers in California
                                                                            and India. The Company’s quality system processes and procedures
           == ISO/TS 16949 ==
                                                                            are for its PIC® MCUs and dsPIC® DSCs, KEELOQ® code hopping
                                                                            devices, Serial EEPROMs, microperipherals, nonvolatile memory and
                                                                            analog products. In addition, Microchip’s quality system for the design
                                                                            and manufacture of development systems is ISO 9001:2000 certified.
 2014 Microchip Technology Inc.                                                                                        DS20005287A-page 87


                          Worldwide Sales and Service
AMERICAS                  ASIA/PACIFIC               ASIA/PACIFIC                EUROPE
Corporate Office          Asia Pacific Office        India - Bangalore           Austria - Wels
2355 West Chandler Blvd.  Suites 3707-14, 37th Floor Tel: 91-80-3090-4444        Tel: 43-7242-2244-39
Chandler, AZ 85224-6199   Tower 6, The Gateway       Fax: 91-80-3090-4123        Fax: 43-7242-2244-393
Tel: 480-792-7200         Harbour City, Kowloon                                  Denmark - Copenhagen
                                                     India - New Delhi
Fax: 480-792-7277         Hong Kong                                              Tel: 45-4450-2828
                                                     Tel: 91-11-4160-8631
Technical Support:        Tel: 852-2943-5100                                     Fax: 45-4485-2829
                                                     Fax: 91-11-4160-8632
http://www.microchip.com/ Fax: 852-2401-3431
                                                     India - Pune                France - Paris
support
                          Australia - Sydney         Tel: 91-20-3019-1500        Tel: 33-1-69-53-63-20
Web Address:
                          Tel: 61-2-9868-6733                                    Fax: 33-1-69-30-90-79
www.microchip.com                                    Japan - Osaka
                          Fax: 61-2-9868-6755                                    Germany - Dusseldorf
Atlanta                                              Tel: 81-6-6152-7160
                          China - Beijing                                        Tel: 49-2129-3766400
Duluth, GA                                           Fax: 81-6-6152-9310
                          Tel: 86-10-8569-7000                                   Germany - Munich
Tel: 678-957-9614                                    Japan - Tokyo
                          Fax: 86-10-8528-2104                                   Tel: 49-89-627-144-0
Fax: 678-957-1455                                    Tel: 81-3-6880- 3770
                          China - Chengdu                                        Fax: 49-89-627-144-44
Austin, TX                                           Fax: 81-3-6880-3771
                          Tel: 86-28-8665-5511
Tel: 512-257-3370                                    Korea - Daegu
                                                                                 Germany - Pforzheim
                          Fax: 86-28-8665-7889                                   Tel: 49-7231-424750
Boston                                               Tel: 82-53-744-4301
Westborough, MA           China - Chongqing          Fax: 82-53-744-4302         Italy - Milan
Tel: 774-760-0087         Tel: 86-23-8980-9588                                   Tel: 39-0331-742611
                                                     Korea - Seoul
Fax: 774-760-0088         Fax: 86-23-8980-9500                                   Fax: 39-0331-466781
                                                     Tel: 82-2-554-7200
Chicago                   China - Hangzhou           Fax: 82-2-558-5932 or       Italy - Venice
Itasca, IL                Tel: 86-571-8792-8115      82-2-558-5934               Tel: 39-049-7625286
Tel: 630-285-0071         Fax: 86-571-8792-8116                                  Netherlands - Drunen
                                                     Malaysia - Kuala Lumpur
Fax: 630-285-0075         China - Hong Kong SAR      Tel: 60-3-6201-9857         Tel: 31-416-690399
Cleveland                 Tel: 852-2943-5100         Fax: 60-3-6201-9859         Fax: 31-416-690340
Independence, OH          Fax: 852-2401-3431                                     Poland - Warsaw
                                                     Malaysia - Penang
Tel: 216-447-0464         China - Nanjing                                        Tel: 48-22-3325737
                                                     Tel: 60-4-227-8870
Fax: 216-447-0643         Tel: 86-25-8473-2460       Fax: 60-4-227-4068          Spain - Madrid
Dallas                    Fax: 86-25-8473-2470                                   Tel: 34-91-708-08-90
                                                     Philippines - Manila
Addison, TX               China - Qingdao                                        Fax: 34-91-708-08-91
                                                     Tel: 63-2-634-9065
Tel: 972-818-7423         Tel: 86-532-8502-7355      Fax: 63-2-634-9069          Sweden - Stockholm
Fax: 972-818-2924
                          Fax: 86-532-8502-7205                                  Tel: 46-8-5090-4654
                                                     Singapore
Detroit                   China - Shanghai           Tel: 65-6334-8870           UK - Wokingham
Novi, MI                  Tel: 86-21-5407-5533       Fax: 65-6334-8850           Tel: 44-118-921-5800
Tel: 248-848-4000         Fax: 86-21-5407-5066
                                                     Taiwan - Hsin Chu           Fax: 44-118-921-5820
Houston, TX
                          China - Shenyang           Tel: 886-3-5778-366
Tel: 281-894-5983
                          Tel: 86-24-2334-2829       Fax: 886-3-5770-955
Indianapolis              Fax: 86-24-2334-2393
Noblesville, IN                                      Taiwan - Kaohsiung
Tel: 317-773-8323
                          China - Shenzhen           Tel: 886-7-213-7830
                          Tel: 86-755-8864-2200
Fax: 317-773-5453                                    Taiwan - Taipei
                          Fax: 86-755-8203-1760      Tel: 886-2-2508-8600
Los Angeles
                          China - Wuhan              Fax: 886-2-2508-0102
Mission Viejo, CA
                          Tel: 86-27-5980-5300
Tel: 949-462-9523                                    Thailand - Bangkok
                          Fax: 86-27-5980-5118       Tel: 66-2-694-1351
Fax: 949-462-9608
                          China - Xian               Fax: 66-2-694-1350
New York, NY
Tel: 631-435-6000         Tel: 86-29-8833-7252
                          Fax: 86-29-8833-7256
San Jose, CA
Tel: 408-735-9110         China - Xiamen
                          Tel: 86-592-2388138
Canada - Toronto
                          Fax: 86-592-2388130
Tel: 905-673-0699
Fax: 905-673-6509         China - Zhuhai
                          Tel: 86-756-3210040
                                                                                                   03/25/14
                          Fax: 86-756-3210049
DS20005287A-page 88                                                           2014 Microchip Technology Inc.


Mouser Electronics
Authorized Distributor
Click to View Pricing, Inventory, Delivery & Lifecycle Information:
Microchip:
 MCP3918A1T-E/ML MCP3918A1-E/ML MCP3918A1-E/SS MCP3918A1T-E/SS
