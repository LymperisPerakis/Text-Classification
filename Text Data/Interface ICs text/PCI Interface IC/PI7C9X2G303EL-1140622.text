                                PI7C9X2G303EL
               PCI EXPRESS GEN 2 PACKET SWITCH
          3-Port, 3-Lane, ExtremeLo PCIe 2.0 Packet Switch
                                    DATASHEET
                                    REVISION 2-2
                                     August 2017
                                                 1545 Barber Lane Milpitas, CA 95035
                                                             Telephone: 408-232-9100
                                                                    FAX: 408-434-1040
                                                       Internet: http://www.diodes.com
Document Number DS40025 Rev 2-2


                                                                                                            PI7C9X2G303EL
                                                             IMPORTANT NOTICE
DIODES INCORPORATED MAKES NO WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, WITH REGARDS TO THIS
DOCUMENT, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A
PARTICULAR PURPOSE (AND THEIR EQUIVALENTS UNDER THE LAWS OF ANY JURISDICTION).
Diodes Incorporated and its subsidiaries reserve the right to make modifications, enhancements, improvements, corrections or
other changes without further notice to this document and any product described herein. Diodes Incorporated does not assume any
liability arising out of the application or use of this document or any product described herein; neither does Diodes Incorporated
convey any license under its patent or trademark rights, nor the rights of others. Any Customer or user of this document or products
described herein in such applications shall assume all risks of such use and will agree to hold Diodes Incorporated and all the
companies w hose products are represented on Diodes Incorporated w ebsite, harmless against all damages.
Diodes Incorporated does not warrant or accept any liability whatsoever in respect of any products purchased through unauthorized
sales channel.
Should Customers purchase or use Diodes Incorporated products for any unintended or unauthorized application, Customers shall
indemnify and hold Diodes Incorporated and its representatives harmless against all claims, damages, expenses, and attorney fees
arising out of, directly or indirectly, any claim of personal injury or death associated with such unintended or unauthorized
application.
Products described herein may be covered by one or more United States, international or foreign patents pending. Product names
and markings noted herein may also be covered by one or more United States, international or foreign trademarks.
This document is w ritten in English but may be translated into multiple languages for reference. Only the English version of this
document is the final and determinative format released by Diodes Incorporated.
                                                                 LIFE SUPPORT
Diodes Incorporated products are specif ically not authorized for use as critical components in life support devic es or systems
w ithout the express written approval of the Chief Executive Officer of Diodes Incorporated. As used herein:
A. Life support devices or systems are devices or systems which:
             1. are intended to implant into the body, or
             2. support or sustain life and whose failure to perform w hen properly used in accordance w ith instructions for use
provided in the labeling can be reasonably expected to result in significant injury to the user.
B. A critical component is any component in a life support device or system whose failure to perform can be reasonably expected
to cause the
     failure of the life support device or to affect its safety or effectiveness.
Customers represent that they have all necessary expertise in the safety and regulatory ramifications of their life support devic es or
systems, and acknowledge and agree that they are solely responsible for all legal, regulatory and safety-related requirements
concerning their products and any use of Diodes Incorporated products in such safety-critical, life support devices or systems,
notw ithstanding any devices- or systems-related information or support that may be provided by Diodes Incorporated. Further,
Customers must fully indemnify Diodes Incorporated and its representatives against any damages arising out of the use of Diodes
Incorporated products in such safety-critical, life support devices or systems.
Copyright © 2016, Diodes Incorporated
www.diodes.com
PI7C9X2G303EL                                                     Page 3 of 91                                        September 2017
Document Number DS40025 Rev 2-2                                 www.diodes.com                                        © Diodes Incorporated


                                                                                                 PI7C9X2G303EL
REVISION HISTORY
Date        Revision Number     Description
7/13/11     0.1                 Preliminary Datasheet
9/13/11     0.2                 Updated Section 3.3 M iscellaneous Signals (GPIO[2] and GPIO[3])
                                Updated Section 4.1 Pin List (GPIO[2] and GPIO[3])
11/23/11    0.3                 Updated Section 1 Features (integrated reference clock)
                                Updated Section 3.1 PCI Express Interface Signals (Added REFCLKI_P, REFCLKI_N,
                                REFCLKO_P[2:0], REFCLKO_N[2:0], and IREF)
8/10/12     1.0                 Updated Section 1 Features (OBFF and LTR support)
                                Updated Section 3 Pin Description (VDDC, VDDCAUX, and AVDD)
                                Updated Section 6 EEPROM Interface And System M anagement Bus
                                Updated Section 7 Register Description
11/22/12    1.1                 Updated Section 3.3 M iscellaneous Signals (NC and Test)
                                Updated Section 4.1 Pin List
                                Updated Figure 12 1 Package outline drawing
                                Updated Table 8-1 Clock Requirement
1/2/13      1.2                 Updated Section 3 Pin Description (PWR_SAV, TCK, TRST_L, and NC)
                                Added Section 11.4 AC Switching Characteristics of Clock Buffer
                                Updated Section 4.1 Pin List
7/15/14     1.3                 Updated Section 1 (512-byte maximum payload size support, No-blocking capability)
                                Updated Section 3 (Removed internal resistance for DWNRST _L[2:1], CLKBUF_PD,
                                VC1_EN, RXPOLINV_DIS, PL_512B, PRSNT[2:1], SLOTCLK, SLOT_IM P[2:1],
                                EEPD, SM BCLK, SM BDATA, SCAN_EN, GPIO[7:0], PWR_SAV, TM S, TDI, and
                                TRST_L)
                                Updated Section 3.2 Port Configuration Signals
                                Updated Section 3.3 M iscellaneous Signals
                                Updated Section 4.1 Pin List Of 136-Pin QFN
                                Updated Section 5.1 Physical Layer Circuit
                                Updated Section 5.1.7 Drive De-Emphasis
                                Updated Section 7.2.75 Device Capabilities Register (M ax_Payload_Size Supported)
                                Updated Section 13 Ordering Information
                                Updated Table 11-2 DC Electrical Characteristics
                                Updated Figure 12-2 Package Bottom View
11/17/14    1.4                 Updated Section 7.2 Transparent M ode Configuration Registers
                                Updated Section 8 Clock Scheme
07/16/15    1.5                 Updated Section 3.1 PCI Express Interface Signals
                                Updated Section 3.2 Port Configuration Signals
                                Updated Section 5.1 Physical Layer Circuit
                                Updated Section 6.1 EEPROM Interface
                                Updated Section 7.2 Transparent M ode Configuration Registers
                                Updated Section 8 Clock Scheme
                                Updated Table 9-1 Instruction Register Codes
                                Updated Table 9-2 JTAG Device ID Register
                                Updated Table 9-3 JTAG Boundary Scan Register Definition
                                Updated Table 11-2 DC Electrical Characteristics
09/07/15    1.6                 Updated Table 11-1 Absolute maximum ratings
12/23/15    1.7                 Updated Section 3.1 PIN Description
                                Updated Table 11-1 Absolute M aximum Ratings
                                Updated Table 11-2 DC Electrical Characteristics
02/26/16    1.8                 Added Section 11 Power Sequence
PI7C9X2G303EL                                       Page 4 of 91                                         September 2017
Document Number DS40025 Rev 2-2                   www.diodes.com                                         © Diodes Incorporated


                                                                                              PI7C9X2G303EL
Date        Revision Number     Description
08/31/17    2-2                 Updated Section 1 Features
                                Updated Section 3.2 Port Configuration Signals
                                Updated Section 5.1 Physical Layer Circuit
                                Updated Section 6.1.4 M apping EEPROM Contents to Configuration Registers
                                Updated Section 7.2 Transparent M ode Configuration Registers
                                Updated Section 12.1 Absolute M aximum Ratings
                                Updated Table 12-2 DC Electrical Characteristics
                                Added Section 12.4 Operating Ambient Temperature
                                Added Section 12.5 Power Consumption
                                Revision numbering system changed to whole number
PI7C9X2G303EL                                       Page 5 of 91                                      September 2017
Document Number DS40025 Rev 2-2                   www.diodes.com                                       © Diodes Incorporated


                                                                                                                                                        PI7C9X2G303EL
TABLE OF CONTENTS
1   FEATUR ES ........................................................................................................................................................................................11
2   GEN ERAL DES CRIPTION .........................................................................................................................................................12
3   PIN DES CRIPTION........................................................................................................................................................................14
  3.1     PCI EXPRESS INTERFACE SIGNA LS................................................................................................................. 14
  3.2     PORT CONFIGURATION SIGNA LS .................................................................................................................... 15
  3.3     MISCELLANEOUS SIGNA LS ................................................................................................................................15
  3.4     JTA G BOUNDARY SCAN SIGNA LS ................................................................................................................... 16
  3.5     POW ER PINS...............................................................................................................................................................17
4   PIN ASSIGNMENTS ......................................................................................................................................................................18
  4.1     PIN LIST OF 136-PIN QFN........................................................................................................................................18
5   FUNCTIONAL DES CRIPTION .................................................................................................................................................19
  5.1     PHYSICA L LA YER CIRCUIT.................................................................................................................................19
     5.1.1     RECEIVER DETECTION ................................................................................................................................. 19
     5.1.2     RECEIVER SIGNAL DETEC TION ................................................................................................................ 20
     5.1.3     RECEIVER EQUALIZATION .......................................................................................................................... 20
     5.1.4     TRANSMITTER S WING ................................................................................................................................... 20
     5.1.5     DRIVE AMPLITUDE AN D DE-EMPHASIS SETTINGS ............................................................................ 20
     5.1.6     DRIVE AMPLITUDE ........................................................................................................................................ 21
     5.1.7     DRIVE DE-EMPHASIS .................................................................................................................................... 22
     5.1.8     TRANSMITTER ELECTRICAL IDLE LATENCY ........................................................................................ 22
  5.2     DATA LINK LA YER (DLL).....................................................................................................................................22
  5.3     TRANSACTION LA YER RECEIVE BLOCK (TLP DECAPSULATION)..................................................... 23
  5.4     ROUTING.....................................................................................................................................................................23
  5.5     TC/ VC MAPPING.......................................................................................................................................................23
  5.6     QUEUE..........................................................................................................................................................................24
     5.6.1     PH......................................................................................................................................................................... 24
     5.6.2     PD......................................................................................................................................................................... 24
     5.6.3     NPHD................................................................................................................................................................... 24
     5.6.4     CPLH ................................................................................................................................................................... 24
     5.6.5     CPLD ................................................................................................................................................................... 24
  5.7     TRANSACTION ORDERING .................................................................................................................................25
  5.8     PORT ARBITRATION ..............................................................................................................................................25
  5.9     VC A RBITRATION ...................................................................................................................................................26
  5.10 FLOW CONTROL ......................................................................................................................................................26
  5.11 TRANSATION LA YER TRANSMIT BLOCK (TLP ENCAPSULATION).................................................... 26
6   EEPROM INTERFACE AND S YSTEM MANAGEMENT B US ...................................................................................... 27
  6.1     EEPROM INTERFA CE .............................................................................................................................................27
     6.1.1     AUTO MODE EERPOM ACCESS ................................................................................................................. 27
     6.1.2     EEPROM MODE AT RESET........................................................................................................................... 27
     6.1.3     EEPROM SPACE ADDRESS MAP ................................................................................................................ 27
     6.1.4     MAPPIN G EEPROM CONTENTS TO C ONFIGURATION REGISTERS .............................................. 30
  6.2     SMBUS INTERFA CE .................................................................................................................................................37
7   REGISTER DES CRIPTION ........................................................................................................................................................38
  7.1     REGISTER TYPES .....................................................................................................................................................38
  7.2     TRANSPA RENT MODE CONFIGURATION REGISTERS............................................................................. 38
     7.2.1     VENDOR ID REGISTER – OFFSET 00h...................................................................................................... 40
PI7C9X2G303EL                                                                Page 6 of 91                                                                             September 2017
Document Number DS40025 Rev 2-2                                           www.diodes.com                                                                               © Diodes Incorporated


                                                                                                                                   PI7C9X2G303EL
     7.2.2     DEVICE ID REGISTER – OFFSET 00h ....................................................................................................... 40
     7.2.3     COMMAND REGISTER – OFFSET 04h....................................................................................................... 40
     7.2.4     PRIMARY STATUS REGISTER – OFFSET 04h .......................................................................................... 41
     7.2.5     REVISION ID REGISTER – OFFSET 08h.................................................................................................... 42
     7.2.6     CLASS CODE REGISTER – OFFSET 08h ................................................................................................... 42
     7.2.7     CACHE LINE REGISTER – OFFSET 0Ch ................................................................................................... 42
     7.2.8     PRIMARY LATENCY TIMER REGISTER – OFFSET 0Ch........................................................................ 42
     7.2.9     HEADER TYPE REGISTER – OFFSET 0Ch ............................................................................................... 42
     7.2.10    PRIMARY BUS NUMBER REGIS TER – OFFSET 18h .............................................................................. 42
     7.2.11    SECONDARY BUS NUMBER REGISTER – OFFSET 18h ....................................................................... 42
     7.2.12    SUBORDINATE BUS N UMBER REGISTER – OFFSET 18h ................................................................... 43
     7.2.13    SECONDARY LATENCY TIMER REGISTER – OFFSET 18h.................................................................. 43
     7.2.14    I/O BASE ADDRESS REGISTER – OFFSET 1Ch....................................................................................... 43
     7.2.15    I/O LIMIT ADDRESS REGISTER – OFFSET 1Ch ..................................................................................... 43
     7.2.16    SECONDARY STATUS REGISTER – OFFSET 1Ch................................................................................... 43
     7.2.17    MEMORY BASE ADDRESS REGISTER – OFFSET 20h ........................................................................... 44
     7.2.18    MEMORY LIMIT ADDRESS REGISTER – OFFSET 20h.......................................................................... 44
     7.2.19    PREFETC HABLE MEMORY BASE ADDRESS REGISTER – OFFSET 24h ......................................... 44
     7.2.20    PREFETC HABLE MEMORY LIMIT ADDRESS REGISTER – OFFSET 24h........................................ 45
     7.2.21    PREFETC HABLE MEMORY BASE ADDRESS UPPER 32-BITS REGISTER – OFFSET 28h.......... 45
     7.2.22    PREFETC HABLE MEMORY LIMIT ADDRESS UPPER 32-BITS REGISTER – OFFSET 2Ch ........ 45
     7.2.23    I/O BASE ADDRESS UPPER 16-BITS REGISTER – OFFSET 30h ........................................................ 45
     7.2.24    I/O LIMIT ADDRESS UPPER 16-BITS REGISTER – OFFSET 30h ....................................................... 45
     7.2.25    CAPABILITY POIN TER REGISTER – OFFSET 34h ................................................................................. 46
     7.2.26    INTERRUPT LINE REGISTER – OFFSET 3Ch .......................................................................................... 46
     7.2.27    INTERRUPT PIN REGISTER – OFFSET 3Ch............................................................................................. 46
     7.2.28    BRIDGE C ONTROL REGISTER – OFFSET 3Ch ....................................................................................... 46
     7.2.29    POWER MANAGEMENT CAPABILITY REGISTER – OFFSET 40h...................................................... 47
     7.2.30    POWER MANAGEMENT DATA REGISTER – OFFSET 44h................................................................... 47
     7.2.31    PPB SUPPORT EXTENSIONS – OFFSET 44h ........................................................................................... 48
     7.2.32    DATA REGISTER – OFFSET 44h .................................................................................................................. 48
     7.2.33    MSI CAPABILITY REGISTER – OFFSET 4Ch (Downstream Port Only) .............................................. 48
     7.2.34    MESSAGE CON TROL REGISTER – OFFSET 4Ch (Downstream Port Only) ...................................... 48
     7.2.35    MESSAGE ADDRESS REGISTER – OFFSET 50h (Downstream Port Only)........................................ 49
     7.2.36    MESSAGE UPPER ADDRESS REGISTER – OFFSET 54h (Downstream Port Only)......................... 49
     7.2.37    MESSAGE DATA REGISTER – OFFSET 58h (Downstream Port Only)................................................ 49
     7.2.38    VPD CAPABILITY REGISTER – OFFSET 5Ch (Upstream Port Only) .................................................. 49
     7.2.39    VPD REGISTER – OFFSET 5Ch (Upstream Port Only) ........................................................................... 49
     7.2.40    VPD DATA REGISTER – OFFSET 60h (Upstream Port Only)................................................................ 50
     7.2.41    VENDOR SPECIFIC CAPABILITY REGIS TER – OFFSET 64h.............................................................. 50
     7.2.42    XPIP CSR0 – OFFSET 68h (Test Purpose Only) ........................................................................................ 50
     7.2.43    XPIP CSR1 – OFFSET 6Ch (Test Purpose Only)........................................................................................ 50
     7.2.44    REPLAY TIME-OUT C OUNTER – OFFSET 70h ....................................................................................... 50
     7.2.45    ACKNOWLEDGE LATENCY TIMER – OFFSET 70h ............................................................................... 51
     7.2.46    SWITCH OPERATION MODE – OFFSET 74h (Upstream Port Only)................................................... 51
     7.2.47    SWITCH OPERATION MODE – OFFSET 74h (Downstream Port Only) ............................................. 52
     7.2.48    XPIP_CSR2 – OFFSET 78h ............................................................................................................................ 53
     7.2.49    PHY PARAMETER 1 – OFFSET 78h ............................................................................................................ 53
     7.2.50    PHY PARAMETER 2 – OFFSET 7Ch............................................................................................................ 53
     7.2.51    XPIP_CSR3 – OFFSET 80h ............................................................................................................................ 54
     7.2.52    XPIP_CSR4 – OFFSET 84h ............................................................................................................................ 54
     7.2.53    XPIP_CSR5 – OFFSET 88h ............................................................................................................................ 54
     7.2.54    TL_CSR – OFFSET 8Ch................................................................................................................................... 55
     7.2.55    PHY PARAMETER 3 – OFFSET 90h ............................................................................................................ 56
     7.2.56    PHY PARAMETER 4 - OFFSET 94h ............................................................................................................. 56
PI7C9X2G303EL                                           Page 7 of 91                                                                             September 2017
Document Number DS40025 Rev 2-2                      www.diodes.com                                                                               © Diodes Incorporated


                                                                                                                     PI7C9X2G303EL
     7.2.57    OPERATION MODE –OFFSET 98h ............................................................................................................. 56
     7.2.58    SSID/SSVID CAPABILITY REGISTER – OFFSET B0h ............................................................................. 56
     7.2.59    SUBSYSTEM VENDOR ID REGISTER – OFFSET B4h ............................................................................ 57
     7.2.60    SUBSYSTEM ID REGISTER – OFFSET B4h ............................................................................................... 57
     7.2.61    GPIO C ONTROL REGISTER – OFFSET B8h (Upstream Port Only) .................................................... 57
     7.2.62    EEPROM CON TROL REGIS TER – OFFSET BCh (Upstream Port Only) ............................................ 58
     7.2.63    EEPROM ADDRESS REGIS TER – OFFSET BCh (Upstream Port Only) ............................................. 59
     7.2.64    EEPROM DATA REGISTER – OFFSET BCh (Upstream Port Only) ..................................................... 59
     7.2.65    PCI EXPRESS CAPABILITY REGISTER – OFFSET C0h......................................................................... 59
     7.2.66    DEVICE CAPABILITIES REGISTER – OFFSET C4h ............................................................................... 60
     7.2.67    DEVICE CON TROL REGISTER – OFFSET C8h ....................................................................................... 60
     7.2.68    DEVICE STATUS REGIS TER – OFFSET C8h ............................................................................................ 61
     7.2.69    LINK CAPABILITIES REGISTER – OFFSET CCh .................................................................................... 62
     7.2.70    LINK C ONTROL REGISTER – OFFSET D0h ............................................................................................. 63
     7.2.71    LINK STATUS REGISTER – OFFSET D0h.................................................................................................. 63
     7.2.72    SLOT C APABILITIES REGISTER – OFFSET D4h (Downstream Port Only)....................................... 64
     7.2.73    SLOT C ONTROL REGISTER – OFFSET D8h (Downstream Port Only) ............................................... 65
     7.2.74    SLOT S TATUS REGISTER OFFSET D8h (Downstream Port Only) ....................................................... 66
     7.2.75    DEVICE CAPABILITIES REGISTER 2 – OFFSET E4h ............................................................................ 66
     7.2.76    DEVICE CON TROL REGISTER 2 – OFFSET E8h .................................................................................... 66
     7.2.77    DEVIDE S TATUS REGISTER 2 – OFFSET E8h......................................................................................... 67
     7.2.78    LINK CAPABILITIES REGISTER 2 – OFFSET ECh ................................................................................. 67
     7.2.79    LINK C ONTROL REGISTER 2 – OFFSET F0h .......................................................................................... 67
     7.2.80    LINK STATUS REGISTER 2 – OFFSET F0h ............................................................................................... 67
     7.2.81    SLOT C APABILITIES REGISTER 2 – OFFSET F4h.................................................................................. 67
     7.2.82    SLOT C ONTORL REGISTER 2 – OFFSET F8h.......................................................................................... 67
     7.2.83    SLOT S TATUS REGISTER 2 – OFFSET F8h .............................................................................................. 68
     7.2.84    PCI EXPRESS ADVANCED ERROR REPORTING CAPABILITY REGIS TER – OFFSET 100h ..... 68
     7.2.85    UNCORRECTABLE ERROR STATUS REGISTER – OFFSET 104h....................................................... 68
     7.2.86    UNCORRECTABLE ERROR MASK REGISTER – OFFSET 108h .......................................................... 69
     7.2.87    UNCORRECTABLE ERROR SEVERITY REGISTER – OFFSET 10Ch.................................................. 70
     7.2.88    CORRECTABLE ERROR STATUS REGISTER – OFFSET 110 h............................................................ 70
     7.2.89    CORRECTABLE ERROR MASK REGISTER – OFFSET 114 h ............................................................... 71
     7.2.90    ADVANCE ERROR CAPABILITIES AND CON TROL REGISTER – OFFSET 118h ........................... 71
     7.2.91    HEADER LOG REGISTER – OFFSET From 11Ch to 128h ..................................................................... 72
     7.2.92    PCI EXPRESS VIRTUAL CHANNEL CAPABILITY REGISTER – OFFSET 140h ............................... 72
     7.2.93    PORT VC CAPABILITY REGISTER 1 – OFFSET 144h ............................................................................ 72
     7.2.94    PORT VC CAPABILITY REGISTER 2 – OFFSET 148h ............................................................................ 73
     7.2.95    PORT VC C ONTROL REGISTER – OFFSET 14Ch ................................................................................... 73
     7.2.96    PORT VC STATUS REGISTER – OFFSET 14Ch........................................................................................ 73
     7.2.97    VC RESOURCE CAPABILITY REGIS TER (0) – OFFSET 150h .............................................................. 73
     7.2.98    VC RESOURCE C ONTROL REGISTER (0) – OFFSET 154h .................................................................. 74
     7.2.99    VC RESOURCE STATUS REGISTER (0) – OFFSET 158h....................................................................... 74
     7.2.100      VC RESOURCE CAPABILITY REGIS TER (1) – OFFSET 15Ch......................................................... 75
     7.2.101      VC RESOURCE C ONTROL REGISTER (1) – OFFSET 160h.............................................................. 75
     7.2.102      VC RESOURCE STATUS REGISTER (1) – OFFSET 164h .................................................................. 76
     7.2.103      VC ARBITRATION TABLE REGISTER – OFFSET 170h...................................................................... 76
     7.2.104      PORT ARBITRATION TABLE REGISTER (0) and (1) – OFFSET 180h and 1C0h ......................... 76
     7.2.105      PCI EXPRESS POWER BUDGETING CAPABILITY REGISTER – OFFSET 20Ch........................ 77
     7.2.106      DATA SELECT REGISTER – OFFSET 210h........................................................................................... 77
     7.2.107      POWER BUDGETING DATA REGISTER – OFFSET 214h ................................................................. 77
     7.2.108      POWER BUDGET C APABILITY REGISTER – OFFSET 218h ........................................................... 78
     7.2.109      ACS EXTENDED CAPABILITY HEADER – OFFSET 220h (Downstream Port Only)................... 78
     7.2.110      ACS CAPABILITY REGISTER – OFFSET 224h (Downstream Port Only)........................................ 78
     7.2.111      EGRESS CON TROL VEC TOR – OFFSET 228h (Downstream Port Only) ....................................... 79
PI7C9X2G303EL                                 Page 8 of 91                                                                         September 2017
Document Number DS40025 Rev 2-2             www.diodes.com                                                                          © Diodes Incorporated


                                                                                                                                           PI7C9X2G303EL
     7.2.112      LTR EXTEN DED CAPABILITY HEADER – OFFSET 230h (Upstream Port Only) ........................ 79
     7.2.113      MAX SNOOP LATENCY REGISTER – OFFSET 234h (Upstream Port Only).................................. 79
     7.2.114      MAX NO-SNOOP LATENCY REGISTER – OFFSET 234h (Upstream Port Only) .......................... 80
8   CLOCK SCHEME...........................................................................................................................................................................81
9   IEEE 1149.1 COMPATIB LE JTAG CONTROLLER .......................................................................................................... 82
  9.1     INSTRUCTION REGISTER .....................................................................................................................................82
  9.2     BYPASS REGISTER..................................................................................................................................................82
  9.3     DEVICE ID REGISTER.............................................................................................................................................82
  9.4     BOUNDA RY SCAN REGISTER.............................................................................................................................83
  9.5     JTA G BOUNDARY SCAN REGISTER ORDER ................................................................................................. 83
10 POWER MANAGEMENT ............................................................................................................................................................85
11 POWER S EQUENCE .....................................................................................................................................................................86
12 EL ECTRICAL AND TIMING SPECIFICATIONS .............................................................................................................. 87
  12.1    ABSOLUTE MAXIMUM RATINGS ..................................................................................................................... 87
  12.2    DC SPECIFICATIONS ..............................................................................................................................................87
  12.3    AC SPECIFICATIONS ..............................................................................................................................................87
  12.4    OPERATING AM BIENT TEMPERATURE ......................................................................................................... 89
  12.5    POW ER CONSUMPTION ........................................................................................................................................89
13 PACKAGE INFORMATION .......................................................................................................................................................90
14 ORDERING INFORMATION.....................................................................................................................................................92
PI7C9X2G303EL                                                   Page 9 of 91                                                                             September 2017
Document Number DS40025 Rev 2-2                              www.diodes.com                                                                               © Diodes Incorporated


                                                                                                                                       PI7C9X2G303EL
TABLE OF FIGURES
FIGURE 5-1 DRIVER OUTPUT WAVEFORM .................................................................................................................................21
FIGURE 6-1 SMBUS A RCHIT ECTURE IMPLEMENTATION ON PI7C9X2G303EL................................................................... 37
FIGURE 11-1 INIT IAL POWER-UP SEQUENCE .............................................................................................................................86
FIGURE 13-1 PACKAGE OUT LINE DRAWING ...............................................................................................................................90
FIGURE 13-2 PACKAGE BOTTOM VIEW........................................................................................................................................91
LIST OF TABLES
TABLE 5-1 RECEIVER DET ECTION THRESHOLD SETTINGS ...................................................................................................... 19
TABLE 5-2 RECEIVER SIGNAL DETECT THRESHOLD ................................................................................................................ 20
TABLE 5-3 RECEIVER EQUALIZATION SETTINGS.......................................................................................................................20
TABLE 5-4 TRANSMITTER SWING SETTINGS ..............................................................................................................................20
TABLE 5-5 DRIVE A MPLIT UDE BASE LEVEL REGIST ERS ......................................................................................................... 21
TABLE 5-6 DRIVE A MPLIT UDE BASE LEVEL SETTINGS............................................................................................................ 21
TABLE 5-7 DRIVE DE-EMPHASIS BASE LEVEL REGIST ER ....................................................................................................... 22
TABLE 5-8 DRIVE DE-EMPHASIS BASE LEVEL SETTINGS........................................................................................................ 22
TABLE 5-9 SUMMARY OF PCI EXPRESS ORDERING RULES ..................................................................................................... 25
TABLE 6-1 SMBUS A DDRESS PIN CONFIGURATION................................................................................................................. 37
TABLE 7-1 REGI ST ER A RRAY LAYOUT FOR VC A RBIT RATION .............................................................................................. 76
TABLE 7-2 TABLE ENT RY SIZE IN 4 BIT S ...................................................................................................................................76
TABLE 8-1 AC SWIT CHING CHARACT ERISTICS .........................................................................................................................81
TABLE 9-1 INST RUCT ION REGISTER CODES...............................................................................................................................82
TABLE 9-2 JTA G DEVICE ID REGIST ER .....................................................................................................................................82
TABLE 9-3 JTA G BOUNDARY SCAN REGIST ER DEFINITION................................................................................................... 83
TABLE 12-1 A BSOLUTE M AXIMUM RAT INGS ............................................................................................................................87
TABLE 12-2 DC ELECT RICAL CHARACTERISTICS ..................................................................................................................... 87
TABLE 12-3 PCI EXPRESS INTERFACE - DIFFERENT IAL TRANSMITTER (TX) OUT PUT (5.0 GBPS) CHARACTERIST ICS.. 87
TABLE 12-4 PCI EXPRESS INTERFACE - DIFFERENT IAL TRANSMITTER (TX) OUT PUT (2.5 GBPS) CHARACTERIST ICS.. 88
TABLE 12-5 PCI EXPRESS INTERFACE - DIFFERENT IAL RECEIVER (RX) INPUT (5.0 GBPS) CHARACT ERIST ICS............. 88
TABLE 12-6 PCI EXPRESS INTERFACE - DIFFERENT IAL RECEIVER (RX) INPUT (2.5 GBPS) CHARACT ERIST ICS............. 89
TABLE 12-7 OPERAT ING A MBIENT TEMPERATURE................................................................................................................... 89
TABLE 12-8 POWER CONSUMPTION ............................................................................................................................................89
PI7C9X2G303EL                                              Page 10 of 91                                                                             September 2017
Document Number DS40025 Rev 2-2                          www.diodes.com                                                                               © Diodes Incorporated


                                                                                            PI7C9X2G303EL
1 FEATURES
    • 3-lane PCI Express Gen 2 Switch with 3 PCI Express ports
    • Supports “Cut-through”(Default) as well as “Store and Forward” mode for packet switching
    • Peer-to-peer switching between any two downstream ports
    • 150 ns typical latency for packet routed through Switch without blocking
    • Integrated reference clock for downstream ports
    • Strapped pins configurable with optional EEPROM or SMBus
    • SMBus interface support
    • Compliant with System Management (SM) Bus, Version 1.0
    • Compliant with PCI Express Base Specification Revision 2.1
    • Compliant with PCI Express CEM Specification Revision 2.0
    • Compliant with PCI-to-PCI Bridge Architecture Specification Revision 1.2
    • Compliant with Advanced Configuration Power Interface (ACPI) Specification
    • Reliability, Availability and Serviceability
             -     Supports Data Poisoning and End-to-End CRC
             -     Advanced Error Reporting and Logging
             -     IEEE 1149.1 JTAG interface support
    • Advanced Power Saving
             -     Empty downstream ports are set to idle state to minimize power consumption
    • Link Power Management
             -     Supports L0, L0s, L1, L2, L2/L3Ready and L3 link power states
             -     Active state power management for L0s and L1 states
    • Device State Power Management
             -     Supports D0, D3Hot and D3Cold device power states
             -     3.3V Aux Power support in D3Cold power state
    • Port Arbitration: Round Robin (RR), Weighted RR and Time-based Weighted RR
    • Extended Virtual Channel capability
             -     Two Virtual Channels (VC) and Eight Traffic Class (TC) support
             -     Disabled VCs’ buffer is assigned to enabled VCs for resource sharing
             -     Independent TC/VC mapping for each port
             -     Provides VC arb itration selections: Strict Priority, Round Robin (RR) and Programmable
                   Weighted RR
    • Supports Isochronous Traffic
             -     Isochronous traffic class mapped to VC1 only
             -     Strict time based credit policing
    • Supports up to 512-byte maximu m payload size
    • Programmable driver current and de-emphasis level at each individual port
    • Support Access Control Service (ACS) for peer-to-peer traffic
    • Support Address Translation (AT) packet for SR-IOV application
    • Support OBFF and LTR
    • Low Power Dissipation: 650 mW typical in L0 normal mode
    • Industrial Temperature Range -40o to 85o C
    • 136-pin aQFN 8mm x 8mm package
PI7C9X2G303EL                                         Page 11 of 91                               September 2017
Document Number DS40025 Rev 2-2                      www.diodes.com                               © Diodes Incorporated


                                                                                                 PI7C9X2G303EL
2 GENERAL DESCRIPTION
Similar to the ro le of PCI/PCIX Bridge in PCI/PCIX bus architecture, the function of PCI Exp ress (PCIE) Switch is
to expand the connectivity to allow more end devices to be reached by host controllers in PCIE serial interconnect
architecture. The 3-lane PCIe Switch is in 3-port type configuration. It provides users the flexib ility to expand or
fan-out the PCI Express lanes based on their application needs.
In the PCI Exp ress Architecture, the PCIE Switch forwards posted and non-posted requests, and complet ion packets
in either downstream or upstream d irection concurrently as if a virtual PCI Bridge is in operation on each port. By
visualizing the port as a virtual Bridge, the Switch can be logically viewed as two-level cascaded mult iple virtual
PCI-to-PCI Bridges, where one upstream-port Bridge sits on all downstream-port Bridges. Similar to a PCI Bridge
during enumeration, each port is given a unique bus number, device number, and function number by the initiating
software. The bus number, device number, and function number are co mbined to form a destination ID for each
specific port. In addition to that, the memo ry-map and IO address ranges are exclusively allocated to each port as
well. After the software enumeration is fin ished, the packets are routed to the dedicated port based on the embedded
address or destination ID. To ensure the packet integrity during forward ing, the Switch is not allo wed to split the
packets to mult iple s mall packets or merge the received packets into a large transmit packet. Also, the IDs of the
requesters and completers are kept unchanged along the path between ingress and egress port.
The Switch emp loys the architecture of Co mb ined Input and Output Queue (CIOQ) in implementation. The main
reason for choosing CIOQ is that the required memory bandwidth of input queue equals to the bandwidth of ingress
port rather than increasing proportionally with port numbers as an output queue Switch does. The CIOQ at each
ingress port contains separate dedicated queues to store packets. The packets are arbitrated to the egress port based
on the PCIe t ransaction-ordering rule. Fo r the packets without ordering information, they are permitted to pass over
each other in case that the addressed egress port is availab le to accept them. As to the packets required to fo llo w the
ordering rule, the Head-Of-Line (HOL) issue becomes unavoidable for packets destined to different egress ports
since the operation of producer-consumer model has to be retained; otherwise the system might occur hang-up
problem. On the other hand, the Switch places replay buffer at each egress port to defer the packets before sending it
out. This can assure the maximu m throughput being achieved and therefore the Switch works efficiently. Another
advantage of imp lementing CIOQ in PCIe Switch is that the credit announcement to the counterpart is simplified
and streamlined because of the credit-based flow control p rotocol. The protocol requires that each ingress port
maintains the credits independently without checking other ports' cred it availability, which is otherwise required by
pure output queue architecture.
The Switch supports two virtual channels (VC0, VC1) and eight traffic classes (TC0 ~ TC7) at each port.
The ingress port independently assigns packets into the preferred virtual channel while the egress port outputs the
packet based on the predefined port and VC arbitrat ion algorith m. For instance, the isochronous packet is given a
special traffic class number other than TC0 and mapped into VC1 accordingly. By emp loying the strict time based
credit policy for port arbit ration and assigning higher priority to VC1 than VC0, the Switch can therefore guarantee
the time-sensitive packet is not blocked by regular traffic to assure the quality of service. In addit ion, some data-
centric applications only carry TC0/ VC0 traffic. As a result, there are no packets that would consume VC1
bandwidth. In order to imp rove the efficiency of buffer usage, the unused VC1 queues can be reassigned to VC0
and enable each of the ingress ports to handle mo re data traffic bursts. This virtual channel resource relocation
feature enhances the performance of the PCIe Switch further.
The Switch provides the advanced feature of Access Control Service (A CS). Th is feature regulates which
components are allo wed to co mmunicate with each other within the PCIe mu ltip le-point fabric, and allows the
system to have more control over packet routing in the Switch. As a result, peer-to-peer traffic can be facilitated
more accurately and efficiently. When the system also implements Address Translation Service (ATS), the peer-to-
peer requests with translated address can be routed directly by enabling the corresponding option in ACS to avoid
possible performance bottleneck associated with re-direction, wh ich introduces extra latency and may increase link
and RC congestion.
PI7C9X2G303EL                                         Page 12 of 91                                      September 2017
Document Number DS40025 Rev 2-2                      www.diodes.com                                       © Diodes Incorporated


                                                                                              PI7C9X2G303EL
The built-in Integrated Reference Clock Buffer of the PCI Express Switch supports three reference clock outputs.
The clock buffer is fro m a single 100M Hz clock input, and distributes the clock source to three outputs, which can
be used by the downstream PCI Exp ress end devices. The clock buffer feature can be enabled and disabled by
strapping pin setting.
PI7C9X2G303EL                                      Page 13 of 91                                      September 2017
Document Number DS40025 Rev 2-2                   www.diodes.com                                      © Diodes Incorporated


                                                                                                        PI7C9X2G303EL
3 PIN DESCRIPTION
3.1    PCI EXPRESS INTERFACE SIGNALS
         NAME                      PIN     TYPE   DESCRIPTIO N
         REFCLKP              A24            I    Re fe rence Clock Input Pair: Connect to 100MHz differential clock
         REFCLKN              A22                 when integrated reference clock buffer is disabled (CLKBUF_PD=1),
                                                  or connect to one of the Integrated Reference Clock Output Pairs
                                                  (REFCLKO_P and REFCLKO_N) of this Switch when integrated
                                                  reference clock buffer is enabled (CLKBUF_PD=0).
                                                  T he input clock signals must be delivered to the clock buffer cell
                                                  through an AC-coupled interface so that only the AC information of
                                                  the clock is received, converted, and buffered. It is recommended that a
                                                  0.1uF be used in the AC-coupling.
         PERP[2:0]            A28, C33, C9   I    PCI Expre ss Data Serial Input Pairs: Differential data receive
                                                  signals in three ports.
                                                  Port 0 (Upstream Port) is PERP[0] and PERN[0]
         PERN[2:0]            A26, C31,      I    Port 1 (Downstream Port) is PERP[1] and PERN[1]
                              C11                 Port 2 (Downstream Port) is PERP[2] and PERN[2]
         PET P[2:0]           C25, C29,     O     PCI Expre ss Data Serial Output Pairs: Differential data transmit
                              A10                 signals in three ports.
                                                  Port 0 (Upstream Port) is PETP[0] and PETN[0]
                                                  Port 1 (Downstream Port) is PETP[1] and PETN[1]
         PET N[2:0]           C23, C27,     O     Port 2 (Downstream Port) is PETP[2] and PETN[2]
                              A12
         PERST _L             M1             I    System Reset (Active LOW): When PERST_L is asserted, the
                                                  internal states of whole chip except sticky logics are initialized.
                                                  Please refer to Table 11-2 for PERST _L spec.
         DWNRST _L[2:1]       J3, F1        O     Downstream Device Reset (Active LOW): DWNRST_L provides a
                                                  reset signal to the devices connected to the downstream ports of the
                                                  switch. T he signal is active when either PERST_L is asserted or the
                                                  device is just plugged into the switch. DWNRST _L [x] corresponds to
                                                  Portx, where x= 1,2,3.
         REXT                 A18            I    Exte rnal Reference Resistor: Connect an external resistor (1.43K
                                                  Ohm +/- 1%) to REXT_GND to provide a reference to both the bias
                                                  currents and impedance calibration circuitry.
         REXT _GND            C15            I    Exte rnal Reference Resistor Ground: Connect to an external resistor
                                                  to REXT .
         REFCLKI_P,           AE35, AH37     I    Inte grated Reference Clock Input Pair: Connect to external
         REFCLKI_N                                100MHz differential clock for the integrated reference clock buffer.
         REFCLKO_P[2:0]       AB37, V37,    O     Inte grated Reference Clock Output Pairs: 100MHz external
                              P37                 differential HCSL clock outputs for the integrated reference clock
         REFCLKO_N[2:0]       AD37, Y37,    O     buffer.
                              T 37
         IREF                 R35            I    Diffe rential Reference Clock Output Current Resistor: External
                                                  resistor (475 Ohm +/- 1%) connection to set the differential reference
                                                  clock output current.
         CLKBUF_PD            AR29           I    Re fe rence Clock Output Pairs Power Down: When CLKBUF_PD is
                                                  asserted high, the integrated reference clock buffer and Reference
                                                  Clock Outputs are disabled. When it is asserted low, the integrated
                                                  reference clock buffer and Reference Clock Outputs are enabled. This
                                                  pin has internal pull-down. If no board trace is connected to this pin,
                                                  the internal pull-down resistor of this pin is enough. However, if pin is
                                                  connected to a board trace and not driven, it is recommended that an
                                                  external 330-ohm pull-down resistor be used.
PI7C9X2G303EL                                    Page 14 of 91                                                     September 2017
Document Number DS40025 Rev 2-2                 www.diodes.com                                                     © Diodes Incorporated


                                                                                                       PI7C9X2G303EL
3.2    PORT CONFIGURATION SIGNALS
         NAME                     PIN    TYPE   DESCRIPTIO N
         VC1_EN               W3            I   Virtual Channel 1 Re source Sharing Enable: The chip provides the
                                                capability to support virtual channel 1 (VC1), in addition to the standard
                                                virtual channel 0. When this pin is asserted high, Virtual Channel 1 is
                                                enabled, and virtual channel resource sharing is not available. When it is
                                                asserted low, the chip would allocate the additional VC1 resource to VC0,
                                                and VC1 capability is disabled. T his pin has internal pull-down resistor. If
                                                no board trace is connected to this pin, the internal pull-down resistor of
                                                this pin is enough. However, if pin is connected to a board trace and not
                                                driven, it is recommended that an external 330-ohm pull-down resistor be
                                                used.
         RXPOLINV_DIS         AE3           I   Rx Polarity Inversion Disable: When RXPOLINV_DIS is asserted high,
                                                it indicates to disable Rx Polarity Inversion detection function. Otherwise,
                                                it indicates to enable Rx Polarity Inversion detection function. This pin has
                                                internal pull-down resistor. If no board trace is connected to this pin, the
                                                internal pull-down resistor of this pin is enough. However, if pin is
                                                connected to a board trace and not driven, it is recommended that an
                                                external 330-ohm pull-down resistor be used.
         PL_512B              AR23          I   Max. Payload Size 512B: When PL_512B is asserted high, it indicates the
                                                max. payload size capability is 512B. Otherwise, it indicates the max.
                                                Payload size is 256B. This pin has internal pull-down resistor. If no board
                                                trace is connected to this pin, the internal pull-down resistor of this pin is
                                                enough. However, if pin is connected to a board trace and not driven, it is
                                                recommended that an external 330-ohm pull-down resistor be used.
         PRSNT [2:1]          AA3, Y1       I   Pre sent: When PRSNT is asserted low, it indicates that the device is
                                                present in the slot of downstream port. Otherwise, it indicates the absence
                                                of the device. PRSNT [x] is correspondent to Port x, where x=1,2,3. These
                                                pins have internal pull-down resistors.
         SLOT CLK             AR7           I   Slot Clock Configuration: It determines if the downstream component
                                                uses the same physical reference clock that the platform provides on the
                                                connector. When SLOTCLK is high, the platform reference clock is
                                                employed. By default, all downstream ports use the same physical
                                                reference clock provided by platform. T his pin has internal pull-down
                                                resistor. If no board trace is connected to this pin, the internal pull-down
                                                resistor of this pin is enough. However, if pin is connected to a board trace
                                                and not driven, it is recommended that an external 330-ohm pull-down
                                                resistor be used.
         SLOT _IMP[2:1]       AU16, AR15    I   Slot Implemented: T hese signals are asserted to indicate that the
                                                downstream ports are connected to slots. SLOT_IMP[x] corresponds to
                                                Portx, where x= 1, 2, 3. When SLOT_IMP[x] is asserted, the Portx is
                                                connected to slot. Otherwise, it is chip-to-chip connection directly. These
                                                pins have internal pull-down resistors. If no board trace is connected to
                                                these pins, the internal pull-down resistors of these pins are enough.
                                                However, if pins are connected to a board trace and not driven, it is
                                                recommended that external 330-ohm pull-down resistors be used.
         PORT ST ATUS[2:0]    AM37,        O    Port Status: These signals indicate the status of each port. Please connect
                              AL35,             to pin header for debug used.
                              AP37
                                                PORT ST ATUS[x] is correspondent to Port x, where x=0, 1, 2.
3.3    MISCELLANEOUS SIGNALS
         NAME                    PIN     TYPE   DESCRIPTIO N
         EECLK                AJ35         O    EEPRO M Clock: Clock signal to the EEPROM interface.
         EEPD                 AK37        I/O   EEPRO M Data: Bi-directional serial data interface to and from the
                                                EEPROM. The pin is set to ‘1’ by default.
         SMBCLK               AH1           I   SM Bus Clock: System management Bus Clock. This pin requires an
                                                external 5.1K-ohm pull-up resistor.
         SMBDAT A             AK1         I/O   SM Bus Data: Bi-Directional System Management Bus Data. This pin
                                                requires an external 5.1K-ohm pull-up resistor.
PI7C9X2G303EL                                  Page 15 of 91                                                     September 2017
Document Number DS40025 Rev 2-2               www.diodes.com                                                      © Diodes Incorporated


                                                                                                         PI7C9X2G303EL
         NAME                     PIN      TYPE   DESCRIPTIO N
         SCAN_EN              AG35          I/O   Full-Scan Enable Control: For normal operation, SCAN_EN is an output
                                                  with a value of “ 0”. SCAN_EN becomes an input during manufacturing
                                                  testing.
         GPIO[7:0]            AU14, AR13,   I/O   Ge neral Purpose Input and Output: These eight general-purpose pins are
                              AU12, AU10,         programmed as either input-only or bi-directional pins by writing the GPIO
                              AR11, AU8,          output enable control register.
                              AU6, AR9            When SMBus is implemented, GPIO[7:5] act as the SMBus address pins,
                                                  which set Bit 2 to 0 of the SMBus address.
                                                  De bug Mode Selection: In debug mode, GPIO[4:0] are used for Debug
                                                  Mode Selection.
         PWR_SAV              AJ3             I   Powe r Saving Mode: PWR_SAV is a strapping pin. When this pin is
                                                  pulled high when system is reset, the Power Saving Mode is enabled. When
                                                  this pin is pulled low when system is reset, the Power Saving Mode is
                                                  disabled. When this pin is pulled low, it should be tied to ground through a
                                                  330-ohm pull-down resistor. When this pin is pulled high, a 5.1K-ohm pull-
                                                  up resistor should be used.
         T EST 3              V1              I   Te st3/5/6: These pins are for internal test purpose. T est3, T est5 and Test6
         T EST 5              AF1                 should be tied to ground through a 330-ohm pull-down resistor.
         T EST 6              AR21
         T EST 4              AD1             I   Te st4: T he pin is for internal test purpose. It should be tied to ground
                                                  through a 330-ohm pull-down resistor for normal operation.
                                                  Port Status Output Enable: In debug mode, it is used to enable PortStatus
                                                  output.
         T EST 1              N3              I   Te st1: T he pin is for internal test purpose. It should be tied to 3.3V through
                                                  a 5.1K-ohm pull-up resistor for normal operation.
                                                  De bug Mode Enable: In debug mode, it need be tired to low through a
                                                  330-ohm pull-down resistor.
         T EST 2              T1              I   Te st2: T he pin is for internal test purpose. Test2 should be tied to 3.3V
                                                  through a 5.1K-ohm pull-up resistor.
         NC                   AF37, A2,           Not Connected: T hese pins can be just left open.
                              A4, A6, A8,
                              A14, A16,
                              A20, A30,
                              A32, A34,
                              A36, B1,
                              B37, C3, C5,
                              C7, C13,
                              C35, D1,
                              D37, F37,
                              G3, H1, K1,
                              U35, AB1,
                              AC3, AC35,
                              AG3, AL3,
                              AM1, AN3,
                              AP1, AR3,
                              AR5, AR17,
                              AR25, AR27,
                              AR33, AR35,
                              AT 1, AT37,
                              AU2, AU4,
                              AU18, AU20,
                              AU22, AU24,
                              AU26, AU28,
                              AU34, AU36
3.4    JTAG BOUNDARY SCAN SIGNALS
         Name                      Pin     Type   De scription
         T CK                   K37          I    Te st Clock: Used to clock state information and data into and out of the
                                                  chip during boundary scan. When JT AG boundary scan function is not
                                                  implemented, this pin should be left open (NC).
PI7C9X2G303EL                                    Page 16 of 91                                                       September 2017
Document Number DS40025 Rev 2-2                 www.diodes.com                                                       © Diodes Incorporated


                                                                                                             PI7C9X2G303EL
         Name                       Pin       Type     De scription
         T MS                   H37             I      Te st Mode Select: Used to control the state of the Test Access Port
                                                       controller. When JT AG boundary scan function is not implemented, this pin
                                                       should be pulled low through a 330-Ohm pull-down resistor.
         T DO                   N35            O       Te st Data Output: When SCAN_EN is high, it is used (in conjunction
                                                       with T CK) to shift data out of the Test Access Port (TAP) in a serial bit
                                                       stream. When JT AG boundary scan function is not implemented, this pin
                                                       should be left open (NC).
         T DI                   J35             I      Te st Data Input: When SCAN_EN is high, it is used (in conjunction with
                                                       T CK) to shift data and instructions into the T AP in a serial bit stream.
                                                       When JT AG boundary scan function is not implemented, this pin should be
                                                       left open (NC).
         T RST _L               G35             I      Te st Re set (Active LOW): Active LOW signal to reset the TAP controller
                                                       into an initialized state. When JTAG boundary scan function is not
                                                       implemented, this pin should be pulled low through a 330-Ohm pull-down
                                                       resistor.
3.5    POWER PINS
         NAME                         PIN        TYPE    DESCRIPTIO N
         VDDC                   AN35, B, L,        P     VDDC Supply (1.0V): Used as digital core power pins.
                                L35
         VDDR                   E3, L3, AR19,      P     VDDR Supply (3.3V): Used as digital I/O power pins.
                                AU32, AR31,
                                E35
         CVDDR                  R                  P     CVDDR Supply (3.3V): Used as reference clock power pin.
         VDDCAUX                P1, R3             P     VDDCAUX Supply (1.0V): Used as auxiliary core power pins.
         VAUX                   U3                 P     VAUX Supply (3.3V): Used as auxiliary I/O power pins.
         AVDD                   T                  P     AVDD Supply (1.0V): Used as PCI Express analog power pins.
         AVDDH                  C17,               P     AVDDH Supply (3.3V): Used as PCI Express analog high voltage power
                                                         pins.
         AGND                   C19, C21           P     Ground: Used as analog ground pins.
         DGND                   M37, AU30          P     Ground: Used as digital ground pins.
         CGND                   W35, AA35          P     Ground: Used as reference clock ground pins.
         VSS                    GND                P     VSS Ground: Used as ground pin.
PI7C9X2G303EL                                         Page 17 of 91                                                     September 2017
Document Number DS40025 Rev 2-2                      www.diodes.com                                                      © Diodes Incorporated


                                                                                     PI7C9X2G303EL
4 PIN ASSIGNMENTS
4.1    PIN LIST of 136-PIN QFN
   PIN     NAME                 PIN  NAME             PIN      NAME            PIN     NAME
   A2      NC                   C35  NC               AA35     CGND            AR21    T EST 6
   A4      NC                   D1   NC               AB1      NC              AR23    PL_512B
   A6      NC                   D37  NC               AB37     REFCLKO_P[2]    AR25    NC
   A8      NC                   E3   VDDR             AC3      NC              AR27    NC
   A10     PET P[0]             E35  VDDR             AC35     NC              AR29    CLKBUF_PD
   A12     PET N[0]             F1   DWNRST _L[1]     AD1      T EST 4         AR31    VDDR
   A14     NC                   F37  NC               AD37     REFCLKO_N[2]    AR33    NC
   A16     NC                   G3   NC               AE3      RXPOLINV_DIS    AR35    NC
   A18     REXT                 G35  T RST _L         AE35     REFCLKI_P       AT 1    NC
   A20     NC                   H1   NC               AF1      T EST 5         AT 37   NC
   A22     REFCLKN              H37  T MS             AF37     NC              AU2     NC
   A24     REFCLKP              J3   DWNRST _L[2]     AG3      NC              AU4     NC
   A26     PERN[2]              J35  T DI             AG35     SCAN_EN         AU6     GPIO[1]
   A28     PERP[2]              K1   NC               AH1      SMBCLK          AU8     GPIO[2]
   A30     NC                   K37  T CK             AH37     REFCLKI_N       AU10    GPIO[4]
   A32     NC                   L3   VDDR             AJ3      PWR_SAV         AU12    GPIO[5]
   A34     NC                   L35  VDDC             AJ35     EECLK           AU14    GPIO[7]
   A36     NC                   M1   PERST _L         AK1      SMBDAT A        AU16    SLOT _IMP[2]
   B1      NC                   M37  DGND             AK37     EEPD            AU18    NC
   B37     NC                   N3   T EST 1          AL3      NC              AU20    NC
   C3      NC                   N35  T DO             AL35     PORT ST ATUS[1] AU22    NC
   C5      NC                   P1   VDDCAUX          AM1      NC              AU24    NC
   C7      NC                   P37  REFCLKO_P[0]     AM37     PORT ST ATUS[2] AU26    NC
   C9      PERP[0]              R3   VDDCAUX          AN3      NC              AU28    NC
   C11     PERN[0]              R35  IREF             AN35     VDDC            AU30    DGND
   C13     NC                   T1   T EST 2          AP1      NC              AU32    VDDR
   C15     REXT _GND            T 37 REFCLKO_N[0]     AP37     PORT ST ATUS[0] AU34    NC
   C17     AVDDH                U3   VAUX             AR3      NC              AU36    NC
   C19     AGND                 U35  NC               AR5      NC              T       AVDD
   C21     AGND                 V1   T EST 3          AR7      SLOT CLK        B       VDDC
   C23     PET N[2]             V37  REFCLKO_P[1]     AR9      GPIO[0]         R       CVDDR
   C25     PET P[2]             W3   VC1_EN           AR11     GPIO[3]         L       VDDC
   C27     PET N[1]             W35  CGND             AR13     GPIO[6]         GND     VSS
   C29     PET P[1]             Y1   PRSNT [1]        AR15     SLOT _IMP[1]
   C31     PERN[1]              Y37  REFCLKO_N[1]     AR17     NC
   C33     PERP[1]              AA3  PRSNT [2]        AR19     VDDR
PI7C9X2G303EL                                    Page 18 of 91                               September 2017
Document Number DS40025 Rev 2-2                 www.diodes.com                                © Diodes Incorporated


                                                                                                  PI7C9X2G303EL
5 FUNCTIONAL DESCRIPTION
Multiple v irtual PCI-to-PCI Bridges (VPPB), connected by a virtual PCI bus, reside in the Switch. Each VPPB
contains the complete PCIe architecture layers that consist of the physical, data link, and transaction layer.
The packets entering the Switch via one of VPPBs are first converted fro m serial bit-stream into parallel bus signals
in physical layer, stripped off the link-related header by data link layer, and then relayed up to the t ransaction layer
to extract out the transaction header. According to the address or ID embedded in the transaction header, the entire
transaction packets are forwarded to the destination VPPB fo r fo rmatting as a serial-type PCIe packet through the
transmit circuits in the data lin k layer and physical layer. The fo llo wing sections describe these function elements
for processing PCIe packets within the Switch.
5.1      PHYSICAL LAYER CIRCUIT
The physical layer circu it design is based on the PHY Interface for PCI Express Architecture (PIPE). It contains
Physical Media Attachment (PMA) and Physical Coding Sub-layer (PCS) blocks. PMA includes Serializer/
Deserializer (SERDES), PLL 1 , Clock Recovery module, receiver detection circuits, beacon transmitter, electrical
idle detector, and input/output buffers. PCS consists of framer, 8B/ 10B encoder/decoder, receiver elastic buffer, and
PIPE PHY control/status circuitries. To provide the flexib ility for port configuration, each lane has its own control
and status signals for MAC to access individually. In addition, a pair of PRBS generator and checker is included for
PHY built -in self test. The main functions of physical layer circuits include the conversion between serial-link and
parallel bus, provision of clock source for the Switch, resolving clock difference in receiver end, and detection of
physical layer errors.
In order to meet the needs of different application, the drive amplitude, de-emphasis and equalizat ion of each
transmitting channels can be adjusted using EEPROM indiv idually. De-emphasis of -3.5 db is implemented by the
transmitters when full swing signaling is used, while an offset can be individually applied to each channel.
5.1.1 RECEIVER DETECTION
The physical layer circuits implement receiver detection, which detects the presence of an attached 50 ohm to
ground termination as per PCI Exp ress Specificat ion. The detect circuits determine if the voltage levels of the
receiver have crossed the internal threshold after a configurable time determined by the Receiver Detection
Threshold field in the PHY Parameter 2 Register (offset 7Ch, bit[6:4]) as listed in Table 5-1 , wh ich can be
configured by EEPROM or SMBUS settings.
        Table 5-1 Receiver Detection Threshold Settings
            Re ce ive r De te ction             Thre shold
                 Thre shold
                      000                          1.0 us
                      001                          2.0 us
                      010                 4.0 us (Recommended)
                      011                          5.0 us
                      100                          10 us
                      101                          20 us
                      110                          40 us
                      111                          50 us
1
  Multiple lanes could share the PLL.
PI7C9X2G303EL                                           Page 19 of 91                                      September 2017
Document Number DS40025 Rev 2-2                        www.diodes.com                                      © Diodes Incorporated


                                                                                                PI7C9X2G303EL
5.1.2 RECEIVER SIGNAL DETECTION
Receiver signal idling is detected with levels above a programmab le threshold specified by Receiver Signal Detect
field in the PHY Parameter 2 Register (Offset 7Ch, b it[21:20]) as listed in Table 5-2, wh ich can be configured on a
per-port basis via EEPROM or SMBUS settings.
        Table 5-2 Receiver Signal Detect Threshold
           Re ce ive r Signal De te ct         Min (mV ppd)               Max (mV ppd)
          00                                         50                           80
          01 (Recommended)                           65                          175
          10                                         75                          200
          11                                        120                          240
5.1.3 RECEIVER EQUALIZATION
The receiver imp lements programmab le equalizer via the Receiver Equalizat ion field in the PHY Parameter 2
Register (Offset 7Ch, b it[25:22]) as listed in Table 5-3, wh ich can be configured on a per-port basis via EEPROM
or SMBUS settings.
        Table 5-3 Receiver Equalization Settings
                     Re ce ive r Equaliz ation           Equaliz ation
          0000                                                 Off
          0010                                                Low
          0110 (Recommended)                                Medium
          1110                                                High
5.1.4 TRANSMITTER SWING
The PCI Exp ress transmitters support implementations of both full voltage swing and half (lo w) voltage swing. In
full swing signaling mode, the transmitters implement de-emphasis, wh ile in half swing mode, the transmitters do
not. The Transmitter Swing field in the PHY Parameter 2 Reg ister (offset 7Ch, Bit[30]) is used for the selection of
full swing signaling or half swing signaling, which can be configured on a per-port basis via EEPROM or SMBUS
settings.
        Table 5-4 Transmitter Swing Settings
                  Transmitte r Swing                   Mode                De -e mphasis
                             0                   Full Voltage Swing        Implemented
                             1                  Half Voltage Swing       Not implemented
5.1.5 DRIVE AMPLITUDE AND DE-EMPHASIS SETTINGS
Depending on the operation condition (voltage swing and de-emphasis condition), one of the Drive A mplitude Base
Level fields in the Switch Operat ion Mode Register (offset 74h) and one of the Drive De-Emphasis Base Level
fields in the PHY Parameter 1 Register (offset 78h) are active for configuration of the amplitude and de-emphasis.
The final drive amp litude and drive de-emphasis are the summation of the base level value and the offset value.
The offset value for drive amplitude is 25 mV pd, and 6.25 mV pd for drive de-emphasis.
PI7C9X2G303EL                                           Page 20 of 91                                  September 2017
Document Number DS40025 Rev 2-2                        www.diodes.com                                   © Diodes Incorporated


                                                                                                                PI7C9X2G303EL
The driver output waveform is the synthesis of amplitude and de-emphasis as shown in Figure 5-1. The driver
amp litude without de-emphasis is specified as a peak differential voltage level (mVpd), and the driver de-emphasis
modifies the driver amplitude.
                                                                                    Amplitude + De-Emphasis
                                                                                    Amplitude – De-Emphasis
                                           1     1    1    1
                                   0                              0     0     0
                                                                                          - (Amplitude) + De-Emphasis
                                                                                          - (Amplitude) – De-Emphasis
                                     Input digital wave form
                                     Output analog waveform
                                                 Figure 5-1 Driver Output Waveform
5.1.6 DRIVE AMPLITUDE
Only one of the Drive A mplitude Level field in the Switch Operat ion Mode Register (offset 74h, bit[20:16],
bit[25:21] and bit[30:26]) listed in Table 5-5 is active depending on the de-emphasis and swing condition.
The settings and the corresponding values of the amplitude level are listed in Tab le 5-6, wh ich can be configured by
EEPROM or SMBUS settings.
        Table 5-5 Drive Amplitude Base Level Registers
                  Active Re giste r               De -Emphasis Condition                Swing Condition
             C_DRV_LVL_3P5_NOM                              -3.5 db                             Full
             C_DRV_LVL_6P0_NOM                              -6.0 db                             Full
            C_DRV_LVL_HALF_NOM                                N/A                               Half
        Table 5-6 Drive Amplitude Base Level Settings
           Se tting     Amplitude            Se tting      Amplitude           Se tting       Amplitude
                          (mV pd)                            (mV pd)                            (mV pd)
            00000             0               00111             175             01110             350
            00001            25               01000             200             01111             375
            00010            50               01001             225             10000             400
            00011            75               01010             250             10001             425
            00100           100               01011             275             10010             450
            00101           125               01100             300             10011             475
            00110           150               01101             325             Others          Reserved
        Note :
        1. Nominal levels. Actual levels will vary with temperature, voltage and board effects.
PI7C9X2G303EL                                                  Page 21 of 91                                          September 2017
Document Number DS40025 Rev 2-2                               www.diodes.com                                          © Diodes Incorporated


                                                                                                                      PI7C9X2G303EL
        2. T he maximum nominal amplitude of the output driver is 475 mV pd. Combined values of driver amplitude and de-emphasis greater
           than 475 mV pd should be avoided.
        3. At higher amplitudes, actual swings will be less than the theoretical value due to process variations and environment factors, such as
           voltage overhead compression, package losses, board losses, and other effects.
5.1.7 DRIVE DE-EMPHASIS
The Drive De-Emphasis Level field in the PHY Parameter 1 Register (Offset 78h, b it[20:16], b it[25:21] and
bit[30:26]) listed in Tab le 5-7 controls the de-emphasis base level. The settings and the corresponding values of the
de-emphasis level are listed in Table 5-8, which can be globally via EEPROM or SMBUS settings.
        Table 5-7 Drive De-Emphasis Base Level Register
                     Re giste r                  De -Emphasis Condition
         C_EMP_POST _GEN1_3P5_NOM                            -3.5 db
         C_EMP_POST _GEN2_3P5_NOM                            -3.5 db
         C_EMP_POST _GEN2_6P0_NOM                            -6.0 db
        Table 5-8 Drive De-Emphasis Base Level Settings
         Se tting     De -Emphasis         Se tting       De -Emphasis         Se tting      De -Emphasis
                         (mV pd)                              (mV pd)                           (mV pd)
           00000            0.0             01011               69.0            10110            137.5
           00001            6.0             01100               75.0            10111            144.0
           00010           12.5             01101               81.0            11000            150.0
           00011           19.0             01110               87.0            11001            156.0
           00100           25.0             01111               94.0            11010            162.5
           00101           31.0             10000              100.0            11011            169.0
           00110           37.5             10001              106.0            11100            175.0
           00111           44.0             10010              112.5            11101            181.0
           01000           50.0             10011              119.0            11110            187.5
           01001           56.0             10100              125.0            11111            194.0
           01010           62.5             10101              131.0               -                -
        Note :
        1. Nominal levels. Actual levels will vary with temperature, voltage and board effects.
        2. T he maximum nominal amplitude of the output driver is 475 mV pd. Combined values of driver amplitude and de-emphasis greater
           than 475 mV pd should be avoided.
        3. At higher amplitudes, actual swings will be less than the theoretical value due to process variations and environment factors, such as
           voltage overhead compression, package losses, board losses, and other effects.
5.1.8 TRANSMITTER ELECTRICAL IDLE LATENCY
After the last character of the PCI Exp ress transmission, the output current is reduced, and a differential voltage of
less than 20 mV with co mmon mode of VTX-CM -DC is established within 20 UI. Th is delay time is programmable
via Transmitter PHY Latency field in the PHY Parameter 2 Register (Offset 7Ch, b it[3:0]), wh ich can be configured
by EEPROM or SMBUS settings.
5.2       DATA LINK LAYER (DLL)
The Data Link Layer (DLL) provides a reliab le data transmission between two PCI Exp ress points. An ACK/NA CK
protocol is employed to guarantee the integrity of the packets delivered. Each Transaction Layer Packet (TLP) is
protected by a 32-bit LCRC for error detection. The DLL receiver performs LCRC calculat ion to determine if the
incoming packet is corrupted in the serial link. If an LCRC erro r is found, the DLL trans mitter would issue a NACK
data link layer packet (DLLP) to the opposite end to request a re-transmission, otherwise an ACK DLLP would be
sent out to acknowledge on reception of a good TLP.
PI7C9X2G303EL                                                   Page 22 of 91                                                 September 2017
Document Number DS40025 Rev 2-2                                www.diodes.com                                                  © Diodes Incorporated


                                                                                                  PI7C9X2G303EL
In the transmitter, a retry buffer is implemented to store the transmitted TLPs whose corresponding ACK/NA CK
DLLP have not been received yet. When an ACK is received, the TLPs with sequence number equals to and smaller
than that carried in the ACK would be flushed out from the buffer. If a NA CK is received or no A CK/ NACK is
returned fro m the link partner after the replay timer exp ires, then a replay mechanis m built in DLL transmitter is
triggered to re-transmit the corresponding packet that receives NA CK or time-out and any other TLP t ransmitted
after that packet.
Meanwhile, the DLL is also responsible for the init ialization, updating, and monitoring of the flow-control credit.
All of the flow control information is carried by DLLP to the other end of the link. Unlike TLP, DLLP is guarded
by 16-bit CRC to detect if data corruption occurs.
In addition, the Media Access Control (MAC) block, which is consisted of LTSSM, mu ltip le lanes de-skew,
scrambler/de-scramb ler, clock correct ion fro m inserting skip order-set, and PIPE-related control/status circuits, is
implemented to interface physical layer with data link layer.
5.3      TRANSACTION LAYER RECEIVE BLOCK (TLP DECAPSULATION)
The receiving end of the transaction layer performs header info rmation retrieval and TC/ VC mapping (see section
5.5), and it validates the correctness of the transaction type and format. If the TLP is found to contain an illegal
header or the indicated packet length mismatches with the actual packet length, then a Malformed TLP is reported
as an error associated with the receiv ing port. To ensure end-to-end data integrity, a 32-b it ECRC is checked against
the TLP at the receiver if the digest bit is set in header.
5.4      ROUTING
The transaction layer implements three types of routing protocols: ID-based, address-based, and imp licit routing.
For configuration reads, configuration writes, transaction completion, and user-defined messages, the packets are
routed by their destination ID constituted of bus number, device nu mber, and function number. Address routing is
emp loyed to forward I/O o r memory transactions to the destination port, which is located within the address range
indicated by the address field carried in the packet header. The packet header indicates the packet types including
memo ry read, memo ry write, IO read, IO write, Message Signaling Interrupt (MSI) and user-defined message.
Implicit routing is mainly used to forward system message transactions such as virtual interrupt line, power
management, and so on. The message type embedded in the packet header determines the routing mechanism.
If the incoming packet can not be forwarded to any other port due to a miss to hit the defined address range or
targeted ID, this is considered as Unsupported Request (UR) packet, wh ich is similar to a master abort event in PCI
protocol.
5.5     TC/VC MAPPING
The 3-bit TC field defined in the header identifies the traffic class of the inco ming packets. To enable the
differential service, a TC/ VC mapp ing table at destination port that is pre-programmed by system software or
EEPROM pre-load is utilized to cast the TC labeled packets into the desired virtual channel. Note that TC0 t raffic is
mapped into VC0 channel by default. After the TC/ VC mapping, the receive b lock dispatches the incoming request,
completion, or data into the appropriate VC0 and VC1 queues.
PI7C9X2G303EL                                          Page 23 of 91                                     September 2017
Document Number DS40025 Rev 2-2                       www.diodes.com                                      © Diodes Incorporated


                                                                                                 PI7C9X2G303EL
5.6     QUEUE
In PCI Exp ress, it defines six different packet types to represent request, completion, and data. They are respectively
Posted Request Header (PH), Posted Request Data payload (PD), Non-Posted Request Header (NPH), Non-Posted
Data Payload (NPD), Co mpletion Header (CPLH) and Co mplet ion Data payload (CPLD). Each packet with
different type would be put into a separate queue in order to facilitate the following ordering processor. Since NPD
usually contains one DW, it can be merged with the corresponding NPH into a co mmon queue named NPHD.
Except NPHD, each virtual channel (VC0 or VC1) has its own corresponding packet header and data queue. When
only VC0 is needed in some applications, VC1 can be disabled and its resources assigned to VC0 by asserting
VC1_EN (Virtual Channel 1 Enable) to low.
5.6.1      PH
PH queue provides TLP header spaces for posted memo ry writes and various message request headers. Each header
space occupies sixteen bytes to accommodate 3 DW or 4 DW headers. There are t wo PH queues for VC0 and VC1
respectively.
5.6.2      PD
PD queue is used for storing posted request data. If the received TLP is of the posted request type and is determined
to have payload coming with the header, the payload data would be put into PD queue. There are t wo PD queues for
VC0 and VC1 respectively.
5.6.3 NPHD
NPHD queue provides TLP header spaces for non-posted request packets, which include memo ry read, IO read, IO
write, configurat ion read, and configuration write. Each header space takes twenty bytes to accommodate a 3-DW
header, s 4-DW header, s 3-WD header with 1-DW data, and a 4-DW header with 1-DW data. There is only one
NPHD queue for VC0, since non-posted request cannot be mapped into VC1.
5.6.4 CPLH
CPLH queue provides TLP header space for comp letion packets. Each header space takes twelve bytes to
accommodate a 3-DW header. Please note that there are no 4-DW co mp letion headers. There are two CPLH queues
for VC0 and VC1 respectively.
5.6.5 CPLD
CPLD queue is used for storing co mpletion data. If the received TLP is of the co mpletion type and is determined to
have payload coming with the header, the payload data would be put into CPLD queue. There are two CPLD queues
for VC0 and VC1 respectively.
PI7C9X2G303EL                                         Page 24 of 91                                      September 2017
Document Number DS40025 Rev 2-2                      www.diodes.com                                       © Diodes Incorporated


                                                                                                 PI7C9X2G303EL
5.7     TRANSACTION ORDERING
Within a VPPB, a set of ordering rules is defined to regulate the transactions on the PCI Express Switch including
Memory, IO, Configuration and Messages, in order to avoid deadlocks and to support the Producer-Consumer
model. The ordering ru les defined in table 5-4 apply within a single Traffic Class (TC). There is no ordering
requirement among transactions within different TC labels. Since the transactions with the same TC label are not
allo wed to map into different virtual channels, it imp lies no ordering relat ionship between the traffic in VC0 and
VC1.
      Table 5-9 Summary of PCI Express Ordering Rules
       Row Pass Column           Posted       Re ad         Non-posted Write  Re ad         Non-posted Write
                                 Re quest    Re quest       Re quest          Completion    Completion
       Posted Request            Yes/No 1    Yes5           Yes5              Yes5          Yes5
       Read Request              No 2        Yes            Yes               Yes           Yes
       Non-posted Write Request  No 2        Yes            Yes               Yes           Yes
       Read Completion           Yes/No 3    Yes            Yes               Yes           Yes
       Non-Posted Write          Yes4        Yes            Yes               Yes           Yes
       Completion
1. When the Relaxed Ordering Attribute bit is cleared, the Posted Request transactions including memo ry write and
message request must complete on the egress bus of VPPB in the order in which they are received on the ingress
bus of VPPB. If the Relaxed Ordering Attribute bit is set, the Posted Request is permitted to pass over other Posted
Requests occurring before it.
2. A Read Request transmitt ing in the same direction as a prev iously queued Posted Request transaction must push
the posted write data ahead of it. The Posted Request transaction must complete on the egress bus before the Read
Request can be attempted on the egress bus. The Read transaction can go to the same location as the Posted data.
Therefore, if the Read transaction were to pass the Posted transaction, it would return stale data.
3. When the Relaxed Ordering Attribute bit is cleared, a Read co mp letion must ‘‘pull’’ ahead of previously queued
posted data transmitting in the same d irection. In this case, the read data transmits in the same direction as the
posted data, and the requestor of the read transaction is on the same side of the VPPB as the comp leter of the posted
transaction. The posted transaction must deliver to the co mpleter before the read data is returned to the requestor. If
the Relaxed Ordering Attribute bit is set, then a read complet ion is permitted to pass a previously queued Memory
Write or Message Request.
4. Non-Posted Write Co mp letions are permitted to pass a previous Memory Write or Message Request transaction.
Such transactions are actually transmitting in the opposite directions and hence have no ordering relationship.
5. Posted Request transactions must be given opportunities to pass Non-posted Read and Write Requests as well as
Co mplet ions. Otherwise, deadlocks may occur when some o lder b ridges, wh ich do not support delayed transactions
are mixed with PCIe Switch in the same system. A fairness algorithm is used to arbitrate between the Posted Write
queue and the Non-posted transaction queue
5.8     PORT ARBITRATION
Among mu ltiple ingress ports, the port arbitration built in the egress port determines which inco ming packets to be
forwarded to the output port. The arbitration algorith m contains hardware fixed Round Robin, 128-phase Weighted
Round-Robin and programmable 128-phase time-based WRR. The port arbitrat ion is held within the same VC
channel. It means that each port has two port arbitration circuitries for VC0 and VC1 respectively. At the upstream
ports, in addition to the inter-port packets, the intra-port packet such as configurations completion would also jo in
the arbitration loop to get the service from Virtual Channel 0.
PI7C9X2G303EL                                         Page 25 of 91                                      September 2017
Document Number DS40025 Rev 2-2                      www.diodes.com                                      © Diodes Incorporated


                                                                                                 PI7C9X2G303EL
5.9     VC ARBITRATION
After port arbitration, VC arb itration is executed among different VC channels within the same source. Three
arbitration algorithms are provided to choose the appropriate VC: Strict Priority, Round Robin or Weighted Round
Robin.
5.10 FLOW CONTROL
PCI Express emp loys Credit-Based Flow Control mechanism to make buffer utilization more efficient.
The transaction layer transmitter ensures that it does not transmit a TLP to an opposite receiver unless the receiver
has enough buffer space to accept the TLP. The transaction layer receiver has the responsibility to advertise the free
buffer space to an opposite transmitter to avoid packet stale. In this Switch, each port has its own separate queues
for different traffic types and the credits are sent to data link layer on the fly. The data link layer co mpares the
current available credits with the monitored ones and reports the updated credit to the counterpart. If no new credit
is acquired, the credit reported is scheduled for every 30 us to prevent the link fro m entering retrain. On the other
hand, the receiver at each egress port gets the usable credits fro m the opposite end in a lin k. The output port
broadcasts them to all the other ingress ports to get packet transmission.
5.11 TRANSATION LAYER TRANSMIT BLOCK (TLP ENCAPSULATION)
The transmit portion of transaction layer performs the following functions. They construct the all types of forwarded
TLP generated from VC arbiter, respond with the completion packets when the local resource (i.e. configuration
register) is accessed, and regenerate the message that terminates at receiver to RC if acting as an upstream port.
PI7C9X2G303EL                                         Page 26 of 91                                      September 2017
Document Number DS40025 Rev 2-2                     www.diodes.com                                       © Diodes Incorporated


                                                                                                     PI7C9X2G303EL
6 EEPROM INTERFACE AND SYSTEM MANAGEMENT BUS
The EEPROM interface consists of two pins: EECLK (EEPROM clock output) and EEPD (EEPROM bi-d irectional
serial data). The Switch may control an ISSI IS24C04 or co mpatib le parts using into 512x8 b its. The EEPROM is
used to initialize a nu mber of registers before enumeration. Th is is accomplished after PRST# is de-asserted, at
which time the data from the EEPROM is loaded. The EEPROM interface is organized into a 16-b it base, and the
Switch supplies a 7-bit EEPROM word address. The Switch does not control the EEPROM address input. It can
only access the EEPROM with address input set to 0.
The System Management Bus interface consists of two p ins: SM BCLK (System Management Bus Clock input) and
SMBDATA (System Management Bus Data input/ output).
6.1     EEPROM INTERFACE
6.1.1 AUTO MODE EERPOM ACCESS
The Switch may access the EEPROM in a WORD format by utilizing the auto mode through a hardware sequencer.
The EEPROM start-control, address, and read/write co mmands can be accessed through the configuration register.
Before each access, the software should check the Autoload Status bit before issuing the next start.
6.1.2 EEPROM MODE AT RESET
During a reset, the Switch will automat ically load the information/data from the EEPROM if the automatic load
condition is met. The first offset in the EEPROM contains a signature. If the signature is recognized, the autoload
initiates right after the reset.
During the autoload, the Bridge will read sequential words fro m the EEPROM and write to the appropriate reg isters.
Before the Bridge registers can be accessed through the host, the autoload condition should be verified by reading
bit [3] offset DCh (EEPROM Autoload Status). The host access is allowed only after the status of this bit is set to '0'
which indicates that the autoload initialization sequence is complete.
6.1.3 EEPROM SPACE ADDRESS MAP
                            15 – 8                                         7–0                       BYTE O FFSET
                                          EEPROM Signature (1516h)                                       00h
                                                  Vendor ID                                              02h
                                                  Device ID                                              04h
          Extended VC Count / Link Capability / Switch Mode Operation / Interrupt pin for Port 1 ~ 2     06h
                                            Subsystem Vender ID                                          08h
                                                 Subsystem ID                                            0Ah
                 Max_Payload_Size Support / ASPM Support / Role_Base Error Reporting                     0Ch
                              Global PHY T X Margin Parameter for Port 0~2                               0Eh
                                    Global PHY Parameter 0 for Port 0~2                                  10h
                       Global XPIP_CSR6[0] / Global PHY Parameter 1 for Port 0~2                         12h
                     Global XPIP_CSR6[4:1] / Global PHY Parameter 2/3 for Port 0~2                       14h
                                   Global XPIP_CSR4[15:0] for Port 0~2                                   16h
                                   Global XPIP_CSR4[31:16] for Port 0~2                                  18h
                                   Global XPIP_CSR5[15:0] for Port 0~2                                   1Ah
                       Buffer_ctrl[4:0] /                 Global XPIP_CSR5[23:16] for Port 0~2           1Ch
             Globe XPIP_CSR6[7:5] for Port 0~2
                             MAC_CT R / Global PHY Parameter 3 for Port 0~2                              1Eh
PI7C9X2G303EL                                               Page 27 of 91                                    September 2017
Document Number DS40025 Rev 2-2                           www.diodes.com                                     © Diodes Incorporated


                                                                                                PI7C9X2G303EL
                         15 – 8                                         7–0                     BYTE O FFSET
                     NFT S / Scramble / XPIP_CSR2 / Deskw mode select for Port 0                    20h
                    NFT S / Scramble / XPIP_CSR2 / Deskew mode select for Port 1                    22h
                    NFT S / Scramble / XPIP_XSR2 / Deskew mode select for Port 2                    24h
                                              Reserved                                              26h
                                              Reserved                                              28h
                                              Reserved                                              2Ah
                                              Reserved                                              2Ch
                                              Reserved                                              2Eh
                                     PHY Parameter2_1 for Port 0                                    30h
                                     PHY Parameter2_1 for Port 1                                    32h
                                     PHY Parameter2_1 for Port 2                                    34h
                                               Reserved                                             36h
                                               Reserved                                             38h
                                              Reserved                                              3Ah
                                              Reserved                                              3Ch
                                              Reserved                                              3Eh
         Do_change_rate_cnt/           PHY Parameter 3/ PHY Parameter2_2 for Port 0                 40h
          XPIP_CSR_2 for
              Port 0
            Sel_deemp/                 PHY Parameter 3/ PHY Parameter2_2 for Port 1                 42h
         Do_change_rate_cnt/
          XPIP_CSR_2 for
              Port 1
            Sel_deemp/                 PHY Parameter 3/ PHY Parameter2_2 for Port 2                 44h
         Do_change_rate_cnt/
          XPIP_CSR_2 for
              Port 2
                                              Reserved                                              46h
                                              Reserved                                              48h
                                              Reserved                                              4Ah
                                              Reserved                                              4Ch
                                              Reserved                                              4Eh
                   PM Data for Port 0                         PM Capability for Port 0              50h
                   PM Data for Port 1                         PM Capability for Port 1              52h
                   PM Data for Port 2                         PM Capability for Port 2              54h
                                              Reserved                                              56h
                                              Reserved                                              58h
                                              Reserved                                              5Ah
                                              Reserved                                              5Ch
                                              Reserved                                              5Eh
              T C/VC Map for Port 0 (VC0)               Slot Clock / LPVC Count / Port Num          60h
                                                                      for Port 0
              T C/VC Map for Port 1 (VC0)            Slot Implemented / Slot Clock / LPVC Count     62h
                                                                / Port Num for Port 1
              T C/VC Map for Port 2 (VC0)            Slot Implemented / Slot Clock / LPVC Count     64h
                                                                / Port Num for Port 2
                                              Reserved                                              66h
                                              Reserved                                              68h
                                              Reserved                                              6Ah
                                              Reserved                                              6Ch
                                              Reserved                                              6Eh
                             Power Budgeting Capability Register for Port 0                         70h
                             Power Budgeting Capability Register for Port 1                         72h
                             Power Budgeting Capability Register for Port 2                         74h
                                              Reserved                                              76h
                                              Reserved                                              78h
                                              Reserved                                              7Ah
                                              Reserved                                              7Ch
                                              Reserved                                              7Eh
              XPIP_CSR5[30:24] for Port 0             PM Control Para/Rx Polarity for Port 0        80h
              XPIP_CSR5[30:24] for Port 1             PM Control Para/Rx Polarity for Port 1        82h
              XPIP_CSR5[30:24] for Port 2             PM Control Para/Rx Polarity for Port 2        84h
                                              Reserved                                              86h
                                              Reserved                                              88h
                                              Reserved                                              8Ah
PI7C9X2G303EL                                            Page 28 of 91                                  September 2017
Document Number DS40025 Rev 2-2                        www.diodes.com                                   © Diodes Incorporated


                                                                                         PI7C9X2G303EL
                         15 – 8                                       7–0                BYTE O FFSET
                                              Reserved                                       8Ch
                                              Reserved                                       8Eh
                                              Reserved                                       90h
                                     Slot Capability 0 for Port 1                            92h
                                     Slot Capability 0 for Port 2                            94h
                                              Reserved                                       96h
                                              Reserved                                       98h
                                              Reserved                                       9Ah
                                              Reserved                                       9Ch
                                              Reserved                                       9Eh
                                              Reserved                                       A0h
                                     Slot Capability 1 for Port 1                            A2h
                                     Slot Capability 1 for Port 2                            A4h
                                              Reserved                                       A6h
                                              Reserved                                       A8h
                                              Reserved                                       AAh
                                              Reserved                                       ACh
                                              Reserved                                       AEh
                                    XPIP_CSR3[15:0] for Port 0                               B0h
                                    XPIP_CSR3[15:0] for Port 1                               B2h
                                    XPIP_CSR3[15:0] for Port 2                               B4h
                                              Reserved                                       B6h
                                              Reserved                                       B8h
                                              Reserved                                       BAh
                                              Reserved                                       BCh
                                              Reserved                                       BEh
                                   XPIP_CSR3[16:31] for Port 0                               C0h
                                   XPIP_CSR3[16:31] for Port 1                               C2h
                                   XPIP_CSR3[16:31] for Port 2                               C4h
                                              Reserved                                       C6h
                                              Reserved                                       C8h
                                              Reserved                                       CAh
                                              Reserved                                       CCh
                                              Reserved                                       CEh
                          REV_T S_CT R/Replay T ime-out Counter for Port 0                   D0h
                         REV_T S_CT R /Replay T ime-out Counter for Port 1                   D2h
                         REV_T S_CT R /Replay T ime-out Counter for Port 2                   D4h
                                              Reserved                                       D6h
                                              Reserved                                       D8h
                                              Reserved                                       DAh
                                              Reserved                                       DCh
                                              Reserved                                       DEh
                                Acknowledge Latency T imer for Port 0                        E0h
                                Acknowledge Latency T imer for Port 1                        E2h
                                Acknowledge Latency T imer for Port 2                        E4h
                                              Reserved                                       E6h
                                              Reserved                                       E8h
                                              Reserved                                       EAh
                                              Reserved                                       ECh
                                              Reserved                                       EEh
              T C/VC Map for Port 0 (VC1)                  Maximum T ime Slot for Port 0     F0h
              T C/VC Map for Port 1 (VC1)                  Maximum T ime Slot for Port 0     F2h
              T C/VC Map for Port 2 (VC1)                  Maximum T ime Slot for Port 0     F4h
                                              Reserved                                       F6h
                                              Reserved                                       F8h
                                              Reserved                                       FAh
                                              Reserved                                       FCh
                                              Reserved                                       FEh
PI7C9X2G303EL                                           Page 29 of 91                            September 2017
Document Number DS40025 Rev 2-2                        www.diodes.com                            © Diodes Incorporated


                                                                                                           PI7C9X2G303EL
6.1.4 MAPPING EEPROM CONTENTS TO CONFIGURATION REGISTERS
         ADDRESS              PCI CFG O FFSET  DESCRIPTIO N
                00h                            EEPRO M signature – 1516h
                02h           00h ~ 01h        Ve ndor ID
                04h           02h ~ 03h        De vice ID
                06h           144h (Port 0~2)  Exte nded VC Count for Port 0~2
                              144h: Bit [0]              Bit [0]: It represents the supported VC count other than the default
                                                          VC
                              CCh (Port 0~2)   Link Capability for Port 0~2
                              CCh: Bit [14:12]           Bit [3:1]: It represents L0s Exit Latency for all ports
                              CCh: Bit [17:15]           Bit [6:4]: It represents L1 Exit Latency for all ports
                              74h (Port 0~2)   Switch Mode Operation for Port 0
                              74h: Bit [5]               Bit [8]: no ordering on packets for different egress port mode
                              74h: Bit [6]               Bit [9]: no ordering on different tag of completion mode
                              74h: Bit [0]               Bit [10]: Store and Forward
                              74h: Bit [2:1]             Bit [12:11]: Cut-through Threshold
                              74h: Bit [3]               Bit [13] : Port arbitrator Mode
                              74h: Bit [4]               Bit [14]: Credit Update Mode
                              3Ch (Port 1~2)   Inte rrupt pin for Port 1~2
                              3Ch: Bit [8]               Bit [15]: Set when INTA is requested for interrupt resource
                08h           B4h ~ B5h        Subsystem Vender ID
               0Ah            B6h ~ B7h        Subsystem ID
                0Ch           C4h (Port 0~2)   Max_Payload_Size Support for Port 0~2
                              C4h: Bit [1:0]             Bit [1:0]: Indicated the maximum payload size that the device can
                                                          support for the TLP
                              CCh (Port 0~2)   ASPM Support for Port 0~2
                              CCh: Bit [11:10]           Bit [3:2] : Indicate the level of ASPM supported on the PCIe link
                              C4h (Port 0~2)   Role _Base Error Re porting for Port 0~2
                              C4h: Bit [15]              Bit [4] : Indicate implement the role-base error reporting
                              70h (Port 0~2)   MSI Capability Disable for Port 0~2
                              70h: Bit [14]              Bit [5] : Disable MSI capability
                              74h (Port 0~2)   Compliance Pattern Parity Control Disable for Port 0~2
                              74h: Bit [15]              Bit [6] : Disable compliance pattern parity
                              70h (Port 0~2)   Powe r Management Capability Disable for Port 0~2
                              70h: Bit [13]              Bit [7] : Disable Power Management Capability
                              8Ch (Port 0~2)   O RDER RULE5 Enable for port 0~2
                              8Ch: Bit [5]               Bit [8]: Capability for Post packet Pass Non-Post packet
                              CCh (Port 1~2)   Link Bandwidth Notification Capability for port 1~2
                              CCh: Bit [21]                    Bit [9]: Link Bandwidth Notification Capability
                              8Ch (Port 0~2)   O rde ring Frozen for Port 0~2
                              8Ch: Bit [6]               Bit [10]: Freeze the ordering feature
                              8Ch (Port 0~2)   TX SO F Latency Mode for Port 0~2
                              8Ch: Bit [0]               Bit [11]: Set to zero to shorten latency
                              CCh (Port 0~2)   Surprise Down Capability Enable for Port 0~2
                              CCh: Bit [19]              Bit [12]: Enable Surprise Down Capability
                              8Ch (Port 0~2)   Powe r Management’s Data Select Register R/W Capability for Port 0~2
                              8Ch: Bit [1]               Bit [13]: Enable Data Select Register R/W
                              E4h (Port 0~2)   LTR Capability Enable for Port 0~2
                              E4h: Bit [12]              Bit [14]: LTR capability enable
                              8Ch (Port 0~2)   4KB Boundary Check Enable for Port 0~2
                              8Ch: Bit [3]               Bit [15]: Enable 4KB Boundary Check
PI7C9X2G303EL                                       Page 30 of 91                                                   September 2017
Document Number DS40025 Rev 2-2                   www.diodes.com                                                     © Diodes Incorporated


                                                                                                     PI7C9X2G303EL
         ADDRESS              PCI CFG O FFSET  DESCRIPTIO N
                0Eh           94h (Port 0~2)   PHY TX Margin Parameter for Port 0~2
                              94h: Bit [4:0]             Bit [4:0]: C_DRV_LVL_3P5_MGN2
                              94h: Bit [9:5]             Bit [9:5]: C_DRV_LVL_6P0_MGN2
                              94h: Bit [14:10]           Bit [14:10]: C_DRV_LVL_HALF_MGN2
                              E4h (Port 0~2)   O BFF Capability Enable for Port 0~2
                              E4h: Bit [18]              Bit [15] : enable OBFF capability
                10h           74h (Port 0~2)   PHY Parameter 0 for Port 0~2
                              74h: Bit [20:16]         Bit [4:0]: C_DRV_LVL_3P5_NOM
                              74h: Bit [25:21]         Bit [9:5]: C_DRV_LVL_6P0_NOM
                              74h: Bit [30:26]         Bit [14:10]: C_DRV_LVL_HALF_NOM
                              8Ch (Port 0~2)   TL_CSR[31] for Port 0~2
                              8Ch: Bit [31]            Bit [15] : P35_GEN2_MODE
                12h           78h (Port 0~2)   PHY Parameter 1 for Port 0~2
                              78h: Bit [20:16]           Bit [4:0]: C_EMP_POST _GEN1_3P5_NOM
                              78h: Bit [25:21]           Bit [9:5]: C_EMP_POST _GEN2_3P5_NOM
                              78h: Bit [30:26]           Bit [14:10]: C_EMP_POST _GEN2_6P0_NOM
                              8Ch (Port 0~2)   XPIP_CSR6[0] for Port 0~2
                              8Ch: Bit [16]              Bit [15]: XPIP_CSR6[0]
                14h           7Ch (Port 0~2)   PHY Parameter 2 for Port 0~2
                              7Ch: Bit [3:0]           Bit [3:0]: C_TX_PHY_LATENCY
                              7Ch: Bit [6:4]           Bit [6:4]: C_REC_DETECT_USEC
                              90h (Port 0~2)   PHY Parameter 3 for Port 0~2
                              90h: Bit [19:15]         Bit [11:7]: C_EMP_POST_HALF_DELTA
                              8Ch (Port 0~2)   XPIP_CSR6[4:1] for Port 0~2
                              8Ch: Bit [20:17]         Bit [15:12]: XPIP_CSR6[4:1]
                16h           84h (Port 0~2)   XPIP_CSR4[15:0] for Port 0~2
                              84h: Bit [15:0]          Bit [15:0]: XPIP_CSR4[15:0]
                18h           84h (Port 0~2)   XPIP_CSR4[31:16] for Port 0~2
                              84h: Bit [31:16]         Bit [15:0]: XPIP_CSR4[31:16]
                1A            88h (Port 0~2)   XPIP_CSR5[15:0] for Port 0~2
                              88h: Bit [15:0]  Bit [15:0]: XPIP_CSR5[15:0]
                 1C           88h (Port 0~2)   XPIP_CSR5[28:16] for Port 0~2
                              88h: Bit [23:16]         Bit [7:0]: XPIP_CSR5[23:16]
                              8Ch (Port 0~2)   XPIP_CSR6[7:5] for Port 0~2
                              8Ch: Bit [23:21]          Bit [10:8]: XPIP_CSR6[7:5]
                              98h (Port 0~2)   BUFFER_CTRL[4:0] for Port 0~2
                              98h: Bit [20:16]          Bit [15:11]: Reference clock Buffer control
                 1E           90h (Port 0~2)   PHY parameter 3 for Port 0~2
                              90h: Bit [21:20]         Bit [1:0]: C_DRV_LVL_3P5_DELTA
                              90h: Bit [23:22]         Bit [3:2]: C_DRV_LVL_6P0_DELTA
                              90h: Bit [25:24]         Bit [5:4]: C_DRV_LVL_HALF_DELTA
                              90h: Bit [27:26]         Bit [7:6]: C_EMP_POST _GEN1_3P5_DELTA
                              90h: Bit [29:28]         Bit [9:8]: C_EMP_POST _GEN2_3P5_DELTA
                              90h: Bit [31:30]         Bit [11:10]: C_EMP_POST _GEN2_6P0_DELTA
                              8Ch (Port 0~2)   MAC control parameter for Port 0~2
                              8Ch: Bit [29:26]          Bit [15:12]: MAC_CTR
                20h           78h (Port 0)     FTS Number for Port 0
                              78h: Bit [7 :0]            Bit [7:0]: FTS number at receiver side
                              68h (Port 0)     De skew Mode Select for Port 0
                              68h: Bit [14:13]           Bit [9:8]: deskew mode select
                              78h (Port 0)     Scrambler Control for Port 0
                              78h: Bit [9:8]             Bit [11:10]: scrambler control
                              78h: Bit [10]              Bit [12]: L0s
                              78h (Port 0)     Change_Speed_Sel for Port 0
                              78h: Bit [13:12]           Bit [14:13]: Change Speed select
PI7C9X2G303EL                                       Page 31 of 91                                          September 2017
Document Number DS40025 Rev 2-2                    www.diodes.com                                          © Diodes Incorporated


                                                                                                     PI7C9X2G303EL
         ADDRESS              PCI CFG O FFSET   DESCRIPTIO N
                              78h (Port 0)      Change_Speed_En for Port 0
                              78h: Bit [14]               Bit [15]: Change Speed enable
                22h           78h (Port 1)      FTS Number for Port 1
                              78h: Bit [7 :0]             Bit [7:0]: FTS number at receiver side
                              68h (Port 1)      De skew Mode Select for Port 01Bit [9:8]: deskew mode select
                              68h: Bit [14:13]
                              78h (Port 1)      Scrambler Control for Port 1
                              78h: Bit [9:8]              Bit [11:10]: scrambler control
                              78h: Bit [10]               Bit [12]: L0s
                              78h (Port 1)      Change_Speed_Sel for Port 1
                              78h: Bit [13:12]            Bit[ 14:13]: Change Speed select
                              78h (Port 1)      Change_Speed_En for Port 1
                              78h: Bit [14]               Bit [15]: Change Speed enable
                24h           78h (Port 2)      FTS Number for Port 2
                              78h: Bit [7 :0]             Bit [7:0]: FTS number at receiver side
                              68h (Port 2)      De skew Mode Select for Port 2
                              68h: Bit [14:13]            Bit [9:8]: deskew mode select
                              78h (Port 2)      Scrambler Control for Port 2
                              78h: Bit [9:8]              Bit [11:10]: scrambler control
                              78h: Bit [10]               Bit [12]: L0s
                              78h (Port 2)      Change_Speed_Sel for Port 2
                              78h: Bit [13:12]            Bit [14:13]: Change Speed select
                              78h (Port 2)      Change_Speed_En for Port 2
                              78h: Bit [14]               Bit [15]: Change Speed enable
                30h           7Ch (Port 0)      PHY Parameter2_1 for Port 0
                              7Ch: Bit [30 :16]           Bit [14:0]: PHY parameter 2
                32h           7Ch (Port 1)      PHY Parameter2_1 for Port 1
                              7Ch: Bit [30 :16]           Bit [14:0]: PHY parameter 2
                34h           7Ch (Port 2)      PHY Parameter2_1 for Port 2
                              7Ch: Bit [30 :16]           Bit [14:0]: PHY parameter 2
                40h           7Ch (Port 0)      PHY Parameter 2_1 for Port 0
                              7Ch: Bit [12 :8]            Bit [4:0]: PHY parameter 2
                              90h (Port 0)      PHY Parameter 3 for Port 0
                              90h: Bit [6 :0]           Bit [11:5]: PHY parameter 3
                              F0h (Port 0)      Se lectable De-emphasis for Port 0
                              F0h: Bit [6]              Bit [12]: Selectable De-emphasis
                              78h (Port 0)      Compliance to Detect for Port 0
                              78h: Bit [11]             Bit [13]: compliance to detect
                              8Ch (Port 0)      DO _CHG_DATA_CNT_SEL for Port 0
                              8Ch: Bit [9:8]             Bit [15:14] : DO_CHG_DATA_CNT_SEL
                42h           7Ch (Port 1)      PHY Parameter 2_1 for Port 1
                              7Ch: Bit [12 :8]            Bit [4:0]: PHY parameter 2
                              90h (Port 1)      PHY Parameter 3 for Port 1
                              90h: Bit [6 :0]           Bit [11:5]: PHY parameter 3
                              F0h (Port 0)      Se lectable De-emphasis for Port 1
                              F0h: Bit [6]              Bit [12]: Selectable De-emphasis
                              78h (Port 1)      Compliance to Detect for Port 1
                              78h: Bit [11]             Bit [13]: compliance to detect
                              8Ch (Port 1)      DO _CHG_DATA_CNT_SEL for Port 1
                              8Ch: Bit [9:8]            Bit [15:14] : DO_CHG_DATA_CNT_SEL
                44h           7Ch (Port 2)      PHY Parameter 2_1 for Port 2
                              7Ch: Bit [12 :8]            Bit [4:0]: PHY parameter 2
PI7C9X2G303EL                                        Page 32 of 91                                           September 2017
Document Number DS40025 Rev 2-2                     www.diodes.com                                           © Diodes Incorporated


                                                                                                          PI7C9X2G303EL
         ADDRESS              PCI CFG O FFSET  DESCRIPTIO N
                              90h (Port 2)     PHY Parameter 3 for Port 2
                              90h: Bit [6 :0]          Bit [11:5]: PHY parameter 3
                              F0h (Port 2)     Se lectable De-emphasis for Port 2
                              F0h: Bit [6]             Bit [12]: Selectable De-emphasis
                              78h (Port 2)     Compliance to Detect for Port 2
                              78h: Bit [11]            Bit [13]: compliance to detect
                              8Ch (Port 2)     DO _CHG_DATA_CNT_SEL for Port 2
                              8Ch: Bit [9:8]            Bit [15:14] : DO_CHG_DATA_CNT_SEL
                50h           44h (Port 0)     No_Soft_Reset for Port 0
                              44h: Bit [3]               Bit [0]: No_Soft_Reset.
                              40h (Port 0)     Powe r Management Capability for Port 0
                              40h: Bit [24:22]           Bit [3:1]: AUX Current.
                              40h: Bit [25]              Bit [4]: read only as 1 to indicate Bridge supports the D1 power
                                                          management state
                              40h: Bit [26]              Bit [5]: read only as 1 to indicate Bridge supports the D2 power
                                                          management state
                              40h: Bit [29:28]           Bit [7:6]: PME Support for D2 and D1 states
                51h           44h (Port 0)     Powe r Management Data for Port 0
                              44h: Bit [31:24]           Bit [15:8]: read only as Data register
                52h           44h (Port 1)     No_Soft_Reset for Port 1
                              44h: Bit [3]               Bit [0]: No_Soft_Reset.
                              40h (Port 1)     Powe r Management Capability for Port 1
                              40h: Bit [24:22]           Bit [3:1]: AUX Current.
                              40h: Bit [25]              Bit [4]: read only as 1 to indicate Bridge supports the D1 power
                                                          management state
                              40h: Bit [26]              Bit [5]: read only as 1 to indicate Bridge supports the D2 power
                                                          management state
                              40h: Bit [29:28]           Bit [7:6]: PME Support for D2 and D1 states
                53h           44h (Port 1)     Powe r Management Data for Port 1
                              44h: Bit [31:24]           Bit [15:8]: read only as Data register
                54h           44h (Port 2)     No_Soft_Reset for Port 2
                              44h: Bit [3]               Bit [0]: No_Soft_Reset
                              40h (Port 2)     Powe r Management Capability for Port 2
                              40h: Bit [24:22]           Bit [3:1]: AUX Current
                              40h: Bit [25]              Bit [4]: read only as 1 to indicate Bridge supports the D1 power
                                                          management state
                              40h: Bit [26]              Bit [5]: read only as 1 to indicate Bridge supports the D2 power
                                                          management state
                              40h: Bit [29:28]           Bit [7:6]: PME Support for D2 and D1 states
                55h           44h (Port 2)     Powe r Management Data for Port 2
                              44h: Bit [31:24]           Bit [15:8]: read only as Data register
                60h           D0h (Port 0)     Slot Clock Configuration for Port 0
                              D0h: Bit [28]              Bit [1]: When set, the component uses the clock provided on the
                                                          connector
                              40h (Port 0)     De vice specific Initialization for Port 0
                              40h: Bit[21]               Bit [2]: When set, the DSI is required
                              144h (Port 0)    LPVC Count for Port 0
                              144h: Bit [4]              Bit [3]: When set, the VC1 is allocated to LPVC of Egress Port 0
                              CCh (Port 0)     Port Number for Port 0
                              CCh: Bit [26:24]           Bit [6:4]: It represents the logic port numbering for physical port 0
                              154h (Port 0)    VC0 TC/VC Map for Port 0
                              154h: Bit [7:1]            Bit [15:9]: When set, it indicates the corresponding T C is mapped
                                                          into VC0
PI7C9X2G303EL                                       Page 33 of 91                                                   September 2017
Document Number DS40025 Rev 2-2                    www.diodes.com                                                    © Diodes Incorporated


                                                                                                           PI7C9X2G303EL
         ADDRESS              PCI CFG O FFSET   DESCRIPTIO N
                62h           C0h (Port 1)      PCIe Capability Slot Implemented for Port 1
                              C0h: Bit [24]               Bit [0]: When set, the slot is implemented for Port 1
                              D0h (Port 1)      Slot Clock Configuration for Port 1
                              D0h: Bit [28]               Bit [1]: When set, the component uses the clock provided on the
                                                             Connector
                              40h (Port 1)      De vice specific Initialization for Port 1
                              40h: Bit [21]               Bit [2]: When set, the DSI is required
                              144h (Port 1)     LPVC Count for Port 1
                              144h: Bit [4]               Bit [3]: When set, the VC1 is allocated to LPVC of Egress Port 1
                              CCh (Port 1)      Port Number for Port 1
                              CCh: Bit [26:24]            Bit [6:4]: It represents the logic port numbering for physical port 1
                              154h (Port 1)     VC0 TC/VC Map for Port 1
                              154h: Bit [7:1]             Bit [15:9]: When set, it indicates the corresponding T C is mapped
                                                           into VC0
                64h           C0h (Port 2)      PCIe Capability Slot Implemented for Port 2
                              C0h: Bit [24]               Bit [0]: When set, the slot is implemented for Port 2
                              D0h (Port 2)      Slot Clock Configuration for Port 2
                              D0h: Bit [28]               Bit [1]: When set, the component uses the clock provided on the
                                                           Connector
                              40h (Port 2)      De vice specific Initialization for Port 2
                              40h: Bit [21]               Bit [2]: When set, the DSI is required
                              144h (Port 2)     LPVC Count for Port 2
                              144h: Bit [4]               Bit [3]: When set, the VC1 is allocated to LPVC of Egress Port 2
                              CCh (Port 2)      Port Number for Port 2
                              CCh: Bit [26:24]            Bit [6:4]: It represents the logic port numbering for physical port 2
                              154h (Port 2)     VC0 TC/VC Map for Port 2
                              154h: Bit [7:1]             Bit [15:9]: When set, it indicates the corresponding T C is mapped
                                                           into VC0
                70h           214h (Port 0)     Powe r Budget Register for Port 0
                              214h: Bit [7:0]             Bit [7:0]: Base Power
                              214h: Bit [9:8]             Bit [9:8]: Data Scale
                              214h: Bit [14:13]           Bit [11:10]: PM State
                              218h: Bit [0]               Bit [15]: System Allocated
                72h           214h (Port 1)     Powe r Budget Register for Port 1
                              214h: Bit [7:0]             Bit [7:0]: Base Power
                              214h: Bit [9:8]             Bit [9:8]: Data Scale
                              214h: Bit [14:13]           Bit [11:10]: PM State
                              218h: Bit [0]               Bit [15]: System Allocated
                74h           214h (Port 2)     Powe r Budget Register for Port 2
                              214h: Bit [7:0]             Bit [7:0]: Base Power
                              214h: Bit [9:8]             Bit [9:8]: Data Scale
                              214h: Bit [14:13]           Bit [11:10]: PM State
                              218h: Bit [0]               Bit [15]: System Allocated
                80h           74h (Port 0)      PM Control Parameter for Port 0
                              74h: Bit [13:8]             Bit [1:0] : D3 enters L1
                                                          Bit [3:2] : L1 delay count select
                                                           Bit [5:4] : L0s enable
                              74h: Bit [14]               Bit [6] : Disable Rx polarity capability
                              70h (Port 0)      VGA De code Enable for Port 0
                              70h: Bit [31]               Bit [7]: Enable VGA decode
                              88h (Port 0)      XPIP_CSR5[31:24] for Port 0
                              88h: Bit [31:24]  Bit[15:8]: XPIP_CSR5[31:24]
PI7C9X2G303EL                                        Page 34 of 91                                                   September 2017
Document Number DS40025 Rev 2-2                    www.diodes.com                                                     © Diodes Incorporated


                                                                                                       PI7C9X2G303EL
         ADDRESS              PCI CFG O FFSET  DESCRIPTIO N
                82h           74h (Port 1)     PM Control Parameter for Port 1
                              74h: Bit [13:8]           Bit [1:0] : D3 enters L1
                                                        Bit [3:2] : L1 delay count select
                                                         Bit [5:4] : L0s enable
                              74h: Bit [14]             Bit [6] : Disable Rx polarity capability
                              70h (Port 1)     VGA De code Enable for Port 1
                              70h: Bit [31]             Bit [7]: Enable VGA decode
                              88h (Port 1)     XPIP_CSR5[31:24] for Port 1
                              88h: Bit [31:24]          Bit[15:8]: XPIP_CSR5[31:24]
                84h           74h (Port 2)     PM Control Parameter for Port 2
                              74h: Bit [13:8]           Bit [1:0] : D3 enters L1
                                                        Bit [3:2] : L1 delay count select
                                                         Bit [5:4] : L0s enable
                              74h: Bit [14]             Bit [6] : Disable Rx polarity capability
                              70h (Port 2)     VGA De code Enable for Port 2
                              70h: Bit [31]             Bit [7]: Enable VGA decode
                              88h (Port 2)     XPIP_CSR5[31:24] for Port 2
                              88h: Bit [31:24]          Bit[15:8]: XPIP_CSR5[31:24]
                92h           D4h (Port 1)     Slot Capability 0 of Port 1
                              D4h: Bit [15:0]           Bit [15:0]: Mapping to the low word of slot capability register
                94h           D4h (Port 2)     Slot Capability 0 of Port 2
                              D4h: Bit [15:0]           Bit [15:0]: Mapping to the low word of slot capability register
               A2h            D4h (Port 1)     Slot Capability 1 of Port 1
                              D4h: Bit [31:16]          Bit [15:0]: Mapping to the high word of slot capability register
               A4h            D4h (Port 2)     Slot Capability 1 of Port 2
                              D4h: Bit [31:16]          Bit [15:0]: Mapping to the high word of slot capability register
                B0h           80h (Port 0)     XPIP_CSR3_0 for Port 0
                              80h: Bit [15:0]           Bit [15:0]: XPIP_CSR3[15:0]
                B2h           80h (Port 1)     XPIP_CSR3_0 for Port 1
                              80h: Bit [15:0]           Bit [15:0]: XPIP_CSR3[15:0]
                B4h           80h (Port 2)     XPIP_CSR3_0 for Port 2
                              80h: Bit [15:0]           Bit [15:0]: XPIP_CSR3[15:0]
                C0h           80h (Port 0)     XPIP_CSR3_1 for Port 0
                              80h: Bit [31:16]          Bit [15:0]: XPIP_CSR3[31:16]
                C2h           80h (Port 1)     XPIP_CSR3_1 for Port 1
                              80h: Bit [31:16]          Bit [15:0]: XPIP_CSR3[31:16]
                C4h           80h (Port 2)     XPIP_CSR3_1 for Port 2
                              80h: Bit [31:16]          Bit [15:0]: XPIP_CSR3[31:16]
               D0h            70h (Port 0)     Re play Time-out Counter for Port 0
                              70h: Bit [12:0]           Bit [12:0]: Relay T ime-out Counter
                              8Ch (Port 0)     REV_TS_CTR for Port 0
                              8Ch: Bit [25:24]          Bit [14:13] REV_T S_CTR
               D2h            70h (Port 1)     Re play Time-out Counter for Port 1
                              70h: Bit [12:0]           Bit [12:0]: Relay T ime-out Counter
                              8Ch (Port 1)     REV_TS_CTR for Port 1
                              8Ch: Bit [25:24]          Bit [14:13] REV_T S_CTR
               D4h            70h (Port 2)     Re play Time-out Counter for Port 2
                              70h: Bit [12:0]           Bit [12:0]: Relay T ime-out Counter
                              8Ch (Port 2)     REV_TS_CTR for Port 2
                              8Ch: Bit [25:24]          Bit [14:13] REV_T S_CTR
                E0h           70h (Port 0)     Acknowledge Latency Timer for Port 0
                              70h: Bit [30:16]          Bit [30:16]: Acknowledge Latency Timer
                E2h           70h (Port 1)     Acknowledge Latency Timer for Port 1
                              70h: Bit [30:16]          Bit [30:16]: Acknowledge Latency Timer
                E4h           70h (Port 2)     Acknowledge Latency Timer for Port 2
                              70h: Bit [30:16]          Bit [30:16]: Acknowledge Latency Timer
PI7C9X2G303EL                                       Page 35 of 91                                                 September 2017
Document Number DS40025 Rev 2-2                   www.diodes.com                                                   © Diodes Incorporated


                                                                                                        PI7C9X2G303EL
         ADDRESS              PCI CFG O FFSET   DESCRIPTIO N
                              15Ch (Port 0)     VC1 MAX Time Slot and TC/VC Map for Port 0
                F0h           15Ch: Bit [22:16]        Bit [6:0]: T he maximum time slot supported by VC1
                              160h (Port 0)     TC/VC Map for Port 0
                              160h: Bit [7:0]          Bit [15:8]: When set, it indicates the corresponding T C is mapped
                                                        into VC1
                F2h           15Ch (Port 1)     VC1 MAX Time Slot and TC/VC Map for Port 1
                              15Ch: Bit [22:16]        Bit [6:0]: T he maximum time slot supported by VC1
                              160h (Port 1)     TC/VC Map for Port 1
                              160h: Bit [7:0]          Bit [15:8]: When set, it indicates the corresponding T C is mapped
                                                        into VC1
                F4h           15Ch (Port 2)     VC1 MAX Time Slot and TC/VC Map for Port 2
                              15Ch: Bit [22:16]        Bit [6:0]: T he maximum time slot supported by VC1
                              160h (Port 2)     TC/VC Map for Port 2
                              160h: Bit [7:0]          Bit [15:8]: When set, it indicates the corresponding T C is mapped
                                                        into VC1
PI7C9X2G303EL                                       Page 36 of 91                                                 September 2017
Document Number DS40025 Rev 2-2                   www.diodes.com                                                   © Diodes Incorporated


                                                                                               PI7C9X2G303EL
6.2     SMBus INTERFACE
The PI7C9X2G303EL p rovides the System Management Bus (SM Bus), a two-wire interface through which a
simp le device can communicate with the rest of the system. The SMBus interface on the PI7C9X2G303EL is a bi-
directional slave interface. It can receive data fro m the SMBus master or send data to the master. The interface
allo ws full access to the configuration registers. A SMBus master, such as the processor or other SMBus devices,
can read or write to every RW configuration reg ister (read/write register). In addition, the RO and HwInt registers
(read-only and hard ware in itialized registers) that can be auto-loaded by the EEPROM interface can also be read
and written by the SMBus interface. This feature allows increases in the system expandability and flexib ility in
system implementation.
          Figure 6-1 SMBus Architecture Implementati on on PI7C9X2G303EL
The SMBus interface on the PI7C9X2G303EL consists of one SMBus clock pin (SMBCLK), a SMBus data pin
(SM BDATA), and 3 SM Bus address pins (GPIO[5:7]). The SM Bus clock pin provides or receives the clock signal.
The SMBus data pin facilitates the data transmission and reception. Both of the clock and data pins are bi-
directional. The SM Bus address pins determine the address to which the PI7C9X2G303EL responds to. The SM Bus
address pins generate addresses according to the following table:
        Table 6-1 SMBus Address Pin Configuration
              BIT    SMBus Address
               0     GPIO[5]
               1     GPIO[6]
               2     GPIO[7]
               3     1
               4     0
               5     1
               6     1
PI7C9X2G303EL                                         Page 37 of 91                                   September 2017
Document Number DS40025 Rev 2-2                      www.diodes.com                                   © Diodes Incorporated


                                                                                                             PI7C9X2G303EL
7 REGISTER DESCRIPTION
7.1            REGISTER TYPES
                REGISTER TYPE                     DEFINITIO N
                HwInt                             Hardware Initialization
                RO                                Read Only
                RW                                Read / Write
                RWC                               Read / Write 1 to Clear
                RWCS                              Sticky – Read Only / Write 1 to Clear
                RWS                               Sticky – Read / Write
                ROS                               Sticky – Read Only
7.2            TRANSPARENT MODE CONFIGURATION REGISTERS
When the port of the Switch is set to operate at the transparent mode, it is represented by a logical PCI-to-PCI
Bridge that imp lements type 1 configuration space header. The following table details the allocation of the register
fields of the PCI 2.3 compatible type 1 configuration space header.
                      31 –24                 23 – 16                    15 – 8                     7 –0            BYTE O FFSET
                                Device ID                                          Vendor ID                             00h
                              Primary Status                                       Command                               04h
                                            Class Code                                         Revision ID               08h
                     Reserved             Header T ype         Primary Latency Timer        Cache Line Size              0Ch
                                                          Reserved                                                   10h – 17h
                Secondary Latency        Subordinate Bus            Secondary Bus         Primary Bus Number             18h
                      T imer                 Number                    Number
                             Secondary Status                     I/O Limit Address         I/O Base Address             1Ch
                          Memory Limit Address                                Memory Base Address                        20h
                   Prefetchable Memory Limit Address                  Prefetchable Memory Base Address                   24h
                                      Prefetchable Memory Base Address Upper 32-bit                                      28h
                                     Prefetchable Memory Limit Address Upper 32-bit                                      2Ch
                      I/O Limit Address Upper 16-bit                     I/O Base Address Upper 16-bit                   30h
                                             Reserved                                     Capability Pointer to          34h
                                                                                                80h(40h)
                                                          Reserved                                                       38h
                              Bridge Control                        Interrupt Pin             Interrupt Line             3Ch
                      Power Management Capabilities            Next Item Pointer=4C         Capability ID=01             40h
                                                                          (5C)
                     PM Data              PPB Support                       Power Management Data                        44h
                                           Extensions
                             Message Control                    Next Item Pointer=:         Capability ID=05             4Ch
                                                                           64
                                                       Message Address                                                   50h
                                                   Message Upper Address                                                 54h
                                 Reserved                                        Message Data                            58h
                              VPD Register                     Next Item Pointer=64         Capability ID=03             5Ch
                                                     VPD Data Register                                                   60h
                          Length in Bytes (34h)                Next Item Pointer=B0         Capability ID=09             64h
                                                        XPIP_CSR0                                                        68h
                                                        XPIP_CSR1                                                        6Ch
                           ACK Latency T imer                               Replay T ime-out Counter                     70h
                             PHY Parameter 0                                     Switch Modes                            74h
                             PHY Parameter 1                                      XPIP_CSR2                              78h
                                                      PHY Parameter 2                                                    7Ch
                                                        XPIP_CSR3                                                        80h
                                                        XPIP_CSR4                                                        84h
                                                        XPIP_CSR5                                                        88h
                    XPIP_CSR7               XPIP_CSR6                               T L_CSR                              8Ch
PI7C9X2G303EL                                             Page 38 of 91                                            September 2017
Document Number DS40025 Rev 2-2                          www.diodes.com                                            © Diodes Incorporated


                                                                                                           PI7C9X2G303EL
                     31 –24                   23 – 16                     15 – 8                   7 –0          BYTE O FFSET
                                                       PHY parameter 3                                                  90h
                     Reserved               PHYL1 RXEQ                      PHY T X Margin parameter                    94h
                     Reserved                Buffer Ctrl                             OP Mode                            98h
                                                            Reserved                                              (9Ch – ACh)
                                  Reserved                        Next Item Pointer=C0          SSID/SSVID              B0h
                                                                                            Capability ID=0D
                                    SSID                                              SSVID                             B4h
                                                    GPIO Data and Control                                               B8h
                              EEPROM Data                          EEPROM Address           EEPROM Control             BCh
                    PCI Express Capabilities Register             Next Item Pointer=00      Capability ID=10            C0h
                                                       Device Capabilities                                              C4h
                               Device Status                                      Device Control                        C8h
                                                        Link Capabilities                                              CCh
                                Link Status                                        Link Control                        D0h
                                                        Slot Capabilities                                              D4h
                                 Slot Status                                       Slot Control                        D8h
                                                            Reserved                                                   DCh
                                                            Reserved                                                    E0h
                                                     Device Capabilities 2                                              E4h
                                                   Device Status / Control 2                                            E8h
                                                       Link Capabilities 2                                             ECh
                                                    Link Status /Control 2                                              F0h
                                                       Slot Capabilities 2                                              F4h
                                                     Slot Status /Control 2                                             F8h
                                                            Reserved                                                    FCh
Other than the PCI 2.3 co mpatib le configuration space header, the Switch also imp lements PCI express extended
configuration space header, which includes advanced error reporting, virtual channel, and power budgeting
capability registers. The following table details the allocation of the register fields of PCI express extended
capability space header. The first extended capability always begins at offset 100h with a PCI Exp ress Enhanced
Capability header and the rest of capabilities are located at an offset greater than 0FFh relative to the beginning of
PCI compatible configuration space.
                      31 –24                   23 – 16                     15 - 8                  7 –0          BYTE O FFSET
                 Next Capability Offset=140h           Cap.        PCI Express Extended Capability ID=0001h            100h
                                                      Version
                                              Uncorrectable Error Status Register                                      104h
                                              Uncorrectable Error Mask Register                                        108h
                                             Uncorrectable Error Severity Register                                     10Ch
                                               Correctable Error Status Register                                       110h
                                               Correctable Error Mask Register                                         114h
                                       Advanced Error Capabilities and Control Register                                118h
                                                      Header Log Register                                         11Ch – 128h
                                                            Reserved                                              12Ch – 13Fh
                 Next Capability Offset=20Ch           Cap.        PCI Express Extended Capability ID=0002h            140h
                                                      Version
                                                 Port VC Capability Register 1                                         144h
               VC Arbitration T able                          Port VC Capability Register 2                            148h
                     Offset=3
                          Port VC Status Register                            Port VC Control Register                  14Ch
               Port Arbitration Table                     VC Resource Capability Register (0)                          150h
                     Offset=4
                                               VC Resource Control Register (0)                                        154h
                      VC Resource Status Register (0)                                Reserved                          158h
               Port Arbitration Table                     VC Resource Capability Register (1)                          15Ch
                     Offset=6
                                               VC Resource Control Register (1)                                        160h
                      VC Resource Status Register (1)                                Reserved                          164h
                                                            Reserved                                              16Ch – 168h
                                             VC Arbitration T able with 32 Phases                                 170h – 17Ch
                                        Port Arbitration T able with 128 Phases for VC0                           180h – 1BCh
                                        Port Arbitration T able with 128 Phases for VC1                           1C0h – 1FCh
                                                            Reserved                                              200h – 20Bh
PI7C9X2G303EL                                               Page 39 of 91                                        September 2017
Document Number DS40025 Rev 2-2                           www.diodes.com                                         © Diodes Incorporated


                                                                                                              PI7C9X2G303EL
                     31 –24                  23 – 16                    15 - 8                      7 –0                 BYTE O FFSET
               Next Capability Offset=220/230h       Cap.        PCI Express Extended Capability ID=0004h                      20Ch
                                                   Version
                                             Reserved                                       Data Select Register               210h
                                                       Data Register                                                           214h
                                             Reserved                                          Power Budget                    218h
                                                                                             Capability Register
                                             Reserved                                                                          21Ch
                 Next Capability Offset=000h          Cap        PCI Express Extended Capability ID=000Dh                      220h
                                                    version
                               ACS Control                                       ACS Capability                                224h
                                             Reserved                                       Egress Control Vector              228h
                                                          Reserved                                                             22Ch
                 Next Capability Offset=000h          Cap        PCI Express Extended Capability ID=0018h                      230h
                                                    version
               Reserved Max No-           Max No-Snoop          Reserved        Max         Max Snoop Latency                  234h
                            Snoop          Latency Value                       Snoop                Value
                           Latency                                            Latency
                             Scale                                              Scale
7.2.1        VENDOR ID REGISTER – OFFSET 00h
               BIT        FUNCTIO N              TYPE       DESCRIPTIO N
               15:0       Vendor ID                RO       Identifies Pericom as the vendor of this device. The default value may be
                                                            changed by SMBus or auto-loading from EEPROM.
                                                            Reset to 12D8h.
7.2.2        DEVICE ID REGISTER – OFFSET 00h
               BIT        FUNCTIO N              TYPE       DESCRIPTIO N
                                                            Identifies this device as the PI7C9X2G303EL. The default value may be
                                                            changed by SMBus or auto-loading from EEPROM.
               31:16      Device ID                RO
                                                            Resets to 2303h.
7.2.3        COMMAND REGISTER – OFFSET 04h
               BIT        FUNCTIO N               TYPE      DESCRIPTIO N
                                                            0b: Ignores I/O transactions on the primary interface
                                                            1b: Enables responses to I/O transactions on the primary interface
               0          I/O Space Enable         RW
                                                            Resets to 0b.
                                                            0b: Ignores memory transactions on the primary interface
                          Memory Space                      1b: Enables responses to memory transactions on the primary interface
               1                                   RW
                          Enable
                                                            Reset to 0b.
                                                            0b: Does not initiate memory or I/O transactions on the upstream port and
                                                                handles as an Unsupported Request (UR) to memory and I/O transactions
                                                                on the downstream port. For Non-Posted Requests, a completion with UR
                                                                completion status must be returned
               2          Bus Master Enable        RW
                                                            1b: Enables the Switch Port to forward memory and I/O Read/Write
                                                                transactions in the upstream direction
                                                            Reset to 0b.
               3          Special Cycle Enable     RO       Does not apply to PCI Express. Must be hardwired to 0b.
                          Memory Write And                  Does not apply to PCI Express. Must be hardwired to 0b.
               4                                   RO
                          Invalidate Enable
               5          VGA Palette Snoop        RO       Does not apply to PCI Express. Must be hardwired to 0b.
PI7C9X2G303EL                                            Page 40 of 91                                                   September 2017
Document Number DS40025 Rev 2-2                        www.diodes.com                                                    © Diodes Incorporated


                                                                                                             PI7C9X2G303EL
               BIT        FUNCTIO N             TYPE    DESCRIPTIO N
                          Enable
                                                        0b: Switch may ignore any parity errors that it detects and continue normal
                                                           operation
                          Parity Error
               6                                 RW     1b: Switch must take its normal action when a parity error is detected
                          Response Enable
                                                        Reset to 0b.
               7          Wait Cycle Control     RO     Does not apply to PCI Express. Must be hardwired to 0.
                                                        0b: Disables the reporting of Non-fatal and Fatal errors detected by the
                                                            Switch to the Root Complex
               8          SERR# enable           RW     b1: Enables the Non-fatal and Fatal error reporting to Root Complex
                                                        Reset to 0b.
                          Fast Back-to-Back             Does not apply to PCI Express. Must be hardwired to 0b.
               9                                 RO
                          Enable
                                                        Controls the ability of a PCI Express device to generate INTx Interrupt
                                                        Messages. In the Switch, this bit does not affect the forwarding of INTx
               10         Interrupt Disable      RW     messages from the downstream ports.
                                                        Reset to 0b.
               15:11      Reserved              RsvdP   Not Support.
7.2.4        PRIMARY STATUS REGISTER – OFFSET 04h
               BIT        FUNCTIO N             TYPE    DESCRIPTIO N
               18:16      Reserved              RsvdP   Not Support.
                                                        Indicates that an INTx Interrupt Message is pending internally to the device.
               19         Interrupt Status       RO     In the Switch, the forwarding of INTx messages from the downstream device
                                                        of the Switch port is not reflected in this bit. Must be hardwired to 0b.
                                                        Set to 1 to enable support for the capability list (offset 34h is the pointer to
                                                        the data structure).
               20         Capabilities List      RO
                                                        Reset to 1b.
               21         66MHz Capable          RO     Does not apply to PCI Express. Must be hardwired to 0b.
               22         Reserved              RsvdP   Not Support.
                          Fast Back-to-Back             Does not apply to PCI Express. Must be hardwired to 0b.
               23                                RO
                          Capable
                                                        Set to 1 (by a requester) whenever a Parity error is detected or forwarded on
                                                        the primary side of the port in a Switch.
                          Master Data Parity
               24                               RWC
                          Error                         If the Parity Error Response Enable bit is cleared, this bit is never set.
                                                        Reset to 0b.
               26:25      DEVSEL# timing         RO     Does not apply to PCI Express. Must be hardwired to 0b.
                                                        Set to 1 (by a completer) whenever completing a request on the primary side
                          Signaled T arget              using the Completer Abort Completion Status.
               27                                RO
                          Abort
                                                        Reset to 0b.
                                                        Set to 1 (by a requestor) whenever receiving a Completion with Completer
                          Received T arget              Abort Completion Status on the primary side.
               28                                RO
                          Abort
                                                        Reset to 0b.
                                                        Set to 1 (by a requestor) whenever receiving a Completion with Unsupported
                          Received Master               Request Completion Status on primary side.
               29                                RO
                          Abort
                                                        Reset to 0b.
                                                        Set to 1 when the Switch sends an ERR_FATAL or ERR_NONFATAL
                          Signaled System               Message, and the SERR Enable bit in the Command register is 1.
               30                               RWC
                          Error
                                                        Reset to 0b.
                                                        Set to 1 whenever the primary side of the port in a Switch receives a Poisoned
                                                        T LP.
               31         Detected Parity Error RWC
                                                        Reset to 0b.
PI7C9X2G303EL                                         Page 41 of 91                                                     September 2017
Document Number DS40025 Rev 2-2                      www.diodes.com                                                     © Diodes Incorporated


                                                                                                         PI7C9X2G303EL
7.2.5        REVISION ID REGISTER – OFFSET 08h
               BIT        FUNCTIO N          TYPE   DESCRIPTIO N
               7:0        Revision           RO     Indicates revision number of device. Hardwired to 05h.
7.2.6        CLASS CODE REGISTER – OFFSET 08h
               BIT        FUNCTIO N          TYPE   DESCRIPTIO N
               15:8       Programming         RO    Read as 00h to indicate no programming interfaces have been defined for
                          Interface                 PCI-to-PCI Bridges.
               23:16      Sub-Class Code      RO    Read as 04h to indicate device is a PCI-to-PCI Bridge.
               31:24      Base Class Code     RO    Read as 06h to indicate device is a Bridge device.
7.2.7         CACHE LINE REGISTER – OFFSET 0Ch
               BIT        FUNCTIO N          TYPE   DESCRIPTIO N
                                                    T he cache line size register is set by the system firmware and the operating
                                                    system cache line size. This field is implemented by PCI Express devices as a
                                                    RW field for legacy compatibility, but it has no impact on any PCI Express
               7:0        Cache Line Size     RW
                                                    device functionality.
                                                    Reset to 00h.
7.2.8        PRIMARY LATENCY TIMER REGISTER – OFFSET 0Ch
               BIT        FUNCTIO N          TYPE   DESCRIPTIO N
                          Primary Latency           Does not apply to PCI Express. Must be hardwired to 00h.
               15:8                           RO
                          timer
7.2.9        HEADER TYPE REGISTER – OFFSET 0Ch
               BIT        FUNCTIO N          TYPE   DESCRIPTIO N
                                                    Read as 01h to indicate that the register layout conforms to the standard PCI-
               23:16      Header T ype        RO
                                                    to-PCI Bridge layout.
7.2.10       PRIMARY BUS NUMBER REGISTER – OFFSET 18h
               BIT        FUNCTIO N          TYPE   DESCRIPTIO N
                                                    Indicates the number of the PCI bus to which the primary interface is
                                                    connected. T he value is set in software during configuration.
               7:0        Primary Bus Number  RW
                                                    Reset to 00h.
7.2.11        SECONDARY BUS NUMBER REGISTER – OFFSET 18h
               BIT        FUNCTIO N          TYPE   DESCRIPTIO N
                                                    Indicates the number of the PCI bus to which the secondary interface is
                          Secondary Bus             connected. T he value is set in software during configuration.
               15:8                           RW
                          Number
                                                    Reset to 00h.
PI7C9X2G303EL                                     Page 42 of 91                                                   September 2017
Document Number DS40025 Rev 2-2                  www.diodes.com                                                   © Diodes Incorporated


                                                                                                        PI7C9X2G303EL
7.2.12       SUBORDINATE BUS NUMBER REGISTER – OFFSET 18h
               BIT        FUNCTIO N          TYPE    DESCRIPTIO N
                                                     Indicates the number of the PCI bus with the highest number that is
                          Subordinate Bus            subordinate to the Bridge. T he value is set in software during configuration.
               23:16                          RW
                          Number
                                                     Reset to 00h.
7.2.13       SECONDARY LATENCY TIMER REGISTER – OFFSET 18h
               BIT        FUNCTIO N          TYPE    DESCRIPTIO N
                          Secondary Latency          Does not apply to PCI Express. Must be hardwired to 00h.
               31:24                          RO
                          T imer
7.2.14       I/O BASE ADDRESS REGISTER – OFFSET 1Ch
               BIT        FUNCTIO N          TYPE    DESCRIPTIO N
               3:0        32-bit Indicator    RO     Read as 01h to indicate 32-bit I/O addressing.
                                                     Defines the bottom address of the I/O address range for the Bridge to
                                                     determine when to forward I/O transactions from one interface to the other.
                                                     T he upper 4 bits correspond to address bits [15:12] and are writable. The
                          I/O Base Address           lower 12 bits corresponding to address bits [11:0] are assumed to be 0. The
               7:4                            RW
                          [15:12]                    upper 16 bits corresponding to address bits [31:16] are defined in the I/O base
                                                     address upper 16 bits address register.
                                                     Reset to 0h.
7.2.15       I/O LIMIT ADDRESS REGISTER – OFFSET 1Ch
               BIT        FUNCTIO N          TYPE    DESCRIPTIO N
               11:8       32-bit Indicator    RO     Read as 01h to indicate 32-bit I/O addressing.
                                                     Defines the top address of the I/O address range for the Bridge to determine
                                                     when to forward I/O transactions from one interface to the other. The upper 4
                                                     bits correspond to address bits [15:12] and are writable. The lower 12 bits
                          I/O Limit Address          corresponding to address bits [11:0] are assumed to be FFFh. T he upper 16
               15:12                          RW
                          [15:12]                    bits corresponding to address bits [31:16] are defined in the I/O limit address
                                                     upper 16 bits address register.
                                                     Reset to 0h.
7.2.16       SECONDARY STATUS REGISTER – OFFSET 1Ch
               BIT        FUNCTIO N          TYPE    DESCRIPTIO N
               20:16      Reserved           RsvdP   Not Support.
               21         66MHz Capable       RO     Does not apply to PCI Express. Must be hardwired to 0b.
               22         Reserved           RsvdP   Not Support.
                          Fast Back-to-Back          Does not apply to PCI Express. Must be hardwired to 0b.
               23                             RO
                          Capable
                                                     Set to 1 (by a requester) whenever a Parity error is detected or forwarded on
                                                     the secondary side of the port in a Switch.
                          Master Data Parity
               24                            RWC
                          Error                      If the Parity Error Response Enable bit is cleared, this bit is never set.
                                                     Reset to 0b.
PI7C9X2G303EL                                      Page 43 of 91                                                    September 2017
Document Number DS40025 Rev 2-2                   www.diodes.com                                                     © Diodes Incorporated


                                                                                                          PI7C9X2G303EL
               BIT        FUNCTIO N             TYPE    DESCRIPTIO N
               26:25      DEVSEL_L timing        RO     Does not apply to PCI Express. Must be hardwired to 0b.
                                                        Set to 1 (by a completer) whenever completing a request in the secondary
                          Signaled T arget              side using Completer Abort Completion Status.
               27                                RO
                          Abort
                                                        Reset to 0b.
                                                        Set to 1 (by a requestor) whenever receiving a Completion with Completer
                          Received T arget              Abort Completion Status in the secondary side.
               28                                RO
                          Abort
                                                        Reset to 0b.
                                                        Set to 1 (by a requestor) whenever receiving a Completion with Unsupported
                          Received Master               Request Completion Status in secondary side.
               29                                RO
                          Abort
                                                        Reset to 0b.
                                                        Set to 1 when the Switch sends an ERR_FATAL or ERR_NONFATAL
                          Received System               Message, and the SERR Enable bit in the Bridge Control register is 1.
               30                               RWC
                          Error
                                                        Reset to 0b.
                                                        Set to 1 whenever the secondary side of the port in a Switch receives a
                                                        Poisoned TLP.
               31         Detected Parity Error RWC
                                                        Reset to 0b.
7.2.17       MEMORY BASE ADDRESS REGISTER – OFFSET 20h
               BIT        FUNCTIO N             TYPE    DESCRIPTIO N
               3:0        Reserved              RsvdP   Not Support.
                                                        Defines the bottom address of an address range for the Bridge to determine
                                                        when to forward memory transactions from one interface to the other. T he
                          Memory Base                   upper 12 bits correspond to address bits [31:20] and are able to be written to.
               15:4                              RW
                          Address [15:4]                T he lower 20 bits corresponding to address bits [19:0] are assumed to be 0.
                                                        Reset to 000h.
7.2.18       MEMORY LIMIT ADDRESS REGISTER – OFFSET 20h
               BIT        FUNCTIO N             TYPE    DESCRIPTIO N
               19:16      Reserved              RsvdP   Not Support.
                                                        Defines the top address of an address range for the Bridge to determine when
                                                        to forward memory transactions from one interface to the other. T he upper
                          Memory Limit                  12 bits correspond to address bits [31:20] and are writable. T he lower 20 bits
               31:20                             RW
                          Address [31:20]               corresponding to address bits [19:0] are assumed to be FFFFFh.
                                                        Reset to 000h.
7.2.19       PREFETCHABLE MEMORY BASE ADDRESS REGISTER – OFFSET 24h
               BIT        FUNCTIO N             TYPE    DESCRIPTIO N
               3:0        64-bit addressing      RO     Read as 0001b to indicate 64-bit addressing.
                                                        Defines the bottom address of an address range for the Bridge to determine
                                                        when to forward memory read and write transactions from one interface to the
                                                        other. The upper 12 bits correspond to address bits [31:20] and are writable.
                          Prefetchable Memory
               15:4                              RW     T he lower 20 bits are assumed to be 0. T he memory base register upper 32
                          Base Address [31:20]
                                                        bits contain the upper half of the base address.
                                                        Reset to 000h.
PI7C9X2G303EL                                         Page 44 of 91                                                  September 2017
Document Number DS40025 Rev 2-2                      www.diodes.com                                                  © Diodes Incorporated


                                                                                                         PI7C9X2G303EL
7.2.20       PREFETCHABLE MEMORY LIMIT ADDRESS REGISTER – OFFSET 24h
               BIT        FUNCTIO N           TYPE   DESCRIPTIO N
               19:16      64-bit addressing    RO    Read as 0001b to indicate 64-bit addressing.
                                                     Defines the top address of an address range for the Bridge to determine when
                                                     to forward memory read and write transactions from one interface to the
                          Prefetchable Memory        other. The upper 12 bits correspond to address bits [31:20] and are writable.
               31:20      Limit Address        RW    T he lower 20 bits are assumed to be FFFFFh. The memory limit upper 32 bits
                          [31:20]                    register contains the upper half of the limit address.
                                                     Reset to 000h.
7.2.21       PREFETCHABLE MEMORY BASE ADDRESS UPPER 32-BITS REGISTER
             – OFFSET 28h
               BIT        FUNCTIO N           TYPE   DESCRIPTIO N
                                                     Defines the upper 32-bits of a 64-bit bottom address of an address range for
                          Prefetchable Memory        the Bridge to determine when to forward memory read and write transactions
               31:0       Base Address, Upper  RW    from one interface to the other.
                          32-bits [63:32]
                                                     Reset to 0000_0000h.
7.2.22       PREFETCHABLE MEMORY LIMIT ADDRESS UPPER 32-BITS REGISTER
             – OFFSET 2Ch
               BIT        FUNCTIO N           TYPE   DESCRIPTIO N
                                                     Defines the upper 32-bits of a 64-bit top address of an address range for the
                          Prefetchable Memory
                                                     Bridge to determine when to forward memory read and write transactions
                          Limit Address,
               31:0                            RW    from one interface to the other.
                          Upper 32-bits
                          [63:32]
                                                     Reset to 0000_0000h.
7.2.23       I/O BASE ADDRESS UPPER 16-BITS REGISTER – OFFSET 30h
               BIT        FUNCTIO N           TYPE   DESCRIPTIO N
                                                     Defines the upper 16-bits of a 32-bit bottom address of an address range for
                          I/O Base Address,          the Bridge to determine when to forward I/O transactions from one interface
               15:0       Upper 16-bits        RW    to the other.
                          [31:16]
                                                     Reset to 0000h.
7.2.24       I/O LIMIT ADDRESS UPPER 16-BITS REGISTER – OFFSET 30h
               BIT        FUNCTIO N           TYPE   DESCRIPTIO N
                                                     Defines the upper 16-bits of a 32-bit top address of an address range for the
                          I/O Limit Address,         Bridge to determine when to forward I/O transactions from one interface to
               31:16      Upper 16-bits        RW    the other.
                          [31:16]
                                                     Reset to 0000h.
PI7C9X2G303EL                                      Page 45 of 91                                                 September 2017
Document Number DS40025 Rev 2-2                   www.diodes.com                                                  © Diodes Incorporated


                                                                                                        PI7C9X2G303EL
7.2.25       CAPABILITY POINTER REGISTER – OFFSET 34h
               BIT        FUNCTIO N          TYPE   DESCRIPTIO N
                                                    Pointer points to the PCI power management registers.
               7:0        Capability Pointer  RO
                                                    Reset to 40h.
7.2.26        INTERRUPT LINE REGISTER – OFFSET 3Ch
               BIT        FUNCTIO N          TYPE   DESCRIPTIO N
               7:0        Interrupt Line      RW    Reset to 00h.
7.2.27       INTERRUPT PIN REGISTER – OFFSET 3Ch
               BIT        FUNCTIO N          TYPE   DESCRIPTIO N
                                                    T he Switch implements INTA virtual wire interrupt signals to represent hot-
                                                    plug events at downstream ports. The default value on the downstream ports
               15:8       Interrupt Pin       RO    may be changed by SMBus or auto-loading from EEPROM.
                                                    Reset to 00h.
7.2.28       BRIDGE CONTROL REGISTER – OFFSET 3Ch
               BIT        FUNCTIO N          TYPE   DESCRIPTIO N
                                                    0b: Ignore Poisoned TLPs on the secondary interface
                                                    1b: Enable the Poisoned T LPs reporting and detection on the secondary
                          Parity Error
               16                             RW    interface
                          Response
                                                    Reset to 0b.
                                                    0b: Disables the forwarding of EER_COR, ERR_NONFATAL and
                                                        ERR_FAT AL from secondary to primary interface
                                                    1b: Enables the forwarding of EER_COR, ERR_NONFATAL and
               17         S_SERR# enable      RW
                                                        ERR_FAT AL from secondary to primary interface
                                                    Reset to 0b.
                                                    0b: Forwards downstream all I/O addresses in the address range defined by
                                                        the I/O Base, I/O Base, and Limit registers
                                                    1b: Forwards upstream all I/O addresses in the address range defined by the
               18         ISA Enable          RW        I/O Base and Limit registers that are in the first 64KB of PCI I/O address
                                                        space (top 768 bytes of each 1KB block)
                                                    Reset to 0b.
                                                    0b: Ignores access to the VGA memory or IO address range
                                                    1b: Forwards transactions targeted at the VGA memory or IO address range
                                                    VGA memory range starts from 000A 0000h to 000B FFFFh
               19         VGA Enable          RW
                                                    VGA IO addresses are in the first 64KB of IO address space.
                                                    AD [9:0] is in the ranges 3B0 to 3BBh and 3C0h to 3DFh.
                                                    Reset to 0b.
                                                    0b: Executes 10-bit address decoding on VGA I/O accesses
                                                    1b: Executes 16-bit address decoding on VGA I/O accesses
               20         VGA 16-bit decode   RW
                                                    Reset to 0b.
               21         Master Abort Mode   RO    Does not apply to PCI Express. Must be hardwired to 0b.
PI7C9X2G303EL                                     Page 46 of 91                                                  September 2017
Document Number DS40025 Rev 2-2                  www.diodes.com                                                   © Diodes Incorporated


                                                                                                           PI7C9X2G303EL
               BIT        FUNCTIO N           TYPE     DESCRIPTIO N
                                                       0b: Does not trigger a hot reset on the corresponding PCI Express Port
                                                       1b: T riggers a hot reset on the corresponding PCI Express Port
                                                          At the downstream port, it asserts PORT_RST# to the attached downstream
                                                          device.
               22         Secondary Bus Reset  RW
                                                          At the upstream port, it asserts the PORT_RST # at all the downstream
                                                          ports.
                                                       Reset to 0b.
                          Fast Back-to-Back            Does not apply to PCI Express. Must be hardwired to 0b.
               23                              RO
                          Enable
                          Primary Master               Does not apply to PCI Express. Must be hardwired to 0b.
               24                              RO
                          T imeout
                          Secondary Master             Does not apply to PCI Express. Must be hardwired to 0b.
               25                              RO
                          T imeout
                          Master T imeout              Does not apply to PCI Express. Must be hardwired to 0b.
               26                              RO
                          Status
                          Discard T imer               Does not apply to PCI Express. Must be hardwired to 0b.
               27                              RO
                          SERR# enable
               31:28      Reserved            RsvdP    Not Support.
7.2.29       POWER MANAGEMENT CAPABILITY REGISTER – OFFSET 40h
               BIT        FUNCTIO N           TYPE     DESCRIPTIO N
                          Enhanced                     Read as 01h to indicate that these are power management enhanced capability
               7:0                              RO
                          Capabilities ID              registers.
                                                       T he pointer points to the Vital Protocol Data (VPD) capability register/the
                                                       Message capability register.
               15:8       Next Item Pointer     RO
                                                       Reset to 5Ch (Upstream port).
                                                       Reset to 4Ch (Downstream ports).
                          Power Management             Read as 011b to indicate the device is compliant to Revision 1.2 of PCI
               18:16                            RO
                          Revision                     Power Management Interface Specifications.
               19         PME# Clock            RO     Does not apply to PCI Express. Must be hardwired to 0b.
               20         Reserved            RsvdP    Not Support.
                                                       Read as 0b to indicate Switch does not have device specific initialization
                          Device Specific
               21                               RO     requirements. T he default value may be changed by SMBus or auto-loading
                          Initialization
                                                       from EEPROM.
                                                       Reset as 111b to indicate the Switch needs 375 mA in D3 state. The default
               24:22      AUX Current          RO
                                                       value may be changed by SMBus or auto-loading from EEPROM.
                          D1 Power State               Read as 1b to indicate Switch supports the D1 power management state. The
               25                               RO
                          Support                      default value may be changed by SMBus or auto-loading from EEPROM.
                          D2 Power State               Read as 1b to indicate Switch supports the D2 power management state. The
               26                               RO
                          Support                      default value may be changed by SMBus or auto-loading from EEPROM.
                                                       Read as 11111b to indicate Switch supports the forwarding of PME# message
               31:27      PME# Support         RO      in all power states. The default value may be changed by SMBus or auto-
                                                       loading from EEPROM.
7.2.30 POWER MANAGEMENT DATA REGISTER – OFFSET 44h
               BIT        FUNCTIO N           TYPE     DESCRIPTIO N
                                                       Indicates the current power state of the Switch. Writing a value of D0 when
                                                       the previous state was D3 cause a hot reset without asserting DWNRST_L.
                                                       00b: D0 state
               1:0        Power State          RW      01b: D1 state
                                                       10b: D2 state
                                                       11b: D3 hot state
                                                       Reset to 00b.
               2          Reserved            RsvdP    Not Support.
               3          No_Soft_Reset         RO     When set, this bit indicates that device transitioning from D3hot to D0 does
PI7C9X2G303EL                                        Page 47 of 91                                                  September 2017
Document Number DS40025 Rev 2-2                     www.diodes.com                                                  © Diodes Incorporated


                                                                                                       PI7C9X2G303EL
               BIT        FUNCTIO N         TYPE    DESCRIPTIO N
                                                    not perform an internal reset. When clear, an internal reset is performed when
                                                    power state transits from D3hot to D0. T his bit can be rewritten with
                                                    EEPROM programming. The default value may be changed by SMBus or
                                                    auto-loading from EEPROM.
                                                    Reset to 1b.
               7:4        Reserved          RsvdP   Not Support.
                                                    When asserted, the Switch will generate the PME# message.
               8          PME# Enable        RWS
                                                    Reset to 0b.
                                                    Select data registers.
               12:9       Data Select        RW
                                                    Reset to 0h.
               14:13      Data Scale          RO    Reset to 00b.
                                                    Read as 0b as the PME# message is not implemented.
               15         PME status         ROS
                                                    Reset to 0b.
7.2.31       PPB SUPPORT EXTENSIONS – OFFSET 44h
               BIT        FUNCTIO N         TYPE    DESCRIPTIO N
               21:16      Reserved          RsvdP   Not Support.
                          B2_B3 Support for         Does not apply to PCI Express. Must be hardwired to 0b.
               22                            RO
                          D3 HOT
                          Bus Power / Clock         Does not apply to PCI Express. Must be hardwired to 0b.
               23                            RO
                          Control Enable
7.2.32       DATA REGISTER – OFFSET 44h
               BIT        FUNCTIO N         TYPE    DESCRIPTIO N
                                                    Data Register. The default value may be changed by SMBus or auto-loading
                                                    from EEPROM.
               31:24      Data Register       RO
                                                    Reset to 00h.
7.2.33       MSI CAPABILITY REGISTER – OFFSET 4Ch (Downstream Port Only)
               BIT        FUNCTIO N         TYPE    DESCRIPTIO N
                          Enhanced                  Read as 05h to indicate that this is message signal interrupt capability
               7:0                            RO
                          Capabilities ID           register.
                                                    Pointer points to the Vendor specific capability register.
               15:8       Next Item Pointer   RO
                                                    Reset to 64h.
7.2.34       MESSAGE CONTROL REGISTER – OFFSET 4Ch (Downstream Port Only)
               BIT        FUNCTIO N         TYPE    DESCRIPTIO N
                                                    0b: T he function is prohibited from using MSI to request service
                                                    1b: T he function is permitted to use MSI to request service and is prohibited
               16         MSI Enable         RW         from using its INT x # pin
                                                    Reset to 0b.
                          Multiple Message          Read as 000b.
               19:17                         RO
                          Capable
                          Multiple Message          Reset to 000b.
               22:20                         RW
                          Enable
PI7C9X2G303EL                                     Page 48 of 91                                                   September 2017
Document Number DS40025 Rev 2-2                  www.diodes.com                                                   © Diodes Incorporated


                                                                                                          PI7C9X2G303EL
               BIT        FUNCTIO N         TYPE     DESCRIPTIO N
                                                     0b: T he function is not capable of generating a 64-bit message address
                          64-bit address             1b: T he function is capable of generating a 64-bit message address
               23                             RO
                          capable
                                                     Reset to 1b.
               31:24      Reserved          RsvdP    Not Support.
7.2.35       MESSAGE ADDRESS REGISTER – OFFSET 50h (Downstream Port Only)
               BIT        FUNCTIO N         TYPE     DESCRIPTIO N
               1:0        Reserved          RsvdP    Not Support.
                                                     If the message enable bit is set, the contents of this register specify the
                                                     DWORD aligned address for MSI memory write transaction.
               31:2       Message Address   RW
                                                     Reset to 0000_0000h.
7.2.36       MESSAGE UPPER ADDRESS REGISTER – OFFSET 54h (Downstream
             Port Only)
               BIT        FUNCTIO N          TYPE    DESCRIPTIO N
                                                     T his register is only effective if the device supports a 64-bit message address
                          Message Upper              is set.
               31:0                           RW
                          Address
                                                     Reset to 0000_0000h.
7.2.37       MESSAGE DATA REGISTER – OFFSET 58h (Downstream Port Only)
               BIT        FUNCTIO N          TYPE    DESCRIPTIO N
               15:0       Message Data        RW     Reset to 0000h.
               31:16      Reserved           RsvdP   Not Support.
7.2.38       VPD CAPABILITY REGISTER – OFFSET 5Ch (Upstream Port Only)
               BIT        FUNCTIO N          TYPE    DESCRIPTIO N
                          Enhanced                   Read as 03h to indicate that these are VPD enhanced capability registers.
               7:0                            RO
                          Capabilities ID
                                                     Pointer points to the Vendor specific capability register.
               15:8       Next Item Pointer   RO
                                                     Reset to 64h.
7.2.39       VPD REGISTER – OFFSET 5Ch (Upstream Port Only)
               BIT        FUNCTIO N         TYPE     DESCRIPTIO N
               17:16      Reserved          RsvdP    Not Support.
                                                     Contains DWORD address that is used to generate read or write cycle to the
                                                     VPD table stored in EEPROM.
               23:18      VPD Address         RW
                                                     Reset to 00_0000b.
               30:24      Reserved          RsvdP    Not Support.
PI7C9X2G303EL                                      Page 49 of 91                                                     September 2017
Document Number DS40025 Rev 2-2                   www.diodes.com                                                      © Diodes Incorporated


                                                                                                       PI7C9X2G303EL
               BIT        FUNCTIO N          TYPE   DESCRIPTIO N
                                                    0b: Performs VPD read command to VPD table at the location as specified
                                                        in VPD address. T his bit is kept ‘0’ and then set to ‘1’ automatically
                                                        after EEPROM cycle is finished
                                                    1b: Performs VPD write command to VPD table at the location as specified
               31         VPD operation       RW
                                                        in VPD address. T his bit is kept ‘1’ and then set to ‘0’ automatically
                                                        after EEPROM cycle is finished.
                                                    Reset to 0b.
7.2.40       VPD DATA REGISTER – OFFSET 60h (Upstream Port Only)
               BIT        FUNCTIO N          TYPE   DESCRIPTIO N
                                                    When read, it returns the last data read from VPD table at the location as
                                                    specified in VPD Address.
               31:0       VPD Data            RW    When written, it places the current data into VPD table at the location as
                                                    specified in VPD Address.
                                                    Reset to 0000_0000h.
7.2.41       VENDOR SPECIFIC CAPABILITY REGISTER – OFFSET 64h
               BIT        FUNCTIO N          TYPE   DESCRIPTIO N
                          Enhanced                  Read as 09h to indicate that these are vendor specific capability registers.
               7:0                            RO
                          Capabilities ID
                                                    Pointer points to the SSID/SSVID capability register.
               15:8       Next Item Pointer   RO
                                                    Reset to B0h.
                                                    T he length field provides the information for number of bytes in the
                                                     capability structure (including the ID and Next pointer bytes).
               31:16      Length Information  RO
                                                    Reset to 0034h.
7.2.42       XPIP CSR0 – OFFSET 68h (Test Purpose Only)
               BIT        FUNCTIO N          TYPE   DESCRIPTIO N
               31:0       XPIP_CSR0           RW    Reset to 0400_1060h.
7.2.43       XPIP CSR1 – OFFSET 6Ch (Test Purpose Only)
               BIT        FUNCTIO N          TYPE   DESCRIPTIO N
               31:0       XPIP_CSR1           RW    Reset to 0400_0800h.
7.2.44       REPLAY TIME-OUT COUNTER – OFFSET 70h
               BIT        FUNCTIO N          TYPE   DESCRIPTIO N
                                                    A 12-bit register contains a user-defined value. The default value may be
                                                    changed by SMBus or auto-loading from EEPROM.
               11:0       User Replay T imer  RW
                                                    Reset to 000h.
                                                    When asserted, the user-defined replay time-out value is be employed. The
                          Enable User Replay        default value may be changed by SMBus or auto-loading from EEPROM.
               12                             RW
                          T imer
                                                    Reset to 0b.
PI7C9X2G303EL                                     Page 50 of 91                                                    September 2017
Document Number DS40025 Rev 2-2                  www.diodes.com                                                    © Diodes Incorporated


                                                                                                         PI7C9X2G303EL
               BIT        FUNCTIO N          TYPE     DESCRIPTIO N
                                                      T he default value may be changed by SMBus or auto-loading from EEPROM.
                          Power Management
               13                             RO
                          Capability Disable
                                                      Reset to 0b.
                                                      T he default value may be changed by SMBus or auto-loading from EEPROM.
                          MSI Capability
               14                             RO
                          Disable
                                                      Reset to 0b.
               15         Reserved           RsvdP    Not Support.
7.2.45       ACKNOWLEDGE LATENCY TIMER – OFFSET 70h
               BIT        FUNCTIO N          TYPE     DESCRIPTIO N
                                                      A 14-bit register contains a user-defined value. The default value may be
                          User ACK Latency            changed by SMBus or auto-loading from EEPROM.
               29:16                          RW
                          T imer
                                                      Reset to 0000h.
                                                      When asserted, the user-defined ACK latency value is be employed. The
                          Enable User ACK             default value may be changed by SMBus or auto-loading from EEPROM.
               30                             RW
                          Latency
                                                      Reset to 0b.
                                                      Enable the VGA range decode.
               31         VGA decode enable   RO
                                                      Reset to 1b.
7.2.46       SWITCH OPERATION MODE – OFFSET 74h (Upstream Port Only)
               BIT       FUNCTIO N           TYPE     DESCRIPTIO N
                                                      When set, a store-forward mode is used. Otherwise, the chip is working under
                                                      cut-through mode. The default value may be changed by SMBus or auto-
               0         Store-Forward        RW      loading from EEPROM.
                                                      Reset to 0b.
                                                      Cut-through Threshold. When forwarding a packet from low-speed port to
                                                      high-speed mode, the chip provides the capability to adjust the forwarding
                                                      threshold. T he default value may be changed by SMBus or auto-loading from
                                                      EEPROM.
                         Cut-through
               2:1                            RW      00b: the threshold is set at the middle of forwarding packet
                         T hreshold
                                                      01b: the threshold is set ahead 1-cycle of middle point
                                                      10b: the threshold is set ahead 2-cycle of middle point
                                                      11b: the threshold is set ahead 3-cycle of middle point
                                                      Reset to 01b.
                                                      When set, the round-robin arbitration will stay in the arbitrated port even if
                                                      the credit is not enough but request is pending.
                                                      When clear, the round-robin arbitration will always go to the requesting port,
                         Port Arbitration             which the outgoing credit is enough for the packet queued in the port.
               3                              RW
                         Mode                         T he default value may be changed by SMBus or auto-loading from
                                                      EEPROM.
                                                      Reset to 0b.
                                                      When set, the frequency of releasing new credit to the link partner will be all
                                                      types per update.
                                                      When clear, the frequency of releasing new credit to the link partner will be
                                                      type oriented per update.
               4         Credit Update Mode   RW
                                                      T he default value may be changed by SMBus or auto-loading from
                                                      EEPROM.
                                                      Reset to 0b.
PI7C9X2G303EL                                       Page 51 of 91                                                   September 2017
Document Number DS40025 Rev 2-2                    www.diodes.com                                                   © Diodes Incorporated


                                                                                                         PI7C9X2G303EL
               BIT       FUNCTIO N             TYPE    DESCRIPTIO N
                                                       When set, there has ordering rule on packets for different egress port. The
                         Ordering on Different         default value may be changed by SMBus or auto-loading from EEPROM.
               5                                RW
                         Egress Port Mode
                                                       Reset to 0b.
                                                       When set, there has ordering rule between completion packet with different
                         Ordering on Different         tag. T he default value may be changed by SMBus or auto-loading from
               6         T ag of Completion     RW     EEPROM.
                         Mode
                                                       Reset to 0b.
               7         Reserved              RsvdP   Not Support.
                                                       T he default value may be changed by SMBus or auto-loading from
                         Power management              EEPROM.
               13:8                             RW
                         Control parameter
                                                       Reset to 00_0001b.
                                                       T he default value may be changed by SMBus or auto-loading from
                         RX Polarity Inversion         EEPROM.
               14                               RO
                         Disable
                                                       Reset to 0b.
                                                       T he default value may be changed by SMBus or auto-loading from
                         Compliance pattern
                                                       EEPROM.
               15        Parity Control         RO
                         Disable
                                                       Reset to 0b.
                                                       T he default value may be changed by SMBus or auto-loading from
                         C_DRV_LVL_3P5_                EEPROM.
               20:16                            RO
                         NOM
                                                       Reset to 1_0011b.
                                                       T he default value may be changed by SMBus or auto-loading from
                         C_DRV_LVL_6P0_                EEPROM.
               25:21                            RO
                         NOM
                                                       Reset to 1_0011b.
                                                       T he default value may be changed by SMBus or auto-loading from
                         C_DRV_LVL_HALF                EEPROM.
               30:26                            RO
                         _NOM
                                                       Reset to 0_0010b.
               31        Reserved              RsvdP   Not Support.
7.2.47       SWITCH OPERATION MODE – OFFSET 74h (Downstream Port Only)
               BIT       FUNCTIO N             TYPE    DESCRIPTIO N
               7:0       Reserved              RsvdP   Not Support.
                                                       T he default value may be changed by SMBus or auto-loading from
                         Power Management              EEPROM.
               13:8                             RW
                         Control Parameter
                                                       Reset to 00_0001b.
                                                       T he default value may be changed by the status of strapped pin, SMBus or
                         RX Polarity           HwInt   auto-loading from EEPROM.
               14
                         Inversion Disable      RO
                                                       Reset to the status of RXPOLINV_DIS strapped pin.
                                                       T he default value may be changed by SMBus or auto-loading from
                         Compliance Pattern
                                                       EEPROM.
               15        Parity Control         RO
                         Disable
                                                       Reset to 0b.
                                                       T he default value may be changed by SMBus or auto-loading from
                         C_DRV_LVL_3P5_                EEPROM.
               20:16                            RO
                         NOM
                                                       Reset to 1_0011b.
                                                       .T he default value may be changed by SMBus or auto-loading from
                         C_DRV_LVL_6P0_                EEPROM.
               25:21                            RO
                         NOM
                                                       Reset to 1_0011b.
                                                       T he default value may be changed by SMBus or auto-loading from
                         C_DRV_LVL_6P0_                EEPROM.
               30:26                            RO
                         NOM
                                                       Reset to 0_0010b.
PI7C9X2G303EL                                        Page 52 of 91                                                  September 2017
Document Number DS40025 Rev 2-2                     www.diodes.com                                                  © Diodes Incorporated


                                                                                               PI7C9X2G303EL
               BIT       FUNCTIO N      TYPE    DESCRIPTIO N
               31        Reserved       RsvdP   Not Support.
7.2.48       XPIP_CSR2 – OFFSET 78h
               BIT        FUNCTIO N     TYPE    DESCRIPTIO N
                                                T he default value may be changed by SMBus or auto-loading from
                                                EEPROM.
               15:0       XPIP_CSR2      RO
                                                Reset to 0080h.
7.2.49       PHY PARAMETER 1 – OFFSET 78h
               BIT        FUNCTIO N     TYPE    DESCRIPTIO N
                                                T he default value may be changed by SMBus or auto-loading from
                          C_EMP_POST _          EEPROM.
               20:16                     RO
                          GEN1_3P5_NOM
                                                Reset to 1_0101b.
                                                T he default value may be changed by SMBus or auto-loading from
                          C_EMP_POST _          EEPROM.
               25:21                     RO
                          GEN2_3P5_NOM
                                                Reset to 1_0101b.
                                                T he default value may be changed by SMBus or auto-loading from
                          C_EMP_POST _          EEPROM.
               30:26                     RO
                          GEN2_6P0_NOM
                                                Reset to 1_1101b.
               31         Reserved      RsvdP   Not Support.
7.2.50       PHY PARAMETER 2 – OFFSET 7Ch
               BIT       FUNCTIO N      TYPE    DESCRIPTIO N
                                                T he default value may be changed by SMBus or auto-loading from
                         C_T X_PHY_             EEPROM.
               3:0                       RO
                         LAT ENCY
                                                Reset to 0111b.
                                                T he default value may be changed by SMBus or auto-loading from
                         C_REC_DETECT_          EEPROM.
               6:4                       RO
                         USEC
                                                Reset to 010b.
               7         Reserved       RsvdP   Not Support.
                                                T he default value may be changed by SMBus or auto-loading from
                         P_CDR_FREQLOOP         EEPROM.
               8                         RO
                         _EN
                                                Reset to 1b.
                                                T he default value may be changed by SMBus or auto-loading from
                         P_CDR_                 EEPROM.
               10:9                      RO
                         T HRESHOLD
                                                Reset to 10b.
                                                T he default value may be changed by SMBus or auto-loading from
                         P_CDR_FREQLOOP         EEPROM.
               12:11                     RO
                         _GAIN
                                                Reset to 11b.
               15:13     Reserved       RsvdP   Not Support.
                                                T he default value may be changed by SMBus or auto-loading from
                         P_DRV_LVL_MGN_         EEPROM.
               16                        RO
                         DELAT A_EN
                                                Reset to 0b.
PI7C9X2G303EL                                 Page 53 of 91                                             September 2017
Document Number DS40025 Rev 2-2              www.diodes.com                                              © Diodes Incorporated


                                                                                                PI7C9X2G303EL
               BIT       FUNCTIO N       TYPE    DESCRIPTIO N
                                                 T he default value may be changed by SMBus or auto-loading from
                         P_DRV_LVL_NOM_          EEPROM.
               17                         RO
                         DELAT A_EN
                                                 Reset to 0b.
                                                 T he default value may be changed by SMBus or auto-loading from
                         P_EMP_POST _MGN         EEPROM.
               18                         RO
                         _DELATA_EN
                                                 Reset to 0b.
                                                 T he default value may be changed by SMBus or auto-loading from
                         P_EMP_POST _NOM         EEPROM.
               19                         RO
                         _DELATA_EN
                                                 Reset to 0b.
                                                 T he default value may be changed by SMBus or auto-loading from
                                                 EEPROM.
               21:20     P_RX_SIGDET_LVL  RO
                                                 Reset to 01b.
                                                 T he default value may be changed by SMBus or auto-loading from
                                                 EEPROM.
               25:22     P_RX_EQ_1        RO
                                                 Reset to 0110b.
                                                 T he default value may be changed by SMBus or auto-loading from
                                                 EEPROM.
               29:26     P_RX_EQ_2        RO
                                                 Reset to 1000b.
                                                 T he default value may be changed by SMBus or auto-loading from
                                                 EEPROM.
               30        P_T XSWING       RO
                                                 Reset to 0b.
               31        Reserved        RsvdP   Not Support.
7.2.51       XPIP_CSR3 – OFFSET 80h
               BIT        FUNCTIO N      TYPE    DESCRIPTIO N
                                                 T he default value may be changed by SMBus or auto-loading from
                                                 EEPROM.
               31:0       XPIP_CSR3       RW
                                                 Reset to 000F_0000h.
7.2.52       XPIP_CSR4 – OFFSET 84h
               BIT        FUNCTIO N      TYPE    DESCRIPTIO N
                                                 T he default value may be changed by SMBus or auto-loading from
                                                 EEPROM.
               31:0       XPIP_CSR4       RO
                                                 Reset to 0000_0000h.
7.2.53        XPIP_CSR5 – OFFSET 88h
               BIT        FUNCTIO N      TYPE    DESCRIPTIO N
                                                 T he default value may be changed by SMBus or auto-loading from
                                                 EEPROM.
               29:0       XPIP_CSR5       RO
                                                 Reset to 7308_3333h (Upstream port).
                                                 Reset to 3308_3333h (Downstream ports).
                                                 T he default value may be changed by SMBus, I2C or auto-loading from
                                                 EEPROM.
                          DO_CHG_DAT A_
               30                         RO
                          RAT E_CTRL
                                                 Reset to 1b (Upstream port).
                                                 Reset to 0b (Downstream ports).
PI7C9X2G303EL                                  Page 54 of 91                                              September 2017
Document Number DS40025 Rev 2-2               www.diodes.com                                              © Diodes Incorporated


                                                                                                      PI7C9X2G303EL
               BIT        FUNCTIO N         TYPE    DESCRIPTIO N
                                                    T he default value may be changed by SMBus, I2C or auto-loading from
                                                    EEPROM.
               31         Gen1_Cap_Only      RO
                                                    Reset to 0b.
7.2.54        TL_CSR – OFFSET 8Ch
               BIT        FUNCTIO N         TYPE    DESCRIPTIO N
                                                    T he default value may be changed by SMBus or auto-loading from
                                                    EEPROM.
               0          T X_SOF_FORM       RO
                                                    Reset to 0b.
                                                    T he default value may be changed by SMBus or auto-loading from
                          PM Data Select
                                                    EEPROM.
               1          Register R/W       RO
                          Capability
                                                    Reset to 0b.
                                                    T he default value may be changed by SMBus or auto-loading from
                          FC_UPDATE_                EEPROM.
               2                             RO
                          MODE
                                                    Reset to 0b.
                                                    T he default value may be changed by SMBus or auto-loading from
                          4K Boundary Check         EEPROM.
               3                             RO
                          Enable
                                                    Reset to 0b.
                                                    T he default value may be changed by SMBus or auto-loading from
                                                    EEPROM.
               4          FIFOERR_FIX_SEL    RO
                                                    Reset to 1b.
                                                    T he default value may be changed by SMBus or auto-loading from
                          MW Overpass               EEPROM.
               5                             RW
                          Disable
                                                    Reset to 0b.
                                                    Disable the RO ordering rule.
                          Ordering Frozen           T he default value may be changed by SMBus or auto-loading from EEPROM
               6                             RW
                          Disable
                                                    Reset to 0b.
                                                    T he default value may be changed by SMBus or auto-loading from
                                                    EEPROM.
               7          GNT _FAIL2IDLE     RO
                                                    Reset to 0b.
                                                    T he trying number for doing change data rate. The default value may be
                          DO_CHG_DAT A_             changed by SMBus or auto-loading from EEPROM.
               9:8                           RO
                          CNT _SEL
                                                    Reset to 00b.
                                                    Disable this port. The default value may be changed by SMBus or auto-
                                                    loading from EEPROM.
               10         Port Disable       RO
                                                    Reset to 0b.
                                                    Reset select (upstream port only). The default value may be changed by
                                                    SMBus or auto-loading from EEPROM.
               11         Reset Select       RO
                                                    Reset to 0b.
               12         ARB_VCFLG_SEL      RO     Reset to 0b.
               15:13      Reserved          RsvdP   Not Support.
                                                    XPIP_CSR6 Value. T he default value may be changed by SMBus or auto-
                                                    loading from EEPROM.
               23:16      XPIP_CSR6          RO
                                                    Reset to 79h.
                                                    T he default value may be changed by SMBus or auto-loading from
                                                    EEPROM.
               25:24      REV_T S_CT R       RO
                                                    Reset to 00b.
PI7C9X2G303EL                                     Page 55 of 91                                                 September 2017
Document Number DS40025 Rev 2-2                  www.diodes.com                                                 © Diodes Incorporated


                                                                                                          PI7C9X2G303EL
               BIT        FUNCTIO N            TYPE     DESCRIPTIO N
                                                        T he default value may be changed by SMBus or auto-loading from
                          MAC Control                   EEPROM.
               29:26                             RO
                          Parameter
                                                        Reset to 0h.
               30         Reserved             RsvdP    Not Support.
                                                        T he default value may be changed by SMBus or auto-loading from
                                                        EEPROM.
               31         P35_GEN2_MODE         RO
                                                        Reset to 0b.
7.2.55       PHY PARAMETER 3 – OFFSET 90h
               BIT        FUNCTIO N            TYPE     DESCRIPTIO N
                                                        PHY’s Lane mode.
                          PHY Parameter 3
               6:0                              RO
                          (per lane)
                                                        Reset to 00h.
               14:7       Reserved             RsvdP    Not Support.
                                                        PHY’s delta value setting.
                          PHY Parameter 3
               31:15                            RO
                          (global)
                                                        Reset to 0_0001h.
7.2.56       PHY PARAMETER 4 - OFFSET 94h
               BIT        FUNCTIO N            TYPE     DESCRIPTIO N
               15:0       PHY T X Margin        RO      Reset to 116Bh.
                                                        Upstream p Port only. Reset to 86h.
               23:16      Multilane RXEQ        RO
                                                        Reserved for Downstream Port. Reset to 00h.
               31:24      Reserved             RsvdP    Not Support.
7.2.57       OPERATION MODE –OFFSET 98h
               BIT        FUNCTIO N            TYPE     DESCRIPTIO N
                                                        { 7'd0, SCAN_MODE, PKG_SEL[2:0], PHY_MODE, DEBUG_MODE,
               15:0       Operation mode        RO
                                                        FAST _MODE, IDDQB, SROM_BYPASS}
                                                        For Reference clock buffer control. The default value may be changed by the
                                                        status of strapped pin, SMBus or auto-loading from EEPROM.
                                                        Bit[20]: Reset to the status of CLKBUF_PD strapped pin.
                                                        Bit[19:16]: Reset to Fh.
                                               HwInt
               20:16      Clock buffer control          Bit[20]: enable or disable reference clock outputs
                                                RO
                                                           0b: enable reference clock outputs
                                                           1b: disable reference clock outputs
                                                        Bit[19]: reserved
                                                        Bit[18:16]: enable or disable REFCLKO_P/N[2:0]
                                                           0b: disable
                                                           1b: enable
               31:21      Reserved             RsvdP    Not Support.
7.2.58       SSID/SSVID CAPABILITY REGISTER – OFFSET B0h
               BIT        FUNCTIO N            TYPE     DESCRIPTIO N
                          SSID/SSVID                    Read as 0Dh to indicate that these are SSID/SSVID capability registers.
               7:0                               RO
                          Capabilities ID
PI7C9X2G303EL                                         Page 56 of 91                                                September 2017
Document Number DS40025 Rev 2-2                      www.diodes.com                                                © Diodes Incorporated


                                                                                                        PI7C9X2G303EL
               BIT        FUNCTIO N          TYPE   DESCRIPTIO N
                                                    Pointer points to the PCI Express capability register.
               15:8       Next Item Pointer   RO
                                                    Reset to C0h.
7.2.59       SUBSYSTEM VENDOR ID REGISTER – OFFSET B4h
               BIT        FUNCTIO N         TYPE    DESCRIPTIO N
               15:0       SSVID               RO    It indicates the sub-system vendor id. T he default value may be changed by
                                                    SMBus or auto-loading from EEPROM.
                                                    Reset to 0000h.
7.2.60       SUBSYSTEM ID REGISTER – OFFSET B4h
               BIT        FUNCTIO N         TYPE    DESCRIPTIO N
               31:16      SSID                RO    It indicates the sub-system device id. T he default value may be changed by
                                                    SMBus or auto-loading from EEPROM.
                                                    Reset to 0000h.
7.2.61       GPIO CONTROL REGISTER – OFFSET B8h (Upstream Port Only)
               BIT        FUNCTIO N         TYPE    DESCRIPTIO N
               0          GPIO [0] Input      RO    State of GPIO [0] pin
                                                    0b: GPIO [0] is an input pin
                          GPIO [0] Output           1b: GPIO [0] is an output pin
               1                              RW
                          Enable
                                                    Reset to 0b.
                                                    Value of this bit will be output to GPIO [0] pin if GPIO [0] is configured as
                          GPIO [0] Output           an output pin.
               2                              RW
                          Register
                                                    Reset to 0b.
               3          Reserved          RsvdP   Not Support.
               4          GPIO [1] Input      RO    State of GPIO [1] pin.
                                                    0b: GPIO [1] is an input pin
                          GPIO [1] Output           1b: GPIO [1] is an output pin
               5                              RW
                          Enable
                                                    Reset to 0b.
                                                    Value of this bit will be output to GPIO [1] pin if GPIO [1] is configured as
                          GPIO [1] Output           an output pin.
               6                              RW
                          Register
                                                    Reset to 0b.
               7          Reserved          RsvdP   Not Support.
               8          GPIO [2] Input      RO    State of GPIO [2] pin
                                                    0b: GPIO [2] is an input pin
                          GPIO [2] Output           1b: GPIO [2] is an output pin
               9                              RW
                          Enable
                                                    Reset to 0b.
                                                    Value of this bit will be output to GPIO [2] pin if GPIO [2] is configured as
                          GPIO [2] Output           an output pin.
               10                             RW
                          Register
                                                    Reset to 0b.
               11         Reserved          RsvdP   Not Support.
               12         GPIO [3] Input      RO    State of GPIO [3] pin.
                                                    0b: GPIO [3] is an input pin
                          GPIO [3] Output           1b: GPIO [3] is an output pin
               13                             RW
                          Enable
                                                    Reset to 0b.
PI7C9X2G303EL                                     Page 57 of 91                                                  September 2017
Document Number DS40025 Rev 2-2                  www.diodes.com                                                  © Diodes Incorporated


                                                                                                     PI7C9X2G303EL
               BIT        FUNCTIO N       TYPE    DESCRIPTIO N
                                                  Value of this bit will be output to GPIO [3] pin if GPIO [3] is configured as
                          GPIO [3] Output         an output pin.
               14                          RW
                          Register
                                                  Reset to 0b.
               15         Reserved        RsvdP   Not Support.
               16         GPIO [4] Input   RO     State of GPIO [4] pin.
                                                  0b: GPIO [4] is an input pin
                         GPIO [4] Output          1b: GPIO [4] is an output pin
               17                          RW
                          Enable
                                                  Reset to 0b.
                                                  Value of this bit will be output to GPIO [4] pin if GPIO [4] is configured as
                          GPIO [4] Output         an output pin.
               18                          RW
                          Register
                                                  Reset to 0b.
               19         Reserved        RsvdP   Not Support.
               20         GPIO [5] Input   RO     State of GPIO [5] pin.
                                                  0b: GPIO [5] is an input pin
                          GPIO [5] Output         1b: GPIO [5] is an output pin
               21                          RW
                          Enable
                                                  Reset to 0b.
                                                  Value of this bit will be output to GPIO [5] pin if GPIO [5] is configured as
                          GPIO [5] Output         an output pin.
               22                          RW
                          Register
                                                  Reset to 0b.
               23         Reserved        RsvdP   Not Support.
               24         GPIO [6] Input   RO     State of GPIO [6] pin.
                                                  0b: GPIO [6] is an input pin
                          GPIO [6] Output         1b: GPIO [6] is an output pin
               25                          RW
                          Enable
                                                  Reset to 0b.
                                                  Value of this bit will be output to GPIO [6] pin if GPIO [6] is configured as
                          GPIO [6] Output         an output pin.
               26                          RW
                          Register
                                                  Reset to 0b.
               27         Reserved        RsvdP   Not Support.
               28         GPIO [7] Input   RO     State of GPIO [7] pin.
                                                  0b: GPIO [7] is an input pin
                          GPIO [7] Output         1b: GPIO [7] is an output pin
               29                          RW
                          Enable
                                                  Reset to 0b.
                                                  Value of this bit will be output to GPIO [7] pin if GPIO [7] is configured as
                          GPIO [7] Output         an output pin.
               30                          RW
                          Register
                                                  Reset to 0b.
               31         Reserved        RsvdP   Not Support.
7.2.62       EEPROM CONTROL REGISTER – OFFSET BCh (Upstream Port Only)
               BIT        FUNCTIO N       TYPE    DESCRIPTIO N
                                                  Starts the EEPROM read or write cycle.
               0          EEPROM Start     RW
                                                  Reset to 0b.
                                                  Sends the command to the EEPROM.
                                                  0b: EEPROM read
               1          EEPROM Command   RW
                                                  1b: EEPROM write
                                                  Reset to 0b.
                                                  1b: EEPROM acknowledge was not received during the EEPROM cycle.
                          EEPROM Error
               2                           RO
                          Status
                                                  Reset to 0b.
PI7C9X2G303EL                                   Page 58 of 91                                                 September 2017
Document Number DS40025 Rev 2-2                www.diodes.com                                                  © Diodes Incorporated


                                                                                                          PI7C9X2G303EL
               BIT        FUNCTIO N          TYPE    DESCRIPTIO N
                                                     0b: EEPROM autoload was unsuccessful or is disabled
                                                     1b: EEPROM autolad occurred successfully after RESET. Configuration
                          EEPROM Autoload
               3                              RO        registers were loaded with values in the EEPROM
                          Success
                                                     It will be cleared when read at this bit.
                                                     0b: EEPROM autoload was unsuccessful or is disabled
                                                     1b: EEPROM autoload occurred successfully after PREST . Configuration
                          EEPROM Autoload
               4                              RO     registers were loaded with values stored in the EEPROM
                          Status
                                                     Reset to 0b.
                                                     0b: EEPROM autoload enabled
                          EEPROM Autoload            1b: EEPROM autoload disabled
               5                              RW
                          Disable
                                                     Reset to 1b.
                                                     Determines the frequency of the EEPROM clock, which is derived from the
                                                     primary clock.
                                                     00b: Reserved
                          EEPROM Clock
               7:6                            RW     01b: PEXCLK / 1024 (PEXCLK is 125MHz)
                          Rate
                                                     10b: Reserved
                                                     11b: T est Mode
                                                     Reset to 01b.
7.2.63       EEPROM ADDRESS REGISTER – OFFSET BCh (Upstream Port Only)
               BIT        FUNCTIO N          TYPE    DESCRIPTIO N
               8          Reserved           RsvdP   Not Support.
                                                     Contains the EEPROM address.
               15:9       EEPROM Address      RW
                                                     Reset to 0000h.
7.2.64       EEPROM DATA REGISTER – OFFSET BCh (Upstream Port Only)
               BIT        FUNCTIO N          TYPE    DESCRIPTIO N
                                                     Contains the data to be written to the EEPROM. After completion of a read
                                                     cycle, this register will contain the data from the EEPROM.
               31:16      EEPROM Data         RW
                                                     Reset to 0000h.
7.2.65       PCI EXPRESS CAPABILITY REGISTER – OFFSET C0h
               BIT        FUNCTIO N          TYPE    DESCRIPTIO N
                          Enhanced                   Read as 10h to indicate that these are PCI express enhanced capability
               7:0                            RO
                          Capabilities ID            registers.
               15:8       Next Item Pointer   RO     Read as 00h. No other ECP registers.
                                                     Read as 0010b to indicate the device is compliant to Revision .2.0a of PCI
               19:16      Capability Version  RO
                                                     Express Base Specifications.
                                                     Indicates the type of PCI Express logical device.
               23:20      Device/Port Type    RO
                                                     Reset to 0101b (Upstream port).
                                                     Reset to 0110b (Downstream ports).
                                                     When set, indicates that the PCIe Link associated with this Port is connected
                                                     to a slot. T his field is valid for downstream port of the Switch. The default
                                             HwInt   value may be changed by the status of strapped pin, SMBus or auto-loading
               24         Slot Implemented
                                              RO     from EEPROM.
                                                     Reset to the status of SLOT_IMP strapped pin.
PI7C9X2G303EL                                      Page 59 of 91                                                    September 2017
Document Number DS40025 Rev 2-2                   www.diodes.com                                                     © Diodes Incorporated


                                                                                                         PI7C9X2G303EL
               BIT        FUNCTIO N           TYPE    DESCRIPTIO N
                          Interrupt Message           Read as 0b. No MSI messages are generated in the transparent mode.
               29:25                           RO
                          Number
               31:30      Reserved            RsvdP   Not Support.
7.2.66        DEVICE CAPABILITIES REGISTER – OFFSET C4h
               BIT        FUNCTIO N           TYPE    DESCRIPTIO N
                                                      Indicates the maximum payload size that the device can support for TLPs.
                                                      T he default value may be changed by the status of strapped pin, SMBus or
                          Max_Payload_Size    HwInt   auto-loading from EEPROM.
               2:0
                          Supported            RO
                                                      Reset to 001b when PL_512B strapped pin is set to 0.
                                                      Reset to 010b when PL_512B strapped pin is set to 1.
                                                      Indicates the support for use of unclaimed function numbers as Phantom
                          Phantom Functions           functions. Read as 00b, since the Switch does not act as a requester.
               4:3                             RO
                          Supported
                                                      Reset to 00b.
                                                      Indicates the maximum supported size of Tag field as a Requester. Read as 0,
                          Extended Tag Field          since the Switch does not act as a requester.
               5                               RO
                          Supported
                                                      Reset to 0b.
                                                      Acceptable total latency that an Endpoint can withstand due to the transition
                                                      from L0s state to the L0 state. For Switch, the ASPM software would not
                          Endpoint L0s
               8:6                             RO     check this value.
                          Acceptable Latency
                                                      Reset to 000b.
                                                      Acceptable total latency that an Endpoint can withstand due to the transition
                                                      from L1 state to the L0 state. For Switch, the ASPM software would not
                          Endpoint L1
               11:9                            RO     check this value.
                          Acceptable Latency
                                                      Reset to 000b.
               14:12      Reserved            RsvdP   Not Support.
                                                      When set, indicates that the device implements the functionality originally
                                                      defined in the Error Reporting ECN. The default value may be changed by
                          Role_Based Error
               15                              RO     SMBus or auto-loading from EEPROM.
                          Reporting
                                                      Reset to 1b.
               17:16      Reserved            RsvdP   Not Support.
                                                      It applies to Upstream Port only. In combination with the Slot Power Limit
                                                      Scale value, specifies the upper limit on power supplied by slot.
                          Captured Slot Power
               25:18                           RO
                          Limit Value                 T his value is set by the Set_Slot_Power_Limit message or hardwired to 00h.
                                                      Reset to 00h.
                                                      It applies to Upstream Port only. Specifies the scale used for the Slot Power
                                                      Limit Value.
                          Captured Slot Power
               27:26                           RO
                          Limit Scale                 T his value is set by the Set_Slot_Power_Limit message or hardwired to 00b.
                                                      Reset to 00b.
               31:28      Reserved            RsvdP   Not Support.
7.2.67       DEVICE CONTROL REGISTER – OFFSET C8h
               BIT        FUNCTIO N           TYPE    DESCRIPTIO N
                                                      0b: Disable Correctable Error Reporting
                          Correctable Error           1b: Enable Correctable Error Reporting
               0                               RW
                          Reporting Enable
                                                      Reset to 0b.
PI7C9X2G303EL                                       Page 60 of 91                                                  September 2017
Document Number DS40025 Rev 2-2                    www.diodes.com                                                   © Diodes Incorporated


                                                                                                            PI7C9X2G303EL
               BIT        FUNCTIO N             TYPE    DESCRIPTIO N
                                                        0b: Disable Non-Fatal Error Reporting
                          Non-Fatal Error               1b: Enable Non-Fatal Error Reporting
               1                                 RW
                          Reporting Enable
                                                        Reset to 0b.
                                                        0b: Disable Fatal Error Reporting
                          Fatal Error Reporting         1b: Enable Fatal Error Reporting
               2                                 RW
                          Enable
                                                        Reset to 0b.
                                                        0b: Disable Unsupported Request Reporting
                          Unsupported Request           1b: Enable Unsupported Request Reporting
               3                                 RW
                          Reporting Enable
                                                        Reset to 0b.
                                                        When set, it permits the device to set the Relaxed Ordering bit in the attribute
                                                        field of transaction. Since the Switch can not either act as a requester or alter
                          Enable Relaxed
               4                                  RO    the content of packet it forwards, this bit always returns ‘0’ when read.
                          Ordering
                                                        Reset to 0b.
                                                        T his field sets maximum TLP payload size for the device. Permissible values
                                                        that can be programmed are indicated by the Max_Payload_Size Supported in
                                                        the Device Capabilities register. Any value exceeding the Max_Payload_Size
               7:5        Max_Payload_Size       RW     Supported written to this register results into clamping to the
                                                        Max_Payload_Size Supported value.
                                                        Reset to 000b.
                                                        Does not apply to PCI Express Switch. Returns ‘0’ when read.
                          Extended Tag Field
               8                                 RW
                          Enable
                                                        Reset to 0b.
                                                        Does not apply to PCI Express Switch. Returns ‘0’ when read.
                          Phantom Function
               9                                 RW
                          Enable
                                                        Reset to 0b.
                                                        When set, indicates that a device is enabled to draw AUX power independent
                          Auxiliary (AUX)               of PME AUX power.
               10                                RWS
                          Power PM Enable
                                                        Reset to 0b.
                                                        When set, it permits to set the No Snoop bit in the attribute field of
                                                        transaction. Since the Switch can not either act as a requester or alter the
               11         Enable No Snoop         RO    content of packet it forwards, this bit always returns ‘0’ when read.
                                                        Reset to 0b.
                                                        T his field sets the maximum Read Request size for the device as a Requester.
                                                        Since the Switch does not generate read request by itself, these bits are
                          Max_Read_
               14:12                              RO    hardwired to 000b.
                          Request_Size
                                                        Reset to 000b.
               15         Reserved              RsvdP   Not Support.
7.2.68       DEVICE STATUS REGISTER – OFFSET C8h
               BIT        FUNCTIO N             TYPE    DESCRIPTIO N
                                                        Asserted when correctable error is detected. Errors are logged in this register
                                                        regardless of whether error reporting is enabled or not in the Device Control
                          Correctable Error
               16                               RW1C    register.
                          Detected
                                                        Reset to 0b.
                                                        Asserted when non-fatal error is detected. Errors are logged in this register
                                                        regardless of whether error reporting is enabled or not in the Device Control
                         Non-Fatal Error
               17                               RW1C    register.
                         Detected
                                                        Reset to 0b.
                                                        Asserted when fatal error is detected. Errors are logged in this register
                                                        regardless of whether error reporting is enabled or not in the Device Control
               18         Fatal Error Detected  RW1C    register.
                                                        Reset to 0b.
PI7C9X2G303EL                                         Page 61 of 91                                                    September 2017
Document Number DS40025 Rev 2-2                      www.diodes.com                                                    © Diodes Incorporated


                                                                                                         PI7C9X2G303EL
               BIT        FUNCTIO N          TYPE    DESCRIPTIO N
                                                     Asserted when unsupported request is detected. Errors are logged in this
                                                     register regardless of whether error reporting is enabled or not in the Device
                          Unsupported
               19                            RW1C    Control register.
                          Request Detected
                                                     Reset to 0b.
                                                     Asserted when the AUX power is detected by the Switch
                          AUX Power
               20                             RO
                          Detected
                                                     Reset to 1b.
                                                     Each port of Switch does not issue Non-posted Requests on its own behalf, so
                          T ransactions              this bit is hardwired to 0b.
               21                             RO
                          Pending
                                                     Reset to 0b.
               31:22      Reserved           RsvdP   Not Support.
7.2.69       LINK CAPABILITIES REGISTER – OFFSET CCh
               BIT        FUNCTIO N          TYPE    DESCRIPTIO N
                                                     Indicates the maximum speed of the Express link. The default value may be
                          Maximum Link               changed by SMBus or auto-loading from EEPROM.
               3:0                            RO
                          Speed
                                                     Reset to 0010b (5 G b/s).
                                                     Indicates the maximum width of the given PCIe Link.
                          Maximum Link
                9:4                           RO
                          Width
                                                     Reset to 00_0001b (x1).
                                                     Indicates the level of ASPM supported on the given PCIe Link. Each port of
                          Active State Power         Switch supports L0s and L1 entry. The default value may be changed by
               11:10      Management          RO     SMBus or auto-loading from EEPROM.
                          (ASPM) Support
                                                     Reset to 00b.
                                                     Indicates the L0s exit latency for the given PCIe Link.
                                                     T he length of time this port requires to complete transition from L0s to L0 is
                                                     in the range of 256ns to less than 512ns. The default value may be changed
               14:12      L0s Exit Latency    RO
                                                     by SMBus or auto-loading from EEPROM.
                                                     Reset to 011b.
                                                     Indicates the L1 exit latency for the given PCIe Link.
                                                     T he length of time this port requires to complete transition from L1 to L0 is in
                          L1 Exit                    the range of 16us to less than 32us. The default value may be changed by
               17:15                          RO
                          Latency                    SMBus or auto-loading from EEPROM.
                                                     Reset to 000b.
               19:18      Reserved           RsvdP   Not Support.
                                                     For a Downstream Port, this bit must be set to 1b if the component supports
                                                     the optional capability of reporting the DL_Active state of the Data Link
                                                     Control and Management State Machine. For a hot-plug capable Downstream
                          Data Link Layer
                                                     Port, this bit must be set to 1b.
               20         Active Reporting    RO
                          Capable
                                                     For Upstream Port, this bit must be hardwired to 0b.
                                                     Reset to 0b.
                                                     Reset to 0b (Upstream port).
               21         Link bw notify cap  RO
                                                     Reset to 1b (Downstream ports).
               23:21      Reserved           RsvdP   Not Support.
                                                     Indicates the PCIe Port Number for the given PCIe Link. The default value
                                                     may be changed by SMBus or auto-loading from EEPROM.
               31:24      Port Number         RO
                                                     Reset to 00h for Port 0.
                                                     Reset to 01h for Port 1.
                                                     Reset to 02h for Port 2.
PI7C9X2G303EL                                      Page 62 of 91                                                   September 2017
Document Number DS40025 Rev 2-2                   www.diodes.com                                                    © Diodes Incorporated


                                                                                                           PI7C9X2G303EL
7.2.70       LINK CONTROL REGISTER – OFFSET D0h
               BIT        FUNCTIO N            TYPE   DESCRIPTIO N
                                                      00b: ASPM is Disabled
                                                      01b: L0s Entry Enabled
                                                      10b: L1 Entry Enabled
                          Active State Power          11b: L0s and L1 Entry Enabled
               1:0        Management            RW
                          (ASPM) Control              Note that the receiver must be capable of entering L0s even when the field is
                                                      disabled.
                                                      Reset to 00b.
               2          Reserved            RsvdP   Not Support.
                                                      Does not apply to PCI Express Switch. Returns ‘0’ when read.
                          Read Completion
               3                                RO
                          Boundary (RCB)
                                                      Reset to 0b.
                                                      At upstream port, it is not allowed to disable the link, so this bit is hardwired
                                                      to ‘0’. For downstream ports, it disables the link when this bit is set.
               4          Link Disable          RW
                                                      Reset to 0b.
                                                      At upstream port, it is not allowed to retrain the link, so this bit is hardwired
                                                      to 0b. For downstream ports, it initiates Link Retraining when this bit is set.
               5          Retrain Link          RW
                                                      T his bit always returns 0b when read.
                                                      0b: T he components at both ends of a link are operating with asynchronous
                                                          reference clock
                          Common Clock                1b: T he components at both ends of a link are operating with a distributed
               6                                RW
                          Configuration                   common reference clock
                                                      Reset to 0b.
                                                      When set, it transmits 4096 FTS ordered sets in the L0s state for entering L0
                                                      state and transmits 1024 T S1 ordered sets in the L1 state for entering L0 state.
               7          Extended Synch        RW
                                                      Reset to 0b.
               8          Reserved            RsvdP   Not Support.
                          HW Autonomous
               9                                RW
                          width Disable               Reset to 0b.
                                                      For upstream Port is RO.
                          Link Bandwidth
                                                      For downstream Port is RW.
               10         Management          RO/RW
                          Interrupt Enable
                                                      Reset to 0b.
                                                      For upstream Port is RO.
                          Link Autonomous
                                                      For downstream Port is RW.
               11         Bandwidth Interrupt RO/RW
                          Enable
                                                      Reset to 0b.
               15:12      Reserved            RsvdP   Not Support.
7.2.71       LINK STATUS REGISTER – OFFSET D0h
               BIT        FUNCTIO N           TYPE    DESCRIPTIO N
                                                      Indicate the negotiated speed of the Express link.
                                                      0001b: 2.5 Gb/s.
               19:16      Link Speed            RO
                                                      0010b: 5 Gb/s.
                                                      Reset to 0010b.
                                                      Indicates the negotiated width of the given PCIe link.
                          Negotiated Link
               25:20                            RO
                          Width
                                                      Reset to 00_0001b (x1).
                                                      When set, indicates a Link training error occurred.
                                                      T his bit is cleared by hardware upon successful training of the link to the L0
               26         T raining Error       RO    link state.
                                                      Reset to 0b.
PI7C9X2G303EL                                       Page 63 of 91                                                     September 2017
Document Number DS40025 Rev 2-2                    www.diodes.com                                                     © Diodes Incorporated


                                                                                                             PI7C9X2G303EL
               BIT        FUNCTIO N           TYPE     DESCRIPTIO N
                                                       When set, indicates the link training is in progress. Hardware clears this bit
                                                       once link training is complete.
               27         Link T raining       RO
                                                       Reset to 0b.
                                                       0b: the Switch uses an independent clock irrespective of the presence of a
                                                           reference on the connector
                                                       1b: the Switch uses the same reference clock that the platform provides on the
                                                           connector
                          Slot Clock          HwInt
               28
                          Configuration        RO
                                                       T he default value may be changed by the status of strapped pin, SMBus or
                                                       auto-loading from EEPROM.
                                                       Reset to the status of SLOTCLK strapped pin.
                                                      Indicates the status of the Data Link Control and Management State Machine.
                          Data Link Layer             It returns a 1b to indicate the DL_Active state, 0b otherwise.
               29                              RO
                          Link Active
                                                      Reset to 0b.
               31:30      Reserved            RsvdP    Not Support.
7.2.72       SLOT CAPABILITIES REGISTER – OFFSET D4h (Downstream Port Only)
               BIT        FUNCTIO N           TYPE     DESCRIPTIO N
                                                       When set, it indicates that an Attention Button is implemented on the chassis
                                                       for this slot. The default value may be changed by SMBus or auto-loading
                          Attention Button
               0                               RO      from EEPROM.
                          Present
                                                       Reset to 0b.
                                                       When set, it indicates that a Power Controller is implemented for this slot.
                          Power Controller             T he default value may be changed by SMBus or auto-loading from EEPROM.
               1                               RO
                          Present
                                                       Reset to 0b.
               2          Reserved            RsvdP    Not Support.
                                                       When set, it indicates that an Attention Indicator is implemented on the
                                                       chassis for this slot. The default value may be changed by SMBus or auto-
                          Attention Indicator
               3                               RO      loading from EEPROM.
                          Present
                                                       Reset to 0b.
                                                       When set, it indicates that a Power Indicator is implemented on the chassis for
                                                       this slot. The default value may be changed by SMBus or auto-loading from
                          Power Indicator
               4                               RO      EEPROM.
                          Present
                                                       Reset to 0b.
                                                       When set, it indicates that a device present in this slot might be removed from
                                                       the system without any prior notification. The default value may be changed
               5          Hot-Plug Surprise    RO      by SMBus or auto-loading from EEPROM.
                                                       Reset to 0b.
                                                       When set, it indicates that this slot is capable of supporting Hot-Plug
                                                       operation. The default value may be changed by SMBus or auto-loading from
               6          Hot-Plug Capable     RO      EEPROM.
                                                       Reset to 0b.
                                                       It applies to Downstream Port only. In combination with the Slot Power Limit
                                                       Scale value, specifies the upper limit on power supplied by slot. Writes to this
                          Slot Power Limit             register also cause the Port to send the Set_Slot_Power_Limit message. The
               14:7                            RW
                          Value                        default value may be changed by SMBus or auto-loading from EEPROM.
                                                       Reset to 00h.
                                                       It applies to Downstream Port only. Specifies the scale used for the Slot
                                                       Power Limit Value. Writes to this register also cause the Port to send the
                          Slot Power Limit             Set_Slot_Power_Limit message. T he default value may be changed by
               16:15                           RW
                          Scale                        SMBus or auto-loading from EEPROM.
                                                       Reset to 00b.
PI7C9X2G303EL                                        Page 64 of 91                                                    September 2017
Document Number DS40025 Rev 2-2                     www.diodes.com                                                    © Diodes Incorporated


                                                                                                            PI7C9X2G303EL
               BIT        FUNCTIO N           TYPE     DESCRIPTIO N
               18:17      Reserved            RsvdP    Not Support.
                                                       It indicates the physical slot number attached to this Port. The default value
                          Physical Slot                may be changed by SMBus or auto-loading from EEPROM.
               31:19                           RO
                          Number
                                                       Reset to 0000h.
7.2.73       SLOT CONTROL REGISTER – OFFSET D8h (Downstream Port Only)
               BIT        FUNCTIO N           TYPE     DESCRIPTIO N
                                                       When set, it enables the generation of Hot-Plug interrupt or wakeup event on
                          Attention Button             an attention button pressed event.
               0                               RW
                          Pressed Enable
                                                       Reset to 0b.
                                                       When set, it enables the generation of Hot-Plug interrupt or wakeup event on
                          Power Fault                  a power fault event.
               1                               RW
                          Detected Enable
                                                       Reset to 0b.
               2          Reserved            RsvdP    Not Support.
                                                       When set, it enables the generation of Hot-Plug interrupt or wakeup event on
                          Presence Detect              a presence detect changed event.
               3                               RW
                          Changed Enable
                                                       Reset to 0b.
                                                       When set, it enables the generation of Hot-Plug interrupt when the Hot-Plug
                          Command
                                                       Controller completes a command.
               4          Completed Interrupt  RW
                          Enable
                                                       Reset to 0b.
                                                       When set, it enables generation of Hot-Plug interrupt on enabled Hot-Plug
                          Hot-Plug Interrupt           events.
               5                               RW
                          Enable
                                                       Reset to 0b.
                                                       Controls the display of Attention Indicator.
                                                       00b: Reserved
                                                       01b: On
                                                       10b: Blink
                          Attention Indicator
               7:6                             RW      11b: Off
                          Control
                                                       Writes to this register also cause the Port to send the
                                                       AT T ENTION_INDICATOR_* Messages.
                                                       Reset to 11b.
                                                       Controls the display of Power Indicator.
                                                       00b: Reserved
                                                       01b: On
                                                       10b: Blink
                          Power Indicator
               9:8                             RW      11b: Off
                          Control
                                                       Writes to this register also cause the Port to send the
                                                       POWER_INDICATOR_* Messages.
                                                       Reset to 11b.
                                                       0b: reset the power state of the slot (Power On)
                          Power Controller             1b: set the power state of the slot (Power Off)
               10                              RW
                          Control
                                                       Reset to 0b.
               11         Reserved            RsvdP    Not Support.
                                                       If the Data Link Layer Link Active capability is implemented, when set to 1b,
                          Data Link Layer              this field enables software notification when Data Link Layer Link Active
               12         State Changed        RW      field is changed.
                          Enable
                                                       Reset to 0b.
               15:13      Reserved            RsvdP    Not Support.
PI7C9X2G303EL                                        Page 65 of 91                                                   September 2017
Document Number DS40025 Rev 2-2                     www.diodes.com                                                    © Diodes Incorporated


                                                                                                             PI7C9X2G303EL
7.2.74       SLOT STATUS REGISTER OFFSET D8h (Downstream Port Only)
               BIT        FUNCTIO N             TYPE     DESCRIPTIO N
                                                         When set, it indicates the Attention Button is pressed.
                          Attention Button
               16                               RW1C
                          Pressed
                                                         Reset to 0b.
                                                         When set, it indicates a Power Fault is detected.
                          Power Fault
               17                               RW1C
                          Detected
                                                         Reset to 0b.
                                                         When set, it indicates a MRL Sensor Changed is detected.
                          MRL Sensor
               18                                 RO
                          Changed
                                                         Reset to 0b.
                                                         When set, it indicates a Presence Detect Changed is detected.
                          Presence Detect
               19                               RW1C
                          Changed
                                                         Reset to 0b.
                                                         When set, it indicates the Hot-Plug Controller completes an issued command.
                          Command
               20                               RW1C
                          Completed
                                                         Reset to 0b.
                                                         Reflects the status of MRL Sensor.
                                                         0b: MRL Closed
               21         MRL Sensor State        RO
                                                         1b: MRL Opened
                                                         Reset to 0b.
                                                         Indicates the presence of a card in the slot.
                                                         0b: Slot Empty
                                                         1b: Card Present in slot
                          Presence Detect       HwInt
               22                                        T his register is implemented on all Downstream Ports that implement slots.
                          State                   RO
                                                         For Downstream Ports not connected to slots (where the Slot Implemented bit
                                                         of the PCI Express Capabilities register is 0b), this bit returns 1b.
                                                         Reset to 1b when PRSNT strapped pin is set to 0.
                                                         Reset to 0b when PRSNT strapped pin is set to 1.
               23         Reserved              RsvdP    Not Support.
                                                         T his bit is set when the value reported in the Data Link Layer Link Active
                          Data Link Layer                field of the Link Status register is changed.
               24                               RW1C
                          State Changed
                                                         Reset to 0b.
               31:25      Reserved              RsvdP    Not Support.
7.2.75       DEVICE CAPABILITIES REGISTER 2 – OFFSET E4h
               BIT        FUNCTIO N              TYPE    DESCRIPTIO N
               10:0       Device Capabilities 2   RO     Reset to 000h.
                                                         A value of 1b indicates support for the optional Latency Tolerance Reporting
                          LT R Mechanism                 (LT R) mechanism.
               11                                 RO
                          Supported
                                                         Reset to 1b.
               17:12      Device Capabilities 2   RO     Reset to 00h.
                                                         T his field indicates if OBFF is supported.
               19:18      OBFF Supported          RO
                                                         Reset to 01b.
               31:20      Device Capabilities 2   RO     Reset to 000h.
7.2.76       DEVICE CONTROL REGISTER 2 – OFFSET E8h
               BIT        FUNCTIO N              TYPE    DESCRIPTIO N
               9:0        Device Control 2        RO     Reset to 000h.
PI7C9X2G303EL                                          Page 66 of 91                                                    September 2017
Document Number DS40025 Rev 2-2                       www.diodes.com                                                     © Diodes Incorporated


                                                                                                   PI7C9X2G303EL
               BIT        FUNCTIO N           TYPE    DESCRIPTIO N
                                                      Enable LT R Mechanism.
                          LT R Mechanism
               10                              RW
                          Enable
                                                      Reset to 0b.
               12:11      Device Control 2     RO     Reset to 00b.
                                                      Enable OBFF Mechanism and select the signaling method.
               14:13      OBFF enable          RW
                                                      Reset to 00b.
               15         Device Control 2     RO     Reset to 0b.
7.2.77       DEVIDE STATUS REGISTER 2 – OFFSET E8h
               BIT         FUNCTIO N          TYPE    DESCRIPTIO N
               31:16       Device status 2      RO    Reset to 0000h.
7.2.78       LINK CAPABILITIES REGISTER 2 – OFFSET ECh
               BIT        FUNCTIO N           TYPE    DESCRIPTIO N
               31:0       Link Capabilities 2  RO     Reset to 0000_0000h.
7.2.79       LINK CONTROL REGISTER 2 – OFFSET F0h
               BIT        FUNCTIO N           TYPE    DESCRIPTIO N
               3:0        T arget Link Speed   RWS    Reset to 0010b.
               4          Enter Compliance     RWS    Reset to 0b.
               5          HW_AutoSpeed_Dis     RW     Reset to 0b.
                                                      Reset to 0b (Upstream port).
               6          Select_Deemp          RO
                                                      Reset to 1b (Downstream ports).
               9:7        T ran_Margin         RWS    Reset to 000b.
                          Enter Modify                Reset to 0b.
               10                              RWS
                          Compliance
               11         Compliance SOS       RWS    Reset to 0b.
               12         Compliance_Deemp     RWS    Reset to 0b.
               15:13      Reserved            RsvdP   Not Support.
7.2.80       LINK STATUS REGISTER 2 – OFFSET F0h
               BIT         FUNCTIO N          TYPE    DESCRIPTIO N
                           Current De-                Reset to 0b (Upstream port).
               16                               RO
                           emphasis Level             Reset to 1b (Downstream ports).
               31:17       Link Status 2        RO    Reset to 0000h.
7.2.81       SLOT CAPABILITIES REGISTER 2 – OFFSET F4h
               BIT        FUNCTIO N           TYPE    DESCRIPTIO N
               31:0       Slot Capabilities 2  RO     Reset to 0000_0000h.
7.2.82       SLOT CONTORL REGISTER 2 – OFFSET F8h
               BIT        FUNCTIO N           TYPE    DESCRIPTIO N
               15:0       Slot Control 2       RO     Reset to 0000h.
PI7C9X2G303EL                                       Page 67 of 91                                            September 2017
Document Number DS40025 Rev 2-2                    www.diodes.com                                            © Diodes Incorporated


                                                                                                            PI7C9X2G303EL
7.2.83       SLOT STATUS REGISTER 2 – OFFSET F8h
               BIT        FUNCTIO N              TYPE     DESCRIPTIO N
               31:16      Slot Status 2            RO     Reset to 0000h.
7.2.84       PCI EXPRESS ADVANCED ERROR REPORTING CAPABILITY REGISTER
             – OFFSET 100h
               BIT        FUNCTIO N               TYPE    DESCRIPTIO N
                          Extended                        Read as 0001h to indicate that these are PCI express extended capability
               15:0                                RO
                          Capabilities ID                 registers for advance error reporting.
                                                          Read as 1h. Indicates PCI-SIG defined PCI Express capability structure
               19:16      Capability Version       RO
                                                          version number.
                                                          Pointer points to the PCI Express Extended VC capability register.
                          Next Capability
               31:20                               RO
                          Offset
                                                          Reset to 140h.
7.2.85       UNCORRECTABLE ERROR STATUS REGISTER – OFFSET 104h
               BIT        FUNCTIO N               TYPE     DESCRIPTIO N
                                                           When set, indicates that the Training Error event has occurred.
               0          T raining Error Status RW1CS
                                                           Reset to 0b.
               3:1        Reserved                RsvdP    Not Support.
                                                           When set, indicates that the Data Link Protocol Error event has occurred.
                          Data Link Protocol
               4                                 RW1CS
                          Error Status
                                                           Reset to 0b.
               11:5       Reserved                RsvdP    Not Support.
                                                           When set, indicates that a Poisoned TLP has been received or generated.
               12         Poisoned TLP Status    RW1CS
                                                           Reset to 0b.
                                                           When set, indicates that the Flow Control Protocol Error event has occurred.
                          Flow Control
               13                                RW1CS
                          Protocol Error Status
                                                           Reset to 0b.
                                                           When set, indicates that the Completion Timeout event has occurred.
                          Completion T imeout
               14                                RW1CS
                          Status
                                                           Reset to 0b.
                                                           When set, indicates that the Completer Abort event has occurred.
                          Completer Abort
               15                                RW1CS
                          Status
                                                           Reset to 0b.
                                                           When set, indicates that the Unexpected Completion event has occurred.
                          Unexpected
               16                                RW1CS
                          Completion Status
                                                           Reset to 0b.
                                                           When set, indicates that the Receiver Overflow event has occurred.
                          Receiver Overflow
               17                                RW1CS
                          Status
                                                           Reset to 0b.
                                                           When set, indicates that a Malformed TLP has been received.
                          Malformed TLP
               18                                RW1CS
                          Status
                                                           Reset to 0b.
                                                           When set, indicates that an ECRC Error has been detected.
               19         ECRC Error Status      RW1CS
                                                           Reset to 0b.
                                                           When set, indicates that an Unsupported Request event has occurred.
                          Unsupported
               20                                RW1CS
                          Request Error Status
                                                           Reset to 0b.
                                                           When set, indicates that an ACS Violation event has occurred
                          ACS Violation
               21                                RW1CS
                          Status
                                                           Reset to 0b.
PI7C9X2G303EL                                           Page 68 of 91                                                 September 2017
Document Number DS40025 Rev 2-2                        www.diodes.com                                                 © Diodes Incorporated


                                                                                                          PI7C9X2G303EL
               BIT        FUNCTIO N            TYPE     DESCRIPTIO N
               31:21      Reserved             RsvdP    Not Support.
7.2.86       UNCORRECTABLE ERROR MASK REGISTER – OFFSET 108h
               BIT        FUNCTIO N            TYPE    DESCRIPTIO N
                                                       When set, the T raining Error event is not logged in the Header Log register
                                                       and not issued as an Error Message to RC either.
               0          T raining Error Mask RWS
                                                       Reset to 0b.
               3:1        Reserved             RsvdP   Not Support.
                                                       When set, the Data Link Protocol Error event is not logged in the Header Log
                          Data Link Protocol           register and not issued as an Error Message to RC either.
               4                               RWS
                          Error Mask
                                                       Reset to 0b.
               11:5       Reserved             RsvdP   Not Support.
                                                       When set, an event of Poisoned T LP has been received or generated is not
                                                       logged in the Header Log register and not issued as an Error Message to RC
               12         Poisoned TLP Mask    RWS     either.
                                                       Reset to 0b.
                                                       When set, the Flow Control Protocol Error event is not logged in the Header
                          Flow Control                 Log register and not issued as an Error Message to RC either.
               13                              RWS
                          Protocol Error Mask
                                                       Reset to 0b.
                                                       When set, the Completion T imeout event is not logged in the Header Log
                          Completion T imeout          register and not issued as an Error Message to RC either.
               14                              RWS
                          Mask
                                                       Reset to 0b.
                                                       When set, the Completer Abort event is not logged in the Header Log register
                          Completer Abort              and not issued as an Error Message to RC either.
               15                              RWS
                          Mask
                                                       Reset to 0b.
                                                       When set, the Unexpected Completion event is not logged in the Header Log
                          Unexpected                   register and not issued as an Error Message to RC either.
               16                              RWS
                          Completion Mask
                                                       Reset to 0b.
                                                       When set, the Receiver Overflow event is not logged in the Header Log
                          Receiver Overflow            register and not issued as an Error Message to RC either.
               17                              RWS
                          Mask
                                                       Reset to 0b.
                                                       When set, an event of Malformed T LP has been received is not logged in the
                          Malformed TLP                Header Log register and not issued as an Error Message to RC either.
               18                              RWS
                          Mask
                                                       Reset to 0b.
                                                       When set, an event of ECRC Error has been detected is not logged in the
                                                       Header Log register and not issued as an Error Message to RC either.
               19         ECRC Error Mask      RWS
                                                       Reset to 0b.
                                                       When set, the Unsupported Request event is not logged in the Header Log
                          Unsupported                  register and not issued as an Error Message to RC either.
               20                              RWS
                          Request Error Mask
                                                       Reset to 0b.
               21         ACS violation mask   RWS     Reset to 0b
               31:22      Reserved             RsvdP   Not Support.
PI7C9X2G303EL                                        Page 69 of 91                                                 September 2017
Document Number DS40025 Rev 2-2                     www.diodes.com                                                 © Diodes Incorporated


                                                                                                        PI7C9X2G303EL
7.2.87       UNCORRECTABLE ERROR SEVERITY REGISTER – OFFSET 10Ch
               BIT        FUNCTIO N             TYPE    DESCRIPTIO N
                                                        0b: Non-Fatal
                          T raining Error               1b: Fatal
               0                                 RWS
                          Severity
                                                        Reset to 1b.
               3:1        Reserved              RsvdP   Not Support.
                                                        0b: Non-Fatal
                          Data Link Protocol            1b: Fatal
               4                                 RWS
                          Error Severity
                                                        Reset to 1b.
               11:5       Reserved              RsvdP   Not Support.
                                                        0b: Non-Fatal
                          Poisoned TLP                  1b: Fatal
               12                                RWS
                          Severity
                                                        Reset to 0b.
                                                        0b: Non-Fatal
                          Flow Control
                                                        1b: Fatal
               13         Protocol Error         RWS
                          Severity
                                                        Reset to 1b.
                                                        0b: Non-Fatal
                          Completion T imeout           1b: Fatal
               14                                RWS
                          Error Severity
                                                        Reset to 0b.
                                                        0b: Non-Fatal
                          Completer Abort               1b: Fatal
               15                                RWS
                          Severity
                                                        Reset to 0b.
                                                        0b: Non-Fatal
                          Unexpected                    1b: Fatal
               16                                RWS
                          Completion Severity
                                                        Reset to 0b.
                                                        0b: Non-Fatal
                          Receiver Overflow             1b: Fatal
               17                                RWS
                          Severity
                                                        Reset to 1b.
                                                        0b: Non-Fatal
                          Malformed TLP                 1b: Fatal
               18                                RWS
                          Severity
                                                        Reset to 1b.
                                                        0b: Non-Fatal
                                                        1b: Fatal
               19         ECRC Error Severity    RWS
                                                        Reset to 0b.
                                                        0b: Non-Fatal
                          Unsupported
                                                        1b: Fatal
               20         Request Error          RWS
                          Severity
                                                        Reset to 0b.
                                                        0b: Non-Fatal
                          ACS violation                 1b: Fatal
               21                                RWS
                          severity
                                                        Reset to 0b.
               31:21      Reserved              RsvdP   Not Support.
7.2.88       CORRECTABLE ERROR STATUS REGISTER – OFFSET 110 h
               BIT        FUNCTIO N              TYPE   DESCRIPTIO N
                                                        When set, the Receiver Error event is detected.
               0          Receiver Error Status RW1CS
                                                        Reset to 0b.
               5:1        Reserved              RsvdP   Not Support.
PI7C9X2G303EL                                         Page 70 of 91                                           September 2017
Document Number DS40025 Rev 2-2                      www.diodes.com                                           © Diodes Incorporated


                                                                                                            PI7C9X2G303EL
               BIT        FUNCTIO N            TYPE   DESCRIPTIO N
                                                      When set, the event of Bad T LP has been received is detected.
               6          Bad T LP Status     RW1CS
                                                      Reset to 0b.
                                                      When set, the event of Bad DLLP has been received is detected.
               7          Bad DLLP Status     RW1CS
                                                      Reset to 0b.
                                                      When set, the REPLAY_NUM Rollover event is detected.
                          REPLAY_NUM
               8                              RW1CS
                          Rollover status
                                                      Reset to 0b.
               11:9       Reserved            RsvdP   Not Support.
                                                      When set, the Replay Timer Timeout event is detected.
                          Replay T imer
               12                             RW1CS
                          T imeout status
                                                      Reset to 0b.
                                                      When set, the Advisory Non-Fatal Error event is detected.
                          Advisory Non-Fatal
               13                             RW1CS
                          Error status
                                                      Reset to 0b.
               31:14      Reserved            RsvdP   Not Support.
7.2.89       CORRECTABLE ERROR MASK REGISTER – OFFSET 114 h
               BIT        FUNCTIO N            TYPE   DESCRIPTIO N
                                                      When set, the Receiver Error event is not logged in the Header Log register
                                                      and not issued as an Error Message to RC either.
               0          Receiver Error Mask  RWS
                                                      Reset to 0b.
               5:1        Reserved            RsvdP   Not Support.
                                                      When set, the event of Bad T LP has been received is not logged in the
                                                      Header Log register and not issued as an Error Message to RC either.
               6          Bad T LP Mask        RWS
                                                      Reset to 0b.
                                                      When set, the event of Bad DLLP has been received is not logged in the
                                                      Header Log register and not issued as an Error Message to RC either.
               7          Bad DLLP Mask        RWS
                                                      Reset to 0b.
                                                      When set, the REPLAY_NUM Rollover event is not logged in the Header
                          REPLAY_NUM                  Log register and not issued as an Error Message to RC either.
               8                               RWS
                          Rollover Mask
                                                      Reset to 0b.
               11:9       Reserved            RsvdP   Not Support.
                                                      When set, the Replay Timer Timeout event is not logged in the Header Log
                          Replay T imer               register and not issued as an Error Message to RC either.
               12                              RWS
                          T imeout Mask
                                                      Reset to 0b.
                                                      When set, the Advisory Non-Fatal Error event is not logged in the Header
                          Advisory Non-Fatal          Long register and not issued as an Error Message to RC either.
               13                              RWS
                          Error Mask
                                                      Reset to 1b.
               31:14      Reserved            RsvdP   Not Support.
7.2.90       ADVANCE ERROR CAPABILITIES AND CONTROL REGISTER – OFFSET
             118h
               BIT        FUNCTIO N           TYPE    DESCRIPTIO N
                                                      It indicates the bit position of the first error reported in the Uncorrectable
                                                      Error Status register.
               4:0        First Error Pointer  ROS
                                                      Reset to 0_0000b.
                                                      When set, it indicates the Switch has the capability to generate ECRC.
                          ECRC Generation
               5                                RO
                          Capable
                                                      Reset to 1b.
PI7C9X2G303EL                                       Page 71 of 91                                                      September 2017
Document Number DS40025 Rev 2-2                    www.diodes.com                                                      © Diodes Incorporated


                                                                                                        PI7C9X2G303EL
               BIT        FUNCTIO N          TYPE    DESCRIPTIO N
                                                     When set, it enables the generation of ECRC when needed.
                          ECRC Generation
               6                             RWS
                          Enable
                                                     Reset to 0b.
                                                     When set, it indicates the Switch has the capability to check ECRC.
                          ECRC Check
               7                              RO
                          Capable
                                                     Reset to 1b.
                                                     When set, the function of checking ECRC is enabled.
               8          ECRC Check Enable  RWS
                                                     Reset to 0b.
               31:9       Reserved           RsvdP   Not Support.
7.2.91       HEADER LOG REGISTER – OFFSET From 11Ch to 128h
               BIT        FUNCTIO N          TYPE    DESCRIPTIO N
               31:0       1 st DWORD          ROS    Hold the 1st DWORD of TLP Header. T he Head byte is in big endian.
               63:32      2 nd DWORD          ROS    Hold the 2nd DWORD of TLP Header. The Head byte is in big endian.
               95:64      3 rd DWORD          ROS    Hold the 3rd DWORD of T LP Header. The Head byte is in big endian.
               127:96     4 th DWORD          ROS    Hold the 4th DWORD of TLP Header. The Head byte is in big endian.
7.2.92       PCI EXPRESS VIRTUAL CHANNEL CAPABILITY REGISTER – OFFSET
             140h
               BIT        FUNCTIO N          TYPE    DESCRIPTIO N
                          Extended                   Read as 0002h to indicate that these are PCI express extended capability
               15:0                           RO
                          Capabilities ID            registers for virtual channel.
                                                     Read as 1h. Indicates PCI-SIG defined PCI Express capability structure
               19:16      Capability Version  RO
                                                     version number.
                                                     Pointer points to the PCI Express Power Budgeting Capability register.
                          Next Capability
               31:20                          RO
                          Offset
                                                     Reset to 20Ch.
7.2.93        PORT VC CAPABILITY REGISTER 1 – OFFSET 144h
               BIT        FUNCTIO N          TYPE    DESCRIPTIO N
                                                     It indicates the number of extended Virtual Channels in addition to the
                                                     default VC supported by the Switch. The default value may be changed by
                                             HwInt   the status of strapped pin, or auto-loading from EEPROM.
               2:0        Extended VC Count
                                              RO
                                                     Bit[2:1]: Reset to 00b.
                                                     Bit[0]: Reset to the status of VC1_EN strapped pin.
               3          Reserved           RsvdP   Not Support.
                                                     It indicates the number of extended Virtual Channels in addition to the
                                                     default VC belonging to the low-priority VC (LPVC) group. The default
                          Low Priority
               6:4                            RO     value may be changed by auto-loading from EEPROM.
                          Extended VC Count
                                                     Reset to 000b.
               7          Reserved           RsvdP   Not Support.
                                                     It indicates the reference clock for Virtual Channels that support time-based
                                                     WRR Port Arbitration. Defined encoding is 00b for 100 ns reference clock.
               9:8        Reference Clock     RO
                                                     Reset to 00b.
                                                     Read as 10b to indicate the size of Port Arbitration table entry in the device is
                          Port Arbitration           4 bits.
               11:10                          RO
                          T able Entry Size
                                                     Reset to 10b.
               31:12      Reserved           RsvdP   Not Support.
PI7C9X2G303EL                                      Page 72 of 91                                                  September 2017
Document Number DS40025 Rev 2-2                   www.diodes.com                                                   © Diodes Incorporated


                                                                                                          PI7C9X2G303EL
7.2.94       PORT VC CAPABILITY REGISTER 2 – OFFSET 148h
               BIT        FUNCTIO N           TYPE     DESCRIPTIO N
                                                       It indicates the types of VC Arbitration supported by the device for the LPVC
                                                       group. T his field is valid when LPVC is greater than 0. The Switch supports
                                                       Hardware fixed arbitration scheme, e.g., Round Robin and Weight Round
                          VC Arbitration
               7:0                             RO      Robin arbitration with 32 phases in LPVC.
                          Capability
                                                       Reset to 03h if offset 144h.bit[0]=1.
                                                       Reset to 00h if offset 144h.bit[0]=0.
               23:8       Reserved            RsvdP    Not Support.
                                                       It indicates the location of the VC Arbitration Table as an offset from the base
                                                       address of the Virtual Channel Capability register in the unit of DQWD (16
                          VC Arbitration               bytes).
               31:24                           RO
                          T able Offset
                                                       Reset to 03h if offset 144h.bit[0]=1.
                                                       Reset to 00h if offset 144h.bit[0]=0.
7.2.95        PORT VC CONTROL REGISTER – OFFSET 14Ch
               BIT        FUNCTIO N           TYPE     DESCRIPTIO N
                                                       When set, the programmed VC Arbitration Table is applied to the hardware.
                          Load VC Arbitration          T his bit always returns 0b when read.
               0                               RW
                          T able
                                                       Reset to 0b.
                                                       T his field is used to configure the VC Arbitration by selecting one of the
                                                       supported VC Arbitration schemes. The valid values for the schemes
                          VC Arbitration               supported by Switch are 0b and 1b. Other value than these written into this
               3:1                             RW
                          Select                       register will be treated as default.
                                                       Reset to 000b.
               15:4       Reserved            RsvdP    Not Support.
7.2.96       PORT VC STATUS REGISTER – OFFSET 14Ch
               BIT        FUNCTIO N           TYPE     DESCRIPTIO N
                                                       When set, it indicates that any entry of the VC Arbitration Table is written by
                                                       software. T his bit is cleared when hardware finishes loading values stored in
                          VC Arbitration
               16                              RO      the VC Arbitration Table after the bit of “Load VC Arbitration Table” is set.
                          T able Status
                                                       Reset to 0b.
               31:17      Reserved            RsvdP    Not Support.
7.2.97       VC RESOURCE CAPABILITY REGISTER (0) – OFFSET 150h
               BIT        FUNCTIO N           TYPE     DESCRIPTIO N
                                                       It indicates the types of Port Arbitration supported by the VC resource. The
                                                       Switch supports Hardware fixed arbitration scheme, e.g., Round Robin,
                                                       Weight Round Robin (WRR) arbitration with 128 phases (3~4 enabled ports)
                          Port Arbitration
               7:0                             RO      and T ime-based WRR with 128 phases (3~4 enabled ports). Note that the
                          Capability
                                                       T ime-based WRR is only valid in VC1.
                                                       Reset to 19h.
               13:8       Reserved            RsvdP    Not Support.
                                                       When set, it indicates the VC resource only supports transaction optimized
                          Advanced Packet              for Advanced Packet Switching (AS).
               14                              RO
                          Switching
                                                       Reset to 0b.
PI7C9X2G303EL                                        Page 73 of 91                                                   September 2017
Document Number DS40025 Rev 2-2                     www.diodes.com                                                   © Diodes Incorporated


                                                                                                           PI7C9X2G303EL
               BIT        FUNCTIO N          TYPE     DESCRIPTIO N
                                                      T his bit is not applied to PCIe Switch.
                          Reject Snoop
               15                             RO
                          T ransactions
                                                      Reset to 0b.
                                                      It indicates the maximum numbers of time slots (minus one) are allocated for
                                                      Isochronous traffic. The default value may be changed by auto-loading from
                          Maximum T ime
               22:16                          RO      EEPROM.
                          Slots
                                                      Reset to 7Fh.
               23         Reserved           RsvdP    Not Support.
                                                      It indicates the location of the Port Arbitration Table (n) as an offset from the
                                                      base address of the Virtual Channel Capability register in the unit of DQWD
                          Port Arbitration
               31:24                          RO      (16 bytes).
                          T able Offset
                                                      Reset to 04h for Port Arbitration Table (0).
7.2.98       VC RESOURCE CONTROL REGISTER (0) – OFFSET 154h
               BIT        FUNCTIO N          TYPE     DESCRIPTIO N
                                                      T his field indicates the TCs that are mapped to the VC resource. Bit locations
                                                      within this field correspond to TC values. When the bits in this field are set, it
                                                      means that the corresponding T Cs are mapped to the VC resource. The
               7:0        T C/VC Map          RW
                                                      default value may be changed by auto-loading from EEPROM.
                                                      Reset to FFh.
               15:8       Reserved           RsvdP    Not Support.
                                                      When set, the programmed Port Arbitration Table is applied to the hardware.
                          Load Port                   T his bit always returns 0b when read.
               16                             RW
                          Arbitration T able
                                                      Reset to 0b.
                                                      T his field is used to configure the Port Arbitration by selecting one of the
                                                      supported Port Arbitration schemes. The permissible values for the schemes
                          Port Arbitration            supported by Switch are 000b and 011b at VC0, other value than these written
               19:17                          RW
                          Select                      into this register will be treated as default.
                                                      Reset to 000b.
               23:20      Reserved           RsvdP    Not Support.
                                                      T his field assigns a VC ID to the VC resource.
               26:24      VC ID               RO
                                                      Reset to 000b.
               30:27      Reserved           RsvdP    Not Support.
                                                      0b: disables this Virtual Channel
                                                      1b: enables this Virtual Channel
               31         VC Enable           RW
                                                      Reset to 1b.
7.2.99       VC RESOURCE STATUS REGISTER (0) – OFFSET 158h
               BIT        FUNCTIO N          TYPE     DESCRIPTIO N
               15:0       Reserved           RsvdP    Not Support.
                                                      When set, it indicates that any entry of the Port Arbitration Table is written by
                                                      software. T his bit is cleared when hardware finishes loading values stored in
                          Port Arbitration
               16                             RO      the Port Arbitration Table after the bit of “Load Port Arbitration Table” is set.
                          T able Status
                                                      Reset to 0b.
                                                      When set, it indicates that the VC resource is still in the process of
                          VC Negotiation              negotiation. This bit is cleared after the VC negotiation is complete.
               17                             RO
                          Pending
                                                      Reset to 0b.
               31:18      Reserved           RsvdP    Not Support.
PI7C9X2G303EL                                       Page 74 of 91                                                    September 2017
Document Number DS40025 Rev 2-2                    www.diodes.com                                                     © Diodes Incorporated


                                                                                                              PI7C9X2G303EL
7.2.100      VC RESOURCE CAPABILITY REGISTER (1) – OFFSET 15Ch
               BIT        FUNCTIO N           TYPE      DESCRIPTIO N
                                                        It indicates the types of Port Arbitration supported by the VC resource. The
                                                        Switch supports Hardware fixed arbitration scheme, e.g., Round Robin,
                                                        Weight Round Robin (WRR) arbitration with 128 phases (3~4 enabled ports)
                          Port Arbitration              and T ime-based WRR with 128 phases (3~4 enabled ports). Note that the
               7:0                             RO
                          Capability                    T ime-based WRR is only valid in VC1.
                                                        Reset to 19h if offset 144h.bit[0]=1.
                                                        Reset to 00h if offset 144h.bit[0]=0.
               13:8       Reserved           RsvdP      Not Support.
                                                        When set, it indicates the VC resource only supports transaction optimized for
                          Advanced Packet               Advanced Packet Switching (AS).
               14                              RO
                          Switching
                                                        Reset to 0b.
                                                        T his bit is not applied to PCIe Switch.
                          Reject Snoop
               15                              RO
                          T ransactions
                                                        Reset to 0b.
                                                        It indicates the maximum numbers of time slots (minus one) are allocated for
                                                        Isochronous traffic. The default value may be changed by auto-loading from
                          Maximum T ime                 EEPROM.
               22:16                           RO
                          Slots
                                                        Reset to 7Fh if offset 144h.bit[0]=1.
                                                        Reset to 00h if offset 144h.bit[0]=0.
               23         Reserved           RsvdP      Not Support.
                                                        It indicates the location of the Port Arbitration Table (n) as an offset from the
                                                        base address of the Virtual Channel Capability register in the unit of DQWD
                          Port Arbitration              (16 bytes).
               31:24                           RO
                          T able Offset
                                                        Reset to 08h for Port Arbitration Table (1) if offset 144h.bit[0]=1.
                                                        Reset to 00h if offset 144h.bit[0]=0.
7.2.101      VC RESOURCE CONTROL REGISTER (1) – OFFSET 160h
               BIT        FUNCTIO N            TYPE         DESCRIPTIO N
                                                            T his field indicates the TCs that are mapped to the VC resource. Bit
                                                            locations within this field correspond to TC values. When the bits in this
                                                RW          field are set, it means that the corresponding TCs are mapped to the VC
               7:0        T C/VC Map         (Exception     resource. Bit 0 of this filed is read-only and must be set to “ 0” for the VC1.
                                              for bit0)     T he default value may be changed by auto-loading from EEPROM.
                                                            Reset to 00h.
               15:8       Reserved             RsvdP        Not Support.
                                                            When set, the programmed Port Arbitration Table is applied to the
                          Load Port                         hardware. T his bit always returns 0b when read.
               16                               RW
                          Arbitration T able
                                                            Reset to 0b.
                                                            T his field is used to configure the Port Arbitration by selecting one of the
                                                            supported Port Arbitration schemes. The permissible values for the
                          Port Arbitration                  schemes supported by Switch are 000b, 011b and 100b at VC1, other value
               19:17                            RW
                          Select                            than these written into this register will be treated as default.
                                                            Reset to 000b.
               23:20      Reserved             RsvdP        Not Support.
                                                            T his field assigns a VC ID to the VC resource.
               26:24      VC ID                 RW
                                                            Reset to 001b if offset 144h.bit[0]=1.
                                                            Reset to 000b if offset 144h.bit[0]=0.
               30:27      Reserved             RsvdP        Not Support.
                                                            0b: disables this Virtual Channel
                                                            1b: enables this Virtual Channel
               31         VC Enable             RW
                                                            Reset to 0b.
PI7C9X2G303EL                                         Page 75 of 91                                                      September 2017
Document Number DS40025 Rev 2-2                     www.diodes.com                                                       © Diodes Incorporated


                                                                                                                 PI7C9X2G303EL
7.2.102       VC RESOURCE STATUS REGISTER (1) – OFFSET 164h
               BIT        FUNCTIO N                TYPE       DESCRIPTIO N
               15:0       Reserved                 RsvdP      Not Support.
                                                              When set, it indicates that any entry of the Port Arbitration Table is written
                                                              by software. T his bit is cleared when hardware finishes loading values
                          Port Arbitration                    stored in the Port Arbitration Table after the bit of “Load Port Arbitration
               16                                   RO
                          T able Status                       T able” is set.
                                                              Reset to 0b.
                                                              When set, it indicates that the VC resource is still in the process of
                          VC Negotiation                      negotiation. This bit is cleared after the VC negotiation is complete.
               17                                   RO
                          Pending
                                                              Reset to 0b.
               31:18      Reserved                 RsvdP      Not Support.
7.2.103       VC ARBITRATION TABLE REGISTER – OFFSET 170h
The VC arb itration table is a read-write register array that contains a table for VC arbitrat ion. Each table entry
allocates four bits, of which three bits are used to represent VC ID and one bit is reserved. A total of 32 entries are
used to construct the VC arbitration table. The layout for this register array is shown below.
              Table 7-1 Register Array Layout for VC Arbitration
                  31 - 28    27 - 24      23 - 20     19 - 16      15 - 12        11 - 8         7-4           3-0         Byte Location
                   Phase      Phase         Phase      Phase        Phase         Phase          Phase        Phase
                                                                                                                                  00h
                    [7]         [6]          [5]        [4]           [3]           [2]           [1]           [0]
                   Phase      Phase         Phase      Phase        Phase         Phase          Phase        Phase
                                                                                                                                  04h
                   [15]        [14]         [13]       [12]          [11]          [10]           [9]           [8]
                   Phase      Phase         Phase      Phase        Phase         Phase          Phase        Phase
                                                                                                                                  08h
                   [23]        [22]         [21]       [20]          [19]          [18]          [17]          [16]
                   Phase      Phase         Phase      Phase        Phase         Phase          Phase        Phase
                                                                                                                                  0Ch
                   [31]        [30]         [29]       [28]          [27]          [26]          [25]          [24]
7.2.104       PORT ARBITRATION TABLE REGISTER (0) and (1) – OFFSET 180h and
              1C0h
The Port arbitration table is a read-write register array that contains a table for Port arbitration. Each table entry
allocates two bits to represent Port Nu mber. The table entry size is dependent on the number o f enabled ports (refer
to bit 10 and 11 of Port VC capability register 1). The arbitrat ion table contains 128 entries if three or four ports are
to be enabled. The following table shows the register array layout for the size of entry equal to two.
              Table 7-2 Table Entry Size in 4 Bits
                  63 - 56    55 - 48       47 - 40    39 - 32       31 - 24      23 - 16         15 - 8        7-0          Byte Location
                   Phase      Phase         Phase      Phase         Phase         Phase         Phase         Phase
                                                                                                                                   00h
                  [15:14]    [13:12]       [11:10]     [9:8]         [7:6]         [5:4]          [3:2]        [1:0]
                   Phase      Phase         Phase      Phase         Phase         Phase         Phase         Phase
                                                                                                                                   08h
                  [31:30]    [29:28]       [27:26]    [25:24]       [23:22]      [21:20]        [19:18]       [17:16]
                   Phase      Phase         Phase      Phase         Phase         Phase         Phase         Phase
                                                                                                                                   10h
                  [47:46]    [45:44]       [43:42]    [41:40]       [39:38]      [37:36]        [35:34]       [33:32]
                   Phase      Phase         Phase      Phase         Phase         Phase         Phase         Phase
                                                                                                                                   18h
                  [63:62]    [61:60]       [59:58]    [57:56]       [55:54]      [53:52]        [51:50]       [49:48]
                   Phase      Phase         Phase      Phase         Phase         Phase         Phase         Phase               20h
PI7C9X2G303EL                                            Page 76 of 91                                                     September 2017
Document Number DS40025 Rev 2-2                         www.diodes.com                                                      © Diodes Incorporated


                                                                                                                PI7C9X2G303EL
                 63 - 56     55 - 48       47 - 40     39 - 32        31 - 24       23 - 16         15 - 8     7-0        Byte Location
                 [79:78]     [77:76]       [75:74]     [73:72]        [71:70]       [69:68]        [67:66]    [65:64]
                  Phase       Phase         Phase       Phase          Phase         Phase          Phase      Phase
                                                                                                                                 28h
                 [95:94]     [93:92]       [91:90]     [89:88]        [87:86]       [85:84]        [83:82]    [81:80]
                  Phase       Phase         Phase       Phase          Phase         Phase          Phase      Phase
                                                                                                                                 30h
                [111:110]   [109:108]     [107:106]   [105:104]      [103:102]     [101:100]       [99:98]    [97:96]
                  Phase       Phase         Phase       Phase          Phase         Phase          Phase      Phase
                                                                                                                                 38h
                [127:126]   [125:124]     [123:122]   [121:120]      [119:118]     [117:116]     [115:114]   [113:112]
7.2.105      PCI EXPRESS POWER BUDGETING CAPABILITY REGISTER – OFFSET
             20Ch
               BIT        FUNCTIO N                TYPE      DESCRIPTIO N
                          Extended                           Read as 0004h to indicate that these are PCI express extended capability
               15:0                                  RO
                          Capabilities ID                    registers for power budgeting.
                                                             Read as 1h. Indicates PCI-SIG defined PCI Express capability structure
               19:16      Capability Version        RO
                                                             version number.
                                                             Pointer points to the PCI Express Extended ACS capability register/LTR
                                                             capability register.
                          Next Capability
               31:20                                RO
                          Offset
                                                             Reset to 230h (Upstream port).
                                                             Reset to 220h (Downstream ports).
7.2.106      DATA SELECT REGISTER – OFFSET 210h
               BIT        FUNCTIO N                TYPE      DESCRIPTIO N
                                                             It indexes the power budgeting data reported through the data register.
                                                             When 00h, it selects D0 Max power budget
               7:0        Data Selection            RW       When 01h, it selects D0 Sustained power budget
                                                             Other values would return zero power budgets, which means not supported
                                                             Reset to 00h.
               31:8       Reserved                 RsvdP     Not Support.
7.2.107      POWER BUDGETING DATA REGISTER – OFFSET 214h
               BIT        FUNCTIO N                TYPE      DESCRIPTIO N
                                                             It specifies the base power value in watts. This value represents the required
                                                             power budget in the given operation condition. T he default value may be
               7:0        Base Power                RO       changed by auto-loading from EEPROM.
                                                             Reset to 04h.
                                                             It specifies the scale to apply to the base power value.
               9:8        Data Scale                RO
                                                             Reset to 00b.
                                                             It specifies the power management sub state of the given operation condition.
                                                             It is initialized to the default sub state.
               12:10      PM Sub State              RO
                                                             Reset to 000b.
                                                             It specifies the power management state of the given operation condition.
                                                             It defaults to the D0 power state.
               14:13      PM State                  RO
                                                             Reset to 00b.
                                                             It specifies the type of the given operation condition.
                                                             It defaults to the Maximum power state.
               17:15      T ype                     RO
                                                             Reset to 111b.
PI7C9X2G303EL                                             Page 77 of 91                                                   September 2017
Document Number DS40025 Rev 2-2                          www.diodes.com                                                   © Diodes Incorporated


                                                                                                          PI7C9X2G303EL
               BIT        FUNCTIO N           TYPE    DESCRIPTIO N
                                                      It specifies the power rail of the given operation condition.
               20:18      Power Rail           RO
                                                      Reset to 010b.
               31:21      Reserved            RsvdP   Not Support.
7.2.108      POWER BUDGET CAPABILITY REGISTER – OFFSET 218h
               BIT        FUNCTIO N           TYPE    DESCRIPTIO N
                                                      When set, it indicates that the power budget for the device is included within
                                                      the system power budget. The default value may be changed by auto-loading
               0          System Allocated     RO     from EEPROM.
                                                      Reset to 0b.
               31:1       Reserved            RsvdP   Not Support.
7.2.109       ACS EXTENDED CAPABILITY HEADER – OFFSET 220h (Downstream
              Port Only)
               BIT        FUNCTIO N           TYPE    DESCRIPTIO N
                          PCI Express                 Read as 000Dh to indicate PCI Express Extended Capability ID for ACS
               15:0       Extended Capability  RO     Extended Capability.
                          ID
                                                      Read as 1h. Indicates PCI-SIG defined PCI Express capability structure
               19:16      Capability Version   RO
                                                      version number.
               31:20      Next Capability ID   RO     Read as 000h. No other ECP registers.
7.2.110       ACS CAPABILITY REGISTER – OFFSET 224h (Downstream Port Only)
               BIT        FUNCTIO N           TYPE    DESCRIPTIO N
                                                      Indicated the implements of ACS Source Validation.
                          ACS Source
               0                               RO
                          Validation
                                                      Reset to 1b.
                                                      Indicated the implements of ACS T ranslation Blocking.
                          ACS T ranslation
               1                               RO
                          Blocking
                                                      Reset to 1b.
                                                      Indicated the implements of ACS P2P Request Redirect.
                          ACS P2P Request
               2                               RO
                          Redirect
                                                      Reset to 1b.
                                                      Indicated the implements of ACS P2P Completion Redirect.
                          ACS P2P
               3                               RO
                          Completion Redirect
                                                      Reset to 1b.
                                                      Indicated the implements of ACS Upstream Forwarding.
                          ACS Upstream
               4                               RO
                          Forwarding
                                                      Reset to 1b.
                                                      Indicated the implements of ACS P2P Egress control.
                          ACS P2P Egress
               5                               RO
                          control
                                                      Reset to 1 b.
                                                      Indicated the implements of ACS Direct Translated P2P.
                          ACS Direct
               6                               RO
                          T ranslated P2P
                                                      Reset to 1b.
               7          Reserved            RsvdP   Not Support.
                                                      Encodings 01h –FFh directly indicate the number of applicable bits in the
                          Egress Control              Egress Control Vector.
               15:8                            RO
                          Vector Size
                                                      Reset to 08h.
                                                      Enable the source validation.
                          ACS Source
               16                              RW
                          Validation Enable
                                                      Reset to 0b.
PI7C9X2G303EL                                       Page 78 of 91                                                   September 2017
Document Number DS40025 Rev 2-2                    www.diodes.com                                                   © Diodes Incorporated


                                                                                                          PI7C9X2G303EL
               BIT        FUNCTIO N           TYPE     DESCRIPTIO N
                                                       Enable ACS T ranslation Blocking.
                          ACS T ranslation
               17                              RW
                          Blocking Enable
                                                       Reset to 0b.
                                                       Enable ACS P2P Request Redirect.
                          ACS P2P Request
               18                              RW
                          Redirect
                                                       Reset to 0b.
                          ACS P2P                      Enable ACS P2P Completion Redirect
               19         Completion Redirect  RW
                          Enable                       Reset to 0b.
                                                       Enable ACS Upstream Forwarding.
                          ACS Upstream
               20                              RW
                          Forwarding Enable
                                                       Reset to 0b.
                                                       Enable ACS P2P Egress control.
                          ACS P2P Egress
               21                              RW
                          control Enable
                                                       Reset to 0b.
                          ACS Direct                   Enable ACS Direct T ranslated P2P.
               22         T ranslated P2P      RW
                          Enable                       Reset to 0b.
               31:23      Reserved            RsvdP    Not Support.
7.2.111       EGRESS CONTROL VECTOR – OFFSET 228h (Downstream Port Only)
               BIT        FUNCTIO N           TYPE     DESCRIPTIO N
                                                       When a given bit is set, peer-to-peer requests targeting the associated Port are
                          Egress Control               blocked or redirected.
               7:0                             RW
                          Vector
                                                       Reset to 00h.
               31:8       Reserved            RsvdP    Not Support.
7.2.112       LTR EXTENDED CAPABILITY HEADER – OFFSET 230h (Upstream Port
              Only)
               BIT        FUNCTIO N           TYPE    DESCRIPTIO N
                          PCI Express                 Read as 0018h to indicate PCI Express Extended Capability ID for LTR
               15:0       Extended Capability  RO     Extended Capability.
                          ID
                                                      Read as 1h. Indicates PCI-SIG defined PCI Express capability structure
               19:16      Capability Version   RO
                                                      version number.
               31:20      Next Capability ID   RO     Read as 000h. No other ECP registers.
7.2.113       MAX SNOOP LATENCY REGISTER – OFFSET 234h (Upstream Port Only)
               BIT        FUNCTIO N           TYPE    DESCRIPTIO N
                                                      .Specifies the maximum snoop latency that a device is permitted to request
                          Max Snoop Latency
               9:0                             RW
                          Value
                                                      Reset to 000h.
                                                      T his register provides a scale for the value contained within the Maximum
                          Max Snoop Latency           Snoop Latency Value field
               12:10                           RW
                          Scale
                                                      Reset to 000b
               15:13      Reserved            RsvdP   Not Support.
PI7C9X2G303EL                                       Page 79 of 91                                                   September 2017
Document Number DS40025 Rev 2-2                    www.diodes.com                                                    © Diodes Incorporated


                                                                                                   PI7C9X2G303EL
7.2.114       MAX NO-SNOOP LATENCY REGISTER – OFFSET 234h (Upstream Port
              Only)
               BIT       FUNCTIO N     TYPE    DESCRIPTIO N
                                               .Specifies the maximum no-snoop latency that a device is permitted to
                         Max No-Snoop          request
               25:16                    RW
                         Latency Value
                                               Reset to 000h.
                                               T his register provides a scale for the value contained within the Maximum
                         Max No-Snoop          No-Snoop Latency Value field
               28:26                    RW
                         Latency Scale
                                               Reset to 000b
               31:29     Reserved      RsvdP   Not Support.
PI7C9X2G303EL                                Page 80 of 91                                                   September 2017
Document Number DS40025 Rev 2-2             www.diodes.com                                                   © Diodes Incorporated


                                                                                                                  PI7C9X2G303EL
8 CLOCK SCHEME
The built-in Integrated Reference Clock Buffer of the PI7C9X2G303EL supports three reference clock outputs.
The clock buffer feature can be enabled and disabled by strapping the CLKBUF_PD pin.
When CLKBUF_ PD p in is asserted low, the clock buffer is enabled. The clock buffer distributes a single 100MHz
reference clock input to three Reference Clock Output Pairs, REFCLKO_P[2:0] and REFCLKO_ N[2:0]. The clock
buffer requires 100M Hz differential clock inputs through REFCLKI_P and REFCLKI_N Pins as show in the
following table.
When CLKBUF_PD p in is asserted high, the clock buffer is in power down mode and disabled. The 100MHz
Reference Clock Output Pairs are d isabled, and The PI7C9X2G303EL requires 100M Hz d ifferential clock inputs
through REFCLKP and REFCLKN Pins as shown in the following table.
Table 8-1 AC Switching Characteristics
         Symbol             Parameters                            Min.             Typ.            Max.              Unit
         FIN                Reference Clock Frequency                              100                               MHz
                        1
         T rise/ T fall     Rise and Fall T ime in 20-80%          175                              700               ps
         DT rise/ DT fall 1 Rise and Fall T ime Variation                                           125               ps
         T pd               Propagation Delay                      2.5                              6.5               ns
                  1
         Vswing             Voltage Including Overshoot            550                             1150               mV
         T DC 2             Duty Cycle                              45                               55               %
       Note :
       1. Measurement taken from Single Ended waveform.
       2. Measurement taken from Differential waveform.
       3.In general rule, use ac-coupling when differential input >500mV; use dc-coupling when differential input <400mV, such as LVDS
         drive with 100 ohm across at the inputs.
PI7C9X2G303EL                                                  Page 81 of 91                                              September 2017
Document Number DS40025 Rev 2-2                              www.diodes.com                                                © Diodes Incorporated


                                                                                                                PI7C9X2G303EL
9 IEEE 1149.1 COMPATIBLE JTAG CONTROLLER
An IEEE 1149.1 co mpatib le Test Access Port (TAP) controller and associated TAP pins are provided to support
boundary scan in PI7C9X2G303EL for board-level continuity test and diagnostics. The TAP pins assigned are
TCK, TDI, TDO, TMS and TRST_L. All digital input, output, input/output pins are tested except TAP pins.
9.1     INSTRUCTION REGISTER
The IEEE 1149.1 Test Logic consists of a TAP controller, an instruction register, and a group of test data registers
including Bypass and Boundary Scan registers. The TAP controller is a synchronous 16-state mach ine driven by the
Test Clock (TCK) and the Test Mode Select (TMS) pins. An independent power on reset circuit is provided to
ensure the machine is in TEST_LOGIC_RESET state at power-up.
PI7C9X2G303EL implements a 5-b it Instruction register to control the operation of the JTA G logic. The defined
instruction codes are shown in the follo wing table. Those bit combinations that are not listed are equivalent to the
BYPASS (11111) instruction.
Table 9-1 Instruction Register Codes
         Instruction        O pe ration Code (binary)    Re gister Selected    O pe ration
         EXT EST                      00000              Boundary Scan         Drives / receives off-chip test data
         SAMPLE                       00001              Boundary Scan         Samples inputs / pre-loads outputs
         HIGHZ                        00101              Bypass                T ri-states output and I/O pins except TDO pin
         CLAMP                        00100              Bypass                Drives pins from boundary-scan register and selects Bypass
                                                                               register for shifts
         IDCODE                       01100              Device ID             Accesses the Device ID register, to read manufacturer ID,
                                                                               part number, and version number
         BYPASS                       11111              Bypass                Selected Bypass Register
         INT _SCAN                    00010              Internal Scan         Scan test
         PHY_TEST_SIG                 01001              Private               Private
         MEM_BIST                     01010              Memory BIST           Memory BIST test
9.2     BYPASS REGISTER
The required bypass register (one-bit shift register) provides the shortest path between TDI and TDO when a bypass
instruction is in effect. This allows rapid movement of test data to and from other co mponents on the board.
This path can be selected when no test operation is being performed on the PI7C9X2G303EL.
9.3     DEVICE ID REGISTER
This register identifies Perico m as the manufacturer of the device and details the part number and revision number
for the device.
Table 9-2 JTAG Device ID Register
         Bit           Type                        Value                 De scription
         31-28         RO                          0001                  Version number
         27-12         RO                          0000010100001000      Last 4 digits (hex) of the die part number
         11-1          RO                          01000111111           Pericom identifier assigned by JEDEC
         0             RO                          1                     Fixed bit equal to 1’b1
PI7C9X2G303EL                                             Page 82 of 91                                                 September 2017
Document Number DS40025 Rev 2-2                         www.diodes.com                                                   © Diodes Incorporated


                                                                                                 PI7C9X2G303EL
9.4     BOUNDARY SCAN REGISTER
The boundary scan register has a set of serial shift-reg ister cells. A chain of boundary scan cells is fo rmed by
connected the internal signal of the PI7C9X2G303EL package pins. The VDD, VSS, and JTA G pins are not in the
boundary scan chain. The input to the shift register is TDI and the output fro m the shift register is TDO. There are 4
different types of boundary scan cells, based on the function of each signal pin.
The boundary scan register cells are dedicated logic and do not have any system function. Data may be loaded into
the boundary scan register master cells fro m the device input pins and output pin-drivers in parallel by the
mandatory SAMPLE and EXTEST instructions. Parallel loading takes place on the rising edge of TCK.
9.5     JTAG BOUNDARY SCAN REGISTER ORDER
Table 9-3 JTAG Boundary Scan Register Definition
           Boundary Scan
          Re giste r Numbe r       Pin Name             Ball Location              Type             Tri-state Control Ce ll
                    0           DWNRST _L[1]                  F1                  Output2
                    1           DWNRST _L[2]                  J3                  Output2
                    2                                                             Internal
                    3                T EST 1                  N3                   Input
                    4              PERST _L                  M1                    Input
                    5                T EST 2                  T1                   Input
                    6                T EST 3                  V1                   Birdir                      12
                    7               VC1_EN                   W3                    Birdir                      12
                    8              PRSNT [1]                  Y1                   Birdir                      12
                    9              PRSNT [2]                 AA3                   Birdir                      12
                   10                                                             Internal
                   11                T EST 4                 AD1                   Birdir                      12
                   12                                                             Control
                   13           RXPOLINV_DIS                 AE3                   Birdir                      12
                   14                T EST 5                 AF1                   Birdir                      12
                   15               SMBCLK                   AH1                   Birdir                      12
                   16             SMBDAT A                   AK1                   Birdir                      12
                   17              PWR_SAV                   AJ3                   Birdir                      12
                   18              SLOT CLK                  AR7                   Birdir                      12
                   19               GPIO[0]                  AR9                   Birdir                      20
                   20                                                             Control
                   21               GPIO[1]                  AU6                   Birdir                      22
                   22                                                             Control
                   23               GPIO[2]                  AU8                   Birdir                      24
                   24                                                             Control
                   25               GPIO[3]                 AR11                   Birdir                      26
                   26                                                             Control
                   27               GPIO[4]                 AU10                   Birdir                      28
                   28                                                             Control
                   29               GPIO[5]                 AU12                   Birdir                      30
                   30                                                             Control
                   31               GPIO[6]                 AR13                   Birdir                      32
                   32                                                             Control
                   33               GPIO[7]                 AU14                   Birdir                      34
                   34                                                             Control
                   35            SLOT _IMP[1]               AR15                   Birdir                      45
                   36            SLOT _IMP[2]               AU16                   Birdir                      45
                   37                                                             Internal
                   38                                                             Internal
                   39                T EST 6                AR21                   Birdir                      45
                   40                                                             Internal
                   41              PL_512B                  AR23                   Birdir                      45
                   42                                                             Internal
PI7C9X2G303EL                                        Page 83 of 91                                        September 2017
Document Number DS40025 Rev 2-2                    www.diodes.com                                          © Diodes Incorporated


                                                                    PI7C9X2G303EL
          Boundary Scan
         Re giste r Numbe r      Pin Name    Ball Location  Type      Tri-state Control Ce ll
                  43                                       Internal
                  44                                       Internal
                  45                                       Control
                  46                                       Internal
                  47            CLKBUF_PD        AR29       Birdir               45
                  48                                       Internal
                  49                                       Internal
                  50                                       Internal
                  51              EECLK          AJ35      Output2
                  52               EEPD          AK37       Birdir               53
                  53                                       Control
PI7C9X2G303EL                              Page 84 of 91                    September 2017
Document Number DS40025 Rev 2-2           www.diodes.com                     © Diodes Incorporated


                                                                                            PI7C9X2G303EL
10 POWER MANAGEMENT
The PI7C9X2G303EL supports D0, D1, D2, D3-hot, and D3-cold Power States. The PCI Exp ress Physical Link
Layer of the PI7C9X2G303EL device supports the PCI Express Lin k Power Management with L0, L0s, L1, L2/ L3
ready and L3 Power States.
During the t ransition fro m D3-hot to D3-co ld state, the main power supplies of VDDC and VDDR are turned off to
save power while keeping the VDDCAUX and VAUX with the auxiliary power supplies to maintain all necessary
informat ion to be restored to the full power D0 state. PI7C9X2G303EL has been designed to have sticky registers
that are powered by auxiliary power supplies. PI7C9X2G303EL forwards power management messages to the
upstream Switches or root complex.
PI7C9X2G303EL also supports ASPM (Active State Power Management) to facilitate the link power saving.
PI7C9X2G303EL                                         Page 85 of 91                               September 2017
Document Number DS40025 Rev 2-2                     www.diodes.com                                 © Diodes Incorporated


                                                                                              PI7C9X2G303EL
11 POWER SEQUENCE
As long as PERST# is active, all PCI Exp ress functions are held in reset. The main supplies ramp up to their
specified levels (3.3V). So metime during this stabilization time, the REFCLK starts and stabilizes. After there has
been time (100 ms ) for the power and clock to become stable, PERST# is deasserted high and the PCI Express
functions can start up.
It is reco mmended to power up the I/O voltage (3.3V) first and then the core voltage (1.0V) or power up I/ O voltage
and core voltage simultaneously for both Aux and Main power rails.
                                     Figure 11-1 Initial Power-Up Sequence
Power-down sequence is the reverse of power-up sequence
PI7C9X2G303EL                                      Page 86 of 91                                      September 2017
Document Number DS40025 Rev 2-2                   www.diodes.com                                      © Diodes Incorporated


                                                                                                                      PI7C9X2G303EL
12 ELECTRICAL AND TIMING SPECIFICATIONS
12.1 ABSOLUTE MAXIMUM RATINGS
Table 12-1 Absolute Maximum Ratings
       (Above which the useful life may be impaired. For user guidelines, not tested.)
         Ite m                                                                                         Absolute Max. Rating
         Storage T emperature (Tstore)                                                                      -65 o C to 150 o C
         Junction Temperature (Tj)                                                                                125 o C
         Digital core and analog supply voltage to ground potential (VDDC, AVDD and                          -0.3v to 1.5v
         VDDCAUX)
         Digital I/O and analog high supply voltage to ground potential (VDDR, CVDDR,                        -0.3v to 4.0v
         AVDDH and VAUX)
         DC input voltage for Digital I/O signals                                                            -0.3v to 4.0v
       Note :
       Stresses greater than those listed under MAXIMUM RATINGS may cause permanent damage to the device. This is a stress
       rating only and functional operation of the device at these or any conditions above those indicated in the operational sections
       of this specification is not implied. Exposure to absolute maximum rating conditions for extended periods of time may affect
       reliability.
12.2 DC SPECIFICATIONS
Table 12-2 DC Electrical Characteristics
         Symbol           De scription                                      Min.      Typ.        Max.        Unit
         VDDC1            Digital Core Power                                0.95       1.0         1.1
         VDDR             Digital I/O Power                                  3.0       3.3         3.6
         CVDDR            Reference Clock Power                              3.0       3.3         3.6
         VDDCAUX Auxiliary Core Power                                       0.95       1.0         1.1
         VAUX             Auxiliary I/O Power                                3.0       3.3         3.6
         AVDD             PCI Express Analog Power                          0.95       1.0         1.1          V
         AVDDH            PCI Express Analog High Voltage Power              3.0       3.3         3.6
         VIH              Input High Voltage                                 2.0                   5.5
         VIL              Input Low Voltage                                 -0.3                   0.8
         VOH              Output High Voltage                                2.4
         VOL              Output Low Voltage                                                       0.4
         RPU              Pull-up Resistor                                  63K       92K        142K
                                                                                                               Ω
         RPD              Pull-down Resistor                                57K       91K        159K
                    2
         RST # Slew       PERST _L Slew Rate                                 50                              mV/ns
       Note :
       1. In order to support auxiliary power management fully, it is recommended to have VDDC and VDDCAUX
           separated.
       2. T he min. value for PERST_L Slew Rate is 50 mV/ns, which translates to the requirement that the time for
           PERST _L from 0V to 3.3V should be less than 66 ns.
12.3 AC SPECIFICATIONS
Table 12-3 PCI Express Interface - Differential Transmitter (TX) Output (5.0 Gbps) Characteristics
         Parameter                                         Symbol                 Min        Typ        Max          Unit
         Unit Interval                                     UI                     199.94     200.0      200.06       ps
         Differential p-p TX voltage swing                 VTX-DIFF-P-P           800        -          -            mV
                                                                                                                     ppd
         Low power differential p-p TX voltage             VTX-DIFF-P-P-LOW       400        -          -            mV
PI7C9X2G303EL                                                   Page 87 of 91                                                   September 2017
Document Number DS40025 Rev 2-2                               www.diodes.com                                                    © Diodes Incorporated


                                                                                                    PI7C9X2G303EL
         Parameter                                     Symbol                  Min    Typ   Max    Unit
         swing                                                                                     ppd
         T X de-emphasis level ratio                   VTX-DE-RATIO-3.5dB      -3.0   -     -4.0   dB
         T X de-emphasis level ratio                   VTX-DE-RATIO-6dB        -5.5         -6.5   dB
         T ransmitter Eye including all jitter sources T TX-EYE                0.75   -     -      UI
         T X deterministic jitter > 1.5 MHz            T TX-HF-DJ-DD           -      -     0.15   UI
         T X RMS jitter < 1.5 MHz                      T TX-LF-RMS             -      -     3.0    Ps
                                                                                                   RMS
         T ransmitter rise and fall time               T TX-RISE-FALL          0.15   -     -      UI
         T X rise/fall mismatch                        T RF-MISMATCH           -      -     0.1    UI
         Maximum T X PLL Bandwidth                     BW TX-PLL               -      -     16     MHz
         Minimum T X PLL BW for 3dB peaking            BW TX-PLL-LO-3DB        8      -     -      MHz
         T X PLL peaking with 8 MHz min BW             PKGTX-PLL1              -      -     3.0    dB
         DC Differential TX Impedance                  ZTX-DIFF-DC             80     -     120    Ω
         T ransmitter Short-Circuit Current Limit      I TX-SHORT              -      -     90     mA
         T X DC Common Mode Voltage                    VTX-DC-CM               0      -     3.6    V
         Absolute Delta of DC Common Mode              VTX-CM-DC-ACTIVE-IDLE-  0      -     100    mV
         Voltage During L0 and Electrical Idle         DELTA
         Absolute Delta of DC Common Mode              VTX-CM-DC-LINE-DELTA    0      -     25     mV
         Voltage between D+ and D–
         Electrical Idle Differential Peak Output      VTX-IDLE-DIFF-AC-p      0      -     20     mV
         Voltage
         DC Electrical Idle Differential Output        VTX-IDLE-DIFF-DC        0      -     5      mV
         Voltage
         T he Amount of Voltage Change Allowed         VTX-RCV-DETECT          -      -     600    mV
         During Receiver Detection
         Lane-to-Lane Output Skew                      LTX-SKEW                -      -     500 ps ps
                                                                                            + 4 UI
Table 12-4 PCI Express Interface - Differential Transmitter (TX) Output (2.5 Gbps) Characteristics
         Parameter                                     Symbol                  Min    Typ   Max    Unit
         Unit Interval                                 UI                      399.88 400.0 400.12 ps
         Differential p-p TX voltage swing             VTX-DIFF-P-P            800    -     -      mV
                                                                                                   ppd
         Low power differential p-p TX voltage         VTX-DIFF-P-P-LOW        400    -     -      mV
         swing                                                                                     ppd
         T X de-emphasis level ratio                   VTX-DE-RATIO            -3.0   -     -4.0   dB
         Minimum T X eye width                         T TX-EYE                0.75   -     -      UI
         Maximum time between the jitter median        T TX-EYE-MEDIAN-to-MAX- -      -     0.125  UI
         and max deviation from the median             JITTER
         T ransmitter rise and fall time               T TX-RISE-FALL          0.125  -     -      UI
         Maximum T X PLL Bandwidth                     BW TX-PLL               -      -     22     MHz
         Maximum T X PLL BW for 3dB peaking            BW TX-PLL-LO-3DB        1.5    -     -      MHz
         Absolute Delta of DC Common Mode              VTX-CM-DC-ACTIVE-IDLE-  0      -     100    mV
         Voltage During L0 and Electrical Idle         DELTA
         Absolute Delta of DC Common Mode              VTX-CM-DC-LINE-DELTA    0      -     25     mV
         Voltage between D+ and D–
         Electrical Idle Differential Peak Output      VTX-IDLE-DIFF-AC-p      0      -     20     mV
         Voltage
         T he Amount of Voltage Change Allowed         VTX-RCV-DETECT          -      -     600    mV
         During Receiver Detection
         T ransmitter DC Common Mode Voltage           VTX-DC-CM               0      -     3.6    V
         T ransmitter Short-Circuit Current Limit      I TX-SHORT              -      -     90     mA
         DC Differential TX Impedance                  ZTX-DIFF-DC             80     100   120    Ω
         Lane-to-Lane Output Skew                      LTX-SKEW                -      -     500 ps ps
                                                                                            + 2 UI
Table 12-5 PCI Express Interface - Differential Receiver (RX) Input (5.0 Gbps) Characteristics
         Parameter                                     Symbol                  Min    Typ   Max    Unit
         Unit Interval                                 UI                      199.94 200.0 200.06 ps
         Differential RX Peak-to-Peak Voltage          VRX-DIFF-PP-CC          120    -     1200   mV
         T otal jitter tolerance                       T JRX                   0.68   -     -      UI
         Receiver DC common mode impedance             ZRX-DC                  40     -     60     Ω
PI7C9X2G303EL                                                 Page 88 of 91                               September 2017
Document Number DS40025 Rev 2-2                             www.diodes.com                                © Diodes Incorporated


                                                                                                                      PI7C9X2G303EL
            Parameter                                         Symbol                    Min      Typ      Max        Unit
            RX AC Common Mode Voltage                         VRX-CM-AC-P               -        -        150        mV
            Electrical Idle Detect Threshold                  VRX-IDLE-DET-DIFFp-p      65       -        175        mV
Table 12-6 PCI Express Interface - Differential Receiver (RX) Input (2.5 Gbps) Characteristics
            Parameter                                         Symbol                    Min      Typ      Max        Unit
            Unit Interval                                     UI                        399.88   400.0    400.12     ps
            Differential RX Peak-to-Peak Voltage              VRX-DIFF-PP-CC            175      -        1200       mV
            Receiver eye time opening                         T RX-EYE                  0.4      -        -          UI
            Maximum time delta between median and             T RX-EYE-MEDIAN-to-MAX-   -        -        0.3        UI
            deviation from median                             JITTER
            Receiver DC common mode impedance                 ZRX-DC                    40       -        60         Ω
            DC differential impedance                         ZRX-DIFF-DC               80       -        120        Ω
            RX AC Common Mode Voltage                         VRX-CM-AC-P               -        -        150        mV
            DC input CM input impedance during reset          ZRX-HIGH-IMP-DC           200      -        -          kΩ
            or power down
            Electrical Idle Detect Threshold                  VRX-IDLE-DET-DIFFp-p      65       -        175        mV
            Lane to Lane skew                                 LRX-SKEW                  -        -        20         ns
12.4 OPERATING AMBIENT TEMPERATURE
Table 12-7 Operating Ambient Temperature
           (Above which the useful life may be impaired.)
            Ite m                                                                   Min.           Max.         Units
                                                                                                                  o
            Ambient T emperature with power applied                                 -40             85              C
          Note :
          Exposure to high temperature conditions for extended periods of time may affect reliability.
12.5 POWER CONSUMPTION
Table 12-8 Power Consumption
                  1.0VDDC           1.0VAUX           1.0AVDD           3.3AVDDH            3.3VDDR      3.3VAUX             Total
Active Lane
                                                                                                                                           Unit
   pe r Port
                 Typ     Max      Typ      Max       Typ      Max       Typ        Max     Typ   Max    Typ    Max       Typ     Max
     1/1/1     123.20 327.91      2.20     2.42 144.10 346.06 35.31              38.84 319.44 351.38 0.03      0.03     624.28 1,066.65 mW
  1/1/1, ec1 123.20 327.91        2.20     2.42 144.10 346.06 35.31              38.84    6.60   7.26   0.03   0.03     311.44 722.52 mW
Note :
1
  : Use external clock buffer, Disable internal clock buffer.
T est Conditions:
- T ypical power measured under the conditions of 1.0V/ 3.3V power rail without device usage on all downstream ports.
- Maximum power measured under the conditions of 1.1V/ 3.63V with PCIe2 devices usage on all downstream ports.
- Ambient T emperature at 25o C
- Power consumption in the table is a reference, be affected by various environments, bus traffic and power supply etc.
PI7C9X2G303EL                                                        Page 89 of 91                                            September 2017
Document Number DS40025 Rev 2-2                                    www.diodes.com                                             © Diodes Incorporated


                                                                                                                                  PI7C9X2G303EL
13 PACKAGE INFORMATION
The package of PI7C9X2G303EL is a 8mm x 8mm aQFN (136 Pin) package. The following are the package
information and mechanical dimension:
                                                                    Figure 13-1 Package outline drawing
                                                                                                                                                    DATE: 09/27/11
                                                                                       DESCRIPTION: 136-contact, Advanced Quad Flat No-Lead (aQFN)
    Notes:
    1. All dimensions are in millimeters. Angles in degrees.                           PACKAGE CODE: ZX (ZX136)
    2. Coplanarity applies to leads, corner leads, rings and die attach pad
                                                                                       DOCUMENT CONTROL #: PD-2098                                     REVISION:A
PI7C9X2G303EL                                                                  Page 90 of 91                                                 September 2017
Document Number DS40025 Rev 2-2                                               www.diodes.com                                                 © Diodes Incorporated


                                                                            PI7C9X2G303EL
                                Figure 13-2 Package bottom view
                                             Top Pad (T), 1.0V
                                    Right Pad (R), 3.3V
                                                        Left Pad (L), 1.0V
                                             Bottom Pad (B), 1.0V
                                                                           Center Pad (GND)
PI7C9X2G303EL                                Page 91 of 91                              September 2017
Document Number DS40025 Rev 2-2            www.diodes.com                                © Diodes Incorporated


                                                                                     PI7C9X2G303EL
14 ORDERING INFORMATION
 Part Number                    Temperature Range             Package               Pb-Free & Green
 PI7C9X2G303EL□ZXEX             -40o to 85o C                 136-pin aQFN          Yes
                                (Industrial Temperature)      8mm x 8mm
                      PI 7C 9X2G303EL                ZX E X
                                                                       Tape & Reel
                                                                  Pb-Free and Green
                                                                      Package Code
                                                                    Blank=Standard
                                                                          =Revision
                                                                       Device Type
                                                                     Device Number
                                                                             Family
                                                                            Pericom
PI7C9X2G303EL                                   Page 92 of 91                               September 2017
Document Number DS40025 Rev 2-2                www.diodes.com                               © Diodes Incorporated


Mouser Electronics
Authorized Distributor
Click to View Pricing, Inventory, Delivery & Lifecycle Information:
Diodes Incorporated:
 PI7C9X2G303ELAZXE PI7C9X2G303ELAEVB PI7C9X2G303ELAZXEX PI7C9X2G303ELBZXE
PI7C9X2G303ELBZXEX
