      PI7C9X20303SL
PCI EXPRESS® PACKET SWITCH
           DATASHEET
          REVISION 1.1
            July 2009
                            3545 North 1ST Street, San Jose, CA 95134
                       Telephone: 1-877-PERICOM, (1-877-737-4266)
                                                   FAX: 408-435-1100
                                   Internet: http://www.pericom.com


                                                                                                                             PI7C9X20303SL
                                                                                                    3Port-3Lane PCI Express® Switch
                                                                                                                         SlimLineTM Family
                                                                                                                                     Datasheet
DISCLAIMER
The information contained in this document is proprietary and confidential to Pericom Semiconductor Cooperation (PSC). No part of this
document may be copied or reproduced in any form or by any means without prior written consent of PSC.
The information in this document is subjected to change without notice. PSC retains the right to make changes to this document at any time
without notice. While the information contained in this document has been checked for accuracy, such information is preliminary, and PSC does
not warrant the accuracy and completeness of such information. PSC does not assume any liability or responsibility for damages arising from any
use of the information contained in this document.
LIFE SUPPORT POLICY
Pericom Semiconductor Corporation’s products are not authorized for use as critical components in life support devices or systems unless a
specific written agreement pertaining to such intended use is executed between the manufacturer and an officer of PSC.
1)    Life support devices or system are devices or systems which:
      a) Are intended for surgical implant into the body or
      b) Support or sustain life and whose failure to perform, when properly used in accordance with instructions for use provided in the
            labeling, can be reasonably expected to result in a significant injury to the user.
2)    A critical component is any component of a life support device or system whose failure to perform can be reasonably expected to cause the
      failure of the life support device or system, or to affect its safety or effectiveness. Pericom Semiconductor Corporation reserves the right to
      make changes to its products or specifications at any time, without notice, in order to improve design or performance and to supply the best
      possible product. Pericom Semiconductor does not assume any responsibility for use of any circuitry described other than the circuitry
      embodied in a Pericom Semiconductor product. The Company makes no representations that circuitry described herein is free from patent
      infringement or other rights of third parties which may result from its use. No license is granted by implication or otherwise under any
      patent, patent rights or other rights, of Pericom Semiconductor Corporation.
All other trademarks are of their respective companies.
                                                                      Page 2 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                    PI7C9X20303SL
                                                                            3Port-3Lane PCI Express® Switch
                                                                                                  SlimLineTM Family
                                                                                                         Datasheet
REVISION HISTORY
Date         Revision Number Description
9/13/07      0.1             Drafted Preliminary Datasheet
10/04/07     0.2             Corrected Chapter 3 Pin Description (DTX’s and DEQ’s default values)
                             Updated Chapter 3.5 JTAG Signals description
                             Updated Chapter 7.2.53 bit
                             Remove VDDP, VDDAUX from Chapter 10 Power Management and
                             Chapter 11.1 Absolute Maximum Ratings
                             Revised Chapter 10 Power Management
                             Corrected Chapter 3 Pin Description (PERP/PERN, PETP/PETN,
                             WAKEUP_L, SLOT_IMP, SLOTCLK, EEPD, SMBDATA, SCAN_EN,
                             PORTACT to PORTERR, DTX, DEQ)
                             Updated 5.1 Physical Layer Circuit and Chapter 5.6 Queue
                             Updated Disclaimer
                             Corrected Chapter 2 General Description
                             Updated Chapter 13 Ordering Information
                             Corrected Chapter 3 Pin Description (DWNRST_L, SLOT_IMP,
                             PORTERR, NC)
                             Corrected Chapter 4 Pin Assignment (DWNRST_L[3], SLOT_IMP[3],
                             PORTERR[3])
                             Removed Virtual Channel 1 related information in Chapter 2 General
                             Description and Chapter 5 (5.5 TC/VC Mapping, 5.6 Queue, 5.7 Transaction
                             Ordering, 5.9 VC Arbitration)
10/31/07     0.3             Updated Footer
                             Updated Chapter 5.8 Port Arbitration
                             Updated Chapter 6.1.3 EEPROM Space Address Map
                             Added Chapter 6.2 SMBus
                             Fixed Chapter 6.1.4 Mapping EEPROM table format
                             Updated Chapter 7 Registers (Offset 08h, 100h, 140h to 1BCh, B0h bit 31)
2/20/08      0.4             Updated Chapter 6 EEPROM (50h, 52h, 54h Reserved)
                             Updated 7.2.91 [7:0] (Removed VC1 description)
                             Corrected Chapter 5 Functional Description (multiple virtual channels)
                             Updated Chapter 6 EEPROM (0Ch)
                             Modified Chapter 7 Registers (7.2.2 Device ID Register, 7.2.50 Bit[13:15]
                             Replay Time-Out Counter, 7.2.52 Bit[14:15] Switch Operation Mode, 7.2.64
                             PCI Express Capability Bit[24], 7.2.70 Link Status Bit[28], 7.2.99 Power
                             Budgeting Data, 7.2.100 Power Budget Capability)
                             Updated 9.5 JTAG Boundary Scan Register Order
                             Updated Chapter 3.5 Power Pins (VDDC, VDDA, VDDAUX, VTT)
                             Updated Chapter 6 EEPROM (A0h, A2h, A4h)
                             Updated Chapter 1 Features (Power Dissipation)
                             Updated Chapter 11.1 AC Specification (VDDAUX)
                             Updated Chapter 11.2 DC Specification (Power Consumption, VDDAUX)
                             Updated Chapter 10 Power Management (VDDAUX)
5/28/08      0.5             Updated 1 Features (typical latency, removed peer-to-peer switching, power
                             consumption)
                             Updated Chapter 3.1 PCI Express Interface Signals (REFCLKP, REFCLKN,
                             PRSNT)
                             Updated Chapter 4.1 PIN List of 128-PIN LQFP (PRSNT)
                             Modified 5.1 Physical Layer Circuit
                             Updated Chapter 6.1.3 EEPROM Space Address Map (10h to 14h, 50h to
                             54h)
                             Modified 6.1.4 Mapping EEPROM Contents To Configuration Registers
                             (0Ch: Ordering Frozen, TX SOF Latency, Surprise Down Capability Enable,
                             Power Management Data Select, 20h, 22h, 24h: Removed LPVC, Added
                             PMCSR, 51h, 52h, 53h, 54h, 55h, 56h)
                             Updated Chapter 7.2 Transparent Mode Configuration Registers (A4h, B4h,
                                                 Page 3 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                  PI7C9X20303SL
                                                                         3Port-3Lane PCI Express® Switch
                                                                                              SlimLineTM Family
                                                                                                       Datasheet
                         B8, BCh, C0h, C4h)
                         Updated 7.2.5 Revision ID Register, 7.2.27 Interrupt Pin Register, 7.2.32
                         Power Management Data Register Bit[3], 7.2.46 Next Item Pointer Register,
                         7.2.50 Replay Time-Out Counter, 7.2.51 Acknowledge Latency Timer,
                         7.5.52 Switch Operation Mode, 7.2.53 Switch Operation Mode
                         (Downstream Port) Bit[16:31], 7.2.54 XPIP CSR2, 7.2.55 SSID/SSVID
                         Capability ID Register, 7.2.56 Next Item Pointer Register, 7.2.57 Subsystem
                         Vendor ID Register, 7.2.58 Subsystem ID Register, 7.2.65 PCI Express
                         Capabilities Register Bit[19:16], 7.2.69 Link Capabilities Register Bit 19,
                         7.2.86 Capability Version Bit[19:16], 7.2.93 VC Resource Control Register
                         Bit [26:24], 7.2.97 Capability Version Bit[19:16]
7/10/08      0.6         Modified 1. Features
                         Modified 3.3 Miscellaneous Signals (DEQ[3] to P0_CTCDIS, HIDRV to
                         P1_CTCDIS, LODRV to P2_CTCDIS, DTX[3] to TEST7)
                         Modified 4.1 Pin List (DEQ[3] to P0_CTCDIS, HIDRV to P1_CTCDIS,
                         LODRV to P2_CTCDIS[2], DTX[3] to TEST7)
                         Modified 6.1.4 Mapping EEPROM Contents To Configuration Registers
                         (0Ch, 10h, 12h, 14h)
                         Corrected 7.2.27 Interrupt Pin Register
                         Added 7.2.55 TL CSR
                         Modified 11.2 Power Consumption
9/5/08       0.7         Updated Chapter 1 Features (updated Industrial Temperature Range)
                         Updated Section 11.1 Absolute Maximum Ratings: Ambient Temperature
                         with power applied
                         Updated Figure 12-1 Package outline drawing
10/3/08      0.8         Updated Chapter 1 Features (power dissipation)
                         Modified 11.2 Power Consumption
11/24/08     1.0         Corrected Chapter 7.2 (8Ch - Next Item Pointer)
                         Updated Figure 12-1 Package outline drawing
                         Updated Chapter 13 Ordering Information
                         Removed “Preliminary” and “Confidential” references
7/20/09      1.1         Updated Chapter 3.2 Port Configuration Signals (PRSNT, SLOTCLK)
                         Updated Chapter 3.3 Miscellaneous Signals (updated PWR_SAV pin,
                         SMBCLK, SMBDATA, PWR_SAV, CTCDIS, EEPD)
                         Updated Chapter 3.4 JTAG Boundary Scan Signals (TMS, TDI, TRST_L)
                         Updated Chapter 7.2.52 Switch Operation Mode (Bit[31:16])
                         Updated Chapter 13 Ordering Information
                                              Page 4 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                                                                 PI7C9X20303SL
                                                                                                               3Port-3Lane PCI Express® Switch
                                                                                                                                             SlimLineTM Family
                                                                                                                                                            Datasheet
TABLE OF CONTENTS
1    FEATURES.........................................................................................................................................................10
2    GENERAL DESCRIPTION..............................................................................................................................11
3    PIN DESCRIPTION...........................................................................................................................................12
   3.1      PCI EXPRESS INTERFACE SIGNALS ....................................................................................................12
   3.2      PORT CONFIGURATION SIGNALS .......................................................................................................12
   3.3      MISCELLANEOUS SIGNALS..................................................................................................................12
   3.4      JTAG BOUNDARY SCAN SIGNALS ......................................................................................................13
   3.5      POWER PINS.............................................................................................................................................14
4    PIN ASSIGNMENTS .........................................................................................................................................15
   4.1      PIN LIST OF 128-PIN LQFP.......................................................................................................................15
5    FUNCTIONAL DESCRIPTION.......................................................................................................................16
   5.1      PHYSICAL LAYER CIRCUIT ..................................................................................................................16
   5.2      DATA LINK LAYER (DLL)......................................................................................................................18
   5.3      TRANSACTION LAYER RECEIVE BLOCK (TLP DECAPSULATION) ..............................................18
   5.4      ROUTING ..................................................................................................................................................18
   5.5      TC/VC MAPPING......................................................................................................................................19
   5.6      QUEUE.......................................................................................................................................................19
      5.6.1     PH .......................................................................................................................................................19
      5.6.2     PD .......................................................................................................................................................19
      5.6.3     NPHD .................................................................................................................................................19
      5.6.4     CPLH ..................................................................................................................................................19
      5.6.5     CPLD ..................................................................................................................................................19
   5.7      TRANSACTION ORDERING...................................................................................................................20
   5.8      PORT ARBITRATION ..............................................................................................................................20
   5.9      FLOW CONTROL .....................................................................................................................................21
   5.10 TRANSATION LAYER TRANSMIT BLOCK (TLP ENCAPSULATION) .............................................21
6    EEPROM INTERFACE AND SYSTEM MANAGEMENT BUS..................................................................22
   6.1      EEPROM INTERFACE .............................................................................................................................22
      6.1.1     AUTO MODE EERPOM ACCESS .....................................................................................................22
      6.1.2     EEPROM MODE AT RESET..............................................................................................................22
      6.1.3     EEPROM SPACE ADDRESS MAP ....................................................................................................22
      6.1.4     MAPPING EEPROM CONTENTS TO CONFIGURATION REGISTERS..........................................24
   6.2      SMBUS INTERFACE .................................................................................................................................29
7    REGISTER DESCRIPTION.............................................................................................................................30
   7.1      REGISTER TYPES ....................................................................................................................................30
   7.2      TRANSPARENT MODE CONFIGURATION REGISTERS ....................................................................30
      7.2.1     VENDOR ID REGISTER – OFFSET 00h ...........................................................................................32
      7.2.2     DEVICE ID REGISTER – OFFSET 00h.............................................................................................32
      7.2.3     COMMAND REGISTER – OFFSET 04h............................................................................................32
      7.2.4     PRIMARY STATUS REGISTER – OFFSET 04h.................................................................................33
      7.2.5     REVISION ID REGISTER – OFFSET 08h .........................................................................................33
      7.2.6     CLASS CODE REGISTER – OFFSET 08h .........................................................................................33
      7.2.7     CACHE LINE REGISTER – OFFSET 0Ch.........................................................................................34
                                                                        Page 5 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                                                PI7C9X20303SL
                                                                                              3Port-3Lane PCI Express® Switch
                                                                                                                            SlimLineTM Family
                                                                                                                                           Datasheet
      7.2.8     PRIMARY LATENCY TIMER REGISTER – OFFSET 0Ch ................................................................34
      7.2.9     HEADER TYPE REGISTER – OFFSET 0Ch......................................................................................34
      7.2.10    PRIMARY BUS NUMBER REGISTER – OFFSET 18h ......................................................................34
      7.2.11    SECONDARY BUS NUMBER REGISTER – OFFSET 18h ................................................................34
      7.2.12    SUBORDINATE BUS NUMBER REGISTER – OFFSET 18h ............................................................34
      7.2.13    SECONDARY LATENCY TIMER REGISTER – OFFSET 18h ...........................................................35
      7.2.14    I/O BASE ADDRESS REGISTER – OFFSET 1Ch..............................................................................35
      7.2.15    I/O LIMIT ADDRESS REGISTER – OFFSET 1Ch.............................................................................35
      7.2.16    SECONDARY STATUS REGISTER – OFFSET 1Ch ..........................................................................35
      7.2.17    MEMORY BASE ADDRESS REGISTER – OFFSET 20h ...................................................................36
      7.2.18    MEMORY LIMIT ADDRESS REGISTER – OFFSET 20h ..................................................................36
      7.2.19    PREFETCHABLE MEMORY BASE ADDRESS REGISTER – OFFSET 24h.....................................36
      7.2.20    PREFETCHABLE MEMORY LIMIT ADDRESS REGISTER – OFFSET 24h....................................36
      7.2.21    PREFETCHABLE MEMORY BASE ADDRESS UPPER 32-BITS REGISTER – OFFSET 28h .........37
      7.2.22    PREFETCHABLE MEMORY LIMIT ADDRESS UPPER 32-BITS REGISTER – OFFSET 2Ch .......37
      7.2.23    I/O BASE ADDRESS UPPER 16-BITS REGISTER – OFFSET 30h...................................................37
      7.2.24    I/O LIMIT ADDRESS UPPER 16-BITS REGISTER – OFFSET 30h..................................................37
      7.2.25    CAPABILITY POINTER REGISTER – OFFSET 34h .........................................................................37
      7.2.26    INTERRUPT LINE REGISTER – OFFSET 3Ch.................................................................................38
      7.2.27    INTERRUPT PIN REGISTER – OFFSET 3Ch ...................................................................................38
      7.2.28    BRIDGE CONTROL REGISTER – OFFSET 3Ch ..............................................................................38
      7.2.29    POWER MANAGEMENT CAPABILITY ID REGISTER – OFFSET 80h ...........................................39
      7.2.30    NEXT ITEM POINTER REGISTER – OFFSET 80h...........................................................................39
      7.2.31    POWER MANAGEMENT CAPABILITIES REGISTER – OFFSET 80h.............................................39
      7.2.32    POWER MANAGEMENT DATA REGISTER – OFFSET 84h ............................................................39
      7.2.33    PPB SUPPORT EXTENSIONS – OFFSET 84h..................................................................................40
      7.2.34    DATA REGISTER – OFFSET 84h ......................................................................................................40
      7.2.35    MSI CAPABILITY ID REGISTER – OFFSET 8Ch (Downstream Port Only) ....................................40
      7.2.36    NEXT ITEM POINTER REGISTER – OFFSET 8Ch (Downstream Port Only) .................................41
      7.2.37    MESSAGE CONTROL REGISTER – OFFSET 8Ch (Downstream Port Only) ..................................41
      7.2.38    MESSAGE ADDRESS REGISTER – OFFSET 90h (Downstream Port Only) ....................................41
      7.2.39    MESSAGE UPPER ADDRESS REGISTER – OFFSET 94h (Downstream Port Only) ......................41
      7.2.40    MESSAGE DATA REGISTER – OFFSET 98h (Downstream Port Only) ...........................................41
      7.2.41    VPD CAPABILITY ID REGISTER – OFFSET 9Ch (Upstream Port Only)........................................41
      7.2.42    NEXT ITEM POINTER REGISTER – OFFSET 9Ch (Upstream Port Only) ......................................42
      7.2.43    VPD REGISTER – OFFSET 9Ch (Upstream Port Only)....................................................................42
      7.2.44    VPD DATA REGISTER – OFFSET A0h (Upstream Port Only).........................................................42
      7.2.45    VENDOR SPECIFIC CAPABILITY ID REGISTER – OFFSET A4h..................................................42
      7.2.46    NEXT ITEM POINTER REGISTER – OFFSET A4h ..........................................................................43
      7.2.47    LENGTH REGISTER – OFFSET A4h ................................................................................................43
      7.2.48    XPIP CSR0 – OFFSET A8h (Test Purpose Only)...............................................................................43
      7.2.49    XPIP CSR1 – OFFSET ACh (Test Purpose Only) ..............................................................................43
      7.2.50    REPLAY TIME-OUT COUNTER – OFFSET B0h (Upstream Port)...................................................43
      7.2.51    ACKNOWLEDGE LATENCY TIMER – OFFSET B0h.......................................................................44
      7.2.52    SWITCH OPERATION MODE – OFFSET B4h (Upstream Port)......................................................44
      7.2.53    SWITCH OPERATION MODE – OFFSET B4h (Downstream Port) .................................................45
      7.2.54    XPIP CSR2 – OFFSET B8h (Test Purpose Only)...............................................................................46
      7.2.55    TL CSR – OFFSET BCh .....................................................................................................................46
      7.2.56    SSID/SSVID CAPABILITY ID REGISTER – OFFSET C0h................................................................46
      7.2.57    NEXT ITEM POINTER REGISTER – OFFSET C0h ..........................................................................46
      7.2.58    SUBSYSTEM VENDOR ID REGISTER – OFFSET C4h ....................................................................46
      7.2.59    SUBSYSTEM ID REGISTER – OFFSET C4h.....................................................................................47
      7.2.60    GPIO CONTROL REGISTER – OFFSET D8h (Upstream Port Only)...............................................47
                                                       Page 6 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                                                     PI7C9X20303SL
                                                                                                   3Port-3Lane PCI Express® Switch
                                                                                                                                 SlimLineTM Family
                                                                                                                                                Datasheet
      7.2.61 EEPROM CONTROL REGISTER – OFFSET DCh (Upstream Port Only)........................................48
      7.2.62 EEPROM ADDRESS REGISTER – OFFSET DCh (Upstream Port Only).........................................49
      7.2.63 EEPROM DATA REGISTER – OFFSET DCh (Upstream Port Only)................................................49
      7.2.64 PCI EXPRESS CAPABILITY ID REGISTER – OFFSET E0h ............................................................49
      7.2.65 NEXT ITEM POINTER REGISTER – OFFSET E0h ..........................................................................49
      7.2.66 PCI EXPRESS CAPABILITIES REGISTER – OFFSET E0h..............................................................49
      7.2.67 DEVICE CAPABILITIES REGISTER – OFFSET E4h .......................................................................50
      7.2.68 DEVICE CONTROL REGISTER – OFFSET E8h...............................................................................51
      7.2.69 DEVICE STATUS REGISTER – OFFSET E8h...................................................................................51
      7.2.70 LINK CAPABILITIES REGISTER – OFFSET ECh............................................................................52
      7.2.71 LINK CONTROL REGISTER – OFFSET F0h....................................................................................53
      7.2.72 LINK STATUS REGISTER – OFFSET F0h ........................................................................................53
      7.2.73 SLOT CAPABILITIES REGISTER (Downstream Port Only) – OFFSET F4h ...................................54
      7.2.74 SLOT CONTROL REGISTER (Downstream Port Only) – OFFSET F8h...........................................55
      7.2.75 SLOT STATUS REGISTER (Downstream Port Only) – OFFSET F8h ...............................................56
      7.2.76 PCI EXPRESS ADVANCED ERROR REPORTING CAPABILITY ID REGISTER – OFFSET 100h.57
      7.2.77 CAPABILITY VERSION – OFFSET 100h ..........................................................................................57
      7.2.78 NEXT ITEM POINTER REGISTER – OFFSET 100h.........................................................................57
      7.2.79 UNCORRECTABLE ERROR STATUS REGISTER – OFFSET 104h .................................................57
      7.2.80 UNCORRECTABLE ERROR MASK REGISTER – OFFSET 108h ....................................................58
      7.2.81 UNCORRECTABLE ERROR SEVERITY REGISTER – OFFSET 10Ch.............................................59
      7.2.82 CORRECTABLE ERROR STATUS REGISTER – OFFSET 110 h......................................................59
      7.2.83 CORRECTABLE ERROR MASK REGISTER – OFFSET 114 h .........................................................60
      7.2.84 ADVANCE ERROR CAPABILITIES AND CONTROL REGISTER – OFFSET 118h.........................60
      7.2.85 HEADER LOG REGISTER – OFFSET From 11Ch to 128h ..............................................................61
      7.2.86 PCI EXPRESS VIRTUAL CHANNEL CAPABILITY ID REGISTER – OFFSET 140h (Upstream Only)
                61
      7.2.87 CAPABILITY VERSION – OFFSET 140h (Upstream Only) ..............................................................61
      7.2.88 NEXT ITEM POINTER REGISTER – OFFSET 140h (Upstream Only).............................................61
      7.2.89 PORT VC CAPABILITY REGISTER 1 – OFFSET 144h (Upstream Only) ........................................61
      7.2.90 PORT VC CAPABILITY REGISTER 2 – OFFSET 148h (Upstream Only) ........................................62
      7.2.91 PORT VC CONTROL REGISTER – OFFSET 14Ch (Upstream Only)...............................................62
      7.2.92 PORT VC STATUS REGISTER – OFFSET 14Ch (Upstream Only)...................................................62
      7.2.93 VC RESOURCE CAPABILITY REGISTER (0) – OFFSET 150h (Upstream Only)............................63
      7.2.94 VC RESOURCE CONTROL REGISTER (0) – OFFSET 154h (Upstream Only) ..............................63
      7.2.95 VC RESOURCE STATUS REGISTER (0) – OFFSET 158h (Upstream Only)....................................64
      7.2.96 PORT ARBITRATION TABLE REGISTER (0) – OFFSET 180h-1BCh (Upstream Only)..................64
      7.2.97 PCI EXPRESS POWER BUDGETING CAPABILITY ID REGISTER – OFFSET 20Ch ....................64
      7.2.98 CAPABILITY VERSION – OFFSET 20Ch..........................................................................................64
      7.2.99 NEXT ITEM POINTER REGISTER – OFFSET 20Ch ........................................................................65
      7.2.100      DATA SELECT REGISTER – OFFSET 210h .................................................................................65
      7.2.101      POWER BUDGETING DATA REGISTER – OFFSET 214h ..........................................................65
      7.2.102      POWER BUDGET CAPABILITY REGISTER – OFFSET 218h .....................................................66
8    CLOCK SCHEME .............................................................................................................................................67
9    IEEE 1149.1 COMPATIBLE JTAG CONTROLLER....................................................................................68
   9.1     INSTRUCTION REGISTER ......................................................................................................................68
   9.2     BYPASS REGISTER .................................................................................................................................68
   9.3     DEVICE ID REGISTER.............................................................................................................................68
   9.4     BOUNDARY SCAN REGISTER...............................................................................................................69
   9.5     JTAG BOUNDARY SCAN REGISTER ORDER......................................................................................69
10 POWER MANAGEMENT ................................................................................................................................71
                                                            Page 7 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                                                  PI7C9X20303SL
                                                                                                3Port-3Lane PCI Express® Switch
                                                                                                                              SlimLineTM Family
                                                                                                                                             Datasheet
11 ELECTRICAL AND TIMING SPECIFICATIONS .......................................................................................72
   11.1    ABSOLUTE MAXIMUM RATINGS ........................................................................................................72
   11.2    POWER CONSUMPTION.........................................................................................................................72
   11.3    DC SPECIFICATIONS ..............................................................................................................................72
   11.4    AC SPECIFICATIONS ..............................................................................................................................73
12 PACKAGE INFORMATION............................................................................................................................75
13 ORDERING INFORMATION..........................................................................................................................76
                                                         Page 8 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                                                 PI7C9X20303SL
                                                                                               3Port-3Lane PCI Express® Switch
                                                                                                                             SlimLineTM Family
                                                                                                                                            Datasheet
TABLE OF FIGURES
FIGURE 6-1 SMBUS ARCHITECTURE IMPLEMENTATION ON PI7C9X20303SL ............................................................29
FIGURE 12-1 PACKAGE OUTLINE DRAWING .................................................................................................................75
LIST OF TABLES
TABLE 5-1 NOMINAL DRIVER CURRENT VALUES (INOM)............................................................................................16
TABLE 5-2 RATIO OF ACTUAL CURRENT AND NOMINAL CURRENT .............................................................................16
TABLE 5-3 DE-EMPHASIS LEVEL VERSUS DEQ [3:0]...................................................................................................17
TABLE 5-4 SUMMARY OF PCI EXPRESS ORDERING RULES ..........................................................................................20
TABLE 6-1 SMBUS ADDRESS PIN CONFIGURATION ....................................................................................................29
TABLE 7-1 TABLE ENTRY SIZE IN 4 BITS .....................................................................................................................64
TABLE 8-1 INPUT CLOCK REQUIREMENTS ...................................................................................................................67
TABLE 9-1 INSTRUCTION REGISTER CODES ..................................................................................................................68
TABLE 9-2 JTAG DEVICE ID REGISTER .......................................................................................................................68
TABLE 9-3 JTAG BOUNDARY SCAN REGISTER DEFINITION ..........................................................................................69
TABLE 11-1 ABSOLUTE MAXIMUM RATINGS ................................................................................................................72
TABLE 11-2 PI7C9X303SL POWER DISSIPATION .........................................................................................................72
TABLE 11-3 DC ELECTRICAL CHARACTERISTICS .........................................................................................................72
TABLE 11-4 TRANSMITTER CHARACTERISTICS............................................................................................................73
TABLE 11-5 RECEIVER CHARACTERISTICS ..................................................................................................................74
                                                        Page 9 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                              PI7C9X20303SL
                                                                            3Port-3Lane PCI Express® Switch
                                                                                            SlimLineTM Family
                                                                                                   Datasheet
1 Features
      3-lane PCI Express Switch with 3 PCI Express ports
      Non-blocking full-wired switching capability at 12 Gbps when all 3 ports are enabled
      Supports “Cut-through”(Default) as well as “Store and Forward” mode for packet switching
      150 ns typical latency for packet routed through Switch without blocking
      Strapped pins configurable with optional EEPROM or SMBus
      SMBus interface support
      Compliant with System Management (SM) Bus, Version 1.0
      Compliant with PCI Express Base Specification Revision 1.1
      Compliant with PCI Express CEM Specification Revision 1.1
      Compliant with PCI-to-PCI Bridge Architecture Specification Revision 1.2
      Compliant with Advanced Configuration Power Interface (ACPI) Specification
      Reliability, Availability and Serviceability
              - Supports Data Poisoning and End-to-End CRC
              - Advanced Error Reporting and Logging
              - IEEE 1149.6 JTAG interface support
      Advanced Power Saving
              - Empty downstream ports are set to idle state to minimize power consumption
      Link Power Management
              - Supports L0, L0s, L1, L2, L2/L3Ready and L3 link power states
              - Active state power management for L0s and L1 states
              - Beacon or Wake# support in L2 state
      Device State Power Management
              - Supports D0, D3Hot and D3Cold device power states
              - 3.3V Aux Power support in D3Cold power state
      Port Arbitration: Round Robin (RR), Weighted RR and Time-based Weighted RR
      Supports up to 256-byte maximum payload size
      Programmable driver current and de-emphasis level at each individual port
      Low Power Dissipation at 360 mW typical in L0 normal mode, 210 mW typical in L1 standby mode
      Industrial Temperature Range -40o to 85oC
      128-pin LQFP 14mm x 14mm package
                                                    Page 10 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                    PI7C9X20303SL
                                                                               3Port-3Lane PCI Express® Switch
                                                                                                  SlimLineTM Family
                                                                                                            Datasheet
2 GENERAL DESCRIPTION
Similar to the role of PCI/PCIX Bridge in PCI/PCIX bus architecture, the function of PCI Express (PCIE) Switch is
to expand the connectivity to allow more end devices to be reached by host controllers in PCIE serial interconnect
architecture. The 3-lane PCIE Switch can be configured as 3-port type combinations. It provides users the flexibility
to expand or fan-out the PCI Express lanes based on their application needs. For some systems that do not need all
the 3 lanes, the unused lanes can be disabled to reduce power consumption.
In the PCI Express Architecture, the PCIE Switch forwards posted and non-posted requests and completion packets
in either downstream or upstream direction concurrently as if a virtual PCI Bridge is in operation on each port. By
visualizing the port as a virtual Bridge, the Switch can be logically viewed as two-level cascaded multiple virtual
PCI-to-PCI Bridges, where one upstream-port Bridge sits on all downstream-port Bridges. Similar to a PCI Bridge
during enumeration, each port is given a unique bus number, device number, and function number by the initiating
software. The bus number, device number, and function number are combined to form a destination ID for each
specific port. In addition to that, the memory-map and IO address ranges are exclusively allocated to each port as
well. After the software enumeration is finished, the packets are routed to the dedicated port based on the embedded
address or destination ID. To ensure the packet integrity during forwarding, the Switch is not allowed to split the
packets to multiple small packets or merge the received packets into a large transmit packet. Also, the IDs of the
requesters and completers are kept unchanged along the path between ingress and egress port.
The Switch employs the architecture of Combined Input and Output Queue (CIOQ) in implementation. The main
reason for choosing CIOQ is that the required memory bandwidth of input queue equals to the bandwidth of ingress
port rather than increasing proportionally with port numbers as an output queue Switch does. The CIOQ at each
ingress port contains separate dedicated queues to store packets. The packets are arbitrated to the egress port based
on the PCIe transaction-ordering rule. For the packets without ordering information, they are permitted to pass over
each other in case that the addressed egress port is available to accept them. As to the packets required to follow the
ordering rule, the Head-Of-Line (HOL) issue becomes unavoidable for packets destined to different egress ports
since the operation of producer-consumer model has to be retained; otherwise the system might occur hang-up
problem. On the other hand, the Switch places replay buffer at each egress port to defer the packets before sending it
out. This can assure the maximum throughput being achieved and therefore the Switch works efficiently. Another
advantage of implementing CIOQ in PCIe Switch is that the credit announcement to the counterpart is simplified
and streamlined because of the credit-based flow control protocol. The protocol requires that each ingress port
maintains the credits independently without checking other ports' credit availability, which is otherwise required by
pure output queue architecture.
                                                      Page 11 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                      PI7C9X20303SL
                                                                         3Port-3Lane PCI Express® Switch
                                                                                                   SlimLineTM Family
                                                                                                               Datasheet
3 PIN DESCRIPTION
3.1     PCI EXPRESS INTERFACE SIGNALS
         NAME                 PIN    TYPE  DESCRIPTION
         REFCLKP         91             I  Reference Clock Input Pairs: Connect to external 100MHz
         REFCLKN         93                differential clock.
                                           The input clock signals must be delivered to the clock buffer cell
                                           through an AC-coupled interface so that only the AC information of
                                           the clock is received, converted, and buffered. It is recommended that a
                                           0.1uF be used in the AC-coupling.
         PERP [2:0]      104, 87, 70    I  PCI Express Data Serial Input Pairs: Differential data receive
                                           signals in three ports.
                                           Port 0 (Upstream Port) is PERP[0] and PERN[0]
         PERN [2:0]      103, 88, 69    I  Port 1 (Downstream Port) is PERP[1] and PERN[1]
                                           Port 2 (Downstream Port) is PERP[2] and PERN[2]
         PETP [2:0]      107, 84, 73   O   PCI Express Data Serial Output Pairs: Differential data transmit
                                           signals in three ports.
         PETN [2:0]      108, 83, 74   O   Port 0 (Upstream Port) is PETP[0] and PETN[0]
                                           Port 1 (Downstream Port) is PETP[1] and PETN[1]
                                           Port 2 (Downstream Port) is PETP[2] and PETN[2]
         WAKEUP_L        6              I  Wakeup Signal (Active LOW): When WAKEUP_L is asserted, the
                                           upstream port has to generate a Beacon that is propagated to the Root
                                           Complex/Power Management Controller. Pin has an internal pull-up.
         PERST_L         43             I  System Reset (Active LOW): When PERST_L is asserted, the
                                           internal states of whole chip except sticky logics are initialized.
         DWNRST_L [2:1]  97, 96        O   Downstream Device Reset (Active LOW): It provides a reset signal
                                           to the devices connected to the downstream ports of Switch. The signal
                                           is active when either PERST_L is asserted or the device is just plugged
                                           into the Switch. DWNRST_L [x] corresponds to Portx, where x= 1,2.
3.2     PORT CONFIGURATION SIGNALS
         NAME                 PIN    TYPE  DESCRIPTION
         PRSNT [2:1]     7, 128        I   Present: When asserted low, it represents the device is present in the
                                           slot of downstream ports. Otherwise, it represents the absence of the
                                           device. PRSNT [x] is correspondent to Port x, where x=1,2. The pins
                                           have internal pull-down.
         SLOTCLK         127           I   Slot Clock Configuration: It determines if the downstream component
                                           uses the same physical reference clock that the platform provides on
                                           the connector. When SLOTCLK is high, the platform reference clock is
                                           employed. By default, all downstream ports use the same physical
                                           reference clock provided by platform. The pin has internal pull-down.
3.3     MISCELLANEOUS SIGNALS
         NAME                 PIN    TYPE  DESCRIPTION
         EECLK           40            O   EEPROM Clock: Clock signal to the EEPROM interface.
         EEPD            41           I/O  EEPROM Data: Bi-directional serial data interface to and from the
                                           EEPROM. The pin has internal pull-up.
         SMBCLK          13             I  SMBus Clock: System management Bus Clock. The pin has internal
                                           pull-up.
         SMBDATA         16           I/O  SMBus Data: Bi-directional System Management Bus Data. The pin
                                           has internal pull-up.
                                          Page 12 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                           PI7C9X20303SL
                                                                               3Port-3Lane PCI Express® Switch
                                                                                                        SlimLineTM Family
                                                                                                                    Datasheet
         NAME                 PIN        TYPE  DESCRIPTION
         SCAN_EN         56               I/O  Full-Scan Enable Control: For normal operation, SCAN_EN is an
                                               output with a value of “0”. SCAN_EN becomes an input during
                                               manufacturing testing.
         PORTERR [2:0]   51, 47, 45        O   Port PHY Error Status: These pins are used to display the PHY Error
                                               status of the ports. When PORTERR is flashing (alternating high and
                                               low signals), it indicates that a PHY error is detected. When it is low,
                                               no PHY error is detected. PORTERR [x] is correspondent to Port x,
                                               where x=0,1,2.
         GPIO [7:0]      28, 27, 26, 25,  I/O  General Purpose Input and Output: These eight general-purpose
                         24, 23, 22, 21        pins are programmed as either input-only or bi-directional pins by
                                               writing the GPIO output enable control register.
                                               When SMBus is implemented, GPIO[7:5] act as the SMBus address
                                               pins, which set Bit 2 to 0 of the SMBus address.
         PWR_SAV         17                 I  Power Saving Mode: PWR_SAV is a strapping pin. When this pin is
                                               pulled high when system is reset, the Power Saving Mode is enabled.
                                               When this pin is pulled low when system is reset, the Power Saving
                                               Mode is disabled. When this pin is pulled low, it should be tied to
                                               ground through a pull-down resistor. When this pin is pulled high, a
                                               pull-up resistor should be used. The suggested value for the pull-up and
                                               pull-down resistor is 5.1K. Pin has an internal pull-down.
         P0_CTCDIS       18                 I  P0/P1/P2 CTC Disable: These pins should be tied to ground through a
         P1_CTCDIS       32                    pull-down resistor. The suggested value for the pull-down resistor is
         P2_CTCDIS       33                    5.1K. The pins have internal pull-down.
         TEST1/3/4/5/6/7 31, 12, 11, 10,       Test1/3/4/5/6/7: These pins are for internal test purpose.
                         126, 38               Test1/3/4/5/6/7 should be tied to ground through a pull-down resistor.
                                               The suggested value for the pull-down resistor is 5.1K.
         TEST2           66                 I  Test2: This pin is for internal test purpose. Test2 should be tied to
                                               3.3V through a pull-up resistor. The suggested value for the pull-up
                                               resistor is 5.1K.
         NC              9, 54, 98, 116,       Not Connected: These pins can be left floating.
                         117, 120, 121
3.4     JTAG BOUNDARY SCAN SIGNALS
         NAME                 PIN        TYPE  DESCRIPTION
          TCK            59                I   Test Clock: Used to clock state information and data into and out of
                                               the chip during boundary scan. When JTAG boundary scan function is
                                               not implemented, this pin should be left open (NC).
         TMS             63                I   Test Mode Select: Used to control the state of the Test Access Port
                                               controller. The pin has internal pull-up. When JTAG boundary scan
                                               function is not implemented, this pin should be pulled low through a
                                               5.1K pull-down resistor.
         TDO             58                O   Test Data Output: When SCAN_EN is high, it is used (in conjunction
                                               with TCK) to shift data out of the Test Access Port (TAP) in a serial bit
                                               stream. When JTAG boundary scan function is not implemented, this
                                               pin should be left open (NC).
         TDI             64                I   Test Data Input: When SCAN_EN is high, it is used (in conjunction
                                               with TCK) to shift data and instructions into the TAP in a serial bit
                                               stream. The pin has internal pull-up. When JTAG boundary scan
                                               function is not implemented, this pin should be left open (NC).
         TRST_L          65                I   Test Reset (Active LOW): Active LOW signal to reset the TAP
                                               controller into an initialized state. The pin has internal pull-up. When
                                               JTAG boundary scan function is not implemented, this pin should be
                                               pulled low through a 5.1K pull-down resistor.
                                              Page 13 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                       PI7C9X20303SL
                                                                             3Port-3Lane PCI Express® Switch
                                                                                                   SlimLineTM Family
                                                                                                                Datasheet
3.5     POWER PINS
         NAME                  PIN       TYPE  DESCRIPTION
         VDDC            1, 15, 29, 37,    P   VDDC Supply (1.0V): Used as digital core power pins.
                         42, 46, 49, 52,
                         61, 72, 85,
                         101, 106, 118,
                         123
         VDDR            8, 20, 35, 39,    P   VDDR Supply (3.3V): Used as digital I/O power pins.
                         48, 55, 99,
                         124
         VDDA            78, 79, 80, 92,   P   VDDA Supply (1.0V): Used as analog power pins.
                         112, 113
         VDDAUX          4, 76, 110        P   VDDAUX Supply (1.0V): Used as auxiliary core power pins.
         VAUX            5                 P   VAUX Supply (3.3V): Used as auxiliary I/O power pins.
         VTT             75, 82, 109,      P   Transmit Termination Voltage (1.5V): Provides driver termination
                         115                   voltage at transmitter. Should be given the same consideration as
                                               VDDAUX.
         VSS             2, 3, 14, 19,     P   VSS Ground: Used as ground pins.
                         30, 34, 36, 44,
                         50, 53, 57, 60,
                         62, 67, 68, 71,
                         77, 81, 86, 89,
                         90, 94, 95,
                         100, 102, 105,
                         111, 114, 119,
                         122, 125
                                              Page 14 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                            PI7C9X20303SL
                                                          3Port-3Lane PCI Express® Switch
                                                                          SlimLineTM Family
                                                                                  Datasheet
4 PIN ASSIGNMENTS
4.1     PIN LIST of 128-PIN LQFP
          PIN       NAME      PIN  NAME             PIN  NAME          PIN      NAME
         1         VDDC      33   P2_CTCDIS        65   TRST_L        97       DWNRST_L[2]
         2         VSS       34   VSS              66   TEST2         98       NC
         3         VSS       35   VDDR             67   VSS           99       VDDR
         4         VDDAUX    36   VSS              68   VSS           100      VSS
         5         VAUX      37   VDDC             69   PERN[0]       101      VDDC
         6         WAKEUP_L  38   TEST7            70   PERP[0]       102      VSS
         7         PRSNT[2]  39   VDDR             71   VSS           103      PERN[2]
         8         VDDR      40   EECLK            72   VDDC          104      PERP[2]
         9         NC        41   EEPD             73   PETP[0]       105      VSS
         10        TEST5     42   VDDC             74   PETN[0]       106      VDDC
         11        TEST4     43   PERST_L          75   VTT           107      PETP[2]
         12        TEST3     44   VSS              76   VDDAUX        108      PETN[2]
         13        SMBCLK    45   PORTERR[0]       77   VSS           109      VTT
         14        VSS       46   VDDC             78   VDDA          110      VDDAUX
         15        VDDC      47   PORTERR[1]       79   VDDA          111      VSS
         16        SMBDATA   48   VDDR             80   VDDA          112      VDDA
         17        PWR_SAV   49   VDDC             81   VSS           113      VDDA
         18        P0_CTCDIS 50   VSS              82   VTT           114      VSS
         19        VSS       51   PORTERR[2]       83   PETN[1]       115      VTT
         20        VDDR      52   VDDC             84   PETP[1]       116      NC
         21        GPIO[0]   53   VSS              85   VDDC          117      NC
         22        GPIO[1]   54   NC               86   VSS           118      VDDC
         23        GPIO[2]   55   VDDR             87   PERP[1]       119      VSS
         24        GPIO[3]   56   SCAN_EN          88   PERN[1]       120      NC
         25        GPIO[4]   57   VSS              89   VSS           121      NC
         26        GPIO[5]   58   TDO              90   VSS           122      VSS
         27        GPIO[6]   59   TCK              91   REFCLKP       123      VDDC
         28        GPIO[7]   60   VSS              92   VDDA          124      VDDR
         29        VDDC      61   VDDC             93   REFCLKN       125      VSS
         30        VSS       62   VSS              94   VSS           126      TEST6
         31        TEST1     63   TMS              95   VSS           127      SLOTCLK
         32        P1_CTCDIS 64   TDI              96   DWNRST_L[1]   128      PRSNT[1]
                                       Page 15 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                       PI7C9X20303SL
                                                                                3Port-3Lane PCI Express® Switch
                                                                                                   SlimLineTM Family
                                                                                                             Datasheet
5 FUNCTIONAL DESCRIPTION
Multiple virtual PCI-to-PCI Bridges (VPPB), connected by a virtual PCI bus, reside in the Switch. Each VPPB
contains the complete PCIe architecture layers that consist of the physical, data link, and transaction layer. The
packets entering the Switch via one of VPPBs are first converted from serial bit-stream into parallel bus signals in
physical layer, stripped off the link-related header by data link layer, and then relayed up to the transaction layer to
extract out the transaction header. According to the address or ID embedded in the transaction header, the entire
transaction packets are forwarded to the destination VPPB for formatting as a serial-type PCIe packet through the
transmit circuits in the data link layer and physical layer. The following sections describe these function elements
for processing PCIe packets within the Switch.
5.1      PHYSICAL LAYER CIRCUIT
The physical layer circuit design is based on the PHY Interface for PCI Express Architecture (PIPE). It contains
Physical Media Attachment (PMA) and Physical Coding Sub-layer (PCS) blocks. PMA includes Serializer/
Deserializer (SERDES), PLL1, Clock Recovery module, receiver detection circuits, beacon transmitter, electrical
idle detector, and input/output buffers. PCS consists of framer, 8B/10B encoder/decoder, receiver elastic buffer, and
PIPE PHY control/status circuitries. To provide the flexibility for port configuration, each lane has its own control
and status signals for MAC to access individually. In addition, a pair of PRBS generator and checker is included for
PHY built-in self test. The main functions of physical layer circuits include the conversion between serial-link and
parallel bus, provision of clock source for the Switch, resolving clock difference in receiver end, and detection of
physical layer errors.
In order to meet the different application needs, the driving current and equalization of each transmitting channels
can be adjusted using EEPROM individually. The driver current of each channel is set to 20mA in default mode. To
change the current value, the user can program the EEPROM for nominal value (HIDRV, LODRV) or actual value
(DTX [3:0]), which is a scaled multiple of Inom. The following tables illustrate the possible transmitted current
values the chip provides.
        Table 5-1 Nominal Driver Current Values (Inom)
               HIDRV                  LODRV             NOMINAL DRIVER CURENT
                   0                      0                           20 mA
                   0                      1                           10 mA
                   1                      0                           28 mA
                   1                      1                          Reserved
        Table 5-2 Ratio of Actual Current and Nominal Current
             DTX [3:0]               ACTUAL CURRENT / NOMINAL CURRENT
                 0000                                        1.00
                 0001                                        1.05
                 0010                                        1.10
                 0011                                        1.15
                 0100                                        1.20
                 0101                                        1.25
                 0110                                        1.30
1
  Multiple lanes could share the PLL.
                                                      Page 16 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                       PI7C9X20303SL
                                                                                3Port-3Lane PCI Express® Switch
                                                                                                    SlimLineTM Family
                                                                                                              Datasheet
               DTX [3:0]              ACTUAL CURRENT / NOMINAL CURRENT
                 0111                                       1.35
                 1000                                       0.60
                 1001                                       0.65
                 1010                                       0.70
                 1011                                       0.75
                 1100                                       0.80
                 1101                                       0.85
                 1110                                       0.90
                 1111                                       0.95
The equalization function of transmitting channels can optimize the driver current for different back-plane lengths
and materials. The table shown below lists the combinations of de-emphasized driver current (ITX –IEQ) to non-de-
emphasized driver current (ITX) for different values of DEQ [3:0].
         Table 5-3 De-emphasis Level versus DEQ [3:0]
               DEQ [3:0]            (ITX –IEQ) / ITX            De-emphasis (dB)
                 0000                     1.00                        0.00
                 0001                     0.96                        -0.35
                 0010                     0.92                        -0.72
                 0011                     0.88                        -1.11
                 0100                     0.84                        -1.51
                 0101                     0.80                        -1.94
                 0110                     0.76                        -2.38
                 0111                     0.72                        -2.85
                 1000                     0.68                        -3.35
                 1001                     0.64                        -3.88
                 1010                     0.60                        -4.44
                 1011                     0.56                        -5.04
                 1100                     0.52                        -5.68
                 1101                     0.48                        -6.38
                 1110                     0.44                        -7.13
                 1111                     0.40                        -7.96
By default, the DEQ is set to “1000” to conform to the PCI Express specification, which calls for a de-emphasis
level of between –3 dB and –4 dB.
In order to improve the data stream integrity across the channels, the receiver of each port of the Switch includes a
reception equalizer to mitigate the effects of ISI. The reception equalizer is implemented as a selectable high-pass
filter at the input node, and it is capable of removing as much as 0.4UI of ISI related jitter. The following table
shows a simple guideline for selecting the appropriate value to adapt with different lengths or connector numbers in
various applications.
         Table 5-4 Rx Equalizer Settings (RXEQCTL)
           RXEQCTL [1]          RXEQCTL [0]          Rx Eq Setting      Input Jitter              Channel Length
                   0                     0            Max Rx Eq      > 0.25 UI            > 20" and two or more
                                                                                          connectors
                   0                     1            Min Rx Eq      Between 0.1 UI       Between 8'' and 20" and up to
                                                                     and 0.25 UI          two connectors
                   1                    X                            < 0.1 UI             8" or less, up to one connector
                                                       Page 17 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                     PI7C9X20303SL
                                                                                3Port-3Lane PCI Express® Switch
                                                                                                   SlimLineTM Family
                                                                                                              Datasheet
5.2      DATA LINK LAYER (DLL)
The Data Link Layer (DLL) provides a reliable data transmission between two PCI Express points. An ACK/NACK
protocol is employed to guarantee the integrity of the packets delivered. Each Transaction Layer Packet (TLP) is
protected by a 32-bit LCRC for error detection. The DLL receiver performs LCRC calculation to determine if the
incoming packet is corrupted in the serial link. If an LCRC error is found, the DLL transmitter would issue a NACK
data link layer packet (DLLP) to the opposite end to request a re-transmission, otherwise an ACK DLLP would be
sent out to acknowledge on reception of a good TLP.
In the transmitter, a retry buffer is implemented to store the transmitted TLPs whose corresponding ACK/NACK
DLLP have not been received yet. When an ACK is received, the TLPs with sequence number equals to and smaller
than that carried in the ACK would be flushed out from the buffer. If a NACK is received or no ACK/NACK is
returned from the link partner after the replay timer expires, then a replay mechanism built in DLL transmitter is
triggered to re-transmit the corresponding packet that receives NACK or time-out and any other TLP transmitted
after that packet.
Meanwhile, the DLL is also responsible for the initialization, updating, and monitoring of the flow-control credit.
All of the flow control information is carried by DLLP to the other end of the link. Unlike TLP, DLLP is guarded
by 16-bit CRC to detect if data corruption occurs.
In addition, the Media Access Control (MAC) block, which is consisted of LTSSM, multiple lanes deskew,
scrambler/de-scrambler, clock correction from inserting skip order-set, and PIPE-related control/status circuits, is
implemented to interface physical layer with data link layer.
5.3      TRANSACTION LAYER RECEIVE BLOCK (TLP DECAPSULATION)
The receiving end of the transaction layer performs header information retrieval and TC/VC mapping (see section
5.5), and it validates the correctness of the transaction type and format. If the TLP is found to contain illegal header
or the indicated packet length mismatches with the actual packet length, then a Malformed TLP is reported as an
error associated with the receiving port. To ensure end-to-end data integrity, a 32-bit ECRC is checked against the
TLP at the receiver if the digest bit is set in header.
5.4      ROUTING
The transaction layer implements three types of routing protocols: ID-based, address-based, and implicit routing.
For configuration reads, configuration writes, transaction completion, and user-defined messages, the packets are
routed by their destination ID constituted of bus number, device number, and function number. Address routing is
employed to forward I/O or memory transactions to the destination port, which is located within the address range
indicated by the address field carried in the packet header. The packet header indicates the packet types including
memory read, memory write, IO read, IO write, Message Signaling Interrupt (MSI) and user-defined message.
Implicit routing is mainly used to forward system message transactions such as virtual interrupt line, power
management, and so on. The message type embedded in the packet header determines the routing mechanism.
If the incoming packet can not be forwarded to any other port due to a miss to hit the defined address range or
targeted ID, this is considered as Unsupported Request (UR) packet, which is similar to a master abort event in PCI
protocol.
                                                        Page 18 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                    PI7C9X20303SL
                                                                                3Port-3Lane PCI Express® Switch
                                                                                                  SlimLineTM Family
                                                                                                            Datasheet
5.5     TC/VC MAPPING
The 3-bit TC field defined in the header identifies the traffic class of the incoming packets. To enable the
differential service, a TC/VC mapping table at destination port that is pre-programmed by system software or
EEPROM pre-load is utilized to cast the TC labeled packets into the desired virtual channel. Note that all the traffic
classes are mapped to VC0, since only VC0 is available on the Switch. After the TC/VC mapping, the receive block
dispatches the incoming request, completion, or data into the VC0 queues.
5.6      QUEUE
In PCI Express, it defines six different packet types to represent request, completion, and data. They are respectively
Posted Request Header (PH), Posted Request Data payload (PD), Non-Posted Request Header (NPH), Non-Posted
Data Payload (NPD), Completion Header (CPLH) and Completion Data payload (CPLD). Each packet with
different type would be put into a separate queue in order to facilitate the following ordering processor. Since NPD
usually contains one DW, it can be merged with the corresponding NPH into a common queue named NPHD.
5.6.1      PH
PH queue provides TLP header spaces for posted memory writes and various message request headers. Each header
space occupies sixteen bytes to accommodate 3 DW or 4 DW headers.
5.6.2      PD
PD queue is used for storing posted request data. If the received TLP is of the posted request type and is determined
to have payload coming with the header, the payload data would be put into PD queue.
5.6.3 NPHD
NPHD queue provides TLP header spaces for non-posted request packets, which include memory read, IO read, IO
write, configuration read, and configuration write. Each header space takes twenty bytes to accommodate a 3-DW
header, s 4-DW header, s 3-WD header with 1-DW data, and a 4-DW header with 1-DW data.
5.6.4 CPLH
CPLH queue provides TLP header space for completion packets. Each header space takes twelve bytes to
accommodate a 3-DW header. Please note that there is no 4-DW completion headers.
5.6.5 CPLD
CPLD queue is used for storing completion data. If the received TLP is of the completion type and is determined to
have payload coming with the header, the payload data would be put into CPLD queue.
                                                     Page 19 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                       PI7C9X20303SL
                                                                                3Port-3Lane PCI Express® Switch
                                                                                                    SlimLineTM Family
                                                                                                              Datasheet
5.7       TRANSACTION ORDERING
Within a VPPB, a set of ordering rules is defined to regulate the transactions on the PCI Express Switch including
Memory, IO, Configuration and Messages, in order to avoid deadlocks and to support the Producer-Consumer
model. The ordering rules defined in table 5-4 apply within a single Traffic Class (TC). There is no ordering
requirement among transactions within different TC labels.
      Table 5-4 Summary of PCI Express Ordering Rules
        Row Pass Column           Posted       Read          Non-posted Write  Read           Non-posted Write
                                  Request     Request        Request           Completion     Completion
        Posted Request            Yes/No1     Yes5           Yes5              Yes5           Yes5
        Read Request              No2         Yes            Yes               Yes            Yes
        Non-posted Write Request  No2         Yes            Yes               Yes            Yes
        Read Completion           Yes/No3     Yes            Yes               Yes            Yes
        Non-Posted Write          Yes4        Yes            Yes               Yes            Yes
        Completion
1. When the Relaxed Ordering Attribute bit is cleared, the Posted Request transactions including memory write and
message request must complete on the egress bus of VPPB in the order in which they are received on the ingress
bus of VPPB. If the Relaxed Ordering Attribute bit is set, the Posted Request is permitted to pass over other Posted
Requests occurring before it.
2. A Read Request transmitting in the same direction as a previously queued Posted Request transaction must push
the posted write data ahead of it. The Posted Request transaction must complete on the egress bus before the Read
Request can be attempted on the egress bus. The Read transaction can go to the same location as the Posted data.
Therefore, if the Read transaction were to pass the Posted transaction, it would return stale data.
3. When the Relaxed Ordering Attribute bit is cleared, a Read completion must ‘‘pull’’ ahead of previously queued
posted data transmitting in the same direction. In this case, the read data transmits in the same direction as the
posted data, and the requestor of the read transaction is on the same side of the VPPB as the completer of the posted
transaction. The posted transaction must deliver to the completer before the read data is returned to the requestor. If
the Relaxed Ordering Attribute bit is set, then a read completion is permitted to pass a previously queued Memory
Write or Message Request.
4. Non-Posted Write Completions are permitted to pass a previous Memory Write or Message Request transaction.
Such transactions are actually transmitting in the opposite directions and hence have no ordering relationship.
5. Posted Request transactions must be given opportunities to pass Non-posted Read and Write Requests as well as
Completions. Otherwise, deadlocks may occur when some older Bridges that do not support delayed transactions
are mixed with PCIe Switch in the same system. A fairness algorithm is used to arbitrate between the Posted Write
queue and the Non-posted transaction queue.
5.8      PORT ARBITRATION
Among multiple ingress ports, the port arbitration built in the egress port determines which input traffic to be
forwarded to the output port. The arbitration algorithm contains hardware fixed Round Robin, 128-phase Weighted
Round-Robin and programmable 128-phase time-based WRR. The port arbitration is held within the same VC
channel. Each port has port arbitration circuitries for traffic handling in VC0. At upstream port, in addition to the
traffic from inter-port, the intra-port packet such as configurations completion would also join the arbitration loop to
get the service in Virtual Channel 0.
                                                      Page 20 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                      PI7C9X20303SL
                                                                                  3Port-3Lane PCI Express® Switch
                                                                                                    SlimLineTM Family
                                                                                                             Datasheet
5.9     FLOW CONTROL
PCI Express employs Credit-Based Flow Control mechanism to make buffer utilization more efficient. The
transaction layer transmitter ensures that it does not transmit a TLP to an opposite receiver unless the receiver has
enough buffer space to accept the TLP. The transaction layer receiver has the responsibility to advertise the free
buffer space to an opposite transmitter to avoid packet stale. In this switch, each port has separate queues for
different traffic types and the credits are on the fly sent to data link layer, which compares the current available
credits with the monitored one and reports the updated credit to the counterpart. If no new credit is acquired, the
credit reported is scheduled for every 30 us to prevent from link entering retrain. On the other hand, the receiver at
each egress port gets the usable credits from the opposite end in a link. It would broadcast them to all the other
ingress ports for gating the packet transmission.
5.10 TRANSATION LAYER TRANSMIT BLOCK (TLP ENCAPSULATION)
The transmit portion of transaction layer performs the following functions. They are to construct the all types of
forwarded TLP generated from VC arbiter, respond with the completion packet when the local resource (i.e.
configuration register) is accessed and regenerate the message that terminated at receiver to RC if acts as an
upstream port.
                                                       Page 21 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                             PI7C9X20303SL
                                                                                            3Port-3Lane PCI Express® Switch
                                                                                                           SlimLineTM Family
                                                                                                                  Datasheet
6 EEPROM INTERFACE AND SYSTEM MANAGEMENT BUS
The EEPROM interface consists of two pins: EECLK (EEPROM clock output) and EEPD (EEPROM bi-
directional serial data). The Switch may control an ISSI IS24C04 or compatible parts using into 512x8 bits. The
EEPROM is used to initialize a number of registers before enumeration. This is accomplished after PRST# is de-
asserted, at which time the data from the EEPROM is loaded. The EEPROM interface is organized into a 16-bit
base, and the Switch supplies a 7-bit EEPROM word address. The Switch does not control the EEPROM address
input. It can only access the EEPROM with address input set to 0.
The System Management Bus interface consists of two pins: SMBCLK (System Management Bus Clock input) and
SMBDATA (System Management Bus Data input/ output).
6.1     EEPROM INTERFACE
6.1.1 AUTO MODE EERPOM ACCESS
The Switch may access the EEPROM in a WORD format by utilizing the auto mode through a hardware sequencer.
The EEPROM start-control, address, and read/write commands can be accessed through the configuration register.
Before each access, the software should check the Autoload Status bit before issuing the next start.
6.1.2 EEPROM MODE AT RESET
During a reset, the Switch will automatically load the information/data from the EEPROM if the automatic load
condition is met. The first offset in the EEPROM contains a signature. If the signature is recognized, the autoload
initiates right after the reset.
During the autoload, the Bridge will read sequential words from the EEPROM and write to the appropriate registers.
Before the Bridge registers can be accessed through the host, the autoload condition should be verified by reading
bit [3] offset DCh (EEPROM Autoload Status). The host access is allowed only after the status of this bit is set to '0'
which indicates that the autoload initialization sequence is complete.
6.1.3 EEPROM SPACE ADDRESS MAP
                            15 – 8                                           7–0                         BYTE OFFSET
                                        EEPROM Signature (1516h)                                              00h
                                                   Vendor ID                                                  02h
                                                   Device ID                                                  04h
            Extended VC Count / Link Capability / Switch Mode Operation / Interrupt pin for Port 1 ~ 2        06h
                                            Subsystem Vender ID                                               08h
                                                 Subsystem ID                                                 0Ah
             Max_Payload_Size Support / ASPM Support / Role_Base Error Reporting / RefClk ppm                 0Ch
                                                   Difference
                           Reserved                                      Revision ID                          0Eh
                                         NFTS / Scramble for Port0                                            10h
                                         NFTS / Scramble for Port1                                            12h
                                         NFTS / Scramble for Port2                                            14h
                                                   Reserved                                                   16h
                                                   Reserved                                                   18h
                                                   Reserved                                                   1Ah
                                                   Reserved                                                   1Ch
                                                             Page 22 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                            PI7C9X20303SL
                                                                                           3Port-3Lane PCI Express® Switch
                                                                                                          SlimLineTM Family
                                                                                                                 Datasheet
                          15 – 8                                             7–0                        BYTE OFFSET
                                                 Reserved                                                    1Eh
                TC/VC Map for Port 0 (VC0)              Slot Clock / LPVC Count / Port Num, Port 0           20h
                TC/VC Map for Port 1(VC0)               Slot Implemented / Slot Clock / LPVC Count           22h
                                                                      / Port Num, Port 1
                TC/VC Map for Port 2 (VC0)              Slot Implemented / Slot Clock / LPVC Count           24h
                                                                      / Port Num, Port 2
                                                 Reserved                                                    26h
                                                 Reserved                                                    28h
                                                 Reserved                                                    2Ah
                                                 Reserved                                                    2Ch
                                                 Reserved                                                    2Eh
                                                 Reserved                                                    30h
                                         Slot Capability 0 for Port 1                                        32h
                                         Slot Capability 0 for Port 2                                        34h
                                                 Reserved                                                    36h
                                                 Reserved                                                    38h
                                                 Reserved                                                    3Ah
                                                 Reserved                                                    3Ch
                                                 Reserved                                                    3Eh
                                                 Reserved                                                    40h
                                         Slot Capability 1 for Port 1                                        42h
                                         Slot Capability 1 for Port 2                                        44h
                                                 Reserved                                                    46h
                                                 Reserved                                                    48h
                                                 Reserved                                                    4Ah
                                                 Reserved                                                    4Ch
                                                 Reserved                                                    4Eh
                      PM Data for Port 0                            PM Capability for Port 0                 50h
                      PM Data for Port 1                            PM Capability for Port 1                 52h
                      PM Data for Port 2                            PM Capability for Port 2                 54h
                                                 Reserved                                                    56h
                                                 Reserved                                                    58h
                                                 Reserved                                                    5Ah
                                                 Reserved                                                    5Ch
                                                 Reserved                                                    5Eh
                               Power Budgeting Capability Register for Port 0                                60h
                               Power Budgeting Capability Register for Port 1                                62h
                               Power Budgeting Capability Register for Port 2                                64h
                                                 Reserved                                                    66h
                                                 Reserved                                                    68h
                                                 Reserved                                                    6Ah
                                                 Reserved                                                    6Ch
                                                 Reserved                                                    6Eh
                                     Replay Time-out Counter for Port 0                                      70h
                                     Replay Time-out Counter for Port 1                                      72h
                                     Replay Time-out Counter for Port 2                                      74h
                                                 Reserved                                                    76h
                                                 Reserved                                                    78h
                                                 Reserved                                                    7Ah
                                                 Reserved                                                    7Ch
                                                 Reserved                                                    7Eh
                                   Acknowledge Latency Timer for Port 0                                      80h
                                   Acknowledge Latency Timer for Port 1                                      82h
                                   Acknowledge Latency Timer for Port 2                                      84h
                                                 Reserved                                                    86h
                                                 Reserved                                                    88h
                                                 Reserved                                                    8Ah
                                                 Reserved                                                    8Ch
                                                 Reserved                                                    8Eh
                                         PHY Parameter for Port 0                                            90h
                                         PHY Parameter for Port 1                                            92h
                                         PHY Parameter for Port 2                                            94h
                                                            Page 23 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                                 PI7C9X20303SL
                                                                                     3Port-3Lane PCI Express® Switch
                                                                                                             SlimLineTM Family
                                                                                                                         Datasheet
                        15 – 8                                        7–0                                  BYTE OFFSET
                                             Reserved                                                             96h
                                             Reserved                                                             98h
                                             Reserved                                                             9Ah
                                             Reserved                                                             9Ch
                                             Reserved                                                             9Eh
                      Reserved                        PM Control Para/Rx Polarity for Port 0                      A0h
                      Reserved                        PM Control Para/Rx Polarity for Port 1                      A2h
                      Reserved                        PM Control Para/Rx Polarity for Port 2                      A4h
                                             Reserved                                                             A6h
6.1.4 MAPPING EEPROM CONTENTS TO CONFIGURATION REGISTERS
             ADDRESS        PCI CFG OFFSET           DESCRIPTION
                00h                                  EEPROM signature – 1516h
                02h         00h ~ 01h                Vendor ID
                04h         02h ~ 03h                Device ID
                06h         144h (Port 0~2)          Extended VC Count for Port 0 ~ 2
                            144h: Bit [0]                     Bit [0]: It represents the supported VC count other than the
                                                               default VC
                            ECh (Port 0~2)           Link Capability for Port 0 ~ 2
                            ECh: Bit [14:12]                  Bit [3:1]: It represents L0s Exit Latency for all ports
                            ECh: Bit [17:15]                  Bit [6:4]: It represents L1 Exit Latency for all ports
                            B4h (Port 0~2)           Switch Mode Operation for Port 0
                            B4h:Bit [5]                       Bit [8]: no ordering on packets for different egress port mode
                               Bit [6]                        Bit [9]: no ordering on different tag of completion mode
                               Bit [0]                        Bit [10]: Store and Forward
                               Bit [2:1]                      Bit [12:11]: Cut-through Threshold
                               Bit [3]                        Bit [13] : Port arbitrator Mode
                               Bit [4]                        Bit [14]: Credit Update Mode
                            3Ch (Port 1~2)           Interrupt pin for Port 1 ~ 2
                            3Ch: Bit [8]]                     Bit [15]: Set when INTA is requested for interrupt resource
                08h         C4h: Bit [15:0]          Subsystem Vender ID
                0Ah         C4h: Bit [31:16]         Subsystem ID
                0Ch         E4h(Port 0~2)            Max_Payload_Size Support for Port 0 ~ 2
                            E4h: Bit 0                        Bit [0]: Indicated the maximum payload size that the device can
                                                               support for the TLP
                            ECh(Port 0~2)            ASPM Support for Port 0 ~ 2
                            ECh: Bit[11:10]                   Bit [2:1] : Indicate the level of ASPM supported on the PCIe link
                            E4h(Port 0~2)            Role_Base Error Reporting for Port 0 ~ 2
                            E4h: Bit[15]                      Bit [3] : Indicate implement the role-base error reporting
                            B0h(port 0~2)            MSI Capability Disable for Port 0~2
                            B0h : Bit [14]                    Bit [4] : Disable MSI capability
                            B0h(port 0~2)            AER Capability Disable for Port 0~2
                            B0h : Bit [15]                    Bit [5] : Disable AER capability
                            B4h(port 0~2)            Compliance Pattern Parity Control Disable for Port 0~2
                            B4h : Bit [15]                    Bit [6] : Disable compliance pattern parity
                            B0h(port 0~2)            Power Management Capability Disable for Port 0~2
                            B0h : Bit [13]                    Bit [7] : Disable Power Management Capability
                            B4h(Port 0~2)            Ordering Frozen for Port 0~2
                            B4h: Bit [7]                      Bit [10]: Freeze the ordering feature
                            BCh(Port 0~2)            TX SOF Latency Mode for Port 0~2
                                                      Page 24 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                        PI7C9X20303SL
                                                                             3Port-3Lane PCI Express® Switch
                                                                                                     SlimLineTM Family
                                                                                                                Datasheet
             ADDRESS     PCI CFG OFFSET   DESCRIPTION
                         BCh: Bit[0]                  Bit [11]: Set to zero to shorten latency
                         ECh(port0~2)     Surprise Down Capability Enable for for Port 0~2
                         ECh : Bit [19]               Bit [12]: Enable Surprise Down Capability
                         BCh(Port 0~2)    Power Management’s Data Select Register R/W Capability for Port 0~2
                         BCh: Bit[1]                  Bit [13]: Enable Data Select Register R/W
                         BCh(Port 0~2)    Flow Control Update Type for Port 0~2
                         BCh: Bit[2]                  Bit [14]: Select Flow Control Update Type
                         BCh(Port 0~2)    4KB Boundary Check Enable
                         BCh: Bit[3]      Bit [15]: Enable 4KB Boundary Check
                0Eh      08h: Bit[7:0]    Revision ID
                                                      Bit [7:0]: Indicates the Revision ID of chip.
                10h      B8h (port 0)     FTS Number for Port 0
                         B8h : Bit[7:0]               Bit [7:0]: FTS number at receiver side
                         A8h(Port 0)      RefClk ppm Difference for Port 0
                         A8h: Bit [14:13]             Bit [9:8]: It represents RefClk ppm difference between the two
                                                       ends in one link; 00: 0 ppm, 01: 100 ppm, 10: 200 ppm, 11: 300
                                                       ppm
                         B8h (port0)      Scrambler Control for Port 0
                         B8h : Bit[11:10]             Bit [11:10]: scrambler control
                         B8h : Bit[12]                Bit [12]: L0s
                12h      B8h (port 1)     FTS Number for Port 1
                         B8h : Bit[7:0]               Bit [7:0]: FTS number at receiver side
                         A8h(Port 1)      RefClk ppm Difference for Port 1
                         A8h: Bit [14:13]             Bit [9:8]: It represents RefClk ppm difference between the two
                                                       ends in one link; 00: 0 ppm, 01: 100 ppm, 10: 200 ppm, 11: 300
                                                       ppm
                         B8h (port1)      Scrambler Control for Port 1
                         B8h : Bit[11:10]             Bit [11:10]: scrambler control
                         B8h : Bit[12]                Bit [12]: L0s
                14h      B8h (port 2)     FTS Number for Port 2
                         B8h : Bit[7:0]               Bit [7:0]: FTS number at receiver side
                         A8h(Port 2)      RefClk ppm Difference for Port 2
                         A8h: Bit [14:13]             Bit [9:8]: It represents RefClk ppm difference between the two
                                                       ends in one link; 00: 0 ppm, 01: 100 ppm, 10: 200 ppm, 11: 300
                                                       ppm
                         B8h (port2)      Scrambler Control for Port 2
                         B8h : Bit[11:10]             Bit [11:10]: scrambler control
                         B8h : Bit[12]                Bit [12]: L0s
                20h      F0h (Port 0)     Slot Clock Configuration for Port 0
                         F0h: Bit [28]                Bit [1]: When set, the component uses the clock provided on the
                                                       connector
                         80h (Port 0)     Device specific Initialization for Port 0
                         80h: Bit[21]                 Bit [2]: When set, the DSI is required
                         ECh (Port 0)     Port Number for Port 0
                         ECh: Bit [25:24]             Bit [5:4]: It represents the logic port numbering for physical port
                                                       0
                         84h (Port 0)     PMCSR Data Scale for Port 0
                         84h: Bit [14:13] Bit [7:6]: It represents the PMCSR Data Scale for physical port 0
                         154h (Port 0)    VC0 TC/VC Map for Port 0
                         154h: Bit [7:1]              Bit [15:9]: When set, it indicates the corresponding TC is
                                                       mapped into VC0
                                          Page 25 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                        PI7C9X20303SL
                                                                             3Port-3Lane PCI Express® Switch
                                                                                                     SlimLineTM Family
                                                                                                                Datasheet
             ADDRESS     PCI CFG OFFSET   DESCRIPTION
                22h      E0h (Port1)      PCIe Capability Slot Implemented for Port 1
                         E0h: Bit [24]                Bit [0]: When set, the slot is implemented for Port 1
                         F0h (Port 1)     Slot Clock Configuration for Port 1
                         F0h: Bit [28]                Bit [1]: When set, the component uses the clock provided on the
                                                          Connector
                         80h (Port 1)     Device specific Initialization for Port 1
                         80h: Bit[21]                 Bit [2]: When set, the DSI is required
                         ECh (Port 1)     Port Number for Port 1
                         ECh: Bit [25:24]             Bit [5:4]: It represents the logic port numbering for physical port
                                                       1
                         84h (Port 1)     PMCSR Data Scale for Port 1
                         84h: Bit [14:13] Bit [7:6]: It represents the PMCSR Data Scale for physical port 1
                         154h (Port 1)    VC0 TC/VC Map for Port 1
                         154h: Bit [7:1]              Bit [15:9]: When set, it indicates the corresponding TC is
                                                       mapped into VC0
                24h      E0h (Port 2)     PCIe Capability Slot Implemented for Port 2
                         E0h: Bit [24]                Bit [0]: When set, the slot is implemented for Port 2
                         F0h (Port 2)     Slot Clock Configuration for Port 2
                         F0h: Bit [28]                Bit [1]: When set, the component uses the clock provided on the
                                                       Connector
                         80h (Port 2)     Device specific Initialization for Port 2
                         80h: Bit[21]                 Bit [2]: When set, the DSI is required
                         ECh (Port 2)     t Number for Port 2
                         ECh: Bit [25:24]             Bit [5:4]: It represents the logic port numbering for physical port
                                                       2
                         84h (Port 2)
                         84h: Bit [14:13]
                         154h (Port 2)    VC0 TC/VC Map for Port 2
                         154h: Bit [7:1]              Bit [15:9]: When set, it indicates the corresponding TC is
                                                       mapped into VC0
                32h      F4h (Port 1)     Slot Capability 0 of Port 1
                         F4h: Bit [15:0]              Bit [15:0]: Mapping to the low word of slot capability register
                34h      F4h (Port 2)     Slot Capability 0 of Port 2
                         F4h: Bit [15:0]              Bit [15:0]: Mapping to the low word of slot capability register
                42h      F4h (Port 1)     Slot Capability 1 of Port 1
                         F4h: Bit [31:16]             Bit [15:0]: Mapping to the high word of slot capability register
                44h      F4h (Port 2)     Slot Capability 1 of Port 2
                         F4h: Bit [31:16]             Bit [15:0]: Mapping to the high word of slot capability register
                50h      84h (Port 0)     No_Soft_Reset for Port 0
                         84h: Bit [3]                 Bit [0]: No_Soft_Reset.
                         80h (Port 0)     Power Management Capability for Port 0
                         80h: Bit [24:22]             Bit [3:1]: AUX Current.
                         80h: Bit [25]                Bit [4]: read only as 1 to indicate Bridge supports the D1 power
                                                       management state
                         80h: Bit [26]                Bit [5]: read only as 1 to indicate Bridge supports the D2 power
                                                       management state
                         80h: Bit [29:28]             Bit [7:6]: PME Support for D2 and D1 states
                51h      84h (Port 0)     Power Management Data for Port 0
                         84h: Bit [31:24]             Bit [15:8]: read only as Data register
                                           Page 26 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                    PI7C9X20303SL
                                                                          3Port-3Lane PCI Express® Switch
                                                                                                  SlimLineTM Family
                                                                                                             Datasheet
             ADDRESS     PCI CFG OFFSET    DESCRIPTION
                52h      84h (Port 1)      No_Soft_Reset for Port 1
                         84h: Bit [3]              Bit [0]: No_Soft_Reset.
                         80h (Port 1)      Power Management Capability for Port 1
                         80h: Bit [24:22]          Bit [3:1]: AUX Current.
                         80h: Bit [25]             Bit [4]: read only as 1 to indicate Bridge supports the D1 power
                                                    management state
                         80h: Bit [26]             Bit [5]: read only as 1 to indicate Bridge supports the D2 power
                                                    management state
                         80h: Bit [29:28]          Bit [7:6]: PME Support for D2 and D1 states
                53h      84h (Port 1)      Power Management Data for Port 1
                         84h: Bit [31:24]          Bit [15:8]: read only as Data register
                54h      84h (Port 2)      No_Soft_Reset for Port 2
                         84h: Bit [3]              Bit [0]: No_Soft_Reset
                         80h (Port 2)      Power Management Capability for Port 2
                         80h: Bit [24:22]          Bit [3:1]: AUX Current
                         80h: Bit [25]             Bit [4]: read only as 1 to indicate Bridge supports the D1 power
                                                    management state
                         80h: Bit [26]             Bit [5]: read only as 1 to indicate Bridge supports the D2 power
                                                    management state
                         80h: Bit [29:28]          Bit [7:6]: PME Support for D2 and D1 states
                55h      84h (Port 2)      Power Management Data for Port 2
                         84h: Bit [31:24]          Bit [15:8] – read only as Data register
                60h      214h (Port 0)     Power Budget Register for Port 0
                         214h– Bit [7:0]           Bit [7:0]: Base Power
                         214h– Bit [9:8]           Bit [9:8]: Data Scale
                         214h– Bit [14:13]         Bit [11:10]: PM State
                         218h– Bit [0]             Bit [15]: System Allocated
                62h      214h (Port 1)     Power Budget Register for Port 1
                         214h– Bit [7:0]           Bit [7:0]: Base Power
                         214h– Bit [9:8]           Bit [9:8]: Data Scale
                         214h– Bit [14:13]         Bit [11:10]: PM State
                         218h– Bit [0]             Bit [15]: System Allocated
                64h      214h (Port 2)     Power Budget Register for Port 2
                         214h– Bit [7:0]           Bit [7:0]: Base Power
                         214h– Bit [9:8]           Bit [9:8]: Data Scale
                         214h– Bit [14:13]         Bit [11:10]: PM State
                         218h– Bit [0]             Bit [15]: System Allocated
                70h      B0h (Port 0)      Replay Time-out Counter for Port 0
                         B0h – Bit [15:0]          Bit [15:0]: Relay Time-out Counter
                72h      B0h (Port 1)      Replay Time-out Counter for Port 1
                         B0h – Bit [15:0]          Bit [15:0]: Relay Time-out Counter
                74h      B0h (Port 2)      Replay Time-out Counter for Port 2
                         B0h – Bit [15:0]          Bit [15:0]: Relay Time-out Counter
                80h      B0h (Port 0)      Acknowledge Latency Timer for Port 0
                         B0h – Bit [31:16]         Bit [31:16]: Acknowledge Latency Timer
                82h      B0h (Port 1)      Acknowledge Latency Timer for Port 1
                         B0h – Bit [31:16]         Bit [31:16]: Acknowledge Latency Timer
                84h      B0h (Port 2)      Acknowledge Latency Timer for Port 2
                         B0h – Bit [31:16]         Bit [31:16]: Acknowledge Latency Timer
                90h      B4h (Port 0)      PHY Parameter for Port 0
                         B4h: Bit [31:16]          Bit [31:16]: PHY Parameter
                92h      B4h (Port 1)      PHY Parameter for Port 1
                         B4h: Bit [31:16]          Bit [31:16]: PHY Parameter
                94h      B4h (Port 2)      PHY Parameter for Port 2
                         B4h: Bit [31:16]          Bit [31:16]: PHY Parameter
                                           Page 27 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                              PI7C9X20303SL
                                                                         3Port-3Lane PCI Express® Switch
                                                                                            SlimLineTM Family
                                                                                                   Datasheet
             ADDRESS     PCI CFG OFFSET  DESCRIPTION
                A0h      B0h (Port0)     Decode VGA for Port0
                         B0h: Bit[31]      Bit [7]
                         B4h (Port 0)    PM Control Parameter for Port 0
                         B4h: Bit [13:8]          Bit [5:4] : L0s enable
                                                  Bit [3:2] : L1 delay count select
                                                  Bit [1:0] : D3 enters L1
                         B4h (Port 0)    Rx Polarity Inversion Disable for port 0
                         B4h : Bit [14]           Bit [6] : Disable Rx polarity capability
                A2h      B0h (Port1)     Decode VGA for Port1
                         B0h: Bit[31]      Bit [7]
                         B4h (Port 1)    PM Control Parameter for Port 1
                         B4h: Bit [13:8]          Bit [5:4] : L0s enable
                                                  Bit [3:2] : L1 delay count select
                                                  Bit [1:0] : D3 enters L1
                         B4h (Port 1)    Rx Polarity Inversion Disable for port 1
                         B4h : Bit [14]           Bit [6] : Disable Rx polarity capability
                A4h      B0h (Port2)     Decode VGA for Port2
                         B0h: Bit[31]      Bit [7]
                         B4h (Port 2)    PM Control Parameter for Port 2
                         B4h: Bit [13:8]          Bit [5:4] : L0s enable
                                                  Bit [3:2] : L1 delay count select
                                                  Bit [1:0] : D3 enters L1
                         B4h (Port 2)    Rx Polarity Inversion Disable for port 2
                         B4h : Bit [14]           Bit [6] : Disable Rx polarity capability
                                         Page 28 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                 PI7C9X20303SL
                                                                            3Port-3Lane PCI Express® Switch
                                                                                               SlimLineTM Family
                                                                                                      Datasheet
6.2     SMBus INTERFACE
The PI7C9X20303SL provides the System Management Bus (SMBus), a two-wire interface through which a simple
device can communicate with the rest of the system. The SMBus interface on the PI7C9X20303SL is a bi-
directional slave interface. It can receive data from the SMBus master or send data to the master. The interface
allows full access to the configuration registers. A SMBus master, such as the processor or other SMBus devices,
can read or write to every RW configuration register (read/write register). In addition, the RO and HwInt registers
(read-only and hardware initialized registers) that can be auto-loaded by the EEPROM interface can also be read
and written by the SMBus interface. This feature allows increases in the system expandability and flexibility in
system implementation.
          Figure 6-1 SMBus Architecture Implementation on PI7C9X20303SL
                                                         Processor           Other SMBus
                        PI7C9X20303SL                  (SMBus Master)           Devices
                                      SMBCLK
                                    SMBDATA
The SMBus interface on the PI7C9X20303SL consists of one SMBus clock pin (SMBCLK), a SMBus data pin
(SMBDATA), and 3 SMBus address pins (GPIO[5:7]). The SMBus clock pin provides or receives the clock signal.
The SMBus data pin facilitates the data transmission and reception. Both of the clock and data pins are bi-
directional. The SMBus address pins determine the address to which the PI7C9X20303SL responds to. The SMBus
address pins generate addresses according to the following table:
        Table 6-1 SMBus Address Pin Configuration
             BIT      SMBus Address
              0       GPIO[5]
              1       GPIO[6]
              2       GPIO[7]
              3       1
              4       0
              5       1
              6       1
                                                    Page 29 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                                       PI7C9X20303SL
                                                                                           3Port-3Lane PCI Express® Switch
                                                                                                                    SlimLineTM Family
                                                                                                                            Datasheet
7 REGISTER DESCRIPTION
7.1           REGISTER TYPES
                REGISTER TYPE                       DEFINITION
                HwInt                               Hardware Initialization
                RO                                  Read Only
                RW                                  Read / Write
                RWC                                 Read / Write 1 to Clear
                RWCS                                Sticky - Read Only / Write 1 to Clear
                RWS                                 Sticky - Read / Write
                ROS                                 Sticky – Read Only
7.2            TRANSPARENT MODE CONFIGURATION REGISTERS
              When the port of switch is set to operate at the transparent mode, it is represented by a logical PCI-to-
              PCI bridge that implements type 1 configuration space header. The following table details the
              allocation of the register fields of the PCI 2.3 compatible type 1 configuration space header.
                       31 –24                    23 – 16                     15 - 8                      7 –0             BYTE OFFSET
                                   Device ID                                             Vendor ID                              00h
                                Primary Status                                           Command                                04h
                                                Class Code                                            Revision ID               08h
                      Reserved                 Header Type          Primary Latency Timer           Cache Line Size            0Ch
                                                              Reserved                                                       10h – 17h
                 Secondary Latency           Subordinate Bus        Secondary Bus Number         Primary Bus Number             18h
                        Timer                    Number
                               Secondary Status                        I/O Limit Address           I/O Base Address            1Ch
                             Memory Limit Address                                  Memory Base Address                          20h
                      Prefetchable Memory Limit Address                     Prefetchable Memory Base Address                    24h
                                          Prefetchable Memory Base Address Upper 32-bit                                         28h
                                         Prefetchable Memory Limit Address Upper 32-bit                                        2Ch
                        I/O Limit Address Upper 16-bit                         I/O Base Address Upper 16-bit                    30h
                                                 Reserved                                        Capability Pointer to          34h
                                                                                                          80h
                                                              Reserved                                                          38h
                                Bridge Control                            Interrupt Pin              Interrupt Line            3Ch
                                                              Reserved                                                       40h – 7Fh
                        Power Management Capabilities                Next Item Pointer=8C          Capability ID=01             80h
                       PM Data                 PPB Support                        Power Management Data                         84h
                                                Extensions
                               Message Control                      Next Item Pointer= A4          Capability ID=05            8Ch
                                                          Message Address                                                       90h
                                                       Message Upper Address                                                    94h
                                   Reserved                                             Message Data                            98h
                                 VPD Register                        Next Item Pointer=A4          Capability ID=03            9Ch
                                                         VPD Data Register                                                     A0h
                             Length in Bytes (14h)                   Next Item Pointer=C0          Capability ID=09            A4h
                                                            XPIP_CSR0                                                          A8h
                                                            XPIP_CSR1                                                          ACh
                              ACK Latency Timer                                   Replay Time-out Counter                      B0h
                               PHY Parameters                                      Switch Operation Mode                       B4h
                                                            XPIP_CSR2                                                          B8h
                                                              Reserved                                                         BCh
                                   Reserved                         Next Item                 SSID/SSVID                       C0h
                                                                    Pointer=E0              Capability ID=0D
                                     SSID                                                 SSVID                                C4h
                                                            Page 30 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                                      PI7C9X20303SL
                                                                                             3Port-3Lane PCI Express® Switch
                                                                                                                    SlimLineTM Family
                                                                                                                            Datasheet
                       31 –24                     23 – 16                      15 - 8                     7 –0           BYTE OFFSET
                                                               Reserved                                                      C8h – D7h
                                                        GPIO Data and Control                                                   D8h
                                 EEPROM Data                            EEPROM Address             EEPROM Control              DCh
                       PCI Express Capabilities Register              Next Item Pointer=00          Capability ID=10            E0h
                                                          Device Capabilities                                                   E4h
                                  Device Status                                         Device Control                          E8h
                                                           Link Capabilities                                                   ECh
                                   Link Status                                           Link Control                           F0h
                                                            Slot Capabilities                                                   F4h
                                   Slot Status                                           Slot Control                           F8h
                                                               Reserved                                                         FCh
              Other than the PCI 2.3 compatible configuration space header, the Switch also implements PCI
              express extended configuration space header, which includes advanced error reporting, virtual channel,
              and power budgeting capability registers. The following table details the allocation of the register
              fields of PCI express extended capability space header. The first extended capability always begins at
              offset 100h with a PCI Express Enhanced Capability header and the rest of capabilities are located at
              an offset greater than 0FFh relative to the beginning of PCI compatible configuration space.
                      31 –24                     23 – 16                      15 - 8                   7 –0             BYTE OFFSET
                      Next Capability Offset              Cap.         PCI Express Extended Capability ID=0001h               100h
                                                        Version
                                                 Uncorrectable Error Status Register                                          104h
                                                 Uncorrectable Error Mask Register                                            108h
                                                Uncorrectable Error Severity Register                                         10Ch
                                                  Correctable Error Status Register                                           110h
                                                   Correctable Error Mask Register                                            114h
                                          Advanced Error Capabilities and Control Register                                    118h
                                                         Header Log Register                                               11Ch – 128h
                                                               Reserved                                                    12Ch – 13Fh
                  Next Capability Offset=20Ch             Cap.         PCI Express Extended Capability ID=0002h               140h
                                                        Version
                                                    Port VC Capability Register 1                                             144h
                VC Arbitration Table                             Port VC Capability Register 2                                148h
                      Offset=3
                             Port VC Status Register                              Port VC Control Register                    14Ch
                Port Arbitration Table                        VC Resource Capability Register (0)                             150h
                      Offset=4
                                                  VC Resource Control Register (0)                                            154h
                        VC Resource Status Register (0)                                  Reserved                             158h
                                                               Reserved                                                     15Ch-17Ch
                                           Port Arbitration Table with 128 Phases for VC0                                  180h – 1BCh
                                                               Reserved                                                    1C0h – 1FCh
                                                               Reserved                                                    200h – 20Bh
                   Next Capability Offset=000h            Cap.         PCI Express Extended Capability ID=0004h               20Ch
                                                        Version
                                                 Reserved                                       Data Select Register          210h
                                                            Data Register                                                     214h
                                                 Reserved                                          Power Budget               218h
                                                                                                Capability Register
                                                              Page 31 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                             PI7C9X20303SL
                                                                                  3Port-3Lane PCI Express® Switch
                                                                                                         SlimLineTM Family
                                                                                                                    Datasheet
7.2.1         VENDOR ID REGISTER – OFFSET 00h
                BIT     FUNCTION             TYPE   DESCRIPTION
                15:0    Vendor ID             RO    Identifies Pericom as the vendor of this device. The default value may be
                                                    changed by SMBus or auto-loading from EEPROM.
                                                    Reset to 12D8h.
7.2.2         DEVICE ID REGISTER – OFFSET 00h
                BIT     FUNCTION             TYPE   DESCRIPTION
                31:16   Device ID             RO    Identifies this device as the PI7C9X20303SL. The default value may be
                                                    changed by SMBus or auto-loading from EEPROM.
                                                    Resets to A303h.
7.2.3         COMMAND REGISTER – OFFSET 04h
                BIT     FUNCTION             TYPE   DESCRIPTION
                                                    0b: Ignores I/O transactions on the primary interface
                                                    1b: Enables responses to I/O transactions on the primary interface
                0       I/O Space Enable      RW
                                                    Resets to 0b.
                                                    0b: Ignores memory transactions on the primary interface
                        Memory Space                1b: Enables responses to memory transactions on the primary interface
                1                             RW
                        Enable
                                                    Reset to 0b.
                                                    0b: Does not initiate memory or I/O transactions on the upstream port and
                                                        handles as an Unsupported Request (UR) to memory and I/O transactions
                                                        on the downstream port. For Non-Posted Requests, a completion with UR
                                                        completion status must be returned
                2       Bus Master Enable     RW
                                                    1b: Enables the Switch Port to forward memory and I/O Read/Write
                                                        transactions in the upstream direction
                                                    Reset to 0b.
                3       Special Cycle Enable  RO    Does not apply to PCI Express. Must be hardwired to 0b.
                        Memory Write And            Does not apply to PCI Express. Must be hardwired to 0b.
                4                             RO
                        Invalidate Enable
                        VGA Palette Snoop           Does not apply to PCI Express. Must be hardwired to 0b.
                5                             RO
                        Enable
                                                    0b: Switch may ignore any parity errors that it detects and continue normal
                                                      operation
                        Parity Error
                6                             RW    1b: Switch must take its normal action when a parity error is detected
                        Response Enable
                                                    Reset to 0b.
                7       Wait Cycle Control    RO    Does not apply to PCI Express. Must be hardwired to 0.
                                                    0b: Disables the reporting of Non-fatal and Fatal errors detected by the
                                                        Switch to the Root Complex
                8       SERR# enable          RW    b1: Enables the Non-fatal and Fatal error reporting to Root Complex
                                                    Reset to 0b.
                        Fast Back-to-Back           Does not apply to PCI Express. Must be hardwired to 0b.
                9                             RO
                        Enable
                                                    Controls the ability of a PCI Express device to generate INTx Interrupt
                                                    Messages. In the Switch, this bit does not affect the forwarding of INTx
                10      Interrupt Disable     RW    messages from the downstream ports.
                                                    Reset to 0b.
                                                  Page 32 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                                PI7C9X20303SL
                                                                                   3Port-3Lane PCI Express® Switch
                                                                                                            SlimLineTM Family
                                                                                                                         Datasheet
                BIT     FUNCTION              TYPE   DESCRIPTION
                15:11   Reserved                RO   Reset to 0b.
7.2.4         PRIMARY STATUS REGISTER – OFFSET 04h
                BIT     FUNCTION              TYPE   DESCRIPTION
                18:16   Reserved                RO   Reset to 000b.
                                                     Indicates that an INTx Interrupt Message is pending internally to the device.
                19      Interrupt Status        RO   In the Switch, the forwarding of INTx messages from the downstream device
                                                     of the Switch port is not reflected in this bit. Must be hardwired to 0b.
                                                     Set to 1 to enable support for the capability list (offset 34h is the pointer to
                                                     the data structure).
                20      Capabilities List       RO
                                                     Reset to 1b.
                21      66MHz Capable           RO   Does not apply to PCI Express. Must be hardwired to 0b.
                22      Reserved                RO   Reset to 0b.
                        Fast Back-to-Back            Does not apply to PCI Express. Must be hardwired to 0b.
                23                              RO
                        Capable
                                                     Set to 1 (by a requester) whenever a Parity error is detected or forwarded on
                                                     the primary side of the port in a Switch.
                        Master Data Parity
                24                             RWC
                        Error                        If the Parity Error Response Enable bit is cleared, this bit is never set.
                                                     Reset to 0b.
                26:25   DEVSEL# timing          RO   Does not apply to PCI Express. Must be hardwired to 0b.
                                                     Set to 1 (by a completer) whenever completing a request on the primary side
                        Signaled Target              using the Completer Abort Completion Status.
                27                              RO
                        Abort
                                                     Reset to 0b.
                                                     Set to 1 (by a requestor) whenever receiving a Completion with Completer
                        Received Target              Abort Completion Status on the primary side.
                28                              RO
                        Abort
                                                     Reset to 0b.
                                                     Set to 1 (by a requestor) whenever receiving a Completion with Unsupported
                        Received Master              Request Completion Status on primary side.
                29                              RO
                        Abort
                                                     Reset to 0b.
                                                     Set to 1 when the Switch sends an ERR_FATAL or ERR_NONFATAL
                        Signaled System              Message, and the SERR Enable bit in the Command register is 1.
                30                             RWC
                        Error
                                                     Reset to 0b.
                                                     Set to 1 whenever the primary side of the port in a Switch receives a Poisoned
                                                     TLP.
                31      Detected Parity Error  RWC
                                                     Reset to 0b.
7.2.5         REVISION ID REGISTER – OFFSET 08h
                BIT     FUNCTION              TYPE   DESCRIPTION
                7:0     Revision              RO     Indicates revision number of device. Hardwired to 02h.
7.2.6         CLASS CODE REGISTER – OFFSET 08h
                BIT     FUNCTION              TYPE   DESCRIPTION
                15:8    Programming             RO   Read as 00h to indicate no programming interfaces have been defined for
                        Interface                    PCI-to-PCI Bridges.
                23:16   Sub-Class Code          RO   Read as 04h to indicate device is a PCI-to-PCI Bridge.
                31:24   Base Class Code         RO   Read as 06h to indicate device is a Bridge device.
                                                   Page 33 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                          PI7C9X20303SL
                                                                               3Port-3Lane PCI Express® Switch
                                                                                                        SlimLineTM Family
                                                                                                                   Datasheet
7.2.7         CACHE LINE REGISTER – OFFSET 0Ch
                BIT     FUNCTION           TYPE   DESCRIPTION
                                                  The cache line size register is set by the system firmware and the operating
                                                  system cache line size. This field is implemented by PCI Express devices as a
                                                  RW field for legacy compatibility, but it has no impact on any PCI Express
                7:0     Cache Line Size     RW
                                                  device functionality.
                                                  Reset to 0b.
7.2.8         PRIMARY LATENCY TIMER REGISTER – OFFSET 0Ch
                BIT     FUNCTION           TYPE   DESCRIPTION
                        Primary Latency           Does not apply to PCI Express. Must be hardwired to 00h.
                15:8                        RO
                        timer
7.2.9         HEADER TYPE REGISTER – OFFSET 0Ch
                BIT     FUNCTION           TYPE   DESCRIPTION
                                                  Read as 01h to indicate that the register layout conforms to the standard PCI-
                23:16   Header Type         RO
                                                  to-PCI Bridge layout.
7.2.10        PRIMARY BUS NUMBER REGISTER – OFFSET 18h
                BIT     FUNCTION           TYPE   DESCRIPTION
                                                  Indicates the number of the PCI bus to which the primary interface is
                                                  connected. The value is set in software during configuration.
                7:0     Primary Bus Number  RW
                                                  Reset to 00h.
7.2.11        SECONDARY BUS NUMBER REGISTER – OFFSET 18h
                BIT     FUNCTION           TYPE   DESCRIPTION
                                                  Indicates the number of the PCI bus to which the secondary interface is
                        Secondary Bus             connected. The value is set in software during configuration.
                15:8                        RW
                        Number
                                                  Reset to 00h.
7.2.12        SUBORDINATE BUS NUMBER REGISTER – OFFSET 18h
                BIT     FUNCTION           TYPE   DESCRIPTION
                                                  Indicates the number of the PCI bus with the highest number that is
                        Subordinate Bus           subordinate to the Bridge. The value is set in software during configuration.
                23:16                       RW
                        Number
                                                  Reset to 00h.
                                                Page 34 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                           PI7C9X20303SL
                                                                              3Port-3Lane PCI Express® Switch
                                                                                                       SlimLineTM Family
                                                                                                                     Datasheet
7.2.13        SECONDARY LATENCY TIMER REGISTER – OFFSET 18h
                BIT     FUNCTION           TYPE   DESCRIPTION
                        Secondary Latency         Does not apply to PCI Express. Must be hardwired to 00h.
                31:24                       RO
                        Timer
7.2.14        I/O BASE ADDRESS REGISTER – OFFSET 1Ch
                BIT     FUNCTION           TYPE   DESCRIPTION
                3:0     32-bit Indicator    RO    Read as 01h to indicate 32-bit I/O addressing.
                                                  Defines the bottom address of the I/O address range for the Bridge to
                                                  determine when to forward I/O transactions from one interface to the other.
                                                  The upper 4 bits correspond to address bits [15:12] and are writable. The
                        I/O Base Address          lower 12 bits corresponding to address bits [11:0] are assumed to be 0. The
                7:4                         RW
                        [15:12]                   upper 16 bits corresponding to address bits [31:16] are defined in the I/O base
                                                  address upper 16 bits address register.
                                                  Reset to 0h.
7.2.15        I/O LIMIT ADDRESS REGISTER – OFFSET 1Ch
                BIT     FUNCTION           TYPE   DESCRIPTION
                11:8    32-bit Indicator    RO    Read as 01h to indicate 32-bit I/O addressing.
                                                  Defines the top address of the I/O address range for the Bridge to determine
                                                  when to forward I/O transactions from one interface to the other. The upper 4
                                                  bits correspond to address bits [15:12] and are writable. The lower 12 bits
                        I/O Limit Address         corresponding to address bits [11:0] are assumed to be FFFh. The upper 16
                15:12                       RW
                        [15:12]                   bits corresponding to address bits [31:16] are defined in the I/O limit address
                                                  upper 16 bits address register.
                                                  Reset to 0h.
7.2.16        SECONDARY STATUS REGISTER – OFFSET 1Ch
                BIT     FUNCTION           TYPE   DESCRIPTION
                20:16   Reserved            RO    Reset to 00000b.
                21      66MHz Capable       RO    Does not apply to PCI Express. Must be hardwired to 0b.
                22      Reserved            RO    Reset to 0b.
                        Fast Back-to-Back         Does not apply to PCI Express. Must be hardwired to 0b.
                23                          RO
                        Capable
                                                  Set to 1 (by a requester) whenever a Parity error is detected or forwarded on
                                                  the secondary side of the port in a Switch.
                        Master Data Parity
                24                         RWC
                        Error                     If the Parity Error Response Enable bit is cleared, this bit is never set.
                                                  Reset to 0b.
                26:25   DEVSEL_L timing     RO    Does not apply to PCI Express. Must be hardwired to 0b.
                                                  Set to 1 (by a completer) whenever completing a request in the secondary side
                        Signaled Target           using Completer Abort Completion Status.
                27                          RO
                        Abort
                                                  Reset to 0b.
                                                  Set to 1 (by a requestor) whenever receiving a Completion with Completer
                        Received Target           Abort Completion Status in the secondary side.
                28                          RO
                        Abort
                                                  Reset to 0b.
                                                Page 35 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                             PI7C9X20303SL
                                                                                  3Port-3Lane PCI Express® Switch
                                                                                                         SlimLineTM Family
                                                                                                                      Datasheet
                BIT     FUNCTION              TYPE   DESCRIPTION
                                                     Set to 1 (by a requestor) whenever receiving a Completion with Unsupported
                        Received Master              Request Completion Status in secondary side.
                29                             RO
                        Abort
                                                     Reset to 0b.
                                                     Set to 1 when the Switch sends an ERR_FATAL or ERR_NONFATAL
                        Received System              Message, and the SERR Enable bit in the Bridge Control register is 1.
                30                            RWC
                        Error
                                                     Reset to 0b.
                                                     Set to 1 whenever the secondary side of the port in a Switch receives a
                                                     Poisoned TLP.
                31      Detected Parity Error RWC
                                                     Reset to 0b.
7.2.17        MEMORY BASE ADDRESS REGISTER – OFFSET 20h
                BIT     FUNCTION              TYPE   DESCRIPTION
                3:0     Reserved               RO    Reset to 0h.
                                                     Defines the bottom address of an address range for the Bridge to determine
                                                     when to forward memory transactions from one interface to the other. The
                        Memory Base                  upper 12 bits correspond to address bits [31:20] and are able to be written to.
                15:4                           RW
                        Address [15:4]               The lower 20 bits corresponding to address bits [19:0] are assumed to be 0.
                                                     Reset to 000h.
7.2.18        MEMORY LIMIT ADDRESS REGISTER – OFFSET 20h
                BIT     FUNCTION              TYPE   DESCRIPTION
                19:16   Reserved               RO    Reset to 0h.
                                                     Defines the top address of an address range for the Bridge to determine when
                                                     to forward memory transactions from one interface to the other. The upper
                        Memory Limit                 12 bits correspond to address bits [31:20] and are writable. The lower 20 bits
                31:20                          RW
                        Address [31:20]              corresponding to address bits [19:0] are assumed to be FFFFFh.
                                                     Reset to 000h.
7.2.19        PREFETCHABLE MEMORY BASE ADDRESS REGISTER – OFFSET 24h
                BIT     FUNCTION              TYPE   DESCRIPTION
                3:0     64-bit addressing      RO    Read as 0001b to indicate 64-bit addressing.
                                                     Defines the bottom address of an address range for the Bridge to determine
                                                     when to forward memory read and write transactions from one interface to the
                                                     other. The upper 12 bits correspond to address bits [31:20] and are writable.
                        Prefetchable Memory
                15:4                           RW    The lower 20 bits are assumed to be 0. The memory base register upper 32
                        Base Address [31:20]
                                                     bits contain the upper half of the base address.
                                                     Reset to 000h.
7.2.20        PREFETCHABLE MEMORY LIMIT ADDRESS REGISTER – OFFSET 24h
                BIT     FUNCTION              TYPE   DESCRIPTION
                19:16   64-bit addressing      RO    Read as 0001b to indicate 64-bit addressing.
                                                   Page 36 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                            PI7C9X20303SL
                                                                                3Port-3Lane PCI Express® Switch
                                                                                                          SlimLineTM Family
                                                                                                                    Datasheet
                BIT     FUNCTION            TYPE   DESCRIPTION
                                                   Defines the top address of an address range for the Bridge to determine when
                                                   to forward memory read and write transactions from one interface to the
                        Prefetchable Memory        other. The upper 12 bits correspond to address bits [31:20] and are writable.
                31:20   Limit Address        RW    The lower 20 bits are assumed to be FFFFFh. The memory limit upper 32 bits
                        [31:20]                    register contains the upper half of the limit address.
                                                   Reset to 000h.
7.2.21        PREFETCHABLE MEMORY BASE ADDRESS UPPER 32-BITS REGISTER
              – OFFSET 28h
                BIT     FUNCTION            TYPE   DESCRIPTION
                                                   Defines the upper 32-bits of a 64-bit bottom address of an address range for
                        Prefetchable Memory        the Bridge to determine when to forward memory read and write transactions
                31:0    Base Address, Upper  RW    from one interface to the other.
                        32-bits [63:32]
                                                   Reset to 00000000h.
7.2.22        PREFETCHABLE MEMORY LIMIT ADDRESS UPPER 32-BITS REGISTER
              – OFFSET 2Ch
                BIT     FUNCTION            TYPE   DESCRIPTION
                                                   Defines the upper 32-bits of a 64-bit top address of an address range for the
                        Prefetchable Memory
                                                   Bridge to determine when to forward memory read and write transactions
                        Limit Address,
                31:0                         RW    from one interface to the other.
                        Upper 32-bits
                        [63:32]
                                                   Reset to 00000000h.
7.2.23        I/O BASE ADDRESS UPPER 16-BITS REGISTER – OFFSET 30h
                BIT     FUNCTION            TYPE   DESCRIPTION
                                                   Defines the upper 16-bits of a 32-bit bottom address of an address range for
                        I/O Base Address,          the Bridge to determine when to forward I/O transactions from one interface
                15:0    Upper 16-bits        RW    to the other.
                        [31:16]
                                                   Reset to 0000h.
7.2.24        I/O LIMIT ADDRESS UPPER 16-BITS REGISTER – OFFSET 30h
                BIT     FUNCTION            TYPE   DESCRIPTION
                                                   Defines the upper 16-bits of a 32-bit top address of an address range for the
                        I/O Limit Address,         Bridge to determine when to forward I/O transactions from one interface to
                31:16   Upper 16-bits        RW    the other.
                        [31:16]
                                                   Reset to 0000h.
7.2.25        CAPABILITY POINTER REGISTER – OFFSET 34h
                BIT     FUNCTION            TYPE   DESCRIPTION
                                                   Pointer points to the PCI power management registers (80h).
                7:0     Capability Pointer   RO
                                                 Page 37 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                              PI7C9X20303SL
                                                                                3Port-3Lane PCI Express® Switch
                                                                                                          SlimLineTM Family
                                                                                                                    Datasheet
                BIT     FUNCTION            TYPE   DESCRIPTION
                                                   Reset to 80h.
7.2.26        INTERRUPT LINE REGISTER – OFFSET 3Ch
                BIT     FUNCTION            TYPE   DESCRIPTION
                7:0     Interrupt Line       RW    Reset to 00h.
7.2.27        INTERRUPT PIN REGISTER – OFFSET 3Ch
                BIT     FUNCTION            TYPE   DESCRIPTION
                                                   The Switch implements INTA virtual wire interrupt signals to represent hot-
                                                   plug events at downstream ports. The default value on the downstream ports
                15:8    Interrupt Pin        RO    may be changed by SMBus or auto-loading from EEPROM.
                                                   Reset to 00h.
7.2.28        BRIDGE CONTROL REGISTER – OFFSET 3Ch
                BIT     FUNCTION            TYPE   DESCRIPTION
                                                   0b: Ignore Poisoned TLPs on the secondary interface
                                                   1b: Enable the Poisoned TLPs reporting and detection on the secondary
                        Parity Error
                16                           RW    interface
                        Response
                                                   Reset to 0b.
                                                   0b: Disables the forwarding of EER_COR, ERR_NONFATAL and
                                                       ERR_FATAL from secondary to primary interface
                                                   1b: Enables the forwarding of EER_COR, ERR_NONFATAL and
                17      S_SERR# enable       RW
                                                       ERR_FATAL from secondary to primary interface
                                                   Reset to 0b.
                                                   0b: Forwards downstream all I/O addresses in the address range defined by
                                                       the I/O Base, I/O Base, and Limit registers
                                                   1b: Forwards upstream all I/O addresses in the address range defined by the
                18      ISA Enable           RW        I/O Base and Limit registers that are in the first 64KB of PCI I/O address
                                                       space (top 768 bytes of each 1KB block)
                                                   Reset to 0b.
                                                   0: Ignores access to the VGA memory or IO address range
                                                   1: Forwards transactions targeted at the VGA memory or IO address range
                                                   VGA memory range starts from 000A 0000h to 000B FFFFh
                19      VGA Enable           RW
                                                   VGA IO addresses are in the first 64KB of IO address space.
                                                   AD [9:0] is in the ranges 3B0 to 3BBh and 3C0h to 3DFh.
                                                   Reset to 0b. Please note that this bit is reserved in Port 2.
                                                   0b: Executes 10-bit address decoding on VGA I/O accesses
                                                   1b: Executes 16-bit address decoding on VGA I/O accesses
                20      VGA 16-bit decode    RW
                                                   Reset to 0b. Please note that this bit is reserved in Port 2.
                21      Master Abort Mode    RO    Does not apply to PCI Express. Must be hardwired to 0b.
                                                   0b: Does not trigger a hot reset on the corresponding PCI Express Port
                                                   1b: Triggers a hot reset on the corresponding PCI Express Port
                                                      At the downstream port, it asserts PORT_RST# to the attached downstream
                                                      device.
                22      Secondary Bus Reset  RW
                                                      At the upstream port, it asserts the PORT_RST# at all the downstream
                                                      ports.
                                                   Reset to 0b.
                                                 Page 38 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                         PI7C9X20303SL
                                                                              3Port-3Lane PCI Express® Switch
                                                                                                      SlimLineTM Family
                                                                                                                  Datasheet
                BIT     FUNCTION          TYPE   DESCRIPTION
                        Fast Back-to-Back        Does not apply to PCI Express. Must be hardwired to 0b.
                23                         RO
                        Enable
                        Primary Master           Does not apply to PCI Express. Must be hardwired to 0b.
                24                         RO
                        Timeout
                        Secondary Master         Does not apply to PCI Express. Must be hardwired to 0b.
                25                         RO
                        Timeout
                        Master Timeout           Does not apply to PCI Express. Must be hardwired to 0b.
                26                         RO
                        Status
                        Discard Timer            Does not apply to PCI Express. Must be hardwired to 0b.
                27                         RO
                        SERR# enable
                31:28   Reserved           RO    Reset to 0h.
7.2.29        POWER MANAGEMENT CAPABILITY ID REGISTER – OFFSET 80h
                BIT     FUNCTION          TYPE   DESCRIPTION
                        Enhanced                 Read as 01h to indicate that these are power management enhanced capability
                7:0                        RO
                        Capabilities ID          registers.
7.2.30        NEXT ITEM POINTER REGISTER – OFFSET 80h
                BIT     FUNCTION          TYPE   DESCRIPTION
                                                 At upstream ports, the pointer points to the Vital Protocol Data (VPD)
                                                 capability register (9Ch).
                                                 At downstream ports, the pointer points to the Message capability register
                15:8    Next Item Pointer  RO    (8Ch).
                                                 Reset to 9Ch (Upstream port).
                                                 Reset to 8Ch (Downstream port).
7.2.31        POWER MANAGEMENT CAPABILITIES REGISTER – OFFSET 80h
                BIT     FUNCTION          TYPE   DESCRIPTION
                        Power Management         Read as 011b to indicate the device is compliant to Revision 1.2 of PCI
                18:16                      RO
                        Revision                 Power Management Interface Specifications.
                19      PME# Clock         RO    Does not apply to PCI Express. Must be hardwired to 0b.
                20      Reserved           RO    Reset to 0b.
                                                 Read as 0b to indicate Switch does not have device specific initialization
                        Device Specific
                21                         RO    requirements. The default value may be changed by SMBus or auto-loading
                        Initialization
                                                 from EEPROM.
                                                 Reset as 111b to indicate the Switch needs 375 mA in D3 state. The default
                24:22   AUX Current        RO
                                                 value may be changed by SMBus or auto-loading from EEPROM.
                        D1 Power State           Read as 1b to indicate Switch supports the D1 power management state. The
                25                         RO
                        Support                  default value may be changed by SMBus or auto-loading from EEPROM.
                        D2 Power State           Read as 1b to indicate Switch supports the D2 power management state. The
                26                         RO
                        Support                  default value may be changed by SMBus or auto-loading from EEPROM.
                                                 Read as 11111b to indicate Switch supports the forwarding of PME# message
                31:27   PME# Support       RO    in all power states. The default value may be changed by SMBus or auto-
                                                 loading from EEPROM.
7.2.32        POWER MANAGEMENT DATA REGISTER – OFFSET 84h
                BIT     FUNCTION          TYPE   DESCRIPTION
                                                 Indicates the current power state of the Switch. Writing a value of D0 when
                1:0     Power State        RW    the previous state was D3 cause a hot reset without asserting DWNRST_L.
                                               Page 39 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                           PI7C9X20303SL
                                                                              3Port-3Lane PCI Express® Switch
                                                                                                       SlimLineTM Family
                                                                                                                   Datasheet
                BIT     FUNCTION          TYPE   DESCRIPTION
                                                 00b: D0 state
                                                 01b: D1 state
                                                 10b: D2 state
                                                 11b: D3 hot state
                                                 Reset to 00b.
                2       Reserved           RO    Reset to 0b.
                                                 When set, this bit indicates that device transitioning from D3hot to D0 does
                                                 not perform an internal reset. When clear, an internal reset is performed when
                                                 power state transits from D3hot to D0. This bit can be rewritten with
                3       No_Soft_Reset      RO    EEPROM programming. The default value may be changed by SMBus or
                                                 auto-loading from EEPROM.
                                                 Reset to 1b.
                7:4     Reserved           RO    Reset to 0b.
                8       PME# Enable       RWS    When asserted, the Switch will generate the PME# message. Reset to 0b.
                                                 Select data registers.
                12:9    Data Select        RW
                                                 Reset to 0h.
                14:13   Data Scale         RO    Reset to 00b.
                15      PME status         ROS   Read as 0b as the PME# message is not implemented.
7.2.33        PPB SUPPORT EXTENSIONS – OFFSET 84h
                BIT     FUNCTION          TYPE   DESCRIPTION
                21:16   Reserved           RO    Reset to 000000b.
                        B2_B3 Support for        Does not apply to PCI Express. Must be hardwired to 0b.
                22                         RO
                        D3HOT
                        Bus Power / Clock        Does not apply to PCI Express. Must be hardwired to 0b.
                23                         RO
                        Control Enable
7.2.34        DATA REGISTER – OFFSET 84h
                BIT     FUNCTION          TYPE   DESCRIPTION
                                                 Data Register. The default value may be changed by SMBus or auto-loading
                                                 from EEPROM.
                31:24   Data Register      RO
                                                 Reset to 0b.
7.2.35        MSI CAPABILITY ID REGISTER – OFFSET 8Ch (Downstream Port Only)
                BIT     FUNCTION          TYPE   DESCRIPTION
                        Enhanced                 Read as 05h to indicate that this is message signal interrupt capability
                7:0                        RO
                        Capabilities ID          register.
                                               Page 40 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                           PI7C9X20303SL
                                                                               3Port-3Lane PCI Express® Switch
                                                                                                        SlimLineTM Family
                                                                                                                     Datasheet
7.2.36        NEXT ITEM POINTER REGISTER – OFFSET 8Ch (Downstream Port Only)
                BIT     FUNCTION          TYPE   DESCRIPTION
                                                 Pointer points to the Vendor specific capability register (A4h).
                15:8    Next Item Pointer  RO
                                                 Reset to A4h.
7.2.37        MESSAGE CONTROL REGISTER – OFFSET 8Ch (Downstream Port Only)
                BIT     FUNCTION          TYPE   DESCRIPTION
                                                 0b: The function is prohibited from using MSI to request service
                                                 1b: The function is permitted to use MSI to request service and is prohibited
                16      MSI Enable         RW         from using its INTx # pin
                                                 Reset to 0b.
                        Multiple Message         Read as 000b.
                19:17                      RO
                        Capable
                        Multiple Message         Reset to 000b.
                22:20                      RW
                        Enable
                                                 0b: The function is not capable of generating a 64-bit message address
                        64-bit address           1b: The function is capable of generating a 64-bit message address
                23                         RO
                        capable
                                                 Reset to 1b.
                31:24   Reserved           RO    Reset to 00h.
7.2.38        MESSAGE ADDRESS REGISTER – OFFSET 90h (Downstream Port Only)
                BIT     FUNCTION          TYPE   DESCRIPTION
                1:0     Reserved          RO     Reset to 00b.
                                                 If the message enable bit is set, the contents of this register specify the
                                                 DWORD aligned address for MSI memory write transaction.
                31:2    Message Address   RW
                                                 Reset to 0.
7.2.39        MESSAGE UPPER ADDRESS REGISTER – OFFSET 94h (Downstream
              Port Only)
                BIT     FUNCTION          TYPE   DESCRIPTION
                                                 This register is only effective if the device supports a 64-bit message address
                        Message Upper            is set.
                31:0                       RW
                        Address
                                                 Reset to 00000000h.
7.2.40        MESSAGE DATA REGISTER – OFFSET 98h (Downstream Port Only)
                BIT     FUNCTION          TYPE   DESCRIPTION
                15:0    Message Data       RW    Reset to 0000h.
7.2.41        VPD CAPABILITY ID REGISTER – OFFSET 9Ch (Upstream Port Only)
                                               Page 41 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                         PI7C9X20303SL
                                                                              3Port-3Lane PCI Express® Switch
                                                                                                      SlimLineTM Family
                                                                                                                  Datasheet
                BIT     FUNCTION          TYPE   DESCRIPTION
                                                 Read as 03h to indicate that these are VPD enhanced capability registers.
                        Enhanced
                7:0                        RO
                        Capabilities ID
                                                 Reset to 03h.
7.2.42        NEXT ITEM POINTER REGISTER – OFFSET 9Ch (Upstream Port Only)
                BIT     FUNCTION          TYPE   DESCRIPTION
                                                 Pointer points to the Vendor specific capability register (A4h).
                15:8    Next Item Pointer  RO
                                                 Reset to A4h.
7.2.43        VPD REGISTER – OFFSET 9Ch (Upstream Port Only)
                BIT     FUNCTION          TYPE   DESCRIPTION
                17:16   Reserved           RO    Reset to 00b.
                                                 Contains DWORD address that is used to generate read or write cycle to the
                                                 VPD table stored in EEPROM.
                23:18   VPD Address        RW
                                                 Reset to 000000b.
                30:24   Reserved           RO    Reset to 0000000b.
                                                 0b: Performs VPD read command to VPD table at the location as specified
                                                     in VPD address. This bit is kept ‘0’ and then set to ‘1’ automatically
                                                     after EEPROM cycle is finished
                                                 1b: Performs VPD write command to VPD table at the location as specified
                31      VPD operation      RW
                                                     in VPD address. This bit is kept ‘1’ and then set to ‘0’ automatically
                                                     after EEPROM cycle is finished.
                                                 Reset to 0b.
7.2.44        VPD DATA REGISTER – OFFSET A0h (Upstream Port Only)
                BIT     FUNCTION          TYPE   DESCRIPTION
                                                 When read, it returns the last data read from VPD table at the location as
                                                 specified in VPD Address.
                31:0    VPD Data           RW
                                                 When written, it places the current data into VPD table at the location as
                                                 specified in VPD Address.
7.2.45        VENDOR SPECIFIC CAPABILITY ID REGISTER – OFFSET A4h
                BIT     FUNCTION          TYPE   DESCRIPTION
                                                 Read as 09h to indicate that these are vendor specific capability registers.
                        Enhanced
                7:0                        RO
                        Capabilities ID
                                                 Reset to 09h.
                                               Page 42 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                         PI7C9X20303SL
                                                                               3Port-3Lane PCI Express® Switch
                                                                                                      SlimLineTM Family
                                                                                                                   Datasheet
7.2.46        NEXT ITEM POINTER REGISTER – OFFSET A4h
                BIT     FUNCTION           TYPE   DESCRIPTION
                                                  Pointer points to the SSID/SSVID capability register (C0h).
                15:8    Next Item Pointer   RO
                                                  Reset to C0h.
7.2.47        LENGTH REGISTER – OFFSET A4h
                BIT     FUNCTION           TYPE   DESCRIPTION
                                                  The length field provides the information for number of bytes in the
                                                   capability structure (including the ID and Next pointer bytes).
                31:16   Length Information  RO
                                                  Reset to 000Ch.
7.2.48        XPIP CSR0 – OFFSET A8h (Test Purpose Only)
                BIT     FUNCTION           TYPE   DESCRIPTION
                31:0    Reserved            RW    Reset to 04001060h.
7.2.49        XPIP CSR1 – OFFSET ACh (Test Purpose Only)
                BIT     FUNCTION           TYPE   DESCRIPTION
                31:0    Reserved            RW    Reset to 04000800h.
7.2.50        REPLAY TIME-OUT COUNTER – OFFSET B0h (Upstream Port)
                BIT     FUNCTION           TYPE   DESCRIPTION
                                                  A 12-bit register contains a user-defined value. The default value may be
                                                  changed by SMBus or auto-loading from EEPROM.
                11:0    User Replay Timer   RW
                                                  Reset to 000h.
                                                  When asserted, the user-defined replay time-out value is be employed. The
                        Enable User Replay        default value may be changed by SMBus or auto-loading from EEPROM.
                12                          RW
                        Timer
                                                  Reset to 0b.
                                                  The default value may be changed by SMBus or auto-loading from
                        Power Management          EEPROM.
                13                          RO
                        Capability Disable
                                                  Reset to 0b.
                                                  The default value may be changed by SMBus or auto-loading from
                        MSI Capability            EEPROM.
                14                          RO
                        Disable
                                                  Reset to 0b.
                                                  The default value may be changed by SMBus or auto-loading from
                        AER Capability            EEPROM.
                15                          RO
                        Disable
                                                  Reset to 0b.
                                                Page 43 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                              PI7C9X20303SL
                                                                                   3Port-3Lane PCI Express® Switch
                                                                                                          SlimLineTM Family
                                                                                                                       Datasheet
7.2.51        ACKNOWLEDGE LATENCY TIMER – OFFSET B0h
                BIT     FUNCTION              TYPE   DESCRIPTION
                                                     A 14-bit register contains a user-defined value. The default value may be
                        User ACK Latency             changed by SMBus or auto-loading from EEPROM.
                29:16                          RW
                        Timer
                                                     Reset to 0.
                                                     When asserted, the user-defined ACK latency value is be employed. The
                        Enable User ACK              default value may be changed by SMBus or auto-loading from EEPROM.
                30                             RW
                        Latency
                                                     Reset to 0b.
                                                     When asserted, the VGA Capability is enabled. The value may be changed by
                        VGA Capability               auto-loading from EEPROM.
                31                             RO
                        Enable
                                                     Reset to 1b.
7.2.52        SWITCH OPERATION MODE – OFFSET B4h (Upstream Port)
                BIT     FUNCTION              TYPE   DESCRIPTION
                                                     When set, a store-forward mode is used. Otherwise, the chip is working under
                                                     cut-through mode. The default value may be changed by SMBus or auto-
                0       Store-Forward          RW    loading from EEPROM.
                                                     Reset to 0b.
                                                     Cut-through Threshold. When forwarding a packet from low-speed port to
                                                     high-speed mode, the chip provides the capability to adjust the forwarding
                                                     threshold. The default value may be changed by SMBus or auto-loading from
                                                     EEPROM.
                        Cut-through
                2:1                            RW    00b: the threshold is set at the middle of forwarding packet
                        Threshold
                                                     01b: the threshold is set ahead 1-cycle of middle point
                                                     10b: the threshold is set ahead 2-cycle of middle point.
                                                     11b: the threshold is set ahead 3-cycle of middle point.
                                                     Reset to 01b.
                                                     When set, the round-robin arbitration will stay in the arbitrated port even if
                                                     the credit is not enough but request is pending.
                                                     When clear, the round-robin arbitration will always go to the requesting port,
                        Port Arbitration             which the outgoing credit is enough for the packet queued in the port.
                3                              RW
                        Mode                         The default value may be changed by SMBus or auto-loading from
                                                     EEPROM.
                                                     Reset to 0b.
                                                     When set, the frequency of releasing new credit to the link partner will be one
                                                     credit per update.
                                                     When clear, the frequency of releasing new credit to the link partner will be
                                                     two credits per update.
                4       Credit Update Mode     RW
                                                     The default value may be changed by SMBus or auto-loading from
                                                     EEPROM.
                                                     Reset to 0b.
                                                     When set, there has ordering rule on packets for different egress port. The
                        Ordering on
                                                     default value may be changed by SMBus or auto-loading from EEPROM.
                5       Different Egress Port  RW
                        Mode
                                                     Reset to 0b.
                                                     When set, there has ordering rule between completion packet with different
                        Ordering on                  tag. The default value may be changed by SMBus or auto-loading from
                6       Different Tag of       RW    EEPROM.
                        Completion Mode
                                                     Reset to 0b.
                7       Reserved               RO    Reset to 0.
                                                   Page 44 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                         PI7C9X20303SL
                                                                                  3Port-3Lane PCI Express® Switch
                                                                                                       SlimLineTM Family
                                                                                                                  Datasheet
                BIT     FUNCTION            TYPE   DESCRIPTION
                                                   The default value may be changed by SMBus or auto-loading from
                        Power management           EEPROM.
                13:8                         RW
                        Control parameter
                                                   Reset to 000001b.
                                                   The default value may be changed by SMBus or auto-loading from
                        RX Polarity                EEPROM.
                14                           RO
                        Inversion Disable
                                                   Reset to 0b.
                                                   The default value may be changed by SMBus or auto-loading from
                        Compliance pattern
                                                   EEPROM.
                15      Parity Control       RO
                        Disable
                                                   Reset to 0b.
                                                   Low Driver Current (LODRV). The default value may be changed by SMBus
                                                   or auto-loading from EEPROM.
                16      Low Driver Current   RO
                                                   Reset to 0b.
                                                   High Driver Current (HIDRV). The default value may be changed by SMBus
                                                   or auto-loading from EEPROM.
                17      High Driver Current  RO
                                                   Reset to 0b.
                                                   Driver Transmit Current (DTX[3:0]). The default value may be changed by
                        Driver Transmit            SMBus or auto-loading from EEPROM.
                21:18                        RO
                        Current
                                                   Reset to 0000b.
                                                   De-emphasis Transmit Equalization (DEQ[3:0]). The default value may be
                        De-emphasis
                                                   changed by SMBus or auto-loading from EEPROM.
                25:22   Transmit             RO
                        Equalization
                                                   Reset to 1000b.
                                                   Receive Termination Adjustment (RXTRMADJ[1:0]). The default value may
                        Receive Termination        be changed by SMBus or auto-loading from EEPROM.
                27:26                        RO
                        Adjustment
                                                   Reset to 00b.
                                                   Transmit Termination Adjustment ( TXTRMADJ[1:0]). The default value
                        Transmit
                                                   may be changed by SMBus or auto-loading from EEPROM.
                29:28   Termination          RO
                        Adjustment
                                                   Reset to 00b.
                                                   Receiver Equalization Level Control (RXEQCTL[1:0]). The default value
                        Receiver
                                                   may be changed by SMBus or auto-loading from EEPROM.
                31:30   Equalization Level   RO
                        Control
                                                   Reset to 00b.
7.2.53        SWITCH OPERATION MODE – OFFSET B4h (Downstream Port)
                BIT     FUNCTION            TYPE   DESCRIPTION
                7:0     Reserved            RO     Reset to 0.
                                                   The default value may be changed by SMBus or auto-loading from
                        Power Management           EEPROM.
                13:8                        RW
                        Control Parameter
                                                   Reset to 000001b.
                                                   The default value may be changed by SMBus or auto-loading from
                        RX Polarity                EEPROM.
                14                          RW
                        Inversion Disable
                                                   Reset to 0b.
                                                   The default value may be changed by SMBus or auto-loading from
                        Compliance Pattern
                                                   EEPROM.
                15      Parity Control      RW
                        Disable
                                                   Reset to 0b.
                                                   It indicates the status of the strapping pin LODRV. The default value may be
                                                   changed by SMBus or auto-loading from EEPROM.
                16      Low Driver Current  RO
                                                   Reset to 0b.
                                                 Page 45 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                            PI7C9X20303SL
                                                                                  3Port-3Lane PCI Express® Switch
                                                                                                        SlimLineTM Family
                                                                                                                   Datasheet
                BIT     FUNCTION            TYPE   DESCRIPTION
                                                   It indicates the status of the strapping pin HIDRV. The default value may be
                                                   changed by SMBus or auto-loading from EEPROM.
                17      High Driver Current RO
                                                   Reset to 0b.
                                                   It indicates the status of the strapping pins DTX[3:0]. The default value may
                        Driver Transmit            be changed by SMBus or auto-loading from EEPROM.
                21:18                       RO
                        Current
                                                   Reset to 0000b.
                                                   It indicates the status of the strapping pins DEQ[3:0]. The default value may
                        De-emphasis
                                                   be changed by SMBus or auto-loading from EEPROM.
                25:22   Transmit            RO
                        Equalization
                                                   Reset to 1000b.
                                                   It indicates the status of the strapping pins RXTRMADJ[1:0]. The default
                        Receive Termination        value may be changed by SMBus or auto-loading from EEPROM.
                27:26                       RO
                        Adjustment
                                                   Reset to 00b.
                                                   It indicates the status of the strapping pins TXTRMADJ[1:0]. The default
                        Transmit
                                                   value may be changed by SMBus or auto-loading from EEPROM.
                29:28   Termination         RO
                        Adjustment
                                                   Reset to 00b.
                                                   It indicates the status of the strapping pins RXEQCTL[1:0]. The default value
                        Receiver
                                                   may be changed by SMBus or auto-loading from EEPROM.
                31:30   Equalization Level  RO
                        Control
                                                   Reset to 00b.
7.2.54        XPIP CSR2 – OFFSET B8h (Test Purpose Only)
                BIT     FUNCTION            TYPE   DESCRIPTION
                31:0    Reserved             RO    Reset to 00000030h.
7.2.55        TL CSR – OFFSET BCh
                BIT     FUNCTION            TYPE   DESCRIPTION
                31:0    Reserved             RO    Reset to 00000004h.
7.2.56        SSID/SSVID CAPABILITY ID REGISTER – OFFSET C0h
                BIT     FUNCTION            TYPE   DESCRIPTION
                        SSID/SSVID                 Read as 0Dh to indicate that these are SSID/SSVID capability registers.
                7:0                          RO
                        Capabilities ID
7.2.57        NEXT ITEM POINTER REGISTER – OFFSET C0h
                BIT     FUNCTION            TYPE   DESCRIPTION
                                                   Pointer points to the PCI Express capability register (E0h).
                15:8    Next Item Pointer    RO
                                                   Reset to E0h.
7.2.58        SUBSYSTEM VENDOR ID REGISTER – OFFSET C4h
                BIT     FUNCTION            TYPE   DESCRIPTION
                                                 Page 46 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                       PI7C9X20303SL
                                                                            3Port-3Lane PCI Express® Switch
                                                                                                    SlimLineTM Family
                                                                                                                Datasheet
                15:0    SSVID            RO    It indicates the sub-system vendor id. The default value may be changed by
                                               SMBus or auto-loading from EEPROM.
                                               Reset to 0000h.
7.2.59        SUBSYSTEM ID REGISTER – OFFSET C4h
                BIT     FUNCTION        TYPE   DESCRIPTION
                31:16   SSID             RO    It indicates the sub-system device id. The default value may be changed by
                                               SMBus or auto-loading from EEPROM.
                                               Reset to 0000h.
7.2.60        GPIO CONTROL REGISTER – OFFSET D8h (Upstream Port Only)
                BIT     FUNCTION        TYPE   DESCRIPTION
                0       GPIO [0] Input   RO    State of GPIO [0] pin
                                               0b: GPIO [0] is an input pin
                        GPIO [0] Output        1b: GPIO [0] is an output pin
                1                        RW
                        Enable
                                               Reset to 0b.
                                               Value of this bit will be output to GPIO [0] pin if GPIO [0] is configured as
                        GPIO [0] Output        an output pin.
                2                        RW
                        Register
                                               Reset to 0b.
                3       Reserved         RO    Reset to 0b.
                4       GPIO [1] Input   RO    State of GPIO [1] pin.
                                               0b: GPIO [1] is an input pin
                        GPIO [1] Output        1b: GPIO [1] is an output pin
                5                        RW
                        Enable
                                               Reset to 0b.
                                               Value of this bit will be output to GPIO [1] pin if GPIO [1] is configured as
                        GPIO [1] Output        an output pin.
                6                        RW
                        Register
                                               Reset to 0b.
                7       Reserved         RO    Reset to 0b.
                8       GPIO [2] Input   RO    State of GPIO [2] pin
                                               0b: GPIO [2] is an input pin
                        GPIO [2] Output        1b: GPIO [2] is an output pin
                9                        RW
                        Enable
                                               Reset to 0b.
                                               Value of this bit will be output to GPIO [2] pin if GPIO [2] is configured as
                        GPIO [2] Output        an output pin.
                10                       RW
                        Register
                                               Reset to 0b.
                11      Reserved         RO    Reset to 0b.
                12      GPIO [3] Input   RO    State of GPIO [3] pin.
                                               0b: GPIO [3] is an input pin
                        GPIO [3] Output        1b: GPIO [3] is an output pin
                13                       RW
                        Enable
                                               Reset to 0b.
                                               Value of this bit will be output to GPIO [3] pin if GPIO [3] is configured as
                        GPIO [3] Output        an output pin.
                14                       RW
                        Register
                                               Reset to 0b.
                15      Reserved         RO    Reset to 0b.
                16      GPIO [4] Input   RO    State of GPIO [4] pin.
                                             Page 47 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                       PI7C9X20303SL
                                                                            3Port-3Lane PCI Express® Switch
                                                                                                    SlimLineTM Family
                                                                                                                Datasheet
                BIT     FUNCTION        TYPE   DESCRIPTION
                                               0b: GPIO [4] is an input pin
                        GPIO [4] Output        1b: GPIO [4] is an output pin
                17                       RW
                        Enable
                                               Reset to 0b.
                                               Value of this bit will be output to GPIO [4] pin if GPIO [4] is configured as
                        GPIO [4] Output        an output pin.
                18                       RW
                        Register
                                               Reset to 0b.
                19      Reserved         RO    Reset to 0b.
                20      GPIO [5] Input   RO    State of GPIO [5] pin.
                                               0b: GPIO [5] is an input pin
                        GPIO [5] Output        1b: GPIO [5] is an output pin
                21                       RW
                        Enable
                                               Reset to 0b.
                                               Value of this bit will be output to GPIO [5] pin if GPIO [5] is configured as
                        GPIO [5] Output        an output pin.
                22                       RW
                        Register
                                               Reset to 0b.
                23      Reserved         RO    Reset to 0b.
                24      GPIO [6] Input   RO    State of GPIO [6] pin.
                                               0b: GPIO [6] is an input pin
                        GPIO [6] Output        1b: GPIO [6] is an output pin
                25                       RW
                        Enable
                                               Reset to 0b.
                                               Value of this bit will be output to GPIO [6] pin if GPIO [6] is configured as
                        GPIO [6] Output        an output pin.
                26                       RW
                        Register
                                               Reset to 0b.
                27      Reserved         RO    Reset to 0b.
                28      GPIO [7] Input   RO    State of GPIO [7] pin.
                                               0b: GPIO [7] is an input pin
                        GPIO [7] Output        1b: GPIO [7] is an output pin
                29                       RW
                        Enable
                                               Reset to 0b.
                                               Value of this bit will be output to GPIO [7] pin if GPIO [7] is configured as
                        GPIO [7] Output        an output pin.
                30                       RW
                        Register
                                               Reset to 0b.
                31      Reserved         RO    Reset to 0b.
7.2.61        EEPROM CONTROL REGISTER – OFFSET DCh (Upstream Port Only)
                BIT     FUNCTION        TYPE   DESCRIPTION
                                               Starts the EEPROM read or write cycle.
                0       EEPROM Start     RW
                                               Reset to 0b.
                                               Sends the command to the EEPROM.
                                               0b: EEPROM read
                1       EEPROM Command   RW
                                               1b: EEPROM write
                                               Reset to 0b.
                                               1b: EEPROM acknowledge was not received during the EEPROM cycle.
                        EEPROM Error
                2                        RO
                        Status
                                               Reset to 0b.
                                               0b: EEPROM autoload was unsuccessful or is disabled
                                               1b: EEPROM autolad occurred successfully after RESET. Configuration
                        EEPROM Autoload
                3                        RO       registers were loaded with values in the EEPROM
                        Success
                                               It will be cleared when read at this bit.
                                             Page 48 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                          PI7C9X20303SL
                                                                                3Port-3Lane PCI Express® Switch
                                                                                                        SlimLineTM Family
                                                                                                                 Datasheet
                BIT     FUNCTION           TYPE   DESCRIPTION
                                                  0b: EEPROM autoload was unsuccessful or is disabled
                                                  1b: EEPROM autoload occurred successfully after PREST. Configuration
                        EEPROM Autoload
                4                           RO    registers were loaded with values stored in the EEPROM
                        Status
                                                  Reset to 0b.
                                                  0b: EEPROM autoload enabled
                        EEPROM Autoload           1b: EEPROM autoload disabled
                5                           RW
                        Disable
                                                  Reset to 1b.
                                                  Determines the frequency of the EEPROM clock, which is derived from the
                                                  primary clock.
                                                  00b: Reserved
                        EEPROM Clock
                7:6                         RW    01b: PEXCLK / 1024 (PEXCLK is 125MHz)
                        Rate
                                                  10b: Reserved
                                                  11b: Test Mode
                                                  Reset to 01b.
7.2.62        EEPROM ADDRESS REGISTER – OFFSET DCh (Upstream Port Only)
                BIT     FUNCTION           TYPE   DESCRIPTION
                8       Reserved            RO    Reset to 0b.
                                                  Contains the EEPROM address.
                15:9    EEPROM Address      RW
                                                  Reset to 0.
7.2.63        EEPROM DATA REGISTER – OFFSET DCh (Upstream Port Only)
                BIT     FUNCTION           TYPE   DESCRIPTION
                                                  Contains the data to be written to the EEPROM. After completion of a read
                                                  cycle, this register will contain the data from the EEPROM.
                31:16   EEPROM Data         RW
                                                  Reset to 0000h.
7.2.64        PCI EXPRESS CAPABILITY ID REGISTER – OFFSET E0h
                BIT     FUNCTION           TYPE   DESCRIPTION
                        Enhanced                  Read as 10h to indicate that these are PCI express enhanced capability
                7:0                         RO
                        Capabilities ID           registers.
7.2.65        NEXT ITEM POINTER REGISTER – OFFSET E0h
                BIT     FUNCTION           TYPE   DESCRIPTION
                15:8    Next Item Pointer   RO    Read as 00h. No other ECP registers.
7.2.66        PCI EXPRESS CAPABILITIES REGISTER – OFFSET E0h
                BIT     FUNCTION           TYPE   DESCRIPTION
                                                  Read as 0001b to indicate the device is compliant to the PCI Express Base
                19:16   Capability Version  RO
                                                  Specifications.
                                                Page 49 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                              PI7C9X20303SL
                                                                                    3Port-3Lane PCI Express® Switch
                                                                                                           SlimLineTM Family
                                                                                                                      Datasheet
                BIT     FUNCTION            TYPE    DESCRIPTION
                                                    Indicates the type of PCI Express logical device.
                23:20   Device/Port Type     RO
                                                    Reset to 0101b (Upstream port).
                                                    Reset to 0110b (Downstream port).
                                                    When set, indicates that the PCIe Link associated with this Port is connected
                                                    to a slot. This field is valid for downstream port of the Switch. The default
                24      Slot Implemented    HwInt
                                                    value may be changed by the status of strapped pin, SMBUs, or auto-loading
                                                    from EEPROM.
                        Interrupt Message           Read as 0b. No MSI messages are generated in the transparent mode.
                29:25                        RO
                        Number
                31:30   Reserved             RO     Reset to 00b.
7.2.67        DEVICE CAPABILITIES REGISTER – OFFSET E4h
                BIT     FUNCTION            TYPE    DESCRIPTION
                                                    Indicates the maximum payload size that the device can support for TLPs.
                                                    Each port of the Switch supports 256 bytes max payload size. The default
                        Max_Payload_Size
                2:0                          RO     value may be changed by SMBus or auto-loading from EEPROM.
                        Supported
                                                    Reset to 001b.
                                                    Indicates the support for use of unclaimed function numbers as Phantom
                        Phantom Functions           functions. Read as 00b, since the Switch does not act as a requester.
                4:3                          RO
                        Supported
                                                    Reset to 00b.
                                                    Indicates the maximum supported size of Tag field as a Requester. Read as 0,
                        Extended Tag Field          since the Switch does not act as a requester.
                5                            RO
                        Supported
                                                    Reset to 0b.
                                                    Acceptable total latency that an Endpoint can withstand due to the transition
                                                    from L0s state to the L0 state. For Switch, the ASPM software would not
                        Endpoint L0s
                8:6                          RO     check this value.
                        Acceptable Latency
                                                    Reset to 000b.
                                                    Acceptable total latency that an Endpoint can withstand due to the transition
                                                    from L1 state to the L0 state. For Switch, the ASPM software would not
                        Endpoint L1
                11:9                         RO     check this value.
                        Acceptable Latency
                                                    Reset to 000b.
                14:12   Reserved             RO     Reset to 000b.
                                                    When set, indicates that the device implements the functionality originally
                                                    defined in the Error Reporting ECN. The default value may be changed by
                        Role_Based Error
                15                           RO     SMBus or auto-loading from EEPROM.
                        Reporting
                                                    Reset to 1b.
                17:16   Reserved             RO     Reset to 00b.
                                                    It applies to Upstream Port only. In combination with the Slot Power Limit
                                                    Scale value, specifies the upper limit on power supplied by slot.
                        Captured Slot Power
                25:18                        RO
                        Limit Value                 This value is set by the Set_Slot_Power_Limit message or hardwired to 00h.
                                                    Reset to 00h.
                                                    It applies to Upstream Port only. Specifies the scale used for the Slot Power
                                                    Limit Value.
                        Captured Slot Power
                27:26                        RO
                        Limit Scale                 This value is set by the Set_Slot_Power_Limit message or hardwired to 00b.
                                                    Reset to 00b.
                31:28   Reserved             RO     Reset to 0h.
                                                  Page 50 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                              PI7C9X20303SL
                                                                                   3Port-3Lane PCI Express® Switch
                                                                                                           SlimLineTM Family
                                                                                                                       Datasheet
7.2.68        DEVICE CONTROL REGISTER – OFFSET E8h
                BIT     FUNCTION              TYPE   DESCRIPTION
                                                     0b: Disable Correctable Error Reporting
                        Correctable Error            1b: Enable Correctable Error Reporting
                0                              RW
                        Reporting Enable
                                                     Reset to 0b.
                                                     0b: Disable Non-Fatal Error Reporting
                        Non-Fatal Error              1b: Enable Non-Fatal Error Reporting
                1                              RW
                        Reporting Enable
                                                     Reset to 0b.
                                                     0b: Disable Fatal Error Reporting
                        Fatal Error Reporting        1b: Enable Fatal Error Reporting
                2                              RW
                        Enable
                                                     Reset to 0b.
                                                     0b: Disable Unsupported Request Reporting
                        Unsupported Request          1b: Enable Unsupported Request Reporting
                3                              RW
                        Reporting Enable
                                                     Reset to 0b.
                                                     When set, it permits the device to set the Relaxed Ordering bit in the attribute
                                                     field of transaction. Since the Switch can not either act as a requester or alter
                        Enable Relaxed
                4                               RO   the content of packet it forwards, this bit always returns ‘0’ when read.
                        Ordering
                                                     Reset to 0b.
                                                     This field sets maximum TLP payload size for the device. Permissible values
                                                     that can be programmed are indicated by the Max_Payload_Size Supported in
                                                     the Device Capabilities register. Any value exceeding the Max_Payload_Size
                7:5     Max_Payload_Size       RW    Supported written to this register results into clamping to the
                                                     Max_Payload_Size Supported value.
                                                     Reset to 000b.
                                                     Does not apply to PCI Express Switch. Returns ‘0’ when read.
                        Extended Tag Field
                8                              RW
                        Enable
                                                     Reset to 0.
                                                     Does not apply to PCI Express Switch. Returns ‘0’ when read.
                        Phantom Function
                9                              RW
                        Enable
                                                     Reset to 0b.
                                                     When set, indicates that a device is enabled to draw AUX power independent
                        Auxiliary (AUX)              of PME AUX power.
                10                             RWS
                        Power PM Enable
                                                     Reset to 0b.
                                                     When set, it permits to set the No Snoop bit in the attribute field of
                                                     transaction. Since the Switch can not either act as a requester or alter the
                11      Enable No Snoop         RO   content of packet it forwards, this bit always returns ‘0’ when read.
                                                     Reset to 0b.
                                                     This field sets the maximum Read Request size for the device as a Requester.
                                                     Since the Switch does not generate read request by itself, these bits are
                        Max_Read_
                14:12                           RO   hardwired to 000b.
                        Request_Size
                                                     Reset to 000b.
                15      Reserved                RO   Reset to 0b.
7.2.69        DEVICE STATUS REGISTER – OFFSET E8h
                BIT     FUNCTION              TYPE   DESCRIPTION
                                                     Asserted when correctable error is detected. Errors are logged in this register
                                                     regardless of whether error reporting is enabled or not in the Device Control
                        Correctable Error
                16                            RW1C   register.
                        Detected
                                                     Reset to 0b.
                                                   Page 51 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                            PI7C9X20303SL
                                                                                 3Port-3Lane PCI Express® Switch
                                                                                                         SlimLineTM Family
                                                                                                                      Datasheet
                BIT     FUNCTION             TYPE   DESCRIPTION
                                                    Asserted when non-fatal error is detected. Errors are logged in this register
                                                    regardless of whether error reporting is enabled or not in the Device Control
                        Non-Fatal Error
                17                           RW1C   register.
                        Detected
                                                    Reset to 0b.
                                                    Asserted when fatal error is detected. Errors are logged in this register
                                                    regardless of whether error reporting is enabled or not in the Device Control
                18      Fatal Error Detected RW1C   register.
                                                    Reset to 0b.
                                                    Asserted when unsupported request is detected. Errors are logged in this
                                                    register regardless of whether error reporting is enabled or not in the Device
                        Unsupported Request
                19                           RW1C   Control register.
                        Detected
                                                    Reset to 0b.
                                                    Asserted when the AUX power is detected by the Switch
                        AUX Power
                20                            RO
                        Detected
                                                    Reset to 1b.
                                                    Each port of Switch does not issue Non-posted Requests on its own behalf, so
                                                    this bit is hardwired to 0b.
                21      Transactions Pending  RO
                                                    Reset to 0b.
                31:22   Reserved              RO    Reset to 0.
7.2.70        LINK CAPABILITIES REGISTER – OFFSET ECh
                BIT     FUNCTION             TYPE   DESCRIPTION
                        Maximum Link                Read as 0001b to indicate the maximum speed of the Express link is 2.5 Gb/s.
                3:0                           RO
                        Speed
                                                    Indicates the maximum width of the given PCIe Link. The width of each port
                                                    is determined by strapped pin or EEPROM pre-loaded value.
                        Maximum Link
                9:4                           RO
                        Width                       Reset to 000001b (x1) for Port 0.
                                                    Reset to 000001b (x1) for Port 1.
                                                    Reset to 000001b (x1) for Port 2.
                                                    Indicates the level of ASPM supported on the given PCIe Link. Each port of
                        Active State Power          Switch supports L0s and L1 entry. The default value may be changed by
                11:10   Management            RO    SMBus or auto-loading from EEPROM.
                        (ASPM) Support
                                                    Reset to 01b.
                                                    Indicates the L0s exit latency for the given PCIe Link.
                                                    The length of time this port requires to complete transition from L0s to L0 is
                                                    in the range of 256ns to less than 512ns. The default value may be changed
                14:12   L0s Exit Latency      RO
                                                    by SMBus or auto-loading from EEPROM.
                                                    Reset to 011b.
                                                    Indicates the L1 exit latency for the given PCIe Link.
                                                    The length of time this port requires to complete transition from L1 to L0 is in
                        L1 Exit                     the range of 16us to less than 32us. The default value may be changed by
                17:15                         RO
                        Latency                     SMBus or auto-loading from EEPROM.
                                                    Reset to 000b.
                18      Reserved              RO    Reset to 0b.
                                                    For a Downstream port, this bit must be set to 1b if the component supports
                                                    the optional capability of detecting and reporting a Surprise Down error
                                                    condition.
                        Surprise Down Error
                19                            RO
                        Reporting Capable           For Upstream Ports, which does not support this optional capability, this bit
                                                    must be hardwired to 0b.
                                                    Rest to 0b.
                                                  Page 52 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                            PI7C9X20303SL
                                                                                3Port-3Lane PCI Express® Switch
                                                                                                         SlimLineTM Family
                                                                                                                      Datasheet
                BIT     FUNCTION           TYPE   DESCRIPTION
                                                  For a Downstream Port, this bit must be set to 1b if the component supports
                                                  the optional capability of reporting the DL_Active state of the Data Link
                                                  Control and Management State Machine. For a hot-plug capable Downstream
                        Data Link Layer           Port, this bit must be set to 1b.
                20      Active Reporting    RO
                        Capable                   For Upstream Port, this bit must be hardwired to 0b.
                                                  Reset to 0b for upstream port.
                                                  Reset to 1b for downstream ports.
                23:21   Reserved            R0    Reset to 000b
                                                  Indicates the PCIe Port Number for the given PCIe Link. The default value
                                                  may be changed by SMBus or auto-loading from EEPROM.
                31:24   Port Number         RO
                                                  Reset to 00h for Port 0.
                                                  Reset to 01h for Port 1.
                                                  Reset to 02h for Port 2.
7.2.71        LINK CONTROL REGISTER – OFFSET F0h
                BIT     FUNCTION           TYPE   DESCRIPTION
                                                  00b: ASPM is Disabled
                                                  01b: L0s Entry Enabled
                                                  10b: L1 Entry Enabled
                        Active State Power        11b: L0s and L1 Entry Enabled
                1:0     Management          RW
                        (ASPM) Control            Note that the receiver must be capable of entering L0s even when the field is
                                                  disabled.
                                                  Reset to 00b.
                2       Reserved            RO    Reset to 0b.
                                                  Does not apply to PCI Express Switch. Returns ‘0’ when read.
                        Read Completion
                3                           RO
                        Boundary (RCB)
                                                  Reset to 0b.
                                                  At upstream port, it is not allowed to disable the link, so this bit is hardwired
                                                  to ‘0’. For downstream ports, it disables the link when this bit is set.
                4       Link Disable        RW
                                                  Reset to 0b.
                                                  At upstream port, it is not allowed to retrain the link, so this bit is hardwired
                                                  to 0b. For downstream ports, it initiates Link Retraining when this bit is set.
                5       Retrain Link        RW
                                                  This bit always returns 0b when read.
                                                  0b: The components at both ends of a link are operating with asynchronous
                                                      reference clock
                        Common Clock              1b: The components at both ends of a link are operating with a distributed
                6                           RW
                        Configuration                 common reference clock
                                                  Reset to 0b.
                                                  When set, it transmits 4096 FTS ordered sets in the L0s state for entering L0
                                                  state and transmits 1024 TS1 ordered sets in the L1 state for entering L0 state.
                7       Extended Synch      RW
                                                  Reset to 0b.
                15:8    Reserved            RO    Reset to 00h.
7.2.72        LINK STATUS REGISTER – OFFSET F0h
                BIT     FUNCTION           TYPE   DESCRIPTION
                                                  Read as 0001b to indicate the negotiated speed of the Express link is 2.5
                19:16   Link Speed          RO
                                                  Gb/s.
                                                Page 53 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                              PI7C9X20303SL
                                                                                  3Port-3Lane PCI Express® Switch
                                                                                                           SlimLineTM Family
                                                                                                                      Datasheet
                BIT     FUNCTION            TYPE    DESCRIPTION
                                                    Indicates the negotiated width of the given PCIe link.
                        Negotiated Link
                25:20                        RO
                        Width
                                                    Reset to 000001b (x1).
                                                    When set, indicates a Link training error occurred.
                                                    This bit is cleared by hardware upon successful training of the link to the L0
                26      Training Error       RO     link state.
                                                    Reset to 0b.
                                                    When set, indicates the link training is in progress. Hardware clears this bit
                                                    once link training is complete.
                27      Link Training        RO
                                                    Reset to 0b.
                                                    0b: the Switch uses an independent clock irrespective of the presence of a
                                                         reference on the connector
                                                    1b: the Switch uses the same reference clock that the platform provides on the
                                                         connector
                        Slot Clock
                28                          HwInt
                        Configuration
                                                    The default value may be changed by the status of strapped pin, SMBus, or
                                                    auto-loading from EEPROM.
                                                    Reset to 0b.
                                                   Indicates the status of the Data Link Control and Management State Machine.
                        Data Link Layer            It returns a 1b to indicate the DL_Active state, 0b otherwise.
                29                           RO
                        Link Active
                                                   Reset to 0b.
                31:30   Reserved             RO    Reset to 00b.
7.2.73        SLOT CAPABILITIES REGISTER (Downstream Port Only) – OFFSET F4h
                BIT     FUNCTION            TYPE    DESCRIPTION
                                                    When set, it indicates that an Attention Button is implemented on the chassis
                                                    for this slot. The default value may be changed by SMBus or auto-loading
                        Attention Button
                0                            RO     from EEPROM.
                        Present
                                                    Reset to 0b.
                                                    When set, it indicates that a Power Controller is implemented for this slot.
                                                    The default value may be changed by SMBus or auto-loading from
                        Power Controller
                1                            RO     EEPROM.
                        Present
                                                    Reset to 0b.
                2       Reserved             RO     Reset to 0b.
                                                    When set, it indicates that an Attention Indicator is implemented on the
                                                    chassis for this slot. The default value may be changed by SMBus or auto-
                        Attention Indicator
                3                            RO     loading from EEPROM.
                        Present
                                                    Reset to 0b.
                                                    When set, it indicates that a Power Indicator is implemented on the chassis
                                                    for this slot. The default value may be changed by SMBus or auto-loading
                        Power Indicator
                4                            RO     from EEPROM.
                        Present
                                                    Reset to 0b.
                                                    When set, it indicates that a device present in this slot might be removed from
                                                    the system without any prior notification. The default value may be changed
                5       Hot-Plug Surprise    RO     by SMBus or auto-loading from EEPROM.
                                                    Reset to 0b.
                                                    When set, it indicates that this slot is capable of supporting Hot-Plug
                6       Hot-Plug Capable    HwInt   operation. The default value may be changed by the status of strapped pin or
                                                    auto-loading from EEPROM.
                                                  Page 54 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                             PI7C9X20303SL
                                                                                  3Port-3Lane PCI Express® Switch
                                                                                                          SlimLineTM Family
                                                                                                                      Datasheet
                BIT     FUNCTION             TYPE   DESCRIPTION
                                                    It applies to Downstream Port only. In combination with the Slot Power Limit
                                                    Scale value, specifies the upper limit on power supplied by slot. Writes to this
                        Slot Power Limit            register also cause the Port to send the Set_Slot_Power_Limit message. The
                14:7                          RW
                        Value                       default value may be changed by SMBus or auto-loading from EEPROM.
                                                    Reset to 00h.
                                                    It applies to Downstream Port only. Specifies the scale used for the Slot
                                                    Power Limit Value. Writes to this register also cause the Port to send the
                        Slot Power Limit            Set_Slot_Power_Limit message. The default value may be changed by
                16:15                         RW
                        Scale                       SMBus or auto-loading from EEPROM.
                                                    Reset to 00b.
                18:17   Reserved              RO    Reset to 00b.
                                                    It indicates the physical slot number attached to this Port. The default value
                        Physical Slot               may be changed by SMBus or auto-loading from EEPROM.
                31:19                         RO
                        Number
                                                    Reset to 0.
7.2.74        SLOT CONTROL REGISTER (Downstream Port Only) – OFFSET F8h
                BIT     FUNCTION             TYPE   DESCRIPTION
                                                    When set, it enables the generation of Hot-Plug interrupt or wakeup event on
                        Attention Button            an attention button pressed event.
                0                             RW
                        Pressed Enable
                                                    Reset to 0b.
                                                    When set, it enables the generation of Hot-Plug interrupt or wakeup event on
                        Power Fault Detected        a power fault event.
                1                             RW
                        Enable
                                                    Reset to 0b.
                2       Reserved              RO    Reset to 0b.
                                                    When set, it enables the generation of Hot-Plug interrupt or wakeup event on
                        Presence Detect             a presence detect changed event.
                3                             RW
                        Changed Enable
                                                    Reset to 0b.
                                                    When set, it enables the generation of Hot-Plug interrupt when the Hot-Plug
                        Command
                                                    Controller completes a command.
                4       Completed Interrupt   RW
                        Enable
                                                    Reset to 0b.
                                                    When set, it enables generation of Hot-Plug interrupt on enabled Hot-Plug
                        Hot-Plug Interrupt          events.
                5                             RW
                        Enable
                                                    Reset to 0b.
                                                    Controls the display of Attention Indicator.
                                                    00b: Reserved
                                                    01b: On
                                                    10b: Blink
                        Attention Indicator
                7:6                           RW    11b: Off
                        Control
                                                    Writes to this register also cause the Port to send the
                                                    ATTENTION_INDICATOR_* Messages.
                                                    Reset to 11b.
                                                  Page 55 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                               PI7C9X20303SL
                                                                                   3Port-3Lane PCI Express® Switch
                                                                                                           SlimLineTM Family
                                                                                                                        Datasheet
                BIT     FUNCTION              TYPE   DESCRIPTION
                                                     Controls the display of Power Indicator.
                                                     00b: Reserved
                                                     01b: On
                                                     10b: Blink
                        Power Indicator
                9:8                            RW    11b: Off
                        Control
                                                     Writes to this register also cause the Port to send the
                                                     POWER_INDICATOR_* Messages.
                                                     Reset to 11b.
                                                     0b: reset the power state of the slot (Power On)
                        Power Controller             1b: set the power state of the slot (Power Off)
                10                             RW
                        Control
                                                     Reset to 0b.
                11      Reserved               RO    Reset to 0b.
                                                     If the Data Link Layer Link Active capability is implemented, when set to 1b,
                        Data Link Layer              this field enables software notification when Data Link Layer Link Active
                12      State Changed          RW    field is changed.
                        Enable
                                                     Reset to 0b.
                15:13   Reserved               RO    Reset to 000b
7.2.75        SLOT STATUS REGISTER (Downstream Port Only) – OFFSET F8h
                BIT     FUNCTION              TYPE   DESCRIPTION
                                                     When set, it indicates the Attention Button is pressed.
                        Attention Button
                16                            RW1C
                        Pressed
                                                     Reset to 0b.
                                                     When set, it indicates a Power Fault is detected.
                17      Power Fault Detected  RW1C
                                                     Reset to 0b.
                                                     When set, it indicates a MRL Sensor Changed is detected.
                        MRL Sensor
                18                             RO
                        Changed
                                                     Reset to 0b.
                                                     When set, it indicates a Presence Detect Changed is detected.
                        Presence Detect
                19                            RW1C
                        Changed
                                                     Reset to 0b.
                                                     When set, it indicates the Hot-Plug Controller completes an issued command.
                        Command
                20                            RW1C
                        Completed
                                                     Reset to 0b.
                                                     Reflects the status of MRL Sensor.
                                                     0b: MRL Closed
                21      MRL Sensor State       RO
                                                     1b: MRL Opened
                                                     Reset to 0b.
                                                     Indicates the presence of a card in the slot.
                                                     0b: Slot Empty
                                                     1b: Card Present in slot
                22      Presence Detect State  RO
                                                     This register is implemented on all Downstream Ports that implement slots.
                                                     For Downstream Ports not connected to slots (where the Slot Implemented bit
                                                     of the PCI Express Capabilities register is 0b), this bit returns 1b.
                                                     Reset to 1b.
                23      Reserved               RO    Reset to 0.
                        Data Link Layer              This bit is set when the value reported in the Data Link Layer Link Active
                24                            RW1C
                        State Changed                field of the Link Status register is changed.
                31:25   Reserved               RO    Reset to 0
                                                   Page 56 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                              PI7C9X20303SL
                                                                                   3Port-3Lane PCI Express® Switch
                                                                                                          SlimLineTM Family
                                                                                                                       Datasheet
7.2.76        PCI EXPRESS ADVANCED ERROR REPORTING CAPABILITY ID
              REGISTER – OFFSET 100h
                BIT     FUNCTION              TYPE    DESCRIPTION
                        Extended                      Read as 0001h to indicate that these are PCI express extended capability
                15:0                            RO
                        Capabilities ID               registers for advance error reporting.
7.2.77        CAPABILITY VERSION – OFFSET 100h
                BIT     FUNCTION              TYPE    DESCRIPTION
                                                      Read as 1h. Indicates PCI-SIG defined PCI Express capability structure
                                                      version number.
                19:16   Capability Version      RO
                                                      Reset to 1h.
7.2.78        NEXT ITEM POINTER REGISTER – OFFSET 100h
                BIT     FUNCTION              TYPE    DESCRIPTION
                                                      Pointer points to the PCI Express Extended VC capability register (140h).
                        Next Capability
                31:20                           RO
                        Offset                        Reset to 140h (upstream port).
                                                      Reset to 20Ch (downstream port).
7.2.79        UNCORRECTABLE ERROR STATUS REGISTER – OFFSET 104h
                BIT     FUNCTION               TYPE    DESCRIPTION
                                                       When set, indicates that the Training Error event has occurred.
                0       Training Error Status RW1CS
                                                       Reset to 0b.
                3:1     Reserved                RO     Reset to 000b.
                                                       When set, indicates that the Data Link Protocol Error event has occurred.
                        Data Link Protocol
                4                             RW1CS
                        Error Status
                                                       Reset to 0b.
                11:5    Reserved                RO     Reset to 0.
                                                       When set, indicates that a Poisoned TLP has been received or generated.
                12      Poisoned TLP Status   RW1CS
                                                       Reset to 0b.
                                                       When set, indicates that the Flow Control Protocol Error event has occurred.
                        Flow Control
                13                            RW1CS
                        Protocol Error Status
                                                       Reset to 0b.
                                                       When set, indicates that the Completion Timeout event has occurred.
                        Completion Timeout
                14                            RW1CS
                        Status
                                                       Reset to 0b.
                                                       When set, indicates that the Completer Abort event has occurred.
                        Completer Abort
                15                            RW1CS
                        Status
                                                       Reset to 0b.
                                                       When set, indicates that the Unexpected Completion event has occurred.
                        Unexpected
                16                            RW1CS
                        Completion Status
                                                       Reset to 0b.
                                                       When set, indicates that the Receiver Overflow event has occurred.
                        Receiver Overflow
                17                            RW1CS
                        Status
                                                       Reset to 0b.
                                                       When set, indicates that a Malformed TLP has been received.
                        Malformed TLP
                18                            RW1CS
                        Status
                                                       Reset to 0b.
                                                    Page 57 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                           PI7C9X20303SL
                                                                                 3Port-3Lane PCI Express® Switch
                                                                                                        SlimLineTM Family
                                                                                                                   Datasheet
                BIT     FUNCTION             TYPE    DESCRIPTION
                                                     When set, indicates that an ECRC Error has been detected.
                19      ECRC Error Status   RW1CS
                                                     Reset to 0b.
                                                     When set, indicates that an Unsupported Request event has occurred.
                        Unsupported Request
                20                          RW1CS
                        Error Status
                                                     Reset to 0b.
                31:21   Reserved              RO     Reset to 0.
7.2.80        UNCORRECTABLE ERROR MASK REGISTER – OFFSET 108h
                BIT     FUNCTION            TYPE    DESCRIPTION
                                                    When set, the Training Error event is not logged in the Header Log register
                                                    and not issued as an Error Message to RC either.
                0       Training Error Mask  RWS
                                                    Reset to 0b.
                3:1     Reserved              RO    Reset to 000b.
                                                    When set, the Data Link Protocol Error event is not logged in the Header Log
                        Data Link Protocol          register and not issued as an Error Message to RC either.
                4                            RWS
                        Error Mask
                                                    Reset to 0b.
                11:5    Reserved              RO    Reset to 0.
                                                    When set, an event of Poisoned TLP has been received or generated is not
                                                    logged in the Header Log register and not issued as an Error Message to RC
                12      Poisoned TLP Mask    RWS    either.
                                                    Reset to 0b.
                                                    When set, the Flow Control Protocol Error event is not logged in the Header
                        Flow Control                Log register and not issued as an Error Message to RC either.
                13                           RWS
                        Protocol Error Mask
                                                    Reset to 0b.
                                                    When set, the Completion Timeout event is not logged in the Header Log
                        Completion Timeout          register and not issued as an Error Message to RC either.
                14                           RWS
                        Mask
                                                    Reset to 0b.
                                                    When set, the Completer Abort event is not logged in the Header Log register
                        Completer Abort             and not issued as an Error Message to RC either.
                15                           RWS
                        Mask
                                                    Reset to 0b.
                                                    When set, the Unexpected Completion event is not logged in the Header Log
                        Unexpected                  register and not issued as an Error Message to RC either.
                16                           RWS
                        Completion Mask
                                                    Reset to 0b.
                                                    When set, the Receiver Overflow event is not logged in the Header Log
                        Receiver Overflow           register and not issued as an Error Message to RC either.
                17                           RWS
                        Mask
                                                    Reset to 0b.
                                                    When set, an event of Malformed TLP has been received is not logged in the
                        Malformed TLP               Header Log register and not issued as an Error Message to RC either.
                18                           RWS
                        Mask
                                                    Reset to 0b.
                                                    When set, an event of ECRC Error has been detected is not logged in the
                                                    Header Log register and not issued as an Error Message to RC either.
                19      ECRC Error Mask      RWS
                                                    Reset to 0b.
                                                    When set, the Unsupported Request event is not logged in the Header Log
                        Unsupported Request         register and not issued as an Error Message to RC either.
                20                           RWS
                        Error Mask
                                                    Reset to 0b.
                31:21   Reserved              RO    Reset to 0.
                                                  Page 58 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                           PI7C9X20303SL
                                                                                 3Port-3Lane PCI Express® Switch
                                                                                                       SlimLineTM Family
                                                                                                                    Datasheet
7.2.81        UNCORRECTABLE ERROR SEVERITY REGISTER – OFFSET 10Ch
                BIT     FUNCTION              TYPE    DESCRIPTION
                                                      0b: Non-Fatal
                        Training Error                1b: Fatal
                0                              RWS
                        Severity
                                                      Reset to 1b.
                3:1     Reserved                RO    Reset to 000b.
                                                      0b: Non-Fatal
                        Data Link Protocol            1b: Fatal
                4                              RWS
                        Error Severity
                                                      Reset to 1b.
                11:5    Reserved                RO    Reset to 0.
                                                      0b: Non-Fatal
                        Poisoned TLP                  1b: Fatal
                12                             RWS
                        Severity
                                                      Reset to 0b.
                                                      0b: Non-Fatal
                        Flow Control
                                                      1b: Fatal
                13      Protocol Error         RWS
                        Severity
                                                      Reset to 1b.
                                                      0b: Non-Fatal
                        Completion Timeout            1b: Fatal
                14                             RWS
                        Error Severity
                                                      Reset to 0b.
                                                      0b: Non-Fatal
                        Completer Abort               1b: Fatal
                15                             RWS
                        Severity
                                                      Reset to 0b.
                                                      0b: Non-Fatal
                        Unexpected                    1b: Fatal
                16                             RWS
                        Completion Severity
                                                      Reset to 0b.
                                                      0b: Non-Fatal
                        Receiver Overflow             1b: Fatal
                17                             RWS
                        Severity
                                                      Reset to 1b.
                                                      0b: Non-Fatal
                        Malformed TLP                 1b: Fatal
                18                             RWS
                        Severity
                                                      Reset to 1b.
                                                      0b: Non-Fatal
                                                      1b: Fatal
                19      ECRC Error Severity    RWS
                                                      Reset to 0.
                                                      0b: Non-Fatal
                        Unsupported Request           1b: Fatal
                20                             RWS
                        Error Severity
                                                      Reset to 0b.
                31:21   Reserved                RO    Reset to 0.
7.2.82        CORRECTABLE ERROR STATUS REGISTER – OFFSET 110 h
                BIT     FUNCTION               TYPE   DESCRIPTION
                                                      When set, the Receiver Error event is detected.
                0       Receiver Error Status RW1CS
                                                      Reset to 0b.
                5:1     Reserved                RO    Reset to 00000b.
                                                      When set, the event of Bad TLP has been received is detected.
                6       Bad TLP Status        RW1CS
                                                      Reset to 0b.
                                                    Page 59 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                                PI7C9X20303SL
                                                                                  3Port-3Lane PCI Express® Switch
                                                                                                             SlimLineTM Family
                                                                                                                        Datasheet
                BIT     FUNCTION             TYPE    DESCRIPTION
                                                     When set, the event of Bad DLLP has been received is detected.
                7       Bad DLLP Status     RW1CS
                                                     Reset to 0b.
                                                     When set, the REPLAY_NUM Rollover event is detected.
                        REPLAY_NUM
                8                           RW1CS
                        Rollover status
                                                     Reset to 0b.
                11:9    Reserved              RO     Reset to 000b.
                                                     When set, the Replay Timer Timeout event is detected.
                        Replay Timer
                12                          RW1CS
                        Timeout status
                                                     Reset to 0b.
                                                     When set, the Advisory Non-Fatal Error event is detected.
                        Advisory Non-Fatal
                13                          RW1CS
                        Error status
                                                     Reset to 0b.
                31:14   Reserved              RO     Reset to 0b.
7.2.83        CORRECTABLE ERROR MASK REGISTER – OFFSET 114 h
                BIT     FUNCTION            TYPE    DESCRIPTION
                                                    When set, the Receiver Error event is not logged in the Header Log register
                                                    and not issued as an Error Message to RC either.
                0       Receiver Error Mask  RWS
                                                    Reset to 0b.
                5:1     Reserved              RO    Reset to 00000b.
                                                    When set, the event of Bad TLP has been received is not logged in the Header
                                                    Log register and not issued as an Error Message to RC either.
                6       Bad TLP Mask         RWS
                                                    Reset to 0b.
                                                    When set, the event of Bad DLLP has been received is not logged in the
                                                    Header Log register and not issued as an Error Message to RC either.
                7       Bad DLLP Mask        RWS
                                                    Reset to 0b.
                                                    When set, the REPLAY_NUM Rollover event is not logged in the Header
                        REPLAY_NUM                  Log register and not issued as an Error Message to RC either.
                8                            RWS
                        Rollover Mask
                                                    Reset to 0b.
                11:9    Reserved              RO    Reset to 000b.
                                                    When set, the Replay Timer Timeout event is not logged in the Header Log
                        Replay Timer                register and not issued as an Error Message to RC either.
                12                           RWS
                        Timeout Mask
                                                    Reset to 0b.
                                                    When set, the Advisory Non-Fatal Error event is not logged in the Header
                        Advisory Non-Fatal          Long register and not issued as an Error Message to RC either.
                13                           RWS
                        Error Mask
                                                    Reset to 1b.
                31:14   Reserved              RO    Reset to 0.
7.2.84        ADVANCE ERROR CAPABILITIES AND CONTROL REGISTER – OFFSET
              118h
                BIT     FUNCTION            TYPE    DESCRIPTION
                                                    It indicates the bit position of the first error reported in the Uncorrectable
                                                    Error Status register.
                4:0     First Error Pointer  ROS
                                                    Reset to 00000b.
                                                    When set, it indicates the Switch has the capability to generate ECRC.
                        ECRC Generation
                5                             RO
                        Capable
                                                    Reset to 1b.
                                                  Page 60 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                           PI7C9X20303SL
                                                                                3Port-3Lane PCI Express® Switch
                                                                                                       SlimLineTM Family
                                                                                                                  Datasheet
                BIT     FUNCTION           TYPE   DESCRIPTION
                                                  When set, it enables the generation of ECRC when needed.
                        ECRC Generation
                6                          RWS
                        Enable
                                                  Reset to 0b.
                                                  When set, it indicates the Switch has the capability to check ECRC.
                        ECRC Check
                7                           RO
                        Capable
                                                  Reset to 1b.
                                                  When set, the function of checking ECRC is enabled.
                8       ECRC Check Enable  RWS
                                                  Reset to 0b.
                31:9    Reserved            RO    Reset to 0.
7.2.85        HEADER LOG REGISTER – OFFSET From 11Ch to 128h
                BIT     FUNCTION           TYPE   DESCRIPTION
                31:0    1st DWORD           ROS   Hold the 1st DWORD of TLP Header. The Head byte is in big endian.
                63:32   2nd DWORD           ROS   Hold the 2nd DWORD of TLP Header. The Head byte is in big endian.
                95:64   3rd DWORD           ROS   Hold the 3rd DWORD of TLP Header. The Head byte is in big endian.
                127:96  4th DWORD           ROS   Hold the 4th DWORD of TLP Header. The Head byte is in big endian.
7.2.86        PCI EXPRESS VIRTUAL CHANNEL CAPABILITY ID REGISTER – OFFSET
              140h (Upstream Only)
                BIT     FUNCTION           TYPE   DESCRIPTION
                        Extended                  Read as 0002h to indicate that these are PCI express extended capability
                15:0                        RO
                        Capabilities ID           registers for virtual channel.
7.2.87        CAPABILITY VERSION – OFFSET 140h (Upstream Only)
                BIT     FUNCTION           TYPE   DESCRIPTION
                                                  Read as 1h. Indicates PCIe Base Specification compliance.
                19:16   Capability Version  RO
                                                  Reset to 1h.
7.2.88        NEXT ITEM POINTER REGISTER – OFFSET 140h (Upstream Only)
                BIT     FUNCTION           TYPE   DESCRIPTION
                                                  Pointer points to the PCI Express Power Budgeting Capability register
                        Next Capability           (20Ch).
                31:20                       RO
                        Offset
                                                  Reset to 20Ch.
7.2.89        PORT VC CAPABILITY REGISTER 1 – OFFSET 144h (Upstream Only)
                BIT     FUNCTION           TYPE   DESCRIPTION
                                                  It indicates the number of extended Virtual Channels in addition to the default
                                                  VC supported by the Switch.
                2:0     Extended VC Count   RO
                                                  Reset to 000b.
                3       Reserved            RO    Reset to 0b.
                                                Page 61 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                             PI7C9X20303SL
                                                                                  3Port-3Lane PCI Express® Switch
                                                                                                         SlimLineTM Family
                                                                                                                      Datasheet
                BIT     FUNCTION             TYPE   DESCRIPTION
                                                    It indicates the number of extended Virtual Channels in addition to the default
                                                    VC belonging to the low-priority VC (LPVC) group. The default value may
                        Low Priority
                6:4                           RO    be changed by SMBus or auto-loading from EEPROM.
                        Extended VC Count
                                                    Reset to 000b.
                7       Reserved              RO    Reset to 0b.
                                                    It indicates the reference clock for Virtual Channels that support time-based
                                                    WRR Port Arbitration. Defined encoding is 00b for 100 ns reference clock.
                9:8     Reference Clock       RO
                                                    Reset to 00b.
                                                    Read as 10b to indicate the size of Port Arbitration table entry in the device is
                        Port Arbitration            4 bits.
                11:10                         RO
                        Table Entry Size
                                                    Reset to 10b.
                31:12   Reserved              RO    Reset to 0.
7.2.90        PORT VC CAPABILITY REGISTER 2 – OFFSET 148h (Upstream Only)
                BIT     FUNCTION             TYPE   DESCRIPTION
                                                    It indicates the types of VC Arbitration supported by the device for the LPVC
                                                    group. This field is valid when LPVC is greater than 0. The Switch supports
                        VC Arbitration              Hardware fixed arbitration scheme, e.g., Round Robin and Weight Round
                7:0                           RO
                        Capability                  Robin arbitration with 32 phases in LPVC.
                                                    Reset to 00000000b.
                23:8    Reserved              RO    Reset to 0.
                                                    It indicates the location of the VC Arbitration Table as an offset from the base
                                                    address of the Virtual Channel Capability register in the unit of DQWD (16
                        VC Arbitration Table
                31:24                         RO    bytes).
                        Offset
                                                    Reset to 00h.
7.2.91        PORT VC CONTROL REGISTER – OFFSET 14Ch (Upstream Only)
                BIT     FUNCTION             TYPE   DESCRIPTION
                                                    When set, the programmed VC Arbitration Table is applied to the hardware.
                        Load VC Arbitration         This bit always returns 0b when read.
                0                             RW
                        Table
                                                    Reset to 0b.
                                                    This field is used to configure the VC Arbitration by selecting one of the
                                                    supported VC Arbitration schemes. The valid values for the schemes
                        VC Arbitration              supported by Switch are 0b and 1b. Other value than these written into this
                3:1                           RW
                        Select                      register will be treated as default.
                                                    Reset to 0b.
                15:4    Reserved              RO    Reset to 0.
7.2.92        PORT VC STATUS REGISTER – OFFSET 14Ch (Upstream Only)
                BIT     FUNCTION             TYPE   DESCRIPTION
                                                    When set, it indicates that any entry of the VC Arbitration Table is written by
                                                    software. This bit is cleared when hardware finishes loading values stored in
                        VC Arbitration Table
                16                            RO    the VC Arbitration Table after the bit of “Load VC Arbitration Table” is set.
                        Status
                                                    Reset to 0b.
                31:17   Reserved              RO    Reset to 0.
                                                  Page 62 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                               PI7C9X20303SL
                                                                                   3Port-3Lane PCI Express® Switch
                                                                                                            SlimLineTM Family
                                                                                                                        Datasheet
7.2.93        VC RESOURCE CAPABILITY REGISTER (0) – OFFSET 150h (Upstream
              Only)
                BIT     FUNCTION              TYPE   DESCRIPTION
                                                     It indicates the types of Port Arbitration supported by the VC resource. The
                                                     Switch supports Hardware fixed arbitration scheme, e.g., Round Robin,
                        Port Arbitration             Weight Round Robin (WRR) arbitration with 128 phases (3~4 enabled ports)
                7:0                            RO
                        Capability                   and Time-based WRR with 128 phases (3~4 enabled ports).
                                                     Reset to 00001001b.
                13:8    Reserved               RO    Reset to 000000b.
                                                     When set, it indicates the VC resource only supports transaction optimized
                        Advanced Packet              for Advanced Packet Switching (AS).
                14                             RO
                        Switching
                                                     Reset to 0b.
                                                     This bit is not applied to PCIe Switch.
                        Reject Snoop
                15                             RO
                        Transactions
                                                     Reset to 0b.
                                                     It indicates the maximum numbers of time slots (minus one) are allocated for
                                                     Isochronous traffic. The default value may be changed by SMBus or auto-
                        Maximum Time
                22:16                          RO    loading from EEPROM.
                        Slots
                                                     Reset to 7Fh.
                23      Reserved               RO    Reset to 0b.
                                                     It indicates the location of the Port Arbitration Table (n) as an offset from the
                                                     base address of the Virtual Channel Capability register in the unit of DQWD
                        Port Arbitration
                31:24                          RO    (16 bytes).
                        Table Offset
                                                     Reset to 04h for Port Arbitration Table (0).
7.2.94        VC RESOURCE CONTROL REGISTER (0) – OFFSET 154h (Upstream
              Only)
                BIT     FUNCTION              TYPE   DESCRIPTION
                                                     This field indicates the TCs that are mapped to the VC resource. Bit locations
                                                     within this field correspond to TC values. When the bits in this field are set, it
                                                     means that the corresponding TCs are mapped to the VC resource. The
                7:0     TC/VC Map              RW
                                                     default value may be changed by SMBus or auto-loading from EEPROM.
                                                     Reset to FFh.
                15:8    Reserved               RO    Reset to 00h.
                                                     When set, the programmed Port Arbitration Table is applied to the hardware.
                        Load Port Arbitration        This bit always returns 0b when read.
                16                             RW
                        Table
                                                     Reset to 0b.
                                                     This field is used to configure the Port Arbitration by selecting one of the
                                                     supported Port Arbitration schemes. The permissible values for the schemes
                        Port Arbitration             supported by Switch are 000b and 011b at VC0, other value than these
                19:17                          RW
                        Select                       written into this register will be treated as default.
                                                     Reset to 000b.
                23:20   Reserved               RO    Reset to 0h.
                                                     This field assigns a VC ID to the VC resource.
                26:24   VC ID                  RO
                                                     Reset to 000b.
                30:27   Reserved               RO    Reset to 0h.
                                                     0b: it disables this Virtual Channel
                                                     1b: it enables this Virtual Channel
                31      VC Enable              RW
                                                     Reset to 1b.
                                                   Page 63 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                                         PI7C9X20303SL
                                                                                             3Port-3Lane PCI Express® Switch
                                                                                                                      SlimLineTM Family
                                                                                                                                  Datasheet
7.2.95        VC RESOURCE STATUS REGISTER (0) – OFFSET 158h (Upstream Only)
                BIT        FUNCTION                  TYPE      DESCRIPTION
                15:0       Reserved                   RO       Reset to 0000h.
                                                               When set, it indicates that any entry of the Port Arbitration Table is written by
                                                               software. This bit is cleared when hardware finishes loading values stored in
                           Port Arbitration
                16                                    RO       the Port Arbitration Table after the bit of “Load Port Arbitration Table” is set.
                           Table Status
                                                               Reset to 0b.
                                                               When set, it indicates that the VC resource is still in the process of
                           VC Negotiation                      negotiation. This bit is cleared after the VC negotiation is complete.
                17                                    RO
                           Pending
                                                               Reset to 0b.
                31:18      Reserved                   RO       Reset to 0.
7.2.96        PORT ARBITRATION TABLE REGISTER (0) – OFFSET 180h-1BCh
              (Upstream Only)
              The Port arbitration table is a read-write register array that contains a table for Port arbitration. Each
              table entry allocates two bits to represent Port Number. The table entry size is dependent on the
              number of enabled ports (refer to bit 10 and 11 of Port VC capability register 1). The arbitration table
              contains 128 entries if three or four ports are to be enabled. The following table shows the register
              array layout for the size of entry equal to two.
              Table 7-1 Table Entry Size in 4 Bits
                   63 - 56    55 - 48        47 - 40     39 - 32       31 - 24        23 - 16        15 - 8        7-0          Byte Location
                    Phase      Phase          Phase      Phase          Phase          Phase         Phase        Phase
                                                                                                                                      00h
                   [15:14]    [13:12]        [11:10]      [9:8]          [7:6]         [5:4]          [3:2]        [1:0]
                    Phase      Phase          Phase      Phase          Phase          Phase         Phase        Phase
                                                                                                                                      08h
                   [31:30]    [29:28]        [27:26]    [25:24]        [23:22]        [21:20]       [19:18]      [17:16]
                    Phase      Phase          Phase      Phase          Phase          Phase         Phase        Phase
                                                                                                                                      10h
                   [47:46]    [45:44]        [43:42]    [41:40]        [39:38]        [37:36]       [35:34]      [33:32]
                    Phase      Phase          Phase      Phase          Phase          Phase         Phase        Phase
                                                                                                                                      18h
                   [63:62]    [61:60]        [59:58]    [57:56]        [55:54]        [53:52]       [51:50]      [49:48]
                    Phase      Phase          Phase      Phase          Phase          Phase         Phase        Phase
                                                                                                                                      20h
                   [79:78]    [77:76]        [75:74]    [73:72]        [71:70]        [69:68]       [67:66]      [65:64]
                    Phase      Phase          Phase      Phase          Phase          Phase         Phase        Phase
                                                                                                                                      28h
                   [95:94]    [93:92]        [91:90]    [89:88]        [87:86]        [85:84]       [83:82]      [81:80]
                    Phase      Phase          Phase      Phase          Phase          Phase         Phase        Phase
                                                                                                                                      30h
                 [111:110]   [109:108]      [107:106]  [105:104]      [103:102]     [101:100]       [99:98]      [97:96]
                    Phase      Phase          Phase      Phase          Phase          Phase         Phase        Phase
                                                                                                                                      38h
                 [127:126]   [125:124]      [123:122]  [121:120]      [119:118]     [117:116]      [115:114]    [113:112]
7.2.97        PCI EXPRESS POWER BUDGETING CAPABILITY ID REGISTER –
              OFFSET 20Ch
                BIT        FUNCTION                  TYPE      DESCRIPTION
                           Extended                            Read as 0004h to indicate that these are PCI express extended capability
                15:0                                  RO
                           Capabilities ID                     registers for power budgeting.
7.2.98        CAPABILITY VERSION – OFFSET 20Ch
                BIT        FUNCTION                  TYPE      DESCRIPTION
                                                           Page 64 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                           PI7C9X20303SL
                                                                                 3Port-3Lane PCI Express® Switch
                                                                                                        SlimLineTM Family
                                                                                                                   Datasheet
                BIT     FUNCTION           TYPE   DESCRIPTION
                                                  Read as 1h. Indicates PCIe Base Specification compliance.
                19:16   Capability Version  RO
                                                  Reset to 1h.
7.2.99        NEXT ITEM POINTER REGISTER – OFFSET 20Ch
                BIT     FUNCTION           TYPE   DESCRIPTION
                                                  Read as 000h. No other ECP registers.
                        Next Capability
                31:20                       RO
                        Offset
                                                  Reset to 000h.
7.2.100       DATA SELECT REGISTER – OFFSET 210h
                BIT     FUNCTION           TYPE   DESCRIPTION
                                                  It indexes the power budgeting data reported through the data register.
                                                  When 00h, it selects D0 Max power budget
                7:0     Data Selection      RW    When 01h, it selects D0 Sustained power budget
                                                  Other values would return zero power budgets, which means not supported
                                                  Reset to 00h.
                31:8    Reserved            RO    Reset to 000000h.
7.2.101       POWER BUDGETING DATA REGISTER – OFFSET 214h
                BIT     FUNCTION           TYPE   DESCRIPTION
                                                  It specifies the base power value in watts. This value represents the required
                                                  power budget in the given operation condition. The default value may be
                7:0     Base Power          RO    changed by auto-loading from EEPROM.
                                                  Reset to 04h.
                                                  It specifies the scale to apply to the base power value. The default value may
                                                  be changed by auto-loading from EEPROM.
                9:8     Data Scale          RO
                                                  Reset to 00b.
                                                  It specifies the power management sub state of the given operation condition.
                                                  It is initialized to the default sub state.
                12:10   PM Sub State        RO
                                                  Reset to 000b.
                                                  It specifies the power management state of the given operation condition.
                                                  It defaults to the D0 power state. The default value may be changed by auto-
                14:13   PM State            RO    loading from EEPROM.
                                                  Reset to 00b.
                                                  It specifies the type of the given operation condition.
                                                  It defaults to the Maximum power state. The default value may be changed by
                17:15   Type                RO    auto-loading from EEPROM.
                                                  Reset to 111b.
                                                  It specifies the power rail of the given operation condition.
                20:18   Power Rail          RO
                                                  Reset to 010b.
                31:21   Reserved            RO    Reset to 0.
                                                Page 65 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                        PI7C9X20303SL
                                                                              3Port-3Lane PCI Express® Switch
                                                                                                     SlimLineTM Family
                                                                                                                 Datasheet
7.2.102       POWER BUDGET CAPABILITY REGISTER – OFFSET 218h
                BIT     FUNCTION         TYPE   DESCRIPTION
                                                When set, it indicates that the power budget for the device is included within
                                                the system power budget. The default value may be changed by auto-loading
                0       System Allocated  RO    from EEPROM.
                                                Reset to 0b.
                31:1    Reserved          RO    Reset to 0.
                                              Page 66 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                          PI7C9X20303SL
                                                                                         3Port-3Lane PCI Express® Switch
                                                                                                        SlimLineTM Family
                                                                                                                 Datasheet
8      CLOCK SCHEME
The PI7C9X20303SL requires 100MHz differential clock inputs through REFCLKP and REFCLKN Pins as shown
in the following table.
        Table 8-1 Input Clock Requirements
          Symbol          Description                                                Min  Typical Max.      Unit
          ClkInFREQ       Reference input clock range                                  -   100       -     MHz
          ClkInDC         Duty cycle of input clock                                   40    50      60       %
          TR, TF          Rise/Fall time of input clock                                -     -      0.2    RCUIa
          VSW             Differential input voltage swing      (peak-to-peak)       800     -     2000     mV
                                                                (zero-to-peak)       400     -     1000     mV
          a. RCUI (Reference Clock Unit Interval) refers to the reference clock period
                                                               Page 67 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                              PI7C9X20303SL
                                                                                    3Port-3Lane PCI Express® Switch
                                                                                                           SlimLineTM Family
                                                                                                                     Datasheet
9 IEEE 1149.1 COMPATIBLE JTAG CONTROLLER
An IEEE 1149.1 compatible Test Access Port (TAP) controller and associated TAP pins are provided to support
boundary scan in PI7C9X20303SL for board-level continuity test and diagnostics. The TAP pins assigned are TCK,
TDI, TDO, TMS and TRST_L. All digital input, output, input/output pins are tested except TAP pins.
9.1     INSTRUCTION REGISTER
The IEEE 1149.1 Test Logic consists of a TAP controller, an instruction register, and a group of test data registers
including Bypass and Boundary Scan registers. The TAP controller is a synchronous 16-state machine driven by the
Test Clock (TCK) and the Test Mode Select (TMS) pins. An independent power on reset circuit is provided to
ensure the machine is in TEST_LOGIC_RESET state at power-up.
PI7C9X20303SL implements a 5-bit Instruction register to control the operation of the JTAG logic. The defined
instruction codes are shown in Table 10-1. Those bit combinations that are not listed are equivalent to the BYPASS
(11111) instruction:
        Table 9-1 Instruction register codes
          Instruction  Operation Code (binary)  Register Selected  Operation
          EXTEST                00000           Boundary Scan      Drives / receives off-chip test data
          SAMPLE                00001           Boundary Scan      Samples inputs / pre-loads outputs
          HIGHZ                 00101           Bypass             Tri-states output and I/O pins except TDO pin
          CLAMP                 00100           Bypass             Drives pins from boundary-scan register and selects Bypass
                                                                   register for shifts
          IDCODE                01100           Device ID          Accesses the Device ID register, to read manufacturer ID, part
                                                                   number, and version number
          BYPASS                11111           Bypass             Selected Bypass Register
          INT_SCAN              00010           Internal Scan      Scan test
          MEM_BIST              01010           Memory BIST        Memory BIST test
9.2     BYPASS REGISTER
     The required bypass register (one-bit shift register) provides the shortest path between TDI and TDO when a
     bypass instruction is in effect. This allows rapid movement of test data to and from other components on the
     board. This path can be selected when no test operation is being performed on the PI7C9X20303SL.
9.3     DEVICE ID REGISTER
        This register identifies Pericom as the manufacturer of the device and details the part number and revision
number for the device.
         Table 9-2 JTAG device ID register
          Bit          Type                     Value              Description
          31-28        RO                       0001               Version number
          27-12        RO                       1001001000000100   Last 4 digits (hex) of the die part number
          11-1         RO                       01000111111        Pericom identifier assigned by JEDEC
          0            RO                       1                  Fixed bit equal to 1’b1
                                                       Page 68 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                     PI7C9X20303SL
                                                                                3Port-3Lane PCI Express® Switch
                                                                                                   SlimLineTM Family
                                                                                                              Datasheet
9.4     BOUNDARY SCAN REGISTER
        The boundary scan register has a set of serial shift-register cells. A chain of boundary scan cells is formed by
        connected the internal signal of the PI7C9X20303SL package pins. The VDD, VSS, and JTAG pins are not
        in the boundary scan chain. The input to the shift register is TDI and the output from the shift register is
        TDO. There are 4 different types of boundary scan cells, based on the function of each signal pin.
        The boundary scan register cells are dedicated logic and do not have any system function. Data may be
        loaded into the boundary scan register master cells from the device input pins and output pin-drivers in
        parallel by the mandatory SAMPLE and EXTEST instructions. Parallel loading takes place on the rising
        edge of TCK.
9.5     JTAG BOUNDARY SCAN REGISTER ORDER
          Table 9-3 JTAG boundary scan register definition
            Boundary Scan
           Register Number          Pin Name                 Pin No                   Type           Tri-state Control Cell
                   0              WAKEUP _L                     6                     Input                     4
                   1             SLOT_IMP[2]                    7                     Bidir                     4
                   2                   NC                       9                     Bidir                     4
                   3                 TEST5                     10                     Bidir                     4
                   4                                                                 Control
                   5                 TEST4                     11                     Bidir                     4
                   6                 TEST3                     12                     Bidir                     4
                   7                SMBCLK                     13                     Bidir                     4
                   8               SMBDATA                     16                     Bidir                     4
                   9               PWR_SAV                     17                     Bidir                     4
                  10                 DEQ[3]                    18                     Bidir                     4
                  11                 GPIO[0]                   21                     Bidir                    12
                  12                                                                 Control
                  13                 GPIO[1]                   22                     Bidir                    14
                  14                                                                 Control
                  15                 GPIO[2]                   23                     Bidir                    16
                  16                                                                 Control
                  17                 GPIO[3]                   24                     Bidir                    18
                  18                                                                 Control
                  19                 GPIO[4]                   25                     Bidir                    20
                  20                                                                 Control
                  21                 GPIO[5]                   26                     Bidir                    22
                  22                                                                 Control
                  23                 GPIO[6]                   27                     Bidir                    24
                  24                                                                 Control
                  25                 GPIO[7]                   28                     Bidir                    26
                  26                                                                 Control
                  27                 TEST1                     31                     Bidir                     4
                  28                 HIDRV                     32                     Bidir                     4
                  29               LOWDRV                      33                     Bidir                     4
                  30                 DTX[3]                    38                     Bidir                     4
                  31                 EECLK                     40                    Output2
                  32                  EEPD                     41                     Bidir                    33
                  33                                                                 Control
                  34                PERST_L                    43                     Input
                  35              PWR_IND[1]                                         Output2
                  36              PWR_IND[3]                                         Output2
                  37              PORTERR[0]                   45                    Output2
                  38              ATT_IND[1]                                         Output2
                  39              ATT_IND[3]                                         Output2
                                                     Page 69 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                      PI7C9X20303SL
                                                     3Port-3Lane PCI Express® Switch
                                                                    SlimLineTM Family
                                                                               Datasheet
            Boundary Scan
           Register Number   Pin Name        Pin No      Type         Tri-state Control Cell
                  40        PORTERR[1]         47       Output2
                  41        ATT_BTN[1]                   Input
                  42        ATT_BTN[3]                   Input
                  43        PORTERR[2]         51       Output2
                  44         PRSNT[1]                    Input
                  45         PRSNT[3]                    Input
                  46       PWR_ENA[1]                   Output2
                  47       PWR_ENA[3]                   Output2
                  48        PWR_FLT[1]                   Input
                  49        PWR_FLT[3]                   Input
                  50            NC             54       Output2
                  51          TEST2            66        Input
                  52       DWNRST_L[1]         96       Output2
                  53       DWNRST_L[2]         97       Output2
                  54            NC             98       Output2
                  55        PWR_IND[2]                  Output2
                  56          TEST6           126        Bidir                   4
                  57        ATT_IND[2]                  Output2
                  58        ATT_RTN[2]                   Input
                  59         SLOTCLK          127        Bidir                   4
                  60         PRSNT[2]                    Input
                  61       PWR_ENA[2]                   Output2
                  62        PWR_FLT[2]                   Input
                  63       SLOT_IMP[1]        128        Bidir                   4
                                       Page 70 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                               PI7C9X20303SL
                                                                           3Port-3Lane PCI Express® Switch
                                                                                            SlimLineTM Family
                                                                                                      Datasheet
10 POWER MANAGEMENT
The PI7C9X20303SL supports D0, D1, D2, D3-hot, and D3-cold Power States. The PCI Express Physical Link
Layer of the PI7C9X20303SL device supports the PCI Express Link Power Management with L0, L0s, L1, L2/L3
ready and L3 Power States.
During the transition from D3-hot to D3-cold state, the main power supplies of VDDC and VDDR are turned off to
save power while keeping the VDDAUX and VAUX with the auxiliary power supplies to maintain all necessary
information to be restored to the full power D0 state. PI7C9X20303SL has been designed to have sticky registers
that are powered by auxiliary power supplies. PI7C9X20303SL forwards power management messages to the
upstream Switches or root complex.
PI7C9X20303SL also supports ASPM (Active State Power Management) to facilitate the link power saving.
PI7C9X20303SL supports beacon generation and WAKEUP_L signal.
                                                    Page 71 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                                PI7C9X20303SL
                                                                                        3Port-3Lane PCI Express® Switch
                                                                                                              SlimLineTM Family
                                                                                                                       Datasheet
11 ELECTRICAL AND TIMING SPECIFICATIONS
11.1 ABSOLUTE MAXIMUM RATINGS
          Table 11-1 Absolute maximum ratings
        (Above which the useful life may be impaired. For user guidelines, not tested.)
         Storage Temperature                                                                    -65oC to 150oC
          Ambient Temperature with power applied                                                 -40oC to 85oC
          PCI Express supply voltage to ground potential (VDDA, VDDC, and                         -0.3v to 3.0v
          VDDAUX)
          DC input voltage for PCI Express signals                                                -0.3v to 3.0v
        Note:
        Stresses greater than those listed under MAXIMUM RATINGS may cause permanent damage to the device. This is a
        stress rating only and functional operation of the device at these or any conditions above those indicated in the
        operational sections of this specification is not implied. Exposure to absolute maximum rating conditions for extended
        periods of time may affect reliability.
11.2 POWER CONSUMPTION
          Table 11-2 PI7C9X303SL power dissipation
          Mode                       Power Saving        Typical Power Dissipation (mW)
         L0 Normal Mode                  Enabled                         360
                                         Disabled                        510
          L1 Standby Mode                Enabled                         210
                                         Disabled                        420
11.3 DC SPECIFICATIONS
          Table 11-3 DC electrical characteristics
          Power Pins                Min.                      Typ.                   Max.
          VDDA                      0.9v                      1.0v                   1.1v
          VDDR                      3.0v                      3.3v                   3.6v
          VDDC                      0.9v                      1.0v                   1.1v
          VAUX                      3.0v                      3.3v                   3.6v
          VDDAUX                    0.9v                      1.0v                   1.1v
          VTT                       VDDC                      1.5v                   1.8v
        VDDA: analog power supply for PCI Express Interface
        VDDR: digital power supply for 3.3v I/O Interface
        VDDC: digital power supply for the core
        VAUX: digital auxiliary power supply for 3.3v I/O Interface
        VDDAUX: digital auxiliary power supply for the core
        VTT: transmit termination power supply for PCI Express Interface
        In order to support auxiliary power management fully, it is recommended to have VDDC and VDDAUX
        separated.
                                                             Page 72 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                               PI7C9X20303SL
                                                                                         3Port-3Lane PCI Express® Switch
                                                                                                             SlimLineTM Family
                                                                                                                      Datasheet
11.4 AC SPECIFICATIONS
          Table 11-4 Transmitter Characteristics
          Symbol          Description                                     Min           Typical        Max.      Unit
          Voltage Parameters
          VTX-DIFFa       Output voltage compliance @ typical swing
                          VTX-DIFFp (peak-to-peak, single ended)          400              500          600      mV
                          VTX-DIFFpp (peak-to-peak, differential)         800             1000         1200      mV
          VSW             Supported TX output voltage range (pp,          400b                        1500c      mV
                          differential)
          VOL             Low-level output voltage                               VTT - 1.5 *VTX-DIFFp             V
          VOH             High-level output voltage                               VTT - 0.5VTX-DIFFp              V
          VTX-CM-AC       Transmit common-mode voltage in L0              0.50      VTT - VTX-DIFFp    1.45       V
          VTX-CM-HiZ      Transmit common-mode voltage in L0s                          VTX-CM-AC                  V
                          (TX) & L1
          VTX-DE-RATIO    De-emphasized differential output voltage         0                          -7.96      dB
          VTX-IDLE-DIFFp  Electric Idle differential peak voltage                                        20      mV
          VTX-RCV-        Voltage change during Receive Detection                       VTX-DIFFp                mV
          DETECT
          RLTX-DIFF       Transmitter Differential Return loss             10                                     dB
          RLTX-CM         Transmitter Common Mode Return loss               6                                     dB
          ZOSE            Single-ended output impedance                    40              50            60       Ω
          ZTX-DIFF-DC     DC Differential TX Impedance                     80              100          120       Ω
          TTX-RISE, TTX-  Rise / Fall time of TxP, TxN outputs             80                          110d       ps
          FALL
          Jitter Parameters
          UI              Unit Interval                                  399.88            400        400.12      ps
          TTX-MAX-JITTER  Transmitter total jitter (peak-to-peak)                                      0.25e      UI
          TTX-EYE         Minimum TX Eye Width (1 - TTX-MAX-              0.75                                    UI
                          JITTER)
          TTX-EYE-        Maximum time between the jitter median                                      0.125       UI
          MEDIAN-to-      and
          MAX-JITTER      maximum deviation from the median
          Timing Parameters
          LTLAT-10        Transmitter data latency (for n=10)               9                            11       UI
          LTLAT-20        Transmitter data latency (for n=20)               9                            11       UI
          LTX-SKEW        Transmitter data skew between any 2 lanes         0                           2+        UI
                                                                                                      200ps
          TTX-IDLE-SET-   Maximum time to transition to a valid                             4             6       ns
          TO-IDLE         electrical idle after sending an Electrical
                          Idle ordered set
          TEIExit         Time to exit Electrical Idle (L0s) state into                    12            16       ns
                          L0
          TBTEn           Time from asserting BeaconTxEn to                                30            80       ns
                          beacon being transmitted on the lane
          TRxDetectEn     Pulse width of RxDetectEn input                  9.8              10          10.2      us
          TRxDetect       RxDetectEn falling edge to RxDetect                               1             2       ns
                          delay
        a. Measured with Vtt = 1.2V, HiDrv=’0’,LowDrv=’0’ and Dtx=’0000’.
        b. Minimum swing assumes LoDrv = 1, HiDrv = 0 and Dtx =1100
        c. Max swing assumes LoDrv = 0, HiDrv = 1, Dtx = 0010, VTT = 1.8V
        d. As measured between 20% and 80% points. Will depend on package characteristics.
        e. Measured using PCI Express Compliance Pattern
                                                                Page 73 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                                    PI7C9X20303SL
                                                                                 3Port-3Lane PCI Express® Switch
                                                                                                  SlimLineTM Family
                                                                                                           Datasheet
          Table 11-5 Receiver Characteristics
          Symbol             Description                                    Min  Typical    Max.      Unit
          Voltage Parameters
          VRX-DIFFp-p        Differential input voltage (peak-to-peak)       170             1200     mV
          VRX-IDLE-DET-      Differential input threshold voltage (peak-     65              175      mV
          DIFFp-p            to-peak) to assert TxIdleDetect output
          VRX-CM-AC          Receiver common-mode voltage for AC-                  0         150      mV
                             coupling
          TRX-RISE, TRX-     Rise time / Fall time of RxP, RxN inputs                        160       Ps
          FALL
          ZRX-DIFF-DC        Differential input impedance (DC)               80   100        120        Ω
          ZRX-COM-DC         Single-ended input impedance                    40    50         60        Ω
          ZRX-COM-INITIAL-   Initial input common mode impedance              5    50         60        Ω
          DC                 (DC)
          ZRX-COM-HIGH-      Powered down input common mode                 200k                        Ω
          IMP-DC             impedance (DC)
          RLRX-DIFF          Receiver Differential Return Lossa              10                        dB
          RLRX-CM            Receiver Common Mode Return Lossb                6                        dB
          Jitter Parameters
          TRX-MAX-JITTER     Receiver total jitter tolerance                                 0.65      UI
          TRX-EYE            Minimum Receiver Eye Width                     0.35                       UI
          TRX-EYE-MEDIAN-    Maximum time between jitter median and                         0.325      UI
          to-MAX-JITTER      max deviation from median
          Timing Parameters
         LRLAT-10           Receiver data latency for n=10                   28               29      bits
         LRLAT-20           Receiver data latency for n=20                   49               60      bits
         TRX-SKEW           Receiver data skew between any 2 lanes            0               1c      bits
         TBDDly             Beacon-Activity on channel to detection of                       200       us
                            Beacond
         TRX-               Delay from detection of Electrical Idle               10          20       ns
         IDLE_ENTER condition on the channel to assertion of
                            TxIdleDetect output
         TRX-               Delay from detection of L0s to L0                      5          10       ns
         IDLE_EXIT          transition to deassertion of TxIdleDetect
                            output
        a. Over a frequency range of 50 MHz to 1.25 GHz.
        b. Over a frequency range of 50 MHz to 1.25 GHz.
        c. Assuming synchronized bit streams at the respective receiver inputs.
        d. This is a function of beacon frequency
                                                                 Page 74 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                       PI7C9X20303SL
                                                                  3Port-3Lane PCI Express® Switch
                                                                                    SlimLineTM Family
                                                                                              Datasheet
12 PACKAGE INFORMATION
The package of PI7C9X20303SL is a 14mm x 14mm LQFP (128 Pin) package. The following are the package
information and mechanical dimension:
          Figure 12-1 Package outline drawing
                                              Page 75 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


                                                                                 PI7C9X20303SL
                                                                3Port-3Lane PCI Express® Switch
                                                                               SlimLineTM Family
                                                                                       Datasheet
13 ORDERING INFORMATION
       Part Number        Temperature Range            Package           Pb-Free & Green
       PI7C9X20303SL□FDEX -40o to 85oC                 128-pin LQFP      Yes
                          (Industrial Temperature)     14mm x 14mm
      PI 7C 9X20303SL      FD E X
                                              Blank=Tray
                                           X=Tape & Reel
                                          Blank=Standard
                                      E=Pb-Free and Green
                                            Package Code
                                          Blank=Standard
                                                =Revision
                                              Device Type
                                           Device Number
                                                   Family
                                              PI=Pericom
                                        Page 76 of 76
July 2009 – Revision 1.1
Pericom Semiconductor


Mouser Electronics
Authorized Distributor
Click to View Pricing, Inventory, Delivery & Lifecycle Information:
Diodes Incorporated:
 PI7C9X20303SLCFDE PI7C9X20303SLCFDEX PI7C9X20303SLCEVB
