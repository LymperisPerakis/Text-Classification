          Version 1.3 2010
Features
 PEX 8604 General Features
  o 4-lane PCI Express switch
    - Integrated 5.0 GT/s SerDes
  o Up to 4 configurable ports
                                                                PEX 8604
  o 15 x 15mm2, 196-ball PBGA
  o Typical Power: 1.29 Watts
 PEX 8604 Key Features                         Flexible & Versatile 4-lane 4-port PCI Express® Switch
  o Standards Compliant
    - PCI Express Base Specification r2.0
       (Backwards compatible with PCIe        The ExpressLane™ PEX 8604 device offers PCI Express switching capability
       r1.0a/1.1)
                                              enabling users to add scalable high bandwidth non-blocking interconnection to a
    - PCI Power Management Spec r1.2
    - Microsoft Vista Compliant               wide variety of applications including control plane applications, consumer
    - Supports Access Control Services        applications and embedded systems. The PEX 8604 is well suited for fan-out,
    - Dynamic link-width control              peer-to-peer, and intelligent I/O module applications.
  o High Performance
    - Non-blocking internal architecture      Low Packet Latency & High Performance
    - Full line rate on all ports             The PEX 8604 architecture supports packet cut-thru with a maximum latency of
    - Cut-Thru latency: 190ns                 190ns in x1 to x1 configuration. This, combined with low power consumption and
    - 2KB max payload size                    non-blocking internal switch architecture, provides full line rate on all ports for low-
    - Read Pacing                             power applications such as consumer and embedded. The low latency enables
       (intelligent bandwidth allocation)     applications to achieve high throughput and performance. In addition to low latency,
    - Dual Cast                               the device supports a max payload size of 2048 bytes, enabling the user to achieve
  o Dual-Host & Fail-Over Support
    - Configurable Non-Transparent port       even higher throughout.
       (NTB)                                  Data Integrity
    - Moveable upstream port
    - Crosslink port capability on all ports
                                              The PEX 8604 provides end-to-end CRC protection (ECRC) and Poison bit support
  o Flexible Configuration                    to enable designs that require guaranteed error-free packets. PLX also supports
    - 4 flexible & configurable ports         data path parity and memory (RAM) error correction as packets pass through the
       (x1 or x2)                             switch.
    - Configurable with strapping pins,
       EEPROM, I2C, or Host software          Dual-Host and Fail-Over Support
    - Lane and polarity reversal              The PEX 8604 supports full non-transparent bridging (NTB) functionality to allow
  o PCI Express Power Management              implementation of multi-host systems and intelligent I/O modules in applications
    - Link power management states: L0, L0s,  which require redundancy support such as select embedded applications.
       L1, L2/L3 Ready, and L3
    - Device states: D0 and D3hot             Non-transparent bridges allow systems to isolate host memory domains by
  o Spread Spectrum Clock Isolation           presenting the processor subsystem as an endpoint rather than another memory
    - Dual clock domain                       system. Base address registers are used to translate addresses, doorbell registers are
  o Quality of Service (QoS)                  used to send interrupts between the address domains, and scratchpad registers are
    - Two Virtual Channels (VC) per port      accessible from both address domains to allow inter-processor communication.
    - Eight Traffic Classes per port
    - Weighted Round-Robin Port & VC          Interoperability
       Arbitration                            The PEX 8604 is designed to be fully compliant with the PCI Express Base
  o Reliability, Availability, Serviceability Specification r2.0 and is backwards compatible to PCI Express Base Specification
    - All ports Hot-Plug capable thru I2C
       (Hot-Plug Controller on every port)
                                              r1.1 and r1.0a. Additionally each port supports auto-negotiation and polarity
    - ECRC & Poison bit support               reversal. Furthermore, the PEX 8604 is designed for Microsoft Vista compliance.
    - Data path protection                    All PLX switches undergo thorough interoperability testing in PLX’s
    - Memory (RAM) error correction           Interoperability Lab and compliance testing at the PCI-SIG plug-fest to ensure
    - Advanced Error Reporting support        compatibility with PCI Express devices in the market.
    - Port Status bits and GPIO available
    - Per port error diagnostics              Device Operation Configuration Flexibility
    - Performance monitoring                  The PEX 8604 provides several ways to configure its operations. The device can be
       (per port payload & header counters)   configured through strapping pins, I2C interface, CPU configuration cycles and/or an
    - JTAG AC/DC boundary scan                optional serial EEPROM. This allows for easy debug during the development phase
    - Fatal Error (FATAL_ERR#) output signal  and functional monitoring during the operation phase.
    - INTA# output signal


Flexible Port Configurations                                     off, low, typical, and high. The SerDes block also supports
The PEX 8604 flexible architecture supports a number of port     loop-back modes and advanced reporting of error
configurations as required by the target applications as shown   conditions, which enables efficient debug and management of
in figure 1 below.                                               the entire system.
                                                                 Port and Virtual Channel (VC) Arbitration
                                                                 The PEX 8604 switch supports hardware fixed and Weighted
                                                                 Round-Robin Ingress Port Arbitration. This allows fine tuning
                                                                 of Quality of Service and efficient use of packet buffers for
                                                                 better system performance. The PEX 8604 also supports WRR
                                                                 VC arbitration scheme between the two virtual channels.
                                                                 Applications
                                                                 Suitable for fan-out, control plane applications, embedded
                                                                 systems as well as intelligent I/O applications, PEX 8604
                                                                 can be configured for a wide variety of form factors and
                                                                 applications.
               Figure 1. Port Configurations                     Fan-Out
                                                                 The PEX 8604 switch, with its flexible configurations, allows
Hot-Plug for High Availability                                   user specific tuning to a variety of host-centric as well as
Hot-Plug capability allows users to replace hardware modules     peer-to-peer applications.
and perform maintenance without powering down the system.
The PEX 8604 Hot-Plug capability feature makes it suitable
for High Availability (HA) applications. If the PEX 8604 is
used in an application where one or more of its downstream
ports connect to PCI Express slots, each port’s Hot-Plug
Controller can be used to manage the Hot-Plug event of its
associated slot. Every port on the PEX 8604 is equipped with
a Hot-Plug control/status register to support Hot-Plug
capability through external logic via the I2C interface.
Dual Cast
The PEX 8604 supports Dual Cast, a feature which allows for
the copying of data (e.g. packets) from one ingress port to two
egress ports allowing for higher performance in storage,
security, and mirroring applications.
Read Pacing
                                                                                  Figure 2. Fan-in/out Usage
The Read Pacing feature allows users to throttle the amount of
read requests being made by downstream devices. In the case      Figure 2 shows a typical fan-out design, where the processor
where a downstream device requests several long reads back-      provides a PCI Express link that needs to be fanned into a
to-back, the Root Complex gets tied up in serving this           larger number of smaller ports for a variety of I/O functions,
downstream port. If this port has a narrow link and is therefore each with different bandwidth requirements.
slow in receiving these read packets from the Root Complex,
then other downstream ports may become starved – thus,           In this example, the PEX 8604 would typically have a 1-lane
impacting performance. The Read Pacing feature enhances          upstream port, and three downstream ports. The downstream
performances by allowing for the adequate servicing of all       ports provide x1 PCI Express connectivity to the endpoints.
downstream devices by intelligent handling of read requests.     With its four ports, the PEX 8604 can provide fan-out
                                                                 connectivity to up to three PCI Express devices. The figure
SerDes Power and Signal Management                               also shows how some of the ports can be bridged to provide
The PEX 8604 provides low power capability that is fully         PCI slots through the use of the PEX 8112 PCIe bridging
compliant with the PCI Express power management                  devices.
specification. In addition, the SerDes physical links can be
turned off when unused for even lower power. The PEX 8604        Consumer Applications
supports software control of the SerDes outputs to allow         With its small footprint, the PEX 8604 is ideal for consumer
optimization of power and signal strength in a system. The       applications. Figure 3 shows an example for a set top box.
PLX SerDes implementation supports four levels of power –        The PEX8604 connects to legacy devices using a PEX85112


(PCIe to PCI bridge). The four ports in the PEX8604 provide   Intelligent Adapter Card
connectivity between the processor to up to three peripherals The PEX 8604 supports the non-transparency feature.
each via an x1 connection. This usage model provides          Figure 6 illustrates a host system using an intelligent adapter
connectivity within a set top box between the control         card.
processor and the various endpoints.
                   Figure 3. Set Top Box
                                                                          Figure 6. Intelligent Adapter Usage
Mobile Wireless Adaptor
PEX 8604 devices can be used in applications where low        In this figure, the CPU on the adapter card is isolated from the
power consumption is of importance as is the case in mobile   host CPU. The PEX 8604 non-transparent port allows the two
applications. An example of a mobile wireless adapter card is CPUs to be isolated but communicate with each other through
shown in Figure 4.                                            various registers that are designed in the PEX 8604 for that
                                                              purpose. The host CPU can dynamically re-assign both the
                                                              upstream port and the non-transparent port of PEX 8604
                                                              allowing the system to be reconfigured.
                                                              Active-Standby Failover Model
                                                              The PEX 8604 supports applications requiring dual host, host
                                                              failover applications through the non-transparency (NTB)
                                                              feature. Figure 7 illustrates a dual host system with an active
                                                              and standby processor configuration.
                                                              The redundancy of the host and the fabric can be achieved
                                                              through many possible configurations using NTB function of
            Figure 4. Mobile Wireless Adaptor
                                                              PEX 8604. In the configuration shown below Processor A is
                                                              the primary active host of the PCI Express system. Processor
Embedded Mezzanine Module                                     B acts as the backup Host. In the case of a failure on Processor
The PEX 8604 is well suited for mezzanine module              A, application software is instructed to migrate the PCI
applications. Figure 5 shows that the mezzanine card has a    Express system to Processor B. Consequently, Processor B
local processor and a local PCIe hierarchy with the PEX8604   becomes the active host and Processor A can be replaced as
and multiple endpoints. Additionally, the non-transparent     the backup Host.
port in the PEX8604 allows the mezzanine to interface with
the main CPU in the Baseboard as well as other mezzanine
modules.
                                                              Figure 7. Active-Standby Control Plane
        Figure 5. PCI Express Mezzanine Module


    Software Usage Model                                                                      Interrupt Sources/Events
    From a system model viewpoint, each PCI Express port is a                                 The PEX 8604 supports the INTx interrupt message type
    virtual PCI to PCI bridge device and has its own set of                                   (compatible with PCI 2.3 Interrupt signals) or Message
    PCI Express configuration registers. It is through the upstream                           Signaled Interrupts (MSI) when enabled. Interrupts/messages
    port that the BIOS or host can configure the other ports using                            are generated by PEX 8604 for Hot-Plug events, doorbell
    standard PCI enumeration. The virtual PCI-to-PCI bridges                                  interrupts, baseline error reporting, and advanced error
    within the PEX 8604 are compliant to the PCI and PCI                                      reporting.
    Express system models. The Configuration Space Registers
    (CSRs) in a virtual primary/secondary PCI-to-PCI bridge are
    accessible by type 0 configuration cycles through the virtual
    primary bus interface (matching bus number, device number,
    and function number).
    Development Tools                                                                         RDK
    PLX offers hardware and software tools to enable rapid                                    The PEX 8604RDK is a hardware module containing the
    customer design activity. These tools consist of a PEX 8604                               PEX 8604 which plugs right into your system (Figure 8). The
    Rapid Development Kit (RDK), hardware documentation, and                                  PEX 8604RDK hardware module can be installed in a
    a Software Development Kit (also available at                                             motherboard, used as a riser card, or configured as a bench-top
    www.plxtech.com/sdk).                                                                     board. The PEX 8604RDK can be used to test and validate
                                                                                              customer software. Additionally, it can be used as an
                                                                                              evaluation vehicle for PEX 8604 features and benefits.
                                                                                              SDK
                                                                                              The SDK tool set
                                                                                              includes:                                      Windows/Linux Apps
                                                                                                 - Linux & Windows                   User
                                                                                                                                     Space
                                                                                                     drivers
                                                                                                 - C/C++ Source code,                                  PEX API
                                                                                                     Objects, libraries
                                                                                                 - User’s Guides &                   Kernel    PCIe            NT PnP
                                                                                                     Application examples            Space     Driver           Driver
                                                                                                                                     Hardware    PCI Express Interface
                           Figure 8. PEX 8604RDK
                                           Product Ordering Information
                                             Part Number                                 Description
                                             PEX8604-BA50BC                              4 Lane, 4 Port PCIe Switch, 196-ball PBGA 15x15mm2 pkg
    PLX Technology, Inc.                     PEX8604-BA50BC G                            4 Lane, 4 Port PCIe Switch, 196-ball PBGA 15x15mm2 pkg, Pb-free
    870 W. Maude Ave.                                                                    4 Lane, 4 Port PCIe Switch, 196-ball PBGA 15x15mm2 pkg, Pb-free
                                             PEX8604-BA50BI G
    Sunnyvale, CA 94085 USA                                                              Industrial Temperature
    www.plxtech.com                          PEX 8604BA-AIC1U1D RDK                      PEX 8604 Rapid Development Kit with 4-ports
                                           Please visit the PLX Web site at http://www.plxtech.com for sampling.
© 2010 by PLX Technology, Inc. All rights reserved. PLX and the PLX logo are registered trademarks of PLX Technology, Inc. ExpressLane is a trademark of PLX Technology,
Inc., which may be registered in some jurisdiction. All other product names that appear in this material are for identification purposes only and are acknowledged to be
trademarks or registered trademarks of their respective companies. Information supplied by PLX is believed to be accurate and reliable, but PLX Technology, Inc. assumes no
responsibility for any errors that may appear in this material. PLX Technology, Inc. reserves the right, without notice, to make changes in product design or specification.
PEX 8604-SIL-PB-1.3                                                                                                                                                        4/10


Mouser Electronics
Authorized Distributor
Click to View Pricing, Inventory, Delivery & Lifecycle Information:
Avago Technologies:
 PEX8604-BA50BIG PEX 8604-BA50BC G
Broadcom Limited:
 PEX8604BA-AIC1U1DRDK PEX 8604BA-AIC1U1D PEX8604-BA50BC PEX8604-BA50BC G
