                                             KIT
                                       ATION
19-0836; Rev 1; 8/10              EVALU   BL E
                                    AVAILA
   SMBus/I2C Interfaced 4-Port, Level-Translating
                          GPIOs and LED Drivers
                                  General Description                                                                                 Features
                                                                                                                                                   MAX7306/MAX7307
The MAX7306/MAX7307               I2C-/SMBus™-compatible,
                                                       seri-                   ♦ 1.4V to 5.5V I/O Level Translation Port Supply (VLA)
al-interfaced peripherals feature four level-translating                       ♦ 1.62V to 3.6V Power Supply
I/Os and operate from a 1.62V to 3.6V power supply.                            ♦ Four Individually Configurable GPIO Ports
The MAX7307 features a port supply (VLA) that allows                                P1 = Open-Drain I/O
level translation on I/O ports to operate from a separate                           P2, P3, P4 = Push-Pull or Open-Drain I/O
power supply from 1.4V to 5.5V. The MAX7306 features                           ♦ Individual 33-Step PWM Intensity Control
an address select input (AD0) to allow up to four unique
slave addresses.                                                               ♦ Blink Controls with 15 Steps on Outputs
                                                                               ♦ 1kHz PWM Period Provides Flicker-Free LED
The MAX7306/MAX7307 ports P2, P3, and P4 can be                                  Intensity Control
configured as inputs, push-pull outputs, and open-drain
outputs. Port P1 can be configured as a general-pur-                           ♦ 25mA (max) Port Output Sink Current (100mA
                                                                                 max Ground Current)
pose input, open-drain output, or an open-drain INT out-
put. Ports P2 and P3 can be configured as OSCIN and                            ♦ Inputs Overvoltage Protected Up to 5.5V (VLA)
OSCOUT, respectively. The MAX7306/MAX7307 include                              ♦ Transition Detection with Optional Interrupt Output
an internal oscillator for PWM, blink, and key debounce,                       ♦ Optional Input Debouncing
or to cascade multiple MAX7306/MAX7307s. The exter-                            ♦ RST Input Clears Serial Interface, Can Restore
nal clock can be used to set a specific PWM and blink                            Power-Up Default State, and Synchronizes Blink
timing. The RST input asynchronously clears the 2-wire                           Timing
interface and terminates a bus lockup involving the                            ♦ Oscillator Input and Output Enables Cascading
MAX7306/MAX7307.                                                                 Multiple Devices
All ports configured as output feature 33-step PWM,                            ♦ Low 0.75µA (typ) Standby Current
allowing any output to be set from fully off, 1/32 to 31/32
duty cycle, to fully on. All output ports also feature LED
blink control, allowing blink periods of 1/8 second, 1/4                                                            Ordering Information
second, 1/2 second, 1, 2, 4, or 8 seconds. Any port can                                     PART                TOP MARK         PIN-PACKAGE
blink during this period with a 1/16 to 15/16 duty cycle.
                                                                               MAX7306ALB+                 AAL        10 µDFN (2mm x 2mm)
The MAX7306/MAX7307 are specified over the -40°C to                            Note: All devices are specified over the -40°C to +125°C oper-
+125°C temperature range and are available in 10-pin                           ating temperature range.
µDFN (2mm x 2mm) and 10-pin µMAX® packages.
                                                                               +Denotes a lead(Pb)-free/RoHS-compliant package.
                                                    Applications               Ordering Information continued at end of data sheet.
  Cell Phones                       LCD/Keypad Backlights                      Pin Configurations appear at end of data sheet.
  System I/O Ports                  LED Status Indicators
SMBus is a trademark of Intel Corp.
µMAX is a registered trademark of Maxim Integrated Products, Inc.
                                                                                                         Typical Operating Circuit
                                        +1.8V                          +4.5V                                             +2.5V
                                            VDD               VLA                                     VDD
                       μC                                                        μC
                            SDA       SDA                                             SDA          SDA
                                                  MAX7307                                                   MAX7306
                            SCL       SCL                                             SCL          SCL
                            RST       RST                                             RST          RST
                                                            P2/OSCIN                                                  P2/OSCIN
                            INT       P1/INT              P3/OSCOUT                   INT          P1/INT           P3/OSCOUT
                                                                  P4                                                        P4
                                                                                                   AD0
                                                    GND                                                       GND
                       ________________________________________________________________ Maxim Integrated Products                              1
For pricing, delivery, and ordering information, please contact Maxim Direct at 1-888-629-4642,
or visit Maxim’s website at www.maxim-ic.com.


                  SMBus/I2C Interfaced 4-Port, Level-Translating
                  GPIOs and LED Drivers
                  ABSOLUTE MAXIMUM RATINGS
MAX7306/MAX7307
                  (All voltages referenced to GND.)                                                               VLA Current (MAX7307) ......................................................30mA
                  VDD ..........................................................................-0.3V to +4V      GND Current ....................................................................100mA
                  VLA, SCL, SDA, AD0, and RST.................................-0.3V to +6V                        Continuous Power Dissipation (TA = +70°C)
                  P1/INT, P2/OSCIN, P3/OSCOUT, and P4                                                               10-Pin µDFN (derate 5.0mW/°C over +70°C) ..............402mW
                     MAX7306 ................................................-0.3V to (VDD + 0.3V)                  10-Pin µMAX (derate 10.3mW/°C over +70°C) ............825mW
                     MAX7307.................................................-0.3V to (VLA + 0.3V)                Operating Temperature Range .........................-40°C to +125°C
                  P1/INT, P2/OSCIN, P3/OSCOUT, and P4 Sink Current ......25mA                                     Junction Temperature ......................................................+150°C
                  P2/OSCIN, P3/OSCOUT, and P4 Source Current ..............10mA                                   Storage Temperature Range .............................-65°C to +150°C
                  SDA Sink Current ...............................................................10mA            Lead Temperature (soldering, 10s) .................................+300°C
                  VDD Current .......................................................................10mA         Soldering Temperature (reflow) .......................................+260°C
                  Stresses beyond those listed under “Absolute Maximum Ratings” may cause permanent damage to the device. These are stress ratings only, and functional
                  operation of the device at these or any other conditions beyond those indicated in the operational sections of the specifications is not implied. Exposure to
                  absolute maximum rating conditions for extended periods may affect device reliability.
                  ELECTRICAL CHARACTERISTICS (MAX7306)
                  (VDD = 1.62V to 3.6V, TA = TMIN to TMAX, unless otherwise noted. Typical values are at VDD = 3.3V, TA = +25°C.) (Note 1)
                                        PARAMETER                                    SYMBOL                    CONDITIONS                              MIN          TYP           MAX        UNITS
                   Operating Supply Voltage                                              VDD                                                           1.62                       3.60           V
                   Power-On Reset Voltage                                               VPOR         VDD rising                                        1.0           1.3           1.6           V
                   Power-On Reset Hysteresis                                        VPORHYST                                                            10           131          300          mV
                                                                                                     Internal oscillator disabled; SCL,
                                                                                                     SDA, digital inputs at VDD or
                                                                                         ISTB                                                                       0.75            2
                                                                                                     GND; P1–P4 (as inputs) at VDD or
                                                                                                     GND
                   Standby Current (Interface Idle)                                                                                                                                             µA
                                                                                                     Internal oscillator enabled; SCL,
                                                                                                     SDA, digital inputs at VDD or
                                                                                        IOSC                                                                         14            25
                                                                                                     GND; P1–P4 (as inputs) at VDD or
                                                                                                     GND
                                                                                                     fSCL = 400kHz; other digital inputs
                   Supply Current (Interface Running)                                   ISUP                                                                         33            40           µA
                                                                                                     at VDD or GND
                   Input High Voltage SDA, SCL, AD0                                      VIH                                                        0.7 x VDD                                    V
                   Input Low Voltage SDA, SCL, AD0                                       VIL                                                                                 0.3 x VDD           V
                   Input High Voltage RST, P1–P4                                        VIHP                                                        0.7 x VDD                                    V
                   Input Low Voltage RST, P1–P4                                          VILP                                                                                0.3 x VDD           V
                   Input Leakage Current SDA, SCL, AD0                                 IIH, IIL      VDD or GND                                         -1                         +1           µA
                   Input Leakage Current RST, P1–P4                                   IIHP, IILP     VDD or GND                                         -1                         +1           µA
                   Input Capacitance SDA, SCL, AD0, P1–P4                                                                                                             8                         pF
                                                                                                     VDD = 1.62V, ISINK = 3mA                                       0.06          0.11
                   Output Low Voltage P1–P4                                              VOL         VDD = 2.5V, ISINK = 16mA                                       0.19           0.4           V
                                                                                                     VDD = 3.3V, ISINK = 20mA                                        0.2           0.4
                                                                                                     VDD = 1.62V, ISOURCE = 0.5mA                      1.55          1.6
                   Output High Voltage P2, P3, and P4                                    VOH         VDD ≥ 2.5V, ISOURCE = 5mA                      VDD - 0.3        2.3                         V
                                                                                                     VDD ≥ 3.3V, ISOURCE = 8mA                     VDD - 0.4         3.1
                   Output Low Voltage SDA                                             VOLSDA         ISINK = 6mA                                                                   0.3           V
                  2     _______________________________________________________________________________________


  SMBus/I2C Interfaced 4-Port, Level-Translating
                         GPIOs and LED Drivers
ELECTRICAL CHARACTERISTICS (MAX7307)
                                                                                                                                          MAX7306/MAX7307
(VDD = 1.62V to 3.6V, TA = TMIN to TMAX, unless otherwise noted. Typical values are at VDD = 3.3V, VLA = 3.3V, TA = +25°C.) (Note 1)
               PARAMETER                       SYMBOL                 CONDITIONS                   MIN       TYP      MAX       UNITS
Operating Supply Voltage                         VDD                                               1.62                3.60       V
Port Logic Supply Voltage                        VLA                                               1.40                5.50       V
Power-On Reset Voltage                           VPOR       VDD rising                             1.0       1.3       1.6        V
Power-On Reset Hysteresis                     VPORHYST                                              10       131       300        V
                                                            Internal oscillator disabled; SCL,
                                                 ISTB       SDA, digital inputs at VDD or GND;               0.75       2
                                                            P1–P4 (as inputs) at VLA or GND
Standby Current (Interface Idle)                                                                                                 µA
                                                            Internal oscillator enabled; SCL,
                                                 IOSC       SDA, digital inputs at VDD or GND;               14         25
                                                            P1–P4 (as inputs) at VLA or GND
                                                            fSCL = 400kHz; other digital
Supply Current (Interface Running)               ISUP                                                        33         40       µA
                                                            inputs at VLA or GND
                                                            Port (configured as inputs) at VLA
Port Supply Current (VLA)                        IVLA                                                        0.05       5        µA
                                                            or GND
Input High Voltage SDA, SCL, RST                  VIH                                            0.7 x VDD                        V
Input Low Voltage SDA, SCL, RST                   VIL                                                               0.3 x VDD     V
                                                            Input is VLA referred                0.7 x VLA
Input High Voltage P1–P4                        VIHPA                                                                             V
                                                            Input is VDD referred                0.7 x VDD
                                                            Input is VLA referred                                   0.3 x VLA
Input Low Voltage P1–P4                          VILPA                                                                            V
                                                            Input is VDD referred                                   0.3 x VDD
Input Leakage Current SDA, SCL, AD0, RST        IIH, IIL    VDD or GND                              -1                 +1        µA
Input Leakage Current P1–P4                    IIHP, IILP   VLA or GND                              -1                 +1        µA
Input Capacitance SDA, SCL, AD0, RST,
                                                                                                              8        0.11      pF
P1–P4
                                                            VDD = 1.62V, ISINK = 3mA                         0.06      0.11
Output Low Voltage P1–P4                         VOL        VDD = 2.5V, ISINK = 16mA                         0.19      0.4        V
                                                            VDD = 3.3V, ISINK = 20mA                         0.2       0.4
                                                            VLA = 1.62V, ISOURCE = 0.5mA           1.3       1.4
Output High Voltage P2, P3, P4                   VOH        VLA = 2.5V, ISOURCE = 5mA            VLA - 0.3   2.3                  V
                                                            VLA = 3.3V, ISOURCE = 8mA            VLA - 0.4   3.1
Output Low Voltage SDA                         VOLSDA       ISINK = 6mA                                                0.3        V
                    _______________________________________________________________________________________                           3


                  SMBus/I2C Interfaced 4-Port, Level-Translating
                  GPIOs and LED Drivers
                  PORT, INTERRUPT (INT), AND RESET (RST) TIMING CHARACTERISTICS
MAX7306/MAX7307
                  (VDD = 1.62V to 3.6V, TA = TMIN to TMAX, unless otherwise noted. Typical values are at VDD = 3.3V, VLA = 3.3V (MAX7307 only), TA =
                  +25°C.) (Note 1) (See Figures 14, 15, and 16)
                                     PARAMETER                           SYMBOL             CONDITIONS              MIN       TYP        MAX       UNITS
                                                                                     fCLK = internal oscillator               32                    kHz
                  Oscillator Frequency                                     fCLK
                                                                                     fCLK = external input                                 1       MHz
                  Port Output Data Valid High Time                         tPPVH     CL ≤ 100pF                                            4         µs
                  Port Output Data Valid Low Time (Internal or
                                                                          tPPVL1     CL ≤ 100pF (Note 2)                                1 / fCLK     µs
                  External Oscillator Running)
                  Port Output Data Valid Low Time (Oscillator Not
                                                                          tPPVL2     CL ≤ 100pF                               40                     µs
                  Running)
                  Port Input Setup Time                                    tPSU      CL = 100pF                      0                              µs
                  Port Input Hold Time                                      tPH      CL = 100pF                      4                              µs
                  INT Input Data Valid Time                                  tIV     CL = 100pF                                            4        µs
                  INT Reset Delay Time from Acknowledge                      tIR     CL = 100pF                                            4        µs
                  RST Pulse Width                                            tW                                     500                             ns
                  RST Rising to START Condition Setup Time                  tRST                                    900                             ns
                  TIMING CHARACTERISTICS
                  (VDD = 1.62V to 3.6V, TA = TMIN to TMAX, unless otherwise noted. Typical values are at VDD = 3.3V, VLA = 3.3V (MAX7307 only), TA =
                  +25°C.) (Note 1) (See Figure 8)
                                     PARAMETER                           SYMBOL             CONDITIONS              MIN       TYP         MAX      UNITS
                   Serial-Clock Frequency                                  fSCL                                                           400       kHz
                   Bus Timeout                                           tTIMEOUT                                              31                   ms
                   Bus Free Time Between a STOP and a START Condition       tBUF                                     1.3                            µs
                   Hold Time, (Repeated) START Condition                  tHD,STA                                    0.6                            µs
                   Repeated START Condition Setup Time                    tSU,STA                                    0.6                            µs
                   STOP Condition Setup Time                              tSU,STO                                    0.6                            µs
                   Data Hold Time                                         tHD,DAT    (Note 3)                                              0.9      µs
                   Data Setup Time                                        tSU,DAT                                   100                             ns
                   SCL Clock Low Period                                    tLOW                                      1.3                            µs
                   SCL Clock High Period                                   tHIGH                                     0.7                            µs
                   Rise Time of Both SDA and SCL Signals, Receiving          tR      (Notes 2, 4)                          20 + 0.1Cb     300       ns
                   Fall Time of Both SDA and SCL Signals, Receiving          tF      (Notes 2, 4)                          20 + 0.1Cb     300       ns
                   Fall Time of SDA Transmitting                            tF.TX    (Note 4)                              20 + 0.1Cb     250       ns
                   Pulse Width of Spike Suppressed                          tSP      (Note 5)                                  50                   ns
                   Capacitive Load for Each Bus Line                        Cb       (Note 2)                                             400       pF
                  Note 1: All parameters are tested at TA = +25°C. Specifications over temperature are guaranteed by design.
                  Note 2: Guaranteed by design.
                  Note 3: A master device must provide a hold time of at least 300ns for the SDA signal (referred to VIL of the SCL signal) to bridge the
                          undefined region of SCL’s falling edge.
                  Note 4: Cb = total capacitance of one bus line in pF. tR and tF are measured between 0.3 x VDD and 0.7 x VDD.
                  Note 5: Input filters on the SDA and SCL inputs suppress noise spikes less than 50ns.
                  4   _______________________________________________________________________________________


                                SMBus/I2C Interfaced 4-Port, Level-Translating
                                                       GPIOs and LED Drivers
                                                                                                                                                                             Typical Operating Characteristics
                                                                                                                                                                                                                                                                                                                            MAX7306/MAX7307
(VDD = 3.3V, VLA = 3.3V, and TA = +25°C, unless otherwise noted.) (MAX7307)
                                              QUIESCENT SUPPLY CURRENT                                                                                  QUIESCENT SUPPLY CURRENT                                                                                     ACTIVE SUPPLY CURRENT
                                                   vs. TEMPERATURE                                                                                           vs. TEMPERATURE                                                                                            vs. TEMPERATURE
                                0.70                                                                                                    14.0                                                                                                          36.0
                                                                                  MAX7306/7 toc01                                                                                                 MAX7306/7 toc02                                                                                         MAX7306/7 toc03
                                           INTERNAL OSCILLATOR OFF                                                                                 INTERNAL OSCILLATOR ON                                                                                       fSCL = 400kHz
QUIESCENT SUPPLY CURRENT (μA)                                                                           QUIESCENT SUPPLY CURRENT (μA)                                                                                 QUIESCENT SUPPLY CURRENT (μA)
                                0.65                                                                                                    13.5                                                                                                          35.5
                                0.60                                                                                                    13.0                                                                                                          35.0
                                0.55                                                                                                    12.5                                                                                                          34.5
                                0.50                                                                                                    12.0                                                                                                          34.0
                                0.45                                                                                                    11.5                                                                                                          33.5
                                0.40                                                                                                    11.0                                                                                                          33.0
                                       -40 -25 -10 5 20 35 50 65 80 95 110 125                                                                 -40 -25 -10 5 20 35 50 65 80 95 110 125                                                                       -40 -25 -10 5 20 35 50 65 80 95 110 125
                                                    TEMPERATURE (°C)                                                                                        TEMPERATURE (°C)                                                                                              TEMPERATURE (°C)
                                       PORT OPEN-DRAIN OUTPUT LOW VOLTAGE                                                                          PUSH-PULL OUTPUT HIGH VOLTAGE                                                                                       INTERNAL OSCILLATOR
                                                vs. SINK CURRENT                                                                                        vs. SOURCE CURRENT                                                                                               vs. TEMPERATURE
                                0.35                                                                                                    3.3                                                                                                           34.0
                                                                                  MAX7306/7 toc04                                                                                             MAX7306/7 toc05                                                                                         MAX7306/7 toc06
                                                                                                                                                                                  -40°C
                                0.30                            +125°C                                                                  3.2                                                                                                           33.5
OUTPUT-VOLTAGE LOW (V)                                                                              OUTPUT-VOLTAGE HIGH (V)
                                0.25
                                                                                                                                        3.1                                                                                                           33.0
                                                                                                                                                                                                                    FREQUENCY (kHz)
                                0.20                      +25°C
                                                                                                                                        3.0             +125°C                                                                                        32.5
                                0.15
                                                                                                                                        2.9                               +25°C                                                                       32.0
                                0.10
                                0.05                                                                                                    2.8                                                                                                           31.5
                                                                         -40°C
                                  0                                                                                                     2.7                                                                                                           31.0
                                       0        5       10      15         20    25                                                            0            3        6      9       12       15                                                              -40 -25 -10 5 20 35 50 65 80 95 110 125
                                                     SINK CURRENT (mA)                                                                                          SOURCE CURRENT (mA)                                                                                       TEMPERATURE (°C)
                                                                            STAGGERED PWM OUTPUT                                                                                           PUSH-PULL OUTPUT RISE TIME
                                                                                                                                                   MAX7306/7 toc07                                                                                                     MAX7306/7 toc08
                                                                                                                                                                     P1
                                                                                                                                                                                                                                                                                         CL = 10pF
                                                                                                                                                                     P2
                                                          2.00V/div                                                                                                               2V/div                                                                                                 CL = 100pF
                                                                                                                                                                     P3
                                                                                                                                                                     P4
                                                                                           400μs/div                                                                                                                                            20ns/div
                                                          _______________________________________________________________________________________                                                                                                                                                                       5


                  SMBus/I2C Interfaced 4-Port, Level-Translating
                  GPIOs and LED Drivers
                                                                                                                       Pin Description
MAX7306/MAX7307
                             PIN
                                            NAME                                              FUNCTION
                      MAX7306   MAX7307
                                                      Reset Input. RST is an active-low input, referenced to VDD, that clears the 2-wire interface,
                         1         1         RST      which can be configured to put the device in the power-up reset condition and reset the
                                                      PWM and blink timing.
                                                      Input/Output Port. P1/INT is configurable as an open-drain I/O or as a transition detection
                         2         2        P1/INT
                                                      interrupt output.
                         3         3         GND      Ground
                                                      Input/Output Port. P2/OSCIN is configurable as a push-pull I/O, open-drain I/O, or as the
                         4         4      P2/OSCIN
                                                      PWM/blink/timing oscillator input.
                                                      Input/Output Port. P3/OSCOUT is configurable as a push-pull I/O, open-drain I/O, or as
                         5         5      P3/OSCOUT
                                                      the PWM/blink/timing oscillator output.
                         6         6         P4       Input/Output Port. P4 is configurable as a push-pull I/O or an open-drain I/O.
                                                      Port Supply for P1–P4. Connect VLA to a power supply between 1.40V and 5.5V. Bypass
                        —          7         VLA
                                                      VLA to GND with a 0.1µF capacitor.
                                                      Address Input. Sets the device slave address. Connect to GND, VDD, SCL, or SDA to
                         7         —         AD0
                                                      provide four address combinations.
                         8         8         VDD      Positive Supply Voltage. Bypass VDD to GND with a 0.1µF ceramic capacitor.
                         9         9         SDA      Serial-Data I/O
                        10         10        SCL      Serial-Clock Input
                        —          —         EP       Exposed Pad (µMAX only). Connect to GND.
                  6    _______________________________________________________________________________________


  SMBus/I2C Interfaced 4-Port, Level-Translating
                         GPIOs and LED Drivers
                                                                                                         Block Diagram
                                                                                                                              MAX7306/MAX7307
                                                                                          MAX7307 ONLY
                                                           VDD                     VLA
                                 MAX7306/
                                 MAX7307
             SCL
                                                         OUTPUT
             SDA                                          LOGIC                    I/O                        P1–P4
                                   I 2C
             AD0
            MAX7306 ONLY
             RST
                                                           I/O                    INPUT
                                                         CONTROL                  LOGIC
                                 REGISTER
                                   BANK
                           Detailed Description                                                           Initial Power-Up
                                                                 On power-up, the MAX7307 default configuration has
The MAX7306/MAX7307 4-port, general-purpose port
                                                                 all ports configured as input ports with logic levels ref-
expanders operate from a 1.62V to 3.6V power supply.
                                                                 erenced to VLA. The MAX7306 default configuration
Ports P2 through P4 can be configured as inputs, push-
                                                                 has all ports configured as input ports with logic levels
pull outputs, and open-drain outputs. Port P1 can be
                                                                 referenced to VDD. The transition detection interrupt
configured as an input and an open-drain output; P1
                                                                 status flag resets and stays high (see Tables 1 and 2).
can also be configured to function as an (INT) output.
Each port configured as an open-drain or push-pull                              Device Configuration Registers
output can sink up to 25mA. Push-pull outputs also               The device configuration registers set up the interrupt
have a 10mA source drive capability. The MAX7306/                function, serial-interface bus timeout, PWM/blink, oscil-
MAX7307 are rated to sink a total of 100mA into any              lator options, global blink period, and reset options
combination of the output ports. Output ports have               (see Tables 3 and 4).
PWM and blink capabilities, as well as logic drive.
                   _______________________________________________________________________________________               7


                  SMBus/I2C Interfaced 4-Port, Level-Translating
                  GPIOs and LED Drivers
MAX7306/MAX7307
                  Table 1. Register Address Map
                                               REGISTER                                       ADDRESS         AUTOINCREMENT ADDRESS                 POR STATE
                  Port P1 or INT Output                                                           0x01                     0x02                          0x80
                  Port P2 or OSCIN Input                                                          0x02                     0x03                          0x80
                  Port P3 or OSCOUT Output                                                        0x03                     0x04                          0x80
                  Port P4                                                                         0x04                     0x05*                         0x80
                  Configuration 26                                                                0x26                     0x27                       0xEC
                  Configuration 27                                                                0x27                     0x28*                         0x8F
                  FACTORY RESERVED (Do not write to these registers)                          0x3C–0x3F                  0x3F–0x40                       0x00
                  FACTORY RESERVED (Do not write to these registers)                              0x00                     0x01                          0x80
                  *No registers are present.
                  Table 2. Power-Up Register Status
                                                                                                             ADDRESS                   REGISTER DATA
                            REGISTER                           POWER-UP CONDITION
                                                                                                             CODE (hex)    D7 D6 D5 D4 D3 D2 D1 D0
                                                Ports P_ are VLA referred input ports with interrupt
                  Ports P1–P4                                                                                0x01–0x04      1      0    0   0   0    0     0    0
                                                and debounce disabled
                                                RST does not reset registers or counters; blink period
                  Configuration 26                                                                              0x26        1      1    1   0   1    1     0    0
                                                is 1Hz; transition flag clear; interrupt status flag clear
                                                Ports P1–P4 are GPIO ports; bus timeout is
                  Configuration 27                                                                              0x27        1      0    0   0   1    1     1    1
                                                disabled
                  8   _______________________________________________________________________________________


  SMBus/I2C Interfaced 4-Port, Level-Translating
                         GPIOs and LED Drivers
                                                                                                                                MAX7306/MAX7307
Table 3. Configuration Register (0x26)
   REGISTER BIT      DESCRIPTION          VALUE                                       FUNCTION
                     Interrupt Status       0     An interrupt has occurred on at least one interrupt enabled input port.
         D7
                    Flag (Read-Only)       1*     No interrupt has occurred on an interrupt enabled input port.
                     Transition Flag        0     Transition has occurred on an input port.
         D6
                      (Read-Only)          1*     No transition has occurred on an input port.
         D5             Reserved            0     Reserved.
     D4, D3, D2    Blink Prescaler Bits    0/1    See Table 9 for blink frequency setting.
                                           0*     RST does not reset PWM/blink counters.
         D1            RST Timer
                                            1     RST resets PWM/blink counters.
                                           0*     RST does not reset registers to power-on-reset state.
         D0             RST POR
                                            1     RST resets registers to power-on-reset state.
*Default state.
Table 4. Configuration Register (0x27)
   REGISTER BIT      DESCRIPTION          VALUE                                       FUNCTION
                                            0     Enables the bus timeout feature.
         D7           Bus Timeout
                                           1*     Disables the bus timeout feature.
     D6, D5, D4         Reserved            0     Reserved.
                                            0     Sets P3 to output the oscillator.
         D3           P3/OSCOUT
                                           1*     Sets P3 as a GPIO controlled by register 0x03.
                                            0     Sets P2 as the oscillator input.
         D2            P2/OSCIN
                                           1*     Sets P2 as a GPIO controlled by register 0x02.
                                            0     Sets P1 as the interrupt output.
         D1          P1/INT Output
                                           1*     Sets P1 as a GPIO controlled by register 0x01.
         D0          Input Transition       0     Set to 0 on power-up for proper transition detection.
*Default state.
                  _______________________________________________________________________________________                   9


                  SMBus/I2C Interfaced 4-Port, Level-Translating
                  GPIOs and LED Drivers
                                                                 Slave Address                                                          I/O Port Registers
MAX7306/MAX7307
                  The MAX7307 is set to slave address 0x98 and the                              The port I/O registers set the I/O ports, one register per
                  MAX7306 can be set to one of four I2C slave addresses                         port (see Tables 6 and 7). Use the I/O port registers to
                  0x98 to 0x9F, using the address input AD0 (see Table 5)                       configure the ports individually as inputs, open-drain, or
                  and is accessed over an I2C or SMBus serial interface.                        push-pull outputs. Port P1 can only be configured as an
                  The MAX7306 slave address is determined on each I2C                           input or an open-drain output. The push-pull bit (D6) set-
                  transmission, regardless of the transmission actually                         ting for the port I/O register P1 is ignored.
                  addressing the device or not. The MAX7306 distin-
                  guishes whether address input AD0 is connected to                                                                           I/O Input Port
                  SDA, SCL, V DD , or GND during the transmission.                              Configure a port as an input by writing a logic-high to the
                  Therefore, the MAX7306 slave address can be config-                           MSB (bit D7) of the port I/O register (see Table 6). To
                  ured dynamically in an application without toggling the                       obtain the logic level of the port input, read the port I/O
                  device supply.                                                                register bit, D0. This readback value is the instantaneous
                                                                                                logic level at the time of the read request if debounce is
                  Table 5. Slave-Address Selection                                              disabled for the port (port I/O register bit D2 = 0), or the
                                                                                                debounced result if debounce is enabled for the port
                     AD0                          DEVICE ADDRESS                                (port I/O register bit D2 = 1). See Figure 1 for input port
                  CONNECTION       A6   A5       A4    A3       A2    A1     A0     R/W         structure.
                        GND        1     0        0     1       1     0      0      0/1
                                                                                                                                          I/O Output Port
                        VDD        1     0        0     1       1     0      1      0/1         Configure a port as an output by writing a logic-low to the
                        SCL        1     0        0     1       1     1      0      0/1         MSB (bit D7) of the port I/O register. The device reads
                        SDA        1     0        0     1       1     1      1      0/1         back the logic level, PWM, or the blink setting of the port
                                                                                                (see Table 7).
                  Table 6. Port I/O Registers (I/O Port Set as an Input, Registers 0x01 to 0x04)
                       REGISTER BIT       DESCRIPTION                VALUE                                            FUNCTION
                           D7                Port I/O Set Bit          1         Sets the I/O port as an input.
                                              Port Supply              0         Refers the input to the VLA supply voltage.
                           D6*
                                              Reference                1         Refers the input to the VDD supply voltage.
                                        Transition Interrupt           0         Disables the transition interrupt.
                           D5
                                              Enable                   1         Enables the transition interrupt.
                          D4, D3               Reserved                0         Do not write to these registers.
                                                                       0         Disables debouncing of the input port.
                           D2                  Debounce
                                                                       1         Enables debouncing of the input port.
                                          Port Transition              0         No transition has occurred since the last port read.
                           D1
                                        State (Read-Only)              1         A transition has occurred since the last port read.
                                               Port Status             0         Port input is logic-low.
                           D0
                                              (Read-Only)              1         Port input is logic-high.
                  *Bit D6 controls the I/O’s supply reference for the MAX7307. The MAX7306 ignores bit D6.
                  10    ______________________________________________________________________________________


  SMBus/I2C Interfaced 4-Port, Level-Translating
                         GPIOs and LED Drivers
                                                                                                                                                            MAX7306/MAX7307
                                                                                                                            MAX7307 ONLY
                                                                                                                VDD   VLA
                              PORT_[2]
                            (DEBOUNCE)                                                                            1   0
                                                                                                   PORT_[6]
                                                                                                (THRESHOLD
                                                                                                    SELECT)
               PORT_[0]          0                                                                                                         I/O
               (PORTIN)
                                 1                                                          DEBOUNCE LOGIC
                                           TRANSITION                          TRANSITION
                                           DETECTION                           DETECTION
                                                               INTERRUPT                PORT_ [5]
                                                                 LOGIC                  INTERRUPT
                                                                                        ENABLE
                                                                  INT
                                                        INT2
                                     INT
                                                        INT4
Figure 1. Input Port Structure
Table 7. Port I/O Registers (I/O Port Set as an Output, Registers 0x01 to 0x04)
   REGISTER BIT            DESCRIPTION              VALUE                                                     FUNCTION
         D7                Port I/O Set Bit                0            Sets the I/O port as an output.
                          Output Port Set to               0            Sets the output type to open-drain.
         D6                   Push-Pull
                           or Open-Drain                   1            Sets the output type to push-pull.
                                                           0            Sets the output to PWM mode.
         D5               PWM/Blink Enable
                                                           1            Sets the output to blink mode.
                                                           0            MSB of the 5-bit duty cycle setting. See the PWM and Blink Timing section.
         D4                Duty Cycle Bit 4
                                                           1            MSB of the 5-bit duty cycle setting. See the PWM and Blink Timing section.
                                                           0            Bit 3 of the 5-bit duty cycle setting. See the PWM and Blink Timing section.
         D3                Duty Cycle Bit 3
                                                           1            Bit 3 of the 5-bit duty cycle setting. See the PWM and Blink Timing section.
                                                           0            Bit 2 of the 5-bit duty cycle setting. See the PWM and Blink Timing section.
         D2                Duty Cycle Bit 2
                                                           1            Bit 2 of the 5-bit duty cycle setting. See the PWM and Blink Timing section.
                                                           0            Bit 1 of the 5-bit duty cycle setting. See the PWM and Blink Timing section.
         D1                Duty Cycle Bit 1
                                                           1            Bit 1 of the 5-bit duty cycle setting. See the PWM and Blink Timing section.
                                                           0            LSB of the 5-bit duty cycle setting. See the PWM and Blink Timing section.
         D0                Duty Cycle Bit 0
                                                           1            LSB of the 5-bit duty cycle setting. See the PWM and Blink Timing section.
                      ______________________________________________________________________________________                                           11


                  SMBus/I2C Interfaced 4-Port, Level-Translating
                  GPIOs and LED Drivers
MAX7306/MAX7307
                                                                                                      PORT_[5]
                                                                                        5-BIT PWM                      0
                                                                                        PORT_[4:0]
                                                                                                                                                  I/O
                                 CLOCK                    3-BIT PRESCALER               4-BIT BLINK                    1
                                                           CONFIG26 [4:2]               PORT_[3:0]
                  Figure 2. Output Port Structure
                                                    VDD        VLA MAX7307 ONLY                                  VDD           VLA MAX7307 ONLY
                                         SELECT                                                       SELECT
                                                                                                                                                        PORTS P2
                                          INPUT                                   PORT P1               INPUT
                                                                                                                                                        THROUGH P4
                                         OUTPUT                                                       OUTPUT
                                                          P1                                                      P2, P3, P4
                  Figure 3. Port I/O Structure
                             Port Supplies and Level Translation                             Ports P2 through P4 are overvoltage protected to VLA.
                  The MAX7307 features a port supply, VLA, that provides                     This is true even for a port used as an input with a VDD
                  the logic supplies to all push-pull I/O ports. P2 through                  port logic-input threshold. Port P1 is overvoltage pro-
                  P4 can be configured as push-pull I/O ports (see Figure                    tected to 5.5V, independent of VDD and VLA (see Figure
                  3). VLA powers the logic-high port output voltage sourc-                   3). To mix logic outputs with more than one voltage
                  ing the logic-high port load current. VLA provides level                   swing on a group of ports using the same port supply,
                  translation capability for the outputs and operates over a                 set the port supply voltage (VLA) to be the highest out-
                  1.40V to 5.5V voltage independent of the power-supply                      put voltage. Use push-pull outputs and port P1 for the
                  voltage, VDD.                                                              highest voltage ports, and use open-drain outputs with
                  Each port of the MAX7307 set as an input can be config-                    external pullup resistors for the lower voltage ports. For
                  ured to switch midrail of either the VDD or the VLA port                   the MAX7307, when P2, P3, and P4 ports are acting as
                  supplies. Whenever the port supply reference is                            an input referenced to VDD, make sure the VLA voltage
                  changed from VDD to VLA, or vice versa, read the port                      is greater than VDD - 0.3V.
                  register to clear any transition flag on the port.
                  12   ______________________________________________________________________________________


  SMBus/I2C Interfaced 4-Port, Level-Translating
                         GPIOs and LED Drivers
                                         Input Debounce           Ports configured as outputs do not feature transition
                                                                                                                                 MAX7306/MAX7307
The MAX7306/MAX7307 sample the input ports every                  detection, and therefore, cannot cause an interrupt.
31ms if input debouncing is enabled for an input port             The INT output never reasserts during a read sequence
(D2 = 1 of the port I/O register). The MAX7306/MAX7307            because this process could cause a recursive reentry
compare each new sample with the previous sample. If              into the interrupt service routine. Instead, if a data
the new sample and the previous sample have the same              change occurs during the read that would normally set
value, the corresponding internal register updates.               the INT output, the interrupt assertion is delayed until
When the port input is read through the serial interface,         the STOP condition. If the changed input data is read
the MAX7306/MAX7307 do not return the instantaneous               before the STOP condition, a new interrupt is not
backing value of the logic level from the port because            required and not asserted. The INT bit and INT output
debounce is active. Instead, the MAX7306/MAX7307                  (if selected) have the same value at all times.
return the stored debounced input signal.
                                                                                                             Transition Flag
When debouncing is enabled for a port input, transition           The transition bit in device configuration register 0x26 is
detection applies to the stored debounced input signal            a NOR of all the port I/O registers’ individual transition
value, rather than to the instantaneous value at the              bits. A port’s I/O register’s transition bit sets when that
input. This process allows for useful transition detection        port is set as an input, and the input changes from the
of noisy signals, such as keyswitch inputs, without               port’s I/O registers last read through the serial interface.
causing spurious interrupts.                                      A port’s individual transition bit clears by reading that
          Port Input Transition Detection and Interrupt           port’s I/O register. Always write a 0 to bits D4 and D3 of
Any transition on ports configured as inputs automatically        the configuration register 0x26 to properly configure a
set the D1 bit of that port’s I/O registers high. Any input can   transition detection. The transition flag of configuration
be selected to assert an interrupt output indicating a transi-    register 0x26 is only cleared after reading all ports I/O
tion has occurred at the input port(s). The MAX7306/              registers on which a transition has ocurred.
MAX7307 sample the port input (internally latched into a                                                        RST Input
snapshot register) during a read access to its port P_ I/O        The active-low RST input operates as a hardware reset
register. The MAX7306/MAX7307 continuously compare                that voids any ongoing I 2 C transition involving the
the snapshot with the port’s input condition. If the device       MAX7306/MAX7307 (this feature allows the
detects a change for any port input, an internal transition       MAX7306/MAX7307 supply current to be minimized in
flag sets for that port. Read register 0x26 to clear the inter-   power-critical applications by effectively disconnecting
rupt, then read all the port I/O registers (0x01 to 0x04) by      the MAX7307 from the bus). RST also operates as a
initiating a burst read to clear the MAX7306/MAX7307’s            chip enable, allowing multiple devices to use the same
internal transition flag. Note that when debouncing is            I2C slave address if only one MAX7306/MAX7307 has
enabled for a port input, transition detection applies to the     its RST input high at any time. RST can be configured
stored debounced input signal value, rather than to the           to restore all port registers to the power-up settings by
instantaneous value at the input. Transition bits D4 and          setting bit D0 of device configuration register 0x26
D3 of port registers must be set to 0 to detect the next          (Table 1). RST can also be configured to reset the inter-
rising or falling edge on the input port (P_).                    nal timing counters used for PWM and blink by setting
The MAX7306/MAX7307 allow the user to select the                  bit D1 of device configuration register 0x26.
input port(s) that cause an interrupt on the INT output.          When RST is low, the MAX7306/MAX7307 are forced
Set INT for each port by using the INT enable bit (bit            into the I2C STOP condition. The reset action does not
D5) in each port P_ register. The appropriate port’s              clear the interrupt output INT.
transition flag always sets when an input changes,
regardless of the port’s INT enable bit settings. The INT         The RST input is referenced to VDD and is overvoltage
enable bits allow processor interrupt only on critical            tolerant up to the supply voltage, VLA.
events, while the inputs and the transition flags can be                                                      INT Output
polled periodically to detect less critical events. When          Port P1 can be configured as a latching interrupt out-
debounce is disabled, a signal transition between the             put, INT, that flags any transients on any combination of
9th and 11th falling edges of the clock will not be regis-        selected ports configured as inputs. Any transitions
tered, since the transition is detected and cleared at            occurring at the selected inputs assert INT low to alert
the same time.
                    ______________________________________________________________________________________                 13


                  SMBus/I2C Interfaced 4-Port, Level-Translating
                  GPIOs and LED Drivers
                  the host processor of data changes at the selected                 port options using the device configuration register
MAX7306/MAX7307
                  inputs. Reset INT by reading any port’s I/O registers              0x27 bits D2 and D3 (see Table 2).
                  (0x01 to 0x04).                                                    The P2/OSCIN port is overvoltage protected to supply
                                                             Standby Mode            voltage VLA for the MAX7307, so the external clock can
                  Upon power-up, the MAX7306/MAX7307 enter standby                   exceed VDD if VLA is greater than VDD. The external
                  mode when the serial interface is idle. If any of the PWM          clock cannot exceed VDD for the MAX7306. The port P2
                  intensity control, blink, or debounce features are used,           register (see Tables 2 and 6) sets the P2/OSCIN logic
                  the operating current rises because the internal PWM               threshold (30%/70%) to either the VDD supply or the VLA.
                  oscillator is running and toggling counters. When using            Use OSCOUT or an external clock source to cascade
                  OSCIN to override the internal oscillator, the operating           up to four MAX7306s per master for applications requir-
                  current varies according to the frequency at OSCIN.                ing additional ports. To synchronize the blink action
                  When the serial interface is active, the operating current         across multiple MAX7306s (see Figures 4 and 5), use
                  also increases because the MAX7306/MAX7307, like all               OSCOUT from one MAX7306 to drive OSCIN of the
                  I2C slaves, have to monitor every transmission. The bus            other MAX7306s. This process ensures the same blink
                  timeout circuit and debounce circuit use the internal oscil-       frequency of all the devices, but also make sure to syn-
                  lator even if OSCIN is selected.                                   chronize the blink phase. The blink timing of multiple
                                                                                     MAX7306s is synchronous at the instant of power-up
                       Internal Oscillator and OSCIN/OSCOUT                          because the blink and PWM counters clear by each
                                       External Clock Options                        device’s internal reset circuit, and by default the
                  The MAX7306/MAX7307 contain an internal oscillator                 device’s internal oscillators are off upon power-up.
                  nominally at 32kHz. The MAX7306/MAX7307 always use
                                                                                     Ensure that the blink phase of all the devices remains
                  the internal oscillator for bus timeout and for debounce
                                                                                     synchronized by programming the OSCIN and
                  timing (when enabled). The internal oscillator is also
                                                                                     OSCOUT functionality before programming any feature
                  used by default to generate PWM and blink timing. The
                                                                                     that causes a MAX7306’s internal oscillator to operate
                  internal oscillator only runs when the clock output
                                                                                     (blink, PWM, bus timeout, or key debounce). Configure
                  OSCOUT is needed to keep the operating current as
                                                                                     the RST input to reset the internal timing counters used
                  low as possible.
                                                                                     for PWM and blink by setting bit D1 of device configu-
                  The MAX7306/MAX7307 can use an external clock                      ration register 0x26 (see Table 3).
                  source instead of the internal oscillator for the PWM
                  and blink timing. The external clock can range from DC
                  to 1MHz and it connects to the P2/OSCIN port. The
                  P3/OSCOUT port provides a buffered and level-shifted
                  output of the internal oscillator or external clock to drive
                  other devices. Select the P2/OSCIN and P3/OSCOUT
                                           MAX7306/MAX7307                 MAX7306/MAX7307              MAX7306/MAX7307
                                                      P3/OSCOUT        P2/OSCIN                      P2/OSCIN
                                           MAX7306/MAX7307                 MAX7306/MAX7307              MAX7306/MAX7307
                                                      P3/OSCOUT        P2/OSCIN       P3/OSCOUT      P2/OSCIN
                  Figure 4. Synchronizing Multiple MAX7306/MAX7307s (Internal Oscillator)
                  14   ______________________________________________________________________________________


  SMBus/I2C Interfaced 4-Port, Level-Translating
                         GPIOs and LED Drivers
                                                                                                                                         MAX7306/MAX7307
                          0MHz TO 1MHz              MAX7306                          MAX7306                       MAX7306
           EXTERNAL
                                         P2/OSCIN                         P2/OSCIN                      P2/OSCIN
          OSCILLATOR
                          0MHz TO 1MHz              MAX7306                          MAX7306                       MAX7306
           EXTERNAL                      P2/OSCIN                         P2/OSCIN         P3/OSCOUT    P2/OSCIN
                                                              P3/OSCOUT
          OSCILLATOR
Figure 5. Synchronizing Multiple MAX7306s (External Clock)
                                PWM and Blink Timing                      A PWM period contains 32 cycles of the nominal 1kHz
The MAX7306/MAX7307 divide the 32kHz nominal                              PWM clock (see Figure 6). Set ports individually to a
internal oscillator OSC or external clock source OSCIN                    PWM duty cycle between 0/32 and 31/32. For static
frequency by 32 to provide a nominal 1kHz PWM fre-                        logic-level low output, set the ports to 0/32 PWM, and
quency. Use the reset function to synchronize multiple                    for static logic-level high output, set the port register to
MAX7306s that are operating from the same OSCIN, or                       0111xxxx (see Table 8). The MAX7306/MAX7307 stag-
to synchronize a single MAX7306/MAX7307’s blink tim-                      ger the PWM timing of the 4-port outputs, in single or dual
ing to an external event. Configure the RST input to                      ports, by 1/8 of the PWM period. These phase shifts dis-
reset the internal timing counters used by PWM and                        tribute the port-output switching points across the PWM
blink by setting bit D1 of the device configuration regis-                period (see Figure 7). This staggering reduces the di/dt
ter 0x26 (see Table 3).                                                   output-switching transient on the supply and also
The MAX7306/MAX7307 use the internal oscillator by                        reduces the peak/mean current requirement.
default. Configure port P2 using device configuration                     All ports feature LED blink control. A global blink period
register 0x27 bit D2 (see Table 4) as an external clock                   of 1/8 second, 1/4 second, 1/2 second, 1, 2, 4, or 8
source input, OSCIN, if the application requires a par-                   seconds applies to all ports. See Table 9. Any port can
ticular or more accurate timing for the PWM or blink                      blink during this period with a 1/16 to 15/16 duty cycle,
functions. OSCIN only applies to PWM and blink; the                       adjustable in 1/16 increments. See Table 10. For PWM
MAX7306/MAX7307 always use the internal oscillator for                    fan control, the MAX7306/MAX7307 can set the blink
debouncing and bus timeout. OSCIN can range up to                         frequency to 32Hz.
1MHz. Use device configuration register 0x27 bit D3
(see Table 2) to configure port P3 as OSCOUT to out-
put a MAX7306/MAX7307’s clock. The MAX7306/
MAX7307 buffer the clock output of either the internal
oscillator OSC or the external clock source OSCIN,
according to port D2’s setup. Synchronize multiple
MAX7306s without using an external clock source input
by configuring one MAX7306 to generate OSCOUT
from its internal clock, and use this signal to drive the
remaining MAX7306s’ OSCIN.
                       ______________________________________________________________________________________                      15


                  SMBus/I2C Interfaced 4-Port, Level-Translating
                  GPIOs and LED Drivers
MAX7306/MAX7307
                           PORT
                       REGISTER                                             977μs NOMINAL PWM PERIOD (1024Hz PERIOD)
                         VALUE
                                                                                                                                                            HIGH IMPEDANCE
                  0b0X000000      OUTPUT STATIC LOW (STATIC LOGIC-LOW OUTPUT OR LED DRIVE ON)
                                                                                                                                                            LOW
                                                                                                                                                            HIGH IMPEDANCE
                  0b0X000001      OUTPUT LOW 1/32 DUTY PWM
                                                                                                                                                            LOW
                                                                                                                                                            HIGH IMPEDANCE
                  0b0X000010      OUTPUT LOW 2/32 DUTY PWM
                                                                                                                                                            LOW
                                                                                                                                                            HIGH IMPEDANCE
                  0b0X000011      OUTPUT LOW 3/32 DUTY PWM
                                                                                                                                                            LOW
                                                                                                                                                            HIGH IMPEDANCE
                  0b0X011101      OUTPUT LOW 29/32 DUTY PWM
                                                                                                                                                            LOW
                                                                                                                                                            HIGH IMPEDANCE
                  0b0X011110      OUTPUT LOW 30/32 DUTY PWM
                                                                                                                                                            LOW
                                                                                                                                                            HIGH IMPEDANCE
                  0b0X011111      OUTPUT LOW 31/32 DUTY PWM
                                                                                                                                                            LOW
                                                                                                                                                            HIGH IMPEDANCE
                  0b0111XXXX      OUTPUT STATIC HIGH (STATIC LOGIC-HIGH OUTPUT OR LED DRIVE OFF)
                                                                                                                                                            LOW
                  Figure 6. Static and PWM Port Output Waveforms
                                             977μs NOMINAL PWM PERIOD                    NEXT PWM PERIOD                     NEXT PWM PERIOD
                                       0         1         2        3          4
                                                                OUTPUT P1                             OUTPUT P1                         OUTPUT P1
                                                                         OUTPUT P2                              OUTPUT P2                       OUTPUT P2
                                                                                    OUTPUT P3                           OUTPUT P3
                                                                                             OUTPUT P4                          OUTPUT P4
                  Figure 7. Staggered PWM Phasing Between Port Outputs
                  16      ______________________________________________________________________________________


  SMBus/I2C Interfaced 4-Port, Level-Translating
                         GPIOs and LED Drivers
                                                                                                                                   MAX7306/MAX7307
Table 8. PWM Settings on Output Ports
                                                                                       REGISTER DATA
                       PWM SETTING
                                                                  D7     D6    D5        D4    D3       D2      D1        D0
Port P_ is a static logic-level low output port                   0      X      0        0      0        0       0        0
Port P_ is a PWM output port; PWM duty cycle is 1/32              0      X      0        0      0        0       0        1
Port P_ is a PWM output port; PWM duty cycle is 3/32              0      X      0        0      0        0       1        1
Port P_ is a PWM output port; PWM duty cycle is 7/32              0      X      0        0      0        1       1        1
Port P_ is a PWM output port; PWM duty cycle is 15/32             0      X      0        0      1        1       1        1
Port P_ is a PWM output port; PWM duty cycle is 31/32             0      X      0        1      1        1       1        1
Port P_ is a static logic-level high output port                  0      1      1        1      X        X       X        X
Table 9. Blink and PWM Frequencies
                                         DEVICE CONFIGURATION               BLINK OR PWM
                                             REGISTER 0x66                                               BLINK OR PWM
                                                                          FREQUENCY (32kHz
    BLINK OR PWM SETTING                                                                            FREQUENCY (0Hz TO 1MHz
                                        BIT D4     BIT D3      BIT D2   INTERNAL OSCILLATOR)
                                                                                                     EXTERNAL OSCILLATOR)
                                        BLINK2     BLINK1      BLINK0            (Hz)
Blink period is 8 seconds (0.125Hz)        0          0           0            0.125                    OSCIN / 262,144
Blink period is 4 seconds (0.25Hz)         0          0           1            0.25                     OSCIN / 131,072
Blink period is 2 seconds (0.5Hz)          0          1           0             0.5                     OSCIN / 65,536
Blink period is 1 second (1Hz)             0          1           1              1                      OSCIN / 32,768
Blink period is a 1/2 second (2Hz)         1          0           0              2                      OSCIN / 16,384
Blink period is a 1/4 second (4Hz)         1          0           1              4                       OSCIN / 8192
Blink period is an 1/8 second (8Hz)        1          1           0              8                       OSCIN / 4096
Blink period is a 1/32 second (32Hz)       1          1           1             32                       OSCIN / 1024
PWM                                        X          X           X            1024                       OSCIN / 32
Table 10. Blink Settings on Output Ports
                                                                                       REGISTER DATA
                     BLINK SETTINGS
                                                                  D7     D6    D5        D4    D3       D2      D1        D0
Port P_ is a static logic-level low output port                   0      X      1        0      0        0       0        0
Port P_ is a blinking output port; blink duty cycle is 1/16       0      X      1        0      0        0       0        1
Port P_ is a blinking output port; blink duty cycle is 3/16       0      X      1        0      0        0       1        1
Port P_ is a blinking output port; blink duty cycle is 7/16       0      X      1        0      0        1       1        1
Port P_ is a blinking output port; blink duty cycle is 15/16      0      X      1        0      1        1       1        1
Port P_ is a static logic-level high output port                  0      1      1        1      X        X       X        X
X = Don’t care.
                     ______________________________________________________________________________________                   17


                  SMBus/I2C Interfaced 4-Port, Level-Translating
                  GPIOs and LED Drivers
                                                                Serial Interface                                                           START and STOP Conditions
MAX7306/MAX7307
                                                                                                                  Both SCL and SDA remain high when the interface is
                                                                      Serial Addressing                           not busy. A master signals the beginning of a transmis-
                  The MAX7306/MAX7307 operate as a slave that sends                                               sion with a START (S) condition by transitioning SDA
                  and receives data through an I2C-compatible, 2-wire                                             from high to low while SCL is high. When the master
                  interface. The interface uses a serial-data line (SDA)                                          has finished communicating with the slave, it issues a
                  and a serial-clock line (SCL) to achieve bidirectional                                          STOP (P) condition by transitioning SDA from low to
                  communication between master(s) and slave(s). A                                                 high while SCL is high. The bus is then free for another
                  master (typically a microcontroller) initiates all data                                         transmission (see Figure 9).
                  transfers to and from the MAX7306/MAX7307 and gen-
                  erates the SCL clock that synchronizes the data trans-                                                                                  Bit Transfer
                  fer (see Figure 8).                                                                             One data bit is transferred during each clock pulse.
                                                                                                                  The data on SDA must remain stable while SCL is high
                  The MAX7306/MAX7307 SDA line operates as both an
                                                                                                                  (see Figure 10).
                  input and an open-drain output. A 4.7kΩ (typ) pullup
                  resistor is required on SDA. The MAX7306/MAX7307                                                                                           Acknowledge
                  SCL line operates only as an input. A 4.7kΩ (typ) pullup                                        The acknowledge bit is a clocked 9th bit that the recipient
                  resistor is required on SCL if there are multiple masters                                       uses to acknowledge receipt of each byte of data (see
                  on the 2-wire interface, or if the master in a single-mas-                                      Figure 11). Thus, each effectively transferred byte
                  ter system has an open-drain SCL output.                                                        requires 9 bits. The master generates the 9th clock pulse,
                  Each transmission consists of a START condition (see                                            and the recipient pulls down SDA during the acknowledge
                  Figure 9) sent by a master, followed by the MAX7306/                                            clock pulse, so the SDA line is stable low during the high
                  MAX7307 7-bit slave address plus R/W bit, a register                                            period of the clock pulse. When the master is transmitting
                  address byte, one or more data bytes, and finally a STOP                                        to the MAX7306/MAX7307, the devices generate the
                  condition (see Figure 9).                                                                       acknowledge bit because the MAX7306/MAX7307 are the
                                      SDA
                                                                                                        tSU,STA                                                         tBUF
                                                                           tSU,DAT                                           tHD,STA
                                                               tLOW
                                                                                          tHD,DAT                                                     tSU,STO
                                      SCL                                   tHIGH
                                         tHD,STA
                                                                      tR             tF
                                             START CONDITION                                            REPEATED START CONDITION                                  STOP           START
                                                                                                                                                                CONDITION      CONDITION
                                     RESET
                                                                                                                          tWL(RST)
                  Figure 8. 2-Wire Serial Interface Timing Details
                                                                                                                    SDA
                       SDA
                       SCL                                                                                          SCL
                             S                                                                      P
                           START                                                              STOP
                         CONDITION                                                          CONDITION                                DATA LINE STABLE; CHANGE OF DATA
                                                                                                                                        DATA VALID        ALLOWED
                  Figure 9. Start and Stop Conditions                                                             Figure 10. Bit Transfer
                  18     ______________________________________________________________________________________


  SMBus/I2C Interfaced 4-Port, Level-Translating
                         GPIOs and LED Drivers
recipients. When the MAX7306/MAX7307 transmit to the                                  Message Format for Writing to the MAX7306/MAX7307
                                                                                                                                                          MAX7306/MAX7307
master, the master generates the acknowledge bit                                     A write to the MAX7306/MAX7307 comprises the trans-
because the master is the recipient.                                                 mission of the MAX7306/MAX7307’s slave address with
                                                                                     the R/W bit set to zero, followed by at least 1 byte of
                                         Slave Address                               information. The first byte of information is the command
The MAX7306/MAX7307 have a 7-bit long slave                                          byte. The command byte determines which register of
address (Figure 12). The 8th bit following the 7-bit slave                           the MAX7306/MAX7307 is to be written to by the next
address is the R/W bit. Set the R/W bit low for a write                              byte, if received (see Table 1). If a STOP condition is
command and high for a read command.                                                 detected after the command byte is received, the
The first 5 bits of the MAX7306 slave address (A6–A2)                                MAX7306/MAX7307 take no further action beyond stor-
are always 1, 0, 0, 1, and 1. Slave address bits A1 and                              ing the command byte (see Figure 13).
A0 are selected by the address input AD0. AD0 can be                                 Any bytes received after the command byte are data
connected to GND, VDD, SDA, or SCL. The MAX7306                                      bytes. The first data byte goes into the internal register of
has four possible slave addresses (see Table 5), and                                 the MAX7306/MAX7307 selected by the command byte
therefore, a maximum of four MAX7306 devices can be                                  (see Figure 14). If multiple data bytes are transmitted
controlled independently from the same interface. The                                before a STOP condition is detected, these bytes are
MAX7307 features a permanent slave address of 0x98.                                  generally stored in subsequent MAX7306/MAX7307
                                                                                     internal registers because the command byte address
              START                              CLOCK PULSE                         autoincrements (see Table 1).
            CONDITION                       FOR ACKNOWLEDGE
         SCL                   1        2              8        9
                                                                                                             Message Format for Reading
                                                                                     The MAX7306/MAX7307 are read using the MAX7306/
       SDA BY                                                                        MAX7307’s internally stored command byte as an
  TRANSMITTER                                                                        address pointer the same way the stored command byte
       SDA BY                                                                        is used as an address pointer for a write. The pointer
     RECEIVER   S                                                                    autoincrements after each data byte is read using the
Figure 11. Acknowledge
         SDA         1              0             0             1              1                1                A0              R/W           ACK
                    MSB                                                                                          LSB
         SCL
Figure 12. Slave Address
                                                                                   D15   D14   D13   D12   D11        D10   D9   D8
                                                ACKNOWLEDGE FROM MAX7306
                         S                  SLAVE ADDRESS            0     A                     REGISTER ADDRESS                      A   P
                                                               R/W                                     ACKNOWLEDGE FROM MAX7306
Figure 13. Register Address Received
                             ______________________________________________________________________________________                                  19


                  SMBus/I2C Interfaced 4-Port, Level-Translating
                  GPIOs and LED Drivers
MAX7306/MAX7307
                             WRITE TO OUTPUT PORTS REGISTERS
                             (P4)
                       SCL            1        2        3     4       5       6        7        8         9
                                                        SLAVE ADDRESS                                                                   REGISTER ADDRESS
                       SDA      S      1        0       0     1         1     A1       A0        0         A         0      0       0       0      0         1       0   0         A           MSB              DATA       LSB     AA         P
                             START CONDITION                                                    R/W       ACKNOWLEDGE FROM SLAVE                                                   ACKNOWLEDGE FROM SLAVE                                    STOP
                                                                                                                                                                                                                                 ACKNOWLEDGE
                   P4–P1                                                                                                                                                                                                               DATA VALID
                                                                                                                                                                                                                                 tPPV
                  Figure 14. Write to Output Port Registers
                             READ FROM INPUT PORTS REGISTERS
                       SCL            1        2        3     4         5     6         7        8             9
                       SDA      S      1        0        0     1          1       A1       A0       1          A     MSB                        DATA1                        LSB       A        MSB               DATA4          LSB    NA          P
                              START CONDITION                                                   R/W            ACKNOWLEDGE FROM SLAVE                                                  ACKNOWLEDGE FROM MASTER                               STOP
                                                                                                                                                                                                                                        NO ACKNOWLEDGE
                   P4–P1                                      DATA1                                                         DATA2                                DATA3                                             DATA4
                                                                                                         tPH                                                             tPSU
                  Figure 15. Read from Input Port Registers
                             INTERRUPT VALID/RESET
                    SCL               1        2        3     4         5     6            7        8          9
                    SDA        S      1         0       0      1          1       1    A0            1         A      MSB                       DATA2                        LSB           A     MSB               DATA3          LSB     NA            P
                              START CONDITION                                                   R/W            ACKNOWLEDGE FROM SLAVE                                                  ACKNOWLEDGE FROM MASTER                                STOP
                                                                                                                                                                                                                                   NO ACKNOWLEDGE
                   P4–P1                        DATA1                                                              DATA2                                                                               DATA3
                       INT
                                                                                                                                tIR                                                                      t IR
                                                                              tIV                                                                      tIV
                  Figure 16. Interrupt and Reset Timing
                  same rules as for a write. Thus, a read is initiated by first                                                                              address pointer, and the read(s) that takes the data
                  configuring the MAX7306/MAX7307’s command byte                                                                                             from the location(s). This is because it is possible for
                  by performing a write (Figure 13). The master can now                                                                                      master 2 to take over the bus after master 1 has set up
                  read n consecutive bytes from the MAX7306/                                                                                                 the MAX7306/MAX7307’s address pointer, but before
                  MAX7307 with the first data byte being read from the                                                                                       master 1 has read the data. If master 2 subsequently
                  register addressed by the initialized command byte                                                                                         changes the MAX7306/MAX7307’s address pointer,
                  (Figure 15). When performing read-after-write verifica-                                                                                    then master 1’s delayed read can be from an unexpect-
                  tion, remember to reset the command byte’s address                                                                                         ed location.
                  because the stored command byte address has been
                  autoincremented after the write (see Table 1).                                                                                                                                        Bus Timeout
                                                                                                                                                             Clear device configuration register 0x27 bit D7 to
                                        Operation with Multiple Masters                                                                                      enable the bus timeout function (see Table 2), or set it
                  If the MAX7306/MAX7307 are operated on a 2-wire                                                                                            to disable the bus timeout function. Enabling the time-
                  interface with multiple masters, a master reading the                                                                                      out feature resets the MAX7306/MAX7307 serial-bus
                  MAX7306/MAX7307 should use a repeated start                                                                                                interface when SCL stops either high or low during a
                  between the write that sets the MAX7306/MAX7307’s                                                                                          read or write. If either SCL or SDA is low for more than
                  20         ______________________________________________________________________________________


  SMBus/I2C Interfaced 4-Port, Level-Translating
                         GPIOs and LED Drivers
nominally 31ms after the start of a valid serial transfer,   where:
                                                                                                                          MAX7306/MAX7307
the interface resets itself and sets up SDA as an input.         RLED is the resistance of the resistor in series with
The MAX7306/MAX7307 then waits for another START                 the LED (Ω)
condition.
                                                                 VSUPPLY is the supply voltage used to drive the
                Applications Information                         LED (V)
                                        Hot Insertion             VLED is the forward voltage of the LED (V)
Serial interfaces SDA, SCL (and AD0 for the MAX7306)              VOL is the output low voltage of the MAX7306/
remain high impedance with up to 5.5V asserted on                 MAX7307 when sinking ILED (V)
them when the MAX7306/MAX7307 are powered down                    ILED is the desired operating current of the LED (A).
(VDD = 0V), independent of the voltages on the port
supply VLA. When VDD = 0V, or if VDD falls below the         For example, to operate a 2.2V red LED at 20mA from a
MAX7306/MAX7307’s reset threshold, all I/O ports             5V supply, RLED = (5 - 2.2 - 0.2) / 0.020 = 100Ω.
become high impedance. Ports P2 through P4 remain               Driving Load Currents Higher than 25mA
high impedance to signals between 0V and the port            The MAX7306/MAX7307 can sink current from loads
supply VLA for the MAX7307 and VDD for the MAX7306.          drawing more than 25mA by sharing the load across
Port P1 goes high impedance to signals up to 5.5V. If a      multiple ports configured as open-drain outputs. Use at
signal outside this range is applied to a port, the port’s   least one output per 25mA of load current; for example,
protection diodes clamp the input signal to VLA or 0V,       drive a 90mA white LED with four ports.
as appropriate. If the MAX7307’s VLA is lower than the
                                                             The register structure of the MAX7306/MAX7307 allows
input signal, the port pulls up VLA, and the protection
                                                             only one port to be manipulated at a time. Do not con-
diode effectively powers any load on VLA from the input
                                                             nect ports directly in parallel because multiple ports
signal. This behavior is safe if the current through each
                                                             cannot be switched high or low at the same time, which
protection diode is limited to 10mA.
                                                             is necessary to share a load safely. Multiple ports can
If it is important that I/O ports remain high impedance      drive high-current LEDs because each port can use its
when all the supplies are powered down, including            own external current-limiting resistor to set that port’s
the port supply VLA, then ensure that there is no direct     current through the LED.
or parasitic path for the MAX7306/MAX7307 input signals
to drive current into either the regulator providing VLA                       Power-Supply Considerations
or other circuits powered from VLA. One simple way to        The MAX7306/MAX7307 operate with a VDD power-sup-
achieve this is with a series small-signal Schottky          ply voltage of 1.62V to 3.6V. Bypass VDD to GND with a
diode, such as the BAT54, between the port supply            0.1µF capacitor as close as possible to the device. The
and the VLA input.                                           port supply V LA is connected to a supply voltage
                                                             between 1.40V and 5.5V and bypassed with a 0.1µF
                             I/O Level Translation           capacitor as close as possible to the device. The VDD
The open-drain output configuration of the ports allows      supply and port supply are independent and can be
them to level translate the outputs to lower (but not        connected to different voltages or the same supply as
higher) voltages than the V LA supply. An external           required.
pullup resistor converts the high-impedance, logic-high
                                                             Power supplies VDD and VLA can be sequenced in
condition to a positive voltage level. Connect the resis-
                                                             either order or together.
tor to any voltage up to V LA. For interfacing CMOS
inputs, a pullup resistor value of 220kΩ is a good start-    For the MAX7307, when a push-pull port is acting as an
ing point. Use a lower resistance to improve noise           input referenced to VCC, make sure the VLA voltage is
immunity, in applications where power consumption is         greater than VCC - 0.3V.
less critical, or where a faster rise time is needed for a
given capacitive load.
                                 Driving LED Loads
When driving LEDs, use a resistor in series with the
LED to limit the LED current to no more than 25mA.
Choose the resistor value according to the following
formula:
         RLED = (VSUPPLY - VLED - VOL) / ILED
                   ______________________________________________________________________________________           21


                  SMBus/I2C Interfaced 4-Port, Level-Translating
                  GPIOs and LED Drivers
                                                                                                                                                Pin Configurations
MAX7306/MAX7307
                                                              VLA/AD0*
                        TOP VIEW
                                        SCL   SDA       VDD              P4
                                                                                                                                     +
                                        10     9        8      7          6                                               RST 1                      10 SCL
                                                                                                                      P1/INT    2                    9   SDA
                                                                                                                          GND   3        MAX7306/    8   VDD
                                               MAX7306/                                                                                  MAX7307
                                               MAX7307                                                              P2/OSCIN    4                    7   VLA (AD0)*
                                    +                                                                                                    EP
                                                                                                                   P3/OSCOUT    5                    6   P4
                                        1      2        3      4          5
                                                                                                                                          μMAX
                                                                                                                   EP = EXPOSED PADDLE
                                                                         P3/OSCOUT
                                                              P2/OSCIN
                                        RST
                                              P1/INT
                                                        GND
                                                                                             *AD0 FOR MAX7306
                                                   μDFN                                       VLA FOR MAX7307
                       Ordering Information (continued)                                                                                             Chip Information
                                                                                     µ   (        )
                                                                                                            PROCESS: BiCMOS
                          PART                TOP MARK                   PIN-PACKAGE
                  MAX7306AUB+                      AAAO                  10 µMAX-EP*
                                                                                                                                              Package Information
                  MAX7307ALB+                          AAK               10 µDFN (2mm x 2mm)
                                                                                                            For the latest package outline information and land patterns,
                  MAX7307AUB+                      AAAN                  10 µMAX-EP*                        go to www.maxim-ic.com/packages. Note that a "+", "#", or "-"
                  Note: All devices are specified over the -40°C to +125°C oper-                            in the package code indicates RoHS status only. Package
                  ating temperature range.                                                                  drawings may show a different suffix character, but the draw-
                                                                                                            ing pertains to the package regardless of RoHS status.
                  +Denotes a lead(Pb)-free/RoHS-compliant package.
                                                                                                                PACKAGE         PACKAGE             OUTLINE              LAND
                                                                                                                  TYPE            CODE                NO.             PATTERN NO.
                                                                                                                10 µMAX             U10E+3          21-0109             90-0148
                                                                                                                10 µDFN             L1022+1         21-0164             90-0006
                  22    ______________________________________________________________________________________


   SMBus/I2C Interfaced 4-Port, Level-Translating
                          GPIOs and LED Drivers
                                                                                                                  Revision History
                                                                                                                                                        MAX7306/MAX7307
 REVISION       REVISION                                                                                                           PAGES
                                                                    DESCRIPTION
 NUMBER          DATE                                                                                                             CHANGED
       0            6/07       Initial release                                                                                         —
       1            8/10       Updated Driving LED Load section                                                                        21
Maxim cannot assume responsibility for use of any circuitry other than circuitry entirely embodied in a Maxim product. No circuit patent licenses are
implied. Maxim reserves the right to change the circuitry and specifications without notice at any time.
Maxim Integrated Products, 120 San Gabriel Drive, Sunnyvale, CA 94086 408-737-7600 ____________________ 23
© 2010 Maxim Integrated Products                                        Maxim is a registered trademark of Maxim Integrated Products, Inc.


Mouser Electronics
Authorized Distributor
Click to View Pricing, Inventory, Delivery & Lifecycle Information:
Maxim Integrated:
 MAX7306ALB+T MAX7306AUB+ MAX7306AUB+T MAX7307AUB+T
