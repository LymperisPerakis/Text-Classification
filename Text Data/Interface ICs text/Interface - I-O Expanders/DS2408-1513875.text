                                                                                                               DS2408
                                                                         1-Wire 8-Channel Addressable Switch
BENEFITS AND FEATURES                                                              PIN CONFIGURATION
    Control Eight Independent I/O Port Pins from a Single
     Micro Port Pin
     o Eight Channels of Programmable I/O with
           Open-Drain Outputs
     o On-Resistance of PIO Pulldown Transistor 100Ω
           (max); Off-Resistance 10MΩ (typ)
     o Individual Activity Latches Capture
           Asynchronous State Changes at PIO Inputs for
           Interrogation by the Bus Master
     o Data-Strobe Output to Synchronize PIO Logic
           States to External Read/Write Circuitry
    Minimalist 1-Wire Interface Lowers Cost and                                                 150-mil SO
     Interface Complexity
     o Built-in Multidrop Controller Ensures
           Compatibility with Other 1-Wire® Net Products
     o Supports 1-Wire Conditional Search Command                           ORDERING INFORMATION
           with Response Controlled by Programmable PIO                          PART          TEMP RANGE     PIN-PACKAGE
           Conditions                                                        DS2408S+          -40°C to +85°C 16 SO
     o Unique Factory-Lasered 64-Bit Registration
                                                                             DS2408S+T&R       -40°C to +85°C 16 SO
           Number Ensures Error-Free Device Selection and
                                                                            +Denotes a lead(Pb)-free package.
           Absolute Part Identity
                                                                            T&R = Tape and reel.
     o Communicates to Host with a Single Digital
           Signal at 15.3kbps or 100kbps
    Wide Voltage and Temperature Operating Ranges
     Enables Robust System Performance
     o 2.8V to 5.25V
     o -40°C to +85°C Industrial Temperature Range
DESCRIPTION
The DS2408 is an 8-channel, programmable I/O 1-Wire chip. PIO outputs are configured as open-drain and
provide an on resistance of 100Ω max. A robust PIO channel-access communication protocol ensures that PIO
output-setting changes occur error-free. A data-valid strobe output can be used to latch PIO logic states into
external circuitry such as a D/A converter (DAC) or microcontroller data bus.
DS2408 operation is controlled over the single-conductor 1-Wire bus. Device communication follows the
standard Dallas Semiconductor 1-Wire protocol. Each DS2408 has its own unalterable and unique 64-bit
ROM registration number that is factory lasered into the chip. The registration number guarantees unique
identification and is used to address the device in a multidrop 1-Wire net environment. Multiple DS2408
devices can reside on a common 1-Wire bus and can operate independently of each other. The DS2408 also
supports 1-Wire conditional search capability based on PIO conditions or power-on-reset activity; the
conditions to cause participation in the conditional search are programmable. The DS2408 has an optional VCC
supply connection. When an external supply is absent, device power is supplied parasitically from the 1-Wire
bus. When an external supply is present, PIO states are maintained in the absence of the 1-Wire bus power
source. The RSTZ signal is configurable to serve as either a hard-wired reset for the PIO output or as a strobe
for external circuitry to indicate that a PIO write or PIO read has completed.
1-Wire is a registered trademark of Maxim Integrated Products, Inc.
                                                                    1 of 39
                                                                                                              19-5702; 3/15


                                                                                                 DS2408
ABSOLUTE MAXIMUM RATINGS*
 P0 to P7, RSTZ, I/O Voltage to GND                       -0.5V, +6V
 P0 to P7, RSTZ, I/O combined sink current                20mA
 Operating Temperature Range                              -40°C to +85°C
 Junction Temperature                                     +150°C
 Storage Temperature Range                                -55°C to +125°C
 Lead temperature (soldering 10s)                         +300°C
 Soldering Temperature (reflow)                           +260°C
*   This is a stress rating only and functional operation of the device at these or any other conditions
    above those indicated in the operation sections of this specification is not implied. Exposure to
    absolute maximum rating conditions for extended periods of time may affect reliability.
ELECTRICAL CHARACTERISTICS
(VCC = 0V or ≥ VPUP, TA = -40°C or +85°C.)
     PARAMETER            SYMBOL          CONDITIONS                 MIN      TYP       MAX     UNITS
 1-Wire Pullup                       Standard speed                   2.8                5.25
                            VPUP                                                                   V
 Voltage                             Overdrive speed                  3.3                5.25
 Standby Supply                      VCC at VPUP,
                             ICCS                                                          1      µA
 Current                             I/O pin at 0.3V
 I/O Pin General Data
 1-Wire Pullup
                             RPUP    (Notes 1, 2)                                         2.2     kΩ
 Resistance
 Input Capacitance           CIO     (Notes 3, 4)                                       1200      pF
                                     I/O pin at VPUP,
 Input Load Current           IL                                                           1      µA
                                     VCC at 0V
 High-to-Low
                             VTL     (Notes 4, 5, 6)                  0.5                 3.2      V
 Switching Threshold
 Input-Low Voltage           VIL     (Notes 1, 7)                                        0.30      V
 Low-to-High
                             VTH     (Notes 4, 5, 8)                  0.8                 3.4      V
 Switching Threshold
 Switching Hysteresis        VHY     (Notes 9, 4)                    0.16                0.73      V
 Output-Low Voltage
                             VOL     (Note 10)                                            0.4      V
 at 4mA
                                     Standard speed, RPUP =
                                                                       5
                                     2.2kΩ
                                     Overdrive speed, RPUP =
 Recovery Time                                                         2
                             tREC    2.2kΩ                                                        µs
 (Note 1)
                                     Overdrive speed, Directly
                                     prior to reset pulse; RPUP        5
                                     = 2.2kΩ
 Rising-Edge Hold-off                Standard speed                   0.5                  5
                             tREH                                                                 µs
 Time (Notes 11, 4)                  Overdrive speed                  0.5                  2
 Timeslot Duration                   Standard speed                   65
                            tSLOT                                                                 µs
 (Notes 1, 12)                       Overdrive speed                  10
                                                   2 of 39


                                                                              DS2408
    PARAMETER         SYMBOL          CONDITIONS         MIN     TYP MAX     UNITS
I/O Pin, 1-Wire Reset, Presence-Detect Cycle
                                 Standard speed, VPUP >
                                                          480         720
Reset-Low Time                   4.5V
                         tRSTL                                                 µs
(Notes 1, 12)                    Standard speed           660         720
                                 Overdrive speed           53          80
Presence-Detect High             Standard speed            15          60
                          tPDH                                                 µs
Time (Note 12)                   Overdrive speed            2           7
                                 Standard speed, VPUP >
                                                            1           5
Presence-Detect Fall             4.5V
                          tFPD                                                 µs
Time (Note 13)                   Standard speed             1           8
                                 Overdrive speed                        1
                                 Standard speed, VPUP >
                                                           60         240
Presence-Detect Low              4.5V
                          tPDL                                                 µs
Time (Note 12)                   Standard speed            60         280
                                 Overdrive speed            7          27
                                 Standard speed, VPUP >
                                                           65          75
Presence-Detect                  4.5V
                          tMSP                                                 µs
Sample Time (Note 1)             Standard speed            68          75
                                 Overdrive speed            8           9
I/O Pin, 1-Wire Write
Write-0 Low Time                 Standard speed            60         120
                         tW0L                                                  µs
(Notes 1, 12, 14)                Overdrive speed            8          13
Write-1 Low Time                 Standard speed             5          15
                         tW1L                                                  µs
(Notes 1, 12, 14)                Overdrive speed            1          1.8
Write Sample Time                Standard speed            15          60
(Slave Sampling)          tSLS                                                 µs
                                 Overdrive speed          1.8           8
(Note 12)
I/O Pin, 1-Wire Read
Read-Low Time                    Standard speed             5        15 - δ
                           t RL                                                µs
(Notes 1, 15)                    Overdrive speed            1        1.8 - δ
Read-0 Low Time                  Standard speed            15          60
(Data From Slave)         tSPD                                                 µs
                                 Overdrive speed          1.8           8
(Note 12)
Read-Sample Time                 Standard speed         tRL + δ        15
                         tMSR                                                  µs
(Notes 1, 12, 15)                Overdrive speed        tRL + δ        1.8
P0 to P7, RSTZ Pin
Input-Low Voltage         VIL    (Notes 1, 7)                         0.30     V
                                 VX = max (VPUP,VCC)
Input-High Voltage        VIH                           VX - 0.8      5.25     V
                                 (Note 1)
Output-Low Voltage
                          VOL    (Note 10)                             0.4     V
at 4mA
Leakage Current            ILP   5.25V at the pin                       1     µA
Output Fall Time         tFPIO   (Notes 4, 16)            100                  ns
Minimum-Sensed                                              1
                        tPWMIN (Notes 4, 17)                            5      µs
PIO Pulse
                                              3 of 39


                                                                                                     DS2408
Note 1:  System Requirement
Note 2:  Maximum allowable pullup resistance is a function of the number of 1-Wire devices in the
         system and 1-Wire recovery times. The specified value here applies to systems with only one
         device and with the minimum 1-Wire recovery times. For more heavily loaded systems, an
         active pullup such as that found in the DS2480B may be required.
Note 3:  If a 2.2kΩ resistor is used to pull up the data line to VPUP, 5µs after power has been applied,
         the parasite capacitance does not affect normal communications.
Note 4:  Guaranteed by design—not production tested.
Note 5:  VTL and VTH are functions of the internal supply voltage, which in parasitic power mode, is a
         function of VPUP and the 1-Wire recovery times. The VTH and VTL maximum specifications
         are valid at VPUP = 5.25V. In any case, VTL < VTH < VPUP.
Note 6:  Voltage below which, during a falling edge on I/O, a logic '0' is detected.
Note 7:  The voltage on I/O needs to be less or equal to VILMAX whenever the master drives the line
         low.
Note 8:  Voltage above which, during a rising edge on I/O, a logic '1' is detected.
Note 9:  After VTH is crossed during a rising edge on I/O, the voltage on I/O has to drop by VHY to be
         detected as logic '0'.
Note 10: The I-V characteristic is linear for voltages less than 1V.
Note 11: The earliest recognition of a negative edge is possible at tREH after VTH has been reached
         before.
Note 12: Highlighted numbers are NOT in compliance with the published 1-Wire standards. See
         comparison table below.
Note 13: Interval during the negative edge on I/O at the beginning of a presence detect pulse between
         the time at which the voltage is 90% of VPUP and the time at which the voltage is 10% of
         VPUP.
Note 14: ε in Figure 14 represents the time required for the pullup circuitry to pull the voltage on I/O
         up from VIL to VTH. The actual maximum duration for the master to pull the line low is
         tW1LMAX + tF - ε and tW0LMAX + tF - ε respectively.
Note 15: δ in Figure 14 represents the time required for the pullup circuitry to pull the voltage on I/O
         up from VIL to the input high threshold of the bus master. The actual maximum duration for
         the master to pull the line low is tRLMAX + tF.
Note 16: Interval during the device-generated negative edge on any PIO pin or the RSTZ pin between
         the time at which the voltage is 90% of VPUP and the time at which the voltage is 10% of
         VPUP. PIO pullup resistor = 2.2kΩ.
Note 17: Width of the narrowest pulse which trips the activity latch (for any PIO pin) or causes a reset
         (for the RSTZ pin). For a pulse duration tPW: If tPW < tPWMIN(min), the pulse will be rejected. If
         tPWMIN(min) < tPW < tPWMIN(max), the pulse may or may not be rejected. If tPW > tPWMIN(max) the
         pulse will be recognized and latched.
Note 18: Maximum instantaneous pulldown current through all port pins and the RSTZ pin combined.
         No requirement for current balance among different pins.
                                                   4 of 39


                                                                                                          DS2408
                             STANDARD VALUES                                    DS2408 VALUES
  PARAMETER              STANDARD              OVERDRIVE                STANDARD             OVERDRIVE
       NAME                SPEED                   SPEED                   SPEED                 SPEED
                       MIN        MAX         MIN          MAX         MIN        MAX        MIN       MAX
 tSLOT (incl. tREC)     61µs     (undef.)       7µs      (undef.) 65µs 1) (undef.)           10µs     (undef.)
 tRSTL                 480µs     (undef.)      48µs        80µs       660µs      720µs       53µs       80µs
 tPDH                   15µs       60µs         2µs         6µs        15µs       60µs        2µs        7µs
 tPDL                   60µs      240µs         8µs        24µs        60µs      280µs        7µs       27µs
 tW0L                   60µs      120µs         6µs        16µs        60µs      120µs        8µs       13µs
 tSLS, tSPD             15µs       60µs         2µs         6µs        15µs       60µs       1.8µs       8µs
1)
   Intentional change, longer recovery-time requirement due to modified 1-Wire front end.
PIN DESCRIPTION
       PIN          NAME                                      DESCRIPTION
         1           N.C.      Not Connected
                               I/O Pin of Channel 0. Logic input/open-drain output with 100Ω maximum
                               on-resistance; 0V to 5.25V operating range. Power-on default is
         2            P0       indeterminate. If it is application-critical for the outputs to power up in the
                               "off" state, the user should attach an appropriate power-on-reset circuit or
                               supervisor IC to the RSTZ pin.
                               Optional Power Supply Input. Range 2.8V to 5.25V; must be tied to GND
         3           VCC
                               if not used.
         4            I/O      1-Wire Interface. Open-drain, requires external pullup resistor.
         5           GND       Ground
         6           N.C.      Not Connected
         7            P7       I/O Pin of Channel 7. Same characteristics as P0.
         8            P6       I/O Pin of Channel 6. Same characteristics as P0.
         9            P5       I/O Pin of Channel 5. Same characteristics as P0.
                               SW configurable PIO reset input ( RST ) or open-drain strobe output
                               ( STRB ). When configured as RST , a LOW input sets all PIO outputs to
                               the "off" state by setting all bits in the PIO Output Latch State Register.
        10          RSTZ       When configured as STRB , an output strobe will occur after a PIO write
                               (see Channel-Access Write command) or after a PIO Read (see Channel-
                               Access Read command). The power-on default function of this pin is
                                RST .
        11            P4       I/O pin of channel 4; same characteristics as P0
        12            P3       I/O pin of channel 3; same characteristics as P0
        13            P2       I/O pin of channel 2; same characteristics as P0
        14            P1       I/O pin of channel 1; same characteristics as P0
        15           N.C.      Not connected
        16           N.C.      Not connected
                                                      5 of 39


                                                                                                   DS2408
APPLICATION
The DS2408 is a multipurpose device. Typical applications include port expander for microcontrollers,
remote multichannel sensor/actuator, communication and control unit of a microterminal, or as network
interface of a microcontroller. Typical application circuits and communication examples are found later
in this data sheet (Figures 17 to 22).
OVERVIEW
Figure 1 shows the relationships between the major function blocks of the DS2408. The device has two
main data components: 1) 64-bit lasered ROM, and 2) 64-bit register page of control and status registers.
Figure 2 shows the hierarchical structure of the 1-Wire protocol. The bus master must first provide one of
the eight ROM function commands: 1) Read ROM, 2) Match ROM, 3) Search ROM, 4) Conditional
Search ROM, 5) Skip ROM, 6) Overdrive-Skip ROM, 7) Overdrive-Match ROM, or 8) Resume. Upon
completion of an Overdrive ROM command byte executed at standard speed, the device will enter
overdrive mode, where all subsequent communication occurs at a higher speed. The protocol required for
these ROM function commands is described in Figure 12. After a ROM function command is success-
fully executed, the control functions become accessible and the master may provide any one of the five
available commands. The protocol for these control commands is described in Figure 8. All data is read
and written least significant bit first.
Figure 1. DS2408 BLOCK DIAGRAM
               VCC                           PARASITE POWER
                                               INTERNAL VCC
                                           1-WIRE                   64-BIT
               I/O                        FUNCTION              LASERED ROM
                                          CONTROL
               GND
                                          REGISTER                  PORT
                                                                  FUNCTION           RSTZ
                                          FUNCTION
                                          CONTROL                 CONTROL
                                                                                     P0
                                            CRC16
                                                                                     P1
                                         GENERATOR
                                                                                     P2
                                                                        PORT         P3
                                          REGISTER                     INTER-        P4
                                            PAGE                        FACE         P5
                                                                                     P6
                                                                                     P7
                                                   6 of 39


                                                                                                        DS2408
Figure 2. HIERARCHICAL STRUCTURE FOR 1-Wire PROTOCOL
          Bus                     1-Wire Net                          Other
        Master                                                       Devices
                                       DS2408
         Command                       Available                Cmd. Data Field
         Level:                        Commands:               Codes: Affected:
                                       Read ROM                  33h  64-BIT ROM, RC-FLAG
                                       Match ROM                 55h  64-BIT ROM, RC-FLAG
                                       Search ROM                F0h  64-BIT ROM, RC-FLAG
              1-Wire ROM Function
                                       Skip ROM                  CCh  RC-FLAG
                   Commands
                                       Conditional Search        ECh  64-BIT ROM, RC-FLAG, Port Status,
                                               ROM                           Cond. Search Settings,
                                       Overdrive Match           69h  64-BIT ROM, RC-FLAG, OD-Flag
                                       Overdrive Skip            3Ch  RC-FLAG, OD-Flag
                                       Resume                    A5h  RC-FLAG
                                       Read PIO Registers        F0h  PIO Registers
                                       Channel Access Read       F5h  Port Input Latches
                DS2408-Specific        Channel Access Write      5Ah  Port Output Latches
                Control Function       Write Conditional         CCh  Conditional Search Register
                   Commands                  Search Register
                                       Reset Activity Latches    C3h  Activity Latches
PARASITE POWER
The DS2408 can derive its power entirely from the 1-Wire bus by storing energy on an internal capacitor
during periods of time when the signal line is high. During low times the device continues to operate from
this “parasite” power source until the 1-Wire bus returns high to replenish the parasite (capacitor) supply.
If power is available, the VCC pin should be connected to the external voltage supply.
Figure 3. 64-BIT LASERED ROM
    MSB                                                                                          LSB
         8-BIT                                                                       8-BIT FAMILY
                                     48-BIT SERIAL NUMBER
      CRC CODE                                                                        CODE (29h)
    MSB        LSB      MSB                                                LSB      MSB         LSB
64-BIT LASERED ROM
Each DS2408 contains a unique ROM code that is 64 bits long. The first 8 bits are a 1-Wire family code.
The next 48 bits are a unique serial number. The last eight bits are a CRC of the first 56 bits. See Figure 3
for details. The 1-Wire CRC is generated using a polynomial generator consisting of a shift register and
XOR gates as shown in Figure 4. The polynomial is X8 + X5 + X4 + 1. Additional information about the
Dallas 1-Wire Cyclic Redundancy Check is available in Application Note 27.
                                                       7 of 39


                                                                                                                DS2408
The shift register bits are initialized to 0. Then, starting with the least significant bit of the family code,
one bit at a time is shifted in. After the eighth bit of the family code has been entered, the serial number is
entered. After the serial number has been entered, the shift register contains the CRC value. Shifting in
the eight bits of CRC returns the shift register to all 0s.
Figure 4. 1-Wire CRC GENERATOR
                                                       8     5    4
                                        POLYNOMIAL = X + X + X + 1
          st         nd         rd         th                  th                    th          th         th
        1          2          3          4                   5                     6           7          8
      STAGE      STAGE      STAGE      STAGE               STAGE                 STAGE       STAGE      STAGE
     0         1          2          3                   4                     5           6          7          8
   X         X          X          X                   X                     X           X          X          X
                                                                                        INPUT DATA
REGISTER ACCESS
The registers needed to operate the DS2408 are organized as a Register Page, as shown in Figure 5. All
registers are volatile, i. e., they lose their state when the device is powered down. PIO, Conditional
Search, and Control/Status registers are read/written using the device level Read PIO Registers and Write
Conditional Search Register commands described in subsequent sections and Figure 8 of this document.
Figure 5. DS2408 REGISTER ADDRESS MAP
   ADDRESS RANGE                ACCESS TYPE     DESCRIPTION
   0000h to 0087h                       R       Undefined Data
   0088h                                R       PIO Logic State
   0089h                                R       PIO Output Latch State Register
   008Ah                                R       PIO Activity Latch State Register
   008Bh                             R/W        Conditional Search Channel Selection Mask
   008Ch                             R/W        Conditional Search Channel Polarity Selection
   008Dh                             R/W        Control/Status Register
   008Eh to 008Fh                       R       These Bytes Always Read FFh
                                                       8 of 39


                                                                                                          DS2408
PIO Logic-State Register
The logic state of the PIO pins can be obtained by reading this register using the Read PIO Registers
command. Reading this register does not generate a signal at the RSTZ pin, even if it is configured as
STRB . See the Channel-Access commands description for details on STRB .
PIO Logic State Register Bitmap
     ADDR       b7       b6       b5        b4       b3        b2      b1       b0
     0088h      P7      P6        P5       P4        P3       P2       P1       P0
This register is read-only. Each bit is associated with the pin of the respective PIO channel as shown in
Figure 6. The data in this register is sampled at the last (most significant) bit of the byte that proceeds
reading the first (least significant) bit of this register. See the Read PIO Registers command description
for details.
PIO Output Latch State Register
The data in this register represents the latest data written to the PIO through the Channel-access Write
command. This register is read using the Read PIO Registers command. Reading this register does not
generate a signal at the RSTZ pin, even if it is configured as STRB . See the Channel-access commands
description for details on STRB . This register is not affected if the device reinitializes itself after an ESD
hit.
PIO Output Latch State Register Bitmap
     ADDR       b7       b6       b5        b4       b3        b2      b1       b0
     0089h     PL7      PL6      PL5       PL4      PL3       PL2     PL1      PL0
This register is read-only. Each bit is associated with the output latch of the respective PIO channel as
shown in Figure 6.
The flip-flops of this register will power up in a random state. If the chip has to power up with all PIO
channels off, a LOW pulse must be generated on the RSTZ pin, e.g., by means of an open-drain CPU
supervisor chip (see Figure 20). When using an RC circuit to generate the power-on reset, make sure that
RSTZ is NOT configured as strobe output (ROS bit in control/status register 008Dh needs to be 0).
PIO Activity Latch State Register
The data in this register represents the current state of the PIO activity latches. This register is read using
the Read PIO Registers command. Reading this register does not generate a signal at the RSTZ pin, even
if it is configured as STRB . See the Channel-access commands description for details on STRB .
PIO Activity Latch State Register Bitmap
     ADDR       b7       b6       b5        b4       b3        b2      b1       b0
     008Ah     AL7      AL6      AL5       AL4      AL3       AL2     AL1      AL0
This register is read-only. Each bit is associated with the activity latch of the respective PIO channel as
shown in Figure 6. This register is cleared to 00h by a power-on reset, by a low pulse on the RSTZ pin
(only if RSTZ is configured as RST input), or by successful execution of the Reset Activity Latches
command.
                                                      9 of 39


                                                                                                    DS2408
Figure 6. CHANNEL I/O AND RSTZ SIMPLIFIED LOGIC DIAGRAM
                  TO PIO LOGIC
             STATE REGISTER                         PIO ACTIVITY
                                                        LATCH      "1"
            TO ACTIVITY LATCH                                                      CHANNEL
               STATE REGISTER                                                        I/O PIN
                                                            Q   D
                POWER ON
                RESET                                        Q R
                CLR ACT LATCH                                           EDGE
                                                                     DETECTOR
                TO PIO
                OUTPUT LATCH
                STATE REG.
                                             DATA             S
                                                            D   Q
                                             CLOCK
                                                                Q
                                                         PIO
                                                         OUTPUT
                                                         LATCH
                                                                                        RSTZ
                                                                                         PIN
                       PORT
                    FUNCTION
                     CONTROL
                                        ROS
                                       STRB
Conditional Search Channel Selection Mask Register
The data in this register controls whether a PIO channel qualifies for participation in the conditional
search command. To include one or more of the PIO channels, the bits in this register that correspond to
those channels need to be set to 1. This register can only be written through the Write Conditional Search
Registers command.
Conditional Search Channel Selection Mask Register Bitmap
   ADDR        b7       b6       b5       b4       b3        b2      b1      b0
   008Bh      SM7      SM6      SM5      SM4      SM3       SM2     SM1     SM0
This register is read/write. Each bit is associated with the respective PIO channel as shown in Figure 7.
This register is cleared to 00h by a power-on reset
                                                   10 of 39


                                                                                                       DS2408
Conditional Search Channel Polarity Selection Register
The data in this register specifies the polarity of each selected PIO channel for the device to respond to
the conditional search command. Within a PIO channel, the data source may be either the channel's input
signal (pin) or the channel's activity latch, as specified by the PLS bit in the Control/Status register at ad-
dress 008Dh. This register can only be written through the Write Conditional Search Registers command.
Conditional Search Channel Polarity Selection Register Bitmap
    ADDR       b7       b6       b5         b4        b3        b2     b1       b0
   008Ch      SP7      SP6      SP5        SP4       SP3       SP2    SP1      SP0
This register is read/write. Each bit is associated with the respective PIO channel as shown in Figure 7.
This register is cleared to 00h by a power-on reset.
Figure 7. Conditional Search Logic
            PLS     CHANNEL 0      SP0                    SM0                              CT
  AL0
  P0
                                                   INPUT FROM
                                                CHANNELS 1 TO 6                                         CSR
                                                  (NOT SHOWN)
                   CHANNEL 7         SP7                  SM7
  AL7
   P7
                                                      11 of 39


                                                                                                               DS2408
Control/Status Register
The data in this register reports status information, determines the function of the RSTZ pin and further
configures the device for conditional search. This register can only be written through the Write Condi-
tional Search Registers command.
Control/Status Register Bitmap
    ADDR        b7       b6       b5        b4        b3         b2       b1        b0
    008Dh     VCCP        0        0         0      PORL        ROS       CT      PLS
This register is read/write. Without VCC supply, this register reads 08h after a power-on reset. The func-
tional assignments of the individual bits are explained in the table below. Bits 4 to 6 have no function;
they will always read 0 and cannot be set to 1.
Control/Status Register Details
       BIT DESCRIPTION         BIT(S)                                    DEFINITION
    PLS: Pin or Activity         b0      Selects either the PIO pins or the PIO activity latches as input for the
    Latch Select                         conditional search.
                                                 0: pin selected (default)
                                                 1: activity latch selected
    CT: Conditional Search       b1      Specifies whether the data of two or more channels needs to be OR’ed
    Logical Term                         or AND’ed to meet the qualifying condition for the device to respond to a
                                         conditional search. If only a single channel is selected in the channel
                                         selection mask (008Bh) this bit is a don't care.
                                                 0: bitwise OR (default)
                                                 1: bitwise AND
    ROS: RSTZ Pin Mode           b2      Configures RSTZ as either RST input or STRB output
    Control
                                                 0: configured as RST input (default)
                                                 1: configured as STRB output
    PORL: Power-On Reset         b3      Specifies whether the device has performed a power-on reset. This bit
    Latch                                can only be cleared to 0 under software control. As long as this bit is 1
                                         the device will always respond to a conditional search.
    VCCP: VCC Power              b7      For VCC powered operation the VCC pin needs to be tied to a voltage
    Status (Read-Only)                   source ≥ VPUP.
                                                 0: VCC pin is grounded
                                                 1: VCC -powered operation
The interaction of the various signals that determine whether the device responds to a conditional search
is illustrated in Figure 7. The selection mask SM selects the participating channels. The polarity selection
SP determines for each channel whether the channel signal needs to be 1 or 0 to qualify. The PLS bit
determines whether all channel signals are taken from the activity latches or I/O pins. The signals of all
channels are fed into an AND gate as well as an OR gate. The CT bit finally selects the AND’ed or
OR’ed result as the conditional search response signal CSR.
Note on CT bit:
OR       The qualifying condition is met if the input (pin state or activity latch) for one or more selected
         channels matches the corresponding polarity.
AND For the qualifying condition to be met, the input (pin state or activity latch) for every selected
         channel must match the corresponding polarity.
                                                      12 of 39


                                                                                               DS2408
Figure 8-1. CONTROL FUNCTIONS FLOW CHART
               Bus Master TX Control           From ROM Functions
                Function Command              Flow Chart (Figure 12)
                                                                          To Figure 8
                                                                              nd
                        F0h          N                                      2 Part
                  Read PIO Reg.?
                                             Note:
                             Y               To read the three PIO state and latch
                  Bus Master TX              register bytes, the target address should
             TA1 (T7:T0), TA2 (T15:T8)       be 0088h. Returned data for a target
                                             address <0088h is undefined.
             N                       Y
                      Address
                      < 90h?
                                                  Address          Y
                                                  = 88h?
                                                                     DS2408 Samples        1)
                                                 N                     PIO Pin Status
                                           DS2408 sets Register
                                            Address = (T15:T0)             Note 1)
                                                                           See the command
                                                                           description for the
                                                                           exact timing of the
                                         Bus Master RX Data Byte
                                                                           PIO pin sampling.
                                          from Register Address
                          DS2408 Incre-                            Y
                                                   Master
                         ments Address
                                                TX Reset?
                             Counter
                                                        N
                                        Y         Address
                                                   < 90h?
                                                        N
                                                                   Y
                                                   Master
                                                 TX Reset?
                                                        N
                                          Bus Master RX CRC16
                                          of Command, Address,
                                                 Data Bytes
                                         N
                           Bus Master              Master
                            RX “1”s              TX Reset?
                                                        Y
                                                                         From Figure 8
                                                                             nd
                                                                            2 Part
                                             To ROM Functions
                                           Flow Chart (Figure 12)
                                           13 of 39


                                         DS2408
Figure 8-2. CONTROL FUNCTIONS FLOW CHART
                               14 of 39


                                         DS2408
Figure 8-3. CONTROL FUNCTIONS FLOW CHART
                               15 of 39


                                                                                                      DS2408
CONTROL FUNCTION COMMANDS
Once a ROM function command is completed, the Control Function Commands can be issued. The
Control Functions Flow Chart (Figure 8) describes the protocols necessary for accessing the PIO
channels and the special function registers of the DS2408. The communication between the master and
the DS2408 takes place either at standard speed (default, OD = 0) or at overdrive speed (OD = 1). If not
explicitly set into the overdrive mode, the device operates at standard speed.
Read PIO Registers [F0h]
The Read PIO Registers command is used to read any of the device's registers. After issuing the
command, the master must provide the 2-byte target address. After these two bytes, the master reads data
beginning from the target address and may continue until address 008Fh. If the master continues reading,
it will receive an inverted 16-bit CRC of the command, address bytes, and all data bytes read from the
initial starting byte through the end of the register page. This CRC16 is the result of clearing the CRC
generator and then shifting in the command byte followed by the two address bytes and the data bytes
beginning at the first addressed location and continuing through to the last byte of the register page. After
the bus master has received the CRC16, the DS2408 responds to any subsequent read-time slots with
logical 1’s until a 1-Wire Reset command is issued. If this command is issued with target address 0088h
(PIO Logic State Register), the PIO sampling takes place during the transmission of the MS bit of TA2. If
the target address is lower than 0088h, the sampling takes place while the master reads the MS bit from
address 0087h.
Channel-Access Read [F5h]
In contrast to reading the PIO logical state from address 88h, this command reads the status in an endless
loop. After 32 bytes of PIO pin status the DS2408 inserts an inverted CRC16 into the data stream, which
allows the master to verify whether the data was received error-free. A Channel-Access Read can be
terminated at any time with a 1-Wire Reset.
Figure 9. CHANNEL-ACCESS READ TIMING
                                          Example - Sampled State = 72h
                                          MS 2 bits of pre-      LS 2 bits of data
                                          vious byte (8Dh)       byte (72h)
                            IO (1-Wire)
                                 STRB\                                      tSPD
                                                     tSPD
                                                                tSPD
                                               Sampling Point
Notes:
1) The "previous byte" could be the command code, the data byte resulting from the previous PIO
     sample, or the MS byte of a CRC16. The example shows a read-1 time slot.
2) The sample point timing also applies to the Channel-access Write command, with the "previous byte"
     being the write confirmation byte (AAh). No STRB pulse results when sampling occurs during a
     Channel-Access Write command.
                                                    16 of 39


                                                                                                          DS2408
The status of all eight PIO channels is sampled at the same time. The first sampling occurs during the last
(most significant) bit of the command code F5h. While the master receives the MSB of the PIO status
(i.e., the status of pin P7) the next sampling occurs and so on until the master has received 31 PIO
samples. Next, the master receives the inverted CRC16 of the command byte and 32 PIO samples (first
pass) or the CRC of 32 PIO samples (subsequent passes). While the last (most significant) bit of the CRC
is transmitted the next PIO sampling takes place. The delay between the beginning of the time slot and
the sampling point is independent of the bit value being transmitted and the data direction (see Figure 9).
If the RSTZ pin is configured as STRB , a strobe signal will be generated during the transmission of the
first two (least significant) bits of PIO data. The strobe can signal a FIFO or a microcontroller to apply
the next data byte at the PIO for the master to read through the 1-Wire line.
Channel-Access Write [5Ah]
The Channel-Access Write command is the only way to write to the PIO output-latch state register
(address 0089h), which controls the open-drain output transistors of the PIO channels. In an endless loop
this command first writes new data to the PIO and then reads back the PIO status. The implicit read-after-
write can be used by the master for status verification or for a fast communication with a microcontroller
that is connected to the port pins and RSTZ for synchronization. A Channel-Access Write can be termi-
nated at any time with a 1-Wire Reset.
Figure 10. CHANNEL-ACCESS WRITE TIMING
            Case #1 - MS Bit of new PIO state is 0             Case #2 - MS Bit of new PIO state is 1
            Example - Old State = 39h, New state = 72h         Example - Old State = 72h, New state = 93h
             MS 2 bits of inverted     LS 2 bits of confir-     MS 2 bits of inverted   LS 2 bits of confir-
             new-state byte (8Dh)      mation byte (AAh)        new-state byte (6Ch)    mation byte (AAh)
                                                                                   VTH
  IO (1-Wire)
         PIO        39h               72h                              72h                   93h
                                                  tSPD                                              tSPD
       STRB\
                             tSLS     tSPD                                             tSPD
Note:
Both examples assume that the RSTZ pin is configured as STRB output. If RSTZ is configured as RST
input (default), the RSTZ pin needs to be tied high (to VCC or VPUP) for the Channel-Access Write to
function properly. Leaving the pin unconnected will force the output transistors of the PIO channels to the
"off" state and the PIO output latches will all read "1". See Figure 6 for a schematic of the logic.
After the command code the master transmits a byte that determines the new state of the PIO output
transistors. The first (least significant) bit is associated to P0. To switch the output transistor off (non-
conducting) the corresponding bit value is 1. To switch the transistor on that bit needs to be 0. This way
the data byte transmitted as the new PIO output state arrives in its true form at the PIO pins. To protect
the transmission against data errors, the master has to repeat the new PIO byte in its inverted form. Only
if the transmission was successful will the PIO status change. The actual transition at the PIO to the new
state occurs during the last (most significant) bit of the inverted new PIO data byte and depends on the
polarity of that bit, as shown in Figure 10. If this bit is a 1, the transition begins after tSLS is expired; in
case of a 0, the transition begins at the end of the time slot, when the VTH threshold is crossed. To inform
the master about the successful change of the PIO status, the DS2408 transmits a confirmation byte with
                                                      17 of 39


                                                                                                       DS2408
the data pattern AAh. If the RSTZ pin is configured as STRB , a strobe signal will be generated during the
transmission of the first two (least significant) bits of the confirmation byte. The strobe can signal a FIFO
or a microcontroller to read the new data byte from the PIO. While the last bit of the confirmation byte is
transmitted, the DS2408 samples the status of the PIO pins, as shown in Figure 9, and sends it to the
master. Depending on the data, the master can either continue writing more data to the PIO or issue a 1-
Wire reset to end the command.
Write Conditional Search Register [CCh]
This command is used to tell the DS2408 the conditions that need to be met for the device to respond to a
Conditional Search command, to define the function of the RSTZ pin and to clear the power-on reset flag.
After issuing the command the master sends the 2-byte target address, which must be a value between
008Bh and 008Dh. Next the master sends the byte to be written to the addressed cell. If the address was
valid, the byte is immediately written to its location in the register page. The master now can either end
the command by issuing a 1-Wire reset or send another byte for the next higher address. Once register
address 008Dh has been written, any subsequent data bytes will be ignored. The master has to send a 1-
Wire reset to end the command. Since the Write Conditional Search Register flow does not include any
error-checking for the new register data, it is important to verify correct writing by reading the registers
using the Read PIO Registers command.
Reset Activity Latches [C3h]
Each PIO channel includes an activity latch that is set whenever there is a state transition at a PIO pin.
This change may be caused by an external event/signal or by writing to the PIO. Depending on the
application there may be a need to reset the activity latch after having captured and serviced an external
event. Since there is only read access to the PIO Activity Latch State Register, the DS2408 supports a
special command to reset the latches. After having received the command code, the device resets all
activity latches simultaneously. There are two ways for the master to verify the execution of the Reset
Activity Latches command. The easiest way is to start reading from the 1-Wire line right after the
command code is transmitted. In this case the master will read AAh bytes until it sends a 1-Wire reset.
The other way to verify execution is to read register address 008Ah.
1-WIRE BUS SYSTEM
The 1-Wire bus is a system that has a single bus master and one or more slaves. In all instances the
DS2408 is a slave device. The bus master is typically a microcontroller or PC. For small configurations
the 1-Wire communication signals can be generated under software control using a single port pin. For
multisensor networks, the DS2480B 1-Wire line driver chip or serial port adapters based on this chip
(DS9097U series) are recommended. This simplifies the hardware design and frees the microprocessor
from responding in real time.
The discussion of this bus system is broken down into three topics: hardware configuration, transaction
sequence, and 1-Wire signaling (signal types and timing). The 1-Wire protocol defines bus transactions in
terms of the bus state during specific time slots that are initiated on the falling edge of sync pulses from
the bus master.
HARDWARE CONFIGURATION
The 1-Wire bus has only a single line by definition; it is important that each device on the bus be able to
drive it at the appropriate time. To facilitate this, each device attached to the 1-Wire bus must have open
drain or tri-state outputs. The 1-Wire port of the DS2408 is open-drain with an internal circuit equivalent
to that shown in Figure 11.
                                                     18 of 39


                                                                                                       DS2408
Figure 11. HARDWARE CONFIGURATION
            SIMPLE BUS MASTER               VPUP                           DS2408 1-Ωire PORT
                                                      SEE
                                             RPUP
                                                      TEXT
            RX                                                          DATA                   RX
                                                                                               TX
            TX                               RX = RECEIVE
                                             TX = TRANSMIT                             100Ω
                       OPEN-DRAIN                                                      MOSFET
                        PORT PIN
                 DS2480B BUS MASTER
                                                        +5V
                                     VDD VPP
           HOST CPU
                                     POL   1-Ω                   TO 1-Ωire DATA
               SERIAL   SERIAL IN
                PORT                 RXD    NC
                       SERIAL OUT
                                     TXD GND
                                     DS2480B
A multidrop bus consists of a 1-Wire bus with multiple slaves attached. At standard speed the 1-Wire bus
has a maximum data rate of 15.3kbps. Communication speed for 1-Wire devices can be typically boosted
to 142kbps by activating the overdrive mode; however, the maximum overdrive data rate for the DS2408
is 100kbps. The value of the pullup resistor primarily depends on the network size and load conditions.
For most applications the optimal value of the pullup resistor will be approximately 2.2kΩ for standard
speed and 1.5kΩ for overdrive speed.
The idle state for the 1-Wire bus is high. If for any reason a transaction needs to be suspended, the bus
MUST be left in the idle state if the transaction is to resume. If this does not occur and the bus is left low
for more than 16µs (overdrive speed) or more than 120µs (standard speed), one or more devices on the
bus may be reset. With the DS2408 the bus must be left low for no longer than 13µs at overdrive speed to
ensure that none of the slave devices on the 1-Wire bus performs a reset. The DS2408 communicates
properly when used in conjunction with a DS2480B 1-Wire driver and serial port adapters that are based
on this driver chip. When operating the device in overdrive or below 4.5V, some 1-Wire I/O timing
values must be modified (see EC table).
                                                    19 of 39


                                                                                                     DS2408
TRANSACTION SEQUENCE
The protocol for accessing the DS2408 through the 1-Wire port is as follows:
 Initialization
 ROM Function Command
 Control Function Command
 Transaction/Data
Illustrations of the transaction sequence for the various control function commands are found later in this
document.
INITIALIZATION
All transactions on the 1-Wire bus begin with an initialization sequence. The initialization sequence
consists of a reset pulse transmitted by the bus master followed by presence pulse(s) transmitted by the
slave(s). The presence pulse lets the bus master know that the DS2408 is on the bus and is ready to
operate. For more details, see the 1-Wire Signaling section.
ROM FUNCTION COMMANDS
Once the bus master has detected a presence, it can issue one of the seven ROM function commands. All
ROM function commands are eight bits long. A list of these commands follows (see the flowchart in
Figure 12).
Read ROM [33h]
This command allows the bus master to read the DS2408's 8-bit family code, unique 48-bit serial number,
and 8-bit CRC. This command can only be used if there is a single device on the bus. If more than one
slave is present on the bus, a data collision will occur when all slaves try to transmit at the same time
(open drain will produce a wired-AND result). The resultant family code and 48-bit serial number will
result in a mismatch of the CRC.
Match ROM [55h]
The Match ROM command, followed by a 64-bit ROM sequence, allows the bus master to address a spe-
cific DS2408 on a multidrop bus. Only the DS2408 that exactly matches the 64-bit ROM sequence will
respond to the following control function command. All slaves that do not match the 64-bit ROM se-
quence will wait for a reset pulse. This command can be used with either single or multiple devices on the
bus.
Search ROM [F0h]
When a system is initially brought up, the bus master might not know the number of devices on the
1-Wire bus or their 64-bit ROM codes. The Search ROM command allows the bus master to use a
process of elimination to identify the 64-bit ROM codes of all slave devices on the bus. The search ROM
process is the repetition of a simple three-step routine: read a bit, read the complement of the bit, then
write the desired value of that bit. The bus master performs this simple, three-step routine on each bit of
the ROM. After one complete pass, the bus master knows the contents of the ROM in one device. The
remaining number of devices and their ROM codes may be identified by additional passes. See
Application Note 187 for a detailed discussion on the Search ROM command process including a
software example.
Conditional Search [ECh]
The Conditional Search ROM command operates similarly to the Search ROM command except that only
devices fulfilling the specified condition will participate in the search. The condition is specified by the
Conditional Search channel and polarity selection (addresses 008Bh, 008Ch), the bit functions CT and
                                                    20 of 39


                                                                                                  DS2408
PLS of the Control/Status Register (address 008Dh), and the state of the PIO channels. See Figure 7 for a
description of the Conditional Search logic. The device also responds to the Conditional Search if the
PORL bit is set. The Conditional Search ROM provides an efficient means for the bus master to deter-
mine devices on a multidrop system that have to signal an important event, such as a state change at a
PIO pin caused by an external signal. After each pass of the conditional search that successfully deter-
mined the 64-bit ROM for a specific device on the multidrop bus, that particular device can be individu-
ally accessed as if a Match ROM had been issued, since all other devices will have dropped out of the
search process and will be waiting for a reset pulse.
Skip ROM [CCh]
This command can save time in a single-drop bus system by allowing the bus master to access the control
functions without providing the 64-bit ROM code. If more than one slave is present on the bus and a
Read command is issued following the Skip ROM command, data collision will occur on the bus as
multiple slaves transmit simultaneously (open-drain pulldowns will produce a wired-AND result).
Resume Command [A5h]
In a typical application the DS2408 can be accessed several times to complete a control or adjustment
function. In a multidrop environment this means that the 64-bit ROM sequence of a Match ROM com-
mand has to be repeated for every access. To maximize the data throughput in a multidrop environment,
the Resume Command function is implemented. This function checks the status of the RC flag and, if it is
set, directly transfers control to the control functions, similar to a Skip ROM command. The only way to
set the RC flag is through successfully executing the Match ROM, Search ROM, Conditional Search
ROM, or Overdrive-Match ROM command. Once the RC flag is set, the device can be repeatedly
accessed through the Resume Command function. Accessing another device on the bus will clear the RC
flag, preventing two or more devices from simultaneously responding to the Resume Command function.
Skip ROM [3Ch]
On a single-drop bus this command can save time by allowing the bus master to access the control
functions without providing the 64-bit ROM code. Unlike the normal Skip ROM command, the
Overdrive Skip ROM sets the DS2408 in the overdrive mode (OD = 1). All communication following
this command has to occur at overdrive speed until a reset pulse of minimum 480µs duration resets all
devices on the bus to standard speed (OD = 0). When issued on a multidrop bus this command will set all
overdrive-supporting devices into overdrive mode. To subsequently address a specific overdrive-
supporting device, a reset pulse at overdrive speed has to be issued followed by a Match ROM or Search
ROM command sequence. This will speed up the time for the search process. If more than one slave
supporting overdrive is present on the bus and the Overdrive Skip ROM command is followed by a Read
command, data collision will occur on the bus as multiple slaves transmit simultaneously (open-drain
pulldowns will produce a wired-AND result).
Overdrive Match ROM [69h]
The Overdrive Match ROM command followed by a 64-bit ROM sequence transmitted at overdrive
speed allows the bus master to address a specific DS2408 on a multidrop bus and to simultaneously set it
in overdrive mode. Only the DS2408 that exactly matches the 64-bit ROM sequence will respond to the
subsequent control function command. Slaves already in overdrive mode from a previous Overdrive Skip
or Match command will remain in overdrive mode. All overdrive-capable slaves will return to standard
speed at the next Reset Pulse of minimum 480µs duration. The Overdrive Match ROM command can be
used with either single or multiple devices on the bus.
                                                     21 of 39


                                                                                                       DS2408
Figure 12-1. ROM FUNCTIONS FLOW CHART
                                             Bus Master TX
                                              Reset Pulse                                             nd
            From Control Functions                                                  From Figure 12, 2    Part
             Flow Chart (Figure 8)
                                                  OD           N
                                             Reset Pulse?            OD = 0
                                                Y
 Bus Master TX ROM                            DS2408 TX
 Function Command                           Presence Pulse
                                                                                                To Figure 12
                                                                                                   nd
                                                                                                  2 Part
         33h         N              55h          N              F0h         N         ECh
     Read ROM                  Match ROM                    Search ROM            Cond. Search
     Command?                  Command?                      Command?              Command?            N
              Y                          Y                            Y                     Y
       RC = 0                     RC = 0                       RC = 0                RC = 0
                                                                              N
                                                                                 Condition Met?
                                                                                              Y
     DS2408 TX                                            DS2408 TX Bit 0       DS2408 TX Bit 0
    Family Code              Master TX Bit 0              DS2408 TX Bit 0       DS2408 TX Bit 0
       (1 Byte)                                            Master TX Bit 0       Master TX Bit 0
                                   Bit 0        N     N         Bit 0         N       Bit 0
                                 Match?                       Match?                 Match?
                                           Y                            Y                     Y
     DS2408 TX                                            DS2408 TX Bit 1       DS2408 TX Bit 1
   Serial Number             Master TX Bit 1              DS2408 TX Bit 1       DS2408 TX Bit 1
      (6 Bytes)                                            Master TX Bit 1       Master TX Bit 1
                                   Bit 1        N     N         Bit 1         N       Bit 1
                                 Match?                       Match?                 Match?
                                           Y                            Y                     Y
                                                         DS2408 TX Bit 63       DS2408 TX Bit 63
     DS2408 TX
                             Master TX Bit 63            DS2408 TX Bit 63       DS2408 TX Bit 63
      CRC Byte
                                                          Master TX Bit 63      Master TX Bit 63
                                   Bit 63       N     N        Bit 63         N      Bit 63
                                  Match?                      Match?                 Match?
                                           Y                            Y                     Y
                                                                                                To Figure 12
                                  RC = 1                       RC = 1                RC = 1        nd
                                                                                                  2 Part
                                                                                             From Figure 12
                                                                                                  nd
                                                                                                 2 Part
                                                  To Control Functions
                                                 Flow Chart (Figure 8)
                                                     22 of 39


                                                                                DS2408
Figure 12-2. ROM FUNCTIONS FLOW CHART
                 st
  To Figure 12, 1 Part
 From Figure 12
       st
     1 Part
               CCh     N    A5h     N             3Ch        N      69h          N
            Skip ROM      Resume               Overdrive       Overdrive Match
           Command?      Command?             Skip ROM?            ROM?
                    Y           Y                       Y                 Y
             RC = 0                          RC = 0 ; OD = 1   RC = 0 ; OD = 1
                                     N
                          RC = 1 ?
                                                               Master TX Bit 0
                                Y
                                                 Master      Y                   N
                                                                    Bit 0
                                              TX Reset ?          Match?
                                                                            Y
                                                       N
                                                               Master TX Bit 1
                                     Master      Y                  Bit 1        N
                                   TX Reset ?                     Match?
                                                                            Y
                                           N
                                                               Master TX Bit 63
                                                                   Bit 63        N
                                                                   Match?
                                                                            Y
 From Figure 12
       st
     1 Part                                                        RC = 1
  To Figure 12
      st
    1 Part
                                   23 of 39


                                                                                                        DS2408
1-WIRE SIGNALING
The DS2408 requires strict protocols to ensure data integrity. The protocol consists of four types of
signaling on one line: Reset Sequence with Reset Pulse and Presence Pulse, Write-Zero, Write-One, and
Read-Data. Except for the presence pulse, the bus master initiates all these signals. The DS2408 can
communicate at two different speeds, standard speed, and overdrive speed. If not explicitly set into the
overdrive mode, the DS2408 will communicate at standard speed. While in overdrive mode, the fast
timing applies to all waveforms.
To get from idle to active, the voltage on the 1-Wire line needs to fall from VPUP below the VTL threshold.
To get from active to idle, the voltage needs to rise from VILMAX past the VTH threshold. The VILMAX
voltage is relevant for the DS2408 when determining a logical level, not triggering any events.
Figure 13 shows the initialization sequence required to begin any communication with the DS2408. A
Reset Pulse followed by a Presence Pulse indicates the DS2408 is ready to receive data, given the correct
ROM and control function command. If the bus master uses slew-rate control on the falling edge, it must
pull down the line for tRSTL + tF to compensate for the edge. A tRSTL duration of 480µs or longer will exit
the overdrive mode returning the device to standard speed. If the DS2408 is in overdrive mode and tRSTL
is no longer than 80µs the device will remain in overdrive mode.
Figure 13. INITIALIZATION PROCEDURE “RESET AND PRESENCE PULSES”
After the bus master has released the line it goes into receive mode (RX). The 1-Wire bus is then pulled
to VPUP via the pullup resistor or, in case of a DS2480B driver, by active circuitry. When the VTH
threshold is crossed, the DS2408 waits for tPDH and then transmits a Presence Pulse by pulling the line
low for tPDL. To detect a presence pulse, the master must test the logical state of the 1-Wire line at tMSP.
The tRSTH window must be at least the sum of tPDHMAX, tPDLMAX, and tRECMIN. Immediately after tRSTH is
expired, the DS2408 is ready for data communication. In a mixed population network, tRSTH should be
extended to a minimum of 480µs at standard speed and 48µs at overdrive speed to accommodate other 1-
Wire devices.
                                                   24 of 39


                                                                                                   DS2408
Read/Write Time Slots
Data communication with the DS2408 takes place in time slots, which carry a single bit each. Write time
slots transport data from bus master to slave. Read time slots transfer data from slave to master. The
definitions of the write and read time slots are illustrated in Figure 14.
All communication begins with the master pulling the data line low. As the voltage on the 1-Wire line
falls below the threshold VTL, the DS2408 starts its internal time base. The tolerance of the slave time
base creates a slave-sampling window, which stretches from tSLSMIN to tSLSMAX. The voltage on the data
line at the sampling point determines whether the DS2408 decodes the time slot as 1 or 0.
Master-to-Slave
For a write-one time slot, the voltage on the data line must have crossed the VTHMAX threshold after the
write-one low time tW1LMAX has expired. For a write-zero time slot, the voltage on the data line must stay
below the VTHMIN threshold until the write-zero low time tW0LMIN has expired. For most reliable
communication, the voltage on the data line should not exceed VILMAX during the entire tW0L window.
After the VTHMAX threshold has been crossed, the DS2408 needs a recovery time tREC before it is ready for
the next time slot.
Figure 14. READ/WRITE TIMING DIAGRAM
Write-One Time Slot
                VPUP           tW1L
            VIHMASTER
                  VTH
                                                           DS2408
                  VTL                                      Sampling
               VILMAX                                      Window
                  0V
                      tF              ε
                                     tSLSMIN
                                                            tSLSMAX
                                                                            tSLOT
Write-Zero Time Slot
                                           tW0L
                VPUP
            VIHMASTER
                  VTH                                       DS2408
                                                           Sampling
                  VTL
                                                            Window
               VILMAX
                  0V
                        tF          tSLSMIN                                ε        tREC
                                                          tSLSMAX
                                                                                  tSLOT
                                                     25 of 39


                                                                                                      DS2408
Read-Data Time Slot
Slave-to-Master
A read-data time slot begins like a write-one time slot. The voltage on the data line must remain below
VTLMIN until the read low time tRL has expired. During the tRL window, when responding with a 0, the
DS2408 starts pulling the data line low; its internal timing generator determines when this pulldown ends
and the voltage starts rising again. When responding with a 1, the DS2408 does not hold the data line low
at all, and the voltage starts rising as soon as tRL is over.
The sum of tRL + δ (rise time) on one side and the internal timing generator of the DS2408 on the other
side define the master sampling window (tMSRMIN to tMSRMAX) in which the master must perform a read
from the data line. For most reliable communication, tRL should be as short as permissible and the master
should read close to but no later than tMSRMAX. After reading from the data line, the master must wait until
tSLOT is expired. This guarantees sufficient recovery time tREC for the DS2408 to get ready for the next
time slot.
Improved Network Behavior
In a 1-Wire environment, line termination is possible only during transients controlled by the bus master
(1-Wire driver). 1-Wire networks therefore are susceptible to noise of various origins. Depending on the
physical size and topology of the network, reflections from end points and branch points can add up or
cancel each other to some extent. Such reflections are visible as glitches or ringing on the 1-Wire
communication line. Noise coupled onto the 1-Wire line from external sources can also result in signal
glitching. A glitch during the rising edge of a time slot can cause a slave device to lose synchronization
with the master and, as a consequence, result in a Search ROM command coming to a dead end or cause a
device level command to abort. For better performance in network applications, the DS2408 uses a new
1-Wire front end, which makes it less sensitive to noise and also reduces the magnitude of noise injected
by the slave device itself.
The 1-Wire front end of the DS2408 differs from traditional slave devices in four characteristics.
1) The falling edge of the presence pulse has a controlled slew rate. This provides a better match to the
    line impedance than a digitally switched transistor, converting the high-frequency ringing known
    from traditional devices into a smoother low-bandwidth transition. The slew rate control is specified
    by the parameter tFPD, which has different values for standard and overdrive speed.
2) There is additional lowpass filtering in the circuit that detects the falling edge at the beginning of a
    time slot. This reduces the sensitivity to high-frequency noise. This additional filtering does not apply
    at overdrive speed.
                                                       26 of 39


                                                                                                     DS2408
3) The input buffer was designed with hysteresis. If a negative glitch crosses VTH but doesn’t go below
     VTH - VHY, it will not be recognized (Figure 15, Case A). The hysteresis is effective at any 1-Wire
     speed.
4) There is a time window specified by the rising edge hold-off time tREH during which glitches will be
     ignored, even if they extend below the VTH - VHY threshold (Figure 15, Case B, tGL < tREH). Deep
     voltage droops or glitches that appear late after crossing the VTH threshold and extend beyond the tREH
     window cannot be filtered out and will be taken as the beginning of a new time slot (Figure 15, Case
     C, tGL ≥ tREH).
Figure 15. NOISE SUPPRESSION SCHEME
       VPUP                                       tREH                      tREH
        VTH
    VHY
                       Case A                    Case B                       Case C
         0V
                                                tGL                          tGL
CRC GENERATION
The DS2408 has two different types of cyclic redundancy checks (CRCs). One CRC is an 8-bit type and
is stored in the most significant byte of the 64-bit ROM. The bus master can compute a CRC value from
the first 56 bits of the 64-bit ROM and compare it to the value stored within the DS2408 to determine if
the ROM data has been received error free. The equivalent polynomial function of this CRC is X8 + X5 +
X4 + 1. This 8-bit CRC is received in the true (noninverted) form. It is computed at the factory and lasered
into the ROM.
The other CRC is a 16-bit type, generated according to the standardized CRC16-polynomial function X16
+ X15 + X2 + 1. This CRC is used for error detection when reading data through the end of the register
page using the Read PIO Registers command, for fast verification of the data transfer when writing to or
reading from the scratchpad, and when reading from the PIO using the Channel-access Read command.
In contrast to the 8-bit CRC, the 16-bit CRC is always communicated in the inverted form. A CRC-
generator inside the DS2408 chip (Figure 16) calculates a new 16-bit CRC as shown in the command
flow chart of Figure 8. The bus master compares the CRC value read from the device to the one it
calculates from the data and decides whether to continue with an operation or to reread the portion of the
data with the CRC error.
With the Read PIO Registers flow chart, the 16-bit CRC value is the result of shifting the command byte
into the cleared CRC generator, followed by the 2 address bytes and the data bytes beginning at the target
address and ending with the last byte of the register page, address 008Fh.
With the initial pass through the Channel-access Read command flow, the CRC is generated by first
clearing the CRC generator and then shifting in the command code followed by 32 bytes of PIO pin data.
Subsequent passes through the command flow will generate a 16-bit CRC that is the result of clearing the
CRC generator and then shifting in 32 bytes read from the PIO pins. For more information on generating
CRC values see Application Note 27.
                                                      27 of 39


                                                                                                                                                  DS2408
Figure 16. CRC-16 HARDWARE DESCRIPTION AND POLYNOMIAL
                                                                                   16      15        2
                                                    POLYNOMIAL = X                     +X      +X +1
          st          nd                             rd              th              th             th           th             th
        1           2                              3               4               5              6            7              8
      STAGE       STAGE                        STAGE           STAGE           STAGE          STAGE          STAGE          STAGE
    0            1                            2               3               4              5              6              7
  X            X                            X               X               X              X              X             X
          th           th         th            th              th              th             th                               th
        9          10          11            12              13              14            15                                16
      STAGE       STAGE       STAGE       STAGE           STAGE           STAGE           STAGE                            STAGE
    8            9          10           11              12              13             14                               15           16
  X            X          X            X              X               X               X                                X            X         CRC
                                                                                                                                              OUTPUT
                                                                                                       INPUT DATA
Figure 17. DS2408 AS SLAVE INTERFACE FOR MICROCONTROLLER
                                                                           PULLUP PROVIDED BY CPU
                                                        47U
                                     VCC
             VCC
             GND
                                                    3                            2                       3                                   50
              1W                                          VCC             P0                                  P1.0                  P0.0/AD0
                                                                                 14                      4                                   49
                                                                          P1                                  P1.1                  P0.1/AD1
                                                                                 13                      5                                   48
                                                                          P2                                  P1.2                  P0.2/AD2
                                                                                 12                      6                                   47
                                                                          P3                                  P1.3                  P0.3/AD3
                                                                                 11                      7                                   46
                                                                          P4                                  P1.4                  P0.4/AD4
                                                                                 9                       8                                   45
                                                                          P5                                  P1.5                  P0.5/AD5
                                                    4                            8                       9                                   44
                                                          IO              P6                                  P1.6                  P0.6/AD6
                                                                                 7                      10                                   43
                                                                          P7                                  P1.7                  P0.7/AD7
                                                    5
                                                          GND
                                                                                 10                     12                                   39
                                                                        RSTZ                                  RST                        ALE
                                                                                                                                             38
                                                                                                                                       PSEN
                                                                                                        42
                                                          DS2408                                              EA                             30
                                                                                                                                    P2.0/AD8
                                                                                                        15                                   31
                                                                                                              P3.0/RXD0             P2.1/AD9
                                                                                                        16                                   32
                                                                                                              P3.1/TXD0            P2.2/AD10
                                                                                                        17                                   33
                                                                                                              P3 .2 / INT0         P2.3/AD11
                                                                                                        18                                   34
                                                                                                              P3 .3 / INT1         P2.4/AD12
                                                                                                        19                                   35
                                                                                                              P3.4/T0              P2.5/AD13
                                                                                                        20                                   36
                                                                                                              P3.5/T1              P2.6/AD14
                                                                                                        21                                   37
                                                                                                              P3 .6 / WR           P2.7/AD15
                                                                                                        22
                                                                                                              P3 .7 / RD
                                                                                                        23                                   28
                                                                                                              XTAL2                   RTCX1
                                                                                                        24                                   27
                                                                                                              XTAL1                   RTCX2
                                                                                                              DS80C520
                                                                                                              8051 Equiv CPU
The data direction (upload/download) is determined by application-specific data protocol.
                                                                          28 of 39


                                                                                                                                                              DS2408
Figure 18. DS2408 AS SLAVE INTERFACE FOR INTELLIGENT DISPLAY
                                                                  1               6                                           Local iButton Probe
                                                                  2               5                47
                                                                  3               4
                                                                      DS9503                                                LCD Display
                                                                                                         VCC
                                                                                         47U                       1
                                                                                                                       GND
                                                                                                                   2
                                                                                                                       VCC
                                                                                                                   3
                                                                                                                       CONTRAST
                                 VCC                                                                               4
                                                                                                                                      ACM1601B 16X1 Display
                                                                                                                       D/ C
                                                                                                                   5
                                                                                                                       R/ W
                                                                                                                   6
      5VDC                                                                                                             S TB
       GND
                                       3                     2                                                     7
        1W                                 VCC        P0                                                               D0
                                                             14                                                    8
                                                      P1                                                               D1
                                                             13                                                    9
                                                      P2                                                               D2
                                                             12                                                   10
                                                      P3                                                               D3
                                                                                                                                         with Back Light
                                                             11                                                   11
                                                      P4                                                               D4
                                                             9                                     VCC            12
                                                      P5                                                               D5
                                       4                     8                                                    13
                                           IO         P6                                                               D6
                                                             7                                                    14
                                                      P7                                                               D7
                                       5
                                           GND
                                                             10                                                   15
                                                    RSTZ                                                               LEDA
                                                                                                                  16
                                                                                                                       LEDK
                                           DS2408
                                                    VCC
                                                                  1 2 3 4 5 6 7 8 9 10
                                                                                                                                      Up
                                                           10K
                                                                                                                                     Down
                                                                                                                                     Select
Figure 19. DS2408 AS MICROCONTROLLER PORT EXPANDER
                                                                                         VCC
                                                                                                         DS2408
                                                                                               3                       2
                                                                                                     VCC          P0
                                                                                                                       14
                                                                                                                  P1
                                                                                                                       13
                                                                                                                  P2
                                                                                                                       12
                                                                      VC                                          P3
                                                                                                                       11
                                                                      C                                           P4
                                                                                                                       9
                                                                                                                  P5
                                                                                               4                       8
                                                                                                     IO           P6
                                                                                                                       7
                                                                                                                  P7
                                                                                               5
              MICROCONTROLLER                                                                        GND
                                                                                                                       10
                                                                                                               RSTZ
              WITH FEW I/O PINS
             VCC                                                           2.2K          VCC
                                                                                                         DS2408
                   1                            8                                              3                       2
                       VCC         GND                                                               VCC          P0
                   2                            7                                                                      14
                       OSC1/P5       P0                                                                           P1
                   3                            6                                                                      13
                       OSC2/P4       P1                                                                           P2
                   4                            5                                                                      12
                       CLR/P3    P2/CK                                                                            P3
                                                                                                                       11
                                                                                                                  P4
                                                                                                                       9
                       PIC12C508                                                               4
                                                                                                                  P5
                                                                                                                       8
                                                                                                     IO           P6
                                                                                                                       7
                                                                                                                  P7
                                                                                               5
                                                                                                     GND
                                                                                                                       10
                                                                                                               RSTZ
                             24 I/O LINES OR                                             VCC
                             3 BYTE-WIDE                                                                 DS2408
                             BUSES FROM A                                                      3                       2
                                                                                                     VCC          P0
                                                                                                                       14
                             SINGLE PIN                                                                           P1
                                                                                                                       13
                                                                                                                  P2
                                                                                                                       12
                                                                                                                  P3
                                                                                                                       11
                                                                                                                  P4
                                                                                                                       9
                                                                                                                  P5
                                                                                               4                       8
                                                                                                     IO           P6
                                                                                                                       7
                                                                                                                  P7
                                                                                               5
                                                                                                     GND
                                                                                                                       10
                                                                                                               RSTZ
                                                                             29 of 39


                                                                                                                          DS2408
Figure 20. DS2408 AS µC-OPERATED KEYBOARD SCANNER
                                                                                     10kΩ
                               10U
                                                                 1 2 3 4 5 6 7 8 9 10
           VCC
    VCC
    GND
                           3                           2
     1Ω                            VCC          P0
                                                       14
                                                P1
                                                       13
                                                P2
                                                       12
                                                P3
                                                       11
                                                P4
                                                       9
                                                P5
                           4                           8
                                   IO           P6
                                                       7
                                                P7
                           5
                                   GND
                                                       10
                                              RSTZ
                                   DS2408
                                                     VCC
                               POR Circuit
                                                  VCC
                                                    RST
                                                  GND
                                        DS1811
                                        The DS1811 has
                                        an internal pull-up
                                        resistor of 5.5 kΩ
                                                                                    To More Switch Rows
                                                                                  (Up to 4 x 4, 3 x 5 or 2 x 6)
Figure 21. DS2408 AS PARASITE-POWERED PUSH-BUTTON SENSOR
                     VCC
            0.1U
           Parasite
            Power
                 BAT54         3
                                        VCC       P0
                                                            2
                                                            14
                                                  P1
                                                            13
                                                  P2
                                                            12
      1W                                          P3
                                                            11
     GND                                          P4
                                                            9
                                                  P5
                               4                            8
                                        IO        P6
                                                            7
                                                  P7
                               5
                                        GND
                                                           10
                                                RSTZ
                                    DS2408
                                                                   1 2 3 4 5 6 7 8 9 10
                                                                                        100k
                                                                                               SWITCHES OR PUSH-BUTTONS
                                                                 30 of 39


                                                                                                    DS2408
Figure 22. DS2408 AS MULTIPURPOSE SENSOR/ACTUATOR
                                10kΩ
              47U
                                     1 2 3 4 5 6 7 8 9 10
                                                                                       SΩITCHES
                                                                                       OR PUSH-
              VCC                                                                      BUTTONS
       VCC
        1Ω
                  3             2
       GND          VCC      P0
                                14
                             P1
                                13
                             P2
                                12
                             P3
                                11
                             P4
                                9                                             VCC
                             P5
                  4             8                                 4mA
                    IO       P6
                                7                                      1kΩ
                             P7
                  5
                    GND
                           RSTZ
                                10                                                       ISOLATED
                                                                       OPTOISO
                    DS2408                             VCC                         6     OUTPUT
                                                                    1
                                                                                   5
                                                                    2
                                                           BSS-84
                                                                                   4
                                           1N4004                                         DRY
                                                             5V                           CONTACT
                                                                               LED
                                                                                     VCC  LED INDI-
                                                                                          CATOR
                                                                  470Ω   8mA
                                                31 of 39


                                                                                                              DS2408
Command-Specific 1-Wire Communication Protocol—Legend
      SYMBOL                                                   DESCRIPTION
          RST           1-Wire Reset Pulse generated by master.
           PD           1-Wire Presence Pulse generated by slave.
         Select         Command and data to satisfy the ROM function protocol.
          RPR           Command "Read PIO Registers".
          CAR           Command "Channel-Access Read".
         CAW            Command "Channel-Access Write".
         WCS            Command "Write Conditional Search Register".
          RAL           Command "Reset Activity Latches".
           TA           Target Address TA1, TA2.
        <data>          Transfer of an undetermined amount of data.
       CRC16\           Transfer of an inverted CRC16.
        FF loop         Indefinite loop where the master reads FF bytes.
       AA loop          Indefinite loop where the master reads AA bytes.
    <32 samples>,
                        Indefinite loop where the master reads 32 PIO samples followed by an inverted CRC16.
     CRC16\ loop
  <new state>, <new     Transfer of 2 bytes, where the second byte is the bit-inverse of the first byte. The first
        state\>         byte will be taken as the new PIO state.
                        Transfer of 2 bytes, where the first byte is a constant (AAh) and the second byte is the
  AAh, <read back>
                        current PIO state.
     <new state>,
                        Transfer of 2 bytes, where the second byte is NOT the bit-inverse of the first byte.
       <invalid>
Command-Specific 1-Wire Communication Protocol—Color Codes
 Master to slave    Slave to master
Read PIO Registers (Success)
 RST      PD    Select    RPR      TA    <data>     CRC16\     FF loop
Read PIO Registers (Fail Address)
 RST      PD    Select    RPR      TA    FF loop
Channel-Access Read (Cannot Fail)
 RST      PD    Select    CAR      <32 samples>, CRC16\ loop
                                                     32 of 39


                                                                                                         DS2408
Channel-Access Write (Success)
   RST     PD    Select    CAW    <new state>, <new state\>      AAh, <read back>
                                                                                          Loop
Channel-Access Write (Fail New State)
   RST     PD    Select    CAW    <new state>, <invalid>     FF loop
Write Conditional Search Register (Success)
   RST     PD    Select    WCS    TA    <data>     FF loop
Write Conditional Search Register (Fail Address)
   RST     PD    Select    WCS    TA    FF loop
Reset Activity Latches (Cannot Fail)
   RST     PD    Select    RAL    AA loop
COMMUNICATION EXAMPLES
The examples in this section demonstrate the use of ROM and control functions in typical situations. The
first two examples are related to Figure 17. They show how to write to the PIO with readback for
verification or for receiving an immediate response (example 1) and how to read from the PIO in an
endless loop (example 2). The third example assumes a network of multiple DS2408s where each of the
devices is connected to 8 pushbuttons, as in Figure 21.
Example 1
Task: Write to the PIO with readback for verification or for receiving an immediate response.
This task is broken into the following steps:
1) Configure RSTZ as STRB output.
2) Verify configuration setting.
3) Write to the PIO and read back the response.
With only a single DS2408 connected to the bus master, the communication is as follows:
      MASTER MODE                  DATA (LSB FIRST)                                COMMENTS
 Step 1     TX                            (Reset)                  Reset pulse
            RX                          (Presence)                 Presence pulse
            TX                             CCh                     Issue Skip ROM command
            TX                             CCh                     Issue Write Conditional Search Register
                                                                   command
            TX                              8Dh                    TA1, target address = 8Dh
            TX                              00h                    TA2, target address = 008Dh
            TX                              04h                    Write byte to Control/Status Register
                                                    33 of 39


                                                                                                      DS2408
     MASTER MODE                     DATA (LSB FIRST)                          COMMENTS
            TX                             (Reset)            Reset pulse
            RX                           (Presence)           Presence pulse
 Step 2     TX                              CCh               Issue Skip ROM command
            TX                               F0h              Issue Read PIO Registers command
            TX                               8Dh              TA1, target address = 8Dh
            TX                               00h              TA2, target address = 008Dh
            RX                               84h              Read Control/Status Register and verify
            TX                             (Reset)            Reset pulse
            RX                           (Presence)           Presence pulse
 Step 3     TX                              CCh               Issue Skip ROM command
            TX                               5Ah              Issue Channel-access Write command
            TX                        <PIO output byte>       Write byte to PIO
            TX                   <inverted PIO output byte>   Write inverted byte to PIO
           (—)                               (—)              DS2408 updates PIO status if transmission
                                                              was OK
            RX                               AAh              Read for verification (AAh = success)
           (—)                               (—)              DS2408 samples PIO pin status
            RX                      <PIO pin status byte>     Read PIO pin status
            TX                        <PIO output byte>       Write byte to PIO (next byte)
            TX                   <inverted PIO output byte>   Write inverted byte to PIO (next byte)
            RX                               AAh              Read for verification (AAh = success)
            RX                      <PIO pin status byte>     Read PIO pin status
                                                              Repeat the previous 4 steps with more PIO
           (—)                               (—)
                                                              output data as needed in the application.
            TX                             (Reset)            Reset pulse
            RX                           (Presence)           Presence pulse
When using this communication example to send data to a remote microcontroller, as in Figure 17,
synchronization between the master and the remote microcontroller can be maintained by transmitting
data packets that begin with a length byte and end with a CRC16. See Application Note 114, section
"UNIVERSAL DATA PACKET" for details.
Example 2
Task: Read from the PIO in an endless loop.
This task is broken into the following steps:
1) Configure RSTZ as STRB output.
2) Verify configuration setting.
3) Read from the PIO.
With only a single DS2408 connected to the bus master, the communication is as follows:
     MASTER MODE                     DATA (LSB FIRST)                          COMMENTS
 Step 1     TX                             (Reset)            Reset pulse
            RX                           (Presence)           Presence pulse
            TX                              CCh               Issue Skip ROM command
                                                              Issue Write Conditional Search Register
            TX                              CCh
                                                              command
            TX                               8Dh              TA1, target address = 8Dh
            TX                               00h              TA2, target address = 008Dh
                                                     34 of 39


                                                                                                         DS2408
      MASTER MODE                   DATA (LSB FIRST)                              COMMENTS
             TX                             04h                  Write byte to Control/Status Register
             TX                           (Reset)                Reset pulse
            RX                          (Presence)               Presence pulse
 Step 2     TX                             CCh                   Issue Skip ROM command
             TX                             F0h                  Issue Read PIO Registers command
             TX                             8Dh                  TA1, target address = 8Dh
             TX                             00h                  TA2, target address = 008Dh
            RX                              84h                  Read Control/Status Register and verify
             TX                           (Reset)                Reset pulse
            RX                          (Presence)               Presence pulse
 Step 3     TX                             CCh                   Issue Skip ROM command
             TX                             F5h                  Issue Channel-access Read command
            (—)                             (—)                  DS2408 samples PIO pin status
            RX                     <PIO pin status byte>         Read PIO pin status
                                                                 Repeat the previous 2 steps until the master
            (—)                             (—)                  has received a total of 32 bytes of PIO pin
                                                                 status
            RX                       <2 bytes CRC16>             Read CRC16
                                                                 PIO pin status and CRC loop can be
            (—)                             (—)
                                                                 continued as long as the application requires.
             TX                           (Reset)                Reset pulse
            RX                          (Presence)               Presence pulse
When using this communication example to read data from a remote microcontroller, as in Figure 17,
synchronization between the remote microcontroller and the master can be maintained by transmitting
data packets that begin with a length byte and end with a CRC16. See Application Note 114, section
"UNIVERSAL DATA PACKET" for details.
Example 3
Task: Detect the specific DS2408 where the button was pressed and identify the pin to which the
pushbutton is connected. This task is broken into the following steps:
1) Configure the conditional search and verify configuration setting.
2) Switch off all channel output transistors.
3) Clear the activity latches.
4) Search until a pushbutton is pressed.
5) Identify device and pushbutton; reset activity latches.
The device has to respond to the conditional search if the activity latch of at least one of the 8 channels is
set. This requires the following setup data for the conditional search registers:
   Channel Selection Mask, select all channels ⇒ FFh
   Channel Polarity Selection, select logic 1 for all channels ⇒ FFh
                                                    35 of 39


                                                                                                        DS2408
   Control/Status register,
      Source is Activity Latch ⇒ PLS = 1
      Term is OR ⇒ CT = 0
      RSTZ = inactive (input) ⇒ ROS = 0
      Clear Power-On Reset Latch ⇒ PORL = 0
      The resulting setup data for the Control/Status Register is 01h.
For each DS2408 in the application, perform the following initialization:
     MASTER MODE                   DATA (LSB FIRST)                                 COMMENTS
 Step 1    TX                             (Reset)                Reset pulse
           RX                           (Presence)               Presence pulse
            TX                              55h                  Issue Match ROM command
            TX                       <8 byte ROM ID>             Send ROM ID of the device to be accessed
                                                                 Issue Write Conditional Search Register
            TX                             CCh
                                                                 command
            TX                              8Bh                  TA1, target address = 8Bh
            TX                              00h                  TA2, target address = 008Bh
            TX                              FFh                  Write Channel Selection Mask
            TX                              FFh                  Write Channel Polarity Selection
            TX                              01h                  Write Control/Status Register
            TX                            (Reset)                Reset pulse
           RX                           (Presence)               Presence pulse
            TX                              A5h                  Issue Resume command
            TX                              F0h                  Issue Read PIO Registers command
            TX                              8Bh                  TA1, target address = 8Bh
            TX                              00h                  TA2, target address = 008Bh
           RX                        <FFh, FFh, 81h>             Read Registers and verify
            TX                            (Reset)                Reset pulse
           RX                           (Presence)               Presence pulse
 Step 2    TX                               A5h                  Issue Resume command
            TX                              5Ah                  Issue Channel-access Write command
            TX                              FFh                  Write byte to PIO
            TX                              00h                  Write inverted byte to PIO
                                                                 DS2408 switches off all channel output
           (—)                              (—)
                                                                 transistors if transmission was OK
           RX                               AAh                  Read for verification (AAh = success)
           RX                               FFh                  Read PIO pin status and verify; FFh = OK
            TX                            (Reset)                Reset pulse
           RX                           (Presence)               Presence pulse
 Step 3    TX                               A5h                  Issue Resume command
            TX                               C3                  Issue Reset Activity Latch command
           RX                               AAh                  Read for verification (AAh = success)
            TX                            (Reset)                Reset pulse
           RX                           (Presence)               Presence pulse
                                                   36 of 39


                                                                                                           DS2408
After all DS2408s are initialized, perform the search process below as an endless loop:
     MASTER MODE                    DATA (LSB FIRST)                              COMMENTS
 Step 4    TX                             (Reset)              Reset pulse
           RX                           (Presence)             Presence pulse
            TX                             ECh                 Issue Conditional Search ROM command
                                                               Read 2 bits; if both bits are 1, no push button
                                                               has been pressed; in this case return to Step
           RX                            <2 bits>              4. If the bit pattern is 01 or 10 or 00, a push
                                                               button has been pressed; in this case
                                                               continue with Step 5.
                                                               Identify and select the LS bit of the ROM ID
 Step 5    TX                            <1 bits>              of the DS2408 that has responded to the
                                                               Conditional Search.
                                                               Read 2 bits; this relates to the next bit of the
           RX                            <2 bits>
                                                               ROM ID of the participating device(s).
                                                               Identify and select the next bit of the ROM ID
            TX                           <1 bits>              of the DS2408 that has responded to the
                                                               Conditional Search.
                                                               Repeat the previous 2 steps until one device
           (—)                              (—)                has been identified and accessed. (see Note
                                                               1)
            TX                              F0h                Issue Read PIO Registers command
            TX                              88h                TA1, target address = 88h
            TX                              00h                TA2, target address = 0000h
                                                               Read register page; the data in the Activity
           RX                         <8 data bytes>           Latch State Register tells which button has
                                                               been pressed.
                                                               Read CRC16 and verify correct data
           RX                        <2 bytes CRC16>
                                                               transmission.
            TX                            (Reset)              Reset pulse
           RX                           (Presence)             Presence pulse
            TX                              A5h                Issue Resume command
            TX                               C3                Issue Reset Activity Latch command
           RX                               AAh                Read for verification (AAh = success)
                                                               Now, as the device and push button are
           (—)                              (—)                identified and the Activity Latch is cleared,
                                                               continue at Step 4.
Note 1: For a full description of the Search Algorithm see Application Note 187.
                                                   37 of 39


                                                                                                     DS2408
APPLICATIONS INFORMATION
Power-up timing
The DS2408 is sensitive to the power-on slew rate and can inadvertently power up with a test mode
feature enabled. When this occurs, the P0 port does not respond to the Channel Access Write command.
For most reliable operation, it is recommended to disable the test mode after every power-on reset using
the Disable Test Mode sequence shown below. The 64-bit ROM code must be transmitted in the same bit
sequence as with the Match ROM command, i.e., least significant bit first. This precaution is
recommended in parasite power mode (VCC pin connected to GND) as well as with VCC power.
Disable Test Mode
  RST     PD   96h   <64-bit DS2408 ROM Code>     3Ch    RST   PD
Power-up State of P0 to P7
When the DS2408 powers up, the state of the I/O pins P0 to P7 is indeterminate. This behavior may not
be acceptable for some applications. To ensure that P0 to P7 power up in the "off" state, it is necessary to
have a suitable power-on-reset circuit, such as the DS1811, or a supervisor IC connected to the RSTZ pin.
RSTZ Pin
When not configured as STRB output, the RSTZ pin is to be connected to VCC, directly or through a
resistor. A local VCC supply can be created by taking energy from the 1-Wire line, as shown in Figure 21.
PACKAGE INFORMATION
For the latest package outline information and land patterns, go to www.maxim-ic.com/packages. Note
that a “+”, “#”, or “-” in the package code indicates RoHS status only. Package drawings may show a
different suffix character, but the drawing pertains to the package regardless of RoHS status.
     PACKAGE TYPE               PACKAGE CODE              OUTLINE NO.              LAND PATTERN NO.
  16 SO (150 mils)                   S16+5                   21-0041                    90-0097
                                                   38 of 39


                                                                                                                                                        DS2408
Revision History
 REVISION                                                                                                                                         PAGES
                                                                    DESCRIPTION
   DATE                                                                                                                                         CHANGED
  051403             Initial release                                                                                                                 —
  122203             Corrected the wiring in Figure 18: in 4-bit mode, the display uses D4 to D7.                                                    28
  061604             Deleted empty page at the end                                                                                                   37
                     Updated the Ordering Information for lead(Pb)-free; updated soldering temperature in
                     the Absolute Maximum Ratings.
                     Applied EC table note 14 to tW0L.
                     Deleted ε from the tW1L spec in the EC table.
                     VTL/VTH clarification: Added to EC table note 5 the text ", which in parasitic power                                     1, 2, 3, 4, 25,
   12/10
                     mode, is a function of ..."                                                                                                     38
                     Added to EC table notes 14 and 15 the reference to Figure 14 and the text "The actual
                     maximum duration...."
                     Added ε to the write zero time slot graphic in Figure 14.
                     Added the Applications Information section; added the Package Information section
    3/15             Updated Benefits and Features section                                                                                            1
   Maxim Integrated cannot assume responsibility for use of any circuitry other than circuitry entirely embodied in a Maxim Integrated product. No circuit
   patent licenses are implied. Maxim Integrated reserves the right to change the circuitry and specifications without notice at any time. The parametric
   values (min and max limits) shown in the Electrical Characteristics table are guaranteed. Other parametric values quoted in this data sheet are
   provided for guidance.
   Maxim Integrated, 160 Rio Robles, San Jose, CA 95134 1-408-601-1000
   ©2015 Maxim Integrated Products, Inc. The Maxim logo and Maxim Integrated are trademarks of Maxim Integrated Products, Inc.
                                                                          39 of 39


Mouser Electronics
Authorized Distributor
Click to View Pricing, Inventory, Delivery & Lifecycle Information:
Maxim Integrated:
 DS2408S+ DS2408S+T&R
