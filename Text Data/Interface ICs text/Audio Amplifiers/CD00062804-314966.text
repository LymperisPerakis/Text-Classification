                                                                                                       STA326
                                               2.1-channel high-efficiency digital audio system
                                                                                            Datasheet - production data
                                                                      Bass/treble tone control
                                                                      Dual independent programmable
                                                                        limiters/compressors
                                                                      Automodes
                                                                                                               s  )
                                                                        – 32 preset EQ curves
                                                                        – 15 preset crossover settings
                                                                                                         c t(
                                                                                                     u
                                                                        – Auto volume-controlled loudness
                                                                                                  d
                                                                                             r o
                                                                        – 3 preset volume curves
                                                                        – 2 preset anti-clipping modes
                           PowerSO-36
                    with exposed pad up                                                   P
                                                                        – Preset nighttime listening mode
                                                                                      e
                                                                                    t
                                                                        – Preset TV AGC
                                                                                le
                                                                          s  o
                                                                      Input and output channel mapping
                                                                      AM noise-reduction and PWM
 Features
  Wide supply voltage range (10 V - 36 V)                        O   b frequency-shifting modes
  Three power output configurations
                                                           )   -      Software volume update and muting
                                                                      Auto zero detect and invalid input detect
      – 2 x 40 W + 1 x 80 W
                                                      t(s               muting
                                                  uc
      – 2 x 80 W                                                      Selectable DDX® ternary or binary PWM
      – 1 x 160 W
                                         o   d                          output + variable PWM speeds
                                      r
  PowerSO-36 package (exposed pad up (EPU))                          Selectable de-emphasis
                         eP
  2.1 channels of 24-bit DDX®                                        Post-EQ user-programmable mix with default
                l e   t
  100-dB SNR and dynamic range
  32 kHz to 192 kHz input sample rates
                                                                        2.1 bass-management settings
                                                                      Variable max power correction for lower full-
        s    o
  Digital gain/attenuation +48 dB to -80 dB in
                                                                        power THD
O b   0.5-dB steps
  Four 28-bit user-programmable biquads (EQ)
                                                                      Four output routing configurations
                                                                      Selectable clock input ratio
      per channel                                                     96 kHz internal processing sample rate, 24 to
  I2C control                                                          28-bit precision
  2-channel I2S input data interface                                 Video application supports 576 * fs input mode
  Individual channel and master gain/attenuation
  Individual channel and master soft/hard mute
  Individual channel volume and EQ bypass
                                                      Table 1. Device summary
                   Order code                                  Package                          Packaging
                  STA32613TR                               PowerSO-36 EPU                      Tape and reel
 January 2016                                             DocID11531 Rev 9                                         1/64
 This is information on a product in full production.                                                         www.st.com


 Contents                                                                                                                    STA326
 Contents
 1          Description . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 8
            1.1    EQ processing . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9
            1.2    Output configurations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9
 2          Pin out . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10
            2.1    Package pins . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10
            2.2
                                                                                                                             s   )
                   Pin list . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10
            2.3
                                                                                                                    c   t(
                   Pin description . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12
                                                                                                           d    u
 3
                                                                                                    r  o
            Electrical specifications . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13
            3.1                                                                                P
                   General interface specifications . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13
                                                                                        e
            3.2
                                                                               le     t
                   DC electrical specifications (3.3 V buffers) . . . . . . . . . . . . . . . . . . . . . . . . 14
            3.3
                                                                           o
                   Power electrical specifications . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14
                                                                       s
 4                                                          O     b
            Power supply and control sequencing . . . . . . . . . . . . . . . . . . . . . . . . . 16
                                                  )    -
 5
                                            ( s
            Characterization curves . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17
                                         t
                                 u   c
            I2C bus specification . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19
 6
                         o  d
            6.1
            6.2   P    r
                   Communication protocol . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19
                   Device addressing . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19
            e t e
       o  l 6.3    Write operation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20
  bs
            6.4    Read operation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20
O7          Register description . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 22
            7.1    Configuration register A (addr 0x00) . . . . . . . . . . . . . . . . . . . . . . . . . . . . 23
            7.2    Configuration register B (addr 0x01) . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26
            7.3    Configuration register C (addr 0x02) . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29
                   7.3.1      DDX® power output mode . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29
                   7.3.2      DDX® variable compensating pulse size . . . . . . . . . . . . . . . . . . . . . . . . 29
            7.4    Configuration register D (addr 0x03) . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30
            7.5    Configuration register E (addr 0x04) . . . . . . . . . . . . . . . . . . . . . . . . . . . . 32
            7.6    Configuration register F (addr 0x05) . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34
 2/64                                            DocID11531 Rev 9


 STA326                                                                                                            Contents
          7.7   Volume control . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 36
                7.7.1    Master controls . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 36
                7.7.2    Channel controls . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 36
                7.7.3    Volume description . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 36
          7.8   Automode registers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38
                7.8.1    Automodes EQ, volume, GC (addr 0x0B) . . . . . . . . . . . . . . . . . . . . . . . 38
                7.8.2    Automode AM/prescale/bass management scale (addr 0x0C) . . . . . . . 39
                7.8.3    Preset EQ settings (addr 0x0D) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 40
          7.9   Channel configuration registers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 41
                                                                                                                      s   )
                7.9.1
                7.9.2
                                                                                                             c   t(
                         Channel 1 configuration (addr 0x0E) . . . . . . . . . . . . . . . . . . . . . . . . . . . 41
                         Channel 2 configuration (addr 0x0F) . . . . . . . . . . . . . . . . . . . . . . . . . . . 41
                7.9.3
                                                                                                    d    u
                         Channel 3 configuration (addr 0x10) . . . . . . . . . . . . . . . . . . . . . . . . . . . 41
          7.10                                                                               r  o
                Tone control (addr 0x11) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 43
          7.11
                                                                                 e      P
                Dynamics control . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 44
                7.11.1
                                                                        le     t
                         Limiter 1 attack/release threshold (addr 0x12) . . . . . . . . . . . . . . . . . . . 44
                7.11.2                                              o
                         Limiter 1 attack/release threshold (addr 0x13) . . . . . . . . . . . . . . . . . . . 44
                                                                s
                7.11.3
                                                           b
                         Limiter 2 attack/release rate (addr 0x14) . . . . . . . . . . . . . . . . . . . . . . . . 44
                                                     O
                7.11.4
                7.11.5
                                           )    -
                         Limiter 2 attack/release threshold (addr 0x15) . . . . . . . . . . . . . . . . . . . 44
                         Dynamics control description . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 44
                7.11.6
                                  t  ( s
                         Anti-clipping mode . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 46
                7.11.7
                           u  c
                         Dynamic range compression mode . . . . . . . . . . . . . . . . . . . . . . . . . . . . 47
                      o d
 8                  r
          User programmable processing . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 48
                P
          8.1
          e t e EQ - biquad equation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 48
      o l 8.2   Prescale . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 48
  bs
          8.3   Postscale . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 48
O         8.4
          8.5
                Mix/bass management . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 49
                Calculating 24-bit signed fractional numbers from a dB value . . . . . . . . . 50
          8.6   User-defined coefficient RAM . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 50
                8.6.1    Coefficient address register 1 (addr 0x16) . . . . . . . . . . . . . . . . . . . . . . . 50
                8.6.2    Coefficient b1data register bits 23:16 (addr 0x17) . . . . . . . . . . . . . . . . . 50
                8.6.3    Coefficient b1data register bits 15:8 (addr 0x18) . . . . . . . . . . . . . . . . . . 50
                8.6.4    Coefficient b1data register bits 7:0 (addr 0x19) . . . . . . . . . . . . . . . . . . . 50
                8.6.5    Coefficient b2 data register bits 23:16 (addr 0x1A) . . . . . . . . . . . . . . . . 50
                8.6.6    Coefficient b2 data register bits 15:8 (addr 0x1B) . . . . . . . . . . . . . . . . . 51
                8.6.7    Coefficient b2 data register bits 7:0 (addr 0x1C) . . . . . . . . . . . . . . . . . . 51
                                          DocID11531 Rev 9                                                                   3/64
                                                                                                                                  64


 Contents                                                                                                         STA326
                  8.6.8    Coefficient a1 data register bits 23:16 (addr 0x1D) . . . . . . . . . . . . . . . . 51
                  8.6.9    Coefficient a1 data register bits 15:8 (addr 0x1E) . . . . . . . . . . . . . . . . . 51
                  8.6.10   Coefficient a1 data register bits 7:0 (addr 0x1F) . . . . . . . . . . . . . . . . . . 51
                  8.6.11   Coefficient a2 data register bits 23:16 (addr 0x20) . . . . . . . . . . . . . . . . 51
                  8.6.12   Coefficient a2 data register bits 15:8 (addr 0x21) . . . . . . . . . . . . . . . . . 51
                  8.6.13   Coefficient a2 data register bits 7:0 (addr 0x22) . . . . . . . . . . . . . . . . . . 51
                  8.6.14   Coefficient b0 data register bits 23:16 (addr 0x23) . . . . . . . . . . . . . . . . 52
                  8.6.15   Coefficient b0 data register bits 15:8 (addr 0x24) . . . . . . . . . . . . . . . . . 52
                  8.6.16   Coefficient b0 data register bits 7:0 (addr 0x25) . . . . . . . . . . . . . . . . . . 52
                  8.6.17
                                                                                                                  s
                           Coefficient write control register (addr 0x26) . . . . . . . . . . . . . . . . . . . . . 52)
            8.7
                                                                                                         c   t(
                  Reading a coefficient from RAM . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 53
            8.8
                                                                                                d    u
                  Reading a set of coefficients from RAM . . . . . . . . . . . . . . . . . . . . . . . . . . 53
            8.9                                                                           r o
                  Writing a single coefficient to RAM . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 53
            8.10                                                                     P
                  Writing a set of coefficients to RAM . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 54
                                                                               e
            8.11
                                                                       le   t
                  Variable max power correction (addr 0x27, 0x28) . . . . . . . . . . . . . . . . . . 56
            8.12
                                                               s   o
                  Fault detect recovery (addr 0x2B, 0x2C) . . . . . . . . . . . . . . . . . . . . . . . . . 56
            8.13                                           b
                  Status (addr 0x2D) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 56
                                                     O
 9                                          )    -
            Applications . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 57
                                    t ( s
 10
                             u  c
            Package mechanical data . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 60
            10.1
                        o d
                  PowerSO-36 EPU package information . . . . . . . . . . . . . . . . . . . . . . . . . . 61
                  P   r
 11
                e
            Revision history . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 63
            e t
        o l
  b   s
O
 4/64                                      DocID11531 Rev 9


 STA326                                                                                                                               List of tables
 List of tables
 Table 1.    Device summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1
 Table 2.    Pin list . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10
 Table 3.    Absolute maximum ratings . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13
 Table 4.    Thermal data. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13
 Table 5.    Recommended operating conditions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13
 Table 6.    General interface electrical characteristics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13
 Table 7.    DC electrical specifications . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14
 Table 8.    Power electrical characteristics. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14
 Table 9.
 Table 10.
             Register summary. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 22
                                                                                                                                               s
             Master clock select . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 23  )
 Table 11.
 Table 12.
             IR and MCS settings for input sample rate and clock rate . . . . . . . . . . . . . . . . . . . . . . . . . 24
                                                                                                                                     c    t(
             Interpolation ratio select . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24
 Table 13.
                                                                                                                           d    u
             IR bit settings as a function of input sample rate . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24
 Table 14.
 Table 15.                                                                                                         r  o
             Thermal warning recovery bypass . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24
             Thermal warning adjustment bypass . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25
 Table 16.                                                                                                    P
             Fault detect recovery bypass . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25
                                                                                                      e
 Table 17.
 Table 18.
                                                                                             le     t
             Serial audio input interface format . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26
             Supported serial audio input formats . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 27
 Table 19.
 Table 20.                                                                          s   o
             Serial input data timing characteristics (fs = 32 to 192 kHz). . . . . . . . . . . . . . . . . . . . . . . . 28
             Delay serial clock enable . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28
 Table 21.
 Table 22.                                                              O      b
             Channel input mapping . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28
             DDX® power output mode . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29
 Table 23.
                                                             )    -
             DDX® output modes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29
 Table 24.
 Table 25.
                                                   t  (  s
             DDX® compensating pulse . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29
             High-pass filter bypass . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30
 Table 26.                                     c
             De-emphasis. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30
                                          u
 Table 27.
 Table 28.
                                o    d
             DSP bypass . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30
             Postscale link . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30
 Table 29.
 Table 30.             P     r
             Biquad coefficient link . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31
             Dynamic range compression/anti-clipping bit . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31
 Table 31.
               t e
             Zero detect mute enable . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31
             e
 Table 32.
        o
 Table 33. l Miami mode enable. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31
             Max power correction variable . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 32
  b  s
 Table 34.
 Table 35.
             Max power correction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 32
             AM mode enable. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 32
OTable 36.
 Table 37.
             PWM speed mode . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 32
             Zero-crossing volume enable . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 33
 Table 38.   Soft volume update enable . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 33
 Table 39.   Output configuration selection . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34
 Table 40.   Output configuration selection . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34
 Table 41.   Invalid input detect mute enable . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34
 Table 42.   Binary clock loss detection enable . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34
 Table 43.   Auto-EAPD on clock loss enable . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 35
 Table 44.   Software power down . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 35
 Table 45.   External amplifier power down . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 35
 Table 46.   Master volume offset as a function of MV[7:0] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 37
 Table 47.   Channel volume as a function of CxV[7:0] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 37
 Table 48.   Automode EQ . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38
                                                            DocID11531 Rev 9                                                                          5/64
                                                                                                                                                           64


 List of tables                                                                                                                              STA326
 Table 49.    Automode volume . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38
 Table 50.    Automode gain compression/limiters . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38
 Table 51.    AMPS - Automode auto prescale . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38
 Table 52.    Automode AM switching enable . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 39
 Table 53.    Automode AM switching frequency selection . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 39
 Table 54.    Automode crossover setting . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 39
 Table 55.    Crossover frequency selection . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 39
 Table 56.    Preset EQ selection . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 40
 Table 57.    Channel limiter mapping selection . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 42
 Table 58.    Channel PWM output mapping . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 42
 Table 59.    Tone control boost/cut selection . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 43
 Table 60.    Limiter attack/release rate selection . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 45
 Table 61.    Limiter attack/release threshold selection (AC mode) . . . . . . . . . . . . . . . . . . . . . . . . . . . . 46
                                                                                                                                             s   )
                                                                                                                                        t(
 Table 62.    Limiter attack/release threshold selection (DRC mode) . . . . . . . . . . . . . . . . . . . . . . . . . . . 47
 Table 63.
 Table 64.
              RAM block for biquads, mixing, and scaling . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 54
                                                                                                                              u    c
              TWARN. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 56
 Table 65.
                                                                                                                         d
              FAULT . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 56
                                                                                                                    o
 Table 66.
 Table 67.
 Table 68.
                                                                                                                  r
              PLLUL . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 56
                                                                                                            P
              PowerSO-36 EPU package mechanical data . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 62
              Document revision history. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 63
                                                                                                  t e
                                                                                      o    le
                                                                             b    s
                                                                -     O
                                                    (  s   )
                                             c   t
                                   d    u
                           r  o
                  e   P
            l e t
      s  o
O b
 6/64                                                     DocID11531 Rev 9


 STA326                                                                                                                          List of figures
 List of figures
 Figure 1.    Block diagram . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 8
 Figure 2.    Channel signal flow diagram through the digital core . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 8
 Figure 3.    Channel signal flow through the EQ block . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9
 Figure 4.    Output power-stage configurations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9
 Figure 5.    Pin connections . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10
 Figure 6.    Test circuit 1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15
 Figure 7.    Test circuit 2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15
 Figure 8.    Power-on sequence . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 16
 Figure 9.
 Figure 10.
              Power-off sequence . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 16
              Channel separation vs. frequency . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17
                                                                                                                                            s   )
 Figure 11.
 Figure 12.
              THD vs. output power - single ended . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17
                                                                                                                                  c    t(
              THD vs. output power - BTL . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18
 Figure 13.
                                                                                                                        d    u
              THD vs. frequency - BTL . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18
 Figure 14.
 Figure 15.                                                                                                     r  o
              I2C write procedure . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20
              I2C read procedure . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20
 Figure 16.                                                                                                P
              General serial input and output formats . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26
                                                                                                   e
 Figure 17.
 Figure 18.
                                                                                          le     t
              Serial input data timing . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28
              Basic limiter and volume flow diagram . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 45
 Figure 19.
 Figure 20.                                                                      s   o
              Biquad filter . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 48
              Mix/bass management block diagram . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 49
 Figure 21.
 Figure 22.                                                          O      b
              Application circuit for 2.0-channel (2 BTL) configuration . . . . . . . . . . . . . . . . . . . . . . . . . . 57
              Application circuit for 2.1-channel (2 single-ended + 1 BTL) configuration. . . . . . . . . . . . . 58
 Figure 23.
                                                          )    -
              Application circuit for mono-channel configuration . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 59
 Figure 24.
                                                      s
              PowerSO-36 EPU package outline. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 61
                                                t  (
                                       u    c
                             o    d
                       P   r
              e t e
        o   l
  b  s
O
                                                         DocID11531 Rev 9                                                                          7/64
                                                                                                                                                        64


 Description                                                                                        STA326
 1           Description
             The STA326 comprises digital audio processing, digital amplifier control and DDX® power
             output stage to create a high-power single-chip DDX® solution for high-quality,
             high-efficiency, all-digital amplification.
             The STA326 power section consists of four independent half-bridges. These can be
             configured via digital control to operate in different modes. 2.1 channels can be provided by
             two half-bridges and a single full-bridge to give up to 2 x 40 W plus 1 x 80 W of power
             output. Two channels can be provided by two full-bridges to give up to 2 x 80 W of power.
             The IC can also be configured as a single parallel full-bridge capable of high-current
             operation and 1 x 160 W output.
                                                                                                    s  )
                                                                                             c  t(
             Also provided in the STA326 is a full assortment of digital processing features. This includes
             up to four programmable 28-bit biquads (EQ) per channel and bass/treble tone control.
                                                                                       d  u
             Automodes enable a time-to-market advantage by substantially reducing the amount of
             software development needed for certain functions. This includes auto volume loudness,
                                                                                  r o
             preset volume curves, preset EQ settings and new advanced AM radio-interference
             reduction modes.
                                                                          e    P
             format.
                                                                     le t
             The serial audio data input interface accepts all possible formats, including the popular I2S
                                                               s  o
             Three channels of DDX® processing are provided. This high-quality conversion from PCM
             range.
                                                         O  b
             audio to patented DDX® 3-state PWM switching provides over 100 dB of SNR and dynamic
                                                 )   -
                                                  Figure 1. Block diagram
                                          t ( s
                                   u   c
                            o  d
                      P   r
            e  t e
        o l
  b   s
O
                          Figure 2. Channel signal flow diagram through the digital core
 8/64                                          DocID11531 Rev 9


 STA326                                                                                         Description
 1.1      EQ processing
          Two channels of input data (re-sampled if necessary) at 96 kHz are provided to the EQ
          processing block. In this block, up to four user-defined biquads can be applied to each of the
          two channels.
          Prescaling, DC-blocking, high-pass, de-emphasis, bass, and tone control filters can also be
          applied based on various configuration parameter settings.
          The entire EQ block can be bypassed for all channels simultaneously by setting the DSPB
          bit to 1. And the CxEQBP bits can be used to bypass the EQ function on a per channel
          basis. Figure 3 shows the internal signal flow through the EQ block.
                             Figure 3. Channel signal flow through the EQ block
                                                                                                      s )
                                                                                               c t(
                                                                                       d   u
                                                                                  r o
                                                                        e     P
                                                                 le   t
                                                           s o
 1.2      Output configurations
                                                   O    b
                                               -
                                 Figure 4. Output power-stage configurations
                                            )
                                     t ( s                       2-channel (full-bridge) configuration,
                              u   c                              register bits OCFG[1:0] = 00
                         o  d
                    P  r
          e t e
      o l
  b s                                                            2.1-channel configuration,
                                                                 register bits OCFG[1:0] = 01
O
                                                                 1-channel mono-parallel configuration,
                                                                 register bits OCFG[1:0] = 11
                                                                 The setup register is Configuration register
                                                                 F (addr 0x05) on page 34
                                           DocID11531 Rev 9                                               9/64
                                                                                                               64


 Pin out                                                                                     STA326
 2         Pin out
 2.1       Package pins
                                           Figure 5. Pin connections
                             VCC_SIGN        36                    1      SUB_GND
                                   VSS       35                    2      N.C.
                                   VDD       34                    3      OUT2B
                                   GND       33                    4      VCC2B
                                  BICKI      32                    5      N.C.
                                                                                              s )
                                                                                           t(
                                 LRCKI       31                    6      GND2B
                                    SDI      30                    7      GND2A
                                 VDDA
                                 GNDA
                                             29
                                             28
                                                                   8
                                                                   9
                                                                          VCC2A
                                                                          OUT2A
                                                                                       u c
                                    XTI      27                   10      OUT1B
                                                                                 o  d
                            PLL_FILTER
                            RESERVED
                                   SDA
                                             26
                                             25
                                             24
                                                                  11
                                                                  12
                                                                  13
                                                                          VCC1B
                                                                           P
                                                                          GND1B
                                                                          GND1A
                                                                               r
                                   SCL       23                   14
                                                                  15
                                                                     t e  N.C.
                                                               le
                                RESET        22                           VCC1A
                               CONFIG        21                   16      OUT1A
                             VDD_REG
                                     VL      20
                                             19
                                                         s o      17
                                                                  18
                                                                          GND_CLEAN
                                                                          GND_REG
                                                 O    b
                                          )   -
 2.2       Pin list
                                  t (  s
                            u  c
                      o d                       Table 2. Pin list
                  Pr
               Number      Type              Name                            Description
            1          I/O            SUB_GND              Substrate ground
           e2t e       N.C.           N.C.                 Not connected
       o l  3          O              OUT2B                Output half bridge 2B
     s
Ob
            4          I/O            VCC2B                Positive supply
            5          N.C.           N.C.                 Not connected
            6          I/O            GND2B                Negative supply
            7          I/O            GND2A                Negative supply
            8          I/O            VCC2A                Positive supply
            9          O              OUT2A                Output half bridge 2A
            10         O              OUT1B                Output half bridge 1B
            11         I/O            VCC1B                Positive supply
            12         I/O            GND1B                Negative supply
            13         I/O.           GND1A                Negative supply
            14         N.C.           N.C.                 Not connected
 10/64                                   DocID11531 Rev 9


 STA326                                                                                   Pin out
                                         Table 2. Pin list
              Number      Type        Name                              Description
           15         I/O       VCC1A               Positive supply
           16         O         OUT1A               Output half bridge 1A
           17         I/O       GND_CLEAN           Logical ground
           18         I/O       GND_REG             Regulated ground
           19         I/O       VDD_REG             Logic supply
           20         I/O       VL                  Logic supply
           21         I         CONFIG              Logic levels
                                                                                          s )
                                                                                       t(
           22         I         RESET               Reset
           23         I         SCL                 I2C serial clock
                                                                                  u  c
           24         I/O       SDA                 I2C serial data
                                                                            o  d
           25
           26
                      RES
                      I
                                RESERVED
                                PLL_FILTER                            P   r
                                                    This pin must be connected to GND
                                                    Connection to PLL filter
           27         I         XTI
                                                               t e
                                                    PLL input clock
           28         I/O       GNDA
                                                     o  le
                                                    Analog ground
           29         I/O       VDDA
                                              b  s  Analog supply, nominally 3.3 V
                                       -O
           30         I         SDI                 I2S serial data channels 1 & 2
                                                    I2S left/right clock,
           31         I/O
                                    )
                                LRCKI
                                  s
           32         I
                               t(
                                BICKI               I2S serial clock
                           uc
           33         I/O       GND                 Digital ground
                     od
           34         I/O       VDD                 Digital supply, nominally 3.3 V
                 Pr
           35         I/O       VSS                 5 V regulator referred to +
           36         I/O       VCC_SIGN            5 V regulator referred to ground
          e t e
      o l
    s
Ob
                                   DocID11531 Rev 9                                         11/64
                                                                                                  64


 Pin out                                                                                            STA326
 2.3       Pin description
           OUT1A, 1B, 2A and 2B (pins 16, 10, 9 and 3)
           Output half bridge PWM outputs 1A, 1B, 2A and 2B provide the input signals to the
           speakers.
           CONFIG (pin 21)
           The configuration input pin is normally connected to ground. Using the mono high power
           BTL configuration requires the CONFIG input pin to be shorted to VDD_REG.
           RESET (pin 22)
           Driving RESET low sets all outputs low and returns all register settings to their default
                                                                                                    s  )
           (reset) values. The reset is asynchronous to the internal clock.
                                                                                              c  t(
           I2C signals (pins 23 and 24)
                                                                                        d  u
                                                                                  r o
           The SDA (I2C Data) and SCL (I2C Clock) pins operate according to the I2C specification
           supported.
                                                                           e  P
           (Chapter 6 on page 19 gives more information). Fast-mode (400 kB/s) I2C communication is
           GNDA and VDDA (pins 28 and 29)                           le   t
                                                             s  o
                                                          b
           This is the 3.3 V analog supply for the phase locked loop. It must be well decoupled and
           filtered for good noise immunity since the audio performance of the device depends upon
                                                     O
           the PLL circuit.
                                               )   -
           CLK (pin 27)
                                        t ( s
                                 u  c
           This is the master clock in used by the digital core. The master clock must be an integer
           multiple of the LR clock frequency. Typically, the master clock frequency is 12.288 MHz
                              d
           (256 * fs) for a 48 kHz sample rate; it is the default setting at power-up. Care must be taken
                           o
                     P   r
           to provide the device with the nominal system clock frequency; over-clocking the device
           may result in anomalous operation, such as inability to communicate.
              t e
           FILTER_PLL (pin 26)
           e
       o l This is the connection for external filter components for the PLL loop compensation. The
  b  s     schematic diagram in Figure 21 on page 57 shows the recommended circuit.
O          BICKI (pin 32)
           The serial or bit clock input is for framing each data bit. The bit clock frequency is typically
           64 * fs using I2S serial format.
           SDI_12 (pin 30)
           This is the serial data input where PCM audio information enters the device. Six format
           choices are available including I2S, left or right justified, LSB or MSB first, with word widths
           of 16, 18, 20 and 24 bits.
           LRCKI (pin 31)
           The left/right clock input is for data word framing. The clock frequency is at the input sample
           rate, fs.
 12/64                                        DocID11531 Rev 9


 STA326                                                                                   Electrical specifications
 3        Electrical specifications
                                              Table 3. Absolute maximum ratings
            Symbol                                  Parameter                                     Value           Unit
           VDD33         3.3 V I/O power supply (pins VDDA, VDD)                       -0.5 to 4                V
           Vi            Voltage on input pins                                         -0.5 to (VDD33 + 0.5)    V
           Vo            Voltage on output pins                                        -0.5 to (VDD33 + 0.5)    V
           Tstg          Storage temperature                                           -40 to +150              C
           Tamb         Ambient operating temperature                                  -20 to +85
                                                                                                               sC
                                                                                                                  )
                         DC supply voltage (pins nA, nB)                               40
                                                                                                        c  t(   V
           VMAX          Maximum voltage on VL (pin 20)                                5.5
                                                                                                  d  u          V
                                                                                           r o
                                                         Table 4. Thermal data
                                                                                  e   P
            Symbol
           Rthj-case
                                                    Parameter
                         Thermal resistance junction to case (thermal pad)
                                                                             le t      -
                                                                                         Min
                                                                                                 -
                                                                                                   Typ    Max
                                                                                                        2.5
                                                                                                                  Unit
                                                                                                                C/W
           Tj-SD         Thermal shut-down junction temperature
                                                                  b  so                -         150    -       C
           TWARN
           Th-SD
                         Thermal warning temperature
                         Thermal shut-down hysteresis
                                                          -  O                         -
                                                                                       -
                                                                                                 130
                                                                                                 25
                                                                                                        -
                                                                                                        -
                                                                                                                C
                                                                                                                C
                                                 s   )
                                          c  t(
                                        Table 5. Recommended operating conditions
            Symbol
                                 d   u              Parameter                                     Value           Unit
           VDD33
                           r o
                          I/O power supply                                             3.0 to 3.6               V
           Tj
               e     P   Operating junction temperature                                -20 to +125              C
         e   t
        l General interface specifications
 3.1
    s o
Ob        Operating conditions VDD33 = 3.3 V ±0.3 V, Tamb = 25° C unless otherwise specified
                                    Table 6. General interface electrical characteristics
            Symbol                   Parameter                     Test Condition        Min.      Typ.   Max.    Unit
                                                                       (1)
           Iil           Low level input no pull-up           Vi = 0 V                 -         -      1       A
           Iih           High level input no pull-down        Vi = VDD33 (1)           -         -      2       A
                         3-state output leakage without
           IOZ                                                Vi = VDD33 (1)           -         -      2       A
                         pull-up/down
                         Electrostatic protection
           Vesd                                               Leakage current < 1 A   2000      -      -       V
                         (human-body model)
          1. The leakage currents are generally very small (< 1 nA). The values given here are the maximum values
               after an electrostatic stress on the pin.
                                                    DocID11531 Rev 9                                              13/64
                                                                                                                        64


 Electrical specifications                                                                            STA326
 3.2          DC electrical specifications (3.3 V buffers)
              Operating conditions VDD33 = 3.3 V ±0.3 V, Tamb = 25° C unless otherwise specified
                                           Table 7. DC electrical specifications
                Symbol             Parameter                  Test condition       Min.   Typ.   Max.   Unit
               VIL      Low level input voltage         -                        -      -      0.8     V
               VIH      High level input voltage        -                        2.0    -      -       V
               Vhyst    Schmitt trigger hysteresis      -                        0.4    -      -       V
               Vol      Low level output                IoI = 2 mA               -      -      0.15    V
                                                                                 VDD33
                                                                                                      s )
               Voh      High level output               Ioh = -2 mA
                                                                                 - 0.15
                                                                                        -      -
                                                                                               c  t(   V
                                                                                         d  u
 3.3          Power electrical specifications
                                                                                     r o
                                                                                 P
              Operating conditions VDD33 = 3.3 V ±0.3 V, VL = 3.3 V, = 30 V, Tamb = 25° C unless
                                                                             e
              otherwise specified.
                                                                      le   t
                                                                   o
                                       Table 8. Power electrical characteristics
                                                                s
                Symbol             Parameter
                        Power Pchannel/Nchannel        O    bTest conditions       Min.   Typ.   Max.   Unit
               RdsON
                        MOSFET RdsON
                                                 )  -   Id = 1A                  -      200    270     m
                Idss
                                            ( s
                        Power Pchannel/Nchannel
                                          t              = 35 V                  -      -      50      A
                        leakage Idss
                                   u  c
                        Power Pchannel RdsON
               gN
                        matching
                            o   d                       Id = 1 A                 95     -      -       %
               gP
                      P   r
                        Power Nchannel RdsON
                        matching
                                                        Id = 1 A                 95     -      -       %
                   e
           let
                                                        See test circuits,
               Dt_s     Low current dead time (static)                           -      10     20      ns
                                                        Figure 6 and Figure 7
     s  o      td ON    Turn-on delay time              Resistive load           -      -      100     ns
O b            td OFF   Turn-off delay time             Resistive load           -      -      100     ns
                                                        Resistive load, Figure 6
               tr       Rise time                                                -      -      25      ns
                                                        and Figure 7
                                                        Resistive load, Figure 6
               tf       Fall time                                                -      -      25      ns
                                                        and Figure 7
                        Supply voltage                  -                        10     -      36      V
               VL       Low logical state voltage VL    VL = 3.3 V               0.8    -      -       V
               VH       High logical state voltage VH   VL = 3.3 V               -      -      1.7     V
                        Supply current from in
               I-PWRDN                                  Pin PWRDN = 0 V          -      -      3       mA
                        PWRDN
                        Supply current from in
               I-hiz                                     = 30 V, 3-state         -      22     -       mA
                        3-state
 14/64                                          DocID11531 Rev 9


 STA326                                                                                                                        Electrical specifications
                                   Table 8. Power electrical characteristics (continued)
           Symbol                     Parameter                                    Test conditions                           Min.       Typ.        Max.        Unit
                                                                           Input pulse width = 50%
                          Supply current from in                           duty,
          I               operation                                        switching                                      -            80         -            mA
                          (both channel switching)                         frequency = 384 kHz,
                                                                           no LC filters
                          Overcurrent protection
          Iout-sh         threshold (short circuit current                 -                                              4.5          6          -            A
                          limit)
          VUV
                          Undervoltage protection
                          threshold
                                                                           -                                              -            7          -
                                                                                                                                                            s
                                                                                                                                                               V
                                                                                                                                                                )
                                                                                                                                                      t(
                                                                                                                                            uc
          tpw-min         Output minimum pulse width                       No load                                        70                      150          ns
                                                                           THD = 10%
          Po
                          Output power (refer to test
                                                                           RL = 4  = 21 V                                -
                                                                                                                                  o    d
                                                                                                                                       50         -
                          circuit
                                                                           RL = 8  = 36 V
                                                                           THD = 1%                                      P
                                                                                                                          -
                                                                                                                                r      80         -
                                                                                                                                                               W
          Po
                          Output power (refer to test
                          circuit                                          RL = 4  = 21 V
                                                                                                      et        e         -            40         -            W
                                                                           RL = 8  = 36 V
                                                                                             o     l                      -            62         -
                                                                                   b    s
                                                                 Figure 6. Test circuit 1
                                                                    -     O                     OUTxY
                                                        s    )
                                            c    t(
                                        Low current dead time = MAX(DTr, DTf)
                                                                                                                                     (3/4)
                                  d    u                                                                                             (1/2)
                                                                                                                                     (1/4)
                             r o                                         +
              e      P            Duty cycle = 50%                                                     DTr             DTf
                                                                                                                                   t
        le  t                                                  M58
                                                                               OUTxY                      R8W
    s o                                   INxY
                                                               M57
O b                                                                  gnd
                                                                                                                       +
                                                                                                                       -
                                                                                                                              V67
                                                                                                                          vdc = /2
                                                                 Figure 7. Test circuit 2
                                      High Current Dead time for Bridge application = ABS(DTout(A)-DTin(A))+ABS(DTOUT(B)-DTin(B))
                                                                                    +VCC
                  Duty cycle=A                                                                                                                    Duty cycle=B
                                                        DTout(A)
                                     M58         Q1                                                                           Q2        M64
                 DTin(A)                                                                                     DTout(B)                                 DTin(B)
                                                    OUTA                          Rload=4                                OUTB
                           INA                                                                                                                       INB
                                                                L67 10                               L68 10
                                                      Iout=1.5A                                                Iout=1.5A
                                     M57         Q3                  C69                             C70                      Q4        M63
                                                                    470nF        C71 470nF         470nF
                                       Duty cycle A and B: Fixed to have DC output current of 4A in the direction shown in figure           D06AU1651
                                                           DocID11531 Rev 9                                                                                     15/64
                                                                                                                                                                      64


 Power supply and control sequencing                                                    STA326
 4         Power supply and control sequencing
           The recommended power-on/off sequences are shown in Figure 8 and Figure 9.
                                         Figure 8. Power-on sequence
                                                                                         s )
                                                                                    c t(
                                                                              d u
                                                                          r o
                                                                      e P
                                                                le  t
                                                        s   o
 Note:                                             O  b
           1. TR = minimum time between XTI master clock stable and Reset removal: 1 msec
                                            )   -
           2. TC = minimum time between Reset removal and I2C program, sequence start: 1msec
                                       ( s
           3. A stable clock means: fmax - fmin < 1 MHz
                                     t
                                   c
           4. No specific VCC and VDD_Dig turn−on sequence is required
                                u
                          o d            Figure 9. Power-off sequence
                   P    r
           e t e
       o l
  b  s
O
           5. No specific VCC and VDD_Dig turn−off sequence is required
           6. This sequence ensures a pop-free turn-off
 16/64                                    DocID11531 Rev 9


 STA326                                                           Characterization curves
 5        Characterization curves
                         Figure 10. Channel separation vs. frequency
                                                                                  s  )
                                                                            c  t(
                                                                       d u
                                                                  r o
                                                           e   P
                                                     le  t
                                                s  o
                                         O   b
                                   )  -
                              ( s
                        Figure 11. THD vs. output power - single ended
                            t
                        u c
                    o d
                P r
          e t e
      o l
  b s
O
                                  DocID11531 Rev 9                                   17/64
                                                                                           64


 Characterization curves                                                         STA326
                                Figure 12. THD vs. output power - BTL
                                                                                  s )
                                                                             c t(
                                                                         d u
                                                                     r o
                                                              e   P
                                                         le t
                                                    s  o
                                             O   b
                                  Figure 13. THD vs. frequency - BTL
                                       )  -
                                 t ( s
                             u c
                         o d
                    P  r
            e t e
       o  l
  b  s
O
 18/64                                DocID11531 Rev 9


 STA326                                                                             I2C bus specification
 6        I2C bus specification
          The STA326 supports the I2C protocol. This protocol defines any device that sends data on
          to the I2C bus as a transmitter and any device that reads the data as a receiver. The device
          that controls the data transfer is known as the master and the other as the slave. The
          master always starts the transfer and provides the serial clock for synchronization. The
          STA326 is always a slave device in all of its communications.
 6.1      Communication protocol
          Data transition or change
                                                                                                   s )
                                                                                              c
          Data changes on the SDA line must only occur when the SCL clock is low. SDA transitiont(
          while the clock is high is used to identify a START or STOP condition.
                                                                                      d   u
          Start condition
                                                                                r o
                                                                            P
          START is identified by a high to low transition of the data bus SDA signal while the clock
                                                                        e
          data transfer.
                                                                 le   t
          signal SCL is stable in the high state. A START condition must precede any command for
          Stop condition
                                                          s   o
                                                   O    b
          STOP is identified by a low to high transition of the data bus SDA signal while the clock
          STA326 and the bus master.
                                             )  -
          signal SCL is stable in the high state. A STOP condition terminates communication between
          Data input                  t ( s
                                u c
                         o  d
          During the data input the STA326 samples the SDA signal on the rising edge of clock SCL.
          For correct device operation the SDA signal must be stable during the rising edge of the
                       r
          clock and the data can change only when the SCL line is low.
                   P
          e   e
            t addressing
 6.2
      o l Device
  bs
          To start communication between the master and the STA326, the master must initiate with a
          start condition. Following this, the master sends 8 bits (MSB first) onto the SDA line
O         corresponding to the device select address and read or write mode.
          The 7 MSBs are the device address identifiers, corresponding to the I2C bus definition. The
          STA326 device address is 0x34.
          The 8th bit (LSB) identifies read or write operation, RW. This bit is set to 1 in read mode and
          0 for write mode. After a START condition the STA326 identifies the device address on the
          bus. If a match is found, it acknowledges the identification on the SDA bus during the 9th bit
          time. The byte following the device identification byte is the internal space address.
                                            DocID11531 Rev 9                                         19/64
                                                                                                           64


 I2C bus specification                                                                         STA326
 6.3        Write operation
            Following the START condition the master sends a device select code with the RW bit set
            to 0. The STA326 acknowledges this and then the master writes the internal address byte.
            After receiving the internal byte address the STA326 again responds with an
            acknowledgement.
                                            Figure 14. I2C write procedure
                                                                                               s  )
                                                                                         c  t(
                                                                                  d  u
            Byte write                                                        r o
                                                                       e   P
            In the byte write mode the master sends one data byte. This is acknowledged by the
                                                                  le t
            STA326. The master then terminates the transfer by generating a STOP condition.
            Multi-byte write
                                                            s  o
                                                    O    b
            The multi-byte write modes can start from any internal address. Sequential data byte writes
            will be written to sequential addresses within the STA326.
                                              )  -
            The master generating a STOP condition terminates the transfer.
                                       t ( s
 6.4        Read operation       u  c
                           o   d
                     P   r                  Figure 15. I2C read procedure
              t e
     s ole
O  b
            Current address byte read
            Following the START condition the master sends a device select code with the RW bit set to
            1. The STA326 acknowledges this and then responds by sending one byte of data. The
            master then terminates the transfer by generating a STOP condition.
 20/64                                       DocID11531 Rev 9


 STA326                                                                       I2C bus specification
          Current address multi-byte read
          The multi-byte read modes can start from any internal address. Sequential data bytes will be
          read from sequential addresses within the STA326. The master acknowledges each data
          byte read and then generates a STOP condition terminating the transfer.
          Random address byte read
          Following the START condition the master sends a device select code with the RW bit set
          to 0. The STA326 acknowledges this and then the master writes the internal address byte.
          After receiving, the internal byte address the STA326 again responds with an
          acknowledgement. The master then initiates another START condition and sends the device
          select code with the RW bit set to 1. The STA326 acknowledges this and then responds by
          sending one byte of data. The master then terminates the transfer by generating a STOP
                                                                                             s  )
          condition.
                                                                                       c  t(
          Random address multi-byte read
                                                                                d   u
                                                                            r o
          The multi-byte read modes could start from any internal address. Sequential data bytes will
          be read from sequential addresses within the STA326. The master acknowledges each data
                                                                         P
          byte read and then generates a STOP condition terminating the transfer.
                                                                    e
                                                              le  t
                                                          s o
                                                  O    b
                                            )  -
                                     t ( s
                                u  c
                         o  d
                   P   r
          e t e
      o l
  b s
O
                                           DocID11531 Rev 9                                     21/64
                                                                                                       64


 Register description                                                                           STA326
 7          Register description
            You must not reprogram the register bits marked “Reserved”. It is important that these bits
            keep their default reset values.
                                      Table 9. Register summary
  Address   Name        D7         D6         D5       D4        D3        D2         D1          D0
 0x00     CONFA      FDRB       TWAB       TWRB     IR1      IR0       MCS2       MCS1         MCS0
 0x01     CONFB      C2IM       C1IM       DSCKE    SAIFB    SAI3      SAI2       SAI1         SAI0
 0x02     CONFC      Reserved CSZ4         CSZ3     CSZ2     CSZ1      CSZ0       OM1          OM0
                                                                                                s  )
 0x03     CONFD      MME        ZDE        DRC      BQL      PSL       DSPB       DEMP
                                                                                          c  t(HPB
 0x04     CONFE      SVE        ZCE        Reserved PWMS     AME       Reserved MPC
                                                                                   d  u        MPCV
                                                                               ro
 0x05     CONFF      EAPD       PWDN       ECLE     Reserved BCLE      IDE        OCFG1        OCFG0
                                                                      eP
 0x06     MMUTE      Reserved Reserved Reserved Reserved Reserved Reserved Reserved            MMUTE
 0x07     MVOL       MV7        MV6        MV5      MV4      MV3       MV2        MV1          MV0
 0x08     C1VOL      C1V7       C1V6       C1V5     C1V4
                                                               l
                                                             C1V3
                                                                 e  t  C1V2       C1V1         C1V0
                                                             o
                                                        bs
 0x09     C2VOL      C2V7       C2V6       C2V5     C2V4     C2V3      C2V2       C2V1         C2V0
 0x0A     C3VOL      C3V7       C3V6       C3V5     C3V4     C3V3      C3V2       C3V1         C3V0
 0x0B     AUTO1      AMPS       Reserved AMGC1
                                                -  OAMGC0    AMV1      AMV0       AMEQ1        AMEQ0
 0x0C     AUTO2      XO3        XO2
                                         ( s )
                                           XO1      XO1      AMAM2     AMAM1      AMAM0        AMAME
 0x0D     AUTO3
                                    c  t
                     Reserved Reserved Reserved PEQ4         PEQ3      PEQ2       PEQ1         PEQ0
                             du
 0x0E     C1CFG      C1OM1      C1OM0      C1LS1    C1LS0    C1BO      C1VBP      C1EQBP       C1TCB
                        ro
 0x1F     C2CFG      C2OM1      C2OM0      C2LS1    C2LS0    C2BO      C2VBP      C2EQBP       C2TCB
                eP
 0x10     C3CFG      C3OM1      C3OM0      C3LS1    C3LS0    C3BO      C3VBP      Reserved     Reserved
          let
 0x11     TONE       TTC3       TTC2       TTC1     TTC0     BTC3      BTC2       BTC1         BTC0
 0x12     L1AR       L1A3       L1A2       L1A1     L1A0     L1R3      L1R2       L1R1         L1R0
 0x13
     s  o L1ATRT     L1AT3      L1AT2      L1AT1    L1AT0    L1RT3     L1RT2      L1RT1        L1RT0
O b
 0x14
 0x15
          L2AR
          L2ATRT
                     L2A3
                     L2AT3
                                L2A2
                                L2AT2
                                           L2A1
                                           L2AT1
                                                    L2A0
                                                    L2AT0
                                                             L2R3
                                                             L2RT3
                                                                       L2R2
                                                                       L2RT2
                                                                                  L2R1
                                                                                  L2RT1
                                                                                               L2R0
                                                                                               L2RT0
 0x16     CFADDR2 CFA7          CFA6       CFA5     CFA4     CFA3      CFA2       CFA1         CFA0
 0x17     B1CF1      C1B23      C1B22      C1B21    C1B20    C1B19     C1B18      C1B17        C1B16
 0x18     B1CF2      C1B15      C1B14      C1B13    C1B12    C1B11     C1B10      C1B9         C1B8
 0x19     B1CF3      C1B7       C1B6       C1B5     C1B4     C1B3      C1B2       C1B1         C1B0
 0x1A     B2CF1      C2B23      C2B22      C2B21    C2B20    C2B19     C2B18      C2B17        C2B16
 0x1B     B2CF2      C2B15      C2B14      C2B13    C2B12    C2B11     C2B10      C2B9         C2B8
 0x1C     B2CF3      C2B7       C2B6       C2B5     C2B4     C2B3      C2B2       C2B1         C2B0
 0x1D     A1CF1      C3B23      C3B22      C3B21    C3B20    C3B19     C3B18      C3B17        C3B16
 22/64                                      DocID11531 Rev 9


 STA326                                                                                   Register description
                                Table 9. Register summary (continued)
 Address   Name          D7        D6          D5         D4           D3           D2         D1         D0
 0x1E    A1CF2        C3B15     C3B14       C3B13      C3B12      C3B11        C3B10       C3B9        C3B8
 0x1F    A1CF3        C3B7      C3B6        C3B5       C3B4       C3B3         C3B2        C3B1        C3B0
 0x20    A2CF1        C4B23     C4B22       C4B21      C4B20      C4B19        C4B18       C4B17       C4B16
 0x21    A2CF2        C4B15     C4B14       C4B13      C4B12      C4B11        C4B10       C4B9        C4B8
 0x22    A2CF3        C4B7      C4B6        C4B5       C4B4       C4B3         C4B2        C4B1        C4B0
 0x23    B0CF1        C5B23     C5B22       C5B21      C5B20      C5B19        C5B18       C5B17       C5B16
 0x24    B0CF2        C5B15     C5B14       C5B13      C5B12      C5B11        C5B10       C5B9        C5B8
                                                                                                         s  )
                                                                                                     t(
 0x25    B0CF3        C5B7      C5B6        C5B5       C5B4       C5B3         C5B2        C5B1        C5B0
                                                                                               uc
 0x26    CFUD         Reserved Reserved Reserved Reserved RA                   R1          WA          W1
                                                                                        od
 0x27    MPCC1        MPCC15 MPCC14 MPCC13 MPCC12 MPCC11                       MPCC10 MPCC9            MPCC8
                                                                                 Pr
 0x28    MPCC2        MPCC7     MPCC6       MPCC5      MPCC4      MPCC3        MPCC2       MPCC1       MPCC0
 0x29    Reserved     1         1           1          1          0            0           1           1
 0x2A    Reserved     0         0           1          1          0
                                                                          t e  0           1           1
                                                                     le
                                                              so
 0x2B    FDRC1        FDRC15    FDRC14      FDRC13     FDRC12     FDRC11       FDRC10      FDRC9       FDRC8
                                                      Ob
 0x2C    FDRC2        FDRC7     FDRC6       FDRC5      FDRC4      FDRC3        FDRC2       FDRC1       FDRC0
 0x2D    Status       PLLUL     Reserved Reserved Reserved Reserved Reserved FAULT                     TWARN
                                               )  -
 7.1        Configuration register
                                      t (  s A (addr 0x00)
                  D7         D6
                                 u  c    D5           D4           D3            D2           D1          D0
                FDRB
                          o   d
                            TWAB       TWRB           IR1          IR0         MCS2          MCS1        MCS0
                   0
                     P  r     1           1            0            0             0            1           1
              t e                            Table 10. Master clock select
       ole
               Bit    R/W    RST     Name                                 Description
  bs
                                                Master clock select: Selects the ratio between the input
             0       RW     1      MCS0
                                                I2S sample frequency and the input clock.
O            1
             2
                     RW
                     RW
                            1
                            0
                                   MCS1
                                   MCS2
                                                -
                                                -
           The STA326 will support sample rates of 32 kHz, 44.1 kHz, 48 kHz, 88.2 kHz, 96 kHz,
            176.4 kHz and 192 kHz. Therefore the internal clock will be:
                 32.768 MHz for 32 kHz
                 45.1584 MHz for 44.1 kHz, 88.2 kHz, and 176.4 kHz
                 49.152 MHz for 48 kHz, 96 kHz, and 192 kHz
           The external clock frequency provided to the XTI pin must be a multiple of the input sample
            frequency (fs). The correlation between the input clock and the input sample rate is
            determined by the status of the MCSx bits and the IR (input rate) register bits. The MCSx
                                              DocID11531 Rev 9                                               23/64
                                                                                                                   64


 Register description                                                                                        STA326
            bits determine the PLL factor generating the internal clock and the IR bit determines the
            oversampling ratio used internally.
                        Table 11. IR and MCS settings for input sample rate and clock rate
                 Input sample rate                                           MCS[2:0]
                                          IR
                      fs (kHz)                     000         001        010          011         100         101
             32, 44.1, 48               00      768 fs      512 fs     384 fs      256 fs       128 fs     576 fs
             88.2, 96                   01      384 fs      256 fs     192 fs      128 fs       64 fs      -
             176.4, 192                 1X      384 fs      256 fs     192 fs      128 fs       64 fs      -
                                                                                                             s   )
                                          Table 12. Interpolation ratio select
                                                                                                      c  t(
                Bit    R/W     RST      Name                                 Description
                                                                                              d   u
             4:3      RW      00     IR[1:0]
                                                  based on input I2S sample frequency
                                                                                        r o
                                                  Interpolation ratio select: selects internal interpolation ratio
                                                                              e    P
                                                                       le   t
            The STA326 has variable interpolation (re-sampling) settings such that internal processing
            and DDX® output rates remain consistent. The first processing block interpolates by either 2
                                                                   o
            times or 1 time (pass-through) or provides a downsample by a factor of 2.
                                                                s
                                                            b
            The IR bits determine the re-sampling ratio of this interpolation.
                                                       O
                                                   -
                             Table 13. IR bit settings as a function of input sample rate
                                               )
                                        t(s
              Input sample rate fs (kHz)      IR[1,0]                   1st stage interpolation ratio
                                 uc
             32                            00             2 times oversampling
                           od
             44.1                          00             2 times oversampling
                      Pr
             48                            00             2 times oversampling
             88.2                          01             Pass-through
             96
               t e                         01             Pass-through
          le
     so
             176.4                         10             Downsampling by 2
Ob
             192                           10             Downsampling by 2
                                    Table 14. Thermal warning recovery bypass
               Bit   R/W    RST       Name                                   Description
                                                  Thermal warning recovery bypass:
             5       RW    1     TWRB             0: thermal warning recovery enabled
                                                  1: thermal warning recovery disabled
            If the thermal warning adjustment is enabled (TWAB = 0), then the thermal warning
            recovery will determine if the adjustment is removed when thermal warning is negative. If
            TWRB = 0 and TWAB = 0, then when a thermal warning disappears the gain adjustment
            determined by the thermal warning postscale (default = -3 dB) will be removed and the gain
            will be added back to the system. If TWRB = 1 and TWAB = 0, then when a thermal warning
 24/64                                        DocID11531 Rev 9


 STA326                                                                              Register description
         disappears the thermal warning postscale gain adjustment will remain until TWRB is
         changed to zero or the device is reset.
                                Table 15. Thermal warning adjustment bypass
            Bit    R/W     RST       Name                                Description
                                                Thermal warning adjustment bypass:
          6       RW      1       TWAB          0: thermal warning adjustment enabled
                                                1: thermal warning adjustment disabled
         The on-chip STA326 power output block provides feedback to the digital controller using
         inputs to the power control block. The TWARN input is used to indicate a thermal warning
         condition. When TWARN is asserted (set to 0) for a period greater than 400 ms, the power
                                                                                                   s  )
                                                                                             c t(
         control block will force an adjustment to the modulation limit in an attempt to eliminate the
         thermal warning condition. Once the thermal warning volume adjustment is applied, whether
         the gain is reapplied when TWARN is de-asserted is dependent on the TWRB bit.
                                                                                      d  u
                                    Table 16. Fault detect recovery bypass        r o
            Bit    R/W     RST       Name
                                                                        e     P
                                                                         Description
                                                                  l e t
                                                Fault detector recovery bypass:
          7       RW      0       FDRB
                                                              o
                                                0: fault detector recovery enabled
                                                           s
                                                       b
                                                1: fault detector recovery disabled
                                                  O
                                              -
         The DDX® power block can provide feedback to the digital controller using inputs to the
                                           )
                                    t(  s
         power control block. The FAULT input is used to indicate a fault condition (either over-
         current or thermal). When FAULT is asserted (set to 0), the power control block will attempt
                               u  c
         a recovery from the fault by asserting the 3-state output (setting it to 0 which directs the
         power output block to begin recovery). It holds it at 0 for period of time in the range of 0.1 ms
                        o  d
         to 1 s as defined by the fault-detect recovery constant register (FDRC registers
                  P   r
         0x29 to 0x2A), then toggle it back to 1. This sequence is repeated as log as the fault
         indication exists. This feature is enabled by default but can be bypassed by setting the
           t e
         FDRB control bit to 1.
      o le
  b s
O
                                          DocID11531 Rev 9                                            25/64
                                                                                                            64


 Register description                                                                                       STA326
 7.2        Configuration register B (addr 0x01)
                  D7         D6            D5              D4            D3           D2           D1          D0
                 C2IM       C1IM         DSCKE            SAIFB         SAI3         SAI2         SAI1       SAI0
                   1          0             0               0             0            0            0           0
            This register configures the serial data interface
                                    Table 17. Serial audio input interface format
               Bit    R/W   RST     Name                                    Description
                                               Serial audio input interface format: determines the interface
             3:0     RW    0000   SAI[3:0]
                                               format of the input serial digital audio interface (see below).
                                                                                                            s   )
             4       RW    0      SAIFB
                                               Data format:
                                               0: MSB first1: LSB first
                                                                                                      c t(
                                                                                               d  u
                                                                                           o
            The STA326 serial audio input was designed to interface with standard digital audio
                                                                                         r
                                                                                    P
            components and to accept a number of serial data formats. The STA326 always acts as a
            slave when receiving audio input from standard digital audio components. Serial data for
                                                                               e
            BICKI (pin 32), and serial data SDI (pin 30).
                                                                       le   t
            two channels is provided using 3 input pins: left/right clock LRCKI (pin 31), serial clock
                                                                s  o
            SAI[3:0] and SAIFB are used to specify the serial data format. The default format is I2S,
                                                            b
            MSB-first. Available formats are shown below in Figure 16 and the tables that follow.
                                                       O
                                                   -
                                 Figure 16. General serial input and output formats
                                               )
                                        t ( s
                                  u  c
                           o  d
                      P  r
            e t e
       o  l
  b  s
O
            Table 18 lists the serial audio input formats supported by STA326 when
            BICKI = 32 * fs, 48 * fs and 64 * fs, where the sampling rate fs = 32, 44.1, 48, 88.2, 96,
            176.4 or 192 kHz.
 26/64                                        DocID11531 Rev 9


 STA326                                                                              Register description
                              Table 18. Supported serial audio input formats
             BICKI       SAI [3:0]         SAIFB                         Interface format
           32 * fs   1100               X           I2S 15-bit data
                     1110               X           Left/right justified 16-bit data
           48 * fs   0100               X           I2S 23-bit data
                     0100               X           I2S 20-bit data
                     1000               X           I2S 18-bit data
                     0100               0           MSB first I2S 16-bit data
                                                    LSB first I2S 16-bit data
                     1100               1
                                                                                                 s  )
                     0001
                     0101
                                        X
                                        X
                                                    Left-justified 24-bit data
                                                    Left-justified 20-bit data
                                                                                            c t(
                     1001               X           Left-justified 18-bit data
                                                                                      d u
                     1101               X           Left-justified 16-bit data
                                                                                 r o
                     0010               X                                   P
                                                    Right-justified 24-bit data
                                                                       e
                     0110               X
                                                               le    t
                                                    Right-justified 20-bit data
                     1010               X
                                                           o
                                                    Right-justified 18-bit data
                                                       s
                     1110               X
                                                   bRight-justified 16-bit data
                                            -O
           64 * fs   0000               X           I2S 24-bit data
                     0100
                                     ( s
                                        X
                                          )         I2S 20-bit data
                                                    I2S 18-bit data
                     1000
                     0000       c  t    X
                                        0           MSB first I2S 16-bit data
                            u
                      od
                     1100               1           LSB first I2S 16-bit data
                   Pr
                     0001               X           Left-justified 24-bit data
                     0101               X           Left-justified 20-bit data
          e t e      1001               X           Left-justified 18-bit data
      o l            1101               X           Left-justified 16-bit data
    s
Ob
                     0010               X           Right-justified 24-bit data
                     0110               X           Right-justified 20-bit data
                     1010               X           Right-justified 18-bit data
                     1110               X           Right-justified 16-bit data
          For example, SAI = 1110 and SAIFB = 1 would specify right-justified 16-bit data, LSB-first.
                                        DocID11531 Rev 9                                            27/64
                                                                                                          64


 Register description                                                                                     STA326
                       Table 19. Serial input data timing characteristics (fs = 32 to 192 kHz)
                                Parameter in Figure 17                                       Value
             BICKI frequency (slave mode)                                    12.5 MHz max.
             BICKI pulse width low (T0) (slave mode)                         40 ns min.
             BICKI pulse width high (T1) (slave mode)                        40 ns min.
             BICKI active to LRCKI edge delay (T2)                           20 ns min.
             BICKI active to LRCKI edge delay (T3)                           20 ns min.
             SDI valid to BICKI active setup (T4)                            20 ns min.
             BICKI active to SDI hold time (T5)                              20 ns min.
                                                                                                           s  )
                                           Figure 17. Serial input data timing
                                                                                                  c   t(
                                                                                           d   u
                                                                                      r o
                                                                             e    P
                                                                      le   t
                                                              s   o
                                                      O    b
                                                   -
                                           Table 20. Delay serial clock enable
                                                )
                                         t(s
               Bit     R/W     RST          Name                               Description
                                  uc
                                                        Delay serial clock enable:
                                                        0: no serial clock delay
                            od
             5       RW       0       DSCKE
                                                        1: serial clock delay by 1 core clock cycle to tolerate
                     P    r                             anomalies in some I2S master devices
                e
          let
                                            Table 21. Channel input mapping
     so
               Bit     R/W     RST          Name                               Description
Ob
                                                        0: processing channel 1 receives left I2S input
             6       RW       0       C1IM
                                                        1: processing channel 1 receives right I2S input
                                                        0: processing channel 2 receives left I2S input
             7       RW       1       C2IM
                                                        1: processing channel 2 receives right I2S input
            Each channel received via I2S can be mapped to any internal processing channel via the
            channel input mapping registers. This allows for flexibility in processing. The default settings
            of these registers map each I2S input channel to its corresponding processing channel.
 28/64                                         DocID11531 Rev 9


 STA326                                                                              Register description
 7.3       Configuration register C (addr 0x02)
                  D7         D6         D5           D4           D3           D2         D1       D0
              Reserved      CSZ4       CSZ3         CSZ2         CSZ1         CSZ0       OM1      OM0
                   1          1          0            0            0            0          1        0
 7.3.1     DDX® power output mode
                                      Table 22. DDX® power output mode
              Bit     R/W   RST       Name                                Description
                                                   DDX® power output mode:
                                                                                                  s )
                                                                                               t(
            1:0      RW    10      OM[1:0]
                                                   Selects configuration of DDX® output
                                                                                         u   c
                                                                                      d
           The DDX® power output mode selects how the DDX® output timing is configured. Different
                                                                                    o
                                                                              P
           OM = 11 the CSZ bits determine the size of the DDX® compensating pulse.r
           power devices can use different output modes. The recommended use is OM = 10. When
                                          Table 23. DDX® output modes
                                                                       t e
                                                                  le
                                                           so
                          OM[1,0]                                    Output stage - mode
            00
            01
                                               Not used
                                                   O
                                               Not used
                                                        b
            10
                                            )  -
                                               Recommended
                                      ( s
                                   ct
            11                                 Variable compensation
 7.3.2                      d   u
           DDX® variable compensating pulse size
                        r o
               e     P
           The DDX® variable compensating pulse size is intended to adapt to different power stage
           ICs. Contact ST for support when deciding this function.
         l e t                       Table 24. DDX® compensating pulse
       o
  bs
                          CSZ[4:0]                               Compensating pulse size
O           00000
            00001
                                               0 clock period compensating pulse size
                                               1 clock period compensating pulse size
            …                                  …
            10000                              16 clock period compensating pulse size
            …                                  …
            11111                              31 clock period compensating pulse size
                                           DocID11531 Rev 9                                          29/64
                                                                                                           64


 Register description                                                                                     STA326
 7.4        Configuration register D (addr 0x03)
                  D7         D6            D5          D4          D3           D2              D1          D0
                MME         ZDE           DRC         BQL          PSL         DSPB            DEMP        HPB
                   0          1             0           0           0            0               0           0
                                              Table 25. High-pass filter bypass
               Bit    R/W      RST         Name                                Description
                                                        High-pass filter bypass bit.
             0       RW      0         HPB              0: AC coupling high pass filter enabled
                                                        1: AC coupling high pass filter disabled
                                                                                                          s   )
                                                                                                    c t(
            The STA326 features an internal digital high-pass filter for the purpose of DC Blocking. The
            signals can cause speaker damage.
                                                                                              d   u
            purpose of this filter is to prevent DC signals from passing through a DDX® amplifier. DC
                                                                                        r o
                                                   Table 26. De-emphasis
                                                                              e      P
               Bit    R/W     RST           Name
                                                         De-emphasis:   le  t   Description
             1       RW      0        DEMP
                                                                 s  o
                                                         0: no de-emphasis
                                                        O     b
                                                         1: de-emphasis
                                                 )  -
            By setting this bit to 1, the de-emphasis will be implemented on all channels. DSPB, bit D2
                                           (   s
            of CONFD (configuration register D), must be set to 0 for de-emphasis to function.
                                         t
                                      c
                              du
                                                   Table 27. DSP bypass
               Bit    R/W
                        r o   RST           Name                                Description
             2
                e    P
                     RW      0        DSPB
                                                          DSP bypass bit:
                                                          0: normal Operation
          le  t                                           1: bypass of EQ and mixing functionality
     s o    Setting the DSPB bit bypasses all the EQ and mixing functionality of the STA326 core.
O b                                               Table 28. Postscale link
               Bit    R/W      RST            Name                               Description
                                                           Postscale link:
             3       RW      0         PSL                 0: each channel uses individual postscale value
                                                           1: each channel uses channel 1 postscale value
            Postscale functionality is an attenuation placed after the volume control and directly before
            the conversion to PWM. Postscale can also be used to limit the maximum modulation index
            and therefore the peak current. A setting of 1 in the PSL register will result in the use of the
            value stored in channel 1 postscale for all three internal channels.
 30/64                                          DocID11531 Rev 9


 STA326                                                                                  Register description
                                          Table 29. Biquad coefficient link
             Bit     R/W     RST          Name                                Description
                                                      Biquad link:
           4        RW      0       BQL               0: each channel uses coefficient values
                                                      1: each channel uses channel 1 coefficient values
          For ease of use, all channels can use the biquad coefficients loaded into the channel 1
          coefficient RAM space by setting the BQL bit to 1. Therefore, any EQ updates only have to
          be performed once.
                             Table 30. Dynamic range compression/anti-clipping bit
                                                                                                     s  )
             Bit     R/W     RST          Name                                 Description
                                                                                                c t(
           5        RW      0       DRC
                                                                                          d
                                                      0: limiters act in anti-clipping mode u
                                                      Dynamic range compression/anti-clipping
                                                                                      r o
                                                      1: limiters act in dynamic range compression mode
                                                                            e     P
                                                                    le    t
          Both limiters can be used in one of two ways, anti-clipping or dynamic range compression.
          When used in anti-clipping mode the limiter threshold values are constant and dependent
                                                             s  o
          on the limiter settings. In dynamic range compression mode the limiter threshold values vary
          with the volume settings allowing a nighttime listening mode that provides a reduction in the
          dynamic range regardless of the volume level.
                                                    O    b
                                                -
                                         Table 31. Zero detect mute enable
                                             )
             Bit     R/W     RST
                                       t ( s
                                         Name                                 Description
           6        RW      1
                                 u  c
                                    ZDE
                                                     Zero detect mute enable: setting of 1 enables the
                         o   d                       automatic zero-detect mute
                    P  r
          Setting the ZDE bit enables the zero-detect automatic mute. When ZDE = 1, the zero detect
            t e
          circuit looks at the input data to each processing channel after the channel-mapping block. If
          any channel receives 2048 consecutive zero value samples (regardless of fs) then that
          e
      o l individual channel is muted if this function is enabled.
  b s                                       Table 32. Miami mode enable
O            Bit     R/W     RST         Name
                                                     Miami mode enable:
                                                                              Description
           7        RW      0       MME              0: sub mix into left/right disabled
                                                     1: sub mix into left/right enabled
                                            DocID11531 Rev 9                                            31/64
                                                                                                              64


 Register description                                                                            STA326
 7.5        Configuration register E (addr 0x04)
                 D7         D6        D5          D4             D3         D2          D1        D0
                SVE        ZCE     Reserved      PWMS           AME       Reserved     MPC       MPCV
                  1         1          0           0              0          0           1         0
                                     Table 33. Max power correction variable
               Bit    R/W     RST        Name                              Description
                                                     Max power correction variable:
             0       RW      0     MPCV              0: use standard MPC coefficient
                                                     1: use MPCC bits for MPC coefficient
                                                                                                  s  )
            By enabling MPC and setting MPCV = 1, the max power correction becomes variable. By
                                                                                             c t(
            adjusting the MPCC registers (address 0x27, 0x28) it becomes possible to adjust the THD
            at maximum unclipped power to a lower value for a particular application.
                                                                                       d   u
                                          Table 34. Max power correction           r o
               Bit    R/W     RST        Name
                                                                          e   P
                                                                           Description
                                                                    l e t
                                                     Max power correction:
             1       RW      1     MPC
                                                               o
                                                     0: MPC disabled
                                                            s
                                                   O     b
                                                     1: MPC enabled
                                             )  -
            Setting the MPC bit corrects the DDX® power device at high power. This mode lowers the
            THD+N of a full DDX® system at maximum power output and slightly below.
                                      t(  s
                                uc
                                             Table 35. AM mode enable
                          od
               Bit    R/W     RST        Name                              Description
                    Pr
                                                     AM mode enable:
             3       RW      0     AME               0: normal DDX® operation.
              t e                                    1: AM reduction mode DDX® operation.
          le
     so     The STA326 features a DDX® processing mode that minimizes the amount of noise
Ob
            generated in the frequency range of AM radio. This mode is intended for use when DDX® is
            operating in a device with an active AM tuner. The SNR of the DDX® processing is reduced
            to approximately 83 dB in this mode, which is still greater than the SNR of AM radio.
                                            Table 36. PWM speed mode
               Bit    R/W     RST        Name                              Description
                                                     PWM output speed selection:
             4       RW      0     PWMS              0: normal speed (384 kHz) all channels
                                                     1: odd speed (341.3 kHz) all channels
 32/64                                      DocID11531 Rev 9


 STA326                                                                             Register description
                                     Table 37. Zero-crossing volume enable
             Bit   R/W       RST        Name                            Description
                                                   Zero-crossing volume enable:
                                                   1: volume adjustments will only occur at digital zero-
           6      RW       1       ZCE
                                                   crossings
                                                   0: volume adjustments will occur immediately
          The ZCE bit enables zero-crossing volume adjustments. When volume is adjusted on digital
          zero-crossings no clicks will be audible.
                                       Table 38. Soft volume update enable
                                                                                                     s  )
             Bit   R/W       RST        Name                            Description
                                                                                             c   t(
           7      RW       1       SVE
                                                   Soft volume enable:
                                                                                      d   u
                                                   1: volume adjustments will use soft volume
                                                                                r o
                                                   0: volume adjustments will occur immediately
                                                                       e   P
                                                                le   t
          The STA326 includes a soft volume algorithm that will step through the intermediate volume
          values at a predetermined rate when a volume change occurs. By setting SVE = 0 this can
                                                          s  o
          be bypassed and volume changes will jump from old to new value directly. This feature is
          only available if individual channel volume bypass bit is set to 0.
                                                   O   b
                                            )  -
                                      t ( s
                                u  c
                        o    d
                  P   r
          e t e
      o l
  b s
O
                                           DocID11531 Rev 9                                              33/64
                                                                                                               64


 Register description                                                                                   STA326
 7.6        Configuration register F (addr 0x05)
                  D7          D6             D5         D4           D3          D2         D1           D0
                 EAPD       PWDN            ECLE     Reserved       BCLE        IDE        OCFG1       OCFG0
                   0           1              0          1            1           1          0            0
                                       Table 39. Output configuration selection
               Bit     R/W    RST           Name                                  Description
                                                         Output configuration selection
             1:0      RW     00      OCFG[1:0]           00: 2-channel (full-bridge) power, 1-channel DDX® is
                                                         default
                                                                                                         s  )
                                       Table 40. Output configuration selection
                                                                                                   c  t(
                 OCFG[1:0]                                  Output power configuration
                                                                                              d  u
                                2 channel (full-bridge) power, 1 channel DDX®:
                                                                                        r o
             00                 1A/1B  1A/1B
                                2A/2B  2A/2B
                                                                               e    P
                                                                        le  t
                                2 (half-bridge) and 1 (full-bridge) on-board power:
             01
                                1A  1A binary
                                2A  1B binary
                                                                 s   o
                                3A/3B  2A/2B binary
                                                        O     b
             10                 Reserved
                                                 )  -
             11
                                         t
                                3A  1A/1B   s
                                1 channel mono-parallel:
                                           (
                                     c
                                3B  2A/2B
                                 u
                           o  d
                     Pr
                                      Table 41. Invalid input detect mute enable
               Bit     R/W    RST           Name                                  Description
            e t e                                        Invalid input detect auto-mute enable:
       o  l  2        RW    1        IDE                 0: disabled
     s                                                   1: enabled
Ob          Setting the IDE bit enables this function, which looks at the input I2S data and clocking and
            will automatically mute all outputs if the signals are perceived as invalid.
                                    Table 42. Binary clock loss detection enable
               Bit     R/W    RST           Name                                  Description
                                                         Binary output mode clock loss detection enable
             3        RW    1        BCLE                0: disabled
                                                         1: enabled
            Detects loss of input MCLK in binary mode and will output 50% duty cycle to prevent audible
            artifacts when input clocking is lost.
 34/64                                          DocID11531 Rev 9


 STA326                                                                                 Register description
                                    Table 43. Auto-EAPD on clock loss enable
             Bit    R/W    RST          Name                                Description
                                                    Auto EAPD on clock loss
           5       RW     0        ECLE             0: disabled
                                                    1: enabled
          When ECLE is active, it issues a power device power down signal (EAPD) on clock loss
          detection.
                                          Table 44. Software power down
             Bit    R/W    RST          Name                                Description
                                                                                                       s  )
                                                    Software power down:
                                                                                               c  t(
           6       RW     1        PWDN
                                                                                         d  u
                                                    0: power down mode: initiates a power-down sequence
                                                    which results in a soft mute of all channels and finally
                                                                                  r
                                                    asserts EAPD circa 260 ms later
                                                                                     o
                                                    1: normal operation
                                                                         e    P
                                                                  le   t
                                     Table 45. External amplifier power down
             Bit    R/W    RST          Name
                                                           s  o             Description
                                                   O    b
                                                    External amplifier power down:
           7       RW     0        EAPD
                                            )   -   0: external power stage power down active
                                                    1: normal operation
                                      t ( s
                               u   c
          EAPD is used to actively power down a connected DDX® power device. This register has to
          be written to 1 at start-up to enable the DDX® power device for normal operation.
                        o   d
                  P   r
          e t e
      o l
  b s
O
                                           DocID11531 Rev 9                                                35/64
                                                                                                                 64


 Register description                                                                             STA326
 7.7        Volume control
 7.7.1      Master controls
            Master mute register (addr 0x06)
                 D7            D6          D5           D4          D3         D2         D1        D0
               Reserved      Reserved    Reserved    Reserved    Reserved   Reserved   Reserved   MMUTE
                  0             0            0           1           0          0          0         0
            Master volume register (addr 0x07)
                 D7            D6          D5          D4         D3         D2          D1
                                                                                                   s
                                                                                                    D0
                                                                                                      )
                                                                                                t(
                MV7           MV6         MV5         MV4         MV3        MV2        MV1        MV0
                                                                                           uc
                  1             1           1           1          1          1          1          1
 Note:
                                                                                        d
            Value of volume derived from MVOL is dependent on AMV Automode volume settings.
                                                                                      o
 7.7.2      Channel controls
                                                                                P   r
            Channel 1 volume (addr 0x08)
                                                                        et e
                 D7            D6          D5           D4
                                                                  o D3l        D2         D1        D0
                                                              s
                                                       Ob
                C1V7          C1V6        C1V5         C1V4        C1V3       C1V2      C1V1       C1V0
                  0             1            1           0           0          0          0         0
            Channel 2 volume (addr 0x09)
                                                 )  -
                 D7
                C2V7
                               D6
                              C2V6
                                       ct  (s
                                           D5
                                          C2V5
                                                        D4
                                                       C2V4
                                                                    D3
                                                                   C2V3
                                                                               D2
                                                                              C2V2
                                                                                          D1
                                                                                        C2V1
                                                                                                    D0
                                                                                                   C2V0
                  0
                                d
                                1   u        1           0           0          0          0         0
                          r o
            Channel 3 volume (addr 0x0A)
                e D7
                      P        D6          D5           D4          D3         D2         D1        D0
          l e t C3V7          C3V6        C3V5         C3V4        C3V3       C3V2      C3V1       C3V0
     s o           0             1           1           0           0          0          0         0
O b
 7.7.3      Volume description
            The volume structure of the STA326 consists of individual volume registers for each of the
            three channels and a master volume register, and individual channel volume trim registers.
            The channel volume settings are normally used to set the maximum allowable digital gain
            and to hard-set gain differences between certain channels. These values are normally set at
            the initialization of the IC and not changed. The individual channel volumes are adjustable in
            0.5-dB steps from +48 dB to -80 dB. The master volume control is normally mapped to the
            master volume of the system. The values of these two settings are summed to find the
            actual gain/volume value for any given channel.
            When set to 1, the master mute will mute all channels, whereas the individual channel
            mutes (CxM) will mute only that channel. Both the master mute and the channel mutes
            provide a “soft mute” with the volume ramping down to mute in 4096 samples from the
            maximum volume setting at the internal processing rate (approximately 96 kHz). A “hard
            mute” can be obtained by programming the value 0xFF to any channel volume register or
 36/64                                          DocID11531 Rev 9


 STA326                                                                          Register description
          the master volume register. When volume offsets are provided via the master volume
          register any channel whose total volume is less than -100 dB will be muted.
          All changes in volume take place at zero-crossings when ZCE = 1 (configuration register E)
          on a per channel basis as this creates the smoothest possible volume transitions. When
          ZCE = 0, volume updates will occur immediately.
          The STA326 also features a soft-volume update function that will ramp the volume between
          intermediate values when the value is updated, when SVE = 1 (configuration register E).
          This feature can be disabled by setting SVE = 0.
          Each channel also contains an individual channel volume bypass. If a particular channel has
          volume bypassed via the CxVBP = 1 register then only the channel volume setting for that
          particular channel affects the volume setting, the master volume setting will not affect that
          channel. Also, master soft-mute will not affect the channel if CxVBP = 1.
                                                                                                s   )
                                                                                         c  t(
          Each channel also contains a channel mute. If CxM = 1 a soft mute is performed on that
          channel
                                                                                  d  u
                                                                             r o
                           Table 46. Master volume offset as a function of MV[7:0]
                     MV[7:0]
                                                                           P
                                                       Volume offset from channel value
                                                                      e
           00000000 (0x00)              0 dB
                                                                le t
           00000001 (0x01)              -0.5 dB
                                                          s  o
           00000010 (0x02)
           …
                                        -1 dB
                                        …
                                                  O   b
           01001100 (0x4C)
                                            )
                                        -38 dB  -
           …
                                     t (…s
           11111110 (0xFE)
                               u  c     -127 dB
           11111111 (0xFF)
                         o d            Hard master mute
                   P   r      Table 47. Channel volume as a function of CxV[7:0]
          e t e      CxV[7:0]                                      Volume
      o l  00000000 (0x00)              +48 dB
  b s      00000001 (0x01)              +47.5 dB
O          00000010 (0x02)
           …
                                        +47dB
                                        …
           01100001 (0x5F)              +0.5 dB
           01100000 (0x60)              0 dB
           01011111 (0x61)              -0.5 dB
           …                            …
           11111110 (0xFE)              -79.5 dB
           11111111 (0xFF)              Hard channel mute
                                           DocID11531 Rev 9                                         37/64
                                                                                                          64


 Register description                                                                              STA326
 7.8        Automode registers
 7.8.1      Automodes EQ, volume, GC (addr 0x0B)
                 D7         D6            D5           D4           D3        D2         D1         D0
                AMPS      Reserved      AMGC1        AMGC0         AMV1      AMV0      AMEQ1      AMEQ0
                  1          0             0            0            0         0          0          0
                                               Table 48. Automode EQ
                      AMEQ[1,0]                                      Mode (biquad 1-4)
             00                              User programmable
             01                              Preset EQ - PEQ bits
                                                                                                   s   )
             10                              Auto volume controlled loudness curve
                                                                                              c t(
             11                              Not used
                                                                                        d   u
                                                                                   r o
                                                                          e    P
            By setting AMEQ to any setting other than 00 enables Automode EQ where biquads 1-4 are
            not user programmable. Any coefficient settings for these biquads are ignored. Also when
                                                                        t
            Automode EQ is used the prescale value for channels 1-2 becomes hard-set to -18 dB.
                                                                    le
                                                              s  o
                                             Table 49. Automode volume
                       AMV[1,0]
                                                     O     b           Mode (MVOL)
             00
                                                 -
                                             MVOL 0.5 dB 256 steps (standard)
                                              )
                                       t(s
             01                              MVOL auto curve 30 steps
                                 uc
             10                              MVOL auto curve 40 steps
             11                              MVOL auto curve 50 steps
                        r od
                e    P             Table 50. Automode gain compression/limiters
          let
                      AMGC[1:0]                                            Mode
             00                              User programmable GC
     so      01                              AC no clipping
Ob           10
             11
                                             AC limited clipping (10%)
                                             DRC nighttime listening mode
                                     Table 51. AMPS - Automode auto prescale
               Bit    R/W    RST          Name                              Description
                                                      Automode prescale
             7       RW     1        AMPS             0: -18 dB used for prescale when AMEQ neq 00
                                                      1: user-defined prescale when AMEQ neq 00
 38/64                                       DocID11531 Rev 9


 STA326                                                                                    Register description
 7.8.2     Automode AM/prescale/bass management scale (addr 0x0C)
                  D7          D6          D5           D4            D3          D2            D1          D0
                 XO3         XO2         XO1          XO0         AMAM2        AMAM1         AMAM0       AMAME
                   0           0           0            0             0           0             0           0
                                     Table 52. Automode AM switching enable
                Bit    R/W     RST        Name                                Description
                                                        Automode AM enable
            0         RW     0      AMAME               0: switching frequency determined by PWMS setting
                                                        1: switching frequency determined by AMAM settings
                                                        AM switching frequency setting
                                                                                                          s   )
                                                                                                      t(
            3:1       RW     000    AMAM[2:0]
                                                        000: default
                                                                                                u  c
             n
                              Table 53. Automode AM switching frequency selection
                                                                                        o    d
                     AMAM[2:0]               48 kHz/96 kHz input fs                   r
                                                                                 44.1 kHz/88.2 kHz input fs
                                                                                  P
            000                       0.535 MHz -0.720 MHz
                                                                          t e
                                                                            0.535 MHz -0.670 MHz
            001                       0.721 MHz -0.900 MHz
                                                                   o   le   0.671 MHz -0.800 MHz
            010
            011
                                      0.901 MHz -1.100 MHz
                                      1.101 MHz -1.300 MHz  b  s            0.801 MHz -1.000 MHz
                                                                            1.001 MHz -1.180 MHz
            100
                                                  -   O
                                      1.301 MHz -1.480 MHz                  1.181 MHz -1.340 MHz
            101
                                            s  )
                                      1.481 MHz -1.600 MHz
                                         (
                                                                            1.341 MHz -1.500 MHz
            110
                                    c  t
                                      1.601 MHz -1.700 MHz                  1.501 MHz - 1.700 MHz
                              d  u
           When DDX® is used concurrently with an AM radio tuner, it is advisable to use the AMAM
                         r o
           bits to automatically adjust the output PWM switching rate dependent upon the specific
                 e    P
           radio frequency that the tuner is receiving. The values used in AMAM are also dependent
           upon the sample rate determined by the ADC used.
         l e   t                       Table 54. Automode crossover setting
     s o       Bit     R/W    RST         Name                                Description
O b                                                    Automode crossover frequency selection
                                                        000: user-defined crossover coefficients are used
            7:4       RW     0      XO[3:0]
                                                        Otherwise: preset coefficients for the crossover setting
                                                        desired
                                     Table 55. Crossover frequency selection
                      XO[2:0]                        Bass management - Crossover frequency
            0000                       User
            0001                       80 Hz
            0010                       100 Hz
            0011                       120 Hz
                                              DocID11531 Rev 9                                                39/64
                                                                                                                    64


 Register description                                                                          STA326
                                Table 55. Crossover frequency selection (continued)
                      XO[2:0]                         Bass management - Crossover frequency
             0100                      140 Hz
             0101                      160 Hz
             0110                      180 Hz
             0111                      200 Hz
             1000                      220 Hz
             1001                      240 Hz
             1010                      260 Hz
                                                                                                s  )
                                                                                             t(
             1011                      280 Hz
             1100                      300 Hz
                                                                                        u  c
             1101                      320 Hz
                                                                                   o d
             1110
             1111
                                       340 Hz
                                       360 Hz                                P   r
                                                                       t e
 7.8.3      Preset EQ settings (addr 0x0D)
                                                                o  le
                 D7           D6          D5           D4
                                                           b s   D3          D2        D1        D0
               Reserved
                  0
                           Reserved
                               0
                                       Reserved
                                            0
                                                   -   O
                                                      PEQ4
                                                        0
                                                                PEQ3
                                                                  0
                                                                            PEQ2
                                                                              0
                                                                                      PEQ1
                                                                                        0
                                                                                                PEQ0
                                                                                                  0
                                          (  s  )
                                              Table 56. Preset EQ selection
                     PEQ[4:0]
                                     c  t                            Setting
             00000
                              d   u    Flat
                          o
                      Pr
             00001                     Rock
           e  t e
             00010
             00011
                                       Soft rock
                                       Jazz
     s ol    00100                     Classical
O b          00101
             00110
                                       Dance
                                       Pop
             00111                     Soft
             01000                     Hard
             01001                     Party
             01010                     Vocal
             01011                     Hip-hop
             01100                     Dialog
             01101                     Bass-boost #1
             01110                     Bass-boost #2
             01111                     Bass-boost #3
 40/64                                         DocID11531 Rev 9


 STA326                                                                           Register description
                                  Table 56. Preset EQ selection (continued)
                   PEQ[4:0]                                        Setting
           10000                    Loudness 1 (least boost)
           10001                    Loudness 2
           10010                    Loudness 3
           10011                    Loudness 4
           10100                    Loudness 5
           10101                    Loudness 6
           10110                    Loudness 7
                                                                                               s  )
                                                                                            t(
           10111                    Loudness 8
           11000                    Loudness 9
                                                                                      u   c
           11001                    Loudness 10
                                                                                 o d
           11010
           11011
                                    Loudness 11
                                    Loudness 12                            P   r
           11100                    Loudness 13
                                                                    t e
           11101                    Loudness 14
                                                             o   le
           11110                    Loudness 15
                                                        b s
           11111
                                                   O
                                    Loudness 16 (most boost)
                                                -
                                       ( s   )
 7.9
                                     t
          Channel configuration registers
                                  c
 7.9.1
                            d   u
          Channel 1 configuration (addr 0x0E)
                      r o
              e
                D7
              C1OM1P         D6
                          C1OM0
                                         D5
                                       C1LS1
                                                     D4
                                                   C1LS0
                                                               D3
                                                              C1BO
                                                                           D2
                                                                         C1VBP
                                                                                       D1
                                                                                    C1EQBP
                                                                                                  D0
                                                                                               C1TCB
         let
                 0            0           0           0         0           0           0          0
     s
 7.9.2 o  Channel 2 configuration (addr 0x0F)
O b            D7
             C2OM1
                           D6
                         C2OM0
                                       D5
                                      C2LS1
                                                   D4
                                                  C2LS0
                                                               D3
                                                              C2BO
                                                                           D2
                                                                         C2VBP
                                                                                     D1
                                                                                   C2EQBP
                                                                                                D0
                                                                                              C2TCB
                0           1           0           0           0           0         0          0
 7.9.3    Channel 3 configuration (addr 0x10)
               D7          D6          D5          D4          D3          D2        D1         D0
             C3OM1       C3OM0        C3LS1       C3LS0       C3BO       C3VBP     Reserved  Reserved
                1           0           0           0           0           0         0          0
          EQ control can be bypassed on a per channel basis. If EQ control is bypassed on a given
          channel the prescale and all 9 filters (high-pass, biquads, de-emphasis, bass management
          cross-over, bass, treble in any combination) are bypassed for that channel.
                                            DocID11531 Rev 9                                       41/64
                                                                                                         64


 Register description                                                                            STA326
            CxEQBP
                0: perform EQ on channel X - normal operation
                1: bypass EQ on channel X
            Tone control (bass/treble) can be bypassed on a per channel basis. If tone control is
            bypassed on a given channel the two filters that tone control utilizes are bypassed.
            CxTCB
                0: perform tone control on channel X - (default operation)
                1: bypass tone control on channel X
            Each channel can be configured to output either the patented DDX® PWM data or standard
                                                                                                 s
            binary PWM encoded data. By setting the CxBO bit to 1, each channel can be individually)
            controlled to be in binary operation mode.
                                                                                            c t(
                                                                                       d  u
            Also, there is the capability to map each channel independently onto any of the two limiters
            available within the STA326 or even not map it to any limiter at all (default mode).
                                                                                  r o
                                    Table 57. Channel limiter mapping selection
                                                                           e   P
             00
                     CxLS[1,0]
                                                                    le
                                        Channel has limiting disabled
                                                                         t
                                                               Channel limiter mapping
             01
                                                              s  o
                                        Channel is mapped to limiter #1
             10
                                                     O     b
                                        Channel is mapped to limiter #2
                                              )  -
                                        t ( s
            Each PWM output channel can receive data from any channel output of the volume block.
            Which channel a particular PWM output receives is dependent upon that channel’s CxOM
            register bits.
                                 u   c
                            o d       Table 58. Channel PWM output mapping
                     P   r CxOM[1:0]                                    PWM output from
                e
          let
             00                                   Channel 1
             01                                   Channel 2
     s o     10                                   Channel 3
O b          11                                   Not used
 42/64                                       DocID11531 Rev 9


 STA326                                                                      Register description
 7.10     Tone control (addr 0x11)
               D7        D6           D5         D4        D3        D2         D1        D0
              TTC3      TTC2        TTC1        TTC0      BTC3      BTC2       BTC1      BTC0
                0         1            1          1         0         1          1         1
                                Table 59. Tone control boost/cut selection
                    BTC[3:0]/TTC[3:0]                              Boost/Cut
           0000                                 -12 dB
           0001                                 -12 dB
           …                                    …
                                                                                         s  )
           0111
           0110
                                                -4 dB
                                                -2 dB                               c t(
           0111                                 0 dB
                                                                              d  u
           1000                                 +2 dB                    r o
           1001                                 +4 dB
                                                                  e  P
           …                                    …
                                                             le t
           1101                                 +12 dB
                                                       s  o
           1110
           1111                                  O   b
                                                +12 dB
                                                +12 dB
                                          )  -
                                   t (  s
                             u  c
                       o  d
                   P r
          e t e
      o l
  b s
O
                                         DocID11531 Rev 9                                    43/64
                                                                                                   64


 Register description                                                                               STA326
 7.11       Dynamics control
 7.11.1     Limiter 1 attack/release threshold (addr 0x12)
                   D7            D6        D5          D4         D3          D2          D1          D0
                  L1A3          L1A2      L1A1        L1A0       L1R3        L1R2        L1R1        L1R0
                    0             1         1           0          1           0           1           0
 7.11.2     Limiter 1 attack/release threshold (addr 0x13)
                   D7            D6        D5          D4         D3          D2          D1          D0
                 L1AT3
                    0
                               L1AT2
                                  1
                                         L1AT1
                                            1
                                                     L1AT0
                                                        0
                                                                L1RT3
                                                                   1
                                                                            L1RT2
                                                                               0
                                                                                        L1RT1
                                                                                           0
                                                                                                    s  1)
                                                                                                    L1RT0
                                                                                              c  t(
 7.11.3     Limiter 2 attack/release rate (addr 0x14)
                                                                                       d   u
                                                                                  ro
                   D7            D6        D5          D4         D3          D2          D1          D0
                  L2A3
                    0
                                L2A2
                                  1
                                          L2A1
                                            1
                                                      L2A0
                                                        0
                                                                 L2R3
                                                                   1
                                                                          e    P
                                                                             L2R2
                                                                               0
                                                                                         L2R1
                                                                                           1
                                                                                                     L2R0
                                                                                                       0
 7.11.4     Limiter 2 attack/release threshold (addr 0x15)
                                                                o    l et
                                                             s
                                                      Ob
                   D7            D6        D5          D4         D3          D2          D1          D0
                 L2AT3         L2AT2     L2AT1       L2AT0      L2RT3       L2RT2       L2RT1       L2RT0
                                                )-
                    0             1         1           0          1           0           0           1
 7.11.5     Dynamics control description
                                         t (  s
                                     u c
            The STA326 includes 2 independent limiter blocks. The purpose of the limiters is to
                                  d
            automatically reduce the dynamic range of a recording to prevent the outputs from clipping
                             o
                       P   r
            in anti-clipping mode, or to actively reduce the dynamic range for a better listening
            environment (such as a night-time listening mode, which is often needed for DVDs.) The two
            modes are selected via the DRC bit in configuration register D (bit 5, address 0x03). Each
               t e
            channel can be mapped to Limiter1, Limiter2, or not mapped.
            e
       o  l If a channel is not mapped, that channel will clip normally when 0 dBFS is exceeded. Each
  b  s      limiter will look at the present value of each channel that is mapped to it, select the
            maximum absolute value of all these channels, perform the limiting algorithm on that value,
O           and then if needed adjust the gain of the mapped channels in unison.
            The limiter attack thresholds are determined by the LxAT registers. When the attack
            threshold has been exceeded, the limiter, when active, will automatically start reducing the
            gain. The rate at which the gain is reduced when the attack threshold is exceeded is
            dependent upon the attack rate register setting for that limiter. The gain reduction occurs on
            a peak-detect algorithm.
            The release of limiter, when the gain is again increased, is dependent on a RMS-detect
            algorithm. The output of the volume/limiter block is passed through an RMS filter. The output
            of this filter is compared to the release threshold, determined by the Release Threshold
            register.
            When the RMS filter output falls below the release threshold, the gain is increased at a rate
            dependent upon the release rate register. The gain can never be increased past its set value
            and therefore the release will only occur if the limiter has already reduced the gain. The
 44/64                                         DocID11531 Rev 9


 STA326                                                                           Register description
         release threshold value can be used to set what is effectively a minimum dynamic range.
         This is helpful as over-limiting can reduce the dynamic range to virtually zero and cause
         program material to sound “lifeless”.
         In AC mode the attack and release thresholds are set relative to full-scale. In DRC mode the
         attack threshold is set relative to the maximum volume setting of the channels mapped to
         that limiter and the release threshold is set relative to the maximum volume setting plus the
         attack threshold.
                              Figure 18. Basic limiter and volume flow diagram
                                                                                                s )
                                                                                          c t(
                                                                                   d   u
                                                                              r o
                                                                        e  P
                                                                 le   t
                                                          s   o
                                                       b
                                Table 60. Limiter attack/release rate selection
                                                  O
            LxA[3:0]
                                 Attack rate
                                   dB/ms
                                            )  -                  LxR[3:0]
                                                                                   Release rate
                                                                                       dB/ms
          0000          3.1584
                                     t ( s            Fast     0000         0.5116
                                  c
                           du
          0001          2.7072                                 0001         0.1370
                      ro
          0010          2.2560                                 0010         0.0744
             eP
          0011          1.8048                                 0011         0.0499
        let
          0100          1.3536                                 0100         0.0360
          0101          0.9024                                 0101         0.0299
    s o   0110          0.4512                                 0110         0.0264
O b       0111
          1000
                        0.2256
                        0.1504
                                                               0111
                                                               1000
                                                                            0.0208
                                                                            0.0198
          1001          0.1123                                 1001         0.0172
          1010          0.0902                                 1010         0.0147
          1011          0.0752                                 1011         0.0137
          1100          0.0645                                 1100         0.0134
          1101          0.0564                                 1101         0.0117
          1110          0.0501                                 1110         0.0110
          1111          0.0451                        Slow     1111         0.0104
                                           DocID11531 Rev 9                                       45/64
                                                                                                        64


 Register description                                                                           STA326
 7.11.6     Anti-clipping mode
                         Table 61. Limiter attack/release threshold selection (AC mode)
                               Attack threshold (AC)                        Release threshold (AC)
               LxAT[3:0]                                    LxRT[3:0]
                                  dB relative to FS                            dB relative to FS
             0000          -12                            0000         -
             0001          -10                            0001         -29 dB
             0010          -8                             0010         -20 dB
             0011          -6                             0011         -16 dB
             0100          -4                             0100         -14 dB
                                                                                                s )
             0101          -2                             0101         -12 dB
                                                                                         c   t(
             0110
             0111
                           0
                           +2
                                                          0110
                                                          0111
                                                                       -10 dB
                                                                       -8 dB      d   u
             1000          +3                             1000         -7 dB  r o
             1001          +4                             1001
                                                                      e   P
                                                                       -6 dB
                                                                e   t
                                                             ol
             1010          +5                             1010         -5 dB
             1011          +6                             1011         -4 dB
             1100          +7
                                                    O  bs 1100         -3 dB
             1101
             1110
                           +8
                           +9
                                             )   -        1101
                                                          1110
                                                                       -2 dB
                                                                       -1 dB
             1111          +10
                                      t ( s               1111         -0 dB
                                u  c
                           o  d
                    P    r
            e t e
       o  l
  b  s
O
 46/64                                      DocID11531 Rev 9


 STA326                                                                           Register description
 7.11.7    Dynamic range compression mode
                        Table 62. Limiter attack/release threshold selection (DRC mode)
                              Attack threshold (DRC)                       Release threshold (DRC)
              LxAT[3:0]                                     LxRT[3:0]
                               dB relative to volume                     db relative to volume + LxAT
            0000          -31                             0000         -
            0001          -29                             0001         -38 dB
            0010          -27                             0010         -36 dB
            0011          -25                             0011         -33 dB
            0100          -23                             0100         -31 dB
                                                                                                s  )
            0101          -21                             0101         -30 dB
                                                                                          c  t(
            0110
            0111
                          -19
                          -17
                                                          0110
                                                          0111
                                                                       -28 dB
                                                                       -26 dB      d   u
            1000          -16                             1000         -24 dB r o
            1001          -15                             1001
                                                                      e   P
                                                                       -22 dB
                                                                e   t
                                                             ol
            1010          -14                             1010         -20 dB
            1011          -13                             1011         -18 dB
            1100          -12
                                                   O   bs 1100         -15 dB
            1101
            1110
                          -10
                          -7
                                             )  -         1101
                                                          1110
                                                                       -12 dB
                                                                       -9 dB
            1111          -4
                                      t ( s               1111         -6 dB
                               u   c
                          o  d
                   P    r
           e t e
       o l
  b s
O
                                            DocID11531 Rev 9                                       47/64
                                                                                                         64


 User programmable processing                                                                       STA326
 8          User programmable processing
 8.1        EQ - biquad equation
            The biquads use the equation that follows. This is depicted in Figure 19 below.
            Y[n] = 2(b0/2)X[n] + 2(b1/2)X[n - 1] + b2X[n - 2] - 2(a1/2)Y[n - 1] - a2Y[n - 2]
            = b0X[n] + b1X[n - 1] + b2X[n - 2] - a1Y[n - 1] - a2Y[n - 2]
            where Y[n] represents the output and X[n] represents the input. Multipliers are 28-bit signed
            fractional multipliers, with coefficient values in the range of 0x800000 (-1) to 0x7FFFFF
            (0.9999998808).
            Coefficients stored in the user-defined coefficient RAM are referenced in the following
                                                                                                    s  )
            manner:
                                                                                              c  t(
            
            
                  CxHy0 = b1/2
                  CxHy1 = b2                                                            d  u
                 CxHy2 = -a1/2                                                    r o
                 CxHy3 = -a2
                                                                             e P
                 CxHy4 = b0/2
                                                                      le   t
            coefficient in the fourth biquad for channel 3
                                                                 s o
            The x represents the channel and the y the biquad number. For example C3H41 is the b0/2
                                                       O    b
                                                 Figure 19. Biquad filter
                                               )   -
                                        t ( s
                                  u  c
                           o  d
                     P   r
            e t e
 8.2
          l
       o Prescale
  b  s      The prescale block which precedes the first biquad is used for attenuation when filters are
O           designed that boost frequencies above 0 dBFS. This is a single 24-bit signed fractional
            multiplier, with 0x800000 = -1 and 0x7FFFFF = 0.9999998808. By default, all prescale
            factors are set to 0x7FFFFF.
 8.3        Postscale
            The STA326 provides one additional multiplication after the last interpolation stage and
            before the distortion compensation on each channel. This is a 24-bit signed fractional
            multiplier. The scale factor for this multiplier is loaded into RAM using the same I2C registers
            as the biquad coefficients and the mix. All channels can use the same settings as channel 1
            by setting the postscale link bit.
 48/64                                        DocID11531 Rev 9


 STA326                                                                User programmable processing
 8.4      Mix/bass management
          The STA326 provides a post EQ mixing block per channel. Each channel has 2 mixing
          coefficients, which are each 24-bit signed fractional multipliers, that correspond to the 2
          channels of input to the mixing block. These coefficients are accessible via the user
          controlled coefficient RAM described below. The mix coefficients are expressed as 24-bit
          signed; fractional numbers in the range +1.0 (8388607) to -1.0 (-8388608) are used to
          provide three channels of output from two channels of filtered input.
                                Figure 20. Mix/bass management block diagram
                                                                                                 s   )
                                                                                            c t(
                                                                                     d   u
                                                                                r o
                                                                        e   P
                                                                  le  t
                                                           s   o
                                                    O    b
                                             )   -
                                       t ( s
                                u   c
                         o   d
                   P   r
             t e
          After a mix is achieved, STA326 also provides the capability to implement crossover filters
          on all channels corresponding to 2.1 bass management solution. Channels 1 and 2 use a
          e
      o l first-order high-pass filter and channel 3 uses a second-order low-pass filter corresponding
          to the setting of the XO bits of I2C register 0x0C. If XO = 000, user specified crossover filters
  b s     are used.
O         By default these coefficients correspond to pass-through. However, the user can write these
          coefficients in a similar way as the EQ biquads. When user-defined setting is selected, the
          user can only write 2nd order crossover filters. This output is then passed on to the
          volume/limiter block.
                                            DocID11531 Rev 9                                         49/64
                                                                                                            64


 User programmable processing                                                                          STA326
 8.5        Calculating 24-bit signed fractional numbers from a dB value
            The prescale, mixing, and postscale functions of the STA326 use 24-bit signed fractional
            multipliers to attenuate signals. These attenuations can also invert the phase and therefore
            range in value from -1 to +1. It is possible to calculate the coefficient to utilize for a given
            negative dB value (attenuation) via the equations below.
                Non-inverting phase numbers 0 to +1:
                Coefficient = round(8388607 * 10(dB / 20))
                Inverting phase numbers 0 to -1:
                Coefficient = 16777216 - round(8388607 * 10(dB / 20))
            As can be seen by the preceding equations, the value for positive phase 0 dB is 0x7FFFFF
            and the value for negative phase 0 dB is 0x800000.
                                                                                                       s   )
                                                                                                 c  t(
 8.6        User-defined coefficient RAM
                                                                                         d   u
                                                                                   r o
 8.6.1      Coefficient address register 1 (addr 0x16)
                                                                          e   P
                 D7           D6          D5          D4          D3
                                                                    le  t     D2           D1            D0
                CFA7
                  0
                             CFA6
                               0
                                         CFA5
                                           0
                                                     CFA4
                                                       0
                                                             s  oCFA3
                                                                   0
                                                                            CFA2
                                                                               0
                                                                                          CFA1
                                                                                             0
                                                                                                        CFA0
                                                                                                          0
 8.6.2                                               O     b
            Coefficient b1data register bits 23:16 (addr 0x17)
                                               )  -
                 D7           D6
                                       t (D5
                                            s         D4          D3         D2            D1            D0
                C1B23       C1B22
                                    c   C1B21       C1B20       C1B19       C1B18         C1B17        C1B16
                               du
                  0            0           0           0           0          0             0             0
 8.6.3
                         r o
            Coefficient b1data register bits 15:8 (addr 0x18)
                e    P
          le  t  D7
                C1B15
                               D6
                             C1B14
                                           D5
                                         C1B13
                                                       D4
                                                     C1B12
                                                                    D3
                                                                  C1B11
                                                                                D2
                                                                              C1B10
                                                                                              D1
                                                                                            C1B9
                                                                                                         D0
                                                                                                        C1B8
     so
                  0             0           0            0           0           0             0          0
Ob
 8.6.4      Coefficient b1data register bits 7:0 (addr 0x19)
                 D7           D6          D5          D4          D3          D2           D1            D0
                C1B7         C1B6        C1B5        C1B4        C1B3       C1B2          C1B1          C1B0
                  0            0           0           0           0           0             0            0
 8.6.5      Coefficient b2 data register bits 23:16 (addr 0x1A)
                 D7           D6          D5          D4          D3         D2            D1            D0
                C2B23       C2B22       C2B21       C2B20       C2B19       C2B18         C2B17        C2B16
                  0            0           0           0           0          0             0             0
 50/64                                        DocID11531 Rev 9


 STA326                                                        User programmable processing
 8.6.6   Coefficient b2 data register bits 15:8 (addr 0x1B)
               D7      D6        D5            D4         D3          D2         D1       D0
             C2B15    C2B14    C2B13         C2B12      C2B11       C2B10      C2B9      C2B8
                0        0         0            0          0          0           0         0
 8.6.7   Coefficient b2 data register bits 7:0 (addr 0x1C)
              D7       D6       D5           D4        D3          D2         D1          D0
             C2B7     C2B6     C2B5         C2B4      C2B3        C2B2       C2B1        C2B0
               0        0        0            0         0           0          0           0
                                                                                         s  )
 8.6.8   Coefficient a1 data register bits 23:16 (addr 0x1D)
                                                                                    c t(
              D7       D6       D5           D4        D3          D2
                                                                             d u
                                                                              D1          D0
             C3B23   C3B22    C3B21        C3B20      C3B19      C3B18
                                                                         r o C3B17      C3B16
               0        0        0            0         0
                                                                e  P0          0           0
 8.6.9   Coefficient a1 data register bits 15:8 (addr 0x1E)
                                                         le   t
               D7      D6        D5            D4
                                                    s o   D3          D2         D1       D0
             C3B15    C3B14    C3B13         C3B12
                                                  b     C3B11       C3B10      C3B9      C3B8
                                         -O
                0        0         0            0          0          0           0         0
 8.6.10                               )
         Coefficient a1 data register bits 7:0 (addr 0x1F)
                                  s
                              t(
              D7       D6
                           uc   D5           D4        D3          D2         D1          D0
                     od
             C3B7     C3B6     C3B5         C3B4      C3B3        C3B2       C3B1        C3B0
                  Pr
               0        0        0            0         0           0          0           0
 8.6.11  Coefficient a2 data register bits 23:16 (addr 0x20)
           t e
        le
     so
              D7       D6       D5           D4        D3          D2         D1          D0
             C4B23   C4B22    C4B21        C4B20      C4B19      C4B18       C4B17      C4B16
Ob
               0        0        0            0         0           0          0           0
 8.6.12  Coefficient a2 data register bits 15:8 (addr 0x21)
               D7      D6        D5            D4         D3          D2         D1       D0
             C4B15    C4B14    C4B13         C4B12      C4B11       C4B10      C4B9      C4B8
                0        0         0            0          0          0           0         0
 8.6.13  Coefficient a2 data register bits 7:0 (addr 0x22)
              D7       D6       D5           D4        D3          D2         D1          D0
             C4B7     C4B6     C4B5         C4B4      C4B3        C4B2       C4B1        C4B0
               0        0        0            0         0           0          0           0
                                     DocID11531 Rev 9                                        51/64
                                                                                                   64


 User programmable processing                                                                        STA326
 8.6.14     Coefficient b0 data register bits 23:16 (addr 0x23)
                  D7          D6          D5           D4         D3           D2          D1          D0
                C5B23       C5B22       C5B21        C5B20      C5B19        C5B18       C5B17       C5B16
                   0           0           0            0          0            0           0           0
 8.6.15     Coefficient b0 data register bits 15:8 (addr 0x24)
                  D7           D6          D5            D4          D3           D2          D1        D0
                C5B15        C5B14       C5B13         C5B12      C5B11         C5B10       C5B9       C5B8
                   0            0            0            0           0            0           0         0
                                                                                                      s  )
 8.6.16     Coefficient b0 data register bits 7:0 (addr 0x25)
                                                                                                 c t(
                  D7          D6          D5           D4         D3           D2
                                                                                         d  u
                                                                                           D1          D0
                 C5B7        C5B6        C5B5         C5B4       C5B3         C5B2
                                                                                     r o  C5B1        C5B0
                   0           0           0            0          0
                                                                          e    P0           0           0
 8.6.17     Coefficient write control register (addr 0x26)
                                                                    le  t
                                                             so
                  D7          D6          D5           D4         D3           D2          D1          D0
               Reserved    Reserved    Reserved     Reserved      RA           R1          WA          W1
                                                      Ob
                   0           0           0            0          0            0           0           0
                                                )  -
            Coefficients for EQ, mix and scaling are handled internally in the STA326 via RAM. Access
            to this RAM is available to the user via an I2C register interface. A collection of I2C registers
                                       t (s
            are dedicated to this function. First register contains the coefficient base address, five sets
                                    c
            of three registers store the values of the 24-bit coefficients to be written or that were read,
                                  u
            and one contains bits used to control the read or write of the coefficient (s) to RAM. The
                              d
                          o
            following are instructions for reading and writing coefficients.
                        r
                e     P
       o  l et
     s
Ob
 52/64                                         DocID11531 Rev 9


 STA326                                                               User programmable processing
 8.7      Reading a coefficient from RAM
              write 8 bits of address to I2C register 0x16
              write 1 to bit R1 (D2) of I2C register 0x26
              read top 8 bits of coefficient in I2C address 0x17
              read middle 8 bits of coefficient in I2C address 0x18
              read bottom 8 bits of coefficient in I2C address 0x19
 8.8      Reading a set of coefficients from RAM
               write 8 bits of address to I2C register 0x16
          
                                                                                           s )
          
          
               write 1 to bit RA (D3) of I2C register 0x26
               read top 8 bits of coefficient in I2C address 0x17
                                                                                      c t(
              read middle 8 bits of coefficient in I2C address 0x18
                                                                                  d u
              read bottom 8 bits of coefficient in I2C address 0x19
                                                                              r o
          
          
               read top 8 bits of coefficient b2 in I2C address 0x1A
               read middle 8 bits of coefficient b2 in I2C address 0x1B
                                                                       e  P
          
                                                                 le  t
               read bottom 8 bits of coefficient b2 in I2C address 0x1C
          
                                                           s  o
               read top 8 bits of coefficient a1 in I2C address 0x1D
          
          
                                                     O   b
               read middle 8 bits of coefficient a1 in I2C address 0x1E
               read bottom 8 bits of coefficient a1 in I2C address 0x1F
          
                                             )   -
               read top 8 bits of coefficient a2 in I2C address 0x20
          
                                     t ( s
               read middle 8 bits of coefficient a2 in I2C address 0x21
               read bottom 8 bits of coefficient a2 in I2C address 0x22
          
                                u  c
               read top 8 bits of coefficient b0 in I2C address 0x23
          
                         o  d
               read middle 8 bits of coefficient b0 in I2C address 0x24
          
                  P    r
               read bottom 8 bits of coefficient b0 in I2C address 0x25
          e t e
 8.9
      o l Writing a single coefficient to RAM
O bs      
          
               write 8 bits of address to I2C register 0x16
               write top 8 bits of coefficient in I2C address 0x17
              write middle 8 bits of coefficient in I2C address 0x18
              write bottom 8 bits of coefficient in I2C address 0x19
              write 1 to W1 bit in I2C address 0x26
                                            DocID11531 Rev 9                                  53/64
                                                                                                    64


 User programmable processing                                                                     STA326
 8.10       Writing a set of coefficients to RAM
                 write 8 bits of starting address to I2C register 0x16
                 write top 8 bits of coefficient b1 in I2C address 0x17
                 write middle 8 bits of coefficient b1 in I2C address 0x18
                 write bottom 8 bits of coefficient b1 in I2C address 0x19
                 write top 8 bits of coefficient b2 in I2C address 0x1A
                 write middle 8 bits of coefficient b2 in I2C address 0x1B
                 write bottom 8 bits of coefficient b2 in I2C address 0x1C
                 write top 8 bits of coefficient a1 in I2C address 0x1D
                 write middle 8 bits of coefficient a1 in I2C address 0x1E
                                                                                                  s  )
            
            
                  write bottom 8 bits of coefficient a1 in I2C address 0x1F
                  write top 8 bits of coefficient a2 in I2C address 0x20
                                                                                            c  t(
                 write middle 8 bits of coefficient a2 in I2C address 0x21
                                                                                       d  u
                 write bottom 8 bits of coefficient a2 in I2C address 0x22
                                                                                 r o
            
            
                  write top 8 bits of coefficient b0 in I2C address 0x23
                  write middle 8 bits of coefficient b0 in I2C address 0x24
                                                                           e  P
            
                                                                      le t
                  write bottom 8 bits of coefficient b0 in I2C address 0x25
                 write 1 to WA bit in I2C address 0x26
                                                               s  o
                                                       O    b
            The mechanism for writing a set of coefficients to RAM provides a method of updating the
            five coefficients corresponding to a given biquad (filter) simultaneously to avoid possible
                                                   -
            unpleasant acoustic side-effects. When using this technique, the 8-bit address would
                                                )
                                         t ( s
            specify the address of the biquad b1 coefficient (for example 0, 5, 10, 15, …, 45 decimal),
            and the STA326 will generate the RAM addresses as offsets from this base value to write
                                      c
            the complete set of coefficient data.
                                   u
                            o  d
                               Table 63. RAM block for biquads, mixing, and scaling
                     P    r
              Index (decimal)    Index (Hex)              Description           Coefficient     Default
                e
          let
             0                  0x00                                          C1H10 (b1/2)    0x000000
             1                  0x01                                          C1H11 (b2)      0x000000
     s o     2                  0x02           Channel 1 - Biquad 1           C1H12 (a1/2)    0x000000
O b          3
             4
                                0x03
                                0x04
                                                                              C1H13 (a2)
                                                                              C1H14 (b0/2)
                                                                                              0x000000
                                                                                              0x400000
             5                  0x05           Channel 1 - Biquad 2           C1H20           0x000000
             …                  …              …                              …               …
             19                 0x13           Channel 1 - Biquad 4           C1H44           0x400000
             20                 0x14                                          C2H10           0x000000
                                               Channel 2 - Biquad 1
             21                 0x15                                          C2H11           0x000000
             …                  …              …                              …               …
             39                 0x27           Channel 2 - Biquad 4           C2H44           0x400000
 54/64                                         DocID11531 Rev 9


 STA326                                                             User programmable processing
                    Table 63. RAM block for biquads, mixing, and scaling (continued)
           Index (decimal)  Index (Hex)           Description             Coefficient    Default
           40              0x28                                         C12H0 (b1/2)  0x000000
           41              0x29                                         C12H1 (b2)    0x000000
                                        High-pass 2nd order filter
           42              0x2A                                         C12H2 (a1/2)  0x000000
                                        for XO = 000
           43              0x2B                                         C12H3 (a2)    0x000000
           44              0x2C                                         C12H4 (b0/2)  0x400000
           45              0x2D                                         C12L0 (b1/2)  0x000000
           46              0x2E                                         C12L1 (b2)    0x000000
                                        Low-pass 2nd order filter
                                                                                           s )
                                                                                        t(
           47              0x2F                                         C12L2 (a1/2)  0x000000
                                        for XO = 000
                                                                                    uc
           48              0x30                                         C12L3 (a2)    0x000000
                                                                             od
           49              0x31                                         C12L4 (b0/2)  0x400000
                                                                        Pr
           50              0x32         Channel 1 - Prescale            C1PreS        0x7FFFFF
           51              0x33         Channel 2 - Prescale            C2PreS        0x7FFFFF
           52              0x34         Channel 1 - Postscale
                                                                   t e  C1PstS        0x7FFFFF
                                                                le
                                                        so
           53              0x35         Channel 2 - Postscale           C2PstS        0x7FFFFF
                                                Ob
           54              0x36         Channel 3 - Postscale           C3PstS        0x7FFFFF
           55              0x37         Thermal warning - Postscale     TWPstS        0x5A9DF7
           56              0x38
                                         )   -
                                        Channel 1 - Mix 1               C1MX1         0x7FFFFF
           57
           58
                           0x39
                           0x3A
                                ct   (s Channel 1 - Mix 2
                                        Channel 2 - Mix 1
                                                                        C1MX2
                                                                        C2MX1
                                                                                      0x000000
                                                                                      0x000000
           59
                           d  u
                           0x3B         Channel 2 - Mix 2               C2MX2         0x7FFFFF
                       o
                  Pr
           60              0x3C         Channel 3 - Mix 1               C3MX1         0x400000
           61              0x3D         Channel 3 - Mix 2               C3MX2         0x400000
          e t
           62 e            0x3E         Unused                          -             -
      o l  63              0x3F         Unused                          -             -
    s
Ob
                                        DocID11531 Rev 9                                      55/64
                                                                                                    64


 User programmable processing                                                                       STA326
 8.11       Variable max power correction (addr 0x27, 0x28)
                 D7           D6          D5             D4          D3             D2         D1     D0
               MPCC15      MPCC14      MPCC13         MPCC12     MPCC11          MPCC10    MPCC9     MPCC8
                  0            0           1              0           1              1          0       1
               MPCC7       MPCC6        MPCC5         MPCC4       MPCC3          MPCC2     MPCC1     MPCC0
                  1            1           0              0           0              0          0       0
            MPCC bits determine the 16 MSBs of the MPC compensation coefficient. This coefficient is
            used in place of the default coefficient when MPCV = 1.
 8.12       Fault detect recovery (addr 0x2B, 0x2C)
                                                                                                     s  )
                                                                                                  t(
                                                                                             uc
                 D7          D6          D5            D4         D3             D2         D1        D0
               FDRC15     FDRC14      FDRC13        FDRC12     FDRC11         FDRC10      FDRC9     FDRC8
                                                                                         od
                  0           0           0             0          0              0          0         0
               FDRC7
                  0
                           FDRC6
                              0
                                       FDRC5
                                          0
                                                     FDRC4
                                                        0
                                                                FDRC3
                                                                   1
                                                                               FDRC2
                                                                                  P
                                                                                  1
                                                                                       r  FDRC1
                                                                                             0
                                                                                                    FDRC0
                                                                                                       0
                                                                          t e
            FDRC bits specify the 16-bit fault detect recovery time delay. When FAULT is asserted, the
                                                                       e
                                                                o   l
            output TRISTATE will be immediately asserted low and held low for the time period specified
            by this constant. A constant value of 0x0001 in this register is approximately 0.083 ms. The
                                                            b s
            default value of 0x000C specifies approximately 1 ms.
                                                 -    O
 8.13       Status (addr 0x2D)
                                        (s    )
                 D7          D6
                                   c  t  D5            D4         D3             D2         D1        D0
                PLLUL
                             d   u
                          Reserved    Reserved      Reserved   Reserved       Reserved    FAULT     TWARN
                  0
                        r o   0           0             0          0              0          0         0
                eP
                                                   Table 64. TWARN
          let
                       D0                                        Thermal warning
     so
             0                       Thermal warning condition
Ob
             1                       Normal operation
                                                    Table 65. FAULT
                       D1                                               IC fault
             0                       IC fault condition
             1                       Normal operation
                                                    Table 66. PLLUL
                       D7                                         PLL unlocked
             0                       Normal operation
             1                       PLL unlocked
 56/64                                       DocID11531 Rev 9


                         9         Applications
                                                                                                                             STA326
                                                      Figure 21. Application circuit for 2.0-channel (2 BTL) configuration
                                                                                           ( s )
                                                                                   u    ct
                                                                               o d
                                                                       P r
                                                                 e t e
                                                             o l
                                                       b s
                                                     O
   DocID11531 Rev 9
                                               ) -
                                         c t(s
                                    d  u
                                r o
                             e P
                        l e t
    s                 o
O b
                                                                                                                             Applications
   57/64


                                             Figure 22. Application circuit for 2.1-channel (2 single-ended + 1 BTL) configuration
   58/64
                                                                                                                                     Applications
                                                                                          ( s )
                                                                                   u   ct
                                                                               o d
                                                                       P r
                                                                 e t e
                                                             o l
                                                     b s
                                                   O
   DocID11531 Rev 9
                                             ) -
                                       c t(s
                                    du
                                r o
                             e P
                        l e t
    s                 o
O b
                                                                                                                                     STA326


                                                     Figure 23. Application circuit for mono-channel configuration
                                                                                                                     STA326
                                                                                      ( s )
                                                                               u   ct
                                                                           o d
                                                                   P r
                                                             e t e
                                                         o l
                                                     b s
                                                   O
   DocID11531 Rev 9
                                             ) -
                                       c t(s
                                    du
                                r o
                             e P
                        l e t
    s                 o
O b
                                                                                                                     Applications
   59/64


 Package mechanical data                                                                       STA326
 10        Package mechanical data
           In order to meet environmental requirements, ST offers these devices in different grades of
           ECOPACK® packages, depending on their level of environmental compliance. ECOPACK®
           specifications, grade definitions and product status are available at: www.st.com.
           ECOPACK® is an ST trademark.
                                                                                               s )
                                                                                          c t(
                                                                                    d  u
                                                                               r  o
                                                                       e   P
                                                                le   t
                                                          s  o
                                                   O  b
                                            )  -
                                     t  ( s
                               u  c
                         o   d
                   P   r
           e t e
       o l
  b  s
O
 60/64                                     DocID11531 Rev 9


 STA326                                                     Package mechanical data
 10.1     PowerSO-36 EPU package information
                         Figure 24. PowerSO-36 EPU package outline
                                                                            s )
                                                                       c t(
                                                                   d u
                                                               r o
                                                         e P
                                                    le t
                                               s  o
                                        O   b
                                  )  -
                            t ( s
                        u c
                    o d
                P r
          e t e
      o l
  b s
O
                                 DocID11531 Rev 9                             61/64
                                                                                    64


 Package mechanical data                                                                 STA326
                             Table 67. PowerSO-36 EPU package mechanical data
                                       mm.                                 inch.
            Symbol
                        Min.           Typ.           Max.       Min.       Typ.        Max.
               A         3.25            -            3.43       0.128        -         0.135
               A2        3.10            -            3.20       0.122        -         0.126
               A4        0.80            -            1.00       0.031        -         0.039
               A5          -           0.20             -          -       0.008          -
               a1        0.03            -           -0.04       0.001        -        -0.002
                b        0.22            -            0.38       0.009        -
                                                                                            )
                                                                                        0.015
                                                                                         s
                c        0.23            -            0.32       0.009        -
                                                                                   c t( 0.013
               D
               D1
                        15.80
                         9.40
                                         -
                                         -
                                                     16.00
                                                      9.80
                                                                 0.622
                                                                 0.370
                                                                              -
                                                                              d
                                                                              -
                                                                                 u     0.630
                                                                                        0.386
               D2          -           1.00             -          -     r o
                                                                           0.039          -
               E        13.90            -           14.50
                                                                    e
                                                                 0.547 P      -         0.571
                                                                e t
                                                             ol
               E1       10.90            -           11.10       0.429        -         0.437
               E2          -             -            2.90         -          -         0.114
               E3        5.80            -
                                                  O    bs
                                                      6.20       0.228        -         0.244
               E4
                e
                         2.90
                           -
                                         -
                                       0.65
                                            )  -      3.20
                                                        -
                                                                 0.114
                                                                   -
                                                                              -
                                                                           0.026
                                                                                        0.126
                                                                                          -
               e3          -
                                    t ( s
                                       11.05            -          -       0.435          -
                                  c
                           du
               G           0             -            0.08         0          -         0.003
                     ro
               H        15.50            -           15.90       0.610        -        0.626
               eP
                h          -             -            1.10         -          -         0.043
                L        0.80            -            1.10       0.031        -         0.043
         l e t M         2.25            -            2.60       0.089        -         0.102
       o
  bs
               N           -             -        10 degrees       -          -     10 degrees
               R           -            0.6             -          -       0.024          -
O               s          -             -         8 degrees       -          -      8 degrees
 62/64                                     DocID11531 Rev 9


 STA326                                                                                         Revision history
 11           Revision history
                                    Table 68. Document revision history
      Date     Revision                                          Changes
    Jul-2005       1    Initial release
   May-2006        2    Changed from preliminary data to maturity.
                        Datasheet remade
                        Updated Features on cover page
                        Updated Chapter 1: Description on page 8
                        Updated Chapter 2: Pin out on page 10
                                                                                                          s   )
                        Updated Chapter 3: Electrical specifications on page 13
                                                                                                   c   t(
  03-Nov-2010      3
                        Added Chapter 5: Characterization curves on page 17
                                                                                             d  u
                        Updated Table 9: Register summary on page 22 with bit names used in register
                        description
                                                                                       r  o
                        page 22
                                                                               e   P
                        Updated reset values in register bit map tables in Chapter 7: Register description on
                        Updated Chapter 9: Applications on page 57
                                                                       le    t
                        Updated Chapter 10: Package mechanical data on page 60
                                                                s  o
                        Added CONFIG pin description to Section 2.3: Pin description on page 12
  27-Apr-2011      4
                                                            b
                        Added Section 4: Power supply and control sequencing on page 16
                                                      O
  19-Jan-2012      5
                                                   -
                        Updated Section 6.2: Device addressing
                                                )
                        Updated pin names in Figure 5 and Table 2
                                         t ( s
                        Updated pin name to VDD_REG in CONFIG (pin 21) on page 12
  04-Feb-2013      6
                                    u  c
                        Updated Figure 21: Application circuit for 2.0-channel (2 BTL) configuration
                           o    d
                        Added Figure 22: Application circuit for 2.1-channel (2 single-ended + 1 BTL)
                        configuration
  13-Feb-2014      7  P  r
                        Added Figure 23: Application circuit for mono-channel configuration
                        Updated order code Table 1 on page 1
              e t e     Modified value of R5 to 3K9 in Figure 21: Application circuit for 2.0-channel (2 BTL)
         o  l
  18-Jun-2015      8
                        configuration and Figure 23: Application circuit for mono-channel configuration
O bs                    Updated registers 0x29, 0x2A, and 0x2D in Table 9: Register summary
                        Updated Section 4: Power supply and control sequencing
                        Added sample rates to text in Configuration register A (addr 0x00)
                        Updated bit D7 in Configuration register C (addr 0x02)
                        Updated text concerning DSPB bit in Configuration register D (addr 0x03)
  25-Jan-2016      9    Updated bit D4 in Master mute register (addr 0x06)
                        Updated bit D6 in Channel 2 configuration (addr 0x0F)
                        Updated bit D7 in Channel 3 configuration (addr 0x10)
                        Updated Section 8.2: Prescale
                        Corrected name of bits in Coefficient a1 data register bits 23:16 (addr 0x1D)
                        Added Section 8.13: Status (addr 0x2D)
                                               DocID11531 Rev 9                                               63/64
                                                                                                                    64


                                                                                                                                   STA326
                                                                                                                                    s   )
                                                                                                                           c   t(
                                                                                                                   d   u
                                                                                                            r  o
                                                                                                  e    P
                                                                                          le    t
                                                                                   s  o
                                                                         O     b
                                                               )     -
                                                      t ( s
                                              u   c
                                     o   d  IMPORTANT NOTICE – PLEASE READ CAREFULLY
                             P    r
 STMicroelectronics NV and its subsidiaries (“ST”) reserve the right to make changes, corrections, enhancements, modifications, and
                      t e
 improvements to ST products and/or to this document at any time without notice. Purchasers should obtain the latest relevant information on
 ST products before placing orders. ST products are sold pursuant to ST’s terms and conditions of sale in place at the time of order
                 e
               l
 acknowledgement.
           o
   b   s
 Purchasers are solely responsible for the choice, selection, and use of ST products and ST assumes no liability for application assistance or
 the design of Purchasers’ products.
ONo license, express or implied, to any intellectual property right is granted by ST herein.
 Resale of ST products with provisions different from the information set forth herein shall void any warranty granted by ST for such product.
 ST and the ST logo are trademarks of ST. All other product or service names are the property of their respective owners.
 Information in this document supersedes and replaces information previously supplied in any prior versions of this document.
                                                 © 2016 STMicroelectronics – All rights reserved
 64/64                                                       DocID11531 Rev 9


Mouser Electronics
Authorized Distributor
Click to View Pricing, Inventory, Delivery & Lifecycle Information:
STMicroelectronics:
 STA32613TR STA326JTR
