                                                                                            STA369BW
                                              2.1-channel high-efficiency digital audio system
                                                                                        Sound Terminal®
                                                                                        Datasheet - production data
                                                                  – 15 preset crossover filters
                                                                  – 5 preset anti-clipping modes
                                                                  – Preset nighttime listening mode
                                                                Individual channel and master soft/hard mute
                                                                Independent channel volume and DSP bypass
                                                                Automatic zero-detect mute
                           PowerSSO-36
                                                                Automatic invalid input-detect mute
               with exposed pad down (EPD)
                                                                I2S input data interface
                                                                Input and output channel mapping
                                                                Up to 8 user-programmable biquads per
Features                                                          channel
 Wide-range supply voltage                                     3 coefficient banks for EQ presets storing with
                                                                  fast recall via I2C interface
    – 5 V to 26 V (operating range)
    – 30 V (absolute maximum rating)                            Extended coefficient dynamic up to -4..4 for
                                                                  easy implementation of high shelf filters
 Four power output configurations
                                                                Bass/treble tones and de-emphasis control
    – 2 channels of ternary PWM (stereo mode)
          (2 x 30 W into 8  at 22 V)                           Selectable high-pass filter for DC blocking
    – 3 channels - left, right using binary and LFE             Advanced AM interference frequency
          using ternary PWM (2.1 mode) (2 x 15 W +                switching and noise suppression modes
          1 x 30 W into 2 x 4, 1 x 8  at 22 V)                Selectable high- or low-bandwidth
    – 2 channels of ternary PWM (2 x 30 W) +                      noise-shaping topologies
          stereo lineout ternary)
                                                                Selectable clock input ratio
 FFX®100 dB SNR and dynamic range
                                                                96 kHz internal processing sampling rate with
 Selectable 32 to 192 kHz input sampling rates                   quantization error noise shaping for very low
 I2C control with selectable device address                      cutoff frequency filters
 Digital gain/attenuation +42 dB to -80 dB with                Thermal overload and short-circuit protection
    0.125 dB/step resolution                                      embedded
 Soft-volume update with programmable ratio                    Video apps: 576 x Fs input mode supported
 Individual channel and master gain/attenuation                Fully compatible with STA339BW,
                                                                  STA369BWS and STA350BW
 Two independent DRCs configurable as a
    dual-band anti-clipper (B2DRC) or independent
                                                                            Table 1. Device summary
    limiters/compressors
                                                                 Order code          Package           Packing
 EQ-DRC for DRC based on filtered signals
 Dedicated LFE processing for bass boosting                     STA369BW          Power SSO-36          Tube
    with 0.125 dB/step resolution                               STA369BWTR         Power SSO-36      Tape and reel
 Audio presets:
September 2013                                       DocID022033 Rev 2                                          1/89
This is information on a product in full production.                                                       www.st.com


Contents                                                                                                             STA369BW
Contents
1        Description . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10
         1.1    Block diagram . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .11
2        Pin connections . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12
         2.1    Connection diagram . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12
         2.2    Pin description . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12
3        Electrical specifications . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14
         3.1    Absolute maximum ratings . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14
         3.2    Thermal data . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14
         3.3    Recommended operating conditions . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15
         3.4    Electrical specifications for the digital section . . . . . . . . . . . . . . . . . . . . . 15
         3.5    Electrical specifications for the power section . . . . . . . . . . . . . . . . . . . . . 16
4        Characterization curves . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18
         4.1    Mono parallel BTL characteristics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 23
5        Serial audio interface . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25
                5.0.1    Timings . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25
                5.0.2    Delay serial clock enable . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25
                5.0.3    Channel input mapping . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25
6        Processing data paths . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26
7        I2C bus specification . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28
         7.1    Communication protocol . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28
                7.1.1    Data transition or change . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28
                7.1.2    Start condition . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28
                7.1.3    Stop condition . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28
                7.1.4    Data input . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28
         7.2    Device addressing . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28
         7.3    Write operation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29
                7.3.1    Byte write . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29
                7.3.2    Multi-byte write . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29
2/89                                    DocID022033 Rev 2


STA369BW                                                                                                           Contents
         7.4   Read operation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29
               7.4.1   Current address byte read . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29
               7.4.2   Current address multi-byte read . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29
               7.4.3   Random address byte read . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29
               7.4.4   Random address multi-byte read . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29
               7.4.5   Write mode sequence . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30
               7.4.6   Read mode sequence . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30
8        Register description . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31
         8.1   Configuration register A (addr 0x00) . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34
               8.1.1   Master clock select . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34
               8.1.2   Interpolation ratio select . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 35
               8.1.3   Thermal warning recovery bypass . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 35
               8.1.4   Thermal warning adjustment bypass . . . . . . . . . . . . . . . . . . . . . . . . . . . 35
               8.1.5   Fault detect recovery bypass . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 36
         8.2   Configuration register B (addr 0x01) . . . . . . . . . . . . . . . . . . . . . . . . . . . . 36
               8.2.1   Serial audio input interface format . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 36
               8.2.2   Serial data interface . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 37
               8.2.3   Serial data first bit . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 37
               8.2.4   Delay serial clock enable . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 39
               8.2.5   Channel input mapping . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 39
         8.3   Configuration register C (addr 0x02) . . . . . . . . . . . . . . . . . . . . . . . . . . . . 40
               8.3.1   FFX power output mode . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 40
               8.3.2   FFX compensating pulse size register . . . . . . . . . . . . . . . . . . . . . . . . . . 40
               8.3.3   Overcurrent warning detect adjustment bypass . . . . . . . . . . . . . . . . . . 41
         8.4   Configuration register D (addr 0x03) . . . . . . . . . . . . . . . . . . . . . . . . . . . . 41
               8.4.1   High-pass filter bypass . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 41
               8.4.2   De-emphasis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 41
               8.4.3   DSP bypass . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 42
               8.4.4   Post-scale link . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 42
               8.4.5   Biquad coefficient link . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 42
               8.4.6   Dynamic range compression/anti-clipping bit . . . . . . . . . . . . . . . . . . . . 42
               8.4.7   Zero-detect mute enable . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 43
               8.4.8   Submix mode enable . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 43
         8.5   Configuration register E (addr 0x04) . . . . . . . . . . . . . . . . . . . . . . . . . . . . 43
               8.5.1   Max power correction variable . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 43
                                     DocID022033 Rev 2                                                                       3/89
                                                                                                                                  89


Contents                                                                                                        STA369BW
              8.5.2   Max power correction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 43
              8.5.3   Noise-shaper bandwidth selection . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 44
              8.5.4   AM mode enable . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 44
              8.5.5   PWM speed mode . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 44
              8.5.6   Distortion compensation variable enable . . . . . . . . . . . . . . . . . . . . . . . . 44
              8.5.7   Zero-crossing volume enable . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 44
              8.5.8   Soft-volume update enable . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 45
         8.6  Configuration register F (addr 0x05) . . . . . . . . . . . . . . . . . . . . . . . . . . . . 45
              8.6.1   Output configuration . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 45
              8.6.2   Invalid input detect mute enable . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 51
              8.6.3   Binary output mode clock loss detection . . . . . . . . . . . . . . . . . . . . . . . . 51
              8.6.4   LRCK double trigger protection . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 51
              8.6.5   Auto EAPD on clock loss . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 51
              8.6.6   IC power-down . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 51
              8.6.7   External amplifier power-down . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 52
         8.7  Volume control registers (addr 0x06 - 0x0A) . . . . . . . . . . . . . . . . . . . . . . 52
              8.7.1   Mute/line output configuration register . . . . . . . . . . . . . . . . . . . . . . . . . . 52
              8.7.2   Master volume register . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 52
              8.7.3   Channel 1 volume . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 52
              8.7.4   Channel 2 volume . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 53
              8.7.5   Channel 3 / line output volume . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 53
         8.8  Audio preset registers (addr 0x0B and 0x0C) . . . . . . . . . . . . . . . . . . . . . 54
              8.8.1   Audio preset register 1 (addr 0x0B) . . . . . . . . . . . . . . . . . . . . . . . . . . . . 54
              8.8.2   Audio preset register 2 (addr 0x0C) . . . . . . . . . . . . . . . . . . . . . . . . . . . . 55
              8.8.3   AM interference frequency switching . . . . . . . . . . . . . . . . . . . . . . . . . . . 55
              8.8.4   Bass management crossover . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 55
         8.9  Channel configuration registers (addr 0x0E - 0x10) . . . . . . . . . . . . . . . . . 56
              8.9.1   Tone control bypass . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 56
              8.9.2   EQ bypass . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 56
              8.9.3   Volume bypass . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 57
              8.9.4   Binary output enable registers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 57
              8.9.5   Limiter select . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 57
              8.9.6   Output mapping . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 57
         8.10 Tone control register (addr 0x11) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 58
              8.10.1  Tone control . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 58
         8.11 Dynamic control registers (addr 0x12 - 0x15) . . . . . . . . . . . . . . . . . . . . . 58
4/89                                DocID022033 Rev 2


STA369BW                                                                                                            Contents
              8.11.1   Limiter 1 attack/release rate . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 58
              8.11.2   Limiter 1 attack/release threshold . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 58
              8.11.3   Limiter 2 attack/release rate . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 58
              8.11.4   Limiter 2 attack/release threshold . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 59
              8.11.5   Limiter 1 extended attack threshold (addr 0x32) . . . . . . . . . . . . . . . . . . 62
              8.11.6   Limiter 1 extended release threshold (addr 0x33) . . . . . . . . . . . . . . . . . 62
              8.11.7   Limiter 2 extended attack threshold (addr 0x34) . . . . . . . . . . . . . . . . . . 63
              8.11.8   Limiter 2 extended release threshold (addr 0x35) . . . . . . . . . . . . . . . . . 63
         8.12 User-defined coefficient control registers (addr 0x16 - 0x26) . . . . . . . . . . 63
              8.12.1   Coefficient address register . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 63
              8.12.2   Coefficient b1 data register bits 23:16 . . . . . . . . . . . . . . . . . . . . . . . . . . 63
              8.12.3   Coefficient b1 data register bits 15:8 . . . . . . . . . . . . . . . . . . . . . . . . . . . 63
              8.12.4   Coefficient b1 data register bits 7:0 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 63
              8.12.5   Coefficient b2 data register bits 23:16 . . . . . . . . . . . . . . . . . . . . . . . . . . 64
              8.12.6   Coefficient b2 data register bits 15:8 . . . . . . . . . . . . . . . . . . . . . . . . . . . 64
              8.12.7   Coefficient b2 data register bits 7:0 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 64
              8.12.8   Coefficient a1 data register bits 23:16 . . . . . . . . . . . . . . . . . . . . . . . . . . 64
              8.12.9   Coefficient a1 data register bits 15:8 . . . . . . . . . . . . . . . . . . . . . . . . . . . 64
              8.12.10 Coefficient a1 data register bits 7:0 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 64
              8.12.11 Coefficient a2 data register bits 23:16 . . . . . . . . . . . . . . . . . . . . . . . . . . 64
              8.12.12 Coefficient a2 data register bits 15:8 . . . . . . . . . . . . . . . . . . . . . . . . . . . 65
              8.12.13 Coefficient a2 data register bits 7:0 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 65
              8.12.14 Coefficient b0 data register bits 23:16 . . . . . . . . . . . . . . . . . . . . . . . . . . 65
              8.12.15 Coefficient b0 data register bits 15:8 . . . . . . . . . . . . . . . . . . . . . . . . . . . 65
              8.12.16 Coefficient b0 data register bits 7:0 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 65
              8.12.17 Coefficient write/read control register . . . . . . . . . . . . . . . . . . . . . . . . . . 65
              8.12.18 User-defined EQ . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 68
              8.12.19 Pre-scale . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 68
              8.12.20 Post-scale . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 68
              8.12.21 Overcurrent post-scale . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 69
         8.13 Variable max power correction registers (addr 0x27 - 0x28) . . . . . . . . . . 70
         8.14 Variable distortion compensation registers (addr 0x29 - 0x2A) . . . . . . . . 70
         8.15 Fault-detect recovery constant registers (addr 0x2B - 0x2C) . . . . . . . . . . 71
         8.16 Device status register (addr 0x2D) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 71
         8.17 EQ coefficients and DRC configuration register (addr 0x31) . . . . . . . . . . 72
         8.18 Extended configuration register (addr 0x36) . . . . . . . . . . . . . . . . . . . . . . 73
                                     DocID022033 Rev 2                                                                        5/89
                                                                                                                                   89


Contents                                                                                                          STA369BW
               8.18.1    Dual-band DRC . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 73
               8.18.2    EQ DRC mode . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 74
               8.18.3    Extended post-scale range . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 75
               8.18.4    Extended attack rate . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 75
               8.18.5    Extended BIQUAD selector . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 76
         8.19  EQ soft-volume configuration registers (addr 0x37 - 0x38) . . . . . . . . . . . 76
         8.20  DRC RMS filter coefficients (addr 0x39-0x3E) . . . . . . . . . . . . . . . . . . . . . 77
         8.21  Extra volume resolution configuration registers (address 0x3F) . . . . . . . 78
         8.22  Quantization error noise correction (address 0x48) . . . . . . . . . . . . . . . . . 79
         8.23  Extended coefficient range up to -4...4 (address 0x49, 0x4A) . . . . . . . . . 80
         8.24  Miscellaneous registers (address 0x4B, 0x4C) . . . . . . . . . . . . . . . . . . . . 81
               8.24.1    Rate powerdown enable (RPDNEN) bit (address 0x4B, bit D7) . . . . . . 81
               8.24.2    Noise-shaping on DC cut filter enable (NSHHPEN) bit
                         (address 0x4B, bit D6) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 81
               8.24.3    Bridge immediate off (BRIDGOFF) bit (address 0x4B, bit D5) . . . . . . . 81
               8.24.4    Channel PWM enable (CPWMEN) bit (address 0x4B, bit D2) . . . . . . . 82
               8.24.5    Power-down delay selector (PNDLSL[2:0]) bits (address 0x4C,
                         bit D4, D3, D2) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 82
9        Application . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 83
         9.1   Application scheme for power supplies . . . . . . . . . . . . . . . . . . . . . . . . . . 83
         9.2   PLL filter schematic . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 83
         9.3   Typical output configuration . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 83
10       Package thermal characteristics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 85
11       Package mechanical data . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 86
12       Revision history . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 88
6/89                                    DocID022033 Rev 2


STA369BW                                                                                                                      List of tables
List of tables
Table 1.  Device summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1
Table 2.  Pin description . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11
Table 3.  Absolute maximum ratings . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13
Table 4.  Thermal data. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13
Table 5.  Recommended operating conditions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14
Table 6.  Electrical specifications - digital section . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14
Table 7.  Electrical specifications - power section . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15
Table 8.  Timing parameters for slave mode . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24
Table 9.  Register summary. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30
Table 10. Master clock select . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 33
Table 11. Input sampling rates . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 33
Table 12. Internal interpolation ratio . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34
Table 13. IR bit settings as a function of input sampling rate . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34
Table 14. Thermal warning recovery bypass . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34
Table 15. Thermal warning adjustment bypass . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34
Table 16. Fault detect recovery bypass . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 35
Table 17. Serial audio input interface . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 35
Table 18. Serial data first bit . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 36
Table 19. Support serial audio input formats for MSB-first (SAIFB = 0) . . . . . . . . . . . . . . . . . . . . . . . 36
Table 20. Supported serial audio input formats for LSB-first (SAIFB = 1) . . . . . . . . . . . . . . . . . . . . . 37
Table 21. Delay serial clock enable . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38
Table 22. Channel input mapping . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38
Table 23. FFX power output mode . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 39
Table 24. Output modes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 39
Table 25. FFX compensating pulse size bits . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 39
Table 26. Compensating pulse size . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 39
Table 27. Overcurrent warning bypass . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 40
Table 28. High-pass filter bypass . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 40
Table 29. De-emphasis. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 40
Table 30. DSP bypass . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 41
Table 31. Post-scale link. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 41
Table 32. Biquad coefficient link . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 41
Table 33. Dynamic range compression/anti-clipping bit . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 41
Table 34. Zero-detect mute enable. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 42
Table 35. Submix mode enable . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 42
Table 36. Max power correction variable . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 42
Table 37. Max power correction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 42
Table 38. Noise-shaper bandwidth selection . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 43
Table 39. AM mode enable. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 43
Table 40. PWM speed mode . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 43
Table 41. Distortion compensation variable enable . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 43
Table 42. Zero-crossing volume enable . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 43
Table 43. Soft-volume update enable . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 44
Table 44. Output configuration . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 44
Table 45. Output configuration engine selection . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 44
Table 46. Invalid input detect mute enable . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 51
Table 47. Binary output mode clock loss detection . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 51
Table 48. LRCK double trigger protection . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 51
                                                   DocID022033 Rev 2                                                                          7/89
                                                                                                                                                   89


List of tables                                                                                                                    STA369BW
Table 49.    Auto EAPD on clock loss . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 51
Table 50.    IC power-down . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 51
Table 51.    External amplifier power-down . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 52
Table 52.    Line output configuration . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 52
Table 53.    Master volume offset as a function of MV[7:0] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 53
Table 54.    Channel volume as a function of CxV[7:0] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 54
Table 55.    Audio preset gain compression/limiters selection for AMGC[3:2] = 00. . . . . . . . . . . . . . . . 54
Table 56.    AM interference frequency switching bits . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 55
Table 57.    Audio preset AM switching frequency selection . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 55
Table 58.    Bass management crossover . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 55
Table 59.    Bass management crossover frequency . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 55
Table 60.    Tone control bypass . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 56
Table 61.    EQ bypass . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 57
Table 62.    Binary output enable registers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 57
Table 63.    Channel limiter mapping as a function of CxLS bits . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 57
Table 64.    Channel output mapping as a function of CxOM bits . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 57
Table 65.    Tone control boost/cut as a function of BTC and TTC bits . . . . . . . . . . . . . . . . . . . . . . . . . 58
Table 66.    Limiter attack rate as a function of LxA bits . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 60
Table 67.    Limiter release rate as a function of LxR bits . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 60
Table 68.    Limiter attack threshold as a function of LxAT bits (AC-mode). . . . . . . . . . . . . . . . . . . . . . 61
Table 69.    Limiter release threshold as a function of LxRT bits (AC-mode) . . . . . . . . . . . . . . . . . . . . 61
Table 70.    Limiter attack threshold as a function of LxAT bits (DRC -mode) . . . . . . . . . . . . . . . . . . . . 62
Table 71.    Limiter release threshold as a as a function of LxRT bits (DRC-mode) . . . . . . . . . . . . . . . 62
Table 72.    RAM block for biquads, mixing, scaling and bass management. . . . . . . . . . . . . . . . . . . . . 69
Table 73.    Status register bits . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 71
Table 74.    EQ RAM select . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 72
Table 75.    Anti-clipping and DRC preset . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 72
Table 76.    Anti-clipping selection for AMGC[3:2] = 01 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 72
Table 77.    Biquad filter settings . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 80
Table 78.    PowerSSO-36 EPD dimensions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 86
Table 79.    Document revision history . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 88
8/89                                                DocID022033 Rev 2


STA369BW                                                                                                                      List of figures
List of figures
Figure 1.  Block diagram . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11
Figure 2.  Pin connection PowerSSO-36 (top view) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12
Figure 3.  Test circuit . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17
Figure 4.  Demonstration board, 2.0 channels . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18
Figure 5.  Mono parallel BTL schematic . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19
Figure 6.  THD+N vs. output power (VCC = 25 V, load = 6 W) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20
Figure 7.  THD+N vs. output power (VCC = 18 V, load = 8 W) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20
Figure 8.  Output power vs. VCC (load = 6 W). . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21
Figure 9.  Output power vs. VCC (load = 8 W). . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21
Figure 10. Efficiency vs. output power (VCC = 25 V, load = 6 W) . . . . . . . . . . . . . . . . . . . . . . . . . . . . 22
Figure 11. Efficiency vs. output power (VCC = 25 V, load = 8 W) . . . . . . . . . . . . . . . . . . . . . . . . . . . . 22
Figure 12. THD+N vs. output power (VCC = 25 V, load = 3 W) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 23
Figure 13. Output power vs. VCC (load = 3 W) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 23
Figure 14. Efficiency vs. output power (VCC = 26 V, load = 3 W) . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24
Figure 15. Efficiency vs. output power (VCC = 18 V, load = 3 W) . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24
Figure 16. Timing diagram for SAI interface . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25
Figure 17. Left and right processing - part 1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26
Figure 18. Processing - part 2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 27
Figure 19. Write mode sequence . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30
Figure 20. Read mode sequence. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30
Figure 21. OCFG = 00 (default value) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 46
Figure 22. OCFG = 01 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 46
Figure 23. OCFG = 10 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 46
Figure 24. OCFG = 11 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 47
Figure 25. Output mapping scheme . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 47
Figure 26. 2.0 channels (OCFG = 00) PWM slots . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 48
Figure 27. 2.1 channels (OCFG = 01) PWM slots . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 49
Figure 28. 2.1 channels (OCFG = 10) PWM slots . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 50
Figure 29. Basic limiter and volume flow diagram . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 60
Figure 30. B2DRC scheme . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 73
Figure 31. EQDRC scheme . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 75
Figure 32. Extra resolution volume scheme. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 78
Figure 33. Biquad filter structure with quantization error noise-shaping . . . . . . . . . . . . . . . . . . . . . . . 80
Figure 34. Application scheme for power supplies . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 83
Figure 35. Output configuration for stereo BTL mode . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 84
Figure 36. Double-layer PCB with 2 copper ground areas and 24 via holes . . . . . . . . . . . . . . . . . . . 85
Figure 37. PowerSSO-36 power derating curve . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 85
Figure 38. PowerSSO-36 EPD outline drawing . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 87
                                                     DocID022033 Rev 2                                                                          9/89
                                                                                                                                                     89


Description                                                                                    STA369BW
1           Description
            The STA369BW is an integrated solution of digital audio processing, digital amplifier control,
            and FFX-power output stage, thereby creating a high-power single-chip FFX® solution
            comprising high-quality, high-efficiency, and all-digital amplification.
            The STA369BW is based on an FFX (fully flexible amplification) processor, a proprietary
            technology from STMicroelectronics. FFX is the evolution and the enlargement of ST’s
            ternary technology: the new processor can be configured to work in ternary, binary, binary
            differential and phase-shift PWM modulation schemes.
            The STA369BW contains the ternary, binary and binary differential implementations, a
            subset of the full capability of the FFX processor.
            The STA369BW is part of the Sound Terminal® family that provides full digital audio
            streaming to the speaker, offering cost effectiveness, low power dissipation and sound
            enrichment.
            The STA369BW power section consists of four independent half-bridges. These can be
            configured via digital control to operate in different modes. 2.1 channels can be provided by
            two half-bridges and a single full-bridge, providing up to 2 x 15 W + 1 x 30 W of music output
            power, by using standard 4 and 8  speakers. Two channels can be provided by two full-
            bridges, providing up to 2 x 30 W, by using standard 8  speaker at 22 V. The IC can also
            be configured as 2.1 channels with 2 x 30 W provided by the device and external power for
            FFX power drive. Please refer to the package thermal characteristics and application
            suggestions for more details.
            Also provided in the STA369BW are a full assortment of digital processing features. This
            includes up to 8 programmable biquads (EQ) per channel. Special digital signal processing
            techniques are available in order to manage low-frequency quantization noise in case of
            very low frequency cutoff filter thresholds. The coefficient range -4..4 allows the easy
            implementation of high shelf filters. Available presets allow the advantage of earlier time-to-
            market by substantially reducing the amount of software development needed for certain
            functions. This includes audio preset volume loudness, preset volume curves and preset EQ
            settings. There are also new advanced AM radio interference reduction modes. The dual-
            band DRC dynamically equalizes the system to provide speaker linear frequency response
            regardless of output power level. This feature independently processes the two bands,
            controlling dynamically the output power level in each band, thus providing better sound
            clarity.
            The serial audio data input interface accepts all possible formats, including the popular I2S
            format. Three channels of FFX processing are provided. This high-quality conversion from
            PCM audio to FFX PWM switching waveform provides over 100 dB SNR and dynamic
            range.
10/89                                         DocID022033 Rev 2


STA369BW                                                                                       Description
1.1      Block diagram
                                                   Figure 1. Block diagram
                                           2
                                          I C                  Pro tection
                   2                                         curre nt/the rm al
                  I S
              in terfa ce                                                            C han nel
                                                                                        1A
                                                                                     C hann el
                                         Pow er                    Log ic               1B
                Vo lu me                 co ntro l
                control
                                 FFX
                                                                                     Ch anne l
                                                                                        2A
                                                               R egulat ors
                                                                                     C hann el
                   PLL
                                                                                        2B
                                                                    Bias
                          D ig ita l DSP                                        Po wer
                                                                                                 AM045167v1
                                                DocID022033 Rev 2                                     11/89
                                                                                                            89


Pin connections                                                                               STA369BW
2          Pin connections
2.1        Connection diagram
                               Figure 2. Pin connection PowerSSO-36 (top view)
                       GND_SUB        1                             36        VDD_DIG
                              SA      2                             35        GND_DIG
                    TEST_MODE         3                             34        SCL
                             VSS      4                             33        SDA
                       VCC_REG        5                             32        INT_LINE
                          OUT2B       6                             31        RESET
                           GND2       7                             30        SDI
                           VCC2       8                             29        LRCKI
                          OUT2A       9                             28        BICKI
                          OUT1B       10                            27        XTI
                           VCC1       11                            26        GND_PLL
                           GND1       12                            25        FILTER_PLL
                          OUT1A       13                            24        VDD_PLL
                       GND_REG        14                            23        PWRDN
                             VDD      15                            22        GND_DIG
                         CONFIG       16                            21        VDD_DIG
                   OUT3B/FFX3B        17                            20        TWARN/OUT4A
                   OUT3A/FFX3A        18                            19        EAPD/OUT4B
                                                                    D05AU1638                   AM045168v1
2.2        Pin description
                                            Table 2. Pin description
               Pin      Type         Name                               Description
            1        GND       GND_SUB           Substrate ground
            2        I         SA                I2C select address (pull-down)
            3        I         TEST_MODE         This pin must be connected to ground (pull-down)
            4        I/O       VSS               Internal reference at Vcc-3.3 V
            5        I/O       VCC_REG           Internal Vcc reference
            6        O         OUT2B             Output half-bridge 2B
            7        GND       GND2              Power negative supply
            8        Power     VCC2              Power positive supply
            9        O         OUT2A             Output half-bridge 2A
            10       O         OUT1B             Output half-bridge 1B
12/89                                     DocID022033 Rev 2


STA369BW                                                                        Pin connections
                              Table 2. Pin description (continued)
            Pin   Type       Name                                Description
         11     Power  VCC1              Power positive supply
         12     GND    GND1              Power negative supply
         13     O      OUT1A             Output half-bridge 1A
         14     GND    GND_REG           Internal ground reference
         15     Power  VDD                Internal 3.3 V reference voltage
         16     I      CONFIG            Parallel mode command
         17     O      OUT3B/FFX3B       PWM out CH3B / external bridge driver
         18     O      OUT3A/FFX3A       PWM out CH3A / external bridge driver
         19     O      EAPD/OUT4B         Power-down for external bridge / PWM out CH4B
                                         Thermal warning from external bridge (pull-up when input)
         20     I/O    TWARN/OUT4A
                                         / PWM out CH4A
         21     Power  VDD_DIG           Digital supply voltage
         22     GND    GND_DIG           Digital ground
         23     I      PWRDN             Power down (pull-up)
         24     Power  VDD_PLL            Positive supply for PLL
         25     I      FILTER_PLL        Connection to PLL filter
         26     GND    GND_PLL           Negative supply for PLL
         27     I      XTI               PLL input clock
         28     I      BICKI             I2S serial clock
         29     I      LRCKI             I2S left/right clock
         30     I      SDI               I2S serial data channels 1 and 2
         31     I      RESET             Reset (pull-up)
         32     O      INT_LINE          Fault interrupt
         33     I/O    SDA               I2C serial data
         34     I      SCL               I2C serial clock
         35     GND    GND_DIG           Digital ground
         36     Power  VDD_DIG           Digital supply voltage
                                 DocID022033 Rev 2                                            13/89
                                                                                                    89


Electrical specifications                                                                         STA369BW
3            Electrical specifications
3.1          Absolute maximum ratings
                                           Table 3. Absolute maximum ratings
               Symbol                         Parameter                               Min  Typ Max     Unit
                  Vcc     Power supply voltage (VCCxA, VCCxB)                         -0.3      30       V
              VDD_DIG Digital supply voltage                                          -0.3       4       V
              VDD_PLL PLL supply voltage                                              -0.3       4
                  Top     Operating junction temperature                               -20     150      °C
                  Tstg    Storage temperature                                          -40     150      °C
                      Warning:    Stresses beyond those listed in Table 3 above may cause
                                  permanent damage to the device. These are stress ratings
                                  only, and functional operation of the device at these or any
                                  other conditions beyond those indicated under
                                  “Recommended operating conditions” are not implied.
                                  Exposure to AMR conditions for extended periods may affect
                                  device reliability. In the real application, power supplies with
                                  nominal values rated within the recommended operating
                                  conditions, may rise beyond the maximum operating
                                  conditions for a short time when no or very low current is
                                  sunk (amplifier in mute state). In this case the reliability of the
                                  device is guaranteed, provided that the absolute maximum
                                  ratings are not exceeded.
3.2          Thermal data
                                                    Table 4. Thermal data
               Symbol                         Parameter                               Min  Typ Max     Unit
              Rth j-case  Thermal resistance junction-case (thermal pad)                       1.5    °C/W
              Tth-sdj     Thermal shutdown junction temperature                            150          °C
              Tth-w       Thermal warning temperature                                      130          °C
              Tth-sdh     Thermal shutdown hysteresis                                       20          °C
                                                                  (1)
              Rth j-amb   Thermal resistance junction-ambient
             1. See Section 10: Package thermal characteristics on page 85 for details.
14/89                                          DocID022033 Rev 2


STA369BW                                                                  Electrical specifications
3.3      Recommended operating conditions
                             Table 5. Recommended operating conditions
          Symbol                      Parameter                     Min      Typ     Max     Unit
            Vcc  Power supply voltage (VCCxA, VCCxB)                  5                26      V
         VDD_DIG Digital supply voltage                             2.7      3.3      3.6      V
         VDD_PLL PLL supply voltage                                 2.7      3.3      3.6      V
           Tamb  Ambient temperature                                -20               +85     °C
3.4      Electrical specifications for the digital section
                           Table 6. Electrical specifications - digital section
          Symbol             Parameter               Conditions     Min      Typ     Max     Unit
                 Low-level input current without
             Iil                                   Vi = 0 V                    1       5      µA
                 pull-up/down device
                 High-level input current without  Vi = VDD_DIG
            Iih                                                                1       5      µA
                 pull-up/down device               = 3.6 V
                                                                                     0.2 *
            Vil  Low-level input voltage                                                       V
                                                                                   VDD_DIG
                                                                   0.8 *
            Vih  High-level input voltage                                                      V
                                                                  VDD_DIG
                                                                                     0.4 *
            Vol  Low-level output voltage          Iol=2 mA                                    V
                                                                                   VDD_DIG
                                                                   0.8 *
            Voh  High-level output voltage         Ioh=2 mA                                    V
                                                                  VDD_DIG
            Ipu  Pull-up/down current                                25       66      125     µA
                 Equivalent pull-up/down
            Rpu                                                               50              k
                 resistance
                                       DocID022033 Rev 2                                      15/89
                                                                                                    89


Electrical specifications                                                                        STA369BW
3.5           Electrical specifications for the power section
              The specifications given in this section are valid for the operating conditions: VCC = 22 V,
              f = 1 kHz, fsw = 384 kHz, Tamb = 25° C and RL = 8 , unless otherwise specified.
                             Table 7. Electrical specifications - power section
  Symbol                     Parameter                       Conditions      Min      Typ      Max    Unit
            Continuous output power, BTL, ternary      THD = 1%                        20
                                                                                                       W
            mode                                       THD = 10%                       30
      Po
            Continuous output power SE, binary         THD = 1%                        12
                                                                                                       W
            mode, RL = 4                              THD = 10%                       15
            Power Pchannel/Nchannel MOSFET
   RdsON                                               ld = 1.5 A                     180      250     m
            (total bridge)
    Idss    Power Pchannel/Nchannel leakage            VCC = 20 V                               10     A
    ILDT    Low current dead time (static)             Resistive  load(1)               8       15     ns
    IHDT    High current dead time (dynamic)           I load(1) = 1.5 A               15       30     ns
       tr   Rise time                                  Resistive  load(1)              10       18     ns
       tf   Fall time                                  Resistive  load(1)              10       18     ns
     Vcc    Supply voltage operating voltage                                   5                26      V
            Supply current from Vcc in power-down      PWRDN = 0                        1              A
                                                       PCM input signal
                                                       = -60 dBfs,
     Ivcc
            Supply current from Vcc in operation       Switching frequency             52       60     mA
                                                       = 384 kHz,
                                                       No LC filters
            Supply current FFX processing (reference Internal clock =
     Ivdd                                                                              55       70     mA
            only)                                      49.152 MHz
                                                       (2)                    2.6     2.8               A
     Ilim   Overcurrent limit
      Isc    Short-circuit protection                  Hi-Z output            3.1     3.3               A
    UVL     Undervoltage protection                                                            4.3      V
   OVP      Overvoltage protection                                                     29               V
     tmin   Output minimum pulse width                 No load                        100              ns
     DR     Dynamic range                                                             100              dB
            Signal-to-noise ratio, ternary mode        A-Weighted                     100              dB
   SNR
            Signal-to-noise ratio binary mode                                          90              dB
                                                       FFX stereo mode,
  THD+N     Total harmonic distortion + noise          Po = 1 W                       0.09              %
                                                       f = 1 kHz
16/89                                           DocID022033 Rev 2


STA369BW                                                                                         Electrical specifications
                          Table 7. Electrical specifications - power section (continued)
  Symbol                          Parameter                          Conditions            Min        Typ       Max      Unit
                                                                FFX stereo mode,
                                                                <5 kHz
                                                                One channel driven
   XTALK       Crosstalk                                                                               80                 dB
                                                                at 1 W
                                                                Other channel
                                                                measured
                                                                FFX stereo mode,
                                                                <5 kHz
   PSRR        Power Supply Rejection Ratio                     VRipple01V RMS                         80                 dB
                                                                Audio input = dither
                                                                only
                                                                Po = 2 x 25 W
               Peak efficiency, FFX mode                                                               90
                                                                into 8 
                                                                                                                          %
                                                                Po = 2 x 10W into 4
               Peak efficiency, binary modes                                                           86
                                                                + 1 x 20W into 8 
1. Refer to Figure 3: Test circuit.
2. Limit current if the register (OCRB Section 8.3.3) overcurrent warning detect adjustment bypass is enabled. When disabled
   refer to the Isc.
                                                    Figure 3. Test circuit
                                                       DocID022033 Rev 2                                                   17/89
                                                                                                                                 89


Characterization curves                                                                     STA369BW
4          Characterization curves
           The following characterization curves were made using the STA369BW demonstration
           board with 2.0 channels (refer to the schematic in Figure 6) under the following test
           conditions:
           VCC = 22 V, f = 1 kHz, fSW = 384 kHz, Tamb = 25 °C and RL = 8 , unless otherwise
           specified.
                                 Figure 4. Demonstration board, 2.0 channels
                                                                                                AM045290v1
18/89                                    DocID022033 Rev 2


STA369BW                                      Characterization curves
         Figure 5. Mono parallel BTL schematic
                                                              AM045170v1
             DocID022033 Rev 2                                    19/89
                                                                         89


Characterization curves                                                               STA369BW
                         Figure 6. THD+N vs. output power (VCC = 25 V, load = 6 )
                  10
                   5
                   2
                                                  Vcc=25V , Load = 6Ω,
                                                  Freq= 1KHz
                   1
                 0.5
              %
                 0.2
                 0.1
                0.05
                0.02
                0.01
                   1m 2m    5m  10m  20m   50m 100m 200m   500m   1     2   5  10  20     50 100
                                                         W
                                                                                          AM045171v1
                         Figure 7. THD+N vs. output power (VCC = 18 V, load = 8 )
                  10
                   5
                   2
                   1
                                                 Vcc=18V , Load = 8Ω,
                 0.5
                                                 Freq= 1KHz
              %
                 0.2
                 0.1
                0.05
                0.02
                0.01
                   1m 2m     5m  10m  20m    50m 100m 200m    500m    1   2   5   10   20     50
                                                         W                               AM045172v1
20/89                                   DocID022033 Rev 2


STA369BW                                                     Characterization curves
                     Figure 8. Output power vs. VCC (load = 6 )
            60
            55
            50        Load= 6 Ω,
            45        Freq=1KHz
            40
                                        THD = 10%
            35
         W 30
            25
            20
            15                                            THD = 1%
            10
             5
               +6 +8    +10    +12    +14     +16   +18    +20    +22    +24     +26
                                           Vdc
                                                                             AM045173v1
                     Figure 9. Output power vs. VCC (load = 8 )
           50
           45
                       Load= 8 Ω,
           40
                       Freq=1KHz
           35
           30                            THD = 10%
         W 25
           20
           15
                                                          THD = 1%
           10
            5
               +6 +8   +10     +12    +14    +16   +18     +20   +22     +24     +26
                                           Vdc
                                                                              AM045174v1
                            DocID022033 Rev 2                                     21/89
                                                                                         89


Characterization curves                                                                STA369BW
                       Figure 10. Efficiency vs. output power (VCC = 25 V, load = 6 )
                  +1
                 +0.9
                 +0.8
                 +0.7
                 +0.6
              η%
                 +0.5                          Vcc= 25V,
                 +0.4
                                               Load= 6 Ω,
                                               Freq=1KHz
                 +0.3
                 +0.2
                 +0.1
                  +0
                         5     10      15      20    25    30    35      40     45      50      55
                                                         W
                                                                                           AM045175v1
                       Figure 11. Efficiency vs. output power (VCC = 25 V, load = 8 )
                   +1
                 +0.9
                 +0.8
                 +0.7
                 +0.6
             η%
                 +0.5                          Vcc= 25V,
                 +0.4                          Load= 8 Ω,
                                               Freq=1KHz
                 +0.3
                 +0.2
                 +0.1
                   +0
                           5       10       15      20      25      30       35      40        45
                                                         W
                                                                                           AM045176v1
22/89                                    DocID022033 Rev 2


STA369BW                                                              Characterization curves
4.1      Mono parallel BTL characteristics
                      Figure 12. THD+N vs. output power (VCC = 25 V, load = 3 )
              10
               5
               2
                                                    Vcc=25V
                                                    Load= 3 Ω,
               1                                    Freq=1KHz
             0.5
          %
             0.2
             0.1
            0.05
            0.02
            0.01
               1m  2m    5m  10m  20m   50m 100m 200m  500m 1    2  5   10   20   50   100
                                                       W
                                                                                      AM045177v1
                             Figure 13. Output power vs. VCC (load = 3 )
             110
             100
              90                  Load= 3 Ω,                  THD=10%
              80                  Freq=1KHz
              70
              60
          W
              50
              40
              30
                                                                    THD=1%
              20
              10
                  +6      +8     +10     +12    +14     +16   +18  +20     +22   +24    +26
                                                      Vdc
                                                                                     AM045178v1
                                      DocID022033 Rev 2                                    23/89
                                                                                                 89


Characterization curves                                                                STA369BW
                       Figure 14. Efficiency vs. output power (VCC = 26 V, load = 3 )
                    +1
                  +0.9
                  +0.8
                  +0.7
                  +0.6
                  +0.5
             η%   +0.4
                                                     Vcc= 26V
                  +0.3                               Load= 3 Ω,
                                                     Freq=1KHz
                  +0.2
                  +0.1
                    +0
                          10    20      30     40      50    60    70     80      90    100     110
                                                           W
                                                                                            AM045179v1
                       Figure 15. Efficiency vs. output power (VCC = 18 V, load = 3 )
                   +1
                 +0.9
                 +0.8
                 +0.7
                 +0.6
             η % +0.5
                 +0.4                          Vcc=18V
                 +0.3
                                               Load= 3 Ω,
                                               Freq=1KHz
                 +0.2
                 +0.1
                   +0
                           5      10      15      20      25    30     35      40      45        50
                                                          W
                                                                                           AM045180v1
24/89                                    DocID022033 Rev 2


STA369BW                                                                          Serial audio interface
5        Serial audio interface
         The STA369BW audio serial input interface was designed to interface with standard digital
         audio components and to accept a number of serial data formats. The STA369BW always
         acts as the slave when receiving audio input from standard digital audio components. Serial
         data for two channels is provided using three inputs: left/right clock LRCKI, serial clock
         BICKI, and serial data SDI12.
         The SAI bit and the SAIFB bit are used to specify the serial data format. The default serial
         data format is I2S, MSB-first.
5.0.1    Timings
         In the STA369BW the BICKI and LRCKI pins are configured as inputs and they must be
         supplied by the external peripheral.
                                   Figure 16. Timing diagram for SAI interface
                                tBCH          tBCL
                                                                    80%
           BICKI                                             40%
                                    tBCy
           LRCKI
            SDI12
                                                        tLRH         tLRSU
                                   Table 8. Timing parameters for slave mode
          Symbol                           Parameter                          Min     Typ    Max     Unit
             tBCy   BICK cycle time                                            80      -       -      ns
             tBCH   BICK pulse width high                                      40      -       -      ns
             tBCL   BICK pulse width low                                       40      -       -      ns
            tLRSU   LRCKI setup time to BICKI strobing edge                    40      -       -      ns
             tLRH   LRCKI hold time to BICKI strobing edge                     40      -       -      ns
            tLRJT   LRCKI Jitter Tolerance                                                    40      ns
5.0.2    Delay serial clock enable
         To tolerate anomalies in some I2S master devices, a PLL clock cycle delay can be added to
         the BICKI signal before the SAI interface.
5.0.3    Channel input mapping
         Each channel received via I2S can be mapped to any internal processing channel via the
         channel input mapping registers. This allows for flexibility in processing. The default settings
         of these registers map each I2S input channel to its corresponding processing channel.
                                          DocID022033 Rev 2                                         25/89
                                                                                                          89


Processing data paths                                                                                                                      STA369BW
6          Processing data paths
           Figure 17 and 18 illustrate the data processing paths inside the STA369BW.
           The whole processing chain is composed of two consecutive sections. In the first one, dual-
           channel processing is implemented, as described below, and then each channel is fed into
           the post-mixing block allowing to generate either a third channel (typically used in 2.1 output
           configuration and with crossover filters enabled) or to have the channels processed by the
           dual-band DRC block (2.0 output configuration with crossover filters used to define the
           cutoff frequency of the two bands).
           The first section begins with a 2x oversampling FIR filter allowing for 2*Fs audio processing.
           Then a selectable high-pass filter removes the DC level (enabled if HFB=0).
           The channel 1 and 2 processing chain can include up to 8 filters, depending on the selected
           configuration (bits BQL, BQ5, BQ6, BQ7 and XO[3:0]).
           By default 4 independent filters per channel are enabled, plus the pre-configured De-
           Emphasis, Bass and Treble controls (BQL=0, BQ5=0, BQ6=0, BQ7=0).
           If the coefficient sets are linked (BQL=1) it’s then possible to use De-Emphasis, Bass and
           Treble filters in a user-defined configuration (provided the relevant BQx bits are set). In other
           words, both channels will use the same processing coefficients and can have up to 7 filters
           each. Note that if BQL=0 the BQx bits are ignored and the 5th, 6th and 7th filters are
           configured as, respectively, De-Emphasis, Bass and Treble controls.
           Moreover the common 8th filter, from the subsequent processing section, can be available
           on both channels (provided the pre-defined crossover frequencies are not used, XO[3:0]=0,
           and the dual-band DRC is not used).
           In the second section mixing and crossover filters are available. If B2DRC is not enabled
           (Figure 18), they are fully user-programmable and allow generating a third channel (2.1
           outputs). Alternatively, in B2DRC mode, those blocks will be used to split the sub-band and
           define the cutoff frequencies of the two bands. A prescaler and a final post-scaler allow full
           control over the signal dynamic respectively before and after the filtering stages. A mixer
           function is also available.
                                         Figure 17. Left and right processing - part 1
                 Sampling              Sampling                                                            If BQ5=1    If BQ6=1 IF BQ7=1
                 frequency=Fs          frequency=2xFs                                                    and BQL=1   and BQL=1 and BQL=1
                                                                                                             Biquad      Biquad   Biquad
                                                                                                               #5          #6       #7
                                 x2
                                FIR
                                 x2     PreScale    Hi-Pass     Biquad     Biquad     Biquad      Biquad                                      L
                                                      Filter      #1         #2         #3          #4      De-Emph.       Bass    Treble
                                over
                                FIR
                              sampling
                                over
                                                   If HPB=0                  User Defined Filters         If DEMP=0  If C1TCB=0
                                                                                                                     BTC: Bass Boost/Cut
                   From                                                                                              TTC: Treble Boost/Cut
                   I2S input
                   interface
                                                                       If DSPB=0 and C1EQBP=0              If BQ5=1   If BQ6=1 IF BQ7=1
                                                                                                         and BQL=1   and BQL=1 and BQL=1
                                                                                                             Biquad     Biquad    Biquad
                                                                                                               #5          #6       #7
                                 x2
                                FIR
                                 x2     PreScale    Hi-Pass     Biquad     Biquad     Biquad      Biquad                                      L
                                                                                                                                              R
                                                      Filter      #1         #2         #3          #4      De-Emph.       Bass    Treble
                                over
                                FIR
                              sampling
                                over
                                                   If HPB=0                  User Defined Filters         If DEMP=0  If C2TCB=0
                                                                                                                     BTC: Bass Boost/Cut
                                                                                                                     TTC: Treble Boost/Cut
                                                                       If DSPB=0 and C2EQBP=0                                                AM045181v1
26/89                                                     DocID022033 Rev 2


STA369BW                                                                                               Processing data paths
                                     Figure 18. Processing - part 2
         Dual-band DRC enabled                                                         CH3
                                                                                               DRC2
                                                                                    Volume
                               C1Mx1=
                                 C1Mx1
         L                     0x7fffff
                                                  Hi-Pass
                                                     B2DRC XO
                                                                                                 Vol
                                                                                       CH1      And
                                   +                                                                          +
                                                      Filter                                  DRC1                     Post scale
                                                     Hi-pass             -                     Limiter                 Post scale
                                                      filter               +        Volume
         R                       C1Mx2=
                                 C1Mx2
                                 0x00000
                                 C2Mx1=
                                 C2Mx1
                                 0x000000
                                                  Hi-Pass XO
                                                      2DRC
                                                     BFilter                           CH2                             Post scale
                                   +                 Hi-pass             -           Volume
                                                                                               DRC1           +
                                 C2Mx2=
                                 C2Mx2
                                                      filter               +
                                 0x7fffff
                                 C3Mx1=
                                 C3Mx1
                                 0x40000                                               CH3
                                                                                               DRC2
                                   +                                                 Volume
                                 C3Mx2=
                                 C3Mx2
                                 0x400000
                       User-Defined Mix Coefficients
                                             Crossover Frequency determined by XO Setting
                                             User Defined If XO=0000
         Dual-band DRC disabled
                                  C1Mx1
         L                                                Channel ½
                                                         Hi-Pass XO
                                                           Biquad #5
                                                                                              Vol
                                    +                         Filter
                                                          --------------
                                                                                             And            Post scale
                                                                                            Limiter
                                                         Hi-pass XO
         R                        C1Mx2                       filter
                                  C2Mx1
                                                          Channel ½
                                                         Hi-Pass      XO                      Vol
                                    +                      Biquad
                                                              Filter#5                       And            Post scale
                                                          --------------                    Limiter
                                                         Hi-pass XO
                                  C2Mx2
                                                              filter
                                  C3Mx1
                                                          Channel 3
                                                        Lo-Pass XO                            Vol
                                                             Biquad                                         Post scale
                                    +                         Filter
                                                          --------------
                                                                                             And
                                                                                            Limiter
                                                        Low-pass XO
                                  C3Mx2                       filter
                                                                                                        B2DRC Disabled
                       User-Defined Mix Coefficients
                                              Crossover Frequency determined by XO Setting
                                              User Defined If XO=0000
                                                                                                                                AM045182v1
                                      DocID022033 Rev 2                                                                             27/89
                                                                                                                                           89


I2C bus specification                                                                          STA369BW
7          I2C bus specification
           The STA369BW supports the I2C protocol via the input ports SCL and SDA_IN (master to
           slave) and the output port SDA_OUT (slave to master). This protocol defines any device
           that sends data to the bus as a transmitter and any device that reads the data as a receiver.
           The device that controls the data transfer is known as the master and the other as the slave.
           The master always starts the transfer and provides data to the serial clock for
           synchronization. The STA369BW is always a slave device in all of its communications. It
           supports up to 400 kb/sec rate (fast-mode bit rate). The STA369BW I2C is a slave-only
           interface. The I2C interface works properly only in the case that the master clock generated
           by the PLL has a frequency 10 times higher compared to the frequency of the applied SCL
           signal.
7.1        Communication protocol
7.1.1      Data transition or change
           Data changes on the SDA line must only occur when the SCL clock is low. An SDA
           transition while the clock is high is used to identify a START or STOP condition.
7.1.2      Start condition
           START is identified by a high-to-low transition of the data bus SDA signal while the clock
           signal SCL is stable in the high state. A START condition must precede any command for
           data transfer.
7.1.3      Stop condition
           STOP is identified by a low-to-high transition of the data bus SDA signal while the clock
           signal SCL is stable in the high state. A STOP condition terminates communication between
           the STA369BW and the bus master.
7.1.4      Data input
           During data input the STA369BW samples the SDA signal on the rising edge of clock SCL.
           For correct device operation the SDA signal must be stable during the rising edge of the
           clock and the data can change only when the SCL line is low.
7.2        Device addressing
           To start communication between the master and the STA369BW, the master must initiate a
           start condition. Following this, the master sends 8 bits (MSB first), corresponding to the
           device select address and read or write mode, to the SDA line.
           The seven most significant bits are the device address identifiers, corresponding to the I2C
           bus definition. In the STA369BW the I2C interface has two device addresses depending on
           the SA port configuration, 0x38 when SA = 0, and 0x3A when SA = 1.
           The eighth bit (LSB) identifies the read or write operation RW. This bit is set to 1 in read
           mode and to 0 for write mode. After a START condition the STA369BW identifies on the bus
           the device address and if a match is found, it acknowledges the identification on the SDA
28/89                                       DocID022033 Rev 2


STA369BW                                                                          I2C bus specification
         bus during the 9th bit time. The byte following the device identification byte is the internal
         space address.
7.3      Write operation
         Following the START condition the master sends a device select code with the RW bit set
         to 0. The STA369BW acknowledges this and then writes the byte of the internal address.
         After receiving the internal byte address the STA369BW again responds with an
         acknowledgement.
7.3.1    Byte write
         In the byte write mode the master sends one data byte which is acknowledged by the
         STA369BW. The master then terminates the transfer by generating a STOP condition.
7.3.2    Multi-byte write
         The multi-byte write modes can start from any internal address. The master generating a
         STOP condition terminates the transfer.
7.4      Read operation
7.4.1    Current address byte read
         Following the START condition the master sends a device select code with the RW bit set
         to 1. The STA369BW acknowledges this and then responds by sending one byte of data.
         The master then terminates the transfer by generating a STOP condition.
7.4.2    Current address multi-byte read
         The multi-byte read modes can start from any internal address. Sequential data bytes are
         read from sequential addresses within the STA369BW. The master acknowledges each
         data byte read and then generates a STOP condition, terminating the transfer.
7.4.3    Random address byte read
         Following the START condition the master sends a device select code with the RW bit set
         to 0. The STA369BW acknowledges this and then the master writes the internal address
         byte. After receiving the internal byte address, the STA369BW again responds with an
         acknowledgement. The master then initiates another START condition and sends the device
         select code with the RW bit set to 1. The STA369BW acknowledges this and then responds
         by sending one byte of data. The master then terminates the transfer by generating a STOP
         condition.
7.4.4    Random address multi-byte read
         The multi-byte read modes can start from any internal address. Sequential data bytes are
         read from sequential addresses within the STA369BW. The master acknowledges each
         data byte read and then generates a STOP condition, terminating the transfer.
                                         DocID022033 Rev 2                                           29/89
                                                                                                           89


I2C bus specification                                                                                                                  STA369BW
7.4.5      Write mode sequence
                                                          Figure 19. Write mode sequence
                                                         ACK                       ACK                    ACK
                   BYTE                   DEV-ADDR                SUB-ADDR                   DATA IN
                   WRITE
                              START                   RW                                                         STOP
                                                         ACK                       ACK                    ACK                         ACK
                MULTIBYTE                 DEV-ADDR                SUB-ADDR                   DATA IN                          DATA IN
                   WRITE
                              START                   RW                                                                                    STOP
                                                                                                                                           AM045183v1
7.4.6      Read mode sequence
                                                          Figure 20. Read mode sequence
                                                  ACK            NO ACK
               CURRENT
               ADDRESS            DEV-ADDR               DATA
                 READ
                         START                 RW                       STOP
                                                  ACK             ACK                      ACK                NO ACK
               RANDOM
               ADDRESS            DEV-ADDR             SUB-ADDR                 DEV-ADDR             DATA
                 READ
                         START                 RW                     START              RW                          STOP
                                             RW= ACK              ACK                      ACK                NO ACK
                                             HIGH
              SEQUENTIAL
               CURRENT            DEV-ADDR               DATA                DATA                    DATA
                 READ
                         START                                                                                       STOP
                                                  ACK             ACK                      ACK                 ACK               ACK         NO ACK
              SEQUENTIAL
               RANDOM             DEV-ADDR             SUB-ADDR                 DEV-ADDR             DATA                DATA         DATA
                 READ
                         START                 RW                     START              RW                                                         STOP
                                                                                                                                           AM045184v1
30/89                                                         DocID022033 Rev 2


STA369BW                                                                Register description
8         Register description
                              Table 9. Register summary
 Addr   Name     D7       D6       D5          D4          D3       D2       D1       D0
0x00  CONFA   FDRB     TWAB     TWRB       IR1         IR0      MCS2      MCS1     MCS0
0x01  CONFB   C2IM     C1IM     DSCKE      SAIFB       SAI3     SAI2      SAI1     SAI0
0x02  CONFC   OCRB              CSZ3       CSZ2        CSZ1     CSZ0      OM1      OM0
0x03  CONFD   SME      ZDE      DRC        BQL         PSL      DSPB      DEMP     HPB
0x04  CONFE   SVE      ZCE      DCCV       PWMS        AME      NSBW      MPC      MPCV
0x05  CONFF   EAPD     PWDN     ECLE       LDTE        BCLE     IDE       OCFG1    OCFG0
      MUTE/LO
0x06          LOC1     LOC0     Reserved   Reserved    C3M      C2M       C1M      MMUTE
      C
0x07  MVOL    MV7      MV6      MV5        MV4         MV3      MV2       MV1      MV0
0x08  C1VOL   C1V7     C1V6     C1V5       C1V4        C1V3     C1V2      C1V1     C1V0
0x09  C2VOL   C2V7     C2V6     C2V5       C2V4        C2V3     C2V2      C2V1     C2V0
0x0A  C3VOL   C3V7     C3V6     C3V5       C3V4        C3V3     C3V2      C3V1     C3V0
                                                                                   Reserve
0x0B  AUTO1   Reserved Reserved AMGC1      AMGC0       Reserved Reserved  Reserved
                                                                                   d
0x0C  AUTO2   XO3      XO2      XO1        XO0         AMAM2    AMAM1     AMAM0    AMAME
0x0D  AUTO3                                      Reserved
0x0E  C1CFG   C1OM1    C1OM0    C1LS1      C1LS0       C1BO     C1VBP     C1EQBP   C1TCB
0x0F  C2CFG   C2OM1    C2OM0    C2LS1      C2LS0       C2BO     C2VBP     C2EQBP   C2TCB
                                                                                   Reserve
0x10  C3CFG   C3OM1    C3OM0    C3LS1      C3LS0       C3BO     C3VBP     Reserved
                                                                                   d
0x11  TONE    TTC3     TTC2     TTC1       TTC0        BTC3     BTC2      BTC1     BTC0
0x12  L1AR    L1A3     L1A2     L1A1       L1A0        L1R3     L1R2      L1R1     L1R0
0x13  L1ATRT  L1AT3    L1AT2    L1AT1      L1AT0       L1RT3    L1RT2     L1RT1    L1RT0
0x14  L2AR    L2A3     L2A2     L2A1       L2A0        L2R3     L2R2      L2R1     L2R0
0x15  L2ATRT  L2AT3    L2AT2    L2AT1      L2AT0       L2RT3    L2RT2     L2RT1    L2RT0
0x16  CFADDR  Reserved Reserved CFA5       CFA4        CFA3     CFA2      CFA1     CFA0
0x17  B1CF1   C1B23    C1B22    C1B21      C1B20       C1B19    C1B18     C1B17    C1B16
0x18  B1CF2   C1B15    C1B14    C1B13      C1B12       C1B11    C1B10     C1B9     C1B8
0x19  B1CF3   C1B7     C1B6     C1B5       C1B4        C1B3     C1B2      C1B1     C1B0
0x1A  B2CF1   C2B23    C2B22    C2B21      C2B20       C2B19    C2B18     C2B17    C2B16
0x1B  B2CF2   C2B15    C2B14    C2B13      C2B12       C2B11    C2B10     C2B9     C2B8
0x1C  B2CF3   C2B7     C2B6     C2B5       C2B4        C2B3     C2B2      C2B1     C2B0
0x1D  A1CF1   C3B23    C3B22    C3B21      C3B20       C3B19    C3B18     C3B17    C3B16
                                   DocID022033 Rev 2                                   31/89
                                                                                             89


Register description                                                               STA369BW
                             Table 9. Register summary (continued)
  Addr   Name        D7        D6        D5        D4        D3       D2      D1        D0
 0x1E  A1CF2      C3B15    C3B14     C3B13      C3B12     C3B11    C3B10    C3B9     C3B8
 0x1F  A1CF3      C3B7     C3B6      C3B5       C3B4      C3B3     C3B2     C3B1     C3B0
 0x20  A2CF1      C4B23    C4B22     C4B21      C4B20     C4B19    C4B18    C4B17    C4B16
 0x21  A2CF2      C4B15    C4B14     C4B13      C4B12     C4B11    C4B10    C4B9     C4B8
 0x22  A2CF3      C4B7     C4B6      C4B5       C4B4      C4B3     C4B2     C4B1     C4B0
 0x23  B0CF1      C5B23    C5B22     C5B21      C5B20     C5B19    C5B18    C5B17    C5B16
 0x24  B0CF2      C5B15    C5B14     C5B13      C5B12     C5B11    C5B10    C5B9     C5B8
 0x25  B0CF3      C5B7     C5B6      C5B5       C5B4      C5B3     C5B2     C5B1     C5B0
 0x26  CFUD                       Reserved                RA       R1       WA       W1
 0x27  MPCC1      MPCC15   MPCC14    MPCC13     MPCC12    MPCC11   MPCC10   MPCC9    MPCC8
 0x28  MPCC2      MPCC7    MPCC6     MPCC5      MPCC4     MPCC3    MPCC2    MPCC1    MPCC0
 0x29  DCC1       DCC15    DCC14     DCC13      DCC12     DCC11    DCC10    DCC9     DCC8
 0x2A  DCC2       DCC7     DCC6      DCC5       DCC4      DCC3     DCC2     DCC1     DCC0
 0x2B  FDRC1      FDRC15   FDRC14    FDRC13     FDRC12    FDRC11   FDRC10   FDRC9    FDRC8
 0x2C  FDRC2      FDRC7    FDRC6     FDRC5      FDRC4     FDRC3    FDRC2    FDRC1    FDRC0
 0x2D  STATUS     PLLUL    FAULT     UVFAULT    OVFAULT   OCFAULT OCWARN TFAULT      TWARN
 0x2E  Reserved        Reserved      RO1BACT R5BACT       R4BACT   R3BACT   R2BACT   R1BACT
 0x2F  Reserved        Reserved      R01BEND    R5BEND    R4BEND   R3BEND   R2BEND   R1BEND
 0x30  Reserved             Reserved            R5BBAD    R4BBAD   R3BBAD   R2BBAD   R1BBAD
 0x31  EQCFG      XOB      Reserved Reserved    AMGC3     AMGC2    Reserved SEL1     SEL0
                  EATHEN                                                             EATH1[0
 0x32  EATH1               EATH1[6] EATH1[5]    EATH1[4]  EATH1[3] EATH1[2] EATH1[1]
                  1                                                                  ]
                  ERTHEN                                                             ERTH1[
 0x33  ERTH1               ERTH1[6] ERTH1[5]    ERTH1[4]  ERTH1[3] ERTH1[2] ERTH1[1]
                  1                                                                  0]
                  EATHEN                                                             EATH2[0
 0x34  EATH2               EATH2[6] EATH2[5]    EATH2[4]  EATH2[3] EATH2[2] EATH2[1]
                  2                                                                  ]
                  ERTHEN                                                             ERTH2[
 0x35  ERTH2               ERTH2[6] ERTH2[5]    ERTH2[4]  ERTH2[3] ERTH2[2] ERTH2[1]
                  2                                                                  0]
 0x36  CONFX      MDRC[1] MDRC[0] PS48DB        XAR1      XAR2     BQ5      BQ6      BQ7
 0x37  SVCA       Reserved Reserved SVUPE       SVUP[4]   SVUP[3]  SVUP[2]  SVUP[1]  SVUP[0]
                                                                                     SVDW[0
 0x38  SVCB       Reserved Reserved SVDWE       SVDW[4]   SVDW[3]  SVDW[2]  SVDW[1]
                                                                                     ]
                                                                                     R_C0[16
 0x39  RMS0A      R_C0[23] R_C0[22] R_C0[21]    R_C0[20]  R_C0[19] R_C0[18] R_C0[17]
                                                                                     ]
 0x3A  RMS0B      R_C0[15] R_C0[14] R_C0[13]    R_C0[12]  R_C0[11] R_C0[10] R_C0[9]  R_C0[8]
 0x3B  RMS0C      R_C0[7]  R_C0[6]   R_C0[5]    R_C0[4]   R_C0[3]  R_C0[2]  R_C0[1]  R_C0[0]
32/89                                   DocID022033 Rev 2


STA369BW                                                                Register description
                          Table 9. Register summary (continued)
 Addr   Name      D7       D6        D5         D4        D3       D2        D1       D0
                                                                                   R_C1[16
0x3C  RMS1A    R_C1[23] R_C1[22] R_C1[21]    R_C1[20]  R_C1[19] R_C1[18]  R_C1[17]
                                                                                   ]
0x3D  RMS1B    R_C1[15] R_C1[14] R_C1[13]    R_C1[12]  R_C1[11] R_C1[10]  R_C1[9]  R_C1[8]
0x3E  RMS1C    R_C1[7]  R_C1[6]   R_C1[5]    R_C1[4]   R_C1[3]  R_C1[2]   R_C1[1]  R_C1[0]
0x3F  EVOLRES VRESEN VRESTG C3VR[1]          C3VR[0]   C2VR[1]  C2VR[0]   C1VR[1]  C1VR[0]
0x40  Reserved
0x41  Reserved
0x42  Reserved
0x43  Reserved
0x44  Reserved
0x45  Reserved
0x46  Reserved
0x47  Reserved
                        NSHB7E                                  NSHB3E    NSHB2E   NSHB1E
0x48  NSHAPE   NSHXEN             NSHB6EN NSHB5EN      NSHB4EN
                        N                                       N         N        N
      CXT[B4B1                                                                     CXTB1[0
0x49           CXTB4[1] CXTB4[0] CXTB3[1]    CXTB3[0]  CXTB2[1] CXTB2[0]  CXTB1[1]
      ]                                                                            ]
      CXT[B7B5                                                                     CXTB5[0
0x4A           Reserved Reserved CXTB7[1]    CXTB7[0]  CXTB6[1] CXTB6[0]  CXTB5[1]
      ]                                                                            ]
                        NSHHPE BRIDGOF                                             Reserve
0x4B  MISC1    RPDNEN                        Reserved  Reserved CPWMEN Reserved
                        N         F                                                d
                                                       PNDLSL[1 PNDLSL[            Reserve
0x4C  MISC2    Reserved Reserved Reserved    PNDLSL[2]                    Reserved
                                                       ]        0]                 d
0x4D  Reserved
0x4E  Reserved
0x4F  Reserved
0x50  Reserved
0x51  Reserved
0x52  Reserved
0x53  Reserved
0x54  Reserved
0x55  Reserved
0x56  Reserved
                                     DocID022033 Rev 2                                 33/89
                                                                                             89


Register description                                                                                STA369BW
8.1        Configuration register A (addr 0x00)
                 D7           D6        D5            D4           D3           D2          D1           D0
               FDRB         TWAB      TWRB           IR1          IR0          MCS2        MCS1         MCS0
                  0            1         1             0            0            0           1            1
8.1.1      Master clock select
                                            Table 10. Master clock select
               Bit        R/W     RST           Name          Description
                0         R/W      1            MCS0
                                                              Selects the ratio between the input I2S sampling
                1         R/W      1            MCS1
                                                              frequency and the input clock
                2         R/W      0            MCS2
           The STA369BW supports sampling rates of 32 kHz, 44.1 kHz, 48 kHz, 88.2 kHz, 96 kHz,
           176.4 kHz, and 192 kHz. Therefore the internal clock is:
                32.768 MHz for 32 kHz
                45.1584 MHz for 44.1 kHz, 88.2 kHz, and 176.4 kHz
                49.152 MHz for 48 kHz, 96 kHz, and 192 kHz
           The external clock frequency provided to the XTI pin must be a multiple of the input
           sampling frequency (fs).
           The relationship between the input clock and the input sampling rate is determined by both
           the MCSx and the IR (input rate) register bits. The MCSx bits determine the PLL factor
           generating the internal clock and the IR bit determines the oversampling ratio used
           internally.
                                           Table 11. Input sampling rates
              Input sampling rate
                                      IR                                   MCS[2:0]
                     fs (kHz)
                                               101         100          011        010        001        000
            32, 44.1, 48              00     576 * fs    128 * fs     256 * fs   384 * fs  512 * fs    768 * fs
            88.2, 96                  01       NA         64 * fs     128 * fs   192 * fs  256 * fs    384 * fs
            176.4, 192                1X       NA         32 * fs      64 * fs    96 * fs  128 * fs    192 * fs
34/89                                      DocID022033 Rev 2


STA369BW                                                                                 Register description
8.1.2    Interpolation ratio select
                                       Table 12. Internal interpolation ratio
             Bit     R/W      RST        Name                               Description
                                                   Selects internal interpolation ratio based on input I2S
             4:3     R/W       00       IR [1:0]
                                                   sampling frequency
         The STA369BW has variable interpolation (oversampling) settings such that internal
         processing and FFX output rates remain consistent. The first processing block interpolates
         by either 2-times or 1-time (pass-through) or provides a 2-times downsample. The
         oversampling ratio of this interpolation is determined by the IR bits.
                        Table 13. IR bit settings as a function of input sampling rate
              Input sampling rate fs (kHz)       IR                  1st stage interpolation ratio
                           32                    00                      2-times oversampling
                          44.1                   00                      2-times oversampling
                           48                    00                      2-times oversampling
                          88.2                   01                           Pass-through
                           96                    01                           Pass-through
                         176.4                   10                      2-times downsampling
                          192                    10                      2-times downsampling
8.1.3    Thermal warning recovery bypass
                                  Table 14. Thermal warning recovery bypass
            Bit     R/W      RST           Name                                Description
                                                         0: Thermal warning recovery enabled
             5      R/W        1           TWRB
                                                         1: Thermal warning recovery disabled
         If the thermal warning adjustment is enabled (TWAB = 0), then the thermal warning recovery
         determines if the -3 dB output limit is removed when thermal warning is negative.
         If TWRB = 0 and TWAB = 0, then when a thermal warning disappears the -3 dB output limit
         is removed and the gain is added back to the system. If TWRB = 1 and TWAB = 0, then
         when a thermal warning disappears the -3 dB output limit remains until TWRB is changed to
         zero or the device is reset.
8.1.4    Thermal warning adjustment bypass
                                 Table 15. Thermal warning adjustment bypass
            Bit     R/W      RST           Name                                Description
                                                         0: Thermal warning adjustment enabled
             6      R/W        1           TWAB
                                                         1: Thermal warning adjustment disabled
                                          DocID022033 Rev 2                                                35/89
                                                                                                                 89


Register description                                                                               STA369BW
           The on-chip STA369BW power output block provides feedback to the digital controller using
           inputs to the power control block. Input TWARN is used to indicate a thermal warning
           condition. When TWARN is asserted (set to 0) for a period of time greater than 400 ms, the
           power control block forces a -3 dB output limit (determined by TWOCL in the coefficient
           RAM) to the modulation limit in an attempt to eliminate the thermal warning condition. Once
           the thermal warning output limit adjustment is applied, it remains in this state until reset,
           unless FDRB = 0.
8.1.5      Fault detect recovery bypass
                                       Table 16. Fault detect recovery bypass
             Bit      R/W       RST          Name                                Description
                                                           0: fault detect recovery enabled
               7      R/W        0           FDRB
                                                           1: fault detect recovery disabled
           The on-chip STA369BW power output block provides feedback to the digital controller using
           inputs to the power control block. The FAULT input is used to indicate a fault condition
           (either overcurrent or thermal). When FAULT is asserted (set to 0), the power control block
           attempts a recovery from the fault by asserting the tri-state output (setting it to 0 which
           directs the power output block to begin recovery), holds it at 0 for period of time in the range
           of 0.1 ms to 1 second as defined by the fault-detect recovery constant register (FDRC
           registers 0x29-0x2A), then toggles it back to 1. This sequence is repeated as long as the
           fault indication exists. This feature is enabled by default but can be bypassed by setting the
           FDRB control bit to 1.
8.2        Configuration register B (addr 0x01)
                 D7          D6           D5          D4            D3           D2           D1          D0
                C2IM        C1IM        DSCKE        SAIFB         SAI3         SAI2         SAI1        SAI0
                  1           0            0           0             0            0            0           0
8.2.1      Serial audio input interface format
                                        Table 17. Serial audio input interface
             Bit      R/W       RST          Name                                Description
               0      R/W        0            SAI0
               1      R/W        0            SAI1         Determines the interface format of the input serial
               2      R/W        0            SAI2         digital audio interface
               3      R/W        0            SAI3
36/89                                        DocID022033 Rev 2


STA369BW                                                                               Register description
8.2.2    Serial data interface
         The STA369BW audio serial input was designed to interface with standard digital audio
         components and to accept a number of serial data formats. The STA369BW always acts as
         the slave when receiving audio input from standard digital audio components. Serial data for
         two channels is provided using three inputs: left/right clock LRCKI, serial clock BICKI, and
         serial data 1 and 2 SDI12.
         The SAI bits (D3 to D0) and the SAIFB bit (D4) are used to specify the serial data format.
         The default serial data format is I2S, MSB-first. Available formats are shown in the tables
         that follow.
8.2.3    Serial data first bit
                                         Table 18. Serial data first bit
                     SAIFB                                            Format
                         0            MSB-first
                         1            LSB-first
                   Table 19. Support serial audio input formats for MSB-first (SAIFB = 0)
                   BICKI           SAI [3:0]     SAIFB                        Interface format
                                     0000          0        I2S 15-bit data
                   32 * fs
                                     0001          0        Left/right-justified 16-bit data
                                     0000          0        I2S 16 to 23-bit data
                                     0001          0        Left-justified 16 to 24-bit data
                                     0010          0        Right-justified 24-bit data
                   48 * fs
                                     0110          0        Right-justified 20-bit data
                                     1010          0        Right-justified 18-bit data
                                     1110          0        Right-justified 16-bit data
                                     0000          0        I2S 16 to 24-bit data
                                     0001          0        Left-justified 16 to 24-bit data
                                     0010          0        Right-justified 24-bit data
                   64 * fs
                                     0110          0        Right-justified 20-bit data
                                     1010          0        Right-justified 18-bit data
                                     1110          0        Right-justified 16-bit data
                                         DocID022033 Rev 2                                            37/89
                                                                                                            89


Register description                                                                             STA369BW
                   Table 20. Supported serial audio input formats for LSB-first (SAIFB = 1)
                    BICKI             SAI [3:0]     SAIFB                       Interface format
                                        1100          1       I2S 15-bit data
                    32 * fs
                                        1110          1       Left/right-justified 16-bit data
                                        0100          1       I2S 23-bit data
                                        0100          1       I2S 20-bit data
                                        1000          1       I2S 18-bit data
                                        1100          1       LSB first I2S 16-bit data
                                        0001          1       Left-justified 24-bit data
                                        0101          1       Left-justified 20-bit data
                    48 * fs
                                        1001          1       Left-justified 18-bit data
                                        1101          1       Left-justified 16-bit data
                                        0010          1       Right-justified 24-bit data
                                        0110          1       Right-justified 20-bit data
                                        1010          1       Right-justified 18-bit data
                                        1110          1       Right-justified 16-bit data
                                        0000          1       I2S 24-bit data
                                        0100          1       I2S 20-bit data
                                        1000          1       I2S 18-bit data
                                        1100          1       LSB first I2S 16-bit data
                                        0001          1       Left-justified 24-bit data
                                        0101          1       Left-justified 20-bit data
                    64 * fs
                                        1001          1       Left-justified 18-bit data
                                        1101          1       Left-justified 16-bit data
                                        0010          1       Right-justified 24-bit data
                                        0110          1       Right-justified 20-bit data
                                        1010          1       Right-justified 18-bit data
                                        1110          1       Right-justified 16-bit data
           To make the STA369BW work properly, the serial audio interface LRCKI clock must be
           synchronous to the PLL output clock. It means that:
            the frequency of PLL clock / frequency of LRCKI = N ±4 cycles,
                where N depends on the settings in Table 13 on page 35
            the PLL must be locked.
           If these two conditions are not met, and the IDE bit (reg 0x05 bit 2) is set to 1, the
           STA369BW will immediately mute the I2S PCM data out (provided to the processing block)
           and it will freeze any active processing task.
           To avoid any audio side effects (like pop noise), it is strongly recommended to soft-mute any
           audio streams flowing into the STA369BW data path before the desynchronization event
38/89                                       DocID022033 Rev 2


STA369BW                                                                              Register description
         happens. At the same time any processing related to the I2C configuration should be issued
         only after the serial audio interface and the internal PLL are synchronous again.
Note:    Any mute or volume change causes some delay in the completion of the I2C operation due
         to the soft-volume feature. The soft-volume phase change must be finished before any clock
         desynchronization.
8.2.4    Delay serial clock enable
                                       Table 21. Delay serial clock enable
           Bit      R/W     RST            Name                              Description
                                                        0: No serial clock delay
             5      R/W       0           DSCKE         1: Serial clock delay by 1 core clock cycle to tolerate
                                                        anomalies in some I2S master devices
8.2.5    Channel input mapping
                                        Table 22. Channel input mapping
           Bit      R/W     RST            Name                              Description
                                                        0: Processing channel 1 receives left I2S input
             6      R/W        0           C1IM
                                                        1: Processing channel 1 receives right I2S input
                                                        0: Processing channel 2 receives left I2S input
             7      R/W        1           C2IM
                                                        1: Processing channel 2 receives right I2S input
         Each channel received via I2S can be mapped to any internal processing channel via the
         channel input mapping registers. This allows for flexibility in processing. The default settings
         of these registers map each I2S input channel to its corresponding processing channel.
                                          DocID022033 Rev 2                                                39/89
                                                                                                                 89


Register description                                                                                    STA369BW
8.3        Configuration register C (addr 0x02)
                       D7         D6           D5           D4           D3          D2           D1           D0
                     OCRB                     CSZ3         CSZ2         CSZ1        CSZ0         OM1          OM0
                        1                       0            1            1           1            1            1
8.3.1      FFX power output mode
                                               Table 23. FFX power output mode
                Bit          R/W    RST            Name                              Description
                     0       R/W     1             OM0
                                                                 Selects configuration of FFX output
                     1       R/W     1             OM1
           The FFX power output mode selects how the FFX output timing is configured.
           Different power devices use different output modes.
                                                     Table 24. Output modes
                          OM[1,0]                                    Output stage mode
                            00         Drop compensation
                            01         Discrete output stage - tapered compensation
                            10         Full power mode
                            11         Variable drop compensation (CSZx bits)
8.3.2      FFX compensating pulse size register
                                         Table 25. FFX compensating pulse size bits
                Bit          R/W    RST            Name                              Description
                     2       R/W     1             CSZ0
                     3       R/W     1             CSZ1          When OM[1,0] = 11, this register determines the size
                                                                 of the FFX compensating pulse from 0 clock ticks to
                     4       R/W     1             CSZ2          15 clock ticks.
                     5       R/W     0             CSZ3
            Table 6:
                                              Table 26. Compensating pulse size
                         CSZ[3:0]                                Compensating pulse size
                           0000       0 ns (0 tick) compensating pulse size
                           0001       20 ns (1 tick) clock period compensating pulse size
                            …         …
                           1111       300 ns (15 tick) clock period compensating pulse size
40/89                                             DocID022033 Rev 2


STA369BW                                                                            Register description
8.3.3    Overcurrent warning detect adjustment bypass
                                     Table 27. Overcurrent warning bypass
            Bit     R/W       RST          Name                             Description
                                                        0: Overcurrent warning adjustment enabled
             7      R/W        1           OCRB
                                                        1: Overcurrent warning adjustment disabled
         The OCWARN input is used to indicate an overcurrent warning condition. When OCWARN
         is asserted (set to 0), the power control block forces an adjustment to the modulation limit
         (default is -3 dB) in an attempt to eliminate the overcurrent warning condition. Once the
         overcurrent warning volume adjustment is applied, it remains in this state until a reset
         occurs. The level of adjustment can be changed via the TWOCL (thermal warning/over
         current limit) setting which is address 0x37 of the user-defined coefficient RAM.
8.4      Configuration register D (addr 0x03)
               D7          D6           D5          D4          D3          D2           D1          D0
              SME         ZDE          DRC         BQL         PSL         DSPB        DEMP         HPB
                0           1            0           0           0           0            0           0
8.4.1    High-pass filter bypass
                                         Table 28. High-pass filter bypass
            Bit     R/W       RST          Name                             Description
                                                        Setting of one bypasses internal AC coupling digital
             0      R/W        0            HPB
                                                        high-pass filter
         The STA369BW features an internal digital high-pass filter for the purpose of AC coupling.
         The purpose of this filter is to prevent DC signals from passing through an FFX amplifier. DC
         signals can cause speaker damage. When HPB = 0, this filter is enabled.
8.4.2    De-emphasis
                                              Table 29. De-emphasis
            Bit     R/W       RST          Name                             Description
                                                        0: No de-emphasis
             1      R/W        0           DEMP
                                                        1: Enable de-emphasis on all channels
                                           DocID022033 Rev 2                                            41/89
                                                                                                              89


Register description                                                                             STA369BW
8.4.3      DSP bypass
                                                Table 30. DSP bypass
             Bit     R/W       RST          Name                                Description
                                                         0: Normal operation
              2      R/W         0          DSPB
                                                         1: Bypass of biquad and bass/treble functions
           Setting the DSPB bit to 1 bypasses the EQ function of the STA369BW.
8.4.4      Post-scale link
                                              Table 31. Post-scale link
             Bit     R/W       RST          Name                                Description
                                                         0: Each channel uses individual post-scale value
              3      R/W         0           PSL
                                                         1: Each channel uses channel 1 post-scale value
           Post-scale functionality can be used for power-supply error correction. For multi-channel
           applications running off the same power-supply, the post-scale values can be linked to the
           value of channel 1 for ease of use and to update the values faster.
8.4.5      Biquad coefficient link
                                          Table 32. Biquad coefficient link
             Bit     R/W       RST          Name                                Description
                                                         0: Each channel uses coefficient values
              4      R/W         0           BQL
                                                         1: Each channel uses channel 1 coefficient values
           For ease of use, all channels can use the biquad coefficients loaded into the channel-1
           coefficient RAM space by setting the BQL bit to 1. Therefore, any EQ updates only have to
           be performed once.
8.4.6      Dynamic range compression/anti-clipping bit
                             Table 33. Dynamic range compression/anti-clipping bit
             Bit     R/W       RST         Name                               Description
                                                      0: Limiters act in anti-clipping mode
              5      R/W         0         DRC
                                                      1: Limiters act in dynamic range compression mode
           Both limiters can be used in one of two ways, anti-clipping or dynamic range compression.
           When used in anti-clipping mode, the limiter threshold values are constant and dependent
           on the limiter settings. In dynamic range compression mode the limiter threshold values vary
           with the volume settings, allowing a nighttime listening mode that provides a reduction in the
           dynamic range regardless of the volume level.
42/89                                       DocID022033 Rev 2


STA369BW                                                                               Register description
8.4.7    Zero-detect mute enable
                                       Table 34. Zero-detect mute enable
             Bit      R/W      RST         Name                               Description
              6       R/W       1           ZDE         Setting of 1 enables the automatic zero-detect mute
         Setting the ZDE bit enables the zero-detect automatic mute. The zero-detect circuit looks at
         the data for each processing channel at the output of the crossover (bass management)
         filter. If any channel receives 2048 consecutive zero value samples (regardless of fs) then
         that individual channel is muted if this function is enabled.
8.4.8    Submix mode enable
                                          Table 35. Submix mode enable
             Bit      R/W     RST         Name                               Description
                                                      0: Submix into left/right disabled
              7       R/W       0          SME
                                                      1: Submix into left/right enabled
8.5      Configuration register E (addr 0x04)
                 D7         D6         D5          D4           D3            D2          D1           D0
                SVE        ZCE        DCCV        PWMS         AME           NSBW        MPC         MPCV
                  1          1          0           0            0             0           1            0
8.5.1    Max power correction variable
                                    Table 36. Max power correction variable
             Bit      R/W      RST         Name                               Description
                                                        0: Use standard MPC coefficient
              0       R/W       0          MPCV
                                                        1: Use MPCC bits for MPC coefficient
8.5.2    Max power correction
                                         Table 37. Max power correction
             Bit      R/W      RST         Name                               Description
                                                        Setting of 1 enables power bridge correction for THD
              1       R/W       1           MPC
                                                        reduction near maximum power output.
         Setting the MPC bit turns on special processing that corrects the STA369BW power device
         at high power. This mode should lower the THD+N of a full FFX system at maximum power
         output and slightly below. If enabled, MPC is operational in all output modes except tapered
         (OM[1,0] = 01) and binary. When OCFG = 00, MPC will not effect channels 3 and 4, the line-
         out channels.
                                           DocID022033 Rev 2                                              43/89
                                                                                                                89


Register description                                                                             STA369BW
8.5.3      Noise-shaper bandwidth selection
                                  Table 38. Noise-shaper bandwidth selection
             Bit    R/W     RST        Name                               Description
                                                     1: Third order NS
              2     R/W      0         NSBW
                                                     0: Fourth order NS
8.5.4      AM mode enable
                                            Table 39. AM mode enable
             Bit    R/W     RST        Name                               Description
                                                     0: Normal FFX operation.
              3     R/W      0          AME
                                                     1: AM reduction mode FFX operation
           The STA369BW features an FFX processing mode that minimizes the amount of noise
           generated in the frequency range of AM radio. This mode is intended for use when FFX is
           operating in a device with an active AM tuner. The SNR of the FFX processing is reduced to
           approximately 83 dB in this mode, which is still greater than the SNR of AM radio.
8.5.5      PWM speed mode
                                           Table 40. PWM speed mode
             Bit    R/W     RST        Name                               Description
                                                     0: Normal speed (384 kHz) all channels
              4     R/W      0         PWMS
                                                     1: Odd speed (341.3 kHz) all channels
8.5.6      Distortion compensation variable enable
                              Table 41. Distortion compensation variable enable
             Bit    R/W     RST        Name                               Description
                                                     0: Use preset DC coefficient
              5     R/W      0         DCCV
                                                     1: Use DCC coefficient
8.5.7      Zero-crossing volume enable
                                     Table 42. Zero-crossing volume enable
             Bit    R/W     RST       Name                               Description
                                                  1: Volume adjustments only occur at digital zero-crossings
              6     R/W      1         ZCE
                                                  0: Volume adjustments occur immediately
           The ZCE bit enables zero-crossing volume adjustments. When volume is adjusted on digital
           zero-crossings, no clicks are audible.
44/89                                     DocID022033 Rev 2


STA369BW                                                                                Register description
8.5.8    Soft-volume update enable
                                     Table 43. Soft-volume update enable
          Bit      R/W   RST           Name                                 Description
                                                      1: Volume adjustments ramp according to SVR settings
           7       R/W      1           SVE
                                                      0: Volume adjustments occur immediately
8.6      Configuration register F (addr 0x05)
              D7         D6           D5             D4           D3            D2          D1           D0
            EAPD        PWDN         ECLE           LDTE         BCLE          IDE        OCFG1        OCFG0
               0          1            0              1            1             1           0            0
8.6.1    Output configuration
                                         Table 44. Output configuration
          Bit       R/W     RST           Name                                 Description
           0        R/W       0          OCFG0
                                                           Selects the output configuration
           1        R/W       0          OCFG1
                               Table 45. Output configuration engine selection
          OCFG[1:0]                         Output configuration                               Config pin
                         2-channel (full-bridge) power, 2-channel data-out:
                         1A/1B  1A/1B
                         2A/2B  2A/2B
                 00                                                                                0
                         LineOut1  3A/3B
                         LineOut2  4A/4B
                         Line Out Configuration determined by LOC register
                         2(half-bridge).1(full-bridge) on-board power:
                         1A  1A            Binary 0 °
                         2A  1B            Binary 90°
                 01                                                                                0
                         3A/3B  2A/2B Binary 45°
                         1A/B  3A/B        Binary 0°
                         2A/B  4A/B        Binary 90°
                         2-channel (full-bridge) power, 1-channel FFX:
                         1A/1B  1A/1B
                 10      2A/2B  2A/2B                                                             0
                         3A/3B  3A/3B
                         EAPDEXT and TWARNEXT Active
                         1-channel mono parallel:
                         3A  1A/1B       w/ C3BO 45°
                 11      3B  2A/2B       w/ C3BO 45°                                              1
                         1A/1B  3A/3B
                         2A/2B  4A/4B
                                          DocID022033 Rev 2                                                 45/89
                                                                                                                  89


Register description                                                                                       STA369BW
Note:      To the left of the arrow is the processing channel. When using channel output mapping, any
           of the three processing channel outputs can be used for any of the three inputs.
                                         Figure 21. OCFG = 00 (default value)
                                                           Half       OUT1A
                                                          Bridge
                                                                                      Channel 1
                                                           Half
                                                          Bridge      OUT1B
                                                           Half       OUT2A
                                                          Bridge
                                                                                      Channel 2
                                                           Half
                                                          Bridge      OUT2B
                                                                     OUT3A               LineOut1
                                                                     OUT3B     LPF
                                                                     OUT4A               LineOut2
                                                                     OUT4B     LPF
                                                                                                             AM045185v1
                                                Figure 22. OCFG = 01
                                                                Half                             Channel 1
                                                              Bridge
                                                                           OUT1A
                                                                Half                             Channel 2
                                                              Bridge       OUT1B
                                                                Half       OUT2A
                                                              Bridge
                                                                                              Channel 3
                                                                Half
                                                              Bridge       OUT2B
                                                                                                             AM045186v1
                                                Figure 23. OCFG = 10
                                                    Half      OUT1A
                                                   Bridge
                                                                             Channel 1
                                                    Half
                                                   Bridge     OUT1B
                                                    Half      OUT2A
                                                   Bridge
                                                                             Channel 2
                                                    Half
                                                   Bridge     OUT2B
                                                            OUT3A
                                                            OUT3B
                                                                      Power            Channel 3
                                                                      Device
                                                             EAPD
                                                                                                             AM045187v1
46/89                                       DocID022033 Rev 2


STA369BW                                                                                     Register description
                                              Figure 24. OCFG = 11
                                                                 OUT1A
                                                         Half
                                                        Bridge
                                                         Half
                                                                    OUT1B
                                                        Bridge
                                                                                   Channel 3
                                                         Half
                                                        Bridge      OUT2A
                                                         Half
                                                        Bridge   OUT2B
                                                                 OUT3A
                                                                          Channel 1
                                                                 OUT3B
                                                                 OUT4A
                                                                          Channel 2
                                                                 OUT4B
                                                                                                        AM045188v1
         The STA369BW can be configured to support different output configurations. For each
         PWM output channel a PWM slot is defined. A PWM slot is always 1 / (8 * fs) seconds
         length. The PWM slot defines the maximum extension for the PWM rising and falling edge,
         that is, the rising edge as well as the falling edge cannot range outside the PWM slot
         boundaries.
                                      Figure 25. Output mapping scheme
                                        FFX1A
                                                               OUT1A                              OUT1A
                                       FFX1 B
                                        FFX2 A                 OUT1B                              OUT1B
                                        FFX 2B
                         FFX ™                                                   Power
                       modulator       FFX3 A                  OUT2A            Bridge            OUT2A
                                       FFX3B
                                       FFX4 A                  OUT2B                              OUT2B
                                       FFX 4B
                                                 REMAP
                                                               OUT3A
                                                               OUT3B
                                                               OUT4A
                                                               OUT4B
                                                                                                        AM045189v1
                                          DocID022033 Rev 2                                                  47/89
                                                                                                                   89


Register description                                                                        STA369BW
           For each configuration the PWM signals from the digital driver are mapped in different ways
           to the power stage.
           2.0 channels, two full-bridges (OCFG = 00)
                FFX1A -> OUT1A
                FFX1B -> OUT1B
                FFX2A -> OUT2A
                FFX2B -> OUT2B
                FFX3A -> OUT3A
                FFX3B -> OUT3B
                FFX4A -> OUT4A
                FFX4B -> OUT4B
                FFX1A/1B configured as ternary
                FFX2A/2B configured as ternary
                FFX3A/3B configured as lineout ternary
                FFX4A/4B configured as lineout ternary
           On channel 3 line-out (LOC bits = 00) the same data as channel 1 processing is sent. On
           channel 4 line-out (LOC bits = 00) the same data as channel 2 processing is sent. In this
           configuration, neither volume control nor EQ has any effect on channels 3 and 4.
           In this configuration the PWM slot phase is the following as shown in Figure 26.
                                 Figure 26. 2.0 channels (OCFG = 00) PWM slots
                               OUT1A
                               OUT1B
                               OUT2A
                               OUT2B
                               OUT3A
                               OUT3B
                               OUT4A
                               OUT4B
                                                                                              AM045190v1
48/89                                     DocID022033 Rev 2


STA369BW                                                                        Register description
         2.1 channels, two half-bridges + one full-bridge (OCFG = 01)
              FFX1A -> OUT1A
              FFX2A -> OUT1B
              FFX3A -> OUT2A
              FFX3B -> OUT2B
              FFX1A -> OUT3A
              FFX1B -> OUT3B
              FFX2A -> OUT4A
              FFX2B -> OUT4B
              FFX1A/1B configured as binary
              FFX2A/2B configured as binary
              FFX3A/3B configured as binary
              FFX4A/4B is not used
         In this configuration, channel 3 has full control (volume, EQ, etc…). On OUT3/OUT4
         channels the channel 1 and channel 2 PWM are replicated.
         In this configuration the PWM slot phase is the following as shown in Figure 27.
                               Figure 27. 2.1 channels (OCFG = 01) PWM slots
                          OUT1A
                           OUT1B
                          OUT2A
                          OUT2B
                          OUT3A
                          OUT3B
                          OUT4A
                          OUT4B
                                                                                           AM045191v1
                                         DocID022033 Rev 2                                      49/89
                                                                                                      89


Register description                                                                        STA369BW
           2.1 channels, two full-bridges + one external full-bridge (OCFG = 10)
                FFX1A -> OUT1A
                FFX1B -> OUT1B
                FFX2A -> OUT2A
                FFX2B -> OUT2B
                FFX3A -> OUT3A
                FFX3B -> OUT3B
                EAPD -> OUT4A
                TWARN -> OUT4B
                FFX1A/1B configured as ternary
                FFX2A/2B configured as ternary
                FFX3A/3B configured as ternary
                FFX4A/4B is not used
           In this configuration, channel 3 has full control (volume, EQ, etc…). On OUT4 channel the
           external bridge control signals are muxed.
           In this configuration the PWM slot phase is the following as shown in Figure 28.
                                 Figure 28. 2.1 channels (OCFG = 10) PWM slots
                         OUT1A
                         OUT1B
                         OUT2A
                         OUT2B
                         OUT3A
                         OUT3B
                                                                                              AM045192v1
50/89                                      DocID022033 Rev 2


STA369BW                                                                            Register description
8.6.2    Invalid input detect mute enable
                                 Table 46. Invalid input detect mute enable
           Bit     R/W      RST     Name                               Description
            2      R/W        1       IDE     Setting of 1 enables the automatic invalid input detect mute
         Setting the IDE bit enables this function, which looks at the input I2S data and automatically
         mutes if the signals are perceived as invalid.
8.6.3    Binary output mode clock loss detection
                             Table 47. Binary output mode clock loss detection
           Bit     R/W      RST          Name                              Description
            3      R/W        1          BCLE          Binary output mode clock loss detection enable
         The BCLE bit detects loss of input MCLK in binary mode and will output 50% duty cycle.
8.6.4    LRCK double trigger protection
                                  Table 48. LRCK double trigger protection
           Bit     R/W      RST          Name                              Description
            4      R/W        1          LDTE          LRCLK double trigger protection enable
         The LDTE bit actively prevents double triggering of the LRCLK.
8.6.5    Auto EAPD on clock loss
                                     Table 49. Auto EAPD on clock loss
           Bit     R/W      RST          Name                              Description
            5      R/W        0          ECLE          Auto EAPD on clock loss
         When active, the ECLE bit issues a power-stage device power-down signal (EAPD) on
         clock loss detection.
8.6.6    IC power-down
                                           Table 50. IC power-down
           Bit     R/W      RST          Name                              Description
                                                       0: IC power-down low-power condition
            7      R/W        1          PWDN
                                                       1: IC normal operation
         The PWDN register is used to place the IC in a low-power state. When PWDN is written
         as 0, the output begins a soft-mute. After the mute condition is reached, EAPD is asserted
                                        DocID022033 Rev 2                                              51/89
                                                                                                             89


Register description                                                                               STA369BW
           to power down the power-stage, then the master clock to all internal hardware except the
           I2C block is gated. This places the IC in a very low power consumption state.
8.6.7      External amplifier power-down
                                     Table 51. External amplifier power-down
             Bit      R/W      RST            Name                                Description
                                                              0: External power stage power-down active
              7       R/W       0             EAPD
                                                              1: Normal operation
           The EAPD register directly disables/enables the internal power circuitry.
           When EAPD = 0, the internal power section is placed in a low-power state (disabled). This
           register also controls the FFX4B/EAPD output pin when OCFG = 10.
8.7        Volume control registers (addr 0x06 - 0x0A)
8.7.1      Mute/line output configuration register
                D7          D6            D5           D4             D3          D2          D1          D0
               LOC1        LOC0        Reserved      Reserved        C3M         C2M         C1M        MMUTE
                 0           0             0            0              0           0           0           0
                                         Table 52. Line output configuration
                LOC[1:0]                                    Line output configuration
                    00         Line output fixed - no volume, no EQ
                    01         Line output variable - CH3 volume effects line output, no EQ
                    10         Line output variable with EQ - CH3 volume effects line output
           Line output is only active when OCFG = 00. In this case LOC determines the line output
           configuration. The source of the line output is always the channel 1 and 2 inputs.
8.7.2      Master volume register
                D7          D6            D5           D4             D3          D2          D1          D0
                MV7         MV6          MV5           MV4           MV3         MV2         MV1         MV0
                 1           1             1            1              1           1           1           1
8.7.3      Channel 1 volume
                D7          D6            D5           D4             D3          D2          D1          D0
               C1V7        C1V6         C1V5          C1V4          C1V3         C1V2        C1V1        C1V0
                 0           1             1            0              0           0           0           0
52/89                                        DocID022033 Rev 2


STA369BW                                                                        Register description
8.7.4    Channel 2 volume
               D7          D6         D5         D4         D3           D2         D1         D0
              C2V7        C2V6       C2V5       C2V4       C2V3         C2V2       C2V1      C2V0
                0           1          1          0          0            0          0          0
8.7.5    Channel 3 / line output volume
               D7          D6         D5         D4         D3           D2         D1         D0
              C3V7        C3V6       C3V5       C3V4       C3V3         C3V2       C3V1      C3V0
                0           1          1          0          0            0          0          0
         The volume structure of the STA369BW consists of individual volume registers for each
         channel and a master volume register that provides an offset to each channel’s volume
         setting. The individual channel volumes are adjustable in 0.5 dB steps from +48 dB
         to -80 dB.
         As an example if C3V = 0x00 or +48 dB and MV = 0x18 or -12 dB, then the total gain for
         channel 3 = +36 dB.
         The master mute, when set to 1, mutes all channels at once, whereas the individual channel
         mute (CxM) mutes only that channel. Both the master mute and the channel mutes provide
         a “soft mute” with the volume ramping down to mute in 4096 samples from the maximum
         volume setting at the internal processing rate (approximately 96 kHz).
         A “hard (instantaneous) mute” can be obtained by programming a value of 0xFF (255) to
         any channel volume register or the master volume register. When volume offsets are
         provided via the master volume register, any channel whose total volume is less than -80 dB
         is muted.
         All changes in volume take place at zero-crossings when ZCE = 1 (Configuration register E
         (addr 0x04)) on a per-channel basis as this creates the smoothest possible volume
         transitions. When ZCE = 0, volume updates occur immediately.
                           Table 53. Master volume offset as a function of MV[7:0]
                      MV[7:0]                          Volume offset from channel value
                  00000000 (0x00)                                    0 dB
                  00000001 (0x01)                                   -0.5 dB
                  00000010 (0x02)                                    -1 dB
                        …                                              …
                  01001100 (0x4C)                                   -38 dB
                        …                                              …
                  11111110 (0xFE)                                 -127.5 dB
                  11111111 (0xFF)                              Hard master mute
                                         DocID022033 Rev 2                                        53/89
                                                                                                        89


Register description                                                                              STA369BW
                                 Table 54. Channel volume as a function of CxV[7:0]
                        CxV[7:0]                                            Volume
                    00000000 (0x00)                                          +48 dB
                    00000001 (0x01)                                        +47.5 dB
                    00000010 (0x02)                                          +47 dB
                           …                                                    …
                    01011111 (0x5F)                                         +0.5 dB
                    01100000 (0x60)                                           0 dB
                    01100001 (0x61)                                          -0.5 dB
                           …                                                    …
                    11010111 (0xD7)                                         -59.5 dB
                    11011000 (0xD8)                                          -60 dB
                    11011001 (0xD9)                                          -61 dB
                    11011010 (0xDA)                                          -62 dB
                           …                                                    …
                    11101100 (0xEC)                                          -80 dB
                    11101101 (0xED)                                    Hard channel mute
                           …                                                    …
                     11111111 (0xFF)                                   Hard channel mute
8.8        Audio preset registers (addr 0x0B and 0x0C)
8.8.1      Audio preset register 1 (addr 0x0B)
                D7            D6          D5            D4          D3            D2       D1         D0
              Reserved     Reserved     AMGC[1]      AMGC[0]     Reserved       Reserved Reserved   Reserved
                 0             0           0             0           0             0        0          0
           Using AMGC[3:0] bits, attack and release thresholds and rates are automatically configured
           to properly fit application specific configurations. AMGC[3:2] is defined in register EQ
           coefficients and DRC configuration register (addr 0x31) on page 72.
           The AMGC[1:0] bits behave in two different ways depending on the value of AMGC[3:2].
           When this value is 00, then bits AMGC[1:0] are defined as in Table 55.
               Table 55. Audio preset gain compression/limiters selection for AMGC[3:2] = 00
                     AMGC[1:0]                                             Mode
                         00              User-programmable GC
                         01              AC no clipping 2.1
                         10              AC limited clipping (10%) 2.1
                         11              DRC nighttime listening mode 2.1
54/89                                        DocID022033 Rev 2


STA369BW                                                                               Register description
8.8.2    Audio preset register 2 (addr 0x0C)
              D7          D6           D5          D4           D3          D2             D1          D0
             XO3         XO2          XO1         XO0         AMAM2       AMAM1          AMAM0       AMAME
               0           0            0           0            0           0              0           0
8.8.3    AM interference frequency switching
                             Table 56. AM interference frequency switching bits
          Bit     R/W       RST           Name                             Description
                                                      Audio preset AM enable
           0      R/W         0         AMAME         0: switching frequency determined by PWMS setting
                                                      1: switching frequency determined by AMAM settings
                        Table 57. Audio preset AM switching frequency selection
               AMAM[2:0]               48 kHz/96 kHz input fs               44.1 kHz/88.2 kHz input fs
                 000                   0.535 MHz - 0.720 MHz                  0.535 MHz - 0.670 MHz
                 001                   0.721 MHz - 0.900 MHz                  0.671 MHz - 0.800 MHz
                 010                   0.901 MHz - 1.100 MHz                  0.801 MHz - 1.000 MHz
                 011                   1.101 MHz - 1.300 MHz                  1.001 MHz - 1.180 MHz
                 100                   1.301 MHz - 1.480 MHz                  1.181 MHz - 1.340 MHz
                 101                   1.481 MHz - 1.600 MHz                  1.341 MHz - 1.500 MHz
                 110                   1.601 MHz - 1.700 MHz                  1.501 MHz - 1.700 MHz
8.8.4    Bass management crossover
                                   Table 58. Bass management crossover
          Bit     R/W        RST           Name                             Description
           4      R/W          0           XO0
                                                        Selects the bass-management crossover frequency.
           5      R/W          0           XO1          A 1st-order high-pass filter (channels 1 and 2) or a
           6      R/W          0           XO2          2nd-order low-pass filter (channel 3) at the selected
                                                        frequency is performed.
           7      R/W          0           XO3
                              Table 59. Bass management crossover frequency
                 XO[3:0]                                     Crossover frequency
                   0000              User-defined
                   0001              80 Hz
                   0010              100 Hz
                   0011              120 Hz
                                          DocID022033 Rev 2                                               55/89
                                                                                                                89


Register description                                                                           STA369BW
                         Table 59. Bass management crossover frequency (continued)
                     XO[3:0]                                  Crossover frequency
                      0100            140 Hz
                      0101            160 Hz
                      0110            180 Hz
                      0111            200 Hz
                      1000            220 Hz
                      1001            240 Hz
                      1010            260 Hz
                      1011            280 Hz
                      1100            300 Hz
                      1101            320 Hz
                      1110            340 Hz
                      1111            360 Hz
8.9        Channel configuration registers (addr 0x0E - 0x10)
                D7           D6        D5          D4           D3           D2          D1         D0
              C1OM1        C1OM0      C1LS1       C1LS0        C1BO        C1VPB       C1EQBP     C1TCB
                 0            0         0           0            0            0           0          0
                D7           D6        D5          D4           D3           D2          D1         D0
              C2OM1        C2OM0      C2LS1       C2LS0        C2BO        C2VPB       C2EQBP     C2TCB
                 0            1         0           0            0            0           0          0
                D7           D6        D5          D4           D3           D2          D1         D0
              C3OM1        C3OM0      C3LS1       C3LS0        C3BO        C3VPB      Reserved   Reserved
                 1            0         0           0            0            0           0          0
8.9.1      Tone control bypass
           Tone control (bass/treble) can be bypassed on a per-channel basis for channels 1 and 2.
                                          Table 60. Tone control bypass
                     CxTCB                                            Mode
                        0             Perform tone control on channel x - normal operation
                        1             Bypass tone control on channel x
8.9.2      EQ bypass
           EQ control can be bypassed on a per-channel basis for channels 1 and 2. If EQ control is
           bypassed on a given channel, the prescale and all filters (high-pass, biquads, de-emphasis,
           bass, treble in any combination) are bypassed for that channel.
56/89                                     DocID022033 Rev 2


STA369BW                                                                          Register description
                                              Table 61. EQ bypass
                  CxEQBP                                             Mode
                      0              Perform EQ on channel x - normal operation
                      1              Bypass EQ on channel x
8.9.3    Volume bypass
         Each channel contains an individual channel volume bypass. If a particular channel has
         volume bypassed via the CxVBP = 1 register, then only the channel volume setting for that
         particular channel affects the volume setting, the master volume setting will not affect that
         channel.
8.9.4    Binary output enable registers
         Each individual channel output can be set to output a binary PWM stream. In this mode
         output A of a channel is considered the positive output and output B is the negative inverse.
                                  Table 62. Binary output enable registers
                    CxBO                                             Mode
                      0              FFX 3-state output - normal operation
                      1              Binary output
8.9.5    Limiter select
         Limiter selection can be made on a per-channel basis according to the channel limiter select
         bits.
          .
                       Table 63. Channel limiter mapping as a function of CxLS bits
                 CxLS[1:0]                                 Channel limiter mapping
                     00             Channel has limiting disabled
                     01             Channel is mapped to limiter #1
                     10             Channel is mapped to limiter #2
8.9.6    Output mapping
         Output mapping can be performed on a per-channel basis according to the CxOM channel
         output mapping bits. Each input into the output configuration engine can receive data from
         any of the three processing channel outputs.
          .
                      Table 64. Channel output mapping as a function of CxOM bits
                 CxOM[1:0]                              Channel x output source from
                     00             Channel1
                     01             Channel 2
                     10             Channel 3
                                         DocID022033 Rev 2                                         57/89
                                                                                                         89


Register description                                                                 STA369BW
8.10       Tone control register (addr 0x11)
                 D7         D6        D5         D4          D3            D2    D1       D0
               TTC3        TTC2     TTC1        TTC0       BTC3          BTC2  BTC1     BTC0
                  0          1         1          1           0             1     1        1
8.10.1     Tone control
                     Table 65. Tone control boost/cut as a function of BTC and TTC bits
                BTC[3:0]/TTC[3:0]                                Boost/Cut
                      0000                                        -12 dB
                      0001                                        -12 dB
                       …                                             …
                      0111                                         -4 dB
                      0110                                         -2 dB
                      0111                                          0 dB
                      1000                                         +2 dB
                      1001                                         +4 dB
                       …                                             …
                      1101                                        +12 dB
                      1110                                        +12 dB
                      1111                                        +12 dB
8.11       Dynamic control registers (addr 0x12 - 0x15)
8.11.1     Limiter 1 attack/release rate
                 D7         D6        D5         D4          D3            D2    D1       D0
               L1A3        L1A2      L1A1       L1A0        L1R3          L1R2  L1R1     L1R0
                  0          1         1          0           1             0     1        0
8.11.2     Limiter 1 attack/release threshold
                 D7         D6        D5         D4          D3            D2    D1       D0
               L1AT3       L1AT2    L1AT1       L1AT0      L1RT3         L1RT2 L1RT1    L1RT0
                  0          1         1          0           1             0     0        1
8.11.3     Limiter 2 attack/release rate
                 D7         D6        D5         D4          D3            D2    D1       D0
               L2A3        L2A2      L2A1       L2A0        L2R3          L2R2  L2R1     L2R0
                  0          1         1          0           1             0     1        0
58/89                                    DocID022033 Rev 2


STA369BW                                                                          Register description
8.11.4   Limiter 2 attack/release threshold
               D7           D6         D5          D4           D3           D2        D1         D0
             L2AT3         L2AT2      L2AT1       L2AT0       L2RT3        L2RT2     L2RT1      L2RT0
                0            1          1           0            1            0         0          1
         The STA369BW includes two independent limiter blocks. The purpose of the limiters is to
         automatically reduce the dynamic range of a recording to prevent the outputs from clipping
         in anti-clipping mode or to actively reduce the dynamic range for a better listening
         environment such as a nighttime listening mode which is often needed for DVDs. The two
         modes are selected via the DRC bit in Configuration register E (addr 0x04) on page 43.
         Each channel can be mapped to either limiter or not mapped, meaning that the channel will
         clip when 0 dBfs is exceeded. Each limiter looks at the present value of each channel that is
         mapped to it, selects the maximum absolute value of all these channels, performs the
         limiting algorithm on that value, and then if needed adjusts the gain of the mapped channels
         in unison.
         The limiter attack thresholds are determined by the LxAT registers if EATHx[7] bits are set
         to 0, else the thresholds are determined by EATHx[6:0]. It is recommended in anti-clipping
         mode to set this to 0 dBfs, which corresponds to the maximum unclipped output power of an
         FFX amplifier. Since gain can be added digitally within the STA369BW, it is possible to
         exceed 0 dBfs or any other LxAT setting. When this occurs, the limiter, when active,
         automatically starts reducing the gain. The rate at which the gain is reduced when the attack
         threshold is exceeded is dependent upon the attack rate register setting for that limiter. Gain
         reduction occurs on a peak-detect algorithm. Setting the EATHx[7] bits to 1 selects the
         anti-clipping mode.
         The limiter release thresholds are determined by the LxRT registers if ERTHx[7] bits are set
         to 0, else the thresholds are determined by ERTHx[6:0]. Setting the ERTHx[7] bits to 1
         automatically selects the anti-clipping mode. The release of the limiter, when the gain is
         again increased, is dependent on an RMS-detect algorithm. The output of the volume/limiter
         block is passed through an RMS filter. The output of this filter is compared to the release
         threshold, determined by the release threshold register. When the RMS filter output falls
         below the release threshold, the gain is again increased at a rate dependent upon the
         release rate register. The gain can never be increased past its set value and, therefore, the
         release only occurs if the limiter has already reduced the gain. The release threshold value
         can be used to set what is effectively a minimum dynamic range, this is helpful as
         overlimiting can reduce the dynamic range to virtually zero and cause program material to
         sound “lifeless”.
         In AC mode, the attack and release thresholds are set relative to full-scale. In DRC mode,
         the attack threshold is set relative to the maximum volume setting of the channels mapped
         to that limiter, and the release threshold is set relative to the maximum volume setting plus
         the attack threshold.
                                          DocID022033 Rev 2                                          59/89
                                                                                                           89


Register description                                                                          STA369BW
                           Figure 29. Basic limiter and volume flow diagram
                                                LIMITER               RMS
         GAIN / VOLUME
                                                  +
          INPUT                                                                        OUTPUT
                            GAIN              ATTENUATION          SATURATION
                                                                                               AM045193v1
 Table 66. Limiter attack rate as a function of           Table 67. Limiter release rate as a function
                      LxA bits                                            of LxR bits
  LxA[3:0]         Attack rate dB/ms                       LxR[3:0]      Release rate dB/ms
    0000                3.1584                              0000                0.5116
                                           Fast                                                    Fast
    0001                2.7072                               0001               0.1370
    0010                2.2560                               0010               0.0744
    0011                1.8048                               0011               0.0499
    0100                1.3536                               0100               0.0360
    0101                0.9024                               0101               0.0299
    0110                0.4512                               0110               0.0264
    0111                0.2256                               0111               0.0208
    1000                0.1504                               1000               0.0198
    1001                0.1123                              1001                0.0172
    1010                0.0902                               1010               0.0147
    1011                0.0752                               1011               0.0137
    1100                0.0645                               1100               0.0134
    1101                0.0564                               1101               0.0117
    1110                0.0501                               1110               0.0110
                                           Slow                                                    Slow
    1111                0.0451                               1111               0.0104
60/89                                      DocID022033 Rev 2


STA369BW                                                                        Register description
           Anti-clipping mode
   Table 68. Limiter attack threshold as a               Table 69. Limiter release threshold as a
      function of LxAT bits (AC-mode)                         function of LxRT bits (AC-mode)
 LxAT[3:0]         AC (dB relative to fs)               LxRT[3:0]          AC (dB relative to fs)
   0000                    -12                              0000                     -
   0001                    -10                              0001                  -29 dB
   0010                     -8                              0010                  -20 dB
   0011                     -6                              0011                  -16 dB
   0100                     -4                              0100                  -14 dB
   0101                     -2                              0101                  -12 dB
   0110                      0                              0110                  -10 dB
   0111                     +2                              0111                   -8 dB
   1000                     +3                              1000                   -7 dB
   1001                     +4                              1001                   -6 dB
   1010                     +5                              1010                   -5 dB
   1011                     +6                              1011                   -4 dB
   1100                     +7                              1100                   -3 dB
   1101                     +8                              1101                   -2 dB
   1110                     +9                              1110                   -1 dB
   1111                    +10                              1111                   -0 dB
                                          DocID022033 Rev 2                                       61/89
                                                                                                        89


Register description                                                                           STA369BW
            Dynamic range compression mode
    Table 70. Limiter attack threshold as a                 Table 71. Limiter release threshold as a as
      function of LxAT bits (DRC -mode)                         a function of LxRT bits (DRC-mode)
                                                                           DRC (db relative to volume +
 LxAT[3:0]       DRC (dB relative to volume)                 LxRT[3:0]
                                                                                      LxAT)
    0000                       -31                             0000                      -
    0001                       -29                              0001                  -38 dB
    0010                       -27                              0010                  -36 dB
    0011                       -25                              0011                  -33 dB
    0100                       -23                              0100                  -31 dB
    0101                       -21                              0101                  -30 dB
    0110                       -19                              0110                  -28 dB
    0111                       -17                              0111                  -26 dB
    1000                       -16                              1000                  -24 dB
    1001                       -15                              1001                  -22 dB
    1010                       -14                              1010                  -20 dB
    1011                       -13                              1011                  -18 dB
    1100                       -12                              1100                  -15 dB
    1101                       -10                              1101                  -12 dB
    1110                        -7                              1110                   -9 dB
    1111                        -4                              1111                   -6 dB
8.11.5      Limiter 1 extended attack threshold (addr 0x32)
                  D7           D6         D5          D4          D3         D2          D1          D0
               EATHEN1      EATH1[6]   EATH1[5]    EATH1[4]    EATH1[3]   EATH1[2]   EATH1[1]     EATH1[0]
                 TBD          TBD        TBD         TBD         TBD        TBD         TBD         TBD
            The extended attack threshold value is determined as follows:
                  attack threshold = -12 + EATH1 / 4
8.11.6      Limiter 1 extended release threshold (addr 0x33)
                  D7           D6         D5          D4          D3         D2          D1          D0
              ERTHEN1      ERTH1[6]    ERTH1[5]    ERTH1[4]    ERTH1[3]   ERTH1[2]   ERTH1[1]     ERTH1[0]
                 TBD          TBD        TBD         TBD         TBD        TBD         TBD         TBD
            The extended release threshold value is determined as follows:
                  release threshold = -12 + ERTH1 / 4
62/89                                        DocID022033 Rev 2


STA369BW                                                                        Register description
8.11.7   Limiter 2 extended attack threshold (addr 0x34)
              D7           D6         D5          D4         D3         D2          D1        D0
           EATHEN2      EATH2[6]   EATH2[5]    EATH2[4]   EATH2[3]   EATH2[2]    EATH2[1]  EATH2[0]
             TBD          TBD        TBD         TBD        TBD        TBD         TBD       TBD
         The extended attack threshold value is determined as follows:
              attack threshold = -12 + EATH2 / 4
8.11.8   Limiter 2 extended release threshold (addr 0x35)
              D7           D6         D5          D4         D3         D2          D1        D0
           ERTHEN2     ERTH2[6]    ERTH2[5]    ERTH2[4]   ERTH2[3]   ERTH2[2]    ERTH2[1]  ERTH2[0]
             TBD          TBD        TBD         TBD        TBD        TBD         TBD       TBD
         The extended release threshold value is determined as follows:
              release threshold = -12 + ERTH2 / 4
Note:    Attack/release threshold step is 0.125 dB in the range -12 dB to 0 dB.
8.12     User-defined coefficient control registers (addr 0x16 - 0x26)
8.12.1   Coefficient address register
              D7           D6         D5          D4         D3         D2          D1        D0
                                    CFA5        CFA4        CFA3      CFA2        CFA1      CFA0
                                       0           0          0          0           0         0
8.12.2   Coefficient b1 data register bits 23:16
              D7           D6         D5          D4         D3         D2          D1        D0
            C1B23        C1B22      C1B21       C1B20      C1B19      C1B18       C1B17     C1B16
               0            0          0           0          0          0           0         0
8.12.3   Coefficient b1 data register bits 15:8
              D7           D6         D5          D4         D3         D2          D1        D0
            C1B15        C1B14      C1B13       C1B12      C1B11      C1B10       C1B9      C1B8
               0            0          0           0          0          0           0         0
8.12.4   Coefficient b1 data register bits 7:0
              D7           D6         D5          D4         D3         D2          D1        D0
             C1B7        C1B6       C1B5        C1B4        C1B3      C1B2        C1B1      C1B0
               0            0          0           0          0          0           0         0
                                         DocID022033 Rev 2                                       63/89
                                                                                                       89


Register description                                                    STA369BW
8.12.5     Coefficient b2 data register bits 23:16
                D7      D6       D5         D4         D3    D2    D1       D0
               C2B23   C2B22    C2B21      C2B20      C2B19 C2B18 C2B17    C2B16
                 0       0        0          0          0     0     0        0
8.12.6     Coefficient b2 data register bits 15:8
                D7      D6       D5         D4         D3    D2    D1       D0
               C2B15   C2B14    C2B13      C2B12      C2B11 C2B10 C2B9     C2B8
                 0       0        0          0          0     0     0        0
8.12.7     Coefficient b2 data register bits 7:0
                D7      D6       D5         D4         D3    D2    D1       D0
               C2B7    C2B6     C2B5       C2B4       C2B3  C2B2  C2B1     C2B0
                 0       0        0          0          0     0     0        0
8.12.8     Coefficient a1 data register bits 23:16
                D7      D6       D5         D4         D3    D2    D1       D0
               C1B23   C1B22    C1B21      C1B20      C1B19 C1B18 C1B17    C1B16
                 0       0        0          0          0     0     0        0
8.12.9     Coefficient a1 data register bits 15:8
                D7      D6       D5         D4         D3    D2    D1       D0
               C3B15   C3B14    C3B13      C3B12      C3B11 C3B10 C3B9     C3B8
                 0       0        0          0          0     0     0        0
8.12.10    Coefficient a1 data register bits 7:0
                D7      D6       D5         D4         D3    D2    D1       D0
               C3B7    C3B6     C3B5       C3B4       C3B3  C3B2  C3B1     C3B0
                 0       0        0          0          0     0     0        0
8.12.11    Coefficient a2 data register bits 23:16
                D7      D6       D5         D4         D3    D2    D1       D0
               C4B23   C4B22    C4B21      C4B20      C4B19 C4B18 C4B17    C4B16
                 0       0        0          0          0     0     0        0
64/89                               DocID022033 Rev 2


STA369BW                                                                            Register description
8.12.12  Coefficient a2 data register bits 15:8
              D7           D6            D5         D4          D3         D2           D1         D0
             C4B15        C4B14        C4B13       C4B12      C4B11       C4B10        C4B9       C4B8
               0            0             0          0           0          0            0          0
8.12.13  Coefficient a2 data register bits 7:0
              D7           D6            D5         D4          D3         D2           D1         D0
             C4B7         C4B6          C4B5       C4B4        C4B3       C4B2         C4B1       C4B0
               0            0             0          0           0          0            0          0
8.12.14  Coefficient b0 data register bits 23:16
              D7           D6            D5         D4          D3         D2           D1         D0
             C5B23        C5B22        C5B21       C5B20      C5B19       C5B18        C5B17     C5B16
               0            0             0          0           0          0            0          0
8.12.15  Coefficient b0 data register bits 15:8
              D7           D6            D5         D4          D3         D2           D1         D0
             C5B15        C5B14        C5B13       C5B12      C5B11       C5B10        C5B9       C5B8
               0            0             0          0           0          0            0          0
8.12.16  Coefficient b0 data register bits 7:0
              D7           D6            D5         D4          D3         D2           D1         D0
             C5B7         C5B6          C5B5       C5B4        C5B3       C5B2         C5B1       C5B0
               0            0             0          0           0          0            0          0
8.12.17  Coefficient write/read control register
              D7           D6            D5         D4          D3         D2           D1         D0
                               Reserved                         RA         R1           WA         W1
                                  0                              0          0            0          0
         Coefficients for user-defined EQ, mixing, scaling, and bass management are handled
         internally in the STA369BW via RAM. Access to this RAM is available to the user via an I2C
         register interface. A collection of I2C registers are dedicated to this function. One contains a
         coefficient base address, five sets of three store the values of the 24-bit coefficients to be
         written or that were read, and one contains bits used to control the write/read of the
         coefficient(s) to/from RAM.
         Three different RAM banks are embedded in the STA369BW. The three banks are managed
         in paging mode using EQCFG register bits. They can be used to store different EQ settings.
         For speaker frequency compensation, a sampling frequency independent EQ must be
         implemented. Computing three different coefficients set for 32 kHz, 44.1kHz, 48 kHz and
         downloading them into the three RAM banks, it is possible to select the suitable RAM block
         depending on the incoming frequency with a simple I2C write operation in register 0x31.
                                            DocID022033 Rev 2                                         65/89
                                                                                                            89


Register description                                                                          STA369BW
           For example, in case of different input sources (different sampling rates), the three different
           sets of coefficients can be downloaded once at startup, and during normal play it is possible
           to switch among the three RAM blocks allowing faster operation, without any additional
           download from the microcontroller.
           To write the coefficients in a particular RAM bank, this bank must be selected first, writing
           bit 0 and bit 1 in register 0x31. Then the write procedure below can be used.
           Note that as soon as a RAM bank is selected, the EQ settings are automatically switched to
           the coefficients stored in the active RAM block.
Note:      The read write operation on RAM coefficients works only if RLCKI (pin29) is switching and
           stable (ref. Table 8, tLRJT timing) and PLL must be locked (ref bit D7 reg 0x2D).
           Reading a coefficient from RAM
           1.    Select the RAM block with register 0x31 bit1, bit0.
           2.    Write 6 bits of address to I2C register 0x16.
           3.    Write 1 to R1 bit in I2C address 0x26.
           4.    Read top 8 bits of coefficient in I2C address 0x17.
           5.    Read middle 8 bits of coefficient in I2C address 0x18.
           6.    Read bottom 8 bits of coefficient in I2C address 0x19.
           Reading a set of coefficients from RAM
           1.    Select the RAM block with register 0x31 bit1, bit0.
           2.    Write 6 bits of address to I2C register 0x16.
           3.    Write 1 to RA bit in I2C address 0x26.
           4.    Read top 8 bits of coefficient in I2C address 0x17.
           5.    Read middle 8 bits of coefficient in I2C address 0x18.
           6.    Read bottom 8 bits of coefficient in I2C address 0x19.
           7.    Read top 8 bits of coefficient b2 in I2C address 0x1A.
           8.    Read middle 8 bits of coefficient b2 in I2C address 0x1B.
           9.    Read bottom 8 bits of coefficient b2 in I2C address 0x1C.
           10. Read top 8 bits of coefficient a1 in I2C address 0x1D.
           11. Read middle 8 bits of coefficient a1 in I2C address 0x1E.
           12. Read bottom 8 bits of coefficient a1 in I2C address 0x1F.
           13. Read top 8 bits of coefficient a2 in I2C address 0x20.
           14. Read middle 8 bits of coefficient a2 in I2C address 0x21.
           15. Read bottom 8 bits of coefficient a2 in I2C address 0x22.
           16. Read top 8 bits of coefficient b0 in I2C address 0x23.
           17. Read middle 8 bits of coefficient b0 in I2C address 0x24.
           18. Read bottom 8 bits of coefficient b0 in I2C address 0x25.
66/89                                       DocID022033 Rev 2


STA369BW                                                                         Register description
         Writing a single coefficient to RAM
         1.    Select the RAM block with register 0x31 bit1, bit0.
         2.    Write 6 bits of address to I2C register 0x16.
         3.    Write top 8 bits of coefficient in I2C address 0x17.
         4.    Write middle 8 bits of coefficient in I2C address 0x18.
         5.    Write bottom 8 bits of coefficient in I2C address 0x19.
         6.    Write 1 to W1 bit in I2C address 0x26.
         Writing a set of coefficients to RAM
         1.    Select the RAM block with register 0x31 bit1, bit0.
         2.    Write 6 bits of starting address to I2C register 0x16.
         3.    Write top 8 bits of coefficient b1 in I2C address 0x17.
         4.    Write middle 8 bits of coefficient b1 in I2C address 0x18.
         5.    Write bottom 8 bits of coefficient b1 in I2C address 0x19.
         6.    Write top 8 bits of coefficient b2 in I2C address 0x1A.
         7.    Write middle 8 bits of coefficient b2 in I2C address 0x1B.
         8.    Write bottom 8 bits of coefficient b2 in I2C address 0x1C.
         9.    Write top 8 bits of coefficient a1 in I2C address 0x1D.
         10. Write middle 8 bits of coefficient a1 in I2C address 0x1E.
         11. Write bottom 8 bits of coefficient a1 in I2C address 0x1F.
         12. Write top 8 bits of coefficient a2 in I2C address 0x20.
         13. Write middle 8 bits of coefficient a2 in I2C address 0x21.
         14. Write bottom 8 bits of coefficient a2 in I2C address 0x22.
         15. Write top 8 bits of coefficient b0 in I2C address 0x23.
         16. Write middle 8 bits of coefficient b0 in I2C address 0x24.
         17. Write bottom 8 bits of coefficient b0 in I2C address 0x25.
         18. Write 1 to WA bit in I2C address 0x26.
         The mechanism for writing a set of coefficients to RAM provides a method of updating the
         five coefficients corresponding to a given biquad (filter) simultaneously to avoid possible
         unpleasant acoustic side effects. When using this technique, the 6-bit address specifies the
         address of the biquad b1 coefficient (for example, 0, 5, 10, 20, 35 decimal), and the
         STA369BW generates the RAM addresses as offsets from this base value to write the
         complete set of coefficient data.
                                           DocID022033 Rev 2                                       67/89
                                                                                                         89


Register description                                                                                  STA369BW
8.12.18    User-defined EQ
           The STA369BW can be programmed for four EQ filters (biquads) per each of the two input
           channels. The biquads use the following equation:
           Y[n] = 2 * (b0 / 2) * X[n] + 2 * (b1 / 2) * X[n-1] + b2 * X[n-2] - 2 * (a1 / 2) * Y[n-1] - a2 * Y[n-2]
                 = b0 * X[n] + b1 * X[n-1] + b2 * X[n-2] - a1 * Y[n-1] - a2 * Y[n-2]
           where Y[n] represents the output and X[n] represents the input. Multipliers are 24-bit signed
           fractional multipliers, with coefficient values in the range of 0x800000 (-1) to 0x7FFFFF
           (0.9999998808).
           Coefficients stored in the user-defined coefficient RAM are referenced in the following
           manner:
                 CxHy0 = b1 / 2
                 CxHy1 = b2
                 CxHy2 = -a1 / 2
                 CxHy3 = -a2
                 CxHy4 = b0 / 2
           where x represents the channel and the y the biquad number. For example, C2H41 is the b2
           coefficient in the fourth biquad for channel 2.
           Additionally, the STA369BW can be programmed for a high-pass filter (processing
           channels 1 and 2) and a low-pass filter (processing channel 3) to be used for bass-
           management crossover when the XO setting is 000 (user-defined). Both of these filters,
           when defined by the user (rather than using the preset crossover filters), are second order
           filters that use the biquad equation given above. They are loaded into the C12H0-4 and
           C3Hy0-4 areas of RAM noted in Table 72.
           By default, all user-defined filters are pass-through where all coefficients are set to 0, except
           the b0/2 coefficient which is set to 0x400000 (representing 0.5).
8.12.19    Pre-scale
           The STA369BW provides a multiplication for each input channel for the purpose of scaling
           the input prior to EQ. This pre-EQ scaling is accomplished by using a 24-bit signed
           fractional multiplier, with 0x800000 = -1 and 0x7FFFFF = 0.9999998808. The scale factor
           for this multiplication is loaded into RAM using the same I2C registers as the biquad
           coefficients and the bass-management. All channels can use the channel-1 pre-scale factor
           by setting the Biquad link bit. By default, all pre-scale factors are set to 0x7FFFFF.
8.12.20    Post-scale
           The STA369BW provides one additional multiplication after the last interpolation stage and
           the distortion compensation on each channel. This post-scaling is accomplished by using a
           24-bit signed fractional multiplier, with 0x800000 = -1 and 0x7FFFFF = 0.9999998808. The
           scale factor for this multiplication is loaded into RAM using the same I2C registers as the
           biquad coefficients and the bass-management. This post-scale factor can be used in
           conjunction with an ADC-equipped microcontroller to perform power-supply error correction.
           All channels can use the channel-1 post-scale factor by setting the post-scale link bit. By
           default, all post-scale factors are set to 0x7FFFFF. When line output is being used,
           channel-3 post-scale will affect both channels 3 and 4.
68/89                                        DocID022033 Rev 2


STA369BW                                                                            Register description
8.12.21     Overcurrent post-scale
            The STA369BW provides a simple mechanism for reacting to overcurrent detection in the
            power block. When the ocwarn input is asserted, the overcurrent post-scale value is used in
            place of the normal post-scale value to provide output attenuation on all channels. The
            default setting provides 3 dB of output attenuation when ocwarn is asserted.
            The amount of attenuation to be applied in this situation can be adjusted by modifying the
            overcurrent post-scale value. As with the normal post-scale, this scaling value is a 24-bit
            signed fractional multiplier, with 0x800000 = -1 and 0x7FFFFF = 0.9999998808. By default,
            the overcurrent post-scale factor is set to 0x5A9DF7. Once the overcurrent attenuation is
            applied, it remains until the device is reset.
            Table 72. RAM block for biquads, mixing, scaling and bass management
 Index (decimal)    Index (hex)                                         Coefficient           Default
         0               0x00                                           C1H10(b1/2)         0x000000
         1               0x01                                            C1H11(b2)          0x000000
         2               0x02             Channel 1 - Biquad 1          C1H12(a1/2)         0x000000
         3               0x03                                            C1H13(a2)          0x000000
         4               0x04                                           C1H14(b0/2)         0x400000
         5               0x05             Channel 1 - Biquad 2            C1H20             0x000000
        …                 …                         …                       …                   …
        19               0x13             Channel 1 - Biquad 4            C1H44             0x400000
        20               0x14                                             C2H10             0x000000
                                          Channel 2 - Biquad 1
        21               0x15                                             C2H11             0x000000
        …                 …                         …                       …                   …
        39               0x27             Channel 2 - Biquad 4            C2H44             0x400000
        40               0x28                                           C12H0(b1/2)         0x000000
        41               0x29            Channel 1/2 - Biquad 5          C12H1(b2)          0x000000
                                              for XO = 000
        42              0x2A                                            C12H2(a1/2)         0x000000
                                         Hi-pass 2nd Order filter
        43              0x2B                   for XO000                C12H3(a2)          0x000000
        44              0x2C                                            C12H4(b0/2)         0x400000
        45              0x2D                                            C3H0(b1/2)          0x000000
        46              0x2E               Channel 3 - Biquad            C3H1(b2)           0x000000
                                              for XO = 000
        47              0x2F                                            C3H2(a1/2)          0x000000
                                        Low-pass 2nd Order filter
        48               0x30                  for XO000                C3H3(a2)           0x000000
        49               0x31                                           C3H4(b0/2)          0x400000
        50               0x32            Channel 1 - Pre-Scale            C1PreS            0x7FFFFF
        51               0x33            Channel 2 - Pre-Scale            C2PreS            0x7FFFFF
        52               0x34            Channel 1 - Post-Scale           C1PstS            0x7FFFFF
        53               0x35            Channel 2 - Post-Scale           C2PstS            0x7FFFFF
                                             DocID022033 Rev 2                                       69/89
                                                                                                           89


Register description                                                                          STA369BW
        Table 72. RAM block for biquads, mixing, scaling and bass management (continued)
  Index (decimal)      Index (hex)                                          Coefficient       Default
         54               0x36           Channel 3 - Post-Scale              C3PstS          0x7FFFFF
         55               0x37             TWARN/OC - Limit                  TWOCL           0x5A9DF7
         56               0x38              Channel 1 - Mix 1                C1MX1           0x7FFFFF
         57               0x39              Channel 1 - Mix 2                C1MX2           0x000000
         58               0x3A              Channel 2 - Mix 1                C2MX1           0x000000
         59               0x3B              Channel 2 - Mix 2                C2MX2           0x7FFFFF
         60               0x3C              Channel 3 - Mix 1                C3MX1           0x400000
         61               0x3D              Channel 3 - Mix 2                C3MX2           0x400000
         62               0x3E                   UNUSED
         63               0x3F                    UNUSED
8.13         Variable max power correction registers (addr 0x27 - 0x28)
      D7            D6             D5           D4            D3          D2             D1        D0
    MPCC15       MPCC14         MPCC13       MPCC12        MPCC11       MPCC10         MPCC9    MPCC8
       0             0              0            1             1           0              1         0
      D7            D6             D5           D4            D3          D2             D1       D0
    MPCC7         MPCC6          MPCC5        MPCC4        MPCC3        MPCC2          MPCC1    MPCC0
       1             1              0            0             0           0              0         0
             The MPCC bits determine the 16 MSBs of the MPC compensation coefficient. This
             coefficient is used in place of the default coefficient when MPCV = 1.
8.14         Variable distortion compensation registers (addr 0x29 -
             0x2A)
      D7            D6             D5           D4           D3          D2             D1        D0
     DCC15        DCC14         DCC13         DCC12        DCC11        DCC10         DCC9      DCC8
       1             1              1            1            0           0              1         1
      D7            D6             D5           D4            D3          D2             D1       D0
     DCC7          DCC6           DCC5         DCC4         DCC3         DCC2           DCC1     DCC0
       0             0              1            1             0           0              1        1
             The DCC bits determine the 16 MSBs of the distortion compensation coefficient. This
             coefficient is used in place of the default coefficient when DCCV = 1.
70/89                                         DocID022033 Rev 2


STA369BW                                                                              Register description
8.15     Fault-detect recovery constant registers (addr 0x2B - 0x2C)
              D7          D6          D5           D4            D3           D2          D1            D0
            FDRC15      FDRC14      FDRC13       FDRC12       FDRC11        FDRC10      FDRC9         FDRC8
               0           0           0            0             0            0           0             0
              D7          D6          D5           D4            D3           D2          D1            D0
            FDRC7       FDRC6       FDRC5        FDRC4        FDRC3         FDRC2       FDRC1         FDRC0
               0           0           0            0             1            1           0             0
         The FDRC bits specify the 16-bit fault-detect recovery time delay. When FAULT is asserted,
         the TRISTATE output is immediately asserted low and held low for the time period specified
         by this constant. A constant value of 0x0001 in this register is approximately 0.083 ms. The
         default value of 0x000C gives approximately 0.1 ms.
8.16     Device status register (addr 0x2D)
              D7          D6          D5           D4            D3           D2          D1            D0
             PLLUL       FAULT     UVFAULT      OVFAULT      OCFAULT       OCWARN       TFAULT        TWARN
         This read-only register provides fault and thermal-warning status information from the power
         control block. Logic value 1 for faults or warning means normal state. Logic 0 means a fault
         or warning detected on the power bridge. PLLUL = 1 means that the PLL is not locked.
                                          Table 73. Status register bits
           Bit     R/W       RST          Name                                Description
                                                        0: PLL locked
            7       R          -         PLLUL
                                                        1: PLL not locked
                                                        0: fault detected on power bridge
            6       R          -          FAULT
                                                        1: normal operation
                                                        0: VCCxX internally detected
            5       R          -        UVFAULT
                                                        < undervoltage threshold
                                                        0: VCCxX internally detected
            4       R          -        OVFAULT
                                                        > overvoltage threshold
            3       R          -        OCFAULT         0: overcurrent fault detected
            2       R          -        OCWARN          0: overcurrent warning
                                                        0: thermal fault, junction temperature over limit
            1       R          -         TFAULT
                                                        detection
                                                        0: thermal warning, junction temperature is close to
            0       R          -         TWARN
                                                        the fault condition
                                         DocID022033 Rev 2                                                 71/89
                                                                                                                 89


Register description                                                                              STA369BW
8.17       EQ coefficients and DRC configuration register (addr 0x31)
                 D7          D6          D5           D4           D3           D2          D1          D0
                XOB        Reserved    Reserved     AMGC[3]      AMGC[2]      Reserved    SEL[1]      SEL[0]
                  0           0           0            0            0            0           0           0
                                                Table 74. EQ RAM select
                     SEL[1:0]                                  EQ RAM bank selected
                      00/11             Bank 0 activated
                        01              Bank 1 activated
                        10              Bank 2 activated
           Bits AMGC[3:2] change the behavior of the bits AMGC[1:0] as given in Table 75 below.
                                       Table 75. Anti-clipping and DRC preset
                    AMGC[3:2]                          Anti clipping and DRC preset selected
                        00              DRC/Anti-clipping behavior described in Table 55 on page 54 (default)
                        01              DRC/Anti-clipping behavior is described Table 76 on page 72
                      10/11             Reserved, do not use
           When AMGC[3:2] = 01 then the bits 1:0 are defined as given here in Table 76.
                                Table 76. Anti-clipping selection for AMGC[3:2] = 01
                    AMGC[1:0]                                            Mode
                        00              AC0, stereo anticlipping 0 dB limiter
                        01              AC1, stereo anticlipping +1.25 dB limiter
                        10              AC2, stereo anticlipping +2 dB limiter
                        11              Reserved, do not use
           The AC0, AC1, AC2 settings are designed for the loudspeaker protection function, limiting
           at the minimum any audio artifacts introduced by typical anti-clipping/DRC algorithms. More
           detailed information is available in the applications notes “Configurable output power rate
           using STA335BW” and “STA335BWS vs STA335BW”.
           The XOB bit can be used to bypass the crossover filters. Logic 1 means that the function is
           not active. In this case, the high-pass crossover filter works as a pass-through on the data
           path (b0 = 1, all the other coefficients at logic 0) while the low-pass filter is configured to
           have zero signal on channel-3 data processing (all the coefficients are at logic 0).
72/89                                        DocID022033 Rev 2


STA369BW                                                                            Register description
8.18     Extended configuration register (addr 0x36)
              D7           D6          D5             D4      D3           D2              D1      D0
            Mdrc[1]      Mdrc[0]     PS48DB          XAR1    XAR2         BQ5            BQ6      BQ7
               0            0           0              0       0            0               0       0
         The extended configuration register provides access to B2DRC and biquad 5, 6 and 7.
8.18.1   Dual-band DRC
         The STA369BW device provides a dual-band DRC (B2DRC) on the left and right channels
         data path, as depicted in Figure 30. Dual-band DRC is activated by setting MDRC[1:0] = 1x.
                                            Figure 30. B2DRC scheme
                                                                    CH1
                                                                                    DRC1
                                                                                     Limiter
                                                                                      And
                                                                                       Vol
                                                                   Volume
                                             Pass
                                                                                              +
                                             B2DRC XO
                                              Filter
                                             Hi-pass
                    L                         filter
                                                                    CH3
                                                                                    DRC2
                                                                                     Limiter
                                                                                      And
                                                                                       Vol
                                                           -       Volume
                                                                    CH2
                                                                                    DRC1
                                                                   Volume
                                                                                              +
                                             Pass XO
                                              2DRC
                                             BFilter                CH3
                   R                         Hi-pass
                                              filter               Volume
                                                                                    DRC2
                                                                                     Limiter
                                                                                      And
                                                                                       Vol
                                                           -
                                                                                                AM045194v1
         The low-frequency information (LFE) is extracted from left and right channels, removing the
         high frequencies using a programmable biquad filter, and then computing the difference with
         the original signal. Limiter 1 (DRC1) is then used to control left/right high-frequency
         amplitude of the components, while limiter 2 (DRC2) is used to control the low-frequency
         components (see Chapter 8.11).
         The cutoff frequency of the high-pass filters can be user-defined, XO[3:0] = 0, or selected
         from the pre-defined values.
         DRC1 and DRC2 are then used to independently limit L/R high frequencies and the
         amplitude of the LFE channels (see Chapter 8.11) as well as their volume control. To be
         noted that, in this configuration, the dedicated channel 3 volume control can actually act as
         a bass boost enhancer as well (0.5 dB/step resolution).
         The processed LFE channel is then recombined with the L and R channels in order to
         reconstruct the 2.0 output signal.
         Sub-band decomposition
         The sub-band decomposition for B2DRC can be configured, specifying the cutoff frequency.
         The cutoff frequency can be programmed in two ways, using XO bits in register 0x0C, or
         using the “user programmable” mode (coefficients stored in RAM addresses 0x28 to 0x31).
                                          DocID022033 Rev 2                                           73/89
                                                                                                            89


Register description                                                                         STA369BW
           For the user programmable mode, use the formulas below to compute the high-pass filters:
                    b0 = (1 + alpha) / 2              a0 = 1
                    b1 = -(1 + alpha) / 2             a1 = -alpha
                    b2 = 0                            a2 = 0
           where alpha = (1-sin(0))/cos(0), and 0 is the cutoff frequency.
           A first-order filter is recommended to guarantee that for every 0 the corresponding
           low-pass filter obtained as the difference (as shown in Figure 30) will have a symmetric
           (relative to HP filter) frequency response, and the corresponding recombination after the
           DRC has low ripple. Second-order filters can be used as well, but in this case the filter
           shape must be carefully chosen to provide good low-pass response and minimum ripple
           recombination. For second-order filters it is not possible to give a closed formula to get the
           best coefficients, but empirical adjustment should be done.
           DRC settings
           The DRC blocks used by B2DRC are the same as those described in Chapter 8.11. B2DRC
           configures automatically the DRC blocks in anticlipping mode. Attack and release
           thresholds can be selected using registers 0x32, 0x33, 0x34, 0x35, while attack and release
           rates are configured by registers 0x12 and 0x14.
           Band downmixing
           The low-frequency band is down-mixed to the left and right channels at the B2DRC output.
           Channel volume can be used to weight the bands recombination to fine-tune the overall
           frequency response.
8.18.2     EQ DRC mode
           Setting MDRC = 01, it is possible to add a programmable biquad (the XO biquad at RAM
           addresses 0x28 to 0x2C is used for this purpose) to the limiter/compressor measure path
           (side chain). Using EQDRC, the peak detector input can be shaped in frequency using the
           programmable biquad. For example if a +2 dB bass boost is applied (using a low shelf filter
           for example), the effect is that the EQDRC output will limit bass frequencies to -2 dB below
           the selected attack threshold.
           Generally speaking, if the biquad boosts frequency f with an amount of X dB, the level of a
           compressed sine wave at the output will be TH - X, where TH is the selected attack
           threshold.
Note:      EQDRC works only if the biquad frequency response magnitude is  0 dB for every
           frequency.
74/89                                       DocID022033 Rev 2


STA369BW                                                                              Register description
                                          Figure 31. EQDRC scheme
                                                      EQDRC
                                                                                            ATTENUATION
                                                     PEAK              ATTENUATION
           Channel In          BIQUAD                                  CLACULATOR
                                                  DETECTOR
                                               Standard DRC
                                                                                            ATTENUATION
                                                     PEAK              ATTENUATION
           Channel In                             DETECTOR             CLACULATOR
                                                                                                       AM045195v1
8.18.3   Extended post-scale range
                  PS48DB                                              Mode
                       0            Post-scale value is applied as defined in coefficient RAM
                                    Post-scale value is applied with +48 dB offset with respect to the
                       1
                                    coefficient RAM value
         Post-scale is an attenuation by default. When PS48DB is set to 1, a 48-dB offset is applied
         to the coefficient RAM value, so post-scale can act as a gain too.
8.18.4   Extended attack rate
         The attack rate shown in Table 66 can be extended to provide up to an 8 dB/ms attack rate
         on both limiters.
                    XAR1                                              Mode
                       0            Limiter1 attack rate is configured using Table 66
                       1            Limiter1 attack rate is 8 dB/ms
                    XAR2                                              Mode
                       0            Limiter2 attack rate is configured using Table 66
                       1            Limiter2 attack rate is 8 dB/ms
                                        DocID022033 Rev 2                                                   75/89
                                                                                                                  89


Register description                                                                            STA369BW
8.18.5     Extended BIQUAD selector
           De-emphasis filters as well as bass and treble controls can be configured as user-defined
           filters when the equalization coefficients link is activated (BQL = 1) and the corresponding
           BQx bit is set to 1.
                       BQ5                                                 Mode
                         0              Pre-set de-emphasis filter selected
                         1              User-defined biquad 5 coefficients are selected
                       BQ6                                                 Mode
                         0              Pre-set bass filter selected as per Table 65
                         1              User-defined biquad 6 coefficients are selected
                       BQ7                                                 Mode
                         0              Pre-set treble filter selected as per Table 65
                         1              User-defined biquad 7 coefficients are selected
           When filters from 5th to 7th are configured as user-programmable, the corresponding
           coefficients are stored respectively in addresses 0x20-0x24 (BQ5), 0x25-0x29 (BQ6), 0x2A-
           0x2E (BQ7) as in Table 72.
Note:      BQx bits are ignored if BQL = 0 or if DEMP = 1 (relevant for BQ5) or CxTCB = 1 (relevant for
           BQ6 and BQ7).
8.19       EQ soft-volume configuration registers (addr 0x37 - 0x38)
                 D7          D6          D5            D4            D3           D2      D1         D0
                                       SVUPE        SVUP[4]        SVUP[3]      SVUP[2] SVUP[1]    SVUP[0]
                  0           0           0             0             0            0       0          0
                 D7          D6          D5            D4            D3           D2      D1         D0
                                       SVDWE        SVDW4]         SVDW[3]      SVDW[2] SVDW[1]    SVDW[0]
                  0           0           0             0             0            0       0          0
           The soft-volume update has a fixed rate by default. Using register 0x37 and 0x38, it is
           possible to override the default behavior, allowing different volume change rates.
           It is also possible to independently define the fade-in (volume is increased) and fade-out
           (volume is decreased) rates according to the desired behavior.
                      SVUPE                                                Mode
                         0              When volume is increased, use the default rate
                         1              When volume is increased, use the rates defined by SVUP[4:0]
76/89                                       DocID022033 Rev 2


STA369BW                                                                              Register description
         When SVUPE = 1 the fade-in rate is defined by the SVUP[4:0] bits according to the
         following formula:
               Fade-in rate = 48 / (N + 1) dB/ms
         where N is the SVUP[4:0] value.
                     SVDWE                                            Mode
                       0               When volume is decreased, use the default rate
                       1               When volume is decreased, use the rates defined by SVDW[4:0]
         When SVDWE = 1 the fade-out rate is defined by the SVDW[4:0] bits according to the
         following formula:
               Fade-in rate = 48 / (N + 1) dB/ms
         where N is the SVDW[4:0] value.
Note:    For fade-out rates greater than 6 dB/msec it is suggested to disable the CPWMEN bit
         (Section 8.24.4 ) and ZCE bit (Section 8.5.7) in order to avoid any audible pop noise.
8.20     DRC RMS filter coefficients (addr 0x39-0x3E)
               D7           D6          D5           D4        D3           D2           D1         D0
            R_C0[23]     R_C0[22]     R_C0[21]     R_C0[20] R_C0[19]     R_C0[18]      R_C0[17]  R_C0[16]
                0            0           0            0         0            0            0          1
               D7           D6          D5           D4        D3           D2           D1         D0
            R_C0[15]     R_C0[14]     R_C0[13]     R_C0[12]  R_C0[11]    R_C0[10]      R_C0[9]    R_C0[8]
                1            1           1            0         1            1            1          0
               D7           D6          D5           D4        D3           D2           D1         D0
             R_C0[7]      R_C0[6]     R_C0[5]      R_C0[4]   R_C0[3]      R_C0[2]      R_C0[1]    R_C0[0]
                1            1           1            1         1            1            1          1
               D7           D6          D5           D4        D3           D2           D1         D0
            R_C1[23]     R_C1[22]     R_C1[21]     R_C1[20] R_C1[19]     R_C1[18]      R_C1[17]  R_C1[16]
                0            1           1            1         1            1            1          0
               D7           D6          D5           D4        D3           D2           D1         D0
            R_C1[15]     R_C1[14]     R_C1[13]     R_C1[12]  R_C1[11]    R_C1[10]      R_C1[9]    R_C1[8]
                1            1           0            0         0            0            0          0
               D7           D6          D5           D4        D3           D2           D1         D0
             R_C1[7]      R_C1[6]     R_C1[5]      R_C1[4]   R_C1[3]      R_C1[2]      R_C1[1]    R_C1[0]
                0            0           1            0         0            1            1          0
         Signal level detection in DRC algorithm is computed using the following formula:
               y(t) = c0 * abs(x(t)) + c1 * y(t-1)
         where x(t) represents the audio signal applied to the limiter, and y(t) the measured level.
                                           DocID022033 Rev 2                                           77/89
                                                                                                             89


Register description                                                                          STA369BW
8.21       Extra volume resolution configuration registers (address
           0x3F)
                D7          D6           D5         D4        D3          D2          D1            D0
              VRESEN      VRESTG      C3VR[1]     C3VR[0]   C2VR[1]     C2VR[0]     C1VR[1]      C1VR[0]
                 0           0            0          0         0           0           0            0
           The extra volume resolution allows fine volume tuning by steps of 0.125dB.
           The feature is enabled when VRESEN=1, as depicted in Figure 32. The overall channel
           volume in this case will be CxVol+CxVR (in dB). On top of the total volume range from
           -80 dB to +48 dB, this extra volume resolution works in a volume range from -80 dB to +42
           dB. For volumes greater than +42 dB, this function must not be selected.
                                  Figure 32. Extra resolution volume scheme
                                                                      Audio Data In
                               CxVOL        Soft
                                           Volume                      0
                                                                                     Audio Data Out
                                                                                  X
                                                         X             1
                                                                         VRESEN
                                                      1    0
                                                                 VRESTG
                             MVOL or CxVOL’event
                                                    CxVR
                                                                                                 AM045196v1
           If VRESEN = 0, the channel volume will be defined only by the CxVol registers.
           Fine-tuning steps can be set according to the following table for channels 1, 2, 3:
                     CxVR                                           Mode
                       00              0 dB
                       01             -0.125dB
                       10             -0.25dB
                       11             -0.375dB
78/89                                      DocID022033 Rev 2


STA369BW                                                                            Register description
         Two different behaviors can be configured by the VRESTG bit:
             If VRESTG=’0’, the CxVR contribution will be applied immediately after the
              corresponding I2C bits are written.
             If VRESTG=’1’, the CxVR bits will be effective on channel volume only after the
              corresponding CxVol register or master volume register is written (even to the previous
              values).
              VRESEN              VRESTG                                    Mode
                   0                  0          Extra volume resolution disabled
                   0                  1          Extra volume resolution disabled
                   1                  0          Volume fine-tuning enabled and applied immediately.
                                                 Volume fine-tuning enabled and applied when master or
                   1                  1
                                                 channel volume is updated
8.22     Quantization error noise correction (address 0x48)
              D7          D6           D5           D4          D3           D2          D1          D0
           NSHXEN     NSHB7EN NSHB6EN NSHB5EN NSHB4EN NSHB3EN NSHB2EN NSHB1EN
               0           0            0            0           0            0           0           0
         A special feature inside the digital processing block is available. In case of poles positioned
         at very low frequencies, biquad filters can generate some audible quantization noise or
         unwanted DC level. In order to avoid this kind of effect, a quantization noise-shaping
         capability can be used. The filter structure including this special feature, relative to each
         biquad, is shown in Figure 33.
         By default, this capability is not activated to maintain backward compatibility with all the
         previous Sound Terminal products. The new feature can be enabled independently for each
         biquad using the I2C registers. The D7 bit, when set, is responsible for activating this
         function on the crossover filter, while the other bits address any specific biquads according
         to the previous table. Channels 1 and 2 share the same settings. Bit D7 is effective also for
         channel 3 if the relative OCFG is used.
                                          DocID022033 Rev 2                                             79/89
                                                                                                              89


Register description                                                                                STA369BW
                    Figure 33. Biquad filter structure with quantization error noise-shaping
                                                                z-1       -
                        In(t)                                                            Out(t)
                                                 b0              +        Q
                                    z-1                                               z-1
                                                 b1                      a1
                                    z-1                                               z-1
                                                 b2                      a2
                                                                                                      AM045197v1
8.23       Extended coefficient range up to -4...4 (address 0x49, 0x4A)
                D7            D6            D5         D4          D3           D2          D1          D0
            CXTB4[1]     CXTB4[0]       CXTB3[1]    CXTB3[0]   CX_B2[1]   CXTB2[0]      CXTB1[1]     CXTB1[0]
                 0             0             0          0           0            0           0           0
                D7            D6            D5         D4          D3           D2          D1          D0
            Reserved     Reserved       CXTB7[1]    CXTB7[0]   CXTB6[1]   CXTB6[0]       CXTB5[1]    CXTB5[0]
                 0             0            0           0           0            0           0           0
           Biquads from 1 to 7 have in the STA369BW the possibility to extend the coefficient range
           from [-1,1) to [-4..4). This allows the realization of high shelf filters that may require a
           coefficients dynamic greater in absolute value than 1.
           Three ranges are available, [-1;1) [-2;2) [-4;4). By default the extended range is not
           activated to maintain backward compatibility with all the previous Sound Terminal products.
           Each biquad has its independent setting according to the following table:
                                             Table 77. Biquad filter settings
                      CEXT_Bx[1]                         CEXT_Bx[0]
                            0                                 0                               [-1;1)
                            0                                 1                               [-2;2)
                            1                                 0                               [-4;4)
                            1                                 1                            Reserved
80/89                                         DocID022033 Rev 2


STA369BW                                                                            Register description
         In this case the user can decide, for each filter stage, the right coefficients range. Note that
         for a given biquad, the same range will be applied to left and right (channel 1 and channel
         2).
         The crossover biquad does not have the availability of this feature, maintaining the [-1;1)
         range unchanged.
8.24     Miscellaneous registers (address 0x4B, 0x4C)
    D7           D6            D5           D4           D3           D2             D1           D0
RPDNEN     NSHHPEN        BRIDGOFF      Reserved    Reserved      CPWMEN       Reserved      Reserved
     0            0             0            0            0             1             0            0
    D7           D6            D5           D4           D3           D2             D1           D0
Reserved   Reserved       Reserved      PNDLSL[2]   PNDLSL[1]     PNDLSL[0]    Reserved      Reserved
     0            0             0            0            0             0             0            0
8.24.1   Rate powerdown enable (RPDNEN) bit (address 0x4B, bit D7)
         In the STA369BW, by default, the power-down pin and I2C power-down act on mute
         commands to perform the fadeout. This default can be changed so that the fadeout can be
         started using the master volume. The RPDNEN bit, when set, activates this feature.
8.24.2   Noise-shaping on DC cut filter enable (NSHHPEN) bit (address 0x4B,
         bit D6)
         Following the description in Section 8.22, this bit, when set, enables the noise-shaping
         technique on the DC cutoff filter. Channels 1 and 2 share the same settings.
8.24.3   Bridge immediate off (BRIDGOFF) bit (address 0x4B, bit D5)
         A fadeout procedure is started in the STA369BW once the PWDN function is enabled.
         Independently from the fadeout time, after 13 million clock cycles (PLL internal frequency)
         the bridge is put in power-down (tristate mode). There is also the possibility to change this
         behavior so that the power bridge will be switched off immediately after the PWDN pin is tied
         to ground, without waiting for the 13 million clock cycles. The BRIDGOFF bit, when set,
         activates this function. Obviously the immediate power-down will generate a pop noise at
         the output, therefore this procedure must be used only in case pop noise is not relevant in
         the application. Note that this feature works only for hardware PWDN assertion and not for a
         power-down applied through the I2C interface. Refer to Section 8.24.5 in order to program a
         different number of clock cycles.
                                          DocID022033 Rev 2                                          81/89
                                                                                                           89


Register description                                                                           STA369BW
8.24.4     Channel PWM enable (CPWMEN) bit (address 0x4B, bit D2)
           This bit, when set, activates a mute output in case the volume reaches a value lower than
           -76 dBFS.
8.24.5     Power-down delay selector (PNDLSL[2:0]) bits (address 0x4C, bit D4,
           D3, D2)
           As per Section 8.24.3, the assertion of PWDN activates a counter that, by default, after 13
           million clock cycles puts the power bridge in tristate mode, independently from the fadeout
           time. Using these registers it is possible to program this counter according to the following
           table:
               PNDLSL[2]         PNDLSL[1]           PNDLSL[2]                    Fade out time
                    0                 0                   0             Default time (13M clock cycles)
                    0                 0                   1                Default time divided by 2
                    0                 1                   0                Default time divided by 4
                    0                 1                   1                Default time divided by 8
                    1                 0                   0               Default time divided by 16
                    1                 0                   1               Default time divided by 32
                    1                 1                   0               Default time divided by 64
                    1                 1                   1               Default time divided by 128
82/89                                      DocID022033 Rev 2


STA369BW                                                                                   Application
9        Application
9.1      Application scheme for power supplies
         Figure 34 illustrates the typical application scheme for the STA369BW concerning the power
         supplies. Particular care must be given to the layout of the PCB. In particular the 3.3 ohm
         resistors on the digital supplies (VDD_DIG) have to be put as close as possible to the device
         which avoids any unwanted oscillation on the digital portion of the device due to inductive
         traces of the PCB. The same rule is also valid for all the decoupling capacitors in order to
         limit spikes on all the supplies.
                               Figure 34. Application scheme for power supplies
                                                                                               AM045198v1
9.2      PLL filter schematic
         It is recommended to use the above scheme and values for the PLL loop filter to achieve the
         best performances from the device in general applications. Please note that the ground of
         this filter scheme has to be connected to the ground of the PLL without any resistive path.
         Concerning the component values, please take into account that the greater the filter
         bandwidth, the less the lock time, but the higher the PLL output jitter.
9.3      Typical output configuration
         Figure 35 shows the typical output configuration used for BTL stereo mode. Please refer to
         the application note for all the other recommended schematics of the output configuration.
                                          DocID022033 Rev 2                                        83/89
                                                                                                          89


Application                                                       STA369BW
            Figure 35. Output configuration for stereo BTL mode
                                  22uH
             OUT1A
                                              100nF
                                           6.2
                            22                      100nF
                                                          470nF LEFT
                                            6.2     100nF
                            330pF
                                              100nF
             OUT1B
                                   22uH
                                  22uH
             OUT2A
                                              100nF
                                           6.2
                            22                      100nF
                                                          470nF RIGHT
                                            6.2     100nF
                            330pF
                                              100nF
             OUT2B
                                   22uH
                                                                      AM045199v1
84/89                   DocID022033 Rev 2


STA369BW                                                                    Package thermal characteristics
10       Package thermal characteristics
         Using a four-layer PCB, the thermal resistance junction-to-ambient with 2 copper ground
         areas of 6 x 4 cm2 and with 24 via holes (see Figure 36) is 17 °C/W in natural air
         convection.
         The dissipated power within the device depends primarily on the supply voltage, load
         impedance and output modulation level.
         Thus, the maximum estimated dissipated power for the STA369BW is:
                2 x 40 W @ 8 , 25.5 V                              Pd max ~ 8 W
                2 x 17 W + 1 x 35 W @ 4 , 8 ,25 V                Pd max < 7 W
               Figure 36. Double-layer PCB with 2 copper ground areas and 24 via holes
                                                                                                   AM045200v1
         Figure 37 shows the power derating curve for the PowerSSO-36 slug-down package on
         PCBs with copper areas of 5 x 4 cm2 and 6 x 4cm2.
                              Figure 37. PowerSSO-36 power derating curve
                Pd (W)  8
                        7
                                                    Copper Area 6x4 cm
                        6                           and 24 via holes
                        5
                                                                              STA350BW
                                                                              STA369BW
                        4                                                     Power-SSO36
                        3
                                    Copper Area 5x4 cm
                        2           and 20 via holes
                        1
                        0
                           0     20        40          60         80    100     120    140  160
                                                             Tamb ( °C)
                                                                                                  AM045201v1
                                         DocID022033 Rev 2                                             85/89
                                                                                                              89


Package mechanical data                                                                    STA369BW
11        Package mechanical data
          In order to meet environmental requirements, ST offers these devices in different grades of
          ECOPACK® packages, depending on their level of environmental compliance. ECOPACK®
          specifications, grade definitions and product status are available at: www.st.com.
          ECOPACK® is an ST trademark.
                                  Table 78. PowerSSO-36 EPD dimensions
                               Dimensions in mm                        Dimensions in inches
            Symbol
                          Min          Typ           Max         Min             Typ          Max
               A         2.15            -           2.47       0.085             -          0.097
              A2         2.15            -           2.40       0.085             -          0.094
              a1         0.00            -           0.10        0.00             -          0.004
               b         0.18            -           0.36       0.007             -          0.014
               c         0.23            -           0.32       0.009             -          0.013
               D         10.10           -          10.50       0.398             -          0.413
               E         7.40            -           7.60       0.291             -          0.299
               e           -            0.5            -           -            0.020           -
              e3           -            8.5            -           -            0.335           -
               F           -            2.3            -           -            0.091           -
               G           -             -           0.10          -              -          0.004
               H         10.10           -          10.50       0.398             -          0.413
               h           -             -           0.40          -              -          0.016
               k           0             -        8 degrees        0              -        8 degrees
               L         0.60            -           1.00       0.024             -          0.039
               M           -           4.30            -           -            0.169           -
               N           -             -       10 degrees        -              -        10 degrees
               O           -           1.20            -           -            0.047           -
               Q           -           0.80            -           -            0.031           -
               S           -           2.90            -           -            0.114           -
               T           -           3.65            -           -            0.144           -
               U           -           1.00            -           -            0.039           -
               X         4.10            -           4.70       0.161             -          0.185
               Y          6.50           -           7.10       0.256             -          0.280
86/89                                      DocID022033 Rev 2


  STA369BW                                                                 Package mechanical data
                                             h x 45°
Figure 38. PowerSSO-36 EPD outline drawing
                                                       DocID022033 Rev 2                     87/89


Revision history                                                                              STA369BW
12          Revision history
                                  Table 79. Document revision history
                 Date     Revision                                 Changes
              21-Jul-2011    1      Initial release
                                    Added Section 5 on page 25
                                    Modified Note:: The read write operation on RAM coefficients works
             25-Sep-2013     2      only if RLCKI (pin29) is switching and stable (ref. Table 8, tLRJT
                                    timing) and PLL must be locked (ref bit D7 reg 0x2D). on page 66
                                    Updated Company information appearing on last page of document
88/89                                 DocID022033 Rev 2


STA369BW
                                                             Please Read Carefully:
Information in this document is provided solely in connection with ST products. STMicroelectronics NV and its subsidiaries (“ST”) reserve the
right to make changes, corrections, modifications or improvements, to this document, and the products and services described herein at any
time, without notice.
All ST products are sold pursuant to ST’s terms and conditions of sale.
Purchasers are solely responsible for the choice, selection and use of the ST products and services described herein, and ST assumes no
liability whatsoever relating to the choice, selection or use of the ST products and services described herein.
No license, express or implied, by estoppel or otherwise, to any intellectual property rights is granted under this document. If any part of this
document refers to any third party products or services it shall not be deemed a license grant by ST for the use of such third party products
or services, or any intellectual property contained therein or considered as a warranty covering the use in any manner whatsoever of such
third party products or services or any intellectual property contained therein.
UNLESS OTHERWISE SET FORTH IN ST’S TERMS AND CONDITIONS OF SALE ST DISCLAIMS ANY EXPRESS OR IMPLIED
WARRANTY WITH RESPECT TO THE USE AND/OR SALE OF ST PRODUCTS INCLUDING WITHOUT LIMITATION IMPLIED
WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE (AND THEIR EQUIVALENTS UNDER THE LAWS
OF ANY JURISDICTION), OR INFRINGEMENT OF ANY PATENT, COPYRIGHT OR OTHER INTELLECTUAL PROPERTY RIGHT.
ST PRODUCTS ARE NOT DESIGNED OR AUTHORIZED FOR USE IN: (A) SAFETY CRITICAL APPLICATIONS SUCH AS LIFE
SUPPORTING, ACTIVE IMPLANTED DEVICES OR SYSTEMS WITH PRODUCT FUNCTIONAL SAFETY REQUIREMENTS; (B)
AERONAUTIC APPLICATIONS; (C) AUTOMOTIVE APPLICATIONS OR ENVIRONMENTS, AND/OR (D) AEROSPACE APPLICATIONS
OR ENVIRONMENTS. WHERE ST PRODUCTS ARE NOT DESIGNED FOR SUCH USE, THE PURCHASER SHALL USE PRODUCTS AT
PURCHASER’S SOLE RISK, EVEN IF ST HAS BEEN INFORMED IN WRITING OF SUCH USAGE, UNLESS A PRODUCT IS
EXPRESSLY DESIGNATED BY ST AS BEING INTENDED FOR “AUTOMOTIVE, AUTOMOTIVE SAFETY OR MEDICAL” INDUSTRY
DOMAINS ACCORDING TO ST PRODUCT DESIGN SPECIFICATIONS. PRODUCTS FORMALLY ESCC, QML OR JAN QUALIFIED ARE
DEEMED SUITABLE FOR USE IN AEROSPACE BY THE CORRESPONDING GOVERNMENTAL AGENCY.
Resale of ST products with provisions different from the statements and/or technical features set forth in this document shall immediately void
any warranty granted by ST for the ST product or service described herein and shall not create or extend in any manner whatsoever, any
liability of ST.
                            ST and the ST logo are trademarks or registered trademarks of ST in various countries.
                           Information in this document supersedes and replaces all information previously supplied.
            The ST logo is a registered trademark of STMicroelectronics. All other names are the property of their respective owners.
                                                 © 2013 STMicroelectronics - All rights reserved
                                                     STMicroelectronics group of companies
   Australia - Belgium - Brazil - Canada - China - Czech Republic - Finland - France - Germany - Hong Kong - India - Israel - Italy - Japan -
       Malaysia - Malta - Morocco - Philippines - Singapore - Spain - Sweden - Switzerland - United Kingdom - United States of America
                                                                   www.st.com
                                                             DocID022033 Rev 2                                                           89/89
                                                                                                                                                  89


Mouser Electronics
Authorized Distributor
Click to View Pricing, Inventory, Delivery & Lifecycle Information:
STMicroelectronics:
 STA369BWTR
