w                                                                                                                    WM8958
             Multi-Channel Audio Hub CODEC for Smartphones
DESCRIPTION                                                               FEATURES
                  [1]
The WM8958 is a highly integrated ultra-low power hi-fi                       24-bit 4-channel hi-fi DAC and 2-channel hi-fi ADC
CODEC designed for smartphones and other portable devices                     100dB SNR during DAC playback (‘A’ weighted)
rich in multimedia features.                                                  Smart MIC interface
                                                                               - Power, clocking and data input for up to four digital MICs
An integrated stereo Class D/AB speaker driver and Class W                     - High performance analogue MIC interface
headphone driver minimize power consumption during audio                       - MIC activity detect & interrupt allows processor to sleep
playback.                                                                      - Impedance sensing for accessory / push-button detection
The device requires only two voltage supplies, with all other                 2W stereo (2 x 2W) Class D/AB speaker driver
internal supply rails generated from integrated LDOs.                         Capless Class W headphone drivers
                                                                               - Integrated charge pump
Stereo full duplex asynchronous sample rate conversion and                     - 5.3mW total power for DAC playback to headphones
multi-channel digital mixing combined with powerful analogue                  4 Line outputs (single-ended or differential)
mixing allow the device to support a huge range of different                  BTL Earpiece driver
architectures and use cases.                                                  Digital audio interfaces for multi-processor architecture
                                                                               - Asynchronous stereo duplex sample rate conversion
A multiband compressor and programmable parametric EQ
                                                                               - Powerful mixing and digital loopback functions
provide volume maximisation and speaker compensation in the                             TM
                                                                              ReTune Mobile 5-band, 6-channel parametric EQ
digital playback paths. The dynamic range controller can be
                                                                              Multiband compressor and dynamic range controller
used in record or playback paths for maintaining a constant
                                                                              Dual FLL provides all necessary clocks
signal level, maximizing loudness and protecting speakers
                                                                               - Self-clocking modes allow processor to sleep
against overloading and clipping.
                                                                               - All standard sample rates from 8kHz to 96kHz
A smart digital microphone interface provides power regulation,               Active noise reduction circuits
a low jitter clock output and decimation filters for up to four                - DC offset correction removes pops and clicks
digital microphones. Microphone activity detection with interrupt              - Ground loop noise cancellation
is available. Impedance sensing and measurement is provided                   Integrated LDO regulators
for external accessory / push-button detection.                               72-ball W-CSP package (4.516 x 4.258 x 0.698mm)
Fully differential internal architecture and on-chip RF noise filters     APPLICATIONS
ensure a very high degree of noise immunity. Active ground loop
noise rejection and DC offset correction help prevent pop noise               Smartphones and music phones
and suppress ground noise on the headphone outputs.                           Portable navigation
                                                                              Tablets
                                                                              eBooks
                                                                              Portable Media Players
WOLFSON MICROELECTRONICS plc                                                                           Pre-Production, March 2014, Rev 3.5
[1] This product is protected by Patents US 7,622,984, US 7,626,445, and GB 2,469,345
                                                                                                    Copyright 2014 Wolfson Microelectronics plc


WM8958                                                                                                                                                              Pre-Production
                                                      TABLE OF CONTENTS
DESCRIPTION ................................................................................................................ 1
FEATURES ..................................................................................................................... 1
APPLICATIONS.............................................................................................................. 1
TABLE OF CONTENTS .................................................................................................. 2
BLOCK DIAGRAM ......................................................................................................... 7
PIN CONFIGURATION ................................................................................................... 8
ORDERING INFORMATION ........................................................................................... 8
PIN DESCRIPTION ......................................................................................................... 9
ABSOLUTE MAXIMUM RATINGS ............................................................................... 12
RECOMMENDED OPERATING CONDITIONS ............................................................ 13
THERMAL PERFORMANCE ........................................................................................ 14
ELECTRICAL CHARACTERISTICS ............................................................................ 15
 INPUT SIGNAL LEVEL ............................................................................................................ 15
 INPUT PIN RESISTANCE ........................................................................................................ 16
 PROGRAMMABLE GAINS....................................................................................................... 18
 OUTPUT DRIVER CHARACTERISTICS ................................................................................. 19
 ADC INPUT PATH PERFORMANCE....................................................................................... 20
 DAC OUTPUT PATH PERFORMANCE ................................................................................... 21
 BYPASS PATH PERFORMANCE............................................................................................ 24
 MULTI-PATH CROSSTALK ..................................................................................................... 26
 DIGITAL INPUT / OUTPUT ...................................................................................................... 28
 DIGITAL FILTER CHARACTERISTICS ................................................................................... 28
 MICROPHONE BIAS CHARACTERISTICS ............................................................................. 29
 MISCELLANEOUS CHARACTERISTICS ................................................................................ 30
 TERMINOLOGY ....................................................................................................................... 31
TYPICAL PERFORMANCE .......................................................................................... 32
 TYPICAL POWER CONSUMPTION ........................................................................................ 32
 TYPICAL SIGNAL LATENCY ................................................................................................... 33
 SPEAKER DRIVER PERFORMANCE ..................................................................................... 34
SIGNAL TIMING REQUIREMENTS ............................................................................. 35
 SYSTEM CLOCKS & FREQUENCY LOCKED LOOP (FLL) .................................................... 35
 AUDIO INTERFACE TIMING ................................................................................................... 36
   DIGITAL MICROPHONE (DMIC) INTERFACE TIMING ................................................................................................................36
   DIGITAL AUDIO INTERFACE - MASTER MODE .........................................................................................................................37
   DIGITAL AUDIO INTERFACE - SLAVE MODE .............................................................................................................................38
   DIGITAL AUDIO INTERFACE - TDM MODE ................................................................................................................................39
 CONTROL INTERFACE TIMING ............................................................................................. 40
DEVICE DESCRIPTION ............................................................................................... 41
 INTRODUCTION ...................................................................................................................... 41
 ANALOGUE INPUT SIGNAL PATH ......................................................................................... 43
   MICROPHONE INPUTS ................................................................................................................................................................44
   MICROPHONE BIAS CONTROL ..................................................................................................................................................44
   MICROPHONE ACCESSORY DETECT .......................................................................................................................................46
   LINE AND VOICE CODEC INPUTS ..............................................................................................................................................46
   INPUT PGA ENABLE ....................................................................................................................................................................47
   INPUT PGA CONFIGURATION ....................................................................................................................................................48
   INPUT PGA VOLUME CONTROL .................................................................................................................................................49
   INPUT MIXER ENABLE.................................................................................................................................................................52
   INPUT MIXER CONFIGURATION AND VOLUME CONTROL .....................................................................................................52
                                                                                                                                                   PP, March 2014, Rev 3.5
w
                                                                                                                                                                                         2


Pre-Production                                                                                                                                                                  WM8958
  DIGITAL MICROPHONE INTERFACE .................................................................................... 56
    DIGITAL PULL-UP AND PULL-DOWN ..........................................................................................................................................59
  ANALOGUE TO DIGITAL CONVERTER (ADC) ...................................................................... 59
    ADC CLOCKING CONTROL .........................................................................................................................................................60
  DIGITAL CORE ARCHITECTURE ........................................................................................... 61
  DIGITAL MIXING ...................................................................................................................... 63
    AUDIO INTERFACE 1 (AIF1) OUTPUT MIXING ...........................................................................................................................64
    DIGITAL SIDETONE MIXING ........................................................................................................................................................65
    DIGITAL SIDETONE VOLUME AND FILTER CONTROL .............................................................................................................65
    DAC OUTPUT DIGITAL MIXING ...................................................................................................................................................67
    AUDIO INTERFACE 2 (AIF2) DIGITAL MIXING ...........................................................................................................................68
    ULTRASONIC (4FS) AIF OUTPUT MODE ....................................................................................................................................69
  MULTIBAND COMPRESSOR (MBC) ...................................................................................... 70
    RMS LIMITER ................................................................................................................................................................................71
    MBC CLOCKING CONTROL .........................................................................................................................................................71
    MBC CONTROL SEQUENCES .....................................................................................................................................................72
  DYNAMIC RANGE CONTROL (DRC) ..................................................................................... 74
    DRC COMPRESSION / EXPANSION / LIMITING .........................................................................................................................75
    GAIN LIMITS..................................................................................................................................................................................77
    DYNAMIC CHARACTERISTICS ...................................................................................................................................................77
    ANTI-CLIP CONTROL ...................................................................................................................................................................77
    QUICK RELEASE CONTROL .......................................................................................................................................................78
    SIGNAL ACTIVITY DETECT .........................................................................................................................................................78
    DRC REGISTER CONTROLS .......................................................................................................................................................78
  RETUNETM MOBILE PARAMETRIC EQUALIZER (EQ) .......................................................... 88
    DEFAULT MODE (5-BAND PARAMETRIC EQ) ...........................................................................................................................89
             TM
    RETUNE      MOBILE MODE...........................................................................................................................................................91
    EQ FILTER CHARACTERISTICS .................................................................................................................................................92
  3D STEREO EXPANSION ....................................................................................................... 93
  DIGITAL VOLUME AND FILTER CONTROL ........................................................................... 94
    AIF1 - OUTPUT PATH VOLUME CONTROL ................................................................................................................................94
    AIF1 - OUTPUT PATH HIGH PASS FILTER .................................................................................................................................96
    AIF1 - INPUT PATH VOLUME CONTROL ....................................................................................................................................98
    AIF1 - INPUT PATH SOFT MUTE CONTROL ............................................................................................................................101
    AIF1 - INPUT PATH NOISE GATE CONTROL ...........................................................................................................................102
    AIF1 - INPUT PATH MONO MIX CONTROL ...............................................................................................................................103
    AIF2 - OUTPUT PATH VOLUME CONTROL ..............................................................................................................................103
    AIF2 - OUTPUT PATH HIGH PASS FILTER ...............................................................................................................................104
    AIF2 - INPUT PATH VOLUME CONTROL ..................................................................................................................................105
    AIF2 - INPUT PATH SOFT MUTE CONTROL ............................................................................................................................106
    AIF2 - INPUT PATH NOISE GATE CONTROL ...........................................................................................................................106
    AIF2 - INPUT PATH MONO MIX CONTROL ...............................................................................................................................107
  DIGITAL TO ANALOGUE CONVERTER (DAC) .................................................................... 108
    DAC CLOCKING CONTROL .......................................................................................................................................................108
    DAC DIGITAL VOLUME ..............................................................................................................................................................110
    DAC SOFT MUTE AND SOFT UN-MUTE ...................................................................................................................................113
  ANALOGUE OUTPUT SIGNAL PATH ................................................................................... 115
    OUTPUT SIGNAL PATHS ENABLE ............................................................................................................................................116
    HEADPHONE SIGNAL PATHS ENABLE ....................................................................................................................................118
    OUTPUT MIXER CONTROL .......................................................................................................................................................120
    SPEAKER MIXER CONTROL .....................................................................................................................................................124
    OUTPUT SIGNAL PATH VOLUME CONTROL ...........................................................................................................................127
    SPEAKER BOOST MIXER ..........................................................................................................................................................131
    EARPIECE DRIVER MIXER ........................................................................................................................................................131
    LINE OUTPUT MIXERS ..............................................................................................................................................................133
                                                                                                                                                            PP, March 2014, Rev 3.5
w
                                                                                                                                                                                                  3


WM8958                                                                                                                                                                 Pre-Production
 CHARGE PUMP ..................................................................................................................... 137
 DC SERVO ............................................................................................................................. 139
   DC SERVO ENABLE AND START-UP .......................................................................................................................................139
   DC SERVO ACTIVE MODES ......................................................................................................................................................141
   GPIO / INTERRUPT OUTPUTS FROM DC SERVO ...................................................................................................................142
 ANALOGUE OUTPUTS ......................................................................................................... 143
   SPEAKER OUTPUT CONFIGURATIONS ...................................................................................................................................143
   HEADPHONE OUTPUT CONFIGURATIONS .............................................................................................................................146
   EARPIECE DRIVER OUTPUT CONFIGURATIONS ...................................................................................................................147
   LINE OUTPUT CONFIGURATIONS ............................................................................................................................................147
 EXTERNAL ACCESSORY DETECTION ............................................................................... 150
   ACCESSORY DETECTION WITH LOW FREQUENCY SYSCLK...............................................................................................154
 GENERAL PURPOSE INPUT/OUTPUT ................................................................................ 155
   GPIO CONTROL .........................................................................................................................................................................155
   GPIO FUNCTION SELECT .........................................................................................................................................................156
   BUTTON DETECT (GPIO INPUT) ...............................................................................................................................................158
   LOGIC ‘1’ AND LOGIC ‘0’ OUTPUT (GPIO OUTPUT) ................................................................................................................158
   INTERRUPT (IRQ) STATUS OUTPUT ........................................................................................................................................158
   OVER-TEMPERATURE DETECTION .........................................................................................................................................158
   MICROPHONE ACCESSORY STATUS DETECTION ................................................................................................................159
   FREQUENCY LOCKED LOOP (FLL) LOCK STATUS OUTPUT ................................................................................................159
   SAMPLE RATE CONVERTER (SRC) LOCK STATUS OUTPUT ...............................................................................................159
   DYNAMIC RANGE CONTROL (DRC) SIGNAL ACTIVITY DETECTION ....................................................................................160
   CONTROL WRITE SEQUENCER STATUS DETECTION ..........................................................................................................162
   DIGITAL CORE FIFO ERROR STATUS DETECTION................................................................................................................162
   OPCLK CLOCK OUTPUT ............................................................................................................................................................162
   FLL CLOCK OUTPUT ..................................................................................................................................................................163
 INTERRUPTS ........................................................................................................................ 164
 DIGITAL AUDIO INTERFACE ................................................................................................ 169
   MASTER AND SLAVE MODE OPERATION ...............................................................................................................................170
   OPERATION WITH TDM .............................................................................................................................................................170
   AUDIO DATA FORMATS (NORMAL MODE) ..............................................................................................................................171
   AUDIO DATA FORMATS (TDM MODE) .....................................................................................................................................174
 DIGITAL AUDIO INTERFACE CONTROL ............................................................................. 176
   AIF1 - MASTER / SLAVE AND TRI-STATE CONTROL ..............................................................................................................176
   AIF1 - SIGNAL PATH ENABLE ...................................................................................................................................................177
   AIF1 - BCLK AND LRCLK CONTROL .........................................................................................................................................177
   AIF1 - DIGITAL AUDIO DATA CONTROL ...................................................................................................................................180
   AIF1 - MONO MODE ...................................................................................................................................................................181
   AIF1 - COMPANDING .................................................................................................................................................................182
   AIF1 - LOOPBACK ......................................................................................................................................................................184
   AIF1 - DIGITAL PULL-UP AND PULL-DOWN .............................................................................................................................184
   AIF2 - MASTER / SLAVE AND TRI-STATE CONTROL ..............................................................................................................185
   AIF2 - SIGNAL PATH ENABLE ...................................................................................................................................................186
   AIF2 - BCLK AND LRCLK CONTROL .........................................................................................................................................186
   AIF2 - DIGITAL AUDIO DATA CONTROL ...................................................................................................................................189
   AIF2 - MONO MODE ...................................................................................................................................................................191
   AIF2 - COMPANDING .................................................................................................................................................................191
   AIF2 - LOOPBACK ......................................................................................................................................................................191
   AIF2 - DIGITAL PULL-UP AND PULL-DOWN .............................................................................................................................192
   AIF3 - SIGNAL PATH CONFIGURATION AND TRI-STATE CONTROL.....................................................................................193
   AIF3 - BCLK AND LRCLK CONTROL .........................................................................................................................................195
   AIF3 - DIGITAL AUDIO DATA CONTROL ...................................................................................................................................196
   AIF3 - COMPANDING .................................................................................................................................................................197
   AIF3 - LOOPBACK ......................................................................................................................................................................197
                                                                                                                                                      PP, March 2014, Rev 3.5
w
                                                                                                                                                                                           4


Pre-Production                                                                                                                                                             WM8958
  CLOCKING AND SAMPLE RATES........................................................................................ 198
    AIF1CLK ENABLE .......................................................................................................................................................................199
    AIF1 CLOCKING CONFIGURATION ..........................................................................................................................................200
    AIF2CLK ENABLE .......................................................................................................................................................................202
    AIF2 CLOCKING CONFIGURATION ..........................................................................................................................................202
    MISCELLANEOUS CLOCK CONTROLS ....................................................................................................................................204
    BCLK AND LRCLK CONTROL ....................................................................................................................................................207
    CONTROL INTERFACE CLOCKING ..........................................................................................................................................209
    FREQUENCY LOCKED LOOP (FLL) ..........................................................................................................................................209
    FREE-RUNNING FLL CLOCK .....................................................................................................................................................216
    GPIO OUTPUTS FROM FLL .......................................................................................................................................................217
    EXAMPLE FLL CALCULATION...................................................................................................................................................218
    EXAMPLE FLL SETTINGS ..........................................................................................................................................................219
  SAMPLE RATE CONVERSION ............................................................................................. 220
    SAMPLE RATE CONVERTER 1 (SRC1) ....................................................................................................................................220
    SAMPLE RATE CONVERTER 2 (SRC2) ....................................................................................................................................220
    SAMPLE RATE CONVERTER RESTRICTIONS ........................................................................................................................220
    SAMPLE RATE CONVERTER CONFIGURATION ERROR INDICATION .................................................................................222
  CONTROL INTERFACE......................................................................................................... 223
  CONTROL WRITE SEQUENCER.......................................................................................... 226
    INITIATING A SEQUENCE..........................................................................................................................................................226
    PROGRAMMING A SEQUENCE ................................................................................................................................................227
    DEFAULT SEQUENCES .............................................................................................................................................................229
  POP SUPPRESSION CONTROL .......................................................................................... 236
    DISABLED LINE OUTPUT CONTROL ........................................................................................................................................236
    LINE OUTPUT DISCHARGE CONTROL ....................................................................................................................................237
    VMID REFERENCE DISCHARGE CONTROL ............................................................................................................................237
    INPUT VMID CLAMPS ................................................................................................................................................................237
  LDO REGULATORS .............................................................................................................. 238
  REFERENCE VOLTAGES AND MASTER BIAS ................................................................... 240
  POWER MANAGEMENT ....................................................................................................... 242
  THERMAL SHUTDOWN ........................................................................................................ 247
  POWER ON RESET............................................................................................................... 248
  QUICK START-UP AND SHUTDOWN .................................................................................. 250
  SOFTWARE RESET AND DEVICE ID................................................................................... 251
REGISTER MAP ......................................................................................................... 252
  REGISTER BITS BY ADDRESS ............................................................................................ 264
APPLICATIONS INFORMATION ............................................................................... 356
  RECOMMENDED EXTERNAL COMPONENTS .................................................................... 356
    AUDIO INPUT PATHS .................................................................................................................................................................356
    HEADPHONE OUTPUT PATH ....................................................................................................................................................358
    EARPIECE DRIVER OUTPUT PATH ..........................................................................................................................................358
    LINE OUTPUT PATHS ................................................................................................................................................................358
    POWER SUPPLY DECOUPLING ...............................................................................................................................................359
    CHARGE PUMP COMPONENTS ...............................................................................................................................................360
    MICROPHONE BIAS CIRCUIT ...................................................................................................................................................360
    EXTERNAL ACCESSORY DETECTION COMPONENTS ..........................................................................................................362
    CLASS D SPEAKER CONNECTIONS ........................................................................................................................................363
    RECOMMENDED EXTERNAL COMPONENTS DIAGRAM .......................................................................................................364
  DIGITAL AUDIO INTERFACE CLOCKING CONFIGURATIONS........................................... 366
  PCB LAYOUT CONSIDERATIONS ....................................................................................... 369
    CLASS D LOUDSPEAKER CONNECTION ................................................................................................................................369
                                                                                                                                                       PP, March 2014, Rev 3.5
w
                                                                                                                                                                                            5


WM8958                                                                                                                      Pre-Production
PACKAGE DIMENSIONS ........................................................................................... 370
IMPORTANT NOTICE ................................................................................................ 371
 ADDRESS: ............................................................................................................................. 371
REVISION HISTORY .................................................................................................. 372
                                                                                                                PP, March 2014, Rev 3.5
w
                                                                                                                                          6


                                                             DCVDD               DBVDD1          DBVDD2      DBVDD3          DGND                        AVDD2                                                 LDO1VDD                        SPKVDD1 SPKGND1 SPKVDD2 SPKGND2                                                                                                                  HP2GND
                                                                                                                                                                                                                                                                                                                                                                                                            IN1LN
                                         IN1LN
                                                                                                                                                                                                                                                                                                                                                                                                            IN1LP
                                         IN1LP
                                                                                                                                                                                                                                                                                                                                                                                                            IN2LN
                               IN2LN/DMICDAT1
                                                                                                                                                                                                                                                                                                                                                                                                 IN2LP/VRXN
                                   IN2LP/VRXN
                                                                                                                                                                                                                                                                                                                                                                                                           IN2RN
                              IN2RN/DMICDAT2
                                                                                                                                                                                                                                                                                                                                                                                                 IN2RP/VRXP
                                   IN2RP/VRXP
                                                                                                                                                                                                                                                                                                                                                                                                           IN1RN
                                        IN1RN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        Direct Voice
                                                                                                                                                                                                                                                                                                                                                                                                           IN1RP
                                        IN1RP
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Pre-Production
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               LINEOUT1NMIX
                                                                                                                                                                                                                                                                                                                                                                                                                    IN1L
                                                                                                                                                                                                                                                                                                                                                                                                                IN1R
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +                                    LINEOUT1N
                                                                                                                                                                                                                                                                                                                                                                                                         MIXINL
                                                                                                                       -                                                                                                                                                                                                                                                                               MIXINR                                                                                                                                                         0dB or -6dB           Ground Loop
                                                                                                                             RXVOICE
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           Noise Rejection
                                                                                                                       +                                                                                                                                                                                                                                                                                                                                                                                                                                      LINEOUT1PMIX
                                                                                                                                                                                                                                                                                  Gain Codes
                                                                                                                                                                                                                                                                                  V = Full volume control                                                                                                                                                                                                                                                                    +                                    LINEOUT1P
    w
                                                                                                                                                                                                                                                                                     (-71.625dB to 12dB, 0.375dB steps for DAC
                                                                                                                                                                                                                                                                 [Code]               -71.625dB to 17.625dB, 0.375dB steps for ADC/MICs)
                                                                                                                                                                                                                                                                                  S = Softmute/un-mute                                                                                                                                                                                                                                                                0dB or -6dB
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            SPKMIXL                                                                                                         Ground Loop
                                                                                                                                                                                                                                                                                  NG = Digital Noise Gate
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              BLOCK DIAGRAM
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           Noise Rejection
                                                                                                                                                                                                    DMICDAT1   DMICDAT2
                                                                                                                                                                                                                                                                                  G = Fixed gain control
                                                                                                                                                                                                                                                                                     (-36dB to 0dB, 3dB steps)
                                                                                                                                                                                                                                                                                                                                        DAC1L                                                                                                                                        +
                                                                                                                                                                                                                                                                                                                                         Vol                                                                                                                                                                    SPKLVOL
                                                                                                                                                                                              Digital                                                                                                                                                                                                                                                                                                           Min = -57dB                                                          Direct Voice
                                                                                                                                                                                                                                                                                                                                                                                        DAC
                                                                                                                                                                                              MIC                                                                                                                  +                                                                    1L                                                                                                                      Max = +6dB
                                                                                                                                                                                              Inputs                                                                                                                                                                                                                                                                                                            Step = 1dB                              SPKOUTLBOOST
                                                                                                                                                                                                                                                                                                                                        VS                                                                                                                                   0dB or -3dB
                                                                                                                                                                                                                                                                 G G                                                                                                                                                                                                               REC L
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  SPKOUTLN
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +                                         SPKOUTLP
                                                                                           -16.5dB min
                                                                                           +30dB max                                                                                                                                                                                                                                                                                                                                                                        MIXOUTL                    Min = -57dB                                       0dB to +12dB, 1.5dB step
                                                                                           1.5dB step                                                                                                                                                                                                                                   DAC1R                                                                                                                                                          Max = +6dB
                                                                                                                                                                                                                                                                                                                                         Vol                                                                                                                                                           Step = 1dB
                                                                                     -                                                                                                                                                                                                                                                                                                                                                                                                                 HPOUT1LVOL
                                                                                                                                                                                                                                                                                                                                                                                        DAC
                                                                                                                                                                                                                                                                                                                   +                                                                    1R
                                                                                     +         IN1L
                                                                                                                                                                                                                                                                                                                                        VS                                                                                                                                                                                                                                                                        HPOUT1L
                                                                                                                                                                  REC L                                                                                         G G                                                                                                                                                                                                                  +
                                                                                                                                    -12dB to +6dB,
                                                                                           -16.5dB min                                                                                                                                                                                                                                                                                                                                                                                                                                                                              DC Offset Correction
                                                                                                                                         3dB step                                                                                                                                                                                                                                                                                                                                                                    Min = -57dB
                                                                                           +30dB max                                                                                                                                                                                                                                                                                                                                                                                                                                                                                Ground Loop Noise Rejection
                                                                                           1.5dB step                                                                                                                                                                                                                                                                                                                                                                                                                Max = +6dB
                                                                                                                                                                                                                                                                                                                                        DAC2L
                                                                                                                                         0dB or +30dB                                                                                                                                                                                                                                                                                                                                                                Step = 1dB
                                                                                                                                                                                                                                                                                                                                         Vol
                                                                                     -                                                                                                                                                                                                                                                                                                                                                                                                                         MIXOUTLVOL
                                                                                                                                         0dB or +30dB                                         ADC                                                                                                                                                                                       DAC
                                                                                                                                                                   +                                                                                                                                               +                                                                                                                                                     -9dB to 0dB, 3dB step                                                                                       Direct Voice
                                                                                                                                                                                                L                                                                                                                                                                                       2L
                                                                                               IN2L                            -12dB to +6dB, 3dB step
                                                                                     +                                                                                                                                                                                                                                                  VS
                                                                                                                               -12dB to +6dB, 3dB step                                                                                                          G G                                                                                                                                                                                                 Direct DAC1L                                                                              HPOUT2MIX
                                                                                           -16.5dB min                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            HPOUT2P
                                                                                                                                                                MIXINL                                                                                                                                                                                                                                                                                                                                               Min = -57dB                                             +
                                                                                           +30dB max                           -12dB to +6dB, 3dB step                                                                                                                                                                                                                                                                                                              Direct DAC1R                                                                                                                                  HPOUT2N
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     Max = +6dB
                                                                                           1.5dB step                                                                                                                                                                                                                                   DAC2R                                                                                                                                                                        Step = 1dB                                       0dB or -6dB
                                                                                                                               -12dB to +6dB, 3dB step                                                                                                                                                                                   Vol
                                                                                     -                                                                                                                                                                                                                                                                                                                                                                                                                          MIXOUTRVOL
                                                                                                                                         0dB or +30dB                                         ADC                                                                                                                                                                                       DAC
                                                                                                                                                                   +                            R                                                                                                                  +                                                                    2R                                                                                  MIXOUTR
                                                                                     +        IN2R                                       0dB or +30dB
                                                                                                                                                                                                                                                                                                                                        VS
                                                                                                                                                                                                                                                                G G
                                                                                           -16.5dB min                             -12dB to +6dB,               MIXINR
                                                                                           +30dB max                                    3dB step
                                                                                           1.5dB step
                                                                                                                                                                  REC R                                                                                                                                                                                                                                                                                                              +                                                                                                                            HPOUT1R
                                                                                     -
                                                                                              IN1R                                                                                                                                                                                                                                                                                                                                                                                                 HPOUT1RVOL
                                                                                     +                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              DC Offset Correction
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Min = -57dB                                                                      Ground Loop Noise Rejection
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Max = +6dB
                                                                                                                                                                   Digital MIC Clock                                          +       +        +        +                                                                                                                                                                                                                                          Step = 1dB
                                     DMICCLK                                                                                                                                                                                                                                                                                                                                                                                                                             -9dB to 0dB, 3dB step                                                                                       Direct Voice
                                                                                                                                                                           Sample Rate Conversion                                                                                                                                                                                                                                                                                  REC R
                                                                                                                                             (2 duplex channels max, not available where marked )                                                                                                                                                                                                                                                                                                                                                       SPKOUTRBOOST
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            SPKMIXR                                                                                                                               SPKOUTRN
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +                                         SPKOUTRP
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         0dB to +12dB, 1.5dB step
                                                                                                                                                                            Multi-band Compressor (MBC)                                                                                                                                                                                                                                                                              +
                                                                                                                                                                                                                                                                           MBC                      MBC                           MBC
                                                                                                                                                                           available on AIF1 or AIF2 input,                                                                                                                                                                                                                                                                                                     SPKRVOL
                                                                                                                                                                                                  not both.                                                                                                                                                                                                                                                                                                     Min = -57dB
                                                                                                                                                                                                                                                                           DRC                      DRC                           DRC                                                                                                                                                                           Max = +6dB
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                Step = 1dB                                   LINEOUT2NMIX
                                                                                                                                                                                                                                                                                                                                                                                                                                                                              0dB or -3dB
                                                                         ACCESSORY                                                                                         Dynamic Range Control (DRC)                                                                       EQ                      EQ                            EQ
                                      MICDET                             INTERFACE                    GPIO                                                               available on input or output paths,                  DRC              DRC                                                                                                                DRC
                                                                          CONTROL                                                                                                                                                                                              3D                        3D                           3D                                                                                                                                                                                                                                     +                                    LINEOUT2N
                                                                                                                                                                                                   not both.
                                                                                                                                                                                                                          V                                                                                                                          V
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      0dB or -6dB           Ground Loop
                                                                                                                                                                                                                                                               VS, NG                                                  VS, NG                                                                                                                                                                                                                                                              Noise Rejection
                                                                                                                                                                           DRC / Microphone signal
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               LINEOUT2PMIX
                                                                                                                                                                            activity detector (GPIO)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +                                    LINEOUT2P
                                                                                   BCLK1                                                                         AIF1CLK
                                                                                  LRCLK1                     FLL1                                                                                                                                                                                                                Left / Right source select /                                                                                                                                                                                                         0dB or -6dB
                                                                                                                                                                                                                                   Left / Right source select / Mono Mix control                                                                                                                                                                                                                                                                                                            Ground Loop
                                     MICBIAS1                    AVDD1                                                                                           SYSCLK                                                                                                                                                               Mono Mix control                                                                                                                                                                                                                                     Noise Rejection
                                                                                                                                                                 AIF2CLK
                                                                                   BCLK2
                                                                                  LRCLK2                     FLL2                                                                                                             0R      0L      1R       1L                 0R          0L            1R        1L                 0R          0L                 0R              0L
                                     MICBIAS2                    AVDD1                                                                                                                                                                   DIGITAL AUDIO                                                                            DIGITAL AUDIO                                               MONO PCM
                                                                                                                                                                                                                                       INTERFACE 1 (AIF1)                                                                       INTERFACE 2 (AIF2)                                            INTERFACE
                                                                                                                                                                  AVDD1                       DCVDD
                                                                                                                                                LDO1VDD                          DBVDD1
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  CPCA
                                                             VMID                                                   AVDD2                                                                                                                                                                                                                                                                                                                                                                                                                                                             CHARGE                      CPCB
                                                                                                                                                     LDO1                         LDO2                                                                                                                                                                                                                                                BCLK2                                                 CONTROL
                                                          GENERATOR                                                                                                                                                                                                                                                                                                                                                                   BCLK1                                                                                                                                            PUMP                       CPVOUTP
                                                                                                                                                                                                                                                                                                                                                                                                                                     LRCLK2                                                INTERFACE
                                                                                                                VOLTAGE                                                                                                                                                                                                                                                                                                              LRCLK1                                                                                                                                                                       CPVOUTN
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Headphone         Line Output
                                                                                                               REFERENCE                                                                                                                                                                                                                                                                                                                                                                                       Mono Speaker         Ground Loop       Ground Loop
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Output Mode         Noise Rejection   Noise Rejection
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  Select                Input             Input
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ADDR
                                                                                         MCLK1                                                                                                                                                                                                                                                                                                                                                                                              SDA
                                                          AGND   VMIDC   AVDD1                                       VREFC                                                                                                                 BCLK1                                                                                BCLK2                                                                                                                                                       SCLK                                                                                                CPVDD
                                                 REFGND                                  MCLK2                                                                                                                                                     LRCLK1                                                                                LRCLK2                                                                                                                                                                                                                                         CPGND
                                                                                                                                                      LDO1ENA                       LDO2ENA                                                                 DACDAT1     ADCDAT1                                                                   DACDAT2                     ADCDAT2                                                                                                                                SPKMODE            HPOUT1FB          LINEOUTFB
                                                                                                                                                                                                                                                                                                                                                                                                                                                     GPIO11/BCLK3
                                                                                                                                                                                                                                                                                                                                                                                                    GPIO9/ADCDAT3    GPIO8/DACDAT3   GPIO10/LRCLK3
                                                                                                                                                                                                                                                                                  GPIO1/ADCLRCLK1                                                           GPIO6/ADCLRCLK2
7
    PP, March 2014, Rev 3.5
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              WM8958


 WM8958                                                                                    Pre-Production
 PIN CONFIGURATION
 ORDERING INFORMATION
    ORDER CODE       TEMPERATURE RANGE        PACKAGE              MOISTURE        PEAK SOLDERING
                                                                SENSITIVITY LEVEL   TEMPERATURE
 WM8958ECS/R            -40C to +85C     72-ball W-CSP              MSL1              260C
                                       (Pb-free, Tape and reel)
Note:
Reel quantity = 5000
                                                                                  PP, March 2014, Rev 3.5
w
                                                                                                        8


Pre-Production                                                                                                           WM8958
PIN DESCRIPTION
A description of each pin on the WM8958 is provided below.
Note that a table detailing the associated power domain for every input and output pin is provided on the following page.
Note that, where multiple pins share a common name, these pins should be tied together on the PCB.
 PIN NO         NAME                    TYPE                                            DESCRIPTION
   F1         ADCDAT1          Digital Output         Audio interface 1 ADC digital audio data
   F4         ADCDAT2          Digital Output         Audio interface 2 ADC digital audio data
   D3           ADDR           Digital Input          2-wire (I2C) address select
 D7, E6         AGND           Supply                 Analogue ground (Return path for AVDD1, AVDD2 and LDO1VDD)
   D8           AVDD1          Supply / Analogue      Analogue core supply / LDO1 Output
                               Output
   D9           AVDD2          Supply                 Bandgap reference, analogue Class D and FLL supply
   F2           BCLK1          Digital Input / Output Audio interface 1 bit clock
   G3           BCLK2          Digital Input / Output Audio interface 2 bit clock
   G8           CPCA           Analogue Output        Charge pump fly-back capacitor pin
   H8           CPCB           Analogue Output        Charge pump fly-back capacitor pin
   H9          CPGND           Supply                 Charge pump ground (Return path for CPVDD)
   G9          CPVDD           Supply                 Charge pump supply
   H7         CPVOUTN          Analogue Output        Charge pump negative supply decoupling pin (HPOUT1L, HPOUT1R)
   G7         CPVOUTP          Analogue Output        Charge pump positive supply decoupling pin (HPOUT1L, HPOUT1R)
   G1         DACDAT1          Digital Input          Audio interface 1 DAC digital audio data
   E4         DACDAT2          Digital Input          Audio interface 2 DAC digital audio data
   D1          DBVDD1          Supply                 Digital buffer (I/O) supply (core functions and Audio Interface 1)
   F3          DBVDD2          Supply                 Digital buffer (I/O) supply (for Audio Interface 2)
   H5          DBVDD3          Supply                 Digital buffer (I/O) supply (for Audio Interface 3)
   E2          DCVDD           Supply / Analogue      Digital core supply / LDO2 output
                               Output
   G5           DGND           Supply                 Digital ground (Return path for DCVDD, DBVDD1, DBVDD2, DBVDD3)
   D6         DMICCLK          Digital Output         Digital MIC clock output
   H1           GPIO1/         Digital Input / Output General Purpose pin GPIO 1 /
             ADCLRCLK1                                Audio interface 1 ADC left / right clock
   F5          GPIO10/         Digital Input / Output General Purpose pin GPIO 10 /
               LRCLK3                                 Audio interface 3 left / right clock
   E5          GPIO11/         Digital Input / Output General Purpose pin GPIO 11 /
                BCLK3                                 Audio interface 3 bit clock
   H3           GPIO6/         Digital Input / Output General Purpose pin GPIO 6 /
             ADCLRCLK2                                Audio interface 2 ADC left / right clock
   G4           GPIO8/         Digital Input / Output General Purpose pin GPIO 8 /
              DACDAT3                                 Audio interface 3 DAC digital audio data
   H4           GPIO9/         Digital Input / Output General Purpose pin GPIO 9 /
              ADCDAT3                                 Audio interface 3 ADC digital audio data
   F7          HP2GND          Supply                 Analogue ground
   G6        HPOUT1FB          Analogue Input         HPOUT1L and HPOUT1R ground loop noise rejection feedback
   H6         HPOUT1L          Analogue Output        Left headphone output
   F6         HPOUT1R          Analogue Output        Right headphone output
   F9         HPOUT2N          Analogue Output        Earpiece speaker inverted output
   F8         HPOUT2P          Analogue Output        Earpiece speaker non-inverted output
   C7           IN1LN          Analogue Input         Left channel single-ended MIC input /
                                                      Left channel negative differential MIC input
   C8           IN1LP          Analogue Input         Left channel line input /
                                                      Left channel positive differential MIC input
                                                                                                             PP, March 2014, Rev 3.5
w
                                                                                                                                   9


WM8958                                                                                                     Pre-Production
PIN NO      NAME           TYPE                                            DESCRIPTION
  B7       IN1RN  Analogue Input         Right channel single-ended MIC input /
                                         Right channel negative differential MIC input
  C6        IN1RP Analogue Input         Right channel line input /
                                         Right channel positive differential MIC input
  B9       IN2LN/ Analogue Input /       Left channel line input /
        DMICDAT1  Digital Input          Left channel negative differential MIC input /
                                         Digital MIC data input 1
  B8   IN2LP/VRXN Analogue Input         Left channel line input /
                                         Left channel positive differential MIC input /
                                         Mono differential negative input (RXVOICE -)
  A8       IN2RN/ Analogue Input /       Right channel line input /
        DMICDAT2  Digital Input          Right channel negative differential MIC input /
                                         Digital MIC data input 2
  A9   IN2RP/VRXP Analogue Input         Left channel line input /
                                         Left channel positive differential MIC input /
                                         Mono differential positive input (RXVOICE +)
  C3     LDO1ENA  Digital Input          Enable pin for LDO1
  E8     LDO1VDD  Supply                 Supply for LDO1
  D5     LDO2ENA  Digital Input          Enable pin for LDO2
  C5    LINEOUT1N Analogue Output        Negative mono line output / Positive left or right line output
  B5    LINEOUT1P Analogue Output        Positive mono line output / Positive left line output
  C4    LINEOUT2N Analogue Output        Negative mono line output / Positive left or right line output
  B4    LINEOUT2P Analogue Output        Positive mono line output / Positive left line output
  A6    LINEOUTFB Analogue Input         Line output ground loop noise rejection feedback
  D4      LRCLK1  Digital Input / Output Audio interface 1 left / right clock
  H2      LRCLK2  Digital Input / Output Audio interface 2 left / right clock
  E1       MCLK1  Digital Input          Master clock 1
  D2       MCLK2  Digital Input          Master clock 2
  A7     MICBIAS1 Analogue Output        Microphone bias 1
  B6     MICBIAS2 Analogue Output        Microphone bias 2
  E9      MICDET  Analogue Input         Microphone & accessory sense input
  A5      REFGND  Supply                 Analogue ground
  E3         SCLK Digital Input          Control interface clock input
  G2         SDA  Digital Input / Output Control interface data input and output / acknowledge output
  A1     SPKGND1  Supply                 Ground for speaker driver (Return path for SPKVDD1)
  C1     SPKGND2  Supply                 Ground for speaker driver (Return path for SPKVDD2)
  A4     SPKMODE  Digital Input          Mono / Stereo speaker mode select
  B3    SPKOUTLN  Analogue Output        Left speaker negative output
  A3    SPKOUTLP  Analogue Output        Left speaker positive output
  B1    SPKOUTRN  Analogue Output        Right speaker negative output
  B2    SPKOUTRP  Analogue Output        Right speaker positive output
  A2     SPKVDD1  Supply                 Supply for speaker driver 1 (Left channel)
  C2     SPKVDD2  Supply                 Supply for speaker driver 2 (Right channel)
  C9       VMIDC  Analogue Output        Midrail voltage decoupling capacitor
  E7       VREFC  Analogue Output        Bandgap reference decoupling capacitor
                                                                                                  PP, March 2014, Rev 3.5
w
                                                                                                                       10


 Pre-Production                                                                                                         WM8958
The following table identifies the power domain and ground reference associated with each of the input / output pins.
  PIN NO              NAME                  POWER DOMAIN                    GROUND DOMAIN
     F1            ADCDAT1             DBVDD1                          DGND
     F4            ADCDAT2             DBVDD2                          DGND
    D3               ADDR              DBVDD1                          DGND
     F2              BCLK1             DBVDD1                          DGND
    G3               BCLK2             DBVDD2                          DGND
    G1             DACDAT1             DBVDD1                          DGND
     E4            DACDAT2             DBVDD2                          DGND
    D6             DMICCLK             MICBIAS1                        AGND
    H1       GPIO1/ADCLRCLK1           DBVDD1                          DGND
    H3       GPIO6/ADCLRCLK2           DBVDD2                          DGND
    G4         GPIO8/DACDAT3           DBVDD3                          DGND
    H4         GPIO9/ADCDAT3           DBVDD3                          DGND
     F5         GPIO10/LRCLK3          DBVDD3                          DGND
     E5         GPIO11/BCLK3           DBVDD3                          DGND
    H6             HPOUT1L             CPVOUTP, CPVOUTN                CPGND
     F6            HPOUT1R             CPVOUTP, CPVOUTN                CPGND
     F9            HPOUT2N             AVDD1                           HP2GND
     F8            HPOUT2P             AVDD1                           HP2GND
    C7               IN1LN             AVDD1                           AGND
    C8               IN1LP             AVDD1                           AGND
     B7              IN1RN             AVDD1                           AGND
    C6               IN1RP             AVDD1                           AGND
     B9        IN2LN/DMICDAT1          AVDD1 (IN2LN) or                AGND
                                       MICBIAS1 (DMICDAT1)
     B8          IN2LP/VRXN            AVDD1                           AGND
     A8       IN2RN/DMICDAT2           AVDD1 (IN2RN) or                AGND (IN2RN) or
                                       MICBIAS1 (DMICDAT2)             DGND (DMICDAT2)
     A9          IN2RP/VRXP            AVDD1                           AGND
    C3             LDO1ENA             DBVDD1                          DGND
    D5             LDO2ENA             DBVDD1                          DGND
    C5            LINEOUT1N            AVDD1                           AGND
     B5           LINEOUT1P            AVDD1                           AGND
    C4            LINEOUT2N            AVDD1                           AGND
     B4           LINEOUT2P            AVDD1                           AGND
    D4              LRCLK1             DBVDD1                          DGND
    H2              LRCLK2             DBVDD2                          DGND
     E1              MCLK1             DBVDD1                          DGND
    D2               MCLK2             DBVDD1                          DGND
     E9             MICDET             MICBIAS2                        AGND
     E3               SCLK             DBVDD1                          DGND
    G2                SDA              DBVDD1                          DGND
     A4            SPKMODE             DBVDD1                          DGND
     B3           SPKOUTLN             SPKVDD1                         SPKGND1
     A3           SPKOUTLP             SPKVDD1                         SPKGND1
     B1           SPKOUTRN             SPKVDD2                         SPKGND2
     B2           SPKOUTRP             SPKVDD2                         SPKGND2
                                                                                                             PP, March 2014, Rev 3.5
w
                                                                                                                                  11


WM8958                                                                                                              Pre-Production
ABSOLUTE MAXIMUM RATINGS
Absolute Maximum Ratings are stress ratings only. Permanent damage to the device may be caused by continuously operating at or
beyond these limits. Device functional operating limits and guaranteed performance specifications are given under Electrical
Characteristics at the test conditions specified.
                     ESD Sensitive Device. This device is manufactured on a CMOS process. It is therefore generically susceptible
                     to damage from excessive static voltages. Proper ESD precautions must be taken during handling and storage
                     of this device.
Wolfson tests its package types according to IPC/JEDEC J-STD-020 for Moisture Sensitivity to determine acceptable storage
conditions prior to surface mount assembly. These levels are:
MSL1 = unlimited floor life at <30C / 85% Relative Humidity. Not normally stored in moisture barrier bag.
MSL2 = out of bag storage for 1 year at <30C / 60% Relative Humidity. Supplied in moisture barrier bag.
MSL3 = out of bag storage for 168 hours at <30C / 60% Relative Humidity. Supplied in moisture barrier bag.
The Moisture Sensitivity Level for each package type is specified in Ordering Information.
                                  CONDITION                                              MIN                       MAX
Supply voltages (AVDD1, DBVDD2, DBVDD3)                                                 -0.3V                     +4.5V
Supply voltages (AVDD2, DCVDD, DBVDD1)                                                  -0.3V                     +2.5V
Supply voltages (CPVDD)                                                                 -0.3V                     +2.2V
Supply voltages (SPKVDD1, SPKVDD2, LDO1VDD)                                             -0.3V                     +7.0V
Voltage range digital inputs (DBVDD1 domain)                                        AGND - 0.3V              DBVDD1 + 0.3V
Voltage range digital inputs (DBVDD2 domain)                                        AGND - 0.3V              DBVDD2 + 0.3V
Voltage range digital inputs (DBVDD3 domain)                                        AGND - 0.3V              DBVDD3 + 0.3V
Voltage range digital inputs (DMICDATn)                                             AGND - 0.3V               AVDD1 + 0.3V
Voltage range analogue inputs (AVDD1 domain)                                        AGND - 0.3V               AVDD1 + 0.3V
Voltage range analogue inputs (MICDET, LINEOUTFB)                                   AGND - 0.3V               AVDD1 + 0.3V
Voltage range analogue inputs (HPOUT1FB)                                            AGND - 0.3V                AGND + 0.3V
Ground (DGND, CPGND, SPKGND1, SPKGND2, REFGND, HP2GND)                              AGND - 0.3V                AGND + 0.3V
Operating temperature range, TA                                                         -40ºC                     +85ºC
Junction temperature, TJMAX                                                             -40ºC                    +150ºC
Storage temperature after soldering                                                     -65ºC                    +150ºC
                                                                                                           PP, March 2014, Rev 3.5
w
                                                                                                                                 12


Pre-Production                                                                                                     WM8958
RECOMMENDED OPERATING CONDITIONS
PARAMETER                                        SYMBOL                  MIN           TYP            MAX             UNIT
Digital supply range (Core)                       DCVDD                 1.08            1.2            2.0               V
See notes 7, 8
Digital supply range (I/O)                       DBVDD1                 1.62            1.8            2.0               V
Digital supply range (I/O)                  DBVDD2, DBVDD3              1.62            1.8            3.6               V
Analogue supply 1 range                           AVDD1                  2.4            3.0            3.3               V
See notes 3, 4, 5, 6
Analogue supply 2 range                           AVDD2                 1.71            1.8            2.0               V
Charge Pump supply range                          CPVDD                 1.71            1.8            2.0               V
Speaker supply range                       SPKVDD1, SPKVDD2              2.7            5.0            5.5               V
LDO1 supply range                               LDO1VDD                  2.7            5.0            5.5               V
Ground                                    DGND, AGND, CPGND,                              0                              V
                                          SPKGND1, SPKGND2,
                                            REFGND, HP2GND
Power supply rise time                         All supplies               1                                             s
See notes 9, 10, 11
Operating temperature range                          TA                  -40                           85               °C
Notes:
1.    Analogue, digital and speaker grounds must always be within 0.3V of AGND.
2.    There is no power sequencing requirement; the supplies may be enabled in any order.
3.    AVDD1 must be less than or equal to SPKVDD1 and SPKVDD2.
4.    An internal LDO (powered by LDO1VDD) can be used to provide the AVDD1 supply.
5.    When AVDD1 is supplied externally (not from LDO1), the LDO1VDD voltage must be greater than or equal to AVDD1.
6.    The WM8958 can operate with AVDD1 tied to 0V; power consumption may be reduced, but the analogue audio functions will
      not be supported.
7.    An internal LDO (powered by DBVDD1) can be used to provide the DCVDD supply.
8.    When DCVDD is supplied externally (not from LDO2), the DBVDD1 voltage must be greater than or equal to DCVDD.
9.    DCVDD and AVDD1 minimum rise times do not apply when these domains are powered using the internal LDOs.
10. The specified minimum power supply rise times assume a minimum decoupling capacitance of 100nF per pin. However,
      Wolfson strongly advises that the recommended decoupling capacitors are present on the PCB and that appropriate layout
      guidelines are observed (see “Applications Information” section).
11. The specified minimum power supply rise times also assume a maximum PCB inductance of 10nH between decoupling
      capacitor and pin.
                                                                                                       PP, March 2014, Rev 3.5
w
                                                                                                                             13


WM8958                                                                                                                  Pre-Production
THERMAL PERFORMANCE
                              Thermal analysis should be performed in the intended application to prevent the WM8958 from
                              exceeding maximum junction temperature. Several contributing factors affect thermal performance
                              most notably the physical properties of the mechanical enclosure, location of the device on the PCB in
                              relation to surrounding components and the number of PCB layers. Connecting the GND balls through
                              thermal vias and into a large ground plane will aid heat extraction.
                              Three main heat transfer paths exist to surrounding air as illustrated below in Figure 1:
                                         -    Package top to air (radiation).
                                         -    Package bottom to PCB (radiation).
                                         -    Package balls to PCB (conduction).
                              Figure 1 Heat Transfer Paths
                              The temperature rise TR is given by TR = PD * ӨJA
                                         -    PD is the power dissipated in the device.
                                         -    ӨJA is the thermal resistance from the junction of the die to the ambient temperature
                                              and is therefore a measure of heat transfer from the die to surrounding air. ӨJA is
                                              determined with reference to JEDEC standard JESD51-9.
                              The junction temperature TJ is given by TJ = TA +TR, where TA is the ambient temperature.
PARAMETER                                        SYMBOL                     MIN             TYP             MAX             UNIT
Operating temperature range                          TA                     -40                               85             °C
Operating junction temperature                        TJ                    -40                              125             °C
Thermal Resistance                                   ӨJA                                     48                             °C/W
Note:
Junction temperature is a function of ambient temperature and of the device operating conditions. The ambient temperature limits
and junction temperature limits must both be observed.
                                                                                                             PP, March 2014, Rev 3.5
w
                                                                                                                                   14


 Pre-Production                                                                                                              WM8958
 ELECTRICAL CHARACTERISTICS
 INPUT SIGNAL LEVEL
   Test Conditions
   AVDD1 = 3.0V.
   With the exception of the condition(s) noted above, the following electrical characteristics are valid across the full range of
   recommended operating conditions.
   PARAMETER                                                    TEST CONDITIONS                            MIN     TYP       MAX   UNIT
   A1      Full-Scale PGA Input           Single-ended PGA input                                                    1.0            Vrms
           Signal Level                                                                                              0             dBV
           See notes 1, 2, 3 and 4
                                            Differential PGA input                                                  1.0            Vrms
                                                                                                                     0             dBV
   A2      Full-Scale Line Input         Single-ended Line input to                                                 1.0            Vrms
           Signal Level                  MIXINL/R, SPKMIXL/R or                                                      0             dBV
                                             MIXOUTL/R mixers
           See notes 1, 2, 3 and 4
                                            Differential mono line                                                  1.0            Vrms
                                          input on VRXP/VRXN to                                                      0             dBV
                                         RXVOICE or Direct Voice
                                          paths to speaker outputs
                                             or earpiece output
Notes:
1.   The full-scale input signal level changes in proportion with AVDD1. It is calculated as AVDD1/3.0.
2.   When mixing line inputs, input PGA outputs and DAC outputs the total signal must not exceed 1.0Vrms (0dBV).
3.   A 1.0Vrms differential signal equates to 0.5Vrms/-6dBV per input.
4.   A sinusoidal input signal is assumed.
                                                                                                                PP, March 2014, Rev 3.5
w
                                                                                                                                     15


WM8958                                                                                                                    Pre-Production
INPUT PIN RESISTANCE
 Test Conditions
          o
 TA = +25 C.
 With the exception of the condition(s) noted above, the following electrical characteristics are valid across the full range of
 recommended operating conditions.
 PARAMETER                                                  TEST CONDITIONS                              MIN     TYP       MAX    UNIT
 B1     PGA Input Resistance                  Gain = -16.5dB                                                      53               k
        Differential Mode                    (INnx_VOL=00h)
                                                Gain = 0dB                                                        25               k
        See note 5                          (INnx_VOL=0Bh)
                                               Gain = +30dB                                                       1.3              k
        See “Applications                   (INnx_VOL=1Fh)
        Information” for details of
        Input resistance at all
        PGA Gain settings.
 B2     PGA Input Resistance                  Gain = -16.5dB                                                      58               k
        Single-Ended Mode                    (INnx_VOL=00h)
                                                Gain = 0dB                                                        36               k
        See note 5                          (INnx_VOL=0Bh)
                                               Gain = +30dB                                                       2.5              k
        See “Applications                   (INnx_VOL=1Fh)
        Information” for details of
        Input resistance at all
        PGA Gain settings.
 B3     Line Input Resistance             IN1LP to MIXINL, or                                                     56               k
                                            IN1RP to MIXINR
        See note 5                             Gain = -12dB
                                     (IN1xP_MIXINx_VOL=001)
                                          IN1LP to MIXINL, or                                                     17               k
                                            IN1RP to MIXINR
                                                Gain = 0dB
                                     (IN1xP_MIXINx_VOL=101)
                                          IN1LP to MIXINL, or                                                     9.8              k
                                            IN1RP to MIXINR
                                               Gain = +6dB
                                     (IN1xP_MIXINx_VOL=111)
                                          IN1LP to MIXINL, or                                                     3.7              k
                                            IN1RP to MIXINR
                                               Gain = +15dB
                                     (IN1xP_MIXINx_VOL=111,
                                     IN1xP_MIXINx_BOOST=1)
                                        IN1LP to SPKMIXL, or                                                      89               k
                                          IN1RP to SPKMIXR
                                          (SPKATTN = -12dB)
                                        IN1LP to SPKMIXL, or                                                      27               k
                                          IN1RP to SPKMIXR
                                           (SPKATTN = 0dB)
                                       IN2LN, IN2RN, IN2LP or                                                     43               k
                                         IN2RP to MIXOUTL or
                                                 MIXOUTR
                                                Gain = -9dB
                                        (*MIXOUTx_VOL=011)
                                       IN2LN, IN2RN, IN2LP or                                                     18               k
                                         IN2RP to MIXOUTL or
                                                 MIXOUTR
                                                Gain = 0dB
                                        (*MIXOUTx_VOL=000)
                                                                                                              PP, March 2014, Rev 3.5
w
                                                                                                                                     16


 Pre-Production                                                                                                              WM8958
   Test Conditions
            o
   TA = +25 C.
   With the exception of the condition(s) noted above, the following electrical characteristics are valid across the full range of
   recommended operating conditions.
   PARAMETER                                                   TEST CONDITIONS                             MIN     TYP       MAX   UNIT
                                          RXVOICE to MIXINL or                                                      48              k
                                                  MIXINR
                                               Gain = -12dB
                                       (IN2LRP_MIXINx_VOL=001)
                                          RXVOICE to MIXINL or                                                      12              k
                                                  MIXINR
                                                 Gain = 0dB
                                       (IN2LRP_MIXINx_VOL=101)
                                          RXVOICE to MIXINL or                                                      6.0             k
                                                  MIXINR
                                                Gain = +6dB
                                       (IN2LRP_MIXINx_VOL=111)
                                          Direct Voice to Earpiece                                                  20              kΩ
                                                Gain = -6dB
                                             (HPOUT2_VOL=1)
                                          Direct Voice to Earpiece                                                  10              kΩ
                                                 Gain = 0dB
                                             (HPOUT2_VOL=0)
                                          Direct Voice to Speaker                                                  170              kΩ
                                                 Gain = 0dB
                                         (SPKOUTx_BOOST=000)
                                          Direct Voice to Speaker                                                   85              kΩ
                                                Gain = +6dB
                                         (SPKOUTx_BOOST=100)
                                          Direct Voice to Speaker                                                   60              kΩ
                                                Gain = +9dB
                                         (SPKOUTx_BOOST=110)
                                          Direct Voice to Speaker                                                   43              kΩ
                                               Gain = +12dB
                                         (SPKOUTx_BOOST=111)
Note 5: Input resistance will be seen in parallel with the resistance of other enabled input paths from the same pins
                                                                                                                PP, March 2014, Rev 3.5
w
                                                                                                                                     17


WM8958                                                                                                               Pre-Production
PROGRAMMABLE GAINS
 Test Conditions
 The following electrical characteristics are valid across the full range of recommended operating conditions.
               PARAMETER                                          TEST CONDITIONS                     MIN       TYP  MAX     UNIT
 Input PGAs (IN1L, IN2L, IN1R and IN2R)
 C1      Minimum Programmable Gain                               Guaranteed monotonic                          -16.5          dB
 C2      Maximum Programmable Gain                                                                              +30           dB
 C3      Programmable Gain Step Size                                                                            1.5           dB
 Input Mixers (MIXINL and MIXINR)
 C6      Minimum Programmable Gain                              Input PGA signal paths                           0            dB
 C7      Maximum Programmable Gain                                                                              +30           dB
 C8      Programmable Gain Step Size                                                                             30           dB
 C9      Minimum Programmable Gain                          Direct IN1xP input signal paths                     -12           dB
 C10     Maximum Programmable Gain                      (Note the available gain settings are                   +15           dB
 C11     Programmable Gain Step Size                       -12, -9, -6, -3, 0, +3, +6, +15dB)                    3            dB
         Minimum Programmable Gain                          MIXOUTx Record signal paths                         -12           dB
         Maximum Programmable Gain                                                                              +6            dB
         Programmable Gain Step Size                                                                             3            dB
 C12     Minimum Programmable Gain                     RXVOICE (VRXP-VRXN) signal paths                         -12           dB
 C13     Maximum Programmable Gain                                                                              +6            dB
 C14     Programmable Gain Step Size                                                                             3            dB
 Output Mixers (MIXOUTL and MIXOUTR)
 C17     Minimum Programmable Gain                                                                               -9           dB
 C18     Maximum Programmable Gain                                                                               0            dB
 C19     Programmable Gain Step Size                                                                             3            dB
 Speaker Mixers (SPKMIXL and SPKMIXR)
 C21     Minimum Programmable Gain                                                                              -15           dB
 C22     Maximum Programmable Gain                                                                               0            dB
 C23     Programmable Gain Step Size                                                                             3            dB
 Output PGAs (HPOUT1LVOL, HPOUT1RVOL, MIXOUTLVOL, MIXOUTRVOL, SPKLVOL and SPKRVOL)
 C25     Minimum Programmable Gain                              Guaranteed monotonic                            -57           dB
 C26     Maximum Programmable Gain                                                                              +6            dB
 C27     Programmable Gain Step Size                                                                             1            dB
 Line Output Drivers (LINEOUT1NMIX, LINEOUT1PMIX, LINEOUT2NMIX and LINEOUT2PMIX)
 C29     Minimum Programmable Gain                                                                               -6           dB
 C30     Maximum Programmable Gain                                                                               0            dB
 C31     Programmable Gain Step Size                                                                             6            dB
 Earpiece Driver (HPOUT2MIX)
 C33     Minimum Programmable Gain                                                                               -6           dB
 C34     Maximum Programmable Gain                                                                               0            dB
 C35     Programmable Gain Step Size                                                                             6            dB
 Speaker Output Drivers (SPKOUTLBOOST and SPKOUTRBOOST)
 C38     Minimum Programmable Gain                      (Note the available gain settings are                    0            dB
 C39     Maximum Programmable Gain                     0, +1.5, +3, +4.5, +6, +7.5, +9, +12dB)                  +12           dB
 C40     Programmable Gain Step Size                                                                            1.5           dB
                                                                                                           PP, March 2014, Rev 3.5
w
                                                                                                                                 18


  Pre-Production                                                                                                            WM8958
  OUTPUT DRIVER CHARACTERISTICS
    Test Conditions
    The following electrical characteristics are valid across the full range of recommended operating conditions.
                    PARAMETER                                        TEST CONDITIONS                      MIN      TYP    MAX    UNIT
    Line Output Driver (LINEOUT1P, LINEOUT1N, LINEOUT2P, LINEOUT2N)
            Load resistance                                                                                 2                     kΩ
            Load capacitance                                           Direct connection                                  100     pF
                                                              Connection via 1kΩ series resistor                          2000
            Output discharge resistance                        LINEOUTn_DISCH=1, VROI=0                             8             kΩ
                                                               LINEOUTn_DISCH=1, VROI=1,                           500            Ω
                                                                     LINEOUTn_ENA=0
    Headphone Output Driver (HPOUT1L, HPOUT1R)
            Load resistance                                           Normal operation                    15                      Ω
                                                         Device survival with load applied indefinitely   100                    mΩ
                                                                         (see note 6)
            Load capacitance                                                                                                2     nF
            DC offset across load                                    DC Servo complete                            TBD            mV
    Earpiece Output Driver (HPOUT2L, HPOUT2R)
            Load resistance                                                                                15                     Ω
            Load capacitance                                          Direct connection                                    200    pF
            DC offset across load                                                                                   ±5           mV
    Speaker Output Driver (SPKOUTLP, SPKOUTLN, SPKOUTRP, SPKOUTRN)
            Load resistance                               Stereo Mode (SPKMODE=0), Class AB                 8                     Ω
                                                           Stereo Mode (SPKMODE=0), Class D                 4
                                                                Mono Mode (SPKMODE=1)                      4
            Load capacitance                                                                                              TBD     pF
            DC offset across load                                                                                   ±5           mV
            SPKVDD leakage current                                Sum of ISPKVDD1 + ISPKVDD2                        1             µA
Note 6: In typical applications, the PCB trace resistance, jack contact resistance and ESR of any series passive components (eg.
inductor or ferrite bead) are sufficient to provide this minimum resistance; additional series components are not required.
                                                                                                               PP, March 2014, Rev 3.5
w
                                                                                                                                    19


WM8958                                                                                                           Pre-Production
ADC INPUT PATH PERFORMANCE
 Test Conditions
 AVDD1=3.0V (powered from LDO1), DCVDD=1.2V (powered from LDO2), AVDD2=DBVDD1=DBVDD2=DBVDD3=CPVDD=1.8V,
 LDO1VDD=SPKVDD1=SPKVDD2=5V, DGND=AGND=CPGND=SPKGND1=SPKGND2=HP2GND=0V,
          o
 TA = +25 C, 1kHz sinusoidal signal, fs = 48kHz, PGA gain = 0dB, 24-bit audio data unless otherwise stated.
          PARAMETER                                     TEST CONDITIONS                              MIN    TYP    MAX     UNIT
 D1     Line Inputs to ADC via MIXINL and MIXINR
        SNR                             A-weighted                                                            94            dB
        THD                             -1dBV input                                                          -83            dB
        THD+N                           -1dBV input                                                          -81            dB
        Channel Separation                                                                                  100             dB
        (L/R)
        PSRR (all supplies)           100mV (pk-pk)                                                           73            dB
                                           217Hz
 D2     Record Path (DACs to ADCs via MIXINL and MIXINR)
        SNR                             A-weighted                                                            92            dB
        THD                            -1dBFS input                                                          -74            dB
        THD+N                          -1dBFS input                                                          -72            dB
        Channel Separation                                                                                    95            dB
        (L/R)
 D3     Input PGAs to ADC via MIXINL or MIXINR
        SNR                             A-weighted                                                    84      95            dB
        THD                             -1dBV input                                                          -82    -72     dB
        THD+N                           -1dBV input                                                          -80    -70     dB
        Channel Separation                                                                                  100             dB
        (L/R)
        PSRR (AVDD1)                  100mV (pk-pk)                                                           97            dB
                                           217Hz
 D4     RXVOICE to ADCL or ADCR
        SNR                             A-weighted                                                            94            dB
        THD                             -1dBV input                                                          -84            dB
        THD+N                           -1dBV input                                                          -82            dB
                                                                                                        PP, March 2014, Rev 3.5
w
                                                                                                                             20


Pre-Production                                                                                                      WM8958
DAC OUTPUT PATH PERFORMANCE
  Test Conditions
  AVDD1=3.0V (powered from LDO1), DCVDD=1.2V (powered from LDO2), AVDD2=DBVDD1=DBVDD2=DBVDD3=CPVDD=1.8V,
  LDO1VDD=SPKVDD1=SPKVDD2=5V, DGND=AGND=CPGND=SPKGND1=SPKGND2=HP2GND=0V,
           o
  TA = +25 C, 1kHz sinusoidal signal, fs = 48kHz, PGA gain = 0dB, 24-bit audio data unless otherwise stated.
           PARAMETER                                    TEST CONDITIONS                               MIN    TYP    MAX     UNIT
  E1     DAC to Single-Ended Line Output (Load = 10k // 50pF)
         SNR                             A-weighted                                                            93            dB
         THD                            0dBFS input                                                           -75            dB
         THD+N                          0dBFS input                                                           -73            dB
         Channel Separation                                                                                    70            dB
         (L/R)
         PSRR (all supplies)           100mV (pk-pk)                                                           36            dB
                                           217Hz
         LINEOUTFB rejection        LINEOUTn_FB=1,                                                             38            dB
                                       100mV (pk-pk)
                                           217Hz
  E2     DAC to Differential Line Output (Load = 10k // 50pF)
         SNR                             A-weighted                                                            97            dB
         THD                            0dBFS input                                                           -76            dB
         THD+N                          0dBFS input                                                           -75            dB
         Channel Separation                                                                                    90            dB
         (L/R)
         PSRR (all supplies)           100mV (pk-pk)                                                           51            dB
                                           217Hz
  E5     DAC to Headphone on HPOUT1L or HPOUT1R (Load = 32)
         SNR (A-weighted)            DAC_OSR128=1                                                            100             dB
                                     DAC_OSR128=0                                                              97            dB
         THD                             PO=20mW                                                              -74            dB
         THD+N                           PO=20mW                                                              -72            dB
         THD                              PO=5mW                                                              -76            dB
         THD+N                            PO=5mW                                                              -74            dB
         Channel Separation                                                                                    95            dB
         (L/R)
         PSRR (all supplies)           100mV (pk-pk)                                                           51            dB
                                           217Hz
         HPOUT1FB rejection            100mV (pk-pk)                                                           29            dB
                                           217Hz
  E6     DAC to Headphone on HPOUT1L or HPOUT1R (Load = 16)
         SNR (A-weighted)            DAC_OSR128=1                                                     90     100             dB
                                     DAC_OSR128=0                                                              97            dB
         THD                             PO=20mW                                                              -82            dB
         THD+N                           PO=20mW                                                              -80            dB
         THD                              PO=5mW                                                              -83    -73     dB
         THD+N                            PO=5mW                                                              -81    -71     dB
         Channel Separation                                                                                    95            dB
         (L/R)
         PSRR (all supplies)           100mV (pk-pk)                                                           51            dB
                                           217Hz
         HPOUT1FB rejection            100mV (pk-pk)                                                           29            dB
                                           217Hz
                                                                                                         PP, March 2014, Rev 3.5
w
                                                                                                                              21


WM8958                                                                                                           Pre-Production
 Test Conditions
 AVDD1=3.0V (powered from LDO1), DCVDD=1.2V (powered from LDO2), AVDD2=DBVDD1=DBVDD2=DBVDD3=CPVDD=1.8V,
 LDO1VDD=SPKVDD1=SPKVDD2=5V, DGND=AGND=CPGND=SPKGND1=SPKGND2=HP2GND=0V,
          o
 TA = +25 C, 1kHz sinusoidal signal, fs = 48kHz, PGA gain = 0dB, 24-bit audio data unless otherwise stated.
          PARAMETER                                    TEST CONDITIONS                               MIN    TYP    MAX     UNIT
 E9     DAC to Earpiece Driver (Load = 16 BTL)
        SNR                             A-weighted                                                           97             dB
        THD                             PO=50mW                                                              -71            dB
        THD+N                           PO=50mW                                                              -69            dB
        PSRR (all supplies)           100mV (pk-pk)                                                          51             dB
                                          217Hz
 E12    DAC to Speaker Outputs (Load = 8 + 22H BTL, Stereo Mode)
        Class D Mode, +12dB boost (SPKOUTx_BOOST = 111)
        SNR                             A-weighted                                                   85      94             dB
        THD                              PO=0.5W                                                             -65            dB
        THD+N                            PO=0.5W                                                             -63    -53     dB
        THD                              PO=1.0W                                                             -70            dB
        THD+N                            PO=1.0W                                                             -68            dB
        PSRR (all supplies)           100mV (pk-pk)                                                          43             dB
                                          217Hz
        Channel Separation                                                                                   80             dB
        (L/R)
        DAC to Speaker Outputs (Load = 8 + 22H BTL, Stereo Mode)
        Class AB Mode, +12dB boost (SPKOUTx_BOOST = 111)
        SNR                             A-weighted                                                           96             dB
        THD                              PO=0.5W                                                             -67            dB
        THD+N                            PO=0.5W                                                             -65            dB
        THD                              PO=1.0W                                                             -64            dB
        THD+N                            PO=1.0W                                                             -62            dB
        PSRR (all supplies)           100mV (pk-pk)                                                          43             dB
                                          217Hz
        Channel Separation                                                                                   80             dB
        (L/R)
        DAC to Speaker Outputs (Load = 4 + 22H BTL, Stereo Mode)
        Class D Mode, +12dB boost (SPKOUTx_BOOST = 111)
        SNR                             A-weighted                                                           93             dB
        THD                              PO=0.5W                                                                            dB
        THD+N                            PO=0.5W                                                             -63            dB
        THD                              PO=1.0W                                                                            dB
        THD+N                            PO=1.0W                                                             -63            dB
        THD                              PO=2.0W                                                                            dB
        THD+N                            PO=2.0W                                                             -66            dB
        PSRR (all supplies)           100mV (pk-pk)                                                                         dB
                                          217Hz
        Channel Separation                                                                                                  dB
        (L/R)
                                                                                                        PP, March 2014, Rev 3.5
w
                                                                                                                             22


Pre-Production                                                                                                      WM8958
  Test Conditions
  AVDD1=3.0V (powered from LDO1), DCVDD=1.2V (powered from LDO2), AVDD2=DBVDD1=DBVDD2=DBVDD3=CPVDD=1.8V,
  LDO1VDD=SPKVDD1=SPKVDD2=5V, DGND=AGND=CPGND=SPKGND1=SPKGND2=HP2GND=0V,
          o
  TA = +25 C, 1kHz sinusoidal signal, fs = 48kHz, PGA gain = 0dB, 24-bit audio data unless otherwise stated.
          PARAMETER                                         TEST CONDITIONS                           MIN    TYP    MAX     UNIT
  E13    Speaker Output Power (Load = 8 + 22H BTL, Stereo Mode)
         Output Power                    SPKVDD1=                         Class AB                             1             W
                                      SPKVDD2=5.0V                         Class D                             1
                                        THD+N ≤ 1%
                                         SPKVDD1=                         Class AB                           0.95            W
                                      SPKVDD2=4.2V                         Class D                           0.95
                                        THD+N ≤ 1%
                                         SPKVDD1=                         Class AB                           0.75            W
                                      SPKVDD2=3.7V                         Class D                           0.75
                                        THD+N ≤ 1%
         Note that the maximum recommended speaker output power is 1W per channel into 8Ω.
         Output levels that exceed this limit are not guaranteed and may cause damage to the WM8958.
         Speaker Output Power (Load = 4 + 22H BTL, Stereo Mode)
         Output Power                    SPKVDD1=                          Class D                            2.3            W
                                      SPKVDD2=5.0V                    (see note below)
                                        THD+N ≤ 1%
                                         SPKVDD1=                          Class D                            1.6            W
                                      SPKVDD2=4.2V
                                        THD+N ≤ 1%
                                         SPKVDD1=                          Class D                            1.2            W
                                      SPKVDD2=3.7V
                                        THD+N ≤ 1%
         Speaker Output Power (Load = 4 + 22H BTL, Mono Mode)
         Output Power                    SPKVDD1=                         Class AB                            2.7            W
                                      SPKVDD2=5.0V                    (see note below)
                                        THD+N ≤ 1%                         Class D                            2.7
                                                                      (see note below)
         Note that the maximum recommended speaker output power is 2W per channel into 4Ω.
         Output levels that exceed this limit are not guaranteed and may cause damage to the WM8958.
                                                                                                         PP, March 2014, Rev 3.5
w
                                                                                                                              23


WM8958                                                                                                           Pre-Production
BYPASS PATH PERFORMANCE
 Test Conditions
 AVDD1=3.0V (powered from LDO1), DCVDD=1.2V (powered from LDO2), AVDD2=DBVDD1=DBVDD2=DBVDD3=CPVDD=1.8V,
 LDO1VDD=SPKVDD1=SPKVDD2=5V, DGND=AGND=CPGND=SPKGND1=SPKGND2=HP2GND=0V,
          o
 TA = +25 C, 1kHz sinusoidal signal, fs = 48kHz, PGA gain = 0dB, 24-bit audio data unless otherwise stated.
          PARAMETER                                    TEST CONDITIONS                               MIN    TYP    MAX     UNIT
 F1     Input PGA to Differential Line Output (Load = 10k // 50pF)
        SNR                             A-weighted                                                          100             dB
        THD                            0dBV output                                                           -90            dB
        THD+N                          0dBV output                                                           -87            dB
 F3     Input PGA to Headphone via MIXOUTL or MIXOUTR (Load = 16)
        SNR                             A-weighted                                                            98            dB
        THD                             PO=20mW                                                              -89            dB
        THD+N                           PO=20mW                                                              -87            dB
        THD                              PO=5mW                                                              -86            dB
        THD+N                            PO=5mW                                                              -84            dB
        PSRR (all supplies)           100mV (pk-pk)                                                           49            dB
                                          217Hz
        Channel Separation                                                                                    95            dB
        (L/R)
 F2     Line Input (IN2LP or IN2RP) to Headphone via MIXOUTL or MIXOUTR (Load = 16)
        SNR                             A-weighted                                                          100             dB
        THD                             PO=20mW                                                              -86            dB
        THD+N                           PO=20mW                                                              -84            dB
        THD                              PO=5mW                                                              -84            dB
        THD+N                            PO=5mW                                                              -82            dB
        PSRR (all supplies)           100mV (pk-pk)                                                           49            dB
                                          217Hz
 F4     Line Input (IN2LN or IN2RN) to Headphone via MIXOUTL or MIXOUTR (Load = 16)
        SNR                             A-weighted                                                          100             dB
        THD                             PO=20mW                                                              -84            dB
        THD+N                           PO=20mW                                                              -82            dB
        THD                              PO=5mW                                                              -82            dB
        THD+N                            PO=5mW                                                              -80            dB
        PSRR (all supplies)           100mV (pk-pk)                                                           49            dB
                                          217Hz
        Channel Separation                                                                                    95            dB
        (L/R)
                                                                                                        PP, March 2014, Rev 3.5
w
                                                                                                                             24


Pre-Production                                                                                                      WM8958
  Test Conditions
  AVDD1=3.0V (powered from LDO1), DCVDD=1.2V (powered from LDO2), AVDD2=DBVDD1=DBVDD2=DBVDD3=CPVDD=1.8V,
  LDO1VDD=SPKVDD1=SPKVDD2=5V, DGND=AGND=CPGND=SPKGND1=SPKGND2=HP2GND=0V,
           o
  TA = +25 C, 1kHz sinusoidal signal, fs = 48kHz, PGA gain = 0dB, 24-bit audio data unless otherwise stated.
          PARAMETER                                     TEST CONDITIONS                               MIN    TYP    MAX     UNIT
  F5     Direct Voice Path to Earpiece Driver (Load = 16 BTL)
         SNR                             A-weighted                                                   90     104             dB
         THD                             PO=50mW                                                              -70            dB
         THD+N                           PO=50mW                                                              -68    -60     dB
         PSRR (all supplies)           100mV (pk-pk)                                                          91             dB
                                           217Hz
  F6     Direct Voice Path to Speaker Outputs (Load = 8 + 22H BTL, Stereo Mode)
         Class D Mode, +12dB boost (SPKOUTx_BOOST = 111)
         SNR                             A-weighted                                                           97             dB
         THD                              PO=0.5W                                                             -62            dB
         THD+N                            PO=0.5W                                                             -60            dB
         THD                              PO=1.0W                                                             -67            dB
         THD+N                            PO=1.0W                                                             -65            dB
         PSRR (all supplies)           100mV (pk-pk)                                                          63             dB
                                           217Hz
         Direct Voice Path to Speaker Outputs (Load = 8 + 22H BTL, Stereo Mode)
         Class AB Mode, +12dB boost (SPKOUTx_BOOST = 111)
         SNR                             A-weighted                                                          103             dB
         THD                              PO=0.5W                                                             -62            dB
         THD+N                            PO=0.5W                                                             -60            dB
         THD                              PO=1.0W                                                             -64            dB
         THD+N                            PO=1.0W                                                             -62            dB
         PSRR (all supplies)           100mV (pk-pk)                                                          67             dB
                                           217Hz
  F7     Line Input to Speaker Outputs via SPKMIXL or SPKMIXR (Load = 8 + 22H BTL, Stereo Mode)
         Class D Mode, +12dB boost (SPKOUTx_BOOST = 111)
         SNR                             A-weighted                                                           93             dB
         THD                              PO=0.5W                                                             -62            dB
         THD+N                            PO=0.5W                                                             -60            dB
         THD                              PO=1.0W                                                             -67            dB
         THD+N                            PO=1.0W                                                             -65            dB
         PSRR (all supplies)           100mV (pk-pk)                                                          47             dB
                                           217Hz
         Line Input to Speaker Outputs via SPKMIXL or SPKMIXR (Load = 8 + 22H BTL, Stereo Mode)
         Class AB Mode, +12dB boost (SPKOUTx_BOOST = 111)
         SNR                             A-weighted                                                           96             dB
         THD                              PO=0.5W                                                             -72            dB
         THD+N                            PO=0.5W                                                             -68            dB
         THD                              PO=1.0W                                                             -64            dB
         THD+N                            PO=1.0W                                                             -62            dB
         PSRR (all supplies)           100mV (pk-pk)                                                          47             dB
                                           217Hz
                                                                                                         PP, March 2014, Rev 3.5
w
                                                                                                                              25


WM8958                                                                                           Pre-Production
MULTI-PATH CROSSTALK
Test Conditions
AVDD1=3.0V (powered from LDO1), DCVDD=1.2V (powered from LDO2), AVDD2=DBVDD1=DBVDD2=DBVDD3=CPVDD=1.8V,
LDO1VDD=SPKVDD1=SPKVDD2=5V, DGND=AGND=CPGND=SPKGND1=SPKGND2=HP2GND=0V,
        o
TA = +25 C, 1kHz sinusoidal signal, fs = 48kHz, PGA gain = 0dB, 24-bit audio data unless otherwise stated.
             PARAMETER                           TEST CONDITIONS                 MIN      TYP      MAX    UNIT
G1    Headset Voice Call:                                                                  85              dB
      DAC/Headset to Tx Voice
      Separation
      1kHz 0dBFS DAC playback direct
      to HPOUT1L and HPOUT1R;
      Quiescent input on IN1LN/P or
      IN1RN/P (Gain=+12dB),
      differential line output; Measure
      crosstalk at differential line output
G2    Speakerphone Voice Call:                                                             100             dB
      DAC/Speaker to Tx Voice
      Separation
                                                       C
      1kHz 0dBFS DAC playback to                            TA
                                                              LK
                                                          SS
      speakers, 1W/chan output;                         RO
      Quiescent input on IN1LN/P or
      IN1RN/P (Gain=+12dB),
      differential line output; Measure
      crosstalk at differential line output
G3    Earpiece PCM Voice Call:                                                             110             dB
      RXVOICE to Tx Voice Separation
      fs=8kHz for ADC and DAC,
      DAC_SB_FILT=1; -5dBFS, DAC
      output to HPOUT2P-HPOUT2N;
      Quiescent input on input PGA
      (Gain=+12dB) to ADC via MIXINL
      or MIXINR; Measure crosstalk at
      ADC output
G4    Speakerphone PCM Voice Call:                                                         90              dB
      DAC/Speaker to ADC Separation
      fs=8kHz for ADC and DAC,
      DAC_SB_FILT=1; 0dBFS DAC
      output to speaker (1W output);
      ADC record from input PGA
      (Gain=+30dB); Measure crosstalk
      on ADC output
G5    Speakerphone PCM Voice Call:                                                         95              dB
      ADC to DAC/Speaker Separation
      fs=8kHz for ADC and DAC,
      DAC_SB_FILT=1; Quiescent DAC
      output to speaker; ADC record
      from input PGA (Gain=+30dB +
      30dB boost); Measure crosstalk on
      speaker output
                                                                                       PP, March 2014, Rev 3.5
w
                                                                                                            26


Pre-Production                                                                                                                                              WM8958
  Test Conditions
  AVDD1=3.0V (powered from LDO1), DCVDD=1.2V (powered from LDO2), AVDD2=DBVDD1=DBVDD2=DBVDD3=CPVDD=1.8V,
  LDO1VDD=SPKVDD1=SPKVDD2=5V, DGND=AGND=CPGND=SPKGND1=SPKGND2=HP2GND=0V,
           o
  TA = +25 C, 1kHz sinusoidal signal, fs = 48kHz, PGA gain = 0dB, 24-bit audio data unless otherwise stated.
                PARAMETER                                                           TEST CONDITIONS                                          MIN     TYP     MAX    UNIT
  G6     Earpiece Speaker Voice Call:                                                                                                                100             dB
         Tx Voice and RXVOICE
         Separation
         1kHz Full scale differential input
         on VRXP-VRXN, output to
         HPOUT2P-HPOUT2N; Quiescent
         input on IN1LN/P or IN1RN/P
         (Gain=+12dB), differential line
         output; Measure crosstalk at
         differential line output
                                                                                                   LINEOUT1NMIX or            LINEOUT1N or
  G7     Headset Voice Call:                                                                        LINEOUT2NMIX
                                                                                                                     0dB
                                                                                                                               LINEOUT2N             90              dB
         Tx Voice and RXVOICE                                                   IN1L or IN1R
                                                IN1LN or          +12dB
         Separation                               IN1RN
                                                               -
                                                                              (Single-ended or
                                                                             differential mode)
                                                                                                   LINEOUT1PMIX or
                                                                                                     LINEOUT2PMIX    0dB
                                               IN1LP or
                                                 IN1RP         +                                                             LINEOUT1P or
                                                                                                                              LINEOUT2P
         1kHz full scale differential input on                  Quiescent input
         VRXP-VRXN via RXVOICE to
                                                                                                       MIXOUTL      0dB
         MIXOUTL and MIXOUTR, output                  VRXN
                                                                                                          +
                                                                                                                                   HPOUT1L
         to HPOUT1L and HPOUT1R;                       Full scale     -                                        HPOUT1LVOL
                                                         input
                                                                      +                                             0dB
         Quiescent input on IN1LN/P or                                    RXVOICE
                                                                         (MIXINL or                       +
                                                                                                                                   HPOUT1R
                                                      VRXP
         IN1RN/P (Gain=+12dB),                                             MIXINR)
                                                                                                      MIXOUTR  HPOUT1RVOL
         differential line output; Measure
         crosstalk at differential line output
  G8     Stereo Line Record and Playback:               IN1LP or                            MIXINL or                                                95              dB
                                                          IN1RP                              MIXINR
         DAC/Headset to ADC Separation                                                          +          ADCL or
                                                                                                            ADCR
                                                       Quiescent
                                                         input
         -5dBFS input to DACs, playback to                                                                               0dB
                                                                                                                                     HPOUT1L
         HPOUT1L and HPOUT1R; ADC                                                            DACL
         record from line input; Measure                                                                           HPOUT1LVOL
         crosstalk on ADC output                                     CROSSTALK
                                                                                                                         0dB
                                                                                                                                     HPOUT1R
                                                                                             DACR
                                                                                                                   HPOUT1RVOL
                                                                                                                                                 PP, March 2014, Rev 3.5
w
                                                                                                                                                                      27


WM8958                                                                                                                Pre-Production
DIGITAL INPUT / OUTPUT
 Test Conditions
 The following electrical characteristics are valid across the full range of recommended operating conditions.
 PARAMETER                                                 TEST CONDITIONS               MIN          TYP          MAX        UNIT
 Digital Input / Output (except DMICDATn and DMICCLK)
 Digital I/O is referenced to DBVDD1, DBVDD2 or DBVDD3. See “Pin Description” for the domain applicable to each pin.
 H16     Input HIGH Level, VIH                                                          0.8                                    V
                                                                                     DBVDDn
 H17     Input LOW Level, VIL                                                                                      0.2         V
                                                                                                                 DBVDDn
 Note that digital input pins should not be left unconnected / floating.
 H18     Output HIGH Level, VOH                                   IOH=1mA              0.8                                     V
                                                                                     DBVDDn
 H19     Output LOW Level, VOL                                    IOL=-1mA                                         0.2         V
                                                                                                                 DBVDDn
 H20     Input capacitance                                                                            10                       pF
 H21     Input leakage                                                                  -0.9                        0.9        A
 Digital Microphone Input / Output (DMICDATn and DMICCLK)
 H22     DMICDATn input HIGH Level, VIH                                                0.65                                    V
                                                                                     MICBIAS1
 H23     DMICDATn input LOW Level, VIL                                                                            0.35 x        V
                                                                                                                MICBIAS1
 H24     DMICCLK output HIGH Level, VOH                           IOH=1mA              0.8                                     V
                                                                                     MICBIAS1
 H25     DMICCLK output LOW Level, VOL                            IOL=-1mA                                         0.2 x        V
                                                                                                                MICBIAS1
 H26     Input capacitance                                                                            10                       pF
 H27     Input leakage                                                                  -0.9                        0.9        A
DIGITAL FILTER CHARACTERISTICS
 Test Conditions
 The following electrical characteristics are valid across the full range of recommended operating conditions.
 PARAMETER                                                 TEST CONDITIONS               MIN          TYP          MAX        UNIT
 ADC Decimation Filter
         Passband                                                +/- 0.05dB               0                      0.454 fs
                                                                     -6dB                            0.5 fs
         Passband Ripple                                                                                         +/- 0.05      dB
         Stopband                                                                     0.546 fs
         Stopband Attenuation                                   f > 0.546 fs             85                                    dB
         Group Delay                                                                                                 2         ms
 DAC Interpolation Filter
         Passband                                                +/- 0.05dB               0                      0.454 fs
                                                                     -6dB                            0.5 fs
         Passband Ripple                                           0.454 fs                                      +/- 0.05      dB
         Stopband                                                                     0.546 fs
         Stopband Attenuation                                   f > 0.546 fs             85                                    dB
         Group Delay                                                                                                 2         ms
                                                                                                            PP, March 2014, Rev 3.5
w
                                                                                                                                 28


Pre-Production                                                                                          WM8958
MICROPHONE BIAS CHARACTERISTICS
  Test Conditions
  AVDD1=3.0V (powered from LDO1), DCVDD=1.2V (powered from LDO2), AVDD2=DBVDD1=DBVDD2=DBVDD3=CPVDD=1.8V,
  LDO1VDD=SPKVDD1=SPKVDD2=5V, DGND=AGND=CPGND=SPKGND1=SPKGND2=HP2GND=0V,
            o
  TA = +25 C, unless otherwise stated.
  PARAMETER                                               TEST CONDITIONS         MIN   TYP        MAX        UNIT
  Microphone Bias (MICBIAS1 and MICBIAS2)
  Note - No capacitor on MICBIASn
  Note - In regulator mode, it is required that AVDD1 - VMICBIASn > 200mV
  H2      Bias Voltage                                     MICBn_LVL = 000        -5%   1.5        +5%          V
          Regulator mode (MICBn_MODE=0)                    MICBn_LVL = 001        -5%   1.8        +5%
          Load current ≤ 1.0mA                             MICBn_LVL = 010        -5%   1.9        +5%
                                                           MICBn_LVL = 011        -5%   2.0        +5%
                                                           MICBn_LVL = 100        -5%   2.2        +5%
                                                           MICBn_LVL = 101        -5%   2.4        +5%
                                                           MICBn_LVL = 110        -5%   2.5        +5%
                                                           MICBn_LVL = 111        -5%   2.6        +5%
          Bias Voltage                                                          AVDD1 -          AVDD1          V
          Bypass mode (MICBn_MODE=1)                                             80mV
          Load current ≤ 3.6mA
  H3      Bias Current                                      Regulator mode                          2.4        mA
                                                           (MICBn_MODE=0)
                                                              Bypass mode                           3.6
                                                           (MICBn_MODE=1)
  H4      Output Noise Density                              Regulator mode               60                  nV/Hz
                                                          (MICBn_MODE=0),
                                                           MICBn_LVL = 100,
                                                          Load current = 1mA,
                                                           Measured at 1kHz
  H5      Integrated Noise Voltage                          Regulator mode              4.5                   µVRMS
                                                          (MICBn_MODE=0),
                                                           MICBn_LVL = 100,
                                                          Load current = 1mA,
                                                      100Hz to 7kHz, A-weighted
  H6      PSRR (AVDD1)                                   100mV (pk-pk) 217Hz            100                    dB
                                                         100mV (pk-pk) 10kHz            80
          Load capacitance                                  Regulator mode                          50         pF
                                                           (MICBn_MODE=0)
          Output discharge resistance                       MICBn_ENA=0,                 20                    kΩ
                                                            MICBn_DISCH=1
                                                                                            PP, March 2014, Rev 3.5
w
                                                                                                                 29


WM8958                                                                                                            Pre-Production
MISCELLANEOUS CHARACTERISTICS
 Test Conditions
 AVDD1=3.0V (powered from LDO1), DCVDD=1.2V (powered from LDO2), AVDD2=DBVDD1=DBVDD2=DBVDD3=CPVDD=1.8V,
 LDO1VDD=SPKVDD1=SPKVDD2=5V, DGND=AGND=CPGND=SPKGND1=SPKGND2=HP2GND=0V,
          o
 TA = +25 C, 1kHz sinusoidal signal, fs = 48kHz, PGA gain = 0dB, 24-bit audio data unless otherwise stated.
 PARAMETER                                              TEST CONDITIONS              MIN          TYP           MAX       UNIT
 Analogue Reference Levels
 H1     VMID Midrail Reference Voltage                   VMID_SEL = 01,              -3%       AVDD1/2         +3%          V
                                                   4.7F capacitor on VMIDC
        VMID Start-Up time                               VMID_SEL = 01,                                         50         ms
                                                        VMID_RAMP = 11,
                                                   4.7F capacitor on VMIDC
 External Accessory Detection
        Load impedance detection range                 for MICD_LVL[0] = 1            0                          3          Ω
        (MICDET)                                       for MICD_LVL[1] = 1          13.33                      15.27
        2.2kΩ (2%) MICBIAS2 resistor.                  for MICD_LVL[2] = 1          27.16                      30.96
        Note these characteristics assume no           for MICD_LVL[3] = 1          42.48                      49.47
        other component is connected to
                                                       for MICD_LVL[4] = 1            65                        85
        MICDET. See “Applications Information”
        for recommended external components            for MICD_LVL[5] = 1           114                      155.24
        when a typical microphone is present.          for MICD_LVL[6] = 1           191                      329.87
                                                       for MICD_LVL[7] = 1           475                      30000
 Frequency Locked Loops (FLLs)
 H29    Lock time                                          FREF=32kHz,                             2.5                     ms
                                                         FOUT=12.288MHz
                                                           FREF=12MHz,                            300                      s
                                                         FOUT=12.288MHz
 H30    Free-running mode start-up time                                                           100                      s
 H31    Free-running mode frequency accuracy       Reference supplied initially                  +/-10                     %
                                                      No reference provided                      +/-30                     %
 LDO Regulators
 H38    LDO1 Start-Up Time                         4.7F capacitor on AVDD1                                     1.5        ms
                                                    1F capacitor on VREFC
        LDO1 Drop-Out voltage                                                                                   300        mV
        (LDO1VDD - AVDD1)
        LDO1 PSRR (LDO1VDD)                           100mV (pk-pk) 217Hz                         TBD                      dB
 H42    LDO2 Start-Up Time                         2.2F capacitor on DCVDD                                     1.5        ms
                                                    1F capacitor on VREFC
        LDO2 PSRR (DBVDD1)                            100mV (pk-pk) 217Hz                         TBD                      dB
                                                                                                        PP, March 2014, Rev 3.5
w
                                                                                                                             30


Pre-Production                                                                                                            WM8958
TERMINOLOGY
1.   Signal-to-Noise Ratio (dB) – SNR is a measure of the difference in level between the maximum full scale output signal and the
     output with no input signal applied.
2.   Total Harmonic Distortion (dB) – THD is the level of the rms value of the sum of harmonic distortion products relative to the
     amplitude of the measured output signal.
3.   Total Harmonic Distortion plus Noise (dB) – THD+N is the level of the rms value of the sum of harmonic distortion products
     plus noise in the specified bandwidth relative to the amplitude of the measured output signal.
4.   Power Supply Rejection Ratio (dB) - PSRR is the ratio of a specified power supply variation relative to the output signal that
     results from it. PSRR is measured under quiescent signal path conditions.
5.   Common Mode Rejection Ratio (dB) – CMRR is the ratio of a specified input signal (applied to both sides of a differential
     input), relative to the output signal that results from it.
6.   Channel Separation (L/R) (dB) – left-to-right and right-to-left channel separation is the difference in level between the active
     channel (driven to maximum full scale output) and the measured signal level in the idle channel at the test signal frequency.
     The active channel is configured and supplied with an appropriate input signal to drive a full scale output, with signal measured
     at the output of the associated idle channel.
7.   Multi-Path Crosstalk (dB) – is the difference in level between the output of the active path and the measured signal level in the
     idle path at the test signal frequency. The active path is configured and supplied with an appropriate input signal to drive a full
     scale output, with signal measured at the output of the specified idle path.
8.   Mute Attenuation – This is a measure of the difference in level between the full scale output signal and the output with mute
     applied.
9.   All performance measurements carried out with 20kHz low pass filter, and where noted an A-weighted filter. Failure to use
     such a filter will result in higher THD and lower SNR readings than are found in the Electrical Characteristics. The low pass
     filter removes out of band noise; although it is not audible it may affect dynamic specification values.
                                                                                                              PP, March 2014, Rev 3.5
w
                                                                                                                                     31


WM8958                                                                                                         Pre-Production
TYPICAL PERFORMANCE
TYPICAL POWER CONSUMPTION
  OPERATING MODE                  TEST CONDITIONS      SPKVDD     LDO1VDD        AVDD2        CPVDD     DBVDD        TOTAL
                                                       (Note 3)                                         (Note 4)
Off (Battery Leakage only)
LDO1 disabled, LDO2                                      4.2V         4.2V         0.0V        0.0V       0.0V      0.01mW
disabled                                                1.1A        0.4A        5.5A        5A       9.5A
Standby
LDO1 disabled, LDO2          All supplies present,       4.2V         4.2V         1.8V        1.8V       1.8V      0.2mW
enabled                      No clocks,                 1.8A         1A         60A         5A       62A
                             Default register settings
Standby
LDO1 enabled, LDO2           All supplies present,       4.2V         4.2V         1.8V        1.8V       1.8V      0.6mW
enabled                      No clocks,                 1.8A        89A         65A         5A       72A
                             Default register settings
Music playback to Headphone (32ohm load)
AIF1 to DAC to               fs=44.1kHz,                 4.2V         4.2V         1.8V        1.8V       1.8V      12.1mW
HPOUT1 (stereo)              Clocking rate=256fs,       0.0mA       2.05mA       0.32mA      0.48mA     1.13mA
                             24-bit I2S, Slave mode
AIF1 to DAC to               fs=44.1kHz,                 3.6V      AVDD1=          1.8V        1.8V    DBVDD=       5.34mW
HPOUT1 (stereo)              Clocking rate=128fs,       0.0mA         2.4V       0.21mA      0.21mA       1.8V
LDOs disabled,               24-bit I2S, Slave mode,                1.43mA                              0.01mA
See Note 7                   Class W
                                                                                                       DCVDD=
                                                                                                          1.2V
                                                                                                        0.94mA
Music playback to Class D speaker output (8ohm, 22H load)
AIF1 to DAC to               fs=44.1kHz,                 4.2V         4.2V         1.8V        1.8V       1.8V      21.1mW
SPKOUT (stereo)              Clocking rate=256fs,      1.65mA       2.36mA       1.24mA      0.01mA     1.13mA
                             24-bit I2S, Slave mode,
                             +7.5dB Class D boost
AIF1 to DAC to               fs=44.1kHz,                 4.2V         4.2V         1.8V        1.8V       1.8V      16.4mW
SPKOUT (Left)                Clocking rate=256fs,      0.74mA       2.34mA       0.79mA      0.01mA     1.13mA
                             24-bit I2S, Slave mode,
                             +0.0dB Class D boost
AIF1 to AIF3 Mono Digital Bypass (eg. Bluetooth video call)
AIF1(L) to AIF3(L),          fs=8kHz,                    4.2V         4.2V         1.8V        1.8V       1.8V      1.2mW
AIF3(L) to AIF1(L)           Clocking rate=256fs,       0.0mA       0.09mA       0.07mA      0.01mA     0.41mA
                             24-bit I2S, Slave mode
AIF2 to AIF3 Mono Digital Bypass (eg. Bluetooth voice call)
AIF2(L) to AIF3(L),          fs=8kHz,                    4.2V         4.2V         1.8V        1.8V       1.8V      1.1mW
AIF3(L) to AIF2(L)           Clocking rate=256fs,      0.002mA     0.089mA      0.065mA      0.003mA   0.311mA
                             24-bit I2S, Slave mode
Notes:
1. AVDD1 = 3.0V, generated by LDO1.
2. DCVDD = 1.2V, generated by LDO2.
3. SPKVDD = SPKVDD1 = SPKVDD2.
4. DBVDD = DBVDD1 = DBVDD2 = DBVDD3.
5. ISPKVDD = ISPKVDD1 + ISPKVDD2.
6. IDBVDD = IDBVDD1 + IDBVDD2 + IDBVDD3.
7. Power consumption for music playback with LDOs disabled requires an external supply for AVDD1 and DCVDD
                                                                                                     PP, March 2014, Rev 3.5
w
                                                                                                                          32


Pre-Production                                                                                                      WM8958
TYPICAL SIGNAL LATENCY
      OPERATING MODE                                        TEST CONDITIONS                                LATENCY
                                            AIF1                  AIF2             DIGITAL CORE
AIF2 to DAC Stereo Path
AIF2 EQ enabled,                          fs=8kHz,              fs=8kHz,         SYSCLK=AIF1CLK              1.4ms
AIF2 3D enabled,                    Clock rate = 256fs     Clock rate = 1536fs
AIF2 DRC enabled,                        fs=48kHz,              fs=8kHz,         SYSCLK=AIF1CLK              1.3ms
SRC enabled                         Clock rate = 256fs     Clock rate = 1536fs
                                          fs=8kHz,              fs=8kHz,         SYSCLK=AIF1CLK              1.7ms
                                    Clock rate = 256fs     Clock rate = 256fs
                                         fs=48kHz,              fs=8kHz,         SYSCLK=AIF1CLK              1.4ms
                                    Clock rate = 256fs     Clock rate = 256fs
ADC to AIF2 Stereo Path
Digital Sidetone HPF enabled,             fs=8kHz,              fs=8kHz,         SYSCLK=AIF1CLK              2.2ms
AIF2 DRC enabled,                   Clock rate = 256fs     Clock rate = 256fs
AIF2 HPF enabled,                        fs=48kHz,              fs=8kHz,         SYSCLK=AIF1CLK              1.2ms
SRC enabled                         Clock rate = 256fs     Clock rate = 256fs
Digital Sidetone HPF disabled,                                  fs=8kHz,         SYSCLK=AIF2CLK              1.3ms
AIF2 DRC disabled,                                         Clock rate = 1536fs
AIF2 HPF disabled,
SRC disabled
Digital Sidetone HPF disabled,           fs=48kHz,              fs=8kHz,         SYSCLK=AIF1CLK              1.1ms
AIF2 DRC disabled,                  Clock rate = 256fs     Clock rate = 1536fs
AIF2 HPF disabled,
SRC enabled
Notes:
1. These figures are relevant to typical voice call modes, assuming AIF2 is connected to the baseband processor
2. The SRC (Sample Rate Converter) is enabled automatically whenever required
                                                                                                         PP, March 2014, Rev 3.5
w
                                                                                                                              33


WM8958                                                                                                                                                                                                                Pre-Production
SPEAKER DRIVER PERFORMANCE
Typical speaker driver THD+N performance is shown below for Class D and Class AB modes. Curves are shown for typical SPKVDD
supply voltage, gain and load conditions.
                                               THD+N vs. Output Power                                                                              THD+N vs. Output Power
                                       Class D, Mono (SPKMODE=1), 8Ω + 10µH                                                                 Class D, Mono (SPKMODE=1), 4Ω + 10µH
                   10                                                                                                        10
                                     SPKVDD = 3.3V                                                                                          SPKVDD = 3.3V
                                SPKVDD = 3.7V                                                                                              SPKVDD = 3.7V
                    1                                                                 SPKVDD = 5.0V                           1
THD+N Ratio (%)                                                                                           THD+N Ratio (%)
                                                                                                                                       SPKVDD = 4.2V
                                                                                   SPKVDD = 4.5V
                                                                                                                                                                                                  SPKVDD = 5.0V
                   0.1                                                                                                       0.1
                                                                                    SPKVDD = 4.2V
                                                                                                                                                                                               SPKVDD = 4.5V
                  0.01                                                                                                      0.01
                         0     0.2      0.4     0.6   0.8     1      1.2   1.4       1.6    1.8       2                            0       0.5             1         1.5             2             2.5            3
                                                       Output Power (W)                                                                                        Output Power (W)
                                               THD+N vs. Output Power                                                                              THD+N vs. Output Power
                                      Class AB, Mono (SPKMODE=1), 8Ω + 10µH                                                                Class AB, Mono (SPKMODE=1), 4Ω + 10µH
                   10                                                                                                        10
                                     SPKVDD = 3.3V
                                                                                                                                           SPKVDD = 3.3V
                                SPKVDD = 3.7V
                    1                                                                 SPKVDD = 5.0V                           1           SPKVDD = 3.7V
THD+N Ratio (%)                                                                                           THD+N Ratio (%)
                                                                                                                                                                                                  SPKVDD = 5.0V
                                                                                   SPKVDD = 4.5V
                   0.1                                                                                                       0.1
                                                                                                                                                                                                SPKVDD = 4.5V
                                                                            SPKVDD = 4.2V
                                                                                                                                                                                  SPKVDD = 4.2V
                  0.01                                                                                                      0.01
                         0     0.2      0.4     0.6   0.8     1      1.2   1.4       1.6    1.8       2                            0       0.5             1         1.5             2             2.5            3
                                                       Output Power (W)                                                                                        Output Power (W)
                                               THD+N vs. Output Power                                                                              THD+N vs. Output Power
                                      Class D, Stereo (SPKMODE=0), 8Ω + 10µH                                                           Class D, Stereo (SPKMODE=0), Load = 4Ω + 10µH
                   10                                                                                                        10
                             SPKVDD = 3.3V                                                                                               SPKVDD = 3.3V
                                                                                                                                       SPKVDD = 3.7V
                                                                                    SPKVDD = 5.0V
                    1                                                                                                         1
THD+N Ratio (%)                                                                                           THD+N Ratio (%)
                             SPKVDD = 3.7V
                                                                                                                                                                                                  SPKVDD = 5.0V
                                                                                 SPKVDD = 4.5V
                   0.1                                                                                                       0.1                                                                SPKVDD = 4.5V
                                                                                 SPKVDD = 4.2V
                                                                                                                                                                                         SPKVDD = 4.2V
                  0.01                                                                                                      0.01
                         0     0.2      0.4     0.6   0.8     1      1.2   1.4       1.6    1.8       2                            0       0.5             1         1.5             2             2.5            3
                                                       Output Power (W)                                                                                        Output Power (W)
                                               THD+N vs. Output Power
                                      Class AB, Stereo (SPKMODE=0), 8Ω + 10µH
                   10
                               SPKVDD = 3.3V
                    1                                                               SPKVDD = 5.0V
THD+N Ratio (%)
                             SPKVDD = 3.7V
                                                                                 SPKVDD = 4.5V
                   0.1
                                                                           SPKVDD = 4.2V
                  0.01
                         0     0.2      0.4     0.6   0.8     1      1.2   1.4       1.6    1.8       2
                                                       Output Power (W)
                                                                                                                                                                                                  PP, March 2014, Rev 3.5
w
                                                                                                                                                                                                                                 34


Pre-Production                                                                                                        WM8958
SIGNAL TIMING REQUIREMENTS
SYSTEM CLOCKS & FREQUENCY LOCKED LOOP (FLL)
                              Figure 2 Master Clock Timing
  Test Conditions
  The following timing information is valid across the full range of recommended operating conditions.
           PARAMETER                  SYMBOL                    CONDITIONS                 MIN         TYP       MAX        UNIT
  Master Clock Timing (MCLK1 and MCLK2)
                                                           MCLK as input to FLL,           37                                ns
                                                     FLLn_REFCLK_DIV = 01, 10, 11
                                                           MCLK as input to FLL,           74
  MCLK cycle time                      TMCLKY            FLLn_REFCLK_DIV = 00
                                                     FLL not used, AIFnCLK_DIV = 1         40
                                                     FLL not used, AIFnCLK_DIV = 0         80
  MCLK duty cycle                                                                         60:40                 40:60
  (= TMCLKH : TMCLKL)
  Frequency Locked Loops (FLL1 and FLL2)
  FLL Input Frequency                                    FLLn_REFCLK_DIV = 00             0.032                  13.5       MHz
                                                         FLLn_REFCLK_DIV = 01             0.064                   27
                                                         FLLn_REFCLK_DIV = 10             0.128                   27
                                                         FLLn_REFCLK_DIV = 11             0.256                   27
  Internal Clocking
  SYSCLK frequency                                                                                               12.5       MHz
  AIF1CLK frequency                                                                                              12.5       MHz
  AIF2CLK frequency                                                                                              12.5       MHz
  DSP2CLK frequency                                                                                               25        MHz
                                                                                                           PP, March 2014, Rev 3.5
w
                                                                                                                                35


WM8958                                                                                                           Pre-Production
AUDIO INTERFACE TIMING
                             DIGITAL MICROPHONE (DMIC) INTERFACE TIMING
                             Figure 3 Digital Microphone Interface Timing
 Test Conditions
 The following timing information is valid across the full range of recommended operating conditions.
                          PARAMETER                                     SYMBOL          MIN        TYP      MAX       UNIT
 Digital Microphone Interface Timing
 DMICCLK cycle time                                                        tCY         320                              ns
 DMICCLK duty cycle                                                                   45:55                55:45        %
 DMICDAT (Left) setup time to falling DMICCLK edge                        tLSU          15                              ns
 DMICDAT (Left) hold time from falling DMICCLK edge                        tLH           0                              ns
 DMICDAT (Right) setup time to rising DMICCLK edge                        tRSU          15                              ns
 DMICDAT (Right) hold time from rising DMICCLK edge                        tRH           0                              ns
                                                                                                       PP, March 2014, Rev 3.5
w
                                                                                                                            36


 Pre-Production                                                                                                        WM8958
                               DIGITAL AUDIO INTERFACE - MASTER MODE
                                          BCLK                                                          VOH
                                                                                                        VOL
                                       (output)
                                                                tBCY
                                        LRCLK                                                           VOH
                                                                                                        VOL
                                       (output)
                                                                                           tDL
                                     ADCDAT                                                             VOH
                                                                                                        VOL
                                       (output)
                                                                                           tDDA
                                     DACDAT                                                             VIH
                                                                                                        VIL
                                         (input)
                                                                     tDST   tDHT
                               Figure 4 Audio Interface Timing - Master Mode
                               Note that BCLK and LRCLK outputs can be inverted if required; Figure 4 shows the default, non-
                               inverted polarity of these signals.
   Test Conditions
   The following timing information is valid across the full range of recommended operating conditions.
                            PARAMETER                                     SYMBOL          MIN        TYP        MAX        UNIT
   Audio Interface Timing - Master Mode
   BCLK cycle time                                                          tBCY         160                                ns
   LRCLK propagation delay from BCLK falling edge                            tDL                                 20         ns
   ADCDAT propagation delay from BCLK falling edge                          tDDA                                 48         ns
   DACDAT setup time to BCLK rising edge                                    tDST          32                                ns
   DACDAT hold time from BCLK rising edge                                   tDHT          10                                ns
   Audio Interface Timing - Ultrasonic (4FS) Master Mode
   BCLK cycle time                                                          tBCY          80                                ns
   ADCDAT propagation delay from BCLK falling edge                          tDDA                                 24         ns
Note that the descriptions above assume non-inverted polarity of BCLK and LRCLK.
                                                                                                            PP, March 2014, Rev 3.5
w
                                                                                                                                 37


 WM8958                                                                                                           Pre-Production
                               DIGITAL AUDIO INTERFACE - SLAVE MODE
                               Figure 5 Audio Interface Timing - Slave Mode
                               Note that BCLK and LRCLK inputs can be inverted if required; Figure 5 shows the default, non-
                               inverted polarity.
   Test Conditions
   The following timing information is valid across the full range of recommended operating conditions.
                          PARAMETER                                      SYMBOL           MIN        TYP     MAX        UNIT
   Audio Interface Timing - Slave Mode
   BCLK cycle time                                                          tBCY         160                             ns
   BCLK pulse width high                                                    tBCH          64                             ns
   BCLK pulse width low                                                     tBCL          64                             ns
   LRCLK set-up time to BCLK rising edge                                   tLRSU          10                             ns
   LRCLK hold time from BCLK rising edge                                    tLRH          10                             ns
   DACDAT hold time from BCLK rising edge                                    tDH          10                             ns
   ADCDAT propagation delay from BCLK falling edge                           tDD                              48         ns
   DACDAT set-up time to BCLK rising edge                                    tDS          32                             ns
Note that the descriptions above assume non-inverted polarity of BCLK and LRCLK.
                                                                                                         PP, March 2014, Rev 3.5
w
                                                                                                                              38


Pre-Production                                                                                                    WM8958
                              DIGITAL AUDIO INTERFACE - TDM MODE
                              When TDM operation is used on the ADCDATn pins, it is important that two devices do not attempt to
                              drive the ADCDATn pin simultaneously. To support this requirement, the ADCDATn pins can be
                              configured to be tri-stated when not outputting data.
                              The timing of the WM8958 ADCDATn tri-stating at the start and end of the data transmission is
                              described in Figure 6 below.
Figure 6 Audio Interface Timing - TDM Mode
  Test Conditions
  The following timing information is valid across the full range of recommended operating conditions.
                                 PARAMETER                                          MIN           TYP     MAX          UNIT
  TDM Timing - Master Mode
  ADCDAT setup time from BCLK falling edge                                           0                                  ns
  ADCDAT release time from BCLK falling edge                                                               15           ns
  TDM Timing - Slave Mode
  ADCDAT setup time from BCLK falling edge                                           5                                  ns
  ADCDAT release time from BCLK falling edge                                                               32           ns
                                                                                                       PP, March 2014, Rev 3.5
w
                                                                                                                            39


WM8958                                                                                                           Pre-Production
CONTROL INTERFACE TIMING
Figure 7 Control Interface Timing
  Test Conditions
  The following timing information is valid across the full range of recommended operating conditions.
                     PARAMETER                                     SYMBOL                MIN        TYP     MAX        UNIT
  SCLK Frequency                                                                                            400        kHz
  SCLK Low Pulse-Width                                                  t1              1300                            ns
  SCLK High Pulse-Width                                                 t2              600                             ns
  Hold Time (Start Condition)                                           t3              600                             ns
  Setup Time (Start Condition)                                          t4              600                             ns
  Data Setup Time                                                       t5              100                             ns
  SDA, SCLK Rise Time                                                   t6                                  300         ns
  SDA, SCLK Fall Time                                                   t7                                  300         ns
  Setup Time (Stop Condition)                                           t8              600                             ns
  Data Hold Time                                                        t9                                  900         ns
  Pulse width of spikes that will be suppressed                        tps                0                  5          ns
                                                                                                        PP, March 2014, Rev 3.5
w
                                                                                                                             40


Pre-Production                                                                                             WM8958
DEVICE DESCRIPTION
INTRODUCTION
               The WM8958 is a low power, high quality audio codec designed to interface with a wide range of
               processors and analogue components. A high level of mixed-signal integration in a very small footprint
               makes it ideal for portable applications such as mobile phones. Fully differential internal architecture
               and on-chip RF noise filters ensure a very high degree of noise immunity.
               Three sets of audio interface pins are available in order to provide independent and fully
               asynchronous connections to multiple processors, typically an application processor, baseband
               processor and wireless transceiver. Any two of these interfaces can operate totally independently and
               asynchronously while the third interface can be synchronised to either of the other two and can also
               provide ultra low power loopback modes to support, for example, wireless headset voice calls.
               Four digital microphone input channels are available to support advanced multi-microphone
               applications such as noise cancellation. An integrated microphone activity monitor is available to
               enable the processor to sleep during periods of microphone inactivity, saving power.
               Four DAC channels are available to support use cases requiring up to four simultaneous digital audio
               streams to the output drivers.
               Eight highly flexible analogue inputs allow interfacing to up to four microphone inputs (single-ended or
               differential), plus multiple stereo or mono line inputs. Connections to an external voice CODEC, FM
               radio, line input, handset MIC and headset MIC are all fully supported. Signal routing to the output
               mixers and within the CODEC has been designed for maximum flexibility to support a wide variety of
               usage modes. A ‘Direct Voice’ path from a voice CODEC directly to the Speaker or Earpiece output
               drivers is included.
               Impedance sensing and measurement for external accessories is provided, for detection of the
               insertion or removal of microphones and other accessories. Push-button detection of up to 7 inputs
               can be supported using this feature.
               Nine analogue output drivers are integrated, including a stereo pair of high power, high quality
               Class D/AB switchable speaker drivers; these can support 2W each in stereo mode. It is also possible
               to configure the speaker drivers as a mono output, giving enhanced performance. A mono earpiece
               driver is provided, providing output from the output mixers or from the low-power differential ‘Direct
               Voice’ path.
               One pair of ground-referenced headphone outputs is provided; these are powered from an integrated
               Charge Pump, enabling high quality, power efficient headphone playback without any requirement for
               DC blocking capacitors. A DC Servo circuit is available for DC offset correction, thereby suppressing
               pops and reducing power consumption. Four line outputs are provided, with multiple configuration
               options including 4 x single-ended outputs or 2 x differential outputs. The line outputs are suitable for
               output to a voice CODEC, an external speaker driver or line output connector. Ground loop feedback
               is available on the headphone outputs and the line outputs, providing rejection of noise on the ground
               connections. All outputs have integrated pop and click suppression features.
               Internal differential signal routing and amplifier configurations have been optimised to provide the
               highest performance and lowest possible power consumption for a wide range of usage scenarios,
               including voice calls and music playback. The speaker drivers offer low leakage and high PSRR; this
               enables direct connection to a Lithium battery. The speaker drivers provide eight levels of AC and DC
               gain to allow output signal levels to be maximised for many commonly-used SPKVDD/AVDD1
               combinations.
               The ADCs and DACs are of hi-fi quality, using a 24-bit low-order oversampling architecture to deliver
               optimum performance. A flexible clocking arrangement supports mixed sample rates, whilst integrated
               ultra-low power dual FLLs provide additional flexibility. A high pass filter is available in all ADC and
               digital MIC paths for removing DC offsets and suppressing low frequency noise such as mechanical
               vibration and wind noise. A digital mixing path from the ADC or digital MICs to the DAC provides a
               sidetone of enhanced quality during voice calls. DAC soft mute and un-mute is available for pop-free
               music playback.
                                                                                              PP, March 2014, Rev 3.5
w
                                                                                                                     41


WM8958                                                                                         Pre-Production
                                                                                                              TM
       The integrated Multiband Compressors (MBC), Dynamic Range Controllers (DRC) and ReTune
       Mobile 5-band parametric equaliser (EQ) provide further processing capability of the digital audio
       paths. The MBC enables the loudness of the digital playback path to be maximised without
       overdriving the loudspeakers. The RMS Limiter within the MBC function enables the maximum signal
       level to be matched to the application requirements and/or power rating of the loudspeaker. The DRC
       provides compression and signal level control to improve the handling of unpredictable signal levels.
       ‘Anti-clip’ and ‘quick release’ algorithms improve intelligibility in the presence of transients and
       impulsive noises. The EQ provides the capability to tailor the audio path according to the frequency
       characteristics of an earpiece or loudspeaker, and/or according to user preferences.
       The WM8958 has highly flexible digital audio interfaces, supporting a number of protocols, including
        2
       I S, DSP, MSB-first left/right justified, and can operate in master or slave modes. PCM operation is
       supported in the DSP mode. A-law and -law companding are also supported. Time division
       multiplexing (TDM) is available to allow multiple devices to stream data simultaneously on the same
       bus, saving space and power. The four digital MIC and ADC channels and four DAC channels are
       available via four TDM channels on Digital Audio Interface 1 (AIF1).
       A powerful digital mixing core allows data from each TDM channel of each audio interface and from
       the ADCs and digital MICs to be mixed and re-routed back to a different audio interface and to the 4
       DAC output channels. The digital mixing core can operate synchronously with either Audio Interface 1
       or Audio Interface 2, with asynchronous stereo full duplex sample rate conversion performed on the
       other audio interface as required.
       The system clock (SYSCLK) provides clocking for the ADCs, DACs, DSP core, digital audio interface
       and other circuits. SYSCLK can be derived directly from one of the MCLK1 or MCLK2 pins or via one
       of two integrated FLLs, providing flexibility to support a wide range of clocking schemes, including
       self-clocking FLL modes. Typical portable system MCLK frequencies, and sample rates from 8kHz to
       96kHz are all supported. A low frequency (eg. 32.768kHz) clock can be used as the input reference to
       the FLLs, providing further flexibility. Automatic configuration of the clocking circuits is available,
       derived from the sample rate and from the MCLK / SYSCLK ratio.
       The WM8958 uses a standard 2-wire control interface, providing full software control of all features,
       together with device register readback. An integrated Control Write Sequencer enables automatic
       scheduling of control sequences; commonly-used signal configurations may be selected using ready-
       programmed sequences, including time-optimised control of the WM8958 pop suppression features. It
       is an ideal partner for a wide range of industry standard microprocessors, controllers and DSPs.
       Unused circuitry can be disabled under software control, in order to save power; low leakage currents
       enable extended standby/off time in portable battery-powered applications.
       Versatile GPIO functionality is provided, with support for button/accessory detect inputs, or for clock,
       system status, or programmable logic level output for control of additional external circuitry. Interrupt
       logic, status readback and de-bouncing options are supported within this functionality.
                                                                                    PP, March 2014, Rev 3.5
w
                                                                                                             42


Pre-Production                                                                                                      WM8958
ANALOGUE INPUT SIGNAL PATH
                            The WM8958 has eight highly flexible analogue input channels, configurable in a large number of
                            combinations:
                            1. Up to four fully differential or single-ended microphone inputs
                            2. Up to eight mono line inputs or 4 stereo line inputs
                            3. A dedicated mono differential input from external voice CODEC
                            These inputs may be mixed together or independently routed to different combinations of output
                            drivers. An internal record path is provided at the input mixers to allow DAC output to be mixed with
                            the input signal path (e.g. for voice call recording).
                            The WM8958 input signal paths and control registers are illustrated in Figure 8.
Figure 8 Control Registers for Input Signal Path
                                                                                                         PP, March 2014, Rev 3.5
w
                                                                                                                              43


WM8958                                                                                           Pre-Production
       MICROPHONE INPUTS
       Up to four analogue microphones can be connected to the WM8958, either in single-ended or
       differential mode. A dedicated PGA is provided for each microphone input. Two low noise microphone
       bias circuits are provided, reducing the need for external components.
       For single-ended microphone inputs, the microphone signal is connected to the inverting input of the
       PGAs (IN1LN, IN2LN, IN1RN or IN2RN). The non-inverting inputs of the PGAs are internally
       connected to VMID in this configuration. The non-inverting input pins IN1LP, IN2LP, IN1RP and
       IN2RP are free to be used as line connections to the input or output mixers in this configuration.
       For differential microphone inputs, the non-inverted microphone signal is connected to the non-
       inverting input of the PGAs (IN1LP, IN2LP, IN1RP or IN2RP), whilst the inverted (or ‘noisy ground’)
       signal is connected to the inverting input pins (IN1LN, IN2LN, IN1RN and IN2RN).
       The gain of the input PGAs is controlled via register settings, as defined in Table 4. Note that the input
       impedance of both inverting and non-inverting inputs changes with the input PGA gain setting, as
       described under “Electrical Characteristics”. See also the “Applications Information” for details of input
       resistance at all PGA Gain settings.
       The microphone input configurations are illustrated in Figure 9 and Figure 10. Note that any PGA input
       pin that is used in either microphone configuration is not available for use as a line input path at the
       same time.
        Figure 9 Single-Ended Microphone Input                  Figure 10 Differential Microphone Input
       MICROPHONE BIAS CONTROL
       There are two MICBIAS generators which provide low noise reference voltages suitable for powering
       silicon (MEMS) microphones or biasing electret condenser (ECM) type microphones via an external
       resistor. Refer to the “Applications Information” section for recommended external components.
       The MICBIAS outputs can be independently enabled using the MICB1_ENA and MICB2_ENA register
       bits. Under default conditions, a smooth pop-free profile of the MICBIAS outputs is implemented when
       MICB1_ENA or MICB2_ENA is enabled or disabled; a faster transition can be selected by setting the
       MICB1_RATE and MICB2_RATE registers as described in Table 1.
       When a MICBIAS output is disabled, the output pin can be configured to be floating or to be actively
       discharged. This is selected using the MICB1_DISCH and MICB2_DISCH register bits.
       The MICBIAS generators can each operate as a voltage regulator or in bypass mode.
       In Regulator mode, the output voltage is selected using the MICB1_LVL and MICB2_LVL register bits.
       In this mode, AVDD1 must be at least 200mV greater than the required MICBIAS output voltages. The
       MICBIAS outputs are powered from the AVDD1 supply pin, and use the internal bandgap circuit as a
       reference.
       Note that, in Regulator mode, the MICBIAS regulators are designed to operate without external
       decoupling capacitors. It is important that parasitic capacitances on the MICBIAS1 or MICBIAS2 pins
       do not exceed the specified limit in Regulator mode (see “Electrical Characteristics”).
       In Bypass mode, the output pin (MICBIAS1 or MICBIAS2) is connected directly to AVDD1. This
       enables a low power operating state. Note that, if a capacitive load is connected to MICBIAS1 or
       MICBIAS2 (eg. for a digital microphone supply), then the respective MICBIAS generator must be
       configured in Bypass mode.
                                                                                      PP, March 2014, Rev 3.5
w
                                                                                                              44


Pre-Production                                                                                        WM8958
               The MICBIAS configuration is illustrated in Figure 11.
               Figure 11 MICBIAS Generator
                REGISTER     BIT           LABEL             DEFAULT                 DESCRIPTION
                 ADDRESS
                 R1         5       MICB2_ENA                    0    Microphone Bias 2 Enable
                 (0001h)                                              0 = Disabled
                 Power                                                1 = Enabled
                 Managem
                            4       MICB1_ENA                    0    Microphone Bias 1 Enable
                 ent (1)
                                                                      0 = Disabled
                                                                      1 = Enabled
                 R61        5       MICB1_RATE                   1    Microphone Bias 1 Rate
                 (003Dh)                                              0 = Fast start-up / shut-down
                 MICBIAS                                              1 = Pop-free start-up / shut-down
                 1
                            4       MICB1_MODE                   1    Microphone Bias 1 Mode
                                                                      0 = Regulator mode
                                                                      1 = Bypass mode
                            3:1     MICB1_LVL [2:0]             100   Microphone Bias 1 Voltage Control
                                                                      (when MICB1_MODE = 0)
                                                                      000 = 1.5V
                                                                      001 = 1.8V
                                                                      010 = 1.9V
                                                                      011 = 2.0V
                                                                      100 = 2.2V
                                                                      101 = 2.4V
                                                                      110 = 2.5V
                                                                      111 = 2.6V
                            0       MICB1_DISCH                  1    Microphone Bias 1 Discharge
                                                                      0 = MICBIAS1 floating when disabled
                                                                      1 = MICBIAS1 discharged when disabled
                 R62        5       MICB2_RATE                   1    Microphone Bias 2 Rate
                 (003Eh)                                              0 = Fast start-up / shut-down
                 MICBIAS                                              1 = Pop-free start-up / shut-down
                 2
                            4       MICB2_MODE                   1    Microphone Bias 2 Mode
                                                                      0 = Regulator mode
                                                                      1 = Bypass mode
                                                                                           PP, March 2014, Rev 3.5
w
                                                                                                                45


WM8958                                                                                            Pre-Production
         REGISTER        BIT           LABEL          DEFAULT                    DESCRIPTION
         ADDRESS
                        3:1     MICB2_LVL [2:0]           100      Microphone Bias 2 Voltage Control
                                                                   (when MICB2_MODE = 0)
                                                                   000 = 1.5V
                                                                   001 = 1.8V
                                                                   010 = 1.9V
                                                                   011 = 2.0V
                                                                   100 = 2.2V
                                                                   101 = 2.4V
                                                                   110 = 2.5V
                                                                   111 = 2.6V
                        0       MICB2_DISCH                1       Microphone Bias 2 Discharge
                                                                   0 = MICBIAS2 floating when disabled
                                                                   1 = MICBIAS2 discharged when disabled
       Table 1 Microphone Bias Control
       Note that the maximum source current capability for MICBIAS1 and MICBIAS2 is 2.4mA each in
       Regulator mode. The external biasing resistance must be large enough to limit each MICBIAS current
       to 2.4mA across the full microphone impedance range. The maximum source current for MICBIAS1
       and MICBIAS2 is 3.6mA each in Bypass mode, as described in the “Electrical Characteristics”.
       MICROPHONE ACCESSORY DETECT
       The WM8958 provides a microphone detection function, which uses impedance measurement to
       detect one or more different external accessory connections. This feature is described in the “External
       Accessory Detection” section.
       LINE AND VOICE CODEC INPUTS
       All eight analogue input pins may be used as line inputs. Each line input has different signal path
       options, providing flexibility, high performance and low power consumption for many different usage
       modes.
       IN1LN and IN1RN can operate as single-ended line inputs to the input PGAs IN1L and IN1R
       respectively. These inputs provide a high gain path if required for low input signal levels.
       IN2LN and IN2RN can operate as single-ended line inputs to the input PGAs IN2L and IN2R
       respectively, providing further high gain signal paths. These pins can also be connected to either of
       the output mixers MIXOUTL and MIXOUTR.
       IN1LP and IN1RP can operate as single-ended line inputs to the input mixers MIXINL and MIXINR, or
       to the speaker mixers SPKMIXL and SPKMIXR. These signal paths enable power consumption to be
       reduced, by allowing the input PGAs and other circuits to be disabled if not required.
       IN2LP/VRXN and IN2RP/VRXP can operate in three different ways:
                 Mono differential ’RXVOICE’ input (e.g. from an external voice CODEC) to the input mixers
                  MIXINL and MIXINR.
                 Single-ended line inputs to either of the output mixers MIXOUTL and MIXOUTR.
                 Ultra-low power mono differential ‘Direct Voice’ input (e.g. from an external voice CODEC)
                  to the ear speaker driver on HPOUT2, or to either of the speaker drivers on SPKOUTL and
                  SPKOUTR.
       Signal path configuration to the input PGAs and input mixers is detailed later in this section. Signal
       path configuration to the output mixers and speaker mixers is described in “Analogue Output Signal
       Path”.
                                                                                       PP, March 2014, Rev 3.5
w
                                                                                                             46


Pre-Production                                                                                                 WM8958
                 The line input and voice CODEC input configurations are illustrated in Figure 12 through to Figure 15.
                                                                                                                    MIXOUTL/R
                                                                        Line Input
                                                                                     IN2LN,
                                                                                     IN2RN              -
                                                                                                         PGA        MIXINL/R
                                                                                                        +
                                                                                        VMID
                 Figure 12 IN1LN or IN1RN as Line Inputs               Figure 13 IN2LN or IN2RN as Line Inputs
                 Figure 14 IN1LP or IN1RP as Line Inputs               Figure 15 IN2LP or IN2RP as Line Inputs
                 INPUT PGA ENABLE
                 The Input PGAs are enabled using register bits IN1L_ENA, IN2L_ENA, IN1R_ENA and IN2R_ENA,
                 as described in Table 2. The Input PGAs must be enabled for microphone input on the respective
                 input pins, or for line input on the inverting input pins IN1LN, IN1RN, IN2LN, IN2RN.
                    REGISTER         BIT       LABEL        DEFAULT                           DESCRIPTION
                    ADDRESS
                  R2 (0002h)          7     IN2L_ENA            0        IN2L Input PGA Enable
                  Power                                                  0 = Disabled
                  Management                                             1 = Enabled
                  (2)
                                      6     IN1L_ENA            0        IN1L Input PGA Enable
                                                                         0 = Disabled
                                                                         1 = Enabled
                                      5     IN2R_ENA            0        IN2R Input PGA Enable
                                                                         0 = Disabled
                                                                         1 = Enabled
                                      4     IN1R_ENA            0        IN1R Input PGA Enable
                                                                         0 = Disabled
                                                                         1 = Enabled
                 Table 2 Input PGA Enable
                 For normal operation of the input PGAs, the reference voltage VMID and the bias current must also be
                 enabled. See “Reference Voltages and Master Bias” for details of the associated controls VMID_SEL
                 and BIAS_ENA.
                                                                                                  PP, March 2014, Rev 3.5
w
                                                                                                                       47


WM8958                                                                                       Pre-Production
       INPUT PGA CONFIGURATION
       Each of the Input PGAs can operate in a single-ended or differential mode. In differential mode, both
       inputs to the PGA are connected to the input source. In single-ended mode, the non-inverting input to
       the PGA must be connected to VMID. Configuration of the PGA inputs to the WM8958 input pins is
       controlled using the register bits shown in Table 3.
       Single-ended microphone operation is configured by connecting the input source to the inverting input
       of the applicable PGA. The non-inverting input of the PGA must be connected to the buffered VMID
       reference. Note that the buffered VMID reference must be enabled, using the VMID_BUF_ENA
       register, as described in “Reference Voltages and Master Bias”.
       Differential microphone operation is configured by connecting the input source to both inputs of the
       applicable PGA.
       Line inputs to the input pins IN1LN, IN2LN, IN1RN and IN2RN must be connected to the applicable
       PGA. The non-inverting input of the PGA must be connected to VMID.
       Line inputs to the input pins IN1LP, IN2LP, IN1RP or IN2RP do not connect to the input PGAs. The
       non-inverting inputs of the associated PGAs must be connected to VMID. The inverting inputs of the
       associated PGAs may be used as separate mic/line inputs if required.
       The maximum available attenuation on any of these input paths is achieved by using register bits
       shown in Table 3 to disconnect the input pins from the applicable PGA.
           REGISTER         BIT            LABEL          DEFAULT                 DESCRIPTION
           ADDRESS
         R40 (0028h)         7      IN2LP_TO_IN2L            0         IN2L PGA Non-Inverting Input Select
         Input Mixer                                                   0 = Connected to VMID
         (2)                                                           1 = Connected to IN2LP
                                                                       Note that VMID_BUF_ENA must be
                                                                       set when using IN2L connected to
                                                                       VMID.
                             6      IN2LN_TO_IN2L            0         IN2L PGA Inverting Input Select
                                                                       0 = Not connected
                                                                       1 = Connected to IN2LN
                             5      IN1LP_TO_IN1L            0         IN1L PGA Non-Inverting Input Select
                                                                       0 = Connected to VMID
                                                                       1 = Connected to IN1LP
                                                                       Note that VMID_BUF_ENA must be
                                                                       set when using IN1L connected to
                                                                       VMID.
                             4      IN1LN_TO_IN1L            0         IN1L PGA Inverting Input Select
                                                                       0 = Not connected
                                                                       1 = Connected to IN1LN
                             3      IN2RP_TO_IN2R            0         IN2R PGA Non-Inverting Input Select
                                                                       0 = Connected to VMID
                                                                       1 = Connected to IN2RP
                                                                       Note that VMID_BUF_ENA must be
                                                                       set when using IN2R connected to
                                                                       VMID.
                             2      IN2RN_TO_IN2R            0         IN2R PGA Inverting Input Select
                                                                       0 = Not connected
                                                                       1 = Connected to IN2RN
                             1      IN1RP_TO_IN1R            0         IN1R PGA Non-Inverting Input Select
                                                                       0 = Connected to VMID
                                                                       1 = Connected to IN1RP
                                                                       Note that VMID_BUF_ENA must be
                                                                       set when using IN1R connected to
                                                                       VMID.
                             0      IN1RN_TO_IN1R            0         IN1R PGA Inverting Input Select
                                                                       0 = Not connected
                                                                       1 = Connected to IN1RN
       Table 3 Input PGA Configuration
                                                                                   PP, March 2014, Rev 3.5
w
                                                                                                         48


Pre-Production                                                                                            WM8958
               INPUT PGA VOLUME CONTROL
               Each of the four Input PGAs has an independently controlled gain range of -16.5dB to +30dB in 1.5dB
               steps. The gains on the inverting and non-inverting inputs to the PGAs are always equal. Each Input
               PGA can be independently muted using the PGA mute bits as described in Table 4, with maximum
               mute attenuation achieved by simultaneously disconnecting the corresponding inputs described in
               Table 3.
               Note that, under default conditions (following power-up or software reset), the PGA mute register bits
               are set to ‘1’, but the mute functions will only become effective after the respective bit has been
               toggled to ‘0’ and then back to ‘1’. The Input PGAs will be un-muted (Mute disabled) after power-up or
               software reset, regardless of the readback value of the respective PGA mute bits.
               To prevent "zipper noise", a zero-cross function is provided on the input PGAs. When this feature is
               enabled, volume updates will not take place until a zero-crossing is detected. In the case of a long
               period without zero-crossings, a timeout function is provided. When the zero-cross function is
               enabled, the volume will update after the timeout period if no earlier zero-cross has occurred. The
               timeout clock is enabled using TOCLK_ENA, the timeout period is set by TOCLK_DIV. See “Clocking
               and Sample Rates” for more information on these fields.
               The IN1_VU and IN2_VU bits control the loading of the input PGA volume data. When IN1_VU and
               IN2_VU are set to 0, the PGA volume data will be loaded into the respective control register, but will
               not actually change the gain setting. The IN1L and IN1R volume settings are both updated when a 1
               is written to IN1_VU; the IN2L and IN2R volume settings are both updated when a 1 is written to
               IN2_VU. This makes it possible to update the gain of the left and right signal paths simultaneously.
                                                                                              PP, March 2014, Rev 3.5
w
                                                                                                                    49


WM8958                                                                                           Pre-Production
       The Input PGA Volume Control register fields are described in Table 4 and Table 5.
          REGISTER       BIT      LABEL           DEFAULT                      DESCRIPTION
          ADDRESS
        R24 (0018h)       8    IN1_VU                N/A        Input PGA Volume Update
        Left Line Input                                         Writing a 1 to this bit will cause IN1L and
        1&2 Volume                                              IN1R input PGA volumes to be updated
                                                                simultaneously
                          7    IN1L_MUTE              1         IN1L PGA Mute
                                                                0 = Disable Mute
                                                                1 = Enable Mute
                          6    IN1L_ZC                0         IN1L PGA Zero Cross Detector
                                                                0 = Change gain immediately
                                                                1 = Change gain on zero cross only
                         4:0   IN1L_VOL             01011       IN1L Volume
                               [4:0]                (0dB)       -16.5dB to +30dB in 1.5dB steps
                                                                (See Table 5 for volume range)
        R25 (0019h)       8    IN2_VU                N/A        Input PGA Volume Update
        Left Line Input                                         Writing a 1 to this bit will cause IN2L and
        3&4 Volume                                              IN2R input PGA volumes to be updated
                                                                simultaneously
                          7    IN2L_MUTE              1         IN2L PGA Mute
                                                                0 = Disable Mute
                                                                1 = Enable Mute
                          6    IN2L_ZC                0         IN2L PGA Zero Cross Detector
                                                                0 = Change gain immediately
                                                                1 = Change gain on zero cross only
                         4:0   IN2L_VOL             01011       IN2L Volume
                               [4:0]                (0dB)       -16.5dB to +30dB in 1.5dB steps
                                                                (See Table 5 for volume range)
        R26 (001Ah)       8    IN1_VU                N/A        Input PGA Volume Update
        Right Line                                              Writing a 1 to this bit will cause IN1L and
        Input 1&2                                               IN1R input PGA volumes to be updated
        Volume                                                  simultaneously
                          7    IN1R_MUTE              1         IN1R PGA Mute
                                                                0 = Disable Mute
                                                                1 = Enable Mute
                          6    IN1R_ZC                0         IN1R PGA Zero Cross Detector
                                                                0 = Change gain immediately
                                                                1 = Change gain on zero cross only
                         4:0   IN1R_VOL             01011       IN1R Volume
                               [4:0]                (0dB)       -16.5dB to +30dB in 1.5dB steps
                                                                (See Table 5 for volume range)
        R27 (001Bh)       8    IN2_VU                N/A        Input PGA Volume Update
        Right Line                                              Writing a 1 to this bit will cause IN2L and
        Input 3&4                                               IN2R input PGA volumes to be updated
        Volume                                                  simultaneously
                          7    IN2R_MUTE              1         IN2R PGA Mute
                                                                0 = Disable Mute
                                                                1 = Enable Mute
                          6    IN2R_ZC                0         IN2R PGA Zero Cross Detector
                                                                0 = Change gain immediately
                                                                1 = Change gain on zero cross only
                         4:0   IN2R_VOL             01011       IN2R Volume
                               [4:0]                (0dB)       -16.5dB to +30dB in 1.5dB steps
                                                                (See Table 5 for volume range)
       Table 4 Input PGA Volume Control
                                                                                    PP, March 2014, Rev 3.5
w
                                                                                                            50


Pre-Production                                                    WM8958
                  IN1L_VOL[4:0], IN2L_VOL[4:0], VOLUME
                   IN1R_VOL[4:0], IN2R_VOL[4:0]   (dB)
                              00000              -16.5
                              00001              -15.0
                              00010              -13.5
                              00011              -12.0
                              00100              -10.5
                              00101               -9.0
                              00110               -7.5
                              00111               -6.0
                              01000               -4.5
                              01001               -3.0
                              01010               -1.5
                              01011                0
                              01100              +1.5
                              01101              +3.0
                              01110              +4.5
                              01111              +6.0
                              10000              +7.5
                              10001              +9.0
                              10010              +10.5
                              10011              +12.0
                              10100              +13.5
                              10101              +15.0
                              10110              +16.5
                              10111              +18.0
                              11000              +19.5
                              11001              +21.0
                              11010              +22.5
                              11011              +24.0
                              11100              +25.5
                              11101              +27.0
                              11110              +28.5
                              11111              +30.0
               Table 5 Input PGA Volume Range
                                                       PP, March 2014, Rev 3.5
w
                                                                            51


WM8958                                                                                         Pre-Production
       INPUT MIXER ENABLE
       The WM8958 has two analogue input mixers which allow the Input PGAs and Line Inputs to be
       combined in a number of ways and output to the ADCs, Output Mixers, or directly to the output drivers
       via bypass paths.
       The input mixers MIXINL and MIXINR are enabled by the MIXINL_ENA and MIXINR_ENA register
       bits, as described in Table 6. These control bits also enable the RXVOICE input path, described in the
       following section.
       For normal operation of the input mixers, the reference voltage VMID and the bias current must also
       be enabled. See “Reference Voltages and Master Bias” for details of the associated controls
       VMID_SEL and BIAS_ENA.
            REGISTER         BIT       LABEL           DEFAULT                    DESCRIPTION
            ADDRESS
          R2 (0002h)          9     MIXINL_ENA              0        Left Input Mixer Enable
          Power                                                      (Enables MIXINL and RXVOICE input to
          Management                                                 MIXINL)
          (2)                                                        0 = Disabled
                                                                     1 = Enabled
                              8     MIXINR_ENA              0        Right Input Mixer Enable
                                                                     (Enables MIXINR and RXVOICE input to
                                                                     MIXINR)
                                                                     0 = Disabled
                                                                     1 = Enabled
       Table 6 Input Mixer Enable
       INPUT MIXER CONFIGURATION AND VOLUME CONTROL
       The left and right channel input mixers MIXINL and MIXINR can be configured to take input from up to
       five sources:
       1.     IN1L or IN1R Input PGA
       2.     IN2L or IN2R Input PGA
       3.     IN1LP or IN1RP pin (PGA bypass)
       4.     RXVOICE mono differential input from IN2LP/VRXN and IN2RP/VRXP
       5.     MIXOUTL or MIXOUTR Output Mixer (Record path)
       The Input Mixer configuration and volume controls are described in Table 7 for the Left input mixer
       (MIXINL) and Table 8 for the Right input mixer (MIXINR). The signal levels from the Input PGAs may
       be set to Mute, 0dB or 30dB boost. Gain controls for the PGA bypass, RXVOICE and Record paths
       provide adjustment from -12dB to +6dB in 3dB steps.
       When using the IN1LP or IN1RP signal paths direct to the input mixers (PGA bypass paths), a signal
       gain of +15dB can be selected using the IN1RP_MIXINR_BOOST or IN1LP_MIXINL_BOOST register
       bits. See Table 7 and Table 8 for further details.
       When using the IN1LP or IN1RP signal paths direct to the input mixers (PGA bypass paths), the
       buffered VMID reference must be enabled, using the VMID_BUF_ENA register, as described in
       “Reference Voltages and Master Bias”.
       To prevent pop noise, it is recommended that gain and mute controls for the input mixers are not
       modified while the signal paths are active. If volume control is required on these signal paths, it is
       recommended that this is implemented using the input PGA volume controls or the ADC volume
       controls. The ADC volume controls are described in the “Analogue to Digital Converter (ADC)”
       section.
                                                                                      PP, March 2014, Rev 3.5
w
                                                                                                           52


Pre-Production                                                                  WM8958
                REGISTER   BIT        LABEL       DEFAULT            DESCRIPTION
                ADDRESS
               R21          7  IN1LP_MIXINL_BOOST    0    IN1LP Pin (PGA Bypass) to
               (0015h)                                    MIXINL Gain Boost.
               Input Mixer                                This bit selects the maximum gain
               (1)                                        setting of the IN1LP_MIXINL_VOL
                                                          register.
                                                          0 = Maximum gain is +6dB
                                                          1 = Maximum gain is +15dB
               R41          8  IN2L_TO_MIXINL        0    IN2L PGA Output to MIXINL Mute
               (0029h)                                    0 = Mute
               Input Mixer                                1 = Un-Mute
               (3)
                            7  IN2L_MIXINL_VOL       0    IN2L PGA Output to MIXINL Gain
                                                          0 = 0dB
                                                          1 = +30dB
                            5  IN1L_TO_MIXINL        0    IN1L PGA Output to MIXINL Mute
                                                          0 = Mute
                                                          1 = Un-Mute
                            4  IN1L_MIXINL_VOL       0    IN1L PGA Output to MIXINL Gain
                                                          0 = 0dB
                                                          1 = +30dB
                           2:0 MIXOUTL_MIXINL_VOL   000   Record Path MIXOUTL to MIXINL
                               [2:0]               (Mute) Gain and Mute
                                                          000 = Mute
                                                          001 = -12dB
                                                          010 = -9dB
                                                          011 = -6dB
                                                          100 = -3dB
                                                          101 = 0dB
                                                          110 = +3dB
                                                          111 = +6dB
               R43         8:6 IN1LP_MIXINL_VOL     000   IN1LP Pin (PGA Bypass) to
               (002Bh)         [2:0]               (Mute) MIXINL Gain and Mute
               Input Mixer                                000 = Mute
               (5)                                        001 = -12dB
                                                          010 = -9dB
                                                          011 = -6dB
                                                          100 = -3dB
                                                          101 = 0dB
                                                          110 = +3dB
                                                          111 = +6dB (see note below).
                                                          When IN1LP_MIXINL_BOOST is
                                                          set, then the maximum gain
                                                          setting is increased to +15dB, ie.
                                                          111 = +15dB.
                                                          Note that VMID_BUF_ENA must
                                                          be set when using the IN1LP (PGA
                                                          Bypass) input to MIXINL.
                                                                    PP, March 2014, Rev 3.5
w
                                                                                           53


WM8958                                                                                Pre-Production
         REGISTER       BIT            LABEL            DEFAULT             DESCRIPTION
         ADDRESS
                        2:0    IN2LRP_MIXINL_VOL          000    RXVOICE Differential Input
                               [2:0]                     (Mute)  (VRXP-VRXN) to MIXINL Gain
                                                                 and Mute
                                                                 000 = Mute
                                                                 001 = -12dB
                                                                 010 = -9dB
                                                                 011 = -6dB
                                                                 100 = -3dB
                                                                 101 = 0dB
                                                                 110 = +3dB
                                                                 111 = +6dB
       Table 7 Left Input Mixer (MIXINL) Volume Control
         REGISTER       BIT             LABEL            DEFAULT            DESCRIPTION
         ADDRESS
        R21 (0015h)      8     IN1RP_MIXINR_BOOST           0    IN1RP Pin (PGA Bypass) to
        Input Mixer                                              MIXINR Gain Boost.
        (1)                                                      This bit selects the maximum gain
                                                                 setting of the
                                                                 IN1RP_MIXINR_VOL register.
                                                                 0 = Maximum gain is +6dB
                                                                 1 = Maximum gain is +15dB
        R42 (002A)       8     IN2R_TO_MIXINR               0    IN2R PGA Output to MIXINR Mute
        Input Mixer                                              0 = Mute
        (4)                                                      1 = Un-Mute
                         7     IN2R_MIXINR_VOL              0    IN2R PGA Output to MIXINR Gain
                                                                 0 = 0dB
                                                                 1 = +30dB
                         5     IN1R_TO_MIXINR               0    IN1R PGA Output to MIXINR Mute
                                                                 0 = Mute
                                                                 1 = Un-Mute
                         4     IN1R_MIXINR_VOL              0    IN1R PGA Output to MIXINR Gain
                                                                 0 = 0dB
                                                                 1 = +30dB
                        2:0    MIXOUTR_MIXINR_VOL          000   Record Path MIXOUTR to MIXINR
                               [2:0]                      (Mute) Gain and Mute
                                                                 000 = Mute
                                                                 001 = -12dB
                                                                 010 = -9dB
                                                                 011 = -6dB
                                                                 100 = -3dB
                                                                 101 = 0dB
                                                                 110 = +3dB
                                                                 111 = +6dB
                                                                           PP, March 2014, Rev 3.5
w
                                                                                                 54


Pre-Production                                                                                 WM8958
                 REGISTER       BIT            LABEL             DEFAULT            DESCRIPTION
                 ADDRESS
                R44             8:6   IN1RP_MIXINR_VOL             000   IN1RP Pin (PGA Bypass) to
                (002Ch)               [2:0]                       (Mute) MIXINR Gain and Mute
                Input Mixer                                              000 = Mute
                (6)                                                      001 = -12dB
                                                                         010 = -9dB
                                                                         011 = -6dB
                                                                         100 = -3dB
                                                                         101 = 0dB
                                                                         110 = +3dB
                                                                         111 = +6dB (see note below).
                                                                         When IN1RP_MIXINR_BOOST is
                                                                         set, then the maximum gain
                                                                         setting is increased to +15dB, ie.
                                                                         111 = +15dB.
                                                                         Note that VMID_BUF_ENA must
                                                                         be set when using the IN1RP
                                                                         (PGA Bypass) input to MIXINR.
                                2:0   IN2LRP_MIXINR_VOL            000   RXVOICE Differential Input
                                      [2:0]                       (Mute) (VRXP-VRXN) to MIXINR Gain
                                                                         and Mute
                                                                         000 = Mute
                                                                         001 = -12dB
                                                                         010 = -9dB
                                                                         011 = -6dB
                                                                         100 = -3dB
                                                                         101 = 0dB
                                                                         110 = +3dB
                                                                         111 = +6dB
               Table 8 Right Input Mixer (MIXINR) Volume Control
                                                                                   PP, March 2014, Rev 3.5
w
                                                                                                         55


WM8958                                                                                                      Pre-Production
DIGITAL MICROPHONE INTERFACE
                The WM8958 supports a four-channel digital microphone interface. Two channels of audio data are
                multiplexed on the DMICDAT1 pin and a further two channels are multiplexed on the DMICDAT2 pin.
                All four channels are clocked using the DMICCLK output pin.
                The DMICDAT1 function is shared with the IN2LN pin; the analogue signal paths from IN2LN cannot
                be used when this pin is used for DMICDAT1 digital microphone input.
                The DMICDAT2 function is shared with the IN2RN pin; the analogue signal paths from IN2RN cannot
                be used when this pin is used for DMICDAT2 digital microphone input.
                The digital microphone interface is referenced to the MICBIAS1 voltage domain; the MICBIAS1 output
                must be enabled (MICB1_ENA = 1) when using the digital microphone interface.
                The MICBIAS1 generator is suitable for use as a low noise supply for the digital microphones. Note
                that, if the capacitive load on the MICBIAS1 generator exceeds the specified limit (eg. due to a
                decoupling capacitor or long PCB trace), then the MICBIAS1 generator must be configured in Bypass
                mode. See “Analogue Input Signal Path” for details of the MICBIAS1 generator.
                When digital microphone input is enabled, the WM8958 outputs a clock signal on the DMICCLK pin.
                A pair of digital microphones is connected as illustrated in Figure 16. The microphones must be
                configured to ensure that the Left mic transmits a data bit when DMICCLK is high, and the Right mic
                transmits a data bit when DMICCLK is low. The WM8958 samples the digital microphone data at the
                end of each DMICCLK phase. Each microphone must tri-state its data output when the other
                microphone is transmitting.
                Figure 16 Digital Microphone Input
                The DMICDAT1 digital microphone channels are enabled using DMIC1L_ENA and DMIC1R_ENA.
                When these signal paths are enabled, the respective ADC path is disconnected and the digital
                microphone data is routed to the digital mixing input bus, as illustrated in “Digital Mixing”.
                The DMICDAT2 digital microphone channels are enabled using DMIC2L_ENA and DMIC2R_ENA.
                When these signal paths are enabled, the digital microphone data is routed to the digital mixing input
                bus, as illustrated in “Digital Mixing”.
                Two microphone channels are interleaved on DMICDAT1; another two channels are interleaved on
                DMICDAT2. The timing is illustrated in Figure 17. Each microphone must tri-state its data output when
                the other microphone is transmitting.
                                                                                                 PP, March 2014, Rev 3.5
w
                                                                                                                       56


Pre-Production                                                                                              WM8958
                           DMICCLK pin
                                                                  hi-Z
                          Left Mic output            1           1            1
                        Right Mic output                   2            2            2
                          DMICDATn pin               1     2      1     2      1      2
                             (Left & Right
                  channels interleaved)
               Figure 17 Digital Microphone Interface Timing
               The four digital microphone channels can be routed to one of the four timeslots on AIF1. The
               DMICDAT1 microphones, when enabled, are routed to the Left/Right channels of AIF1 Timeslot 0.
               The DMICDAT2 microphones, when enabled, are routed to the Left/Right channels of AIF1 Timeslot
               1.
               Digital volume control of the digital microphone channels in the AIF1 signal paths is provided using
               the registers described in the “Digital Volume and Filter Control” section.
               The digital microphone channels can be routed, in a limited number of configurations, to the digital
               mixing output bus, via the digital sidetone signal paths. See “Digital Mixing” for further details.
               Digital volume control of the digital microphone channels in the digital sidetone signal paths is
               provided using the registers described in the “Digital Mixing” section.
               The digital microphone interface control fields are described in Table 9.
                    REGISTER        BIT               LABEL              DEFAULT                DESCRIPTION
                    ADDRESS
                  R4 (0004h)         5      DMIC2L_ENA                      0         Digital microphone DMICDAT2
                  Power                                                               Left channel enable
                  Management                                                          0 = Disabled
                  (4)                                                                 1 = Enabled
                                     4      DMIC2R_ENA                      0         Digital microphone DMICDAT2
                                                                                      Right channel enable
                                                                                      0 = Disabled
                                                                                      1 = Enabled
                                     3      DMIC1L_ENA                      0         Digital microphone DMICDAT1
                                                                                      Left channel enable
                                                                                      0 = Disabled
                                                                                      1 = Enabled
                                     2      DMIC1R_ENA                      0         Digital microphone DMICDAT1
                                                                                      Right channel enable
                                                                                      0 = Disabled
                                                                                      1 = Enabled
               Table 9 Digital Microphone Interface Control
                                                                                               PP, March 2014, Rev 3.5
w
                                                                                                                    57


WM8958                                                                                        Pre-Production
       Clocking for the Digital Microphone interface is derived from SYSCLK. The DMICCLK frequency is
       configured automatically, according to the AIFn_SR, AIFnCLK_RATE and ADC_OSR128 registers.
       (See “Clocking and Sample Rates” for further details of the system clocks and control registers.)
       The DMICCLK is enabled whenever a digital microphone input path is enabled on the DMICDAT1 or
       DMICDAT2 pin(s). Note that the SYSDSPCLK_ENA register must also be set.
       When AIF1CLK is selected as the SYSCLK source (SYSCLK_SRC = 0), then the DMICCLK
       frequency is controlled by the AIF1_SR and AIF1CLK_RATE registers.
       When AIF2CLK is selected as the SYSCLK source (SYSCLK_SRC = 1), then the DMICCLK
       frequency is controlled by the AIF2_SR and AIF2CLK_RATE registers.
       The DMICCLK frequency is as described in Table 10 (for ADC_OSR128=1) and Table 11 (for
       ADC_OSR128=0). The ADC_OSR128 bit is set by default, giving best audio performance. Note that
       the only valid DMICCLK configurations are the ones listed in Table 10 and Table 11.
       The applicable clocks (SYSCLK, and AIF1CLK or AIF2CLK) must be present and enabled when using
       the digital microphone interface.
            SAMPLE                             SYSCLK RATE (AIFnCLK / fs ratio)
          RATE (kHz)       128        192      256        384         512       768       1024        1536
          8                                                          2.048                2.048      2.048
          11.025                                                    2.8224               2.8224
          12                                                         3.072                3.072
          16                                  2.048                  2.048     2.048
          22.05                              2.8224                 2.8224
          24                                  3.072                  3.072
          32                                  2.048
          44.1                               2.8224
          48                                  3.072
          88.2
          96
          Note that, when ADC_OSR128=1, digital microphone operation is only supported for the above
          DMICCLK configurations.
       Table 10 DMICCLK Frequency (MHz) - ADC_OSR128 = 1 (Default)
            SAMPLE                             SYSCLK RATE (AIFnCLK / fs ratio)
          RATE (kHz)       128        192      256        384         512       768       1024        1536
          8                                   1.024                  1.024     1.024      1.024      1.024
          11.025                             1.4112                 1.4112    1.4112     1.4112
          12                                  1.536                  1.536     1.536      1.536
          16                                  1.024      1.024       1.024    1.024
          22.05                              1.4112     1.4112      1.4112
          24                                  1.536      1.536       1.536
          32                                  2.048      2.048
          44.1                               2.8224
          48                                  3.072
          88.2
          96
          Note that, when ADC_OSR128=0, digital microphone operation is only supported for the above
          DMICCLK configurations.
       Table 11 DMICCLK Frequency (MHz) - ADC_OSR128 = 0
                                                                                    PP, March 2014, Rev 3.5
w
                                                                                                           58


Pre-Production                                                                                               WM8958
                DIGITAL PULL-UP AND PULL-DOWN
                The WM8958 provides integrated pull-up and pull-down resistors on the DMICDAT1 and DMICDAT2
                pins. This provides a flexible capability for interfacing with other devices. Each of the pull-up and pull-
                down resistors can be configured independently using the register bits described in Table 12.
                Note that, if the DMICDAT1 or DMICDAT2 digital microphone channels are disabled, or if
                DMICDATn_PU and DMICDATn_PD are both set, then the pull-up and pull-down will be disabled on
                the respective pin.
                   REGISTER         BIT               LABEL                DEFAULT                DESCRIPTION
                   ADDRESS
                  R1824             11       DMICDAT2_PU                        0       DMICDAT2 Pull-Up enable
                  (0720h)                                                               0 = Disabled
                  Pull Control                                                          1 = Enabled
                  (1)
                                    10       DMICDAT2_PD                        0       DMICDAT2 Pull-Down enable
                                                                                        0 = Disabled
                                                                                        1 = Enabled
                                     9       DMICDAT1_PU                        0       DMICDAT1 Pull-Up enable
                                                                                        0 = Disabled
                                                                                        1 = Enabled
                                     8       DMICDAT1_PD                        0       DMICDAT1 Pull-Down enable
                                                                                        0 = Disabled
                                                                                        1 = Enabled
                Table 12 Digital Pull-Up and Pull-Down Control
ANALOGUE TO DIGITAL CONVERTER (ADC)
                The WM8958 uses stereo 24-bit sigma-delta ADCs. The use of multi-bit feedback and high
                oversampling rates reduces the effects of jitter and high frequency noise. The oversample rate can be
                adjusted, if required, to reduce power consumption - see “Clocking and Sample Rates” for details. The
                ADC full scale input level is proportional to AVDD1 - see “Electrical Characteristics”. Any input signal
                greater than full scale may overload the ADC and cause distortion.
                The ADCs are enabled by the ADCL_ENA and ADCR_ENA register bits.
                      REGISTER             BIT      LABEL           DEFAULT                   DESCRIPTION
                      ADDRESS
                  R4 (0004h)                1     ADCL_ENA              0         Left ADC Enable
                  Power                                                           0 = Disabled
                  Management (4)                                                  1 = Enabled
                                            0     ADCR_ENA              0         Right ADC Enable
                                                                                  0 = Disabled
                                                                                  1 = Enabled
                Table 13 ADC Enable Control
                The outputs of the ADCs can be routed to the Left/Right channels of AIF1 (Timeslot 0).
                Digital volume control of the ADC outputs in the AIF1 signal paths is provided using the registers
                described in the “Digital Volume and Filter Control” section.
                The outputs of the ADCs can be routed, in a limited number of configurations, to the digital mixing
                output bus, via the digital sidetone signal paths. See “Digital Mixing” for further details.
                Digital volume control of the ADC outputs in the digital sidetone signal paths is provided using the
                registers described in the “Digital Mixing” section.
                                                                                                 PP, March 2014, Rev 3.5
w
                                                                                                                       59


WM8958                                                                                  Pre-Production
       ADC CLOCKING CONTROL
       Clocking for the ADCs is derived from SYSCLK. The required clock is enabled when the
       SYSDSPCLK_ENA register is set.
       The ADC clock rate is configured automatically, according to the AIFn_SR, AIFnCLK_RATE and
       ADC_OSR128 registers. (See “Clocking and Sample Rates” for further details of the system clocks
       and control registers.)
       When AIF1CLK is selected as the SYSCLK source (SYSCLK_SRC = 0), then the ADC clocking is
       controlled by the AIF1_SR and AIF1CLK_RATE registers.
       When AIF2CLK is selected as the SYSCLK source (SYSCLK_SRC = 1), then the ADC clocking is
       controlled by the AIF2_SR and AIF2CLK_RATE registers.
       The supported ADC clocking configurations are described in Table 14 (for ADC_OSR128=1) and
       Table 15 (for ADC_OSR128=0). The ADC_OSR128 bit is set by default, giving best audio
       performance.
           SAMPLE                              SYSCLK RATE (AIFnCLK / fs ratio)
         RATE (kHz)        128       192       256      384        512    768       1024       1536
         8                                                                                    
         11.025                                                                      
         12                                                                          
         16                                                             
         22.05                                                    
         24                                                       
         32                                             
         44.1                                   
         48                                     
         88.2
         96
         When ADC_OSR128=1, ADC operation is only supported for the configurations indicated above
       Table 14 ADC Clocking - ADC_OSR128 = 1 (Default)
           SAMPLE                              SYSCLK RATE (AIFnCLK / fs ratio)
         RATE (kHz)        128       192       256      384        512    768       1024       1536
         8                                                                                 
         11.025                                                                   
         12                                                                       
         16                                                             
         22.05                                                    
         24                                                       
         32                                             
         44.1                                   
         48                                     
         88.2
         96
         When ADC_OSR128=0, ADC operation is only supported for the configurations indicated above
       Table 15 ADC Clocking - ADC_OSR128 = 0
       The clocking requirements in Table 14 and Table 15 are only applicable to the AIFnCLK that is
       selected as the SYSCLK source. Note that both clocks (AIF1CLK and AIF2CLK) must satisfy the
       requirements noted in the “Clocking and Sample Rates” section.
       The applicable clocks (SYSCLK, and AIF1CLK or AIF2CLK) must be present and enabled when using
       the Analogue to Digital Converters (ADCs).
                                                                              PP, March 2014, Rev 3.5
w
                                                                                                    60


Pre-Production                                                                                              WM8958
DIGITAL CORE ARCHITECTURE
                The WM8958 Digital Core provides an extensive set of mixing and signal processing features. The
                Digital Core Architecture is illustrated in Figure 18, which also identifies the datasheet sections
                applicable to each portion of the Digital Core.
                Audio Interface 1 (AIF1) supports audio input and output on two stereo timeslots simultaneously,
                making a total of four inputs and four outputs. The mixing of the four AIF1 output paths is described in
                “Audio Interface 1 (AIF1) Output Mixing”.
                A digital mixing path from the ADCs or Digital Microphones to the DAC output paths provides a high
                quality sidetone for voice calls or other applications. The sidetone configuration is described in “Digital
                Sidetone Mixing”; the associated filter and volume control is described in “Digital Sidetone Volume
                and Filter Control”.
                Each of the four hi-fi DACs has a dedicated mixer for controlling the signal paths to that DAC. The
                configuration of these signal paths is described in “DAC Output Digital Mixing”.
                Each DAC is provided with digital volume control, soft mute / un-mute and a low pass filter. The
                associated controls are defined in the “Digital to Analogue Converter (DAC)” section.
                Digital processing can be applied to the four input channels of AIF1 and the two input channels of
                AIF2. The available features include multiband compression (MBC), 5-band equalization (EQ), 3D
                stereo expansion and dynamic range control (DRC).
                The MBC provides a function to maximise the loudness of the audio signal, using independent
                compression and boost of different frequency bands without overdriving the loudspeakers. The RMS
                Limiter within the MBC function enables the maximum signal level to be matched to the application
                requirements and/or power rating of the loudspeaker. The MBC controls are described in “Multiband
                Compressor”. The EQ provides the capability to tailor the audio path according to the frequency
                characteristics of an earpiece or loudspeaker, and/or according to user preferences. The EQ controls
                                            TM
                are described in “ReTune Mobile Parametric Equalizer (EQ)”.
                The DRC provides adaptive signal level control to improve the handling of unpredictable signal levels
                and to improve intelligibility in the presence of transients and impulsive noises. The DRC controls are
                described in “Dynamic Range Control (DRC)”. 3D stereo expansion provides a stereo enhancement
                effect; the depth of the effect is programmable, as described in “3D Stereo Expansion”.
                The input channels of AIF1 and AIF2 are also equipped with digital volume control and soft mute / un-
                mute control; see “Digital Volume and Filter Control” for details of these features.
                The output channels of AIF1 and AIF2 can be configured using the digital volume control and a
                programmable high-pass filter (HPF). The Dynamic Range Control (DRC) circuit can also be applied
                here, with the restriction that a DRC cannot be enabled in the input and output path of one AIF
                channel at the same time. The AIF output volume and filter controls are described in “Digital Volume
                and Filter Control”.
                The WM8958 provides an ultrasonic mode on the output paths of AIF1, allowing high frequency
                signals (such as ultrasonic microphone signals) to be output. See “Ultrasonic (4FS) AIF Output Mode”
                for further details.
                The WM8958 provides two full audio interfaces, AIF1 and AIF2. Each interface supports a number of
                                       2
                protocols, including I S, DSP, MSB-first left/right justified, and can operate in master or slave modes.
                PCM operation is supported in the DSP mode. A-law and -law companding are also supported. Time
                division multiplexing (TDM) is available to allow multiple devices to stream data simultaneously on the
                same bus, saving space and power.
                Four-channel input and output is supported using TDM on AIF1. Two-channel input and output is
                supported on AIF2. A third interface, AIF3, is partially supported, using multiplexers to re-configure
                alternate connections to AIF1 or AIF2.
                Signal mixing between audio interfaces is possible. The WM8958 performs stereo full-duplex sample
                rate conversion between the audio interfaces as required. (Note that sample rate conversion is not
                supported on some signal paths, as noted in Figure 18.)
                The audio interfaces AIF1, AIF2 and AIF3 are referenced to DBVDD1, DBVDD2 and DBVDD3
                respectively; this provides additional capability to interface between different sub-systems within an
                application.
                                                                                                PP, March 2014, Rev 3.5
w
                                                                                                                       61


WM8958                                                                                                                                                                                                                                                                                                                                              Pre-Production
                                                              Digital Sidetone                               Digital Sidetone Volume
                                                              Mixing                                         and Filter Control
                                                                                                                                                                                                                                                                                                                          DAC Output
                                                                                                                                                                                                                                                                                                                          Digital Mixing
                                                                                                                                                                                      Gain Codes
                                                                                                                                                                                      V = Full volume control
                                                                                                                                                                                         (-71.625dB to 12dB, 0.375dB steps for DAC
                                                                                                                                                                 [Code]                   -71.625dB to 17.625dB, 0.375dB steps for ADC/MICs)
                                                                                                                                                                                      S = Softmute/un-mute
                                                   DMICDAT2                                                                                                                           NG = Digital Noise Gate
                                                                                                                                                                                      G = Fixed gain control
                                                                                                                                                                                         (-36dB to 0dB, 3dB steps)
                                                                                                                                                                                                                                                                                                                          DAC Digital
                                                                                                                                                                                                                                                                                                                          Volume
                                             DMICDAT1
                                                                                                                                                                                                                                          DAC1L
                                                                                                                                                                                                                                           Vol
                                                                                                                                                                                                                                                                                             DAC
                                                                                                                                                                                               +                                                                                             1L
                                                                                                                                                                                                                                          VS
                                                                                                                                                 G G
                                                                                                                                                                                                                                          DAC1R
                                                                                                                                                                                                                                           Vol
                                                                                                                                                                                                                                                                                             DAC
                                                                                                                                                                                               +                                                                                             1R
                                                                                                                                                                                                                                          VS
                                                                                                                                                 G G
                                                                                                                                                                                                                                          DAC2L
                                                                                                                                                                                                                                           Vol
                                                   ADC                                                                                                                                                                                                                                       DAC
                                                     L                                                                                                                                         +                                                                                             2L
                                                                                                                                                                                                                                          VS
                                                                                                                                                 G G
                                                                                                                                                                                                                                          DAC2R
                                                                                                                                                                                                                                           Vol
                                                   ADC                                                                                                                                                                                                                                       DAC
                                                     R                                                                                                                                         +                                                                                             2R
                                                                                                                                                                                                                                          VS
                                                                                                                                                 G G
Audio Interface 1
(AIF1) Output Mixing
                                                                        +       +        +         +
                                                                                                                                                                                                                                                                                                                            Multiband Compressor (MBC) /
 Sample Rate                                                                                                                                                                                                                                                                                                                Dynamic Range Control (DRC) /
 Conversion                                                                                                                                                                                                                                                                                                                 Retune Mobile Parameter Equalizer (EQ) /
                                                                                                                                                                                                                                                                                                                            Stereo 3D Expansion /
   = SRC not supported                                                                                                                                                                                                                                                                                                      Digital Volume and Filter Control
                                                                                                                        MBC                        MBC                               MBC
                       DRC / Microphone signal                                                                          DRC                        DRC                               DRC                                                                                                                                   Note the Multi-band Compressor (MBC)
                        activity detector (GPIO)
                                                                                                                                                                                                                                                                                                                           cannot be enabled on AIF1 and AIF2
                                                                                                                          EQ                        EQ                                 EQ                                                                                                                                  simultaneously.
                                                                         DRC                 DRC                                                                                                                      DRC
                                                                                                                            3D                         3D                              3D
                                                                                                            VS, NG                                                        VS, NG
                                                                   V                                                                                                                                    V
                                                                                                                                                                                                                                                                                                                           Note the Dynamic Range Control (DRC) cannot
                                                                                                                                                                                                                                                                                                                           be enabled in the input and output paths of any
                                                                                                                                                                                                                                                                                                                           Digital Audio Interface simultaneously.
                                                                       AIF1 Slot 0                                   AIF1 Slot 0
 Ultrasonic (4FS)
                                                                                       AIF1 Slot 1                                               AIF1 Slot 1
 AIF Output Modes
                                                                fs / 4fs Select
 Digital Audio                                                               Left / Right source select / Mono Mix control
                                                                                                                                                                                     Left / Right source select /
 Interface Control                                                                                                                                                                        Mono Mix control
                                                                        0R      0L       1R        1L                  0R            0L           1R        1L                       0R      0L                     0R             0L
                                                                                   DIGITAL AUDIO                                                                                 DIGITAL AUDIO                                                    MONO PCM
                                                                                 INTERFACE 1 (AIF1)                                                                            INTERFACE 2 (AIF2)                                                 INTERFACE
                                                                                                                                                                                                                                                                                        BCLK2
                                                                                                                                                                                                                                                                                        BCLK1
                                                                                                                                                                                                                                                                                       LRCLK2
                                                                                                                                                                                                                                                                                       LRCLK1
                                                                                                                                                                                                    DACDAT2                     ADCDAT2
                                                                                     BCLK1
                                                                                                                                                                                                                                                                                       GPIO10/LRCLK3   GPIO11/BCLK3
                                                                                                                                                                                   BCLK2   LRCLK2
                                                                                                                                                                                                              GPIO6/ADCLRCLK2
                                                                                                                                                                                                                                                       GPIO9/ADCDAT3   GPIO8/DACDAT3
                                                                                                        DACDAT1      ADCDAT1
                                                                                              LRCLK1
                                                                                                                               GPIO1/ADCLRCLK1
                                                                                                                                                                                                                                                                                                                      Note -
                                                                                                                                                                                                                                                                                                                      AIF1 is referenced to the DBVDD1 power domain
                                                                                                                                                                                                                                                                                                                      AIF2 is referenced to DBVDD2
                                                                                                                                                                                                                                                                                                                      AIF3 / Mono PCM is referenced to DBVDD3
Figure 18 Digital Core Architecture
                                                                                                                                                                                                                                                                                                                               PP, March 2014, Rev 3.5
w
                                                                                                                                                                                                                                                                                                                                                                             62


Pre-Production                                                                                             WM8958
DIGITAL MIXING
               This section describes the digital mixing functions of the WM8958.
               Digital audio mixing is provided on four AIF1 output paths, two digital sidetone paths, and four Digital
               to Analogue converters (DACs).
               Note that the two AIF2 output paths are connected to the DAC2L and DAC2R signal paths.
               The digital mixing functions and associated control registers are illustrated in Figure 19.
               Figure 19 Digital Mixing Block Diagram
                                                                                               PP, March 2014, Rev 3.5
w
                                                                                                                    63


WM8958                                                                                       Pre-Production
       AUDIO INTERFACE 1 (AIF1) OUTPUT MIXING
       There are four AIF1 digital mixers, one for each AIF1 audio channel (ie. Left/Right channels on
       Timeslots 0/1). The inputs to each AIF1 mixer comprise signals from the ADC / Digital Microphone
       inputs and from AIF2.
       Note that the Left/Right channels of AIF1 can be inverted or interchanged if required; see “Digital
       Audio Interface Control”.
       The AIF1 Left Timeslot 0 output channel is derived from the ADCL / DMIC1 (Left) and AIF2 (Left)
       inputs. The ADCL / DMIC1 (Left) path is enabled by ADC1L_TO_AIF1ADC1L, whilst the AIF2 (Left)
       path is enabled by AIF2DACL_TO_AIF1ADC1L.
       The AIF1 Right Timeslot 0 output channel is derived from the ADCR / DMIC1 (Right) and AIF2 (Right)
       inputs. The ADCR / DMIC1 (Right) path is enabled by ADC1R_TO_AIF1ADC1R, whilst the AIF2
       (Right) path is enabled by AIF2DACR_TO_AIF1ADC1R.
       The AIF1 Left Timeslot 1 output channel is derived from the DMIC2 (Left) and AIF2 (Left) inputs. The
       DMIC2 (Left) path is enabled by ADC2L_TO_AIF1ADC2L, whilst the AIF2 (Left) path is enabled by
       AIF2DACL_TO_AIF1ADC2L.
       The AIF1 Right Timeslot 1 output channel is derived from the DMIC2 (Right) and AIF2 (Right) inputs.
       The DMIC2 (Right) path is enabled by ADC2R_TO_AIF1ADC2R, whilst the AIF2 (Right) path is
       enabled by AIF2DACR_TO_AIF1ADC2R.
       The AIF1 output mixer controls are defined in Table 16.
           REGISTER          BIT         LABEL           DEFAULT                DESCRIPTION
           ADDRESS
         R1542 (0606h)        1      ADC1L_TO_AIF            0       Enable ADCL / DMIC1 (Left) to
         AIF1 ADC1                   1ADC1L                          AIF1 (Timeslot 0, Left) output
         Left Mixer                                                  0 = Disabled
         Routing                                                     1 = Enabled
                              0      AIF2DACL_TO_            0       Enable AIF2 (Left) to AIF1 (Timeslot
                                     AIF1ADC1L                       0, Left) output
                                                                     0 = Disabled
                                                                     1 = Enabled
         R1543 (0607h)        1      ADC1R_TO_AIF            0       Enable ADCR / DMIC1 (Right) to
         AIF1 ADC1                   1ADC1R                          AIF1 (Timeslot 0, Right) output
         Right Mixer                                                 0 = Disabled
         Routing                                                     1 = Enabled
                              0      AIF2DACR_TO_            0       Enable AIF2 (Right) to AIF1
                                     AIF1ADC1R                       (Timeslot 0, Right) output
                                                                     0 = Disabled
                                                                     1 = Enabled
         R1544 (0608h)        1      ADC2L_TO_AIF            0       Enable DMIC2 (Left) to AIF1
         AIF1 ADC2                   1ADC2L                          (Timeslot 1, Left) output
         Left Mixer                                                  0 = Disabled
         Routing                                                     1 = Enabled
                              0      AIF2DACL_TO_            0       Enable AIF2 (Left) to AIF1 (Timeslot
                                     AIF1ADC2L                       1, Left) output
                                                                     0 = Disabled
                                                                     1 = Enabled
         R1545 (0609h)        1      ADC2R_TO_AIF            0       Enable DMIC2 (Right) to AIF1
         AIF1 ADC2                   1ADC2R                          (Timeslot 1, Right) output
         Right Mixer                                                 0 = Disabled
         Routing                                                     1 = Enabled
                              0      AIF2DACR_TO_            0       Enable AIF2 (Right) to AIF1
                                     AIF1ADC2R                       (Timeslot 1, Right) output
                                                                     0 = Disabled
                                                                     1 = Enabled
       Table 16 AIF1 Output Mixing
                                                                                  PP, March 2014, Rev 3.5
w
                                                                                                         64


Pre-Production                                                                                               WM8958
               DIGITAL SIDETONE MIXING
               There are two digital sidetone signal paths, STL and STR. The sidetone sources are selectable for
               each path. The sidetone mixer outputs are inputs to the DAC signal mixers.
               The following sources can be selected for sidetone path STL.
                     ADCL or DMICDAT1 (Left) channel
                     DMICDAT2 (Left) channel
               The following sources can be selected for sidetone path STR.
                     ADCR or DMICDAT1 (Right) channel
                     DMICDAT2 (Right) channel
               The sidetone signal sources are selected using STR_SEL and STL_SEL as described in Table 17.
               Note that, when STR_SEL = 0 or STL_SEL = 0, and the respective ADC is enabled (for analogue
               inputs), then the ADC data will be selected for applicable sidetone path.
                    REGISTER            BIT           LABEL             DEFAULT               DESCRIPTION
                    ADDRESS
                  R1569 (0621h)           1      STR_SEL                    0       Select source for sidetone STR path
                  Sidetone                                                          0 = ADCR / DMICDAT1 (Right)
                                                                                    1 = DMICDAT2 (Right)
                                          0      STL_SEL                    0       Select source for sidetone STL path
                                                                                    0 = ADCL / DMICDAT1 (Left)
                                                                                    1 = DMICDAT2 (Left)
               Table 17 Digital Sidetone Mixing
               DIGITAL SIDETONE VOLUME AND FILTER CONTROL
               A digital volume control is provided for the digital sidetone paths. The associated register controls are
               described in Table 18.
               A digital high-pass filter can be enabled in the sidetone paths to remove DC offsets. This filter is
               enabled using the ST_HPF register bit; the cut-off frequency is configured using ST_HPF_CUT. When
               the filter is enabled, it is enabled in both digital sidetone paths.
               Note that the sidetone filter cut-off frequency scales according to the sample rate of AIF1 or AIF2.
               When AIF1CLK is selected as the SYSCLK source (SYSCLK_SRC = 0), then the ST_HPF cut-off
               frequency is scaled according to the AIF1_SR register. When AIF2CLK is selected as the SYSCLK
               source (SYSCLK_SRC = 1), then the ST_HPF cut-off frequency is scaled according to the AIF2_SR
               register. See “Clocking and Sample Rates” for further details of the system clocks and control
               registers.
                    REGISTER            BIT           LABEL             DEFAULT               DESCRIPTION
                    ADDRESS
                  R1536 (0600h)         8:5      ADCR_DAC1_V              0000      Sidetone STR to DAC1L and
                  DAC1 Mixer                     OL [3:0]                           DAC1R Volume
                  Volumes                                                           0000 = -36dB
                                                                                    0001 = -33dB
                                                                                    …. (3dB steps)
                                                                                    1011 = -3dB
                                                                                    1100 = 0dB
                                                                                    (see Table 19 for gain range)
                                                                                                PP, March 2014, Rev 3.5
w
                                                                                                                      65


WM8958                                                                          Pre-Production
          REGISTER         BIT          LABEL   DEFAULT             DESCRIPTION
          ADDRESS
                           3:0    ADCL_DAC1_V     0000  Sidetone STL to DAC1L and
                                  OL [3:0]              DAC1R Volume
                                                        0000 = -36dB
                                                        0001 = -33dB
                                                        …. (3dB steps)
                                                        1011 = -3dB
                                                        1100 = 0dB
                                                        (see Table 19 for gain range)
        R1539 (0603h)      8:5    ADCR_DAC2_V     0000  Sidetone STR to DAC2L and
        DAC2 Mixer                OL [3:0]              DAC2R Volume
        Volumes                                         0000 = -36dB
                                                        0001 = -33dB
                                                        …. (3dB steps)
                                                        1011 = -3dB
                                                        1100 = 0dB
                                                        (see Table 19 for gain range)
                           3:0    ADCL_DAC2_V     0000  Sidetone STL to DAC2L and
                                  OL [3:0]              DAC2R Volume
                                                        0000 = -36dB
                                                        0001 = -33dB
                                                        …. (3dB steps)
                                                        1011 = -3dB
                                                        1100 = 0dB
                                                        (see Table 19 for gain range)
        R1569 (0621h)      9:7    ST_HPF_CUT       000  Sidetone HPF cut-off frequency
        Sidetone                  [2:0]                 (relative to 44.1kHz sample rate)
                                                        000 = 2.7kHz
                                                        001 = 1.35kHz
                                                        010 = 675Hz
                                                        011 = 370Hz
                                                        100 = 180Hz
                                                        101 = 90Hz
                                                        110 = 45Hz
                                                        111 = Reserved
                                                        Note - the cut-off frequencies scale
                                                        with the Digital Mixing (SYSCLK)
                                                        clocking rate. The quoted figures
                                                        apply to 44.1kHz sample rate.
                            6     ST_HPF            0   Digital Sidetone HPF Select
                                                        0 = Disabled
                                                        1 = Enabled
       Table 18 Digital Sidetone Volume Control
                                                                      PP, March 2014, Rev 3.5
w
                                                                                            66


Pre-Production                                                                                       WM8958
                   ADCR_DAC1_VOL,
                   ADCL_DAC2_VOL,
                  ADCR_DAC1_VOL or              SIDETONE
                    ADCL_DAC2_VOL               GAIN (dB)
                           0000                     -36
                           0001                     -33
                           0010                     -30
                           0011                     -27
                           0100                     -24
                           0101                     -21
                           0110                     -18
                           0111                     -15
                           1000                     -12
                           1001                      -9
                           1010                      -6
                           1011                      -3
                           1100                       0
                           1101                       0
                           1110                       0
                           1111                       0
               Table 19 Digital Sidetone Volume Range
               DAC OUTPUT DIGITAL MIXING
               There are four DAC digital mixers, one for each DAC. The inputs to each DAC mixer comprise signals
               from AIF1, AIF2 and the digital sidetone signals.
               Note that the Left/Right channels of the AIF1 and AIF2 inputs can be inverted or interchanged if
               required; see “Digital Audio Interface Control”.
                  REGISTER            BIT           LABEL        DEFAULT                DESCRIPTION
                   ADDRESS
                 R1537 (0601h)         5      ADCR_TO_DAC           0        Enable Sidetone STR to DAC1L
                 DAC1 Left                    1L                             0 = Disabled
                 Mixer Routing                                               1 = Enabled
                                       4      ADCL_TO_DAC           0        Enable Sidetone STL to DAC1L
                                              1L                             0 = Disabled
                                                                             1 = Enabled
                                       2      AIF2DACL_TO_          0        Enable AIF2 (Left) to DAC1L
                                              DAC1L                          0 = Disabled
                                                                             1 = Enabled
                                       1      AIF1DAC2L_TO          0        Enable AIF1 (Timeslot 1, Left) to
                                              _DAC1L                         DAC1L
                                                                             0 = Disabled
                                                                             1 = Enabled
                                       0      AIF1DAC1L_TO          0        Enable AIF1 (Timeslot 0, Left) to
                                              _DAC1L                         DAC1L
                                                                             0 = Disabled
                                                                             1 = Enabled
                 R1538 (0602h)         5      ADCR_TO_DAC           0        Enable Sidetone STR to DAC1R
                 DAC1 Right                   1R                             0 = Disabled
                 Mixer Routing                                               1 = Enabled
                                       4      ADCL_TO_DAC           0        Enable Sidetone STL to DAC1R
                                              1R                             0 = Disabled
                                                                             1 = Enabled
                                       2      AIF2DACR_TO_          0        Enable AIF2 (Right) to DAC1R
                                              DAC1R                          0 = Disabled
                                                                             1 = Enabled
                                                                                         PP, March 2014, Rev 3.5
w
                                                                                                               67


WM8958                                                                                      Pre-Production
          REGISTER          BIT         LABEL         DEFAULT                  DESCRIPTION
           ADDRESS
                             1      AIF1DAC2R_TO           0         Enable AIF1 (Timeslot 1, Right) to
                                    _DAC1R                           DAC1R
                                                                     0 = Disabled
                                                                     1 = Enabled
                             0      AIF1DAC1R_TO           0         Enable AIF1 (Timeslot 0, Right) to
                                    _DAC1R                           DAC1R
                                                                     0 = Disabled
                                                                     1 = Enabled
        R1540 (0604h)        5      ADCR_TO_DAC            0         Enable Sidetone STR to DAC2L
        DAC2 Left                   2L                               0 = Disabled
        Mixer Routing                                                1 = Enabled
                             4      ADCL_TO_DAC            0         Enable Sidetone STL to DAC2L
                                    2L                               0 = Disabled
                                                                     1 = Enabled
                             2      AIF2DACL_TO_           0         Enable AIF2 (Left) to DAC2L
                                    DAC2L                            0 = Disabled
                                                                     1 = Enabled
                             1      AIF1DAC2L_TO           0         Enable AIF1 (Timeslot 1, Left) to
                                    _DAC2L                           DAC2L
                                                                     0 = Disabled
                                                                     1 = Enabled
                             0      AIF1DAC1L_TO           0         Enable AIF1 (Timeslot 0, Left) to
                                    _DAC2L                           DAC2L
                                                                     0 = Disabled
                                                                     1 = Enabled
        R1541 (0605h)        5      ADCR_TO_DAC            0         Enable Sidetone STR to DAC2R
        DAC2 Right                  2R                               0 = Disabled
        Mixer Routing                                                1 = Enabled
                             4      ADCL_TO_DAC            0         Enable Sidetone STL to DAC2R
                                    2R                               0 = Disabled
                                                                     1 = Enabled
                             2      AIF2DACR_TO_           0         Enable AIF2 (Right) to DAC2R
                                    DAC2R                            0 = Disabled
                                                                     1 = Enabled
                             1      AIF1DAC2R_TO           0         Enable AIF1 (Timeslot 1, Right) to
                                    _DAC2R                           DAC2R
                                                                     0 = Disabled
                                                                     1 = Enabled
                             0      AIF1DAC1R_TO           0         Enable AIF1 (Timeslot 0, Right) to
                                    _DAC2R                           DAC2R
                                                                     0 = Disabled
                                                                     1 = Enabled
       Table 20 DAC Output Digital Mixing
       AUDIO INTERFACE 2 (AIF2) DIGITAL MIXING
       There are two output channels on AIF2. The audio source for these two channels is the same as the
       selected source for DAC2L and DAC2R, as described in “DAC Output Digital Mixing”.
       Note that the Left/Right channels of AIF2 can be inverted or interchanged if required; see “Digital
       Audio Interface Control”.
                                                                                 PP, March 2014, Rev 3.5
w
                                                                                                        68


Pre-Production                                                                                            WM8958
                 ULTRASONIC (4FS) AIF OUTPUT MODE
                 The WM8958 provides an ultrasonic mode on the output paths of the AIF1 audio interface. The
                 ultrasonic mode enables high frequency signals (such as ultrasonic microphone signals) to be output.
                 Ultrasonic mode is enabled on AIF1 using the AIF1ADC_4FS register bit. When the ultrasonic mode is
                 selected, the AIF1 output sample rate is increased by a factor of 4. For example, a 48kHz sample rate
                 will be output at 192kHz in ultrasonic mode.
                 Ultrasonic mode is only supported in AIF Master mode and uses the ADCLRCLK output (not the
                 LRCLK). When ultrasonic mode is enabled, the AIF1 must be configured in Master mode, as
                 described in “Digital Audio Interface Control”. See “General Purpose Input/Output” to configure the
                 GPIO1 pin as ADCLRCLK1. The ADCLRCLK1 rate is controlled as described in “Digital Audio
                 Interface Control”.
                 When ultrasonic mode is enabled, the audio band filtering and digital volume controls (see “Digital
                 Volume and Filter Control”) are bypassed on the affected output paths.
                 The Dynamic Range Control (DRC) function is not available on the AIF1 output signal paths in
                 ultrasonic mode. Note, however, that the DRC is still available on the AIF input paths in this case.
                 The ultrasonic (4FS) signal paths are illustrated in Figure 20. The AIF1ADC_4FS register bit is defined
                 in Table 21.
                                                  VS, NG
                                    V
                 Figure 20 Ultrasonic (4FS) Signal Paths
                    REGISTER            BIT                LABEL   DEFAULT                 DESCRIPTION
                    ADDRESS
                  R1040 (0410h)         15     AIF1ADC_4FS             0        Enable AIF1ADC ultrasonic mode
                  AIF1 ADC1                                                     (4FS) output, bypassing all AIF1
                  Filters                                                       baseband output filtering
                                                                                0 = Disabled
                                                                                1 = Enabled
                 Table 21 Ultrasonic (4FS) Mode Control
                                                                                               PP, March 2014, Rev 3.5
w
                                                                                                                     69


WM8958                                                                                                  Pre-Production
MULTIBAND COMPRESSOR (MBC)
               The Multiband Compressor (MBC) is a DSP function which can be enabled in the digital playback path
               of the WM8958 audio interfaces. The normal function of the MBC is to maximise the loudness of the
               audio signal.
               The MBC uses selective processing of the received digital audio signal to control the loudness;
               independent gain control algorithms are applied to different audio frequency bands. The effect of this
               is to increase the perceived loudness of the audio path, producing an enhanced audio signal without
               overdriving the output transducers (eg. loudspeakers).
               The MBC provides two internal signal paths, allowing low frequencies and high frequencies to be
               processed separately. Each signal path incorporates a programmable compressor which can be used
               to dynamically control the level of each frequency band.
               The most significant advantage of multiband compression is that a signal peak in one frequency band
               will not cause gain reduction in the other frequency band. Similarly, gain can be applied to one
               frequency band without boosting (and potentially distorting) the other. This provides a powerful
               capability to maximise the loudness of the signal path.
               The two signal paths are re-combined at the output of the MBC. If necessary, any difference in tonal
               balance between the frequency bands can be restored by changing the levels of the two signal paths
               relative to each other.
               The MBC incorporates a high-pass and a low-pass filter, which set the lower and upper frequency
               limits of the MBC signal path. The crossover frequency that divides the two frequency bands can be
               adjusted according to the system requirements. The attack and decay times of the compressors are
               separately programmable on each frequency band.
               An RMS Limiter is included within the MBC function. This is a signal limiter that responds to the RMS
               output level of the digital playback path, allowing the maximum signal level to be matched to the
               application requirements and/or the power rating of the loudspeaker.
               The WM8958 provides one stereo Multiband Compressor (MBC). The MBC can be enabled on the
               input path of AIF1 timeslot 0, AIF1 timeslot 1 or on the input path of AIF2. Note that the MBC cannot
               be enabled on more than one of these paths simultaneously.
               A Dynamic Range Control (DRC) function is also available on the digital playback paths. Note that the
               DRC and MBC functions should not be enabled simultaneously on the same playback path. The DRC
               is enabled using the registers described in Table 27.
               The MBC signal paths and control parameters are illustrated in Figure 21.
               Figure 21 Multiband Compressor
                                                                                             PP, March 2014, Rev 3.5
w
                                                                                                                   70


Pre-Production                                                                                                         WM8958
                           The MBC filter cut-off frequencies are shown in Table 22.
                                       PARAMETER                         MIN                 DEFAULT                  MAX
                              Low Cut-Off Frequency                     20Hz                   350Hz                  1kHz
                              Crossover Frequency                      500Hz                   2.5kHz               7.9kHz
                              High Cut-Off Frequency                   11kHz                   12kHz                 16kHz
                           Table 22 Multiband Compressor Cut-Off Frequencies
                           RMS LIMITER
                           An RMS Limiter is included within the MBC function. This is a signal limiter that responds to the RMS
                           output level of the digital playback path, allowing the maximum signal level to be matched to the
                           application requirements and/or the power rating of the loudspeaker.
                           The Wolfson WISCE™ software must be used to derive the register settings for the RMS Limiter. The
                           WISCE™ software allows users to select the desired RMS voltage level of the analogue output.
                           Note that the selected RMS voltage level applies to each output pin. For differential (BTL) outputs,
                           note that a limit of 1.0Vrms on each pin equates to 2.0Vrms across the load.
                           The MBC operates within the digital core of the WM8958, and the playback signal may be subject to
                           boost or attenuation in the digital and/or analogue stages of the output signal path. Therefore, the
                           RMS Limiter configuration must take account of the applicable gain settings of the output signal path.
                           The WISCE™ software allows the user to input the amount of gain (dB) applicable to the relevant
                           output signal path. (This is the total signal gain of the applicable DACs, output/boost mixers and PGA
                           volume controls.) Note that the register settings for the RMS Limiter will only be valid for the specified
                           gain level.
                           MBC CLOCKING CONTROL
                           Clocking for the MBC is derived from DSP2CLK. This clock is derived from the output of the
                           AIF1CLK_SRC or AIF2CLK_SRC multiplexers, according to the SYSCLK_SRC register. This is
                           illustrated in Figure 22, and described further in the “Clocking and Sample Rates” section.
Figure 22 Audio Interface Clock Control
                           The MBC can enabled on the AIF1 or AIF2 input paths, regardless of the SYSCLK_SRC setting,
                           provided that the minimum clocking requirement for the MBC is satisfied.
                                                                                                          PP, March 2014, Rev 3.5
w
                                                                                                                                  71


WM8958                                                                                         Pre-Production
       To support the MBC function, it is required that DSP2CLK ≥ 256 x fs (where fs is the sample rate of
       the AIF on which the MBC is enabled). When the MBC is enabled on either of the AIF1 input paths, it
       is required that DSP2CLK ≥ 256 x AIF1_SR; when the MBC is enabled on the AIF2 input path, it is
       required that DSP2CLK ≥ 256 x AIF2_SR.
       The MBC is supported in 44.1kHz and 48kHz AIF sample rate modes only; note that these modes
       require clocking rates of AIFnCLK = 256 x fs. (See “Digital to Analogue Converter (DAC)” for details of
       the valid clocking rates.)
       The DSP2CLK clock for the MBC is enabled when the DSP2CLK_ENA register is set. The DSP2CLK
       clock is required for running the MBC function, and also for accessing any of the MBC configuration
       registers. Note that the applicable source clock must also be present when using DSP2CLK.
       See “Clocking and Sample Rates” for details of the WM8958 clocking control registers.
       MBC CONTROL SEQUENCES
       Specific control sequences must be followed when enabling or configuring the MBC function; these
       sequences are described in Table 23 to Table 25. The associated MBC control registers are
       described in Table 26.
       Note that the WM8958 is provided with a working set of default MBC configuration parameters,
       allowing the MBC feature to be enabled easily in a default operating mode. For user-specific
       configuration of the MBC, the Wolfson WISCE™ software must be used to derive the configuration
                                     TM
       parameters (refer to WISCE for further information).
       The control sequence for enabling the MBC is described in Table 23. It is recommended that the
       applicable DAC playback path is muted during this sequence, as described below.
       For user-specific configuration of the MBC, the configuration parameters should be written in Step 7 of
       the control sequence. For default MBC operation, Step 7 can be omitted.
          STEP                    DESCRIPTION                                       NOTES
            1       Mute the applicable DAC output(s)           The DAC Volume and Mute controls are
                                                                described in Table 57.
            2       Set DSP2CLK_ENA = 1
            3       Set DSP2_ENA = 1
            4       Set Register R2568 (0A08h) = 007Bh
            5       Set Register R2569 (0A09h) = 0007h
            6       Set Register R2570 (0A0Ah) = 0073h
            7       Set the configuration parameters            Refer to WISCE™ for register settings.
                                                                Omit this step for default MBC configuration.
            8       Write DSP2_RUNR = 1
            9       Set MBC_SEL as required                     For AIF1DAC1 path, set MBC_SEL = 00.
                                                                For AIF1DAC2 path, set MBC_SEL = 01.
                                                                For AIF2DAC path, set MBC_SEL = 10.
                    Set MBC_ENA = 1
           10       Un-mute the applicable DAC output(s)
       Table 23 MBC Enable Sequence
       The control sequence for disabling the MBC is described in Table 24. It is recommended that the
       applicable DAC playback path is muted during this sequence, as described below.
          STEP                    DESCRIPTION                                       NOTES
            1       Mute the applicable DAC output(s)           The DAC Volume and Mute controls are
                                                                described in Table 57.
            2       Set MBC_ENA = 0
            3       Un-mute the applicable DAC output(s)
            4       Set DSP2_ENA = 0
            5       Set DSP2CLK_ENA = 0
       Table 24 MBC Disable Sequence
                                                                                      PP, March 2014, Rev 3.5
w
                                                                                                            72


Pre-Production                                                                                               WM8958
               The control sequence for updating the MBC configuration parameters is described in Table 25. It is
               recommended that the applicable DAC playback paths are muted during this sequence, as described
               below.
               The same sequence is required when reading the MBC configuration parameters; note that readback
               of these registers is not possible when the MBC function is active.
                  STEP                   DESCRIPTION                                       NOTES
                    1      Mute the applicable DAC output(s)            The DAC Volume and Mute controls are
                                                                        described in Table 57. (If changing the MBC
                                                                        from one signal path to another, then both
                                                                        DAC paths should be muted.)
                    2      Set MBC_ENA = 0
                    3      Write DSP2_STOP = 1
                    4      Readback the MBC configuration               Refer to WISCE™ for register settings.
                           parameters
                    5      Set Register R2568 (0A08h) = 007Bh           Refer to WISCE™ for register settings.
                           Set Register R2569 (0A09h) = 0007h           Note that these actions are only required for
                           Set Register R2570 (0A0Ah) = 0073h           user-specific MBC configuration.
                           Set the configuration parameters
                    6      Write DSP2_RUNR = 1
                    7      Set MBC_SEL                                  For AIF1DAC1 path, set MBC_SEL = 00.
                                                                        For AIF1DAC2 path, set MBC_SEL = 01.
                                                                        For AIF2DAC path, set MBC_SEL = 10.
                           Set MBC_ENA = 1
                    8      Un-mute the applicable DAC output(s)
               Table 25 MBC Update / Readback Sequence
               The MBC control registers are described in Table 26.
                   REGISTER           BIT          LABEL         DEFAULT                  DESCRIPTION
                   ADDRESS
                 R2304 (0900h)         0       DSP2_ENA               0        DSP2 Audio Processor Enable.
                 DSP2_Progra                                                   0 = Disabled
                 m                                                             1 = Enabled
                                                                               This bit must be set before the MBC
                                                                               is enabled. It must remain set
                                                                               whenever the MBC is enabled.
                 R2305 (0901h)        5:4      MBC_SEL [1:0]         00        MBC Signal Path select
                 DSP2_Config                                                   00 = AIF1DAC1 input path (AIF1,
                                                                               Timeslot 0)
                                                                               01 = AIF1DAC2 input path (AIF1,
                                                                               Timeslot 1)
                                                                               10 = AIF2DAC input path
                                                                               11 = Reserved
                                       0       MBC_ENA                0        MBC Enable
                                                                               0 = Disabled
                                                                               1 = Enabled
                 R2573                 2       DSP2_STOP              0        Stop the DSP2 audio processor
                 (0A0Dh)                                                       Writing a 1 to this bit will cause the
                 DSP2_ExecCo                                                   DSP2 processor to stop processing
                 ntrol                                                         audio data
                                       1       DSP2_RUNR              0        Start the DSP2 audio processor
                                                                               Writing a 1 to this bit will cause the
                                                                               DSP2 processor to start processing
                                                                               audio data
               Table 26 Multiband Compressor (MBC) Control
                                                                                              PP, March 2014, Rev 3.5
w
                                                                                                                      73


WM8958                                                                                                  Pre-Production
DYNAMIC RANGE CONTROL (DRC)
               The Dynamic Range Control (DRC) is a circuit which can be enabled in the digital playback or digital
               record paths of the WM8958 audio interfaces. The function of the DRC is to adjust the signal gain in
               conditions where the input amplitude is unknown or varies over a wide range, e.g. when recording
               from microphones built into a handheld system.
               The DRC can apply Compression and Automatic Level Control to the signal path. It incorporates ‘anti-
               clip’ and ‘quick release’ features for handling transients in order to improve intelligibility in the
               presence of loud impulsive noises.
               The DRC also incorporates a Noise Gate function, which provides additional attenuation of very low-
               level input signals. This means that the signal path is quiet when no signal is present, giving an
               improvement in background noise level under these conditions.
               The WM8958 provides three stereo Dynamic Range Controllers (DRCs); these are associated with
               AIF1 timeslot 0, AIF1 timeslot 1 and AIF2 respectively. Each DRC can be enabled either in the DAC
               playback (AIF input) path or in the ADC record (AIF output) path, as described in the “Digital Core
               Architecture” section.
               The DRCs are enabled in the DAC or ADCs audio signal paths using the register bits described in
               Table 27. Note that enabling any DRC in the DAC and ADC paths simultaneously is an invalid
               selection.
               A Multiband Compressor (MBC) function is also available on the digital playback paths. Note that the
               DRC and MBC functions should not be enabled simultaneously on the same playback path. The MBC
               control registers are described in Table 26.
               When the DRC is enabled in any of the ADC (digital record) paths, the associated High Pass Filter
               (HPF) must be enabled also; this ensures that DC offsets are removed prior to the DRC processing.
               The output path HPF control registers are described in Table 41 (for AIF1 output paths) and Table 49
               (for AIF2 output paths). These are described in the “Digital Volume and Filter Control” section.
               Note that, when ultrasonic (4FS) mode is selected on AIF1, then the DRC function is bypassed on the
               respective ADC (output) signal paths. The DRC may still be selected on the AIF1 DAC (input) signal
               paths.
                   REGISTER           BIT          LABEL          DEFAULT                  DESCRIPTION
                   ADDRESS
                 R1088 (0440h)         2      AIF1DAC1_DRC             0        Enable DRC in AIF1DAC1 playback
                 AIF1 DRC1 (1)                _ENA                              path (AIF1, Timeslot 0)
                                                                                0 = Disabled
                                                                                1 = Enabled
                                       1      AIF1ADC1L_DR             0        Enable DRC in AIF1ADC1 (Left)
                                              C_ENA                             record path (AIF1, Timeslot 0)
                                                                                0 = Disabled
                                                                                1 = Enabled
                                       0      AIF1ADC1R_DR             0        Enable DRC in AIF1ADC1 (Right)
                                              C_ENA                             record path (AIF1, Timeslot 0)
                                                                                0 = Disabled
                                                                                1 = Enabled
                 R1104 (0450h)         2      AIF1DAC2_DRC             0        Enable DRC in AIF1DAC2 playback
                 AIF1 DRC2 (1)                _ENA                              path (AIF1, Timeslot 1)
                                                                                0 = Disabled
                                                                                1 = Enabled
                                       1      AIF1ADC2L_DR             0        Enable DRC in AIF1ADC2 (Left)
                                              C_ENA                             record path (AIF1, Timeslot 1)
                                                                                0 = Disabled
                                                                                1 = Enabled
                                       0      AIF1ADC2R_DR             0        Enable DRC in AIF1ADC2 (Right)
                                              C_ENA                             record path (AIF1, Timeslot 1)
                                                                                0 = Disabled
                                                                                1 = Enabled
                                                                                             PP, March 2014, Rev 3.5
w
                                                                                                                   74


Pre-Production                                                                                            WM8958
                   REGISTER            BIT           LABEL          DEFAULT                DESCRIPTION
                    ADDRESS
                 R1344 (0540h)          2       AIF2DAC_DRC_            0        Enable DRC in AIF2DAC playback
                 AIF2 DRC (1)                   ENA                              path
                                                                                 0 = Disabled
                                                                                 1 = Enabled
                                        1       AIF2ADCL_DRC            0        Enable DRC in AIF2ADC (Left)
                                                _ENA                             record path
                                                                                 0 = Disabled
                                                                                 1 = Enabled
                                        0       AIF2ADCR_DRC            0        Enable DRC in AIF2ADC (Right)
                                                _ENA                             record path
                                                                                 0 = Disabled
                                                                                 1 = Enabled
               Table 27 DRC Enable
               The following description of the DRC is applicable to all three DRCs. The associated register control
               fields are described in Table 29, Table 30 and Table 31 for the respective DRCs.
               Note that, where the following description refers to register names, the generic prefix [DRC] is quoted:
                               For the DRC associated with AIF1 timeslot 0, [DRC] = AIF1DRC1.
                               For the DRC associated with AIF1 timeslot 1, [DRC] = AIF1DRC2.
                               For the DRC associated with AIF2, [DRC] = AIF2DRC.
               DRC COMPRESSION / EXPANSION / LIMITING
               The DRC supports two different compression regions, separated by a “Knee” at a specific input
               amplitude. In the region above the knee, the compression slope [DRC]_HI_COMP applies; in the
               region below the knee, the compression slope [DRC]_LO_COMP applies.
               The DRC also supports a noise gate region, where low-level input signals are heavily attenuated. This
               function can be enabled or disabled according to the application requirements. The DRC response in
               this region is defined by the expansion slope [DRC]_NG_EXP.
               For additional attenuation of signals in the noise gate region, an additional “knee” can be defined
               (shown as “Knee2” in Figure 23). When this knee is enabled, this introduces an infinitely steep drop-
               off in the DRC response pattern between the [DRC]_LO_COMP and [DRC]_NG_EXP regions.
               The overall DRC compression characteristic in “steady state” (i.e. where the input amplitude is near-
               constant) is illustrated in Figure 23.
                                                                                             PP, March 2014, Rev 3.5
w
                                                                                                                     75


WM8958                                                                                                Pre-Production
           DRC Output Amplitude (dB)
                         (Y0)
                                                        Knee1
           [DRC]_KNEE_OP
                                                          P
                                                       OM
                                                   O _C
                                                ]_L
                                             RC
                                           [D
                                  Knee2
         [DRC]_KNEE2_OP
                                [DRC]_KNEE2_IP      [DRC]_KNEE_IP             0dB
                                                                    DRC Input Amplitude (dB)
       Figure 23 DRC Response Characteristic
       The slope of the DRC response is determined by register fields [DRC]_HI_COMP and
       [DRC]_LO_COMP. A slope of 1 indicates constant gain in this region. A slope less than 1 represents
       compression (i.e. a change in input amplitude produces only a smaller change in output amplitude). A
       slope of 0 indicates that the target output amplitude is the same across a range of input amplitudes;
       this is infinite compression.
       When the noise gate is enabled, the DRC response in this region is determined by the
       [DRC]_NG_EXP register. A slope of 1 indicates constant gain in this region. A slope greater than 1
       represents expansion (ie. a change in input amplitude produces a larger change in output amplitude).
       When the DRC_KNEE2_OP knee is enabled (“Knee2” in Figure 23), this introduces the vertical line in
       the response pattern illustrated, resulting in infinitely steep attenuation at this point in the response.
       The DRC parameters are listed in Table 28.
            REF            PARAMETER                                       DESCRIPTION
             1        [DRC]_KNEE_IP             Input level at Knee1 (dB)
             2        [DRC]_KNEE_OP             Output level at Knee2 (dB)
             3        [DRC]_HI_COMP             Compression ratio above Knee1
             4        [DRC]_LO_COMP             Compression ratio below Knee1
             5        [DRC]_KNEE2_IP            Input level at Knee2 (dB)
             6        [DRC]_NG_EXP              Expansion ratio below Knee2
             7        [DRC]_KNEE2_OP            Output level at Knee2 (dB)
       Table 28 DRC Response Parameters
       The noise gate is enabled when the [DRC]_NG_ENA register is set. When the noise gate is not
       enabled, parameters 5, 6, 7 above are ignored, and the [DRC]_LO_COMP slope applies to all input
       signal levels below Knee1.
       The DRC_KNEE2_OP knee is enabled when the [DRC]_KNEE2_OP_ENA register is set. When this
       bit is not set, then parameter 7 above is ignored, and the Knee2 position always coincides with the low
       end of the [DRC]_LO_COMP region.
                                                                                          PP, March 2014, Rev 3.5
w
                                                                                                                  76


Pre-Production                                                                                             WM8958
               The “Knee1” point in Figure 23 is determined by register fields [DRC]_KNEE_IP and
               [DRC]_KNEE_OP.
               Parameter Y0, the output level for a 0dB input, is not specified directly, but can be calculated from the
               other parameters, using the equation:
               GAIN LIMITS
               The minimum and maximum gain applied by the DRC is set by register fields [DRC]_MINGAIN,
               [DRC]_MAXGAIN and [DRC]_NG_MINGAIN. These limits can be used to alter the DRC response
               from that illustrated in Figure 23. If the range between maximum and minimum gain is reduced, then
               the extent of the dynamic range control is reduced.
               The minimum gain in the Compression regions of the DRC response is set by [DRC]_MINGAIN. The
               mimimum gain in the Noise Gate region is set by [DRC]_NG_MINGAIN. The minimum gain limit
               prevents excessive attenuation of the signal path.
               The maximum gain limit set by [DRC]_MAXGAIN prevents quiet signals (or silence) from being
               excessively amplified.
               DYNAMIC CHARACTERISTICS
               The dynamic behaviour determines how quickly the DRC responds to changing signal levels. Note
               that the DRC responds to the average (RMS) signal amplitude over a period of time.
               The [DRC]_ATK determines how quickly the DRC gain decreases when the signal amplitude is high.
               The [DRC]_DCY determines how quickly the DRC gain increases when the signal amplitude is low.
               These register fields are described in Table 29, Table 30 and Table 31. Note that the register defaults
               are suitable for general purpose microphone use.
               ANTI-CLIP CONTROL
               The DRC includes an Anti-Clip feature to avoid signal clipping when the input amplitude rises very
               quickly. This feature uses a feed-forward technique for early detection of a rising signal level. Signal
               clipping is avoided by dynamically increasing the gain attack rate when required. The Anti-Clip feature
               is enabled using the [DRC]_ANTICLIP bit.
               Note that the feed-forward processing increases the latency in the input signal path.
               Note that the Anti-Clip feature operates entirely in the digital domain. It cannot be used to prevent
               signal clipping in the analogue domain nor in the source signal. Analogue clipping can only be
               prevented by reducing the analogue signal gain or by adjusting the source signal.
               Note that the Anti-Clip feature should not be enabled at the same time as the Quick Release feature
               (described below) on the same DRC.
                                                                                               PP, March 2014, Rev 3.5
w
                                                                                                                     77


WM8958                                                                                           Pre-Production
       QUICK RELEASE CONTROL
       The DRC includes a Quick-Release feature to handle short transient peaks that are not related to the
       intended source signal. For example, in handheld microphone recording, transient signal peaks
       sometimes occur due to user handling, key presses or accidental tapping against the microphone.
       The Quick Release feature ensures that these transients do not cause the intended signal to be
       masked by the longer time constants of [DRC]_DCY.
       The Quick-Release feature is enabled by setting the [DRC]_QR bit. When this bit is enabled, the DRC
       measures the crest factor (peak to RMS ratio) of the input signal. A high crest factor is indicative of a
       transient peak that may not be related to the intended source signal. If the crest factor exceeds the
       level set by [DRC]_QR_THR, then the normal decay rate ([DRC]_DCY) is ignored and a faster decay
       rate ([DRC]_QR_DCY) is used instead.
       Note that the Quick Release feature should not be enabled at the same time as the Anti-Clip feature
       (described above) on the same DRC.
       SIGNAL ACTIVITY DETECT
       The DRC incorporates a configurable signal detect function, allowing the signal level at the DRC input
       to be monitored and to be used to trigger other events. This can be used to detect the presence of a
       microphone signal on an ADC or digital mic channel, or can be used to detect an audio signal
       received over the digital audio interface.
       The Peak signal level or the RMS signal level of the DRC input can be selected as the detection
       threshold. When the threshold condition is exceeded, an interrupt or GPIO output can be generated.
       See “General Purpose Input/Output” for a full description of the applicable control fields.
       DRC REGISTER CONTROLS
       The AIF1DRC1 control registers are described in Table 29. The AIF1DRC2 control registers are
       described in Table 30. The AIF2DRC control registers are described in Table 31.
           REGISTER          BIT            LABEL        DEFAULT                    DESCRIPTION
           ADDRESS
         R1088 (0440h)        8       AIF1DRC1_NG_             0         AIF1 DRC1 Noise Gate Enable
         AIF1 DRC1 (1)                ENA                                0 = Disabled
                                                                         1 = Enabled
                              5       AIF1DRC1_KNE             0         AIF1 DRC1 KNEE2_OP Enable
                                      E2_OP_ENA                          0 = Disabled
                                                                         1 = Enabled
                              4       AIF1DRC1_QR              1         AIF1 DRC1 Quick-release Enable
                                                                         0 = Disabled
                                                                         1 = Enabled
                              3       AIF1DRC1_ANTI            1         AIF1 DRC1 Anti-clip Enable
                                      CLIP                               0 = Disabled
                                                                         1 = Enabled
                                                                                     PP, March 2014, Rev 3.5
w
                                                                                                             78


Pre-Production                                                                 WM8958
                 REGISTER     BIT       LABEL  DEFAULT           DESCRIPTION
                 ADDRESS
               R1089 (0441h) 12:9 AIF1DRC1_ATK   0100  AIF1 DRC1 Gain attack rate
               AIF1 DRC1 (2)      [3:0]                (seconds/6dB)
                                                       0000 = Reserved
                                                       0001 = 181us
                                                       0010 = 363us
                                                       0011 = 726us
                                                       0100 = 1.45ms
                                                       0101 = 2.9ms
                                                       0110 = 5.8ms
                                                       0111 = 11.6ms
                                                       1000 = 23.2ms
                                                       1001 = 46.4ms
                                                       1010 = 92.8ms
                                                       1011 = 185.6ms
                                                       1100-1111 = Reserved
                              8:5 AIF1DRC1_DCY   0010  AIF1 DRC1 Gain decay rate
                                  [3:0]                (seconds/6dB)
                                                       0000 = 186ms
                                                       0001 = 372ms
                                                       0010 = 743ms
                                                       0011 = 1.49s
                                                       0100 = 2.97s
                                                       0101 = 5.94s
                                                       0110 = 11.89s
                                                       0111 = 23.78s
                                                       1000 = 47.56s
                                                       1001-1111 = Reserved
                              4:2 AIF1DRC1_MIN    001  AIF1 DRC1 Minimum gain to
                                  GAIN [2:0]           attenuate audio signals
                                                       000 = 0dB
                                                       001 = -12dB (default)
                                                       010 = -18dB
                                                       011 = -24dB
                                                       100 = -36dB
                                                       101 = Reserved
                                                       11X = Reserved
                              1:0 AIF1DRC1_MAX     01  AIF1 DRC1 Maximum gain to boost
                                  GAIN [1:0]           audio signals (dB)
                                                       00 = 12dB
                                                       01 = 18dB
                                                       10 = 24dB
                                                       11 = 36dB
                                                                   PP, March 2014, Rev 3.5
w
                                                                                        79


WM8958                                                                  Pre-Production
         REGISTER     BIT      LABEL     DEFAULT            DESCRIPTION
         ADDRESS
       R1090 (0442h) 15:12 AIF1DRC1_NG_    0000  AIF1 DRC1 Minimum gain to
       AIF1 DRC1 (3)       MINGAIN [3:0]         attenuate audio signals when the
                                                 noise gate is active.
                                                 0000 = -36dB
                                                 0001 = -30dB
                                                 0010 = -24dB
                                                 0011 = -18dB
                                                 0100 = -12dB
                                                 0101 = -6dB
                                                 0110 = 0dB
                                                 0111 = 6dB
                                                 1000 = 12dB
                                                 1001 = 18dB
                                                 1010 = 24dB
                                                 1011 = 30dB
                                                 1100 = 36dB
                                                 1101 to 1111 = Reserved
                     11:10 AIF1DRC1_NG_      00  AIF1 DRC1 Noise Gate slope
                           EXP [1:0]             00 = 1 (no expansion)
                                                 01 = 2
                                                 10 = 4
                                                 11 = 8
                      9:8  AIF1DRC1_QR_      00  AIF1 DRC1 Quick-release threshold
                           THR [1:0]             (crest factor in dB)
                                                 00 = 12dB
                                                 01 = 18dB
                                                 10 = 24dB
                                                 11 = 30dB
                      7:6  AIF1DRC1_QR_      00  AIF1 DRC1 Quick-release decay
                           DCY [1:0]             rate (seconds/6dB)
                                                 00 = 0.725ms
                                                 01 = 1.45ms
                                                 10 = 5.8ms
                                                 11 = Reserved
                      5:3  AIF1DRC1_HI_C    000  AIF1 DRC1 Compressor slope
                           OMP [2:0]             (upper region)
                                                 000 = 1 (no compression)
                                                 001 = 1/2
                                                 010 = 1/4
                                                 011 = 1/8
                                                 100 = 1/16
                                                 101 = 0
                                                 110 = Reserved
                                                 111 = Reserved
                      2:0  AIF1DRC1_LO_     000  AIF1 DRC1 Compressor slope
                           COMP [2:0]            (lower region)
                                                 000 = 1 (no compression)
                                                 001 = 1/2
                                                 010 = 1/4
                                                 011 = 1/8
                                                 100 = 0
                                                 101 = Reserved
                                                 11X = Reserved
                                                              PP, March 2014, Rev 3.5
w
                                                                                   80


Pre-Production                                                                        WM8958
                  REGISTER        BIT        LABEL     DEFAULT           DESCRIPTION
                  ADDRESS
                R1091 (0443h)    10:5    AIF1DRC1_KNE   000000 AIF1 DRC1 Input signal level at the
                AIF1 DRC1 (4)            E_IP [5:0]            Compressor ‘Knee’.
                                                               000000 = 0dB
                                                               000001 = -0.75dB
                                                               000010 = -1.5dB
                                                               … (-0.75dB steps)
                                                               111100 = -45dB
                                                               111101 = Reserved
                                                               11111X = Reserved
                                  4:0    AIF1DRC1_KNE    00000 AIF1 DRC1 Output signal at the
                                         E_OP [4:0]            Compressor ‘Knee’.
                                                               00000 = 0dB
                                                               00001 = -0.75dB
                                                               00010 = -1.5dB
                                                               … (-0.75dB steps)
                                                               11110 = -22.5dB
                                                               11111 = Reserved
                R1092 (0444h)     9:5    AIF1DRC1_KNE    00000 AIF1 DRC1 Input signal level at the
                AIF1 DRC1 (5)            E2_IP [4:0]           Noise Gate threshold ‘Knee2’.
                                                               00000 = -36dB
                                                               00001 = -37.5dB
                                                               00010 = -39dB
                                                               … (-1.5dB steps)
                                                               11110 = -81dB
                                                               11111 = -82.5dB
                                                               Only applicable when
                                                               AIF1DRC1_NG_ENA = 1.
                                  4:0    AIF1DRC1_KNE    00000 AIF1 DRC1 Output signal at the
                                         E2_OP [4:0]           Noise Gate threshold ‘Knee2’.
                                                               00000 = -30dB
                                                               00001 = -31.5dB
                                                               00010 = -33dB
                                                               … (-1.5dB steps)
                                                               11110 = -75dB
                                                               11111 = -76.5dB
                                                               Only applicable when
                                                               AIF1DRC1_KNEE2_OP_ENA = 1.
               Table 29 AIF1 Timeslot 0 DRC Controls
                  REGISTER        BIT        LABEL     DEFAULT           DESCRIPTION
                  ADDRESS
                R1104 (0450h)      8     AIF1DRC2_NG_      0   AIF1 DRC2 Noise Gate Enable
                AIF1 DRC2 (1)            ENA                   0 = Disabled
                                                               1 = Enabled
                                   5     AIF1DRC2_KNE      0   AIF1 DRC2 KNEE2_OP Enable
                                         E2_OP_ENA             0 = Disabled
                                                               1 = Enabled
                                   4     AIF1DRC2_QR       1   AIF1 DRC2 Quick-release Enable
                                                               0 = Disabled
                                                               1 = Enabled
                                   3     AIF1DRC2_ANTI     1   AIF1 DRC2 Anti-clip Enable
                                         CLIP                  0 = Disabled
                                                               1 = Enabled
                                                                           PP, March 2014, Rev 3.5
w
                                                                                                  81


WM8958                                                                Pre-Production
         REGISTER     BIT       LABEL  DEFAULT           DESCRIPTION
         ADDRESS
       R1105 (0451h) 12:9 AIF1DRC2_ATK   0100  AIF1 DRC2 Gain attack rate
       AIF1 DRC2 (2)      [3:0]                (seconds/6dB)
                                               0000 = Reserved
                                               0001 = 181us
                                               0010 = 363us
                                               0011 = 726us
                                               0100 = 1.45ms
                                               0101 = 2.9ms
                                               0110 = 5.8ms
                                               0111 = 11.6ms
                                               1000 = 23.2ms
                                               1001 = 46.4ms
                                               1010 = 92.8ms
                                               1011 = 185.6ms
                                               1100-1111 = Reserved
                      8:5 AIF1DRC2_DCY   0010  AIF1 DRC2 Gain decay rate
                          [3:0]                (seconds/6dB)
                                               0000 = 186ms
                                               0001 = 372ms
                                               0010 = 743ms
                                               0011 = 1.49s
                                               0100 = 2.97s
                                               0101 = 5.94s
                                               0110 = 11.89s
                                               0111 = 23.78s
                                               1000 = 47.56s
                                               1001-1111 = Reserved
                      4:2 AIF1DRC2_MIN    001  AIF1 DRC2 Minimum gain to
                          GAIN [2:0]           attenuate audio signals
                                               000 = 0dB
                                               001 = -12dB (default)
                                               010 = -18dB
                                               011 = -24dB
                                               100 = -36dB
                                               101 = Reserved
                                               11X = Reserved
                      1:0 AIF1DRC2_MAX     01  AIF1 DRC2 Maximum gain to boost
                          GAIN [1:0]           audio signals (dB)
                                               00 = 12dB
                                               01 = 18dB
                                               10 = 24dB
                                               11 = 36dB
                                                           PP, March 2014, Rev 3.5
w
                                                                                 82


Pre-Production                                                                   WM8958
                 REGISTER     BIT      LABEL     DEFAULT            DESCRIPTION
                 ADDRESS
               R1106 (0452h) 15:12 AIF1DRC2_NG_    0000  AIF1 DRC2 Minimum gain to
               AIF1 DRC2 (3)       MINGAIN [3:0]         attenuate audio signals when the
                                                         noise gate is active.
                                                         0000 = -36dB
                                                         0001 = -30dB
                                                         0010 = -24dB
                                                         0011 = -18dB
                                                         0100 = -12dB
                                                         0101 = -6dB
                                                         0110 = 0dB
                                                         0111 = 6dB
                                                         1000 = 12dB
                                                         1001 = 18dB
                                                         1010 = 24dB
                                                         1011 = 30dB
                                                         1100 = 36dB
                                                         1101 to 1111 = Reserved
                             11:10 AIF1DRC2_NG_      00  AIF1 DRC2 Noise Gate slope
                                   EXP [1:0]             00 = 1 (no expansion)
                                                         01 = 2
                                                         10 = 4
                                                         11 = 8
                              9:8  AIF1DRC2_QR_      00  AIF1 DRC2 Quick-release threshold
                                   THR [1:0]             (crest factor in dB)
                                                         00 = 12dB
                                                         01 = 18dB
                                                         10 = 24dB
                                                         11 = 30dB
                              7:6  AIF1DRC2_QR_      00  AIF1 DRC2 Quick-release decay
                                   DCY [1:0]             rate (seconds/6dB)
                                                         00 = 0.725ms
                                                         01 = 1.45ms
                                                         10 = 5.8ms
                                                         11 = Reserved
                              5:3  AIF1DRC2_HI_C    000  AIF1 DRC2 Compressor slope
                                   OMP [2:0]             (upper region)
                                                         000 = 1 (no compression)
                                                         001 = 1/2
                                                         010 = 1/4
                                                         011 = 1/8
                                                         100 = 1/16
                                                         101 = 0
                                                         110 = Reserved
                                                         111 = Reserved
                              2:0  AIF1DRC2_LO_     000  AIF1 DRC2 Compressor slope
                                   COMP [2:0]            (lower region)
                                                         000 = 1 (no compression)
                                                         001 = 1/2
                                                         010 = 1/4
                                                         011 = 1/8
                                                         100 = 0
                                                         101 = Reserved
                                                         11X = Reserved
                                                                      PP, March 2014, Rev 3.5
w
                                                                                           83


WM8958                                                                      Pre-Production
          REGISTER        BIT        LABEL    DEFAULT           DESCRIPTION
          ADDRESS
        R1107 (0453h)    10:5    AIF1DRC2_KNE  000000 AIF1 DRC2 Input signal level at the
        AIF1 DRC2 (4)            E_IP [5:0]           Compressor ‘Knee’.
                                                      000000 = 0dB
                                                      000001 = -0.75dB
                                                      000010 = -1.5dB
                                                      … (-0.75dB steps)
                                                      111100 = -45dB
                                                      111101 = Reserved
                                                      11111X = Reserved
                          4:0    AIF1DRC2_KNE   00000 AIF1 DRC2 Output signal at the
                                 E_OP [4:0]           Compressor ‘Knee’.
                                                      00000 = 0dB
                                                      00001 = -0.75dB
                                                      00010 = -1.5dB
                                                      … (-0.75dB steps)
                                                      11110 = -22.5dB
                                                      11111 = Reserved
        R1108 (0454h)     9:5    AIF1DRC2_KNE   00000 AIF1 DRC2 Input signal level at the
        AIF1 DRC2 (5)            E2_IP [4:0]          Noise Gate threshold ‘Knee2’.
                                                      00000 = -36dB
                                                      00001 = -37.5dB
                                                      00010 = -39dB
                                                      … (-1.5dB steps)
                                                      11110 = -81dB
                                                      11111 = -82.5dB
                                                      Only applicable when
                                                      AIF1DRC2_NG_ENA = 1.
                          4:0    AIF1DRC2_KNE   00000 AIF1 DRC2 Output signal at the
                                 E2_OP [4:0]          Noise Gate threshold ‘Knee2’.
                                                      00000 = -30dB
                                                      00001 = -31.5dB
                                                      00010 = -33dB
                                                      … (-1.5dB steps)
                                                      11110 = -75dB
                                                      11111 = -76.5dB
                                                      Only applicable when
                                                      AIF1DRC2_KNEE2_OP_ENA = 1.
       Table 30 AIF1 Timeslot 1 DRC Controls
          REGISTER        BIT        LABEL    DEFAULT           DESCRIPTION
          ADDRESS
        R1344 (0540h)      8     AIF2DRC_NG_E     0   AIF2 DRC Noise Gate Enable
        AIF2 DRC (1)             NA                   0 = Disabled
                                                      1 = Enabled
                           5     AIF2DRC_KNEE     0   AIF2 DRC KNEE2_OP Enable
                                 2_OP_ENA             0 = Disabled
                                                      1 = Enabled
                           4     AIF2DRC_QR       1   AIF2 DRC Quick-release Enable
                                                      0 = Disabled
                                                      1 = Enabled
                           3     AIF2DRC_ANTI     1   AIF2 DRC Anti-clip Enable
                                 CLIP                 0 = Disabled
                                                      1 = Enabled
                                                                  PP, March 2014, Rev 3.5
w
                                                                                         84


Pre-Production                                                                 WM8958
                 REGISTER     BIT       LABEL  DEFAULT           DESCRIPTION
                 ADDRESS
               R1345 (0541h) 12:9 AIF2DRC_ATK    0100  AIF2 DRC Gain attack rate
               AIF2 DRC (2)       [3:0]                (seconds/6dB)
                                                       0000 = Reserved
                                                       0001 = 181us
                                                       0010 = 363us
                                                       0011 = 726us
                                                       0100 = 1.45ms
                                                       0101 = 2.9ms
                                                       0110 = 5.8ms
                                                       0111 = 11.6ms
                                                       1000 = 23.2ms
                                                       1001 = 46.4ms
                                                       1010 = 92.8ms
                                                       1011 = 185.6ms
                                                       1100-1111 = Reserved
                              8:5 AIF2DRC_DCY    0010  AIF2 DRC Gain decay rate
                                  [3:0]                (seconds/6dB)
                                                       0000 = 186ms
                                                       0001 = 372ms
                                                       0010 = 743ms
                                                       0011 = 1.49s
                                                       0100 = 2.97s
                                                       0101 = 5.94s
                                                       0110 = 11.89s
                                                       0111 = 23.78s
                                                       1000 = 47.56s
                                                       1001-1111 = Reserved
                              4:2 AIF2DRC_MING    001  AIF2 DRC Minimum gain to
                                  AIN [2:0]            attenuate audio signals
                                                       000 = 0dB
                                                       001 = -12dB (default)
                                                       010 = -18dB
                                                       011 = -24dB
                                                       100 = -36dB
                                                       101 = Reserved
                                                       11X = Reserved
                              1:0 AIF2DRC_MAX      01  AIF2 DRC Maximum gain to boost
                                  GAIN [1:0]           audio signals (dB)
                                                       00 = 12dB
                                                       01 = 18dB
                                                       10 = 24dB
                                                       11 = 36dB
                                                                   PP, March 2014, Rev 3.5
w
                                                                                        85


WM8958                                                                  Pre-Production
         REGISTER     BIT       LABEL    DEFAULT            DESCRIPTION
         ADDRESS
       R1346 (0542h) 15:12 AIF2DRC_NG_     0000  AIF2 DRC Minimum gain to
       AIF2 DRC (3)        MINGAIN [3:0]         attenuate audio signals when the
                                                 noise gate is active.
                                                 0000 = -36dB
                                                 0001 = -30dB
                                                 0010 = -24dB
                                                 0011 = -18dB
                                                 0100 = -12dB
                                                 0101 = -6dB
                                                 0110 = 0dB
                                                 0111 = 6dB
                                                 1000 = 12dB
                                                 1001 = 18dB
                                                 1010 = 24dB
                                                 1011 = 30dB
                                                 1100 = 36dB
                                                 1101 to 1111 = Reserved
                     11:10 AIF2DRC_NG_E      00  AIF2 DRC Noise Gate slope
                           XP [1:0]              00 = 1 (no expansion)
                                                 01 = 2
                                                 10 = 4
                                                 11 = 8
                      9:8  AIF2DRC_QR_T      00  AIF2 DRC Quick-release threshold
                           HR [1:0]              (crest factor in dB)
                                                 00 = 12dB
                                                 01 = 18dB
                                                 10 = 24dB
                                                 11 = 30dB
                      7:6  AIF2DRC_QR_D      00  AIF2 DRC Quick-release decay rate
                           CY [1:0]              (seconds/6dB)
                                                 00 = 0.725ms
                                                 01 = 1.45ms
                                                 10 = 5.8ms
                                                 11 = Reserved
                      5:3  AIF2DRC_HI_C     000  AIF2 DRC Compressor slope
                           OMP [2:0]             (upper region)
                                                 000 = 1 (no compression)
                                                 001 = 1/2
                                                 010 = 1/4
                                                 011 = 1/8
                                                 100 = 1/16
                                                 101 = 0
                                                 110 = Reserved
                                                 111 = Reserved
                      2:0  AIF2DRC_LO_C     000  AIF2 DRC Compressor slope (lower
                           OMP [2:0]             region)
                                                 000 = 1 (no compression)
                                                 001 = 1/2
                                                 010 = 1/4
                                                 011 = 1/8
                                                 100 = 0
                                                 101 = Reserved
                                                 11X = Reserved
                                                              PP, March 2014, Rev 3.5
w
                                                                                   86


Pre-Production                                                                        WM8958
                  REGISTER       BIT          LABEL   DEFAULT           DESCRIPTION
                  ADDRESS
                R1347 (0543h)   10:5     AIF2DRC_KNEE  000000 AIF2 DRC Input signal level at the
                AIF2 DRC (4)             _IP [5:0]            Compressor ‘Knee’.
                                                              000000 = 0dB
                                                              000001 = -0.75dB
                                                              000010 = -1.5dB
                                                              … (-0.75dB steps)
                                                              111100 = -45dB
                                                              111101 = Reserved
                                                              11111X = Reserved
                                 4:0     AIF2DRC_KNEE   00000 AIF2 DRC Output signal at the
                                         _OP [4:0]            Compressor ‘Knee’.
                                                              00000 = 0dB
                                                              00001 = -0.75dB
                                                              00010 = -1.5dB
                                                              … (-0.75dB steps)
                                                              11110 = -22.5dB
                                                              11111 = Reserved
                R1348 (0544h)    9:5     AIF2DRC_KNEE   00000 AIF2 DRC Input signal level at the
                AIF2 DRC (5)             2_IP [4:0]           Noise Gate threshold ‘Knee2’.
                                                              00000 = -36dB
                                                              00001 = -37.5dB
                                                              00010 = -39dB
                                                              … (-1.5dB steps)
                                                              11110 = -81dB
                                                              11111 = -82.5dB
                                                              Only applicable when
                                                              AIF2DRC_NG_ENA = 1.
                                 4:0     AIF2DRC_KNEE   00000 AIF2 DRC Output signal at the
                                         2_OP [4:0]           Noise Gate threshold ‘Knee2’.
                                                              00000 = -30dB
                                                              00001 = -31.5dB
                                                              00010 = -33dB
                                                              … (-1.5dB steps)
                                                              11110 = -75dB
                                                              11111 = -76.5dB
                                                              Only applicable when
                                                              AIF2DRC_KNEE2_OP_ENA = 1.
               Table 31 AIF2 DRC Controls
                                                                          PP, March 2014, Rev 3.5
w
                                                                                                 87


WM8958                                                                                                   Pre-Production
RETUNETM MOBILE PARAMETRIC EQUALIZER (EQ)
                              TM
                The ReTune Mobile Parametric EQ is a circuit which can be enabled in the digital playback path of
                the WM8958 audio interfaces. The function of the EQ is to adjust the frequency characteristic of the
                output in order to compensate for unwanted frequency characteristics in the loudspeaker (or other
                output transducer). It can also be used to tailor the response according to user preferences, for
                example to accentuate or attenuate specific frequency bands to emulate different sound profiles or
                environments e.g. concert hall, rock etc.
                The WM8958 provides three stereo EQ circuits; these are associated with AIF1 timeslot 0, AIF1
                timeslot 1 and AIF2 respectively. The EQ is enabled in these three signal paths using the register bits
                described in Table 32.
                    REGISTER           BIT          LABEL          DEFAULT                  DESCRIPTION
                    ADDRESS
                  R1152 (0480h)         0     AIF1DAC1_EQ_E            0          Enable EQ in AIF1DAC1 playback
                  AIF1 DAC1                   NA                                  path (AIF1, Timeslot 0)
                  EQ Gains (1)                                                    0 = Disabled
                                                                                  1 = Enabled
                  R1184                 0     AIF1DAC2_EQ_E            0          Enable EQ in AIF1DAC2 playback
                  (04A0h)                     NA                                  path (AIF1, Timeslot 1)
                  AIF1 DAC2                                                       0 = Disabled
                  EQ Gains (1)                                                    1 = Enabled
                  R1408 (0580h)         0     AIF2DAC_EQ_EN            0          Enable EQ in AIF2DAC playback
                  AIF2 EQ Gains               A                                   path
                  (1)                                                             0 = Disabled
                                                                                  1 = Enabled
                                    TM
                Table 32 ReTune        Mobile Parametric EQ Enable
                The following description of the EQ is applicable to all three EQ circuits. The associated register
                control fields are described in Table 34, Table 35 and Table 36 for the respective EQs. The EQ
                provides selective control of 5 frequency bands as described below.
                The low frequency band (Band 1) filter can be configured either as a peak filter or a shelving filter.
                When configured as a shelving filter, is provides adjustable gain below the Band 1 cut-off frequency.
                As a peak filter, it provides adjustable gain within a defined frequency band that is centred on the
                Band 1 frequency.
                The mid frequency bands (Band 2, Band 3, Band 4) filters are peak filters, which provide adjustable
                gain around the respective centre frequency.
                The high frequency band (Band 5) filter is a shelving filter, which provides adjustable gain above the
                Band 5 cut-off frequency.
                                                                                                 TM
                The EQ can be configured to operate in two modes - “Default” mode or “ReTune        Mobile” mode.
                                                                                              PP, March 2014, Rev 3.5
w
                                                                                                                    88


Pre-Production                                                                                           WM8958
               DEFAULT MODE (5-BAND PARAMETRIC EQ)
               In default mode, the cut-off / centre frequencies are fixed as per Table 33. The filter bandwidths are
               also fixed in default mode. The gain of the individual bands (-12dB to +12dB) can be controlled as
               described in Table 34.
               The cut-off / centre frequencies noted in Table 33 are applicable to a sample rate of 48kHz. When
               using other sample rates, these frequencies will be scaled in proportion to the selected sample rate for
               the associated Audio Interface (AIF1 or AIF2).
               If AIF1 and AIF2 are operating at different sample rates, then the cut-off / centre frequencies will be
               different for the two interfaces. Note that the frequencies can be set to other values by using the
                                              TM
               features described in “ReTune Mobile Mode”.
                         EQ BAND               CUT-OFF/CENTRE FREQUENCY
                              1                              100 Hz
                              2                              300 Hz
                              3                              875 Hz
                              4                             2400 Hz
                              5                             6900 Hz
               Table 33 EQ Band Cut-off / Centre Frequencies
                   REGISTER           BIT           LABEL         DEFAULT                  DESCRIPTION
                   ADDRESS
                 R1152 (0480h)      15:11     AIF1DAC1_EQ           01100       AIF1DAC1 (AIF1, Timeslot 0) EQ
                 AIF1 DAC1                    _B1_GAIN              (0dB)       Band 1 Gain
                 EQ Gains (1)                 [4:0]                             -12dB to +12dB in 1dB steps
                                                                                (see Table 37 for gain range)
                                     10:6     AIF1DAC1_EQ           01100       AIF1DAC1 (AIF1, Timeslot 0) EQ
                                              _B2_GAIN              (0dB)       Band 2 Gain
                                              [4:0]                             -12dB to +12dB in 1dB steps
                                                                                (see Table 37 for gain range)
                                      5:1     AIF1DAC1_EQ           01100       AIF1DAC1 (AIF1, Timeslot 0) EQ
                                              _B3_GAIN              (0dB)       Band 3 Gain
                                              [4:0]                             -12dB to +12dB in 1dB steps
                                                                                (see Table 37 for gain range)
                 R1153 (0481h)      15:11     AIF1DAC1_EQ           01100       AIF1DAC1 (AIF1, Timeslot 0) EQ
                 AIF1 DAC1                    _B4_GAIN              (0dB)       Band 4 Gain
                 EQ Gains (2)                 [4:0]                             -12dB to +12dB in 1dB steps
                                                                                (see Table 37 for gain range)
                                     10:6     AIF1DAC1_EQ           01100       AIF1DAC1 (AIF1, Timeslot 0) EQ
                                              _B5_GAIN              (0dB)       Band 5 Gain
                                              [4:0]                             -12dB to +12dB in 1dB steps
                                                                                (see Table 37 for gain range)
                                       0      AIF1DAC1_EQ              0        AIF1DAC1 (AIF1, Timeslot 0) EQ
                                              _MODE                             Band 1 Mode
                                                                                0 = Shelving filter
                                                                                1 = Peak filter
               Table 34 AIF1 Timeslot 0 EQ Band Gain Control
                                                                                             PP, March 2014, Rev 3.5
w
                                                                                                                    89


WM8958                                                                             Pre-Production
          REGISTER         BIT          LABEL      DEFAULT           DESCRIPTION
          ADDRESS
        R1184            15:11    AIF1DAC2_EQ        01100 AIF1DAC2 (AIF1, Timeslot 1) EQ
        (04A0h)                   _B1_GAIN           (0dB) Band 1 Gain
        AIF1 DAC2                 [4:0]                    -12dB to +12dB in 1dB steps
        EQ Gains (1)                                       (see Table 37 for gain range)
                          10:6    AIF1DAC2_EQ        01100 AIF1DAC2 (AIF1, Timeslot 1) EQ
                                  _B2_GAIN           (0dB) Band 2 Gain
                                  [4:0]                    -12dB to +12dB in 1dB steps
                                                           (see Table 37 for gain range)
                           5:1    AIF1DAC2_EQ        01100 AIF1DAC2 (AIF1, Timeslot 1) EQ
                                  _B3_GAIN           (0dB) Band 3 Gain
                                  [4:0]                    -12dB to +12dB in 1dB steps
                                                           (see Table 37 for gain range)
        R1185            15:11    AIF1DAC2_EQ        01100 AIF1DAC2 (AIF1, Timeslot 1) EQ
        (04A1h)                   _B4_GAIN           (0dB) Band 4 Gain
        AIF1 DAC2                 [4:0]                    -12dB to +12dB in 1dB steps
        EQ Gains (2)                                       (see Table 37 for gain range)
                          10:6    AIF1DAC2_EQ        01100 AIF1DAC2 (AIF1, Timeslot 1) EQ
                                  _B5_GAIN           (0dB) Band 5 Gain
                                  [4:0]                    -12dB to +12dB in 1dB steps
                                                           (see Table 37 for gain range)
                            0     AIF1DAC2_EQ          0   AIF1DAC2 (AIF1, Timeslot 1) EQ
                                  _MODE                    Band 1 Mode
                                                           0 = Shelving filter
                                                           1 = Peak filter
       Table 35 AIF1 Timeslot 1 EQ Band Gain Control
          REGISTER         BIT          LABEL      DEFAULT           DESCRIPTION
          ADDRESS
        R1408 (0580h)    15:11    AIF2DAC_EQ_        01100 AIF2 EQ Band 1 Gain
        AIF2 EQ Gains             B1_GAIN            (0dB) -12dB to +12dB in 1dB steps
        (1)                       [4:0]                    (see Table 37 for gain range)
                          10:6    AIF2DAC_EQ_        01100 AIF2 EQ Band 2 Gain
                                  B2_GAIN            (0dB) -12dB to +12dB in 1dB steps
                                  [4:0]                    (see Table 37 for gain range)
                           5:1    AIF2DAC_EQ_        01100 AIF2 EQ Band 3 Gain
                                  B3_GAIN            (0dB) -12dB to +12dB in 1dB steps
                                  [4:0]                    (see Table 37 for gain range)
        R1409 (0581h)    15:11    AIF2DAC_EQ_        01100 AIF2 EQ Band 4 Gain
        AIF2 EQ Gains             B4_GAIN            (0dB) -12dB to +12dB in 1dB steps
        (2)                       [4:0]                    (see Table 37 for gain range)
                          10:6    AIF2DAC_EQ_        01100 AIF2 EQ Band 5 Gain
                                  B5_GAIN            (0dB) -12dB to +12dB in 1dB steps
                                  [4:0]                    (see Table 37 for gain range)
                            0     AIF2DAC_EQ_          0   AIF2 EQ Band 1 Mode
                                  MODE                     0 = Shelving filter
                                                           1 = Peak filter
       Table 36 AIF2 EQ Band Gain Control
                                                                        PP, March 2014, Rev 3.5
w
                                                                                              90


Pre-Production                                                                                           WM8958
                          EQ GAIN SETTING                      GAIN (dB)
                                  00000                            -12
                                  00001                            -11
                                  00010                            -10
                                  00011                             -9
                                  00100                             -8
                                  00101                             -7
                                  00110                             -6
                                  00111                             -5
                                  01000                             -4
                                  01001                             -3
                                  01010                             -2
                                  01011                             -1
                                  01100                              0
                                  01101                            +1
                                  01110                            +2
                                  01111                            +3
                                  10000                            +4
                                  10001                            +5
                                  10010                            +6
                                  10011                            +7
                                  10100                            +8
                                  10101                            +9
                                  10110                            +10
                                  10111                            +11
                                  11000                            +12
                             11001 to 11111                     Reserved
               Table 37 EQ Gain Control Range
               RETUNETM MOBILE MODE
                        TM
               ReTune Mobile mode provides a comprehensive facility for the user to define the cut-off/centre
               frequencies and filter bandwidth for each EQ band, in addition to the gain controls already described.
               This enables the EQ to be accurately customised for a specific transducer characteristic or desired
               sound profile.
               The EQ enable and EQ gain controls are the same as defined for the default mode. The additional
                                              TM
               coefficients used in ReTune Mobile mode are held in registers R1154 to R1172 for AIF1DAC1,
               registers R1186 to R1204 for AIF1DAC2 and registers R1410 to R1428 for AIF2. These coefficients
               are derived using tools provided in Wolfson’s WISCE™ evaluation board control software.
               Please contact your local Wolfson representative for more details.
               Note that the WM8958 audio interfaces may operate at different sample rates concurrently. The EQ
               settings for each interface must be programmed relative to the applicable sample rate of the
               corresponding audio interface. If the audio interface sample rate is changed, then different EQ register
               settings will be required to achieve a given EQ response.
                                                                                            PP, March 2014, Rev 3.5
w
                                                                                                                    91


WM8958                                                                                                                    Pre-Production
                                   EQ FILTER CHARACTERISTICS
                                   The filter characteristics for each frequency band are shown in Figure 24 to Figure 28. These figures
                                   show the frequency response for all available gain settings, using default cut-off/centre frequencies
                                   and bandwidth. Note that EQ Band 1 can also be configured as a Peak Filter if required.
              15                                                                      15
              10                                                                      10
               5                                                                       5
  Gain (dB)                                                               Gain (dB)
               0                                                                       0
               -5                                                                      -5
              -10                                                                     -10
              -15                                                                     -15
                    1   10   100         1000      10000     100000                         1   10   100       1000     10000    100000
                             Frequency (Hz)                                                          Frequency (Hz)
Figure 24 EQ Band 1 – Low Freq Shelf Filter Response                   Figure 25 EQ Band 2 – Peak Filter Response
              15                                                                      15
              10                                                                      10
               5                                                                       5
  Gain (dB)                                                               Gain (dB)
               0                                                                       0
               -5                                                                      -5
              -10                                                                     -10
              -15                                                                     -15
                    1   10   100         1000      10000     100000                         1   10   100       1000     10000    100000
                             Frequency (Hz)                                                          Frequency (Hz)
Figure 26 EQ Band 3 – Peak Filter Response                             Figure 27 EQ Band 4 – Peak Filter Response
              15
              10
               5
  Gain (dB)
               0
               -5
              -10
              -15
                    1   10   100         1000      10000     100000
                             Frequency (Hz)
Figure 28 EQ Band 5 – High Freq Shelf Filter Response
                                                                                                                 PP, March 2014, Rev 3.5
w
                                                                                                                                     92


Pre-Production                                                                                        WM8958
3D STEREO EXPANSION
               The 3D Stereo Expansion is an audio enhancement feature which can be enabled in the digital
               playback path of the WM8958 audio interfaces. This feature uses configurable cross-talk mechanisms
               to adjust the depth or width of the stereo audio.
               The WM8958 provides three 3D Stereo Expansion circuits; these are associated with AIF1 timeslot 0,
               AIF1 timeslot 1 and AIF2 respectively. The 3D Stereo Expansion is enabled and controlled in these
               signal paths using the register bits described in Table 38.
                   REGISTER          BIT           LABEL           DEFAULT             DESCRIPTION
                   ADDRESS
                 R1057 (0421h)      13:9     AIF1DAC1_3D_G           00000   AIF1DAC1 playback path (AIF1,
                 AIF1 DAC1                   AIN                             Timeslot 0) 3D Stereo depth
                 Filters (2)                                                 00000 = Off
                                                                             00001 = Minimum (-16dB)
                                                                             …(0.915dB steps)
                                                                             11111 = Maximum (+11.45dB)
                                      8      AIF1DAC1_3D_E              0    Enable 3D Stereo in AIF1DAC1
                                             NA                              playback path (AIF1, Timeslot 0)
                                                                             0 = Disabled
                                                                             1 = Enabled
                 R1059 (0423h)      13:9     AIF1DAC2_3D_G           00000   AIF1DAC2 playback path (AIF1,
                 AIF1 DAC2                   AIN                             Timeslot 1) 3D Stereo depth
                 Filters (2)                                                 00000 = Off
                                                                             00001 = Minimum (-16dB)
                                                                             …(0.915dB steps)
                                                                             11111 = Maximum (+11.45dB)
                                      8      AIF1DAC2_3D_E              0    Enable 3D Stereo in AIF1DAC2
                                             NA                              playback path (AIF1, Timeslot 1)
                                                                             0 = Disabled
                                                                             1 = Enabled
                 R1313 (0521h)      13:9     AIF2DAC_3D_GA           00000   AIF2DAC playback path 3D Stereo
                 AIF2 DAC                    IN                              depth
                 Filters (2)                                                 00000 = Off
                                                                             00001 = Minimum (-16dB)
                                                                             …(0.915dB steps)
                                                                             11111 = Maximum (+11.45dB)
                                      8      AIF2DAC_3D_EN              0    Enable 3D Stereo in AIF2DAC
                                             A                               playback path
                                                                             0 = Disabled
                                                                             1 = Enabled
               Table 38 3D Stereo Expansion Control
                                                                                         PP, March 2014, Rev 3.5
w
                                                                                                               93


WM8958                                                                                                         Pre-Production
DIGITAL VOLUME AND FILTER CONTROL
                This section describes the digital volume and filter controls of the WM8958 AIF paths.
                Digital volume control and High Pass Filter (HPF) control is provided on four AIF1 output (digital
                record) paths and two AIF2 output (digital record) paths.
                Note that, when ultrasonic (4FS) mode is selected on AIF1, then the digital volume control and high
                pass filter (HPF) control are bypassed on the respective ADC (output) signal paths.
                Digital volume, soft-mute and mono mix control is provided on four AIF1 input (digital playback) paths
                and two AIF2 input (digital playback) paths. A configurable noise gate function is available on each of
                the digital playback paths.
                AIF1 - OUTPUT PATH VOLUME CONTROL
                The AIF1 interface supports up to four output channels. A digital volume control is provided on each of
                these output signal paths, allowing attenuation in the range -71.625dB to +17.625dB in 0.375dB steps.
                The level of attenuation for an eight-bit code X is given by:
                0.375  (X-192) dB for 1  X  239;         MUTE for X = 0        +17.625dB for 239  X  255
                The AIF1ADC1_VU and AIF1ADC2_VU bits control the loading of digital volume control data. When
                the volume update bit is set to 0, the associated volume control data will be loaded into the respective
                control register, but will not actually change the digital gain setting.
                The AIF1ADC1L and AIF1ADC1R gain settings are updated when a 1 is written to AIF1ADC1_VU.
                The AIF1ADC2L and AIF1ADC2R gain settings are updated when a 1 is written to AIF1ADC2_VU.
                This makes it possible to update the gain of left and right channels simultaneously.
                   REGISTER          BIT         LABEL       DEFAULT                         DESCRIPTION
                    ADDRESS
                  R1024               8       AIF1ADC1_          N/A        AIF1ADC1 output path (AIF1, Timeslot 0)
                  (0400h)                     VU                            Volume Update
                  AIF1 ADC1                                                 Writing a 1 to this bit will cause the
                  Left Volume                                               AIF1ADC1L and AIF1ADC1R volume to be
                                                                            updated simultaneously
                                     7:0      AIF1ADC1L          C0h        AIF1ADC1 (Left) output path (AIF1, Timeslot
                                              _VOL [7:0]        (0dB)       0) Digital Volume
                                                                            00h = MUTE
                                                                            01h = -71.625dB
                                                                            … (0.375dB steps)
                                                                            EFh = +17.625dB
                                                                            (See Table 40 for volume range)
                  R1025               8       AIF1ADC1_          N/A        AIF1ADC1 output path (AIF1, Timeslot 0)
                  (0401h)                     VU                            Volume Update
                  AIF1 ADC1                                                 Writing a 1 to this bit will cause the
                  Right Volume                                              AIF1ADC1L and AIF1ADC1R volume to be
                                                                            updated simultaneously
                                     7:0      AIF1ADC1R          C0h        AIF1ADC1 (Right) output path (AIF1, Timeslot
                                              _VOL [7:0]        (0dB)       0) Digital Volume
                                                                            00h = MUTE
                                                                            01h = -71.625dB
                                                                            … (0.375dB steps)
                                                                            EFh = +17.625dB
                                                                            (See Table 40 for volume range)
                  R1028               8       AIF1ADC2_          N/A        AIF1ADC2 output path (AIF1, Timeslot 1)
                  (0404h)                     VU                            Volume Update
                  AIF1 ADC2                                                 Writing a 1 to this bit will cause the
                  Left Volume                                               AIF1ADC2L and AIF1ADC2R volume to be
                                                                            updated simultaneously
                                                                                                    PP, March 2014, Rev 3.5
w
                                                                                                                          94


Pre-Production                                                                                  WM8958
                 REGISTER       BIT       LABEL    DEFAULT                  DESCRIPTION
                  ADDRESS
                                7:0    AIF1ADC2L      C0h  AIF1ADC2 (Left) output path (AIF1, Timeslot
                                       _VOL [7:0]    (0dB) 1) Digital Volume
                                                           00h = MUTE
                                                           01h = -71.625dB
                                                           … (0.375dB steps)
                                                           EFh = +17.625dB
                                                           (See Table 40 for volume range)
                R1029            8     AIF1ADC2_      N/A  AIF1ADC2 output path (AIF1, Timeslot 1)
                (0405h)                VU                  Volume Update
                AIF1 ADC2                                  Writing a 1 to this bit will cause the
                Right Volume                               AIF1ADC2L and AIF1ADC2R volume to be
                                                           updated simultaneously
                                7:0    AIF1ADC2R      C0h  AIF1ADC2 (Right) output path (AIF1, Timeslot
                                       _VOL [7:0]    (0dB) 1) Digital Volume
                                                           00h = MUTE
                                                           01h = -71.625dB
                                                           … (0.375dB steps)
                                                           EFh = +17.625dB
                                                           (See Table 40 for volume range)
               Table 39 AIF1 Output Path Volume Control
                                                                                   PP, March 2014, Rev 3.5
w
                                                                                                        95


WM8958                                                                                         Pre-Production
          AIF1/AIF2     Volume       AIF1/AIF2   Volume     AIF1/AIF2    Volume      AIF1/AIF2     Volume
        Output Volume    (dB)      Output Volume   (dB)   Output Volume     (dB)  Output Volume      (dB)
              0h         MUTE           40h       -48.000      80h        -24.000       C0h          0.000
              1h        -71.625         41h       -47.625      81h        -23.625       C1h          0.375
              2h        -71.250         42h       -47.250      82h        -23.250       C2h          0.750
              3h        -70.875         43h       -46.875      83h        -22.875       C3h          1.125
              4h        -70.500         44h       -46.500      84h        -22.500       C4h          1.500
              5h        -70.125         45h       -46.125      85h        -22.125       C5h          1.875
              6h        -69.750         46h       -45.750      86h        -21.750       C6h          2.250
              7h        -69.375         47h       -45.375      87h        -21.375       C7h          2.625
              8h        -69.000         48h       -45.000      88h        -21.000       C8h          3.000
              9h        -68.625         49h       -44.625      89h        -20.625       C9h          3.375
              Ah        -68.250         4Ah       -44.250      8Ah        -20.250       CAh          3.750
              Bh        -67.875         4Bh       -43.875      8Bh        -19.875       CBh          4.125
              Ch        -67.500         4Ch       -43.500      8Ch        -19.500       CCh          4.500
              Dh        -67.125         4Dh       -43.125      8Dh        -19.125       CDh          4.875
              Eh        -66.750         4Eh       -42.750      8Eh        -18.750       CEh          5.250
              Fh        -66.375         4Fh       -42.375      8Fh        -18.375       CFh          5.625
             10h        -66.000         50h       -42.000      90h        -18.000       D0h          6.000
             11h        -65.625         51h       -41.625      91h        -17.625       D1h          6.375
             12h        -65.250         52h       -41.250      92h        -17.250       D2h          6.750
             13h        -64.875         53h       -40.875      93h        -16.875       D3h          7.125
             14h        -64.500         54h       -40.500      94h        -16.500       D4h          7.500
             15h        -64.125         55h       -40.125      95h        -16.125       D5h          7.875
             16h        -63.750         56h       -39.750      96h        -15.750       D6h          8.250
             17h        -63.375         57h       -39.375      97h        -15.375       D7h          8.625
             18h        -63.000         58h       -39.000      98h        -15.000       D8h          9.000
             19h        -62.625         59h       -38.625      99h        -14.625       D9h          9.375
             1Ah        -62.250         5Ah       -38.250      9Ah        -14.250       DAh          9.750
             1Bh        -61.875         5Bh       -37.875      9Bh        -13.875       DBh         10.125
             1Ch        -61.500         5Ch       -37.500      9Ch        -13.500       DCh         10.500
             1Dh        -61.125         5Dh       -37.125      9Dh        -13.125       DDh         10.875
             1Eh        -60.750         5Eh       -36.750      9Eh        -12.750       DEh         11.250
             1Fh        -60.375         5Fh       -36.375      9Fh        -12.375       DFh         11.625
             20h        -60.000         60h       -36.000      A0h        -12.000       E0h         12.000
             21h        -59.625         61h       -35.625      A1h        -11.625       E1h         12.375
             22h        -59.250         62h       -35.250      A2h        -11.250       E2h         12.750
             23h        -58.875         63h       -34.875      A3h        -10.875       E3h         13.125
             24h        -58.500         64h       -34.500      A4h        -10.500       E4h         13.500
             25h        -58.125         65h       -34.125      A5h        -10.125       E5h         13.875
             26h        -57.750         66h       -33.750      A6h         -9.750       E6h         14.250
             27h        -57.375         67h       -33.375      A7h         -9.375       E7h         14.625
             28h        -57.000         68h       -33.000      A8h         -9.000       E8h         15.000
             29h        -56.625         69h       -32.625      A9h         -8.625       E9h         15.375
             2Ah        -56.250         6Ah       -32.250      AAh         -8.250       EAh         15.750
             2Bh        -55.875         6Bh       -31.875      ABh         -7.875       EBh         16.125
             2Ch        -55.500         6Ch       -31.500      ACh         -7.500       ECh         16.500
             2Dh        -55.125         6Dh       -31.125      ADh         -7.125       EDh         16.875
             2Eh        -54.750         6Eh       -30.750      AEh         -6.750       EEh         17.250
             2Fh        -54.375         6Fh       -30.375      AFh         -6.375       EFh         17.625
             30h        -54.000         70h       -30.000      B0h         -6.000       F0h         17.625
             31h        -53.625         71h       -29.625      B1h         -5.625       F1h         17.625
             32h        -53.250         72h       -29.250      B2h         -5.250       F2h         17.625
             33h        -52.875         73h       -28.875      B3h         -4.875       F3h         17.625
             34h        -52.500         74h       -28.500      B4h         -4.500       F4h         17.625
             35h        -52.125         75h       -28.125      B5h         -4.125       F5h         17.625
             36h        -51.750         76h       -27.750      B6h         -3.750       F6h         17.625
             37h        -51.375         77h       -27.375      B7h         -3.375       F7h         17.625
             38h        -51.000         78h       -27.000      B8h         -3.000       F8h         17.625
             39h        -50.625         79h       -26.625      B9h         -2.625       F9h         17.625
             3Ah        -50.250         7Ah       -26.250      BAh         -2.250       FAh         17.625
             3Bh        -49.875         7Bh       -25.875      BBh         -1.875       FBh         17.625
             3Ch        -49.500         7Ch       -25.500      BCh         -1.500       FCh         17.625
             3Dh        -49.125         7Dh       -25.125      BDh         -1.125       FDh         17.625
             3Eh        -48.750         7Eh       -24.750      BEh         -0.750       FEh         17.625
             3Fh        -48.375         7Fh       -24.375      BFh         -0.375       FFh         17.625
       Table 40 AIF1 Output Path Digital Volume Range
       AIF1 - OUTPUT PATH HIGH PASS FILTER
       A digital high-pass filter can be enabled in the AIF1 output paths to remove DC offsets. This filter is
       enabled independently in the four AIF1 output channels using the register bits described in Table 41.
       The HPF cut-off frequency for the AIF1 Timeslot 0 channels is set using AIF1ADC1_HPF_CUT. The
       HPF cut-off frequency for the AIF1 Timeslot 1 channels is set using AIF1ADC2_HPF_CUT.
                                                                                    PP, March 2014, Rev 3.5
w
                                                                                                           96


Pre-Production                                                                                              WM8958
               In hi-fi mode, the high pass filter is optimised for removing DC offsets without degrading the bass
               response and has a cut-off frequency of 3.7Hz when the sample rate (fs) = 44.1kHz.
               In voice modes, the high pass filter is optimised for voice communication; it is recommended to set the
               cut-off frequency below 300Hz.
               Note that the cut-off frequencies scale with the AIF1 sample rate. (The AIF1 sample rate is set using
               the AIF1_SR register, as described in the “Clocking and Sample Rates” section.) See Table 42 for the
               HPF cut-off frequencies at all supported sample rates.
                   REGISTER         BIT        LABEL        DEFAULT                      DESCRIPTION
                   ADDRESS
                 R1040 (0410h)    14:13    AIF1ADC1_           00        AIF1ADC1 output path (AIF1, Timeslot 0)
                 AIF1 ADC1                 HPF_CUT                       Digital HPF cut-off frequency (fc)
                 Filters                   [1:0]                         00 = Hi-fi mode (fc = 4Hz at fs = 48kHz)
                                                                         01 = Voice mode 1 (fc = 64Hz at fs = 8kHz)
                                                                         10 = Voice mode 2 (fc = 130Hz at fs = 8kHz)
                                                                         11 = Voice mode 3 (fc = 267Hz at fs = 8kHz)
                                    12     AIF1ADC1L_           0        AIF1ADC1 (Left) output path (AIF1, Timeslot
                                           HPF                           0) Digital HPF Enable
                                                                         0 = Disabled
                                                                         1 = Enabled
                                    11     AIF1ADC1R            0        AIF1ADC1 (Right) output path (AIF1, Timeslot
                                           _HPF                          0) Digital HPF Enable
                                                                         0 = Disabled
                                                                         1 = Enabled
                 R1041 (0411h)    14:13    AIF1ADC2_           00        AIF1ADC2 output path (AIF1, Timeslot 1)
                 AIF1 ADC2                 HPF_CUT                       Digital HPF cut-off frequency (fc)
                 Filters                   [1:0]                         00 = Hi-fi mode (fc = 4Hz at fs = 48kHz)
                                                                         01 = Voice mode 1 (fc = 64Hz at fs = 8kHz)
                                                                         10 = Voice mode 2 (fc = 130Hz at fs = 8kHz)
                                                                         11 = Voice mode 3 (fc = 267Hz at fs = 8kHz)
                                    12     AIF1ADC2L_           0        AIF1ADC2 (Left) output path (AIF1, Timeslot
                                           HPF                           1) Digital HPF Enable
                                                                         0 = Disabled
                                                                         1 = Enabled
                                    11     AIF1ADC2R            0        AIF1ADC2 (Right) output path (AIF1, Timeslot
                                           _HPF                          1) Digital HPF Enable
                                                                         0 = Disabled
                                                                         1 = Enabled
               Table 41 AIF1 Output Path High Pass Filter
                     Sample             Cut-Off Frequency (Hz) for given value of AIFnADCn_HPF_CUT
                  Frequency
                      (kHz)               00                   01                     10                  11
                      8.000              0.7                   64                    130                 267
                     11.025              0.9                   88                    178                 367
                     16.000              1.3                  127                    258                 532
                     22.050              1.9                  175                    354                 733
                     24.000              2.0                  190                    386                 798
                     32.000              2.7                  253                    514                1063
                     44.100              3.7                  348                    707                1464
                     48.000              4.0                  379                    770                1594
                     88.200              7.4                  696                   1414                2928
                     96.000              8.0                  758                   1540                3188
               Table 42 AIF1 Output Path High Pass Filter Cut-Off Frequencies
                                                                                                PP, March 2014, Rev 3.5
w
                                                                                                                     97


WM8958                                                                                                Pre-Production
       AIF1 - INPUT PATH VOLUME CONTROL
       The AIF1 interface supports up to four input channels. A digital volume control is provided on each of
       these input signal paths, allowing attenuation in the range -71.625dB to 0dB in 0.375dB steps. The
       level of attenuation for an eight-bit code X is given by:
       0.375  (X-192) dB for 1  X  192;         MUTE for X = 0         0dB for 192  X  255
       The AIF1DAC1_VU and AIF1DAC2_VU bits control the loading of digital volume control data. When
       the volume update bit is set to 0, the associated volume control data will be loaded into the respective
       control register, but will not actually change the digital gain setting.
       The AIF1DAC1L and AIF1DAC1R gain settings are updated when a 1 is written to AIF1DAC1_VU.
       The AIF1DAC2L and AIF1DAC2R gain settings are updated when a 1 is written to AIF1DAC2_VU.
       This makes it possible to update the gain of left and right channels simultaneously.
       Note that a digital gain function is also available at the audio interface input, to boost the DAC volume
       when a small signal is received on DACDAT1. See “Digital Audio Interface Control” for further details.
       Digital volume control is also possible at the DAC stage of the signal path, after the audio signal has
       passed through the DAC digital mixers. See “Digital to Analogue Converter (DAC)” for further details.
          REGISTER          BIT         LABEL       DEFAULT                         DESCRIPTION
           ADDRESS
         R1026               8       AIF1DAC1_          N/A        AIF1DAC1 input path (AIF1, Timeslot 0)
         (0402h)                     VU                            Volume Update
         AIF1 DAC1                                                 Writing a 1 to this bit will cause the
         Left Volume                                               AIF1DAC1L and AIF1DAC1R volume to be
                                                                   updated simultaneously
                            7:0      AIF1DAC1L          C0h        AIF1DAC1 (Left) input path (AIF1, Timeslot 0)
                                     _VOL [7:0]        (0dB)       Digital Volume
                                                                   00h = MUTE
                                                                   01h = -71.625dB
                                                                   … (0.375dB steps)
                                                                   C0h = 0dB
                                                                   FFh = 0dB
                                                                   (See Table 44 for volume range)
         R1027               8       AIF1DAC1_          N/A        AIF1DAC1 input path (AIF1, Timeslot 0)
         (0403h)                     VU                            Volume Update
         AIF1 DAC1                                                 Writing a 1 to this bit will cause the
         Right Volume                                              AIF1DAC1L and AIF1DAC1R volume to be
                                                                   updated simultaneously
                            7:0      AIF1DAC1R          C0h        AIF1DAC1 (Right) input path (AIF1, Timeslot
                                     _VOL [7:0]        (0dB)       0) Digital Volume
                                                                   00h = MUTE
                                                                   01h = -71.625dB
                                                                   … (0.375dB steps)
                                                                   C0h = 0dB
                                                                   FFh = 0dB
                                                                   (See Table 44 for volume range)
         R1030               8       AIF1DAC2_          N/A        AIF1DAC2 input path (AIF1, Timeslot 1)
         (0406h)                     VU                            Volume Update
         AIF1 DAC2                                                 Writing a 1 to this bit will cause the
         Left Volume                                               AIF1DAC2L and AIF1DAC2R volume to be
                                                                   updated simultaneously
                                                                                           PP, March 2014, Rev 3.5
w
                                                                                                                 98


Pre-Production                                                                                    WM8958
                 REGISTER       BIT       LABEL     DEFAULT                   DESCRIPTION
                  ADDRESS
                                7:0    AIF1DAC2L        C0h  AIF1DAC2 (Left) input path (AIF1, Timeslot 1)
                                       _VOL [7:0]      (0dB) Digital Volume
                                                             00h = MUTE
                                                             01h = -71.625dB
                                                             … (0.375dB steps)
                                                             C0h = 0dB
                                                             FFh = 0dB
                                                             (See Table 44 for volume range)
                R1031            8     AIF1DAC2_        N/A  AIF1DAC2 input path (AIF1, Timeslot 1)
                (0407h)                VU                    Volume Update
                AIF1 DAC2                                    Writing a 1 to this bit will cause the
                Right Volume                                 AIF1DAC2L and AIF1DAC2R volume to be
                                                             updated simultaneously
                                7:0    AIF1DAC2R        C0h  AIF1DAC2 (Right) input path (AIF1, Timeslot
                                       _VOL [7:0]      (0dB) 1) Digital Volume
                                                             00h = MUTE
                                                             01h = -71.625dB
                                                             … (0.375dB steps)
                                                             C0h = 0dB
                                                             FFh = 0dB
                                                             (See Table 44 for volume range)
               Table 43 AIF1 Input Path Volume Control
                                                                                     PP, March 2014, Rev 3.5
w
                                                                                                          99


WM8958                                                                                            Pre-Production
     AIF1/AIF2 Input Volume   AIF1/AIF2 Input  Volume    AIF1/AIF2 Input Volume  AIF1/AIF2 Input  Volume
        Volume        (dB)       Volume         (dB)        Volume         (dB)     Volume          (dB)
            0h        MUTE          40h        -48.000         80h       -24.000       C0h         0.000
            1h       -71.625        41h        -47.625         81h       -23.625       C1h         0.000
            2h       -71.250        42h        -47.250         82h       -23.250       C2h         0.000
            3h       -70.875        43h        -46.875         83h       -22.875       C3h         0.000
            4h       -70.500        44h        -46.500         84h       -22.500       C4h         0.000
            5h       -70.125        45h        -46.125         85h       -22.125       C5h         0.000
            6h       -69.750        46h        -45.750         86h       -21.750       C6h         0.000
            7h       -69.375        47h        -45.375         87h       -21.375       C7h         0.000
            8h       -69.000        48h        -45.000         88h       -21.000       C8h         0.000
            9h       -68.625        49h        -44.625         89h       -20.625       C9h         0.000
            Ah       -68.250        4Ah        -44.250         8Ah       -20.250       CAh         0.000
            Bh       -67.875        4Bh        -43.875         8Bh       -19.875       CBh         0.000
            Ch       -67.500        4Ch        -43.500         8Ch       -19.500      CCh          0.000
            Dh       -67.125        4Dh        -43.125         8Dh       -19.125      CDh          0.000
            Eh       -66.750        4Eh        -42.750         8Eh       -18.750       CEh         0.000
            Fh       -66.375        4Fh        -42.375         8Fh       -18.375       CFh         0.000
           10h       -66.000        50h        -42.000         90h       -18.000       D0h         0.000
           11h       -65.625        51h        -41.625         91h       -17.625       D1h         0.000
           12h       -65.250        52h        -41.250         92h       -17.250       D2h         0.000
           13h       -64.875        53h        -40.875         93h       -16.875       D3h         0.000
           14h       -64.500        54h        -40.500         94h       -16.500       D4h         0.000
           15h       -64.125        55h        -40.125         95h       -16.125       D5h         0.000
           16h       -63.750        56h        -39.750         96h       -15.750       D6h         0.000
           17h       -63.375        57h        -39.375         97h       -15.375       D7h         0.000
           18h       -63.000        58h        -39.000         98h       -15.000       D8h         0.000
           19h       -62.625        59h        -38.625         99h       -14.625       D9h         0.000
           1Ah       -62.250        5Ah        -38.250         9Ah       -14.250       DAh         0.000
           1Bh       -61.875        5Bh        -37.875         9Bh       -13.875       DBh         0.000
           1Ch       -61.500        5Ch        -37.500         9Ch       -13.500      DCh          0.000
           1Dh       -61.125        5Dh        -37.125         9Dh       -13.125      DDh          0.000
           1Eh       -60.750        5Eh        -36.750         9Eh       -12.750       DEh         0.000
           1Fh       -60.375        5Fh        -36.375         9Fh       -12.375       DFh         0.000
           20h       -60.000        60h        -36.000         A0h       -12.000       E0h         0.000
           21h       -59.625        61h        -35.625         A1h       -11.625       E1h         0.000
           22h       -59.250        62h        -35.250         A2h       -11.250       E2h         0.000
           23h       -58.875        63h        -34.875         A3h       -10.875       E3h         0.000
           24h       -58.500        64h        -34.500         A4h       -10.500       E4h         0.000
           25h       -58.125        65h        -34.125         A5h       -10.125       E5h         0.000
           26h       -57.750        66h        -33.750         A6h        -9.750       E6h         0.000
           27h       -57.375        67h        -33.375         A7h        -9.375       E7h         0.000
           28h       -57.000        68h        -33.000         A8h        -9.000       E8h         0.000
           29h       -56.625        69h        -32.625         A9h        -8.625       E9h         0.000
           2Ah       -56.250        6Ah        -32.250         AAh        -8.250       EAh         0.000
           2Bh       -55.875        6Bh        -31.875         ABh        -7.875       EBh         0.000
           2Ch       -55.500        6Ch        -31.500         ACh        -7.500       ECh         0.000
           2Dh       -55.125        6Dh        -31.125         ADh        -7.125       EDh         0.000
           2Eh       -54.750        6Eh        -30.750         AEh        -6.750       EEh         0.000
           2Fh       -54.375        6Fh        -30.375         AFh        -6.375       EFh         0.000
           30h       -54.000        70h        -30.000         B0h        -6.000       F0h         0.000
           31h       -53.625        71h        -29.625         B1h        -5.625       F1h         0.000
           32h       -53.250        72h        -29.250         B2h        -5.250       F2h         0.000
           33h       -52.875        73h        -28.875         B3h        -4.875       F3h         0.000
           34h       -52.500        74h        -28.500         B4h        -4.500       F4h         0.000
           35h       -52.125        75h        -28.125         B5h        -4.125       F5h         0.000
           36h       -51.750        76h        -27.750         B6h        -3.750       F6h         0.000
           37h       -51.375        77h        -27.375         B7h        -3.375       F7h         0.000
           38h       -51.000        78h        -27.000         B8h        -3.000       F8h         0.000
           39h       -50.625        79h        -26.625         B9h        -2.625       F9h         0.000
           3Ah       -50.250        7Ah        -26.250         BAh        -2.250       FAh         0.000
           3Bh       -49.875        7Bh        -25.875         BBh        -1.875       FBh         0.000
           3Ch       -49.500        7Ch        -25.500         BCh        -1.500       FCh         0.000
           3Dh       -49.125        7Dh        -25.125         BDh        -1.125       FDh         0.000
           3Eh       -48.750        7Eh        -24.750         BEh        -0.750       FEh         0.000
           3Fh       -48.375        7Fh        -24.375         BFh        -0.375       FFh         0.000
                     Table 44 AIF1 Input Path Digital Volume Range
                                                                                         PP, March 2014, Rev 3.5
w
                                                                                                            100


Pre-Production                                                                                           WM8958
               AIF1 - INPUT PATH SOFT MUTE CONTROL
               The WM8958 provides a soft mute function for each of the AIF1 interface input paths. When the soft-
               mute function is selected, the WM8958 gradually attenuates the associated signal paths until the path
               is entirely muted.
               When the soft-mute function is de-selected, the gain will either return instantly to the digital gain
               setting, or will gradually ramp back to the digital gain setting, depending on the applicable
               _UNMUTE_RAMP register field.
               The mute and un-mute ramp rate is selectable between two different rates.
               The AIF1 input paths are soft-muted by default. To play back an audio signal, the soft-mute must first
               be de-selected by setting the applicable Mute bit to 0.
               The soft un-mute would typically be used during playback of audio data so that when the Mute is
               subsequently disabled, a smooth transition is scheduled to the previous volume level and pop noise is
               avoided. This is desirable when resuming playback after pausing during a track.
               The soft un-mute would typically not be required when un-muting at the start of a music file, in order
               that the first part of the music track is not attenuated. The instant un-mute behaviour is desirable in
               this case, when starting playback of a new track. See “DAC Soft Mute and Soft Un-Mute” (Figure 29)
               for an illustration of the soft mute function.
                   REGISTER            BIT      LABEL       DEFAULT                     DESCRIPTION
                   ADDRESS
                 R1056 (0420h)          9     AIF1DAC1_         1      AIF1DAC1 input path (AIF1, Timeslot 0) Soft
                 AIF1 DAC1                    MUTE                     Mute Control
                 Filters (1)                                           0 = Un-mute
                                                                       1 = Mute
                                        5     AIF1DAC1_         0      AIF1DAC1 input path (AIF1, Timeslot 0) Soft
                                              MUTERAT                  Mute Ramp Rate
                                              E                        0 = Fast ramp (fs/2, maximum ramp time is
                                                                       10.7ms at fs=48k)
                                                                       1 = Slow ramp (fs/32, maximum ramp time is
                                                                       171ms at fs=48k)
                                                                       (Note: ramp rate scales with sample rate.)
                                        4     AIF1DAC1_         0      AIF1DAC1 input path (AIF1, Timeslot 0)
                                              UNMUTE_                  Unmute Ramp select
                                              RAMP                     0 = Disabling soft-mute (AIF1DAC1_MUTE=0)
                                                                       will cause the volume to change immediately to
                                                                       AIF1DAC1L_VOL and AIF1DAC1R_VOL
                                                                       settings
                                                                       1 = Disabling soft-mute (AIF1DAC1_MUTE=0)
                                                                       will cause the DAC volume to ramp up
                                                                       gradually to the AIF1DAC1L_VOL and
                                                                       AIF1DAC1R_VOL settings
                 R1058 (0422h)          9     AIF1DAC2_         1      AIF1DAC2 input path (AIF1, Timeslot 1) Soft
                 AIF1 DAC2                    MUTE                     Mute Control
                 Filters (1)                                           0 = Un-mute
                                                                       1 = Mute
                                        5     AIF1DAC2_         0      AIF1DAC2 input path (AIF1, Timeslot 1) Soft
                                              MUTERAT                  Mute Ramp Rate
                                              E                        0 = Fast ramp (fs/2, maximum ramp time is
                                                                       10.7ms at fs=48k)
                                                                       1 = Slow ramp (fs/32, maximum ramp time is
                                                                       171ms at fs=48k)
                                                                       (Note: ramp rate scales with sample rate.)
                                        4     AIF1DAC2_         0      AIF1DAC2 input path (AIF1, Timeslot 1)
                                              UNMUTE_                  Unmute Ramp select
                                              RAMP                     0 = Disabling soft-mute (AIF1DAC2_MUTE=0)
                                                                       will cause the volume to change immediately to
                                                                       AIF1DAC2L_VOL and AIF1DAC2R_VOL
                                                                       settings
                                                                                              PP, March 2014, Rev 3.5
w
                                                                                                                  101


WM8958                                                                                          Pre-Production
           REGISTER          BIT       LABEL      DEFAULT                      DESCRIPTION
           ADDRESS
                                                              1 = Disabling soft-mute (AIF1DAC2_MUTE=0)
                                                              will cause the DAC volume to ramp up
                                                              gradually to the AIF1DAC2L_VOL and
                                                              AIF1DAC2R_VOL settings
       Table 45 AIF1 Input Path Soft Mute Control
       AIF1 - INPUT PATH NOISE GATE CONTROL
       The WM8958 provides a digital noise gate function for the AIF1 input paths. The noise gate ensures
       best noise performance when the signal path is idle. When the noise gate is enabled, and the signal
       level is below the noise gate threshold, then the noise gate is activated, causing the signal path to be
       muted.
       The AIF1 Timeslot 0 input path noise gate is enabled using the AIF1DAC1_NG_ENA register. The
       AIF1 Timeslot 1 input path noise gate is enabled using the AIF1DAC2_NG_ENA register.
       The noise gate threshold (the signal level below which the noise gate is activated) is set using
       AIF1DAC1_NG_THR or AIF1DAC2_NG_THR.
       To prevent erroneous triggering, a time delay is applied before the gate is activated; the signal path is
       only muted when the signal level stays below the threshold for longer than ‘hold time’, determined by
       the AIF1DAC1_NG_HLD or AIF1DAC2_NG_HLD registers.
       When the noise gate is activated, the WM8958 gradually attenuates the associated AIF1 input signal
       paths until each is entirely muted. When the signal level increases, and the noise gate is de-activated,
       the gain will return to the AIF1DACnL_VOL and AIF1DACnR_VOL digital gain settings (where n = 1
       for AIF1 Timeslot 0, and n = 2 for AIF1 Timeslot 1). The un-mute behaviour can be immediate or
       gradual; this is determined by the AIF1DACn_MUTERATE and AIF1DACn_UNMUTE_RAMP registers
       described in Table 45.
           REGISTER          BIT       LABEL      DEFAULT                      DESCRIPTION
           ADDRESS
         R1072 (0430h)       6:5    AIF1DAC1_        11       AIF1DAC1 input path (AIF1, Timeslot 0) Noise
         AIF1 DAC1                  NG_HLD                    Gate Hold Time
         Noise Gate                 [1:0]                     (delay before noise gate is activated)
                                                              00 = 30ms
                                                              01 = 125ms
                                                              10 = 250ms
                                                              11 = 500ms
                             3:1    AIF1DAC1_       100       AIF1DAC1 input path (AIF1, Timeslot 0) Noise
                                    NG_THR                    Gate Threshold
                                    [2:0]                     000 = -60dB
                                                              001 = -66dB
                                                              010 = -72dB
                                                              011 = -78dB
                                                              100 = -84dB
                                                              101 = -90dB
                                                              110 = -96dB
                                                              111 = -102dB
                              0     AIF1DAC1_         0       AIF1DAC1 input path (AIF1, Timeslot 0) Noise
                                    NG_ENA                    Gate Enable
                                                              0 = Disabled
                                                              1 = Enabled
         R1073 (0431h)       6:5    AIF1DAC2_        11       AIF1DAC2 input path (AIF1, Timeslot 1) Noise
         AIF1 DAC2                  NG_HLD                    Gate Hold Time
         Noise Gate                 [1:0]                     (delay before noise gate is activated)
                                                              00 = 30ms
                                                              01 = 125ms
                                                              10 = 250ms
                                                                                     PP, March 2014, Rev 3.5
w
                                                                                                           102


Pre-Production                                                                                           WM8958
                   REGISTER         BIT        LABEL       DEFAULT                    DESCRIPTION
                   ADDRESS
                                                                     11 = 500ms
                                    3:1     AIF1DAC2_         100    AIF1DAC2 input path (AIF1, Timeslot 1) Noise
                                            NG_THR                   Gate Threshold
                                            [2:0]                    000 = -60dB
                                                                     001 = -66dB
                                                                     010 = -72dB
                                                                     011 = -78dB
                                                                     100 = -84dB
                                                                     101 = -90dB
                                                                     110 = -96dB
                                                                     111 = -102dB
                                     0      AIF1DAC2_           0    AIF1DAC2 input path (AIF1, Timeslot 1) Noise
                                            NG_ENA                   Gate Enable
                                                                     0 = Disabled
                                                                     1 = Enabled
               Table 46 AIF1 Input Path Noise Gate Control
               AIF1 - INPUT PATH MONO MIX CONTROL
               A digital mono mix can be selected on one or both pairs of AIF1 input channels. The mono mix is
               generated as the sum of the Left and Right AIF channel data. When the mono mix function is enabled,
               the combined mono signal is applied to the Left channel and the Right channel of the respective AIF1
               signal processing and digital mixing paths. To prevent clipping, 6dB attenuation is applied to the mono
               mix.
                   REGISTER         BIT        LABEL        DEFAULT                    DESCRIPTION
                   ADDRESS
                 R1056 (0420h)       7      AIF1DAC1_             0    AIF1DAC1 input path (AIF1, Timeslot 0) Mono
                 AIF1 DAC1                  MONO                       Mix Control
                 Filters (1)                                           0 = Disabled
                                                                       1 = Enabled
                 R1058 (0422h)       7      AIF1DAC2_             0    AIF1DAC2 input path (AIF1, Timeslot 1) Mono
                 AIF1 DAC2                  MONO                       Mix Control
                 Filters (1)                                           0 = Disabled
                                                                       1 = Enabled
               Table 47 AIF1 Input Path Mono Mix Control
               AIF2 - OUTPUT PATH VOLUME CONTROL
               The AIF2 interface supports two output channels. A digital volume control is provided on each output
               signal path, allowing attenuation in the range -71.625dB to +17.625dB in 0.375dB steps. The level of
               attenuation for an eight-bit code X is given by:
               0.375  (X-192) dB for 1  X  239;        MUTE for X = 0     +17.625dB for 239  X  255
               The AIF2ADC_VU bit controls the loading of digital volume control data. When AIF2ADC_VU bit is set
               to 0, the AIF2ADCL_VOL and AIF2ADCR_VOL control data will be loaded into the respective control
               register, but will not actually change the digital gain setting. Both left and right gain settings are
               updated when a 1 is written to AIF2ADC_VU. This makes it possible to update the gain of left and
               right channels simultaneously.
                                                                                            PP, March 2014, Rev 3.5
w
                                                                                                                   103


WM8958                                                                                              Pre-Production
           REGISTER        BIT         LABEL        DEFAULT                       DESCRIPTION
           ADDRESS
         R1280              8       AIF2ADC_V          N/A       AIF2ADC output path Volume Update
         (0500h)                    U                            Writing a 1 to this bit will cause the AIF2ADCL
         AIF2 ADC                                                and AIF2ADCR volume to be updated
         Left Volume                                             simultaneously
                           7:0      AIF2ADCL_          C0h       AIF2ADC (Left) output path Digital Volume
                                    VOL [7:0]         (0dB)      00h = MUTE
                                                                 01h = -71.625dB
                                                                 … (0.375dB steps)
                                                                 EFh = +17.625dB
                                                                 (See Table 40 for volume range)
         R1281              8       AIF2ADC_V          N/A       AIF2ADC output path Volume Update
         (0501h)                    U                            Writing a 1 to this bit will cause the AIF2ADCL
         AIF2 ADC                                                and AIF2ADCR volume to be updated
         Right Volume                                            simultaneously
                           7:0      AIF2ADCR_          C0h       AIF2ADC (Right) output path Digital Volume
                                    VOL [7:0]         (0dB)      00h = MUTE
                                                                 01h = -71.625dB
                                                                 … (0.375dB steps)
                                                                 EFh = +17.625dB
                                                                 (See Table 40 for volume range)
       Table 48 AIF2 Output Path Volume Control
       AIF2 - OUTPUT PATH HIGH PASS FILTER
       A digital high-pass filter can be enabled in the AIF2 output paths to remove DC offsets. This filter is
       enabled independently in the two AIF2 output channels using the register bits described in Table 49.
       The HPF cut-off frequency for the AIF2 channels is set using AIF2ADC_HPF_CUT.
       In hi-fi mode, the high pass filter is optimised for removing DC offsets without degrading the bass
       response and has a cut-off frequency of 3.7Hz when the sample rate (fs) = 44.1kHz.
       In voice modes, the high pass filter is optimised for voice communication; it is recommended to set the
       cut-off frequency below 300Hz.
       Note that the cut-off frequencies scale with the AIF2 sample rate. (The AIF2 sample rate is set using
       the AIF2_SR register, as described in the “Clocking and Sample Rates” section.) See Table 42 for the
       HPF cut-off frequencies at all supported sample rates.
           REGISTER         BIT        LABEL        DEFAULT                       DESCRIPTION
           ADDRESS
         R1296 (0510h)    14:13     AIF2ADC_H           00       AIF2ADC output path Digital HPF Cut-Off
         AIF2 ADC                   PF_CUT                       Frequency (fc)
         Filters                    [1:0]                        00 = Hi-fi mode (fc = 4Hz at fs = 48kHz)
                                                                 01 = Voice mode 1 (fc = 127Hz at fs = 8kHz)
                                                                 10 = Voice mode 2 (fc = 130Hz at fs = 8kHz)
                                                                 11 = Voice mode 3 (fc = 267Hz at fs = 8kHz)
                            12      AIF2ADCL_            0       AIF2ADC (Left) output path Digital HPF
                                    HPF                          Enable
                                                                 0 = Disabled
                                                                 1 = Enabled
                            11      AIF2ADCR_            0       AIF2ADC (Right) output path Digital HPF
                                    HPF                          Enable
                                                                 0 = Disabled
                                                                 1 = Enabled
       Table 49 AIF2 Output Path High Pass Filter
                                                                                         PP, March 2014, Rev 3.5
w
                                                                                                              104


Pre-Production                                                                                                 WM8958
               AIF2 - INPUT PATH VOLUME CONTROL
               The AIF2 interface supports two input channels. A digital volume control is provided on each input
               signal path, allowing attenuation in the range -71.625dB to 0dB in 0.375dB steps. The level of
               attenuation for an eight-bit code X is given by:
               0.375  (X-192) dB for 1  X  192;         MUTE for X = 0       0dB for 192  X  255
               The AIF2DAC_VU bit controls the loading of digital volume control data. When AIF2DAC_VU bit is set
               to 0, the AIF2DACL_VOL and AIF2DACR_VOL control data will be loaded into the respective control
               register, but will not actually change the digital gain setting. Both left and right gain settings are
               updated when a 1 is written to AIF2DAC_VU. This makes it possible to update the gain of left and
               right channels simultaneously.
               Note that a digital gain function is also available at the audio interface input, to boost the DAC volume
               when a small signal is received on DACDAT2. See “Digital Audio Interface Control” for further details.
               Digital volume control is also possible at the DAC stage of the signal path, after the audio signal has
               passed through the DAC digital mixers. See “Digital to Analogue Converter (DAC)” for further details.
                   REGISTER         BIT        LABEL        DEFAULT                        DESCRIPTION
                    ADDRESS
                  R1282              8      AIF2DAC_V           N/A       AIF2DAC input path Volume Update
                  (0502h)                   U                             Writing a 1 to this bit will cause the AIF2DACL
                  AIF2 DAC                                                and AIF2DACR volume to be updated
                  Left Volume                                             simultaneously
                                    7:0     AIF2DACL_           C0h       AIF2DAC (Left) input path Digital Volume
                                            VOL [7:0]          (0dB)      00h = MUTE
                                                                          01h = -71.625dB
                                                                          … (0.375dB steps)
                                                                          C0h = 0dB
                                                                          FFh = 0dB
                                                                          (See Table 44 for volume range)
                  R1283              8      AIF2DAC_V           N/A       AIF2DAC input path Volume Update
                  (0503h)                   U                             Writing a 1 to this bit will cause the AIF2DACL
                  AIF2 DAC                                                and AIF2DACR volume to be updated
                  Right Volume                                            simultaneously
                                    7:0     AIF2DACR_           C0h       AIF2DAC (Right) input path Digital Volume
                                            VOL [7:0]          (0dB)      00h = MUTE
                                                                          01h = -71.625dB
                                                                          … (0.375dB steps)
                                                                          C0h = 0dB
                                                                          FFh = 0dB
                                                                          (See Table 44 for volume range)
               Table 50 AIF2 Input Path Volume Control
                                                                                                  PP, March 2014, Rev 3.5
w
                                                                                                                       105


WM8958                                                                                          Pre-Production
       AIF2 - INPUT PATH SOFT MUTE CONTROL
       The WM8958 provides a soft mute function for each of the AIF2 interface input paths. When the soft-
       mute function is selected, the WM8958 gradually attenuates the associated signal paths until the path
       is entirely muted.
       When the soft-mute function is de-selected, the gain will either return instantly to the digital gain
       setting, or will gradually ramp back to the digital gain setting, depending on the
       AIF2DAC_UNMUTE_RAMP register field.
       The mute and un-mute ramp rate is selectable between two different rates.
       The AIF2 input paths are soft-muted by default. To play back an audio signal, the soft-mute must first
       be de-selected by setting AIF2DAC_MUTE = 0.
       The soft un-mute would typically be used during playback of audio data so that when the Mute is
       subsequently disabled, a smooth transition is scheduled to the previous volume level and pop noise is
       avoided. This is desirable when resuming playback after pausing during a track.
       The soft un-mute would typically not be required when un-muting at the start of a music file, in order
       that the first part of the music track is not attenuated. The instant un-mute behaviour is desirable in
       this case, when starting playback of a new track. See “DAC Soft Mute and Soft Un-Mute” (Figure 29)
       for an illustration of the soft mute function.
           REGISTER            BIT       LABEL        DEFAULT                    DESCRIPTION
            ADDRESS
         R1312 (0520h)          9     AIF2DAC_M          1       AIF2DAC input path Soft Mute Control
         AIF2 DAC                     UTE                        0 = Un-mute
         Filters (1)                                             1 = Mute
                                5     AIF2DAC_M          0       AIF2DAC input path Soft Mute Ramp Rate
                                      UTERATE                    0 = Fast ramp (fs/2, maximum ramp time is
                                                                 10.7ms at fs=48k)
                                                                 1 = Slow ramp (fs/32, maximum ramp time is
                                                                 171ms at fs=48k)
                                                                 (Note: ramp rate scales with sample rate.)
                                4     AIF2DAC_U          0       AIF2DAC input path Unmute Ramp select
                                      NMUTE_RA                   0 = Disabling soft-mute (AIF2DAC_MUTE=0)
                                      MP                         will cause the volume to change immediately
                                                                 to AIF2DACL_VOL and AIF2DACR_VOL
                                                                 settings
                                                                 1 = Disabling soft-mute (AIF2DAC_MUTE=0)
                                                                 will cause the DAC volume to ramp up
                                                                 gradually to the AIF2DACL_VOL and
                                                                 AIF2DACR_VOL settings
       Table 51 AIF2 Input Path Soft Mute Control
       AIF2 - INPUT PATH NOISE GATE CONTROL
       The WM8958 provides a digital noise gate function for the AIF2 input paths. The noise gate ensures
       best noise performance when the signal path is idle. When the noise gate is enabled, and the signal
       level is below the noise gate threshold, then the noise gate is activated, causing the signal path to be
       muted.
       The AIF2 input path noise gate is enabled using the AIF2DAC_NG_ENA register.
       The noise gate threshold (the signal level below which the noise gate is activated) is set using
       AIF2DAC_NG_THR.
       To prevent erroneous triggering, a time delay is applied before the gate is activated; the signal path is
       only muted when the signal level stays below the threshold for longer than ‘hold time’, determined by
       the AIF2DAC_NG_HLD register.
       When the noise gate is activated, the WM8958 gradually attenuates the AIF2 input signal paths until
       each is entirely muted. When the signal level increases, and the noise gate is de-activated, the gain
       will return to the AIF2DACL_VOL and AIF2DACR_VOL digital gain settings. The un-mute behaviour
                                                                                      PP, March 2014, Rev 3.5
w
                                                                                                            106


Pre-Production                                                                                             WM8958
               can be immediate or gradual; this is determined by                    the   AIF2DAC_MUTERATE       and
               AIF2DAC_UNMUTE_RAMP registers described in Table 51.
                   REGISTER          BIT      LABEL        DEFAULT                      DESCRIPTION
                   ADDRESS
                R1328 (0530h)        6:5   AIF2DAC_           11       AIF2DAC input path Noise Gate Hold Time
                AIF2 DAC                   NG_HLD                      (delay before noise gate is activated)
                Noise Gate                 [1:0]
                                                                       00 = 30ms
                                                                       01 = 125ms
                                                                       10 = 250ms
                                                                       11 = 500ms
                                     3:1   AIF2DAC_          100       AIF2DAC input path Noise Gate Threshold
                                           NG_THR                      000 = -60dB
                                           [2:0]
                                                                       001 = -66dB
                                                                       010 = -72dB
                                                                       011 = -78dB
                                                                       100 = -84dB
                                                                       101 = -90dB
                                                                       110 = -96dB
                                                                       111 = -102dB
                                      0    AIF2DAC_            0       AIF2DAC input path Noise Gate Enable
                                           NG_ENA                      0 = Disabled
                                                                       1 = Enabled
               Table 52 AIF2 Input Path Noise Gate Control
               AIF2 - INPUT PATH MONO MIX CONTROL
               A digital mono mix can be selected on the AIF2 input channels. The mono mix is generated as the
               sum of the Left and Right AIF channel data. When the mono mix function is enabled, the combined
               mono signal is applied to the Left channel and the Right channel of the AIF2 signal processing and
               digital mixing paths. To prevent clipping, 6dB attenuation is applied to the mono mix.
                   REGISTER          BIT      LABEL         DEFAULT                      DESCRIPTION
                   ADDRESS
                R1312 (0520h)         7    AIF2DAC_M             0      AIF2DAC input path Mono Mix Control
                AIF2 DAC                   ONO                          0 = Disabled
                Filters (1)                                             1 = Enabled
               Table 53 AIF2 Input Path Mono Mix Control
                                                                                              PP, March 2014, Rev 3.5
w
                                                                                                                 107


WM8958                                                                                                   Pre-Production
DIGITAL TO ANALOGUE CONVERTER (DAC)
                The WM8958 DACs receive digital input data from the DAC mixers - see “Digital Mixing”. The digital
                audio data is converted to oversampled bit streams in the on-chip, true 24-bit digital interpolation
                filters. The bitstream data enters four multi-bit, sigma-delta DACs, which convert them to high quality
                analogue audio signals. The multi-bit DAC architecture reduces high frequency noise and sensitivity to
                clock jitter. It also uses a Dynamic Element Matching technique for high linearity and low distortion.
                A high performance mode of DAC operation can be selected by setting the DAC_OSR128 bit - see
                “Clocking and Sample Rates” for details.
                The analogue outputs from the DACs can be mixed with analogue line/mic inputs using the line output
                mixers MIXOUTL / MIXOUTR and the speaker output mixers SPKMIXL / SPKMIXR.
                The DACs are enabled using the register bits defined in Table 54.
                Note that the DAC clock must be enabled whenever the DACs are enabled.
                       REGISTER             BIT     LABEL          DEFAULT                 DESCRIPTION
                       ADDRESS
                   R5 (0005h)                3    DAC2L_EN             0        Left DAC2 Enable
                   Power                          A                             0 = Disabled
                   Management (5)                                               1 = Enabled
                                             2    DAC2R_EN             0        Right DAC2 Enable
                                                  A                             0 = Disabled
                                                                                1 = Enabled
                                             1    DAC1L_EN             0        Left DAC1 Enable
                                                  A                             0 = Disabled
                                                                                1 = Enabled
                                             0    DAC1R_EN             0        Right DAC1 Enable
                                                  A                             0 = Disabled
                                                                                1 = Enabled
                Table 54 DAC Enable Control
                DAC CLOCKING CONTROL
                Clocking for the DACs is derived from SYSCLK. The required clock is enabled when the
                SYSDSPCLK_ENA register is set.
                The DAC clock rate is configured automatically, according to the AIFn_SR, AIFnCLK_RATE and
                DAC_OSR128 registers. (See “Clocking and Sample Rates” for further details of the system clocks
                and control registers.)
                When AIF1CLK is selected as the SYSCLK source (SYSCLK_SRC = 0), then the DAC clocking is
                controlled by the AIF1_SR and AIF1CLK_RATE registers.
                When AIF2CLK is selected as the SYSCLK source (SYSCLK_SRC = 1), then the DAC clocking is
                controlled by the AIF2_SR and AIF2CLK_RATE registers.
                The supported DAC clocking configurations are described in Table 55 (for DAC_OSR128=0) and
                Table 56 (for DAC_OSR128=1). Under default conditions, the DAC_OSR128 bit is not set.
                                                                                              PP, March 2014, Rev 3.5
w
                                                                                                                     108


Pre-Production                                                                                          WM8958
                    SAMPLE                               SYSCLK RATE (AIFnCLK / fs ratio)
                  RATE (kHz)        128       192        256       384        512        768      1024        1536
                  8                                                                                       
                  11.025                     Note 1                                             
                  12                         Note 1                                             
                  16              Note 1     Note 1                                    
                  22.05           Note 1     Note 1                          
                  24              Note 1     Note 1                          
                  32              Note 1     Note 1                
                  44.1            Note 1     Note 1       
                  48              Note 1     Note 1       
                  88.2            Note 1
                  96              Note 1
                  When DAC_OSR128=0, DAC operation is only supported for the configurations indicated above
               Table 55 DAC Clocking - DAC_OSR128 = 0 (Default)
                    SAMPLE                               SYSCLK RATE (AIFnCLK / fs ratio)
                  RATE (kHz)        128       192        256       384        512        768      1024        1536
                  8                                                                                         
                  11.025                                                                         
                  12                                                                             
                  16                                                                   
                  22.05                      Note 1                          
                  24                         Note 1                          
                  32              Note 1     Note 1                
                  44.1            Note 1     Note 1       
                  48              Note 1     Note 1       
                  88.2            Note 1
                  96              Note 1
                  When DAC_OSR128=1, DAC operation is only supported for the configurations indicated above
               Table 56 DAC Clocking - DAC_OSR128 = 1
               Note 1 - These clocking rates are only supported for ‘simple’ DAC-only playback modes, under the
               following conditions:
                         AIF input is enabled on a single interface (AIF1 or AIF2) only, or is enabled on AIF1 and
                          AIF2 simultaneously provided AIF1 and AIF2 are synchronised (ie. AIF1CLK_SRC =
                          AIF2CLK_SRC)
                         All AIF output paths are disabled
                         All DSP functions (ReTune™ Mobile Parametric Equaliser, 3D stereo expansion and
                          Dynamic Range Control) are disabled
               The clocking requirements in Table 55 and Table 56 are only applicable to the AIFnCLK that is
               selected as the SYSCLK source. Note that both clocks (AIF1CLK and AIF2CLK) must satisfy the
               requirements noted in the “Clocking and Sample Rates” section.
               The applicable clocks (SYSCLK, and AIF1CLK or AIF2CLK) must be present and enabled when using
               the Digital to Analogue Converters (DACs).
               Note that the presence of a suitable clock is automatically detected by the WM8958; if the clock signal
               is absent, then any speaker or earpiece output driver(s) associated with the DAC signal paths will be
               disabled. (This is applicable to the SPKOUTL, SPKOUTR and HPOUT2 outputs only, whenever one
               or more DAC is routed to these output drivers.)
                                                                                             PP, March 2014, Rev 3.5
w
                                                                                                                  109


WM8958                                                                                              Pre-Production
       DAC DIGITAL VOLUME
       The output level of each DAC can be controlled digitally over a range from -71.625dB to +12dB in
       0.375dB steps. The level of attenuation for an eight-bit code X is given by:
       0.375  (X-192) dB for 1  X  224;       MUTE for X = 0;                 12dB to 224  X  255
       Each of the DACs can be muted using the soft mute control bits described in Table 57. The WM8958
       always applies a soft mute, where the volume is decreased gradually. The un-mute behaviour is
       configurable, as described in the “DAC Soft Mute and Soft Un-Mute” section.
       The DAC1_VU and DAC2_VU bits control the loading of digital volume control data. When DAC1_VU
       is set to 0, the DAC1L_VOL or DAC1R_VOL control data will be loaded into the respective control
       register, but will not actually change the digital gain setting. Both left and right gain settings are
       updated when a 1 is written to DAC1_VU. This makes it possible to update the gain of both channels
       simultaneously. A similar function for DAC2L and DAC2R is controlled by the DAC2_VU register bit.
             REGISTER           BIT        LABEL        DEFAULT                    DESCRIPTION
             ADDRESS
         R1552 (0610h)           9      DAC1L_MU            1         DAC1L Soft Mute Control
         DAC1 Left                      TE                            0 = DAC Un-mute
         Volume                                                       1 = DAC Mute
                                 8      DAC1_VU            N/A        DAC1L and DAC1R Volume Update
                                                                      Writing a 1 to this bit will cause the
                                                                      DAC1L and DAC1R volume to be
                                                                      updated simultaneously
                                7:0     DAC1L_VO           C0h        DAC1L Digital Volume
                                        L [7:0]           (0dB)       00h = MUTE
                                                                      01h = -71.625dB
                                                                      … (0.375dB steps)
                                                                      C0h = 0dB
                                                                      … (0.375dB steps)
                                                                      E0h = 12dB
                                                                      FFh = 12dB
                                                                      (See Table 58 for volume range)
         R1553 (0611h)           9      DAC1R_MU            1         DAC1R Soft Mute Control
         DAC1 Right                     TE                            0 = DAC Un-mute
         Volume                                                       1 = DAC Mute
                                 8      DAC1_VU            N/A        DAC1L and DAC1R Volume Update
                                                                      Writing a 1 to this bit will cause the
                                                                      DAC1L and DAC1R volume to be
                                                                      updated simultaneously
                                7:0     DAC1R_VO           C0h        DAC1R Digital Volume
                                        L [7:0]           (0dB)       00h = MUTE
                                                                      01h = -71.625dB
                                                                      … (0.375dB steps)
                                                                      C0h = 0dB
                                                                      … (0.375dB steps)
                                                                      E0h = 12dB
                                                                      FFh = 12dB
                                                                      (See Table 58 for volume range)
         R1554 (0612h)           9      DAC2L_MU            1         DAC2L Soft Mute Control
         DAC2 Left                      TE                            0 = DAC Un-mute
         Volume                                                       1 = DAC Mute
                                 8      DAC2_VU            N/A        DAC2L and DAC2R Volume Update
                                                                      Writing a 1 to this bit will cause the
                                                                      DAC2L and DAC2R volume to be
                                                                      updated simultaneously
                                                                                      PP, March 2014, Rev 3.5
w
                                                                                                              110


Pre-Production                                                                            WM8958
                    REGISTER         BIT     LABEL DEFAULT              DESCRIPTION
                    ADDRESS
                                     7:0  DAC2L_VO   C0h   DAC2L Digital Volume
                                          L [7:0]   (0dB)  00h = MUTE
                                                           01h = -71.625dB
                                                           … (0.375dB steps)
                                                           C0h = 0dB
                                                           … (0.375dB steps)
                                                           E0h = 12dB
                                                           FFh = 12dB
                                                           (See Table 58 for volume range)
                R1555 (0613h)         9   DAC2R_MU    1    DAC2R Soft Mute Control
                DAC2 Right                TE               0 = DAC Un-mute
                Volume                                     1 = DAC Mute
                                      8   DAC2_VU    N/A   DAC2R and DAC2R Volume Update
                                                           Writing a 1 to this bit will cause the
                                                           DAC2R and DAC2R volume to be
                                                           updated simultaneously
                                     7:0  DAC2R_VO   C0h   DAC2R Digital Volume
                                          L [7:0]   (0dB)  00h = MUTE
                                                           01h = -71.625dB
                                                           … (0.375dB steps)
                                                           C0h = 0dB
                                                           … (0.375dB steps)
                                                           E0h = 12dB
                                                           FFh = 12dB
                                                           (See Table 58 for volume range)
               Table 57 DAC Digital Volume Control
                                                                           PP, March 2014, Rev 3.5
w
                                                                                                  111


WM8958                                                                              Pre-Production
                Volume                    Volume              Volume               Volume
     DAC Volume   (dB)     DAC Volume      (dB)    DAC Volume   (dB)  DAC Volume     (dB)
          0h     MUTE          40h        -48.000      80h    -24.000    C0h         0.000
          1h    -71.625        41h        -47.625      81h    -23.625    C1h         0.375
          2h    -71.250        42h        -47.250      82h    -23.250    C2h         0.750
          3h    -70.875        43h        -46.875      83h    -22.875    C3h         1.125
          4h    -70.500        44h        -46.500      84h    -22.500    C4h         1.500
          5h    -70.125        45h        -46.125      85h    -22.125    C5h         1.875
          6h    -69.750        46h        -45.750      86h    -21.750    C6h         2.250
          7h    -69.375        47h        -45.375      87h    -21.375    C7h         2.625
          8h    -69.000        48h        -45.000      88h    -21.000    C8h         3.000
          9h    -68.625        49h        -44.625      89h    -20.625    C9h         3.375
         Ah     -68.250       4Ah         -44.250     8Ah     -20.250    CAh         3.750
         Bh     -67.875       4Bh         -43.875     8Bh     -19.875    CBh         4.125
         Ch     -67.500       4Ch         -43.500     8Ch     -19.500    CCh         4.500
         Dh     -67.125       4Dh         -43.125     8Dh     -19.125    CDh         4.875
         Eh     -66.750       4Eh         -42.750     8Eh     -18.750    CEh         5.250
         Fh     -66.375       4Fh         -42.375     8Fh     -18.375    CFh         5.625
         10h    -66.000        50h        -42.000      90h    -18.000    D0h         6.000
         11h    -65.625        51h        -41.625      91h    -17.625    D1h         6.375
         12h    -65.250        52h        -41.250      92h    -17.250    D2h         6.750
         13h    -64.875        53h        -40.875      93h    -16.875    D3h         7.125
         14h    -64.500        54h        -40.500      94h    -16.500    D4h         7.500
         15h    -64.125        55h        -40.125      95h    -16.125    D5h         7.875
         16h    -63.750        56h        -39.750      96h    -15.750    D6h         8.250
         17h    -63.375        57h        -39.375      97h    -15.375    D7h         8.625
         18h    -63.000        58h        -39.000      98h    -15.000    D8h         9.000
         19h    -62.625        59h        -38.625      99h    -14.625    D9h         9.375
        1Ah     -62.250       5Ah         -38.250     9Ah     -14.250    DAh         9.750
        1Bh     -61.875       5Bh         -37.875     9Bh     -13.875    DBh        10.125
        1Ch     -61.500       5Ch         -37.500     9Ch     -13.500    DCh        10.500
        1Dh     -61.125       5Dh         -37.125     9Dh     -13.125    DDh        10.875
        1Eh     -60.750       5Eh         -36.750     9Eh     -12.750    DEh        11.250
        1Fh     -60.375       5Fh         -36.375     9Fh     -12.375    DFh        11.625
         20h    -60.000        60h        -36.000     A0h     -12.000    E0h        12.000
         21h    -59.625        61h        -35.625     A1h     -11.625    E1h        12.000
         22h    -59.250        62h        -35.250     A2h     -11.250    E2h        12.000
         23h    -58.875        63h        -34.875     A3h     -10.875    E3h        12.000
         24h    -58.500        64h        -34.500     A4h     -10.500    E4h        12.000
         25h    -58.125        65h        -34.125     A5h     -10.125    E5h        12.000
         26h    -57.750        66h        -33.750     A6h      -9.750    E6h        12.000
         27h    -57.375        67h        -33.375     A7h      -9.375    E7h        12.000
         28h    -57.000        68h        -33.000     A8h      -9.000    E8h        12.000
         29h    -56.625        69h        -32.625     A9h      -8.625    E9h        12.000
        2Ah     -56.250       6Ah         -32.250     AAh      -8.250    EAh        12.000
        2Bh     -55.875       6Bh         -31.875     ABh      -7.875    EBh        12.000
        2Ch     -55.500       6Ch         -31.500     ACh      -7.500    ECh        12.000
        2Dh     -55.125       6Dh         -31.125     ADh      -7.125    EDh        12.000
        2Eh     -54.750       6Eh         -30.750     AEh      -6.750    EEh        12.000
        2Fh     -54.375       6Fh         -30.375     AFh      -6.375    EFh        12.000
         30h    -54.000        70h        -30.000     B0h      -6.000    F0h        12.000
         31h    -53.625        71h        -29.625     B1h      -5.625    F1h        12.000
         32h    -53.250        72h        -29.250     B2h      -5.250    F2h        12.000
         33h    -52.875        73h        -28.875     B3h      -4.875    F3h        12.000
         34h    -52.500        74h        -28.500     B4h      -4.500    F4h        12.000
         35h    -52.125        75h        -28.125     B5h      -4.125    F5h        12.000
         36h    -51.750        76h        -27.750     B6h      -3.750    F6h        12.000
         37h    -51.375        77h        -27.375     B7h      -3.375    F7h        12.000
         38h    -51.000        78h        -27.000     B8h      -3.000    F8h        12.000
         39h    -50.625        79h        -26.625     B9h      -2.625    F9h        12.000
        3Ah     -50.250       7Ah         -26.250     BAh      -2.250    FAh        12.000
        3Bh     -49.875       7Bh         -25.875     BBh      -1.875    FBh        12.000
        3Ch     -49.500       7Ch         -25.500     BCh      -1.500    FCh        12.000
        3Dh     -49.125       7Dh         -25.125     BDh      -1.125    FDh        12.000
        3Eh     -48.750       7Eh         -24.750     BEh      -0.750    FEh        12.000
        3Fh     -48.375       7Fh         -24.375     BFh      -0.375    FFh        12.000
                 Table 58 DAC Digital Volume Range
                                                                           PP, March 2014, Rev 3.5
w
                                                                                              112


Pre-Production                                                                                                                               WM8958
                                        DAC SOFT MUTE AND SOFT UN-MUTE
                                        The WM8958 has a soft mute function which ensures that a gradual attenuation is applied to the DAC
                                        outputs when the mute is asserted. The soft mute rate can be selected using the DAC_MUTERATE
                                        bit.
                                        When a mute bit is disabled, the gain will either gradually ramp back up to the digital gain setting, or
                                        return instantly to the digital gain setting, depending on the DAC_SOFTMUTEMODE register bit. If the
                                        gradual un-mute ramp is selected (DAC_SOFTMUTEMODE = 1), then the un-mute rate is determined
                                        by the DAC_MUTERATE bit.
                                        Note that each DAC is soft-muted by default. To play back an audio signal, the mute must first be
                                        disabled by setting the applicable mute control to 0 (see Table 57).
                                        Soft Mute Mode would typically be enabled (DAC_SOFTMUTEMODE = 1) when using mute during
                                        playback of audio data so that when the mute is subsequently disabled, the volume increase will not
                                        create pop noise by jumping immediately to the previous volume level (e.g. resuming playback after
                                        pausing during a track).
                                        Soft Mute Mode would typically be disabled (DAC_SOFTMUTEMODE = 0) when un-muting at the
                                        start of a music file, in order that the first part of the track is not attenuated (e.g. when starting
                                        playback of a new track, or resuming playback after pausing between tracks).
                                        The DAC soft-mute function is illustrated in Figure 29 for DAC1L and DAC1R. The same function is
                                        applicable to DAC2L and DAC2R also.
                                                                                                DAC muting and un-muting using volume control bits
                                                                                                DAC1L_VOL and DAC1R_VOL
      DAC1L_VOL or DAC1R_VOL = [non-zero]                = 00000000             = [non-zero]
                                                                                                DAC muting and un-muting using soft mute bits
                                                                                                DAC1L_MUTE or DAC1R_MUTE
                                                                                                Soft mute mode not enabled (DAC_SOFTMUTEMODE = 0).
                                             DAC_SOFTMUTEMODE = 0
              DAC1L_MUTE = 0                           DAC1L_MUTE = 1         DAC1L_MUTE = 0
              DAC1R_MUTE = 0                           DAC1R_MUTE = 1         DAC1R_MUTE = 0
                                                                                                DAC muting and un-muting using soft mute bit DAC_MUTE.
                                                                                                Soft mute mode enabled (DAC_SOFTMUTEMODE = 1).
                                             DAC_SOFTMUTEMODE = 1
               DAC1L_MUTE = 0                          DAC1L_MUTE = 1         DAC1L_MUTE = 0
              DAC1R_MUTE = 0                           DAC1R_MUTE = 1         DAC1R_MUTE = 0
Figure 29 DAC Soft Mute Control
                                                                                                                             PP, March 2014, Rev 3.5
w
                                                                                                                                                     113


WM8958                                                                                        Pre-Production
       The DAC Soft Mute register controls are defined in Table 59.
       The volume ramp rate during soft mute and un-mute is controlled by the DAC_MUTERATE bit. Ramp
       rates of fs/32 and fs/2 are selectable. The ramp rate determines the rate at which the volume will be
       increased or decreased. Note that the actual ramp time depends on the extent of the difference
       between the muted and un-muted volume settings.
            REGISTER            BIT       LABEL        DEFAULT                  DESCRIPTION
             ADDRESS
         R1556 (0614h)           1     DAC_SOFT            0        DAC Unmute Ramp select
         DAC Softmute                  MUTEMODE                     0 = Disabling soft-mute
                                                                    (DAC[1/2][L/R]_MUTE=0) will cause
                                                                    the DAC volume to change
                                                                    immediately to DAC[1/2][L/R]_VOL
                                                                    settings
                                                                    1 = Disabling soft-mute
                                                                    (DAC[1/2][L/R]_MUTE=0) will cause
                                                                    the DAC volume to ramp up gradually
                                                                    to the DAC[1/2][L/R]_VOL settings
                                 0     DAC_MUTE            0        DAC Soft Mute Ramp Rate
                                       RATE                         0 = Fast ramp (fs/2, maximum ramp
                                                                    time is 10.7ms at fs=48k)
                                                                    1 = Slow ramp (fs/32, maximum ramp
                                                                    time is 171ms at fs=48k)
                                                                    (Note: ramp rate scales with sample
                                                                    rate.)
       Table 59 DAC Soft-Mute Control
                                                                                   PP, March 2014, Rev 3.5
w
                                                                                                        114


Pre-Production                                                                                               WM8958
ANALOGUE OUTPUT SIGNAL PATH
               The WM8958 output routing and mixers provide a high degree of flexibility, allowing operation of many
               simultaneous signal paths through the device to a variety of analogue outputs. The outputs include a
               ground referenced headphone driver, two switchable Class D/AB loudspeaker drivers, an ear speaker
               driver and four highly flexible line drivers. See “Analogue Outputs” for further details of these outputs.
               The WM8958 output signal paths and control registers are illustrated in Figure 30.
               Figure 30 Control Registers for Output Signal Path
                                                                                                PP, March 2014, Rev 3.5
w
                                                                                                                      115


WM8958                                                                                          Pre-Production
       OUTPUT SIGNAL PATHS ENABLE
       The output mixers and drivers can be independently enabled and disabled as described in Table 60.
       The supply rails for headphone outputs HPOUT1L and HPOUT1R are generated using an integrated
       dual-mode Charge Pump, which must be enabled whenever the headphone outputs are used. See the
       “Charge Pump” section for details on enabling and configuring this circuit.
       Note that the headphone outputs HPOUT1L and HPOUT1R have dedicated output PGAs and volume
       controls. As a result, a low power consumption DAC playback path can be supported without needing
       to enable the output mixers MIXOUTL / MIXOUTR or the mixer output PGAs MIXOUTLVOL /
       MIXOUTRVOL.
       Note that the Headphone Outputs are also controlled by fields located within Register R96, which
       provide suppression of pops & clicks when enabling and disabling the HPOUT1L and HPOUT1R
       signal paths. These registers are described in the following “Headphone Signal Paths Enable” section.
       Under recommended usage conditions, the Headphone Pop Suppression control bits will be
       configured by scheduling the default Start-Up and Shutdown sequences as described in the “Control
       Write Sequencer” section. In these cases, the user does not need to set the register fields in R1 and
       R96 directly.
       For normal operation of the output signal paths, the reference voltage VMID and the bias current must
       also be enabled. See “Reference Voltages and Master Bias” for details of the associated controls
       VMID_SEL and BIAS_ENA.
          REGISTER        BIT             LABEL              DEFAULT               DESCRIPTION
           ADDRESS
         R1 (0001h)        13      SPKOUTR_ENA                   0      SPKMIXR Mixer, SPKRVOL PGA
         Power                                                          and SPKOUTR Output Enable
         Management                                                     0 = Disabled
         (1)                                                            1 = Enabled
                           12      SPKOUTL_ENA                   0      SPKMIXL Mixer, SPKLVOL PGA
                                                                        and SPKOUTL Output Enable
                                                                        0 = Disabled
                                                                        1 = Enabled
                           11      HPOUT2_ENA                    0      HPOUT2 Output Stage Enable
                                                                        0 = Disabled
                                                                        1 = Enabled
                            9      HPOUT1L_ENA                   0      Enables HPOUT1L input stage
                                                                        0 = Disabled
                                                                        1 = Enabled
                                                                        For normal operation, this bit should
                                                                        be set as the first step of the
                                                                        HPOUT1L Enable sequence.
                            8      HPOUT1R_ENA                   0      Enables HPOUT1R input stage
                                                                        0 = Disabled
                                                                        1 = Enabled
                                                                        For normal operation, this bit should
                                                                        be set as the first step of the
                                                                        HPOUT1R Enable sequence.
         R3 (0003h)        13      LINEOUT1N_ENA                 0      LINEOUT1N Line Out and
         Power                                                          LINEOUT1NMIX Enable
         Management                                                     0 = Disabled
         (3)                                                            1 = Enabled
                           12      LINEOUT1P_ENA                 0      LINEOUT1P Line Out and
                                                                        LINEOUT1PMIX Enable
                                                                        0 = Disabled
                                                                        1 = Enabled
                           11      LINEOUT2N_ENA                 0      LINEOUT2N Line Out and
                                                                        LINEOUT2NMIX Enable
                                                                        0 = Disabled
                                                                        1 = Enabled
                                                                                    PP, March 2014, Rev 3.5
w
                                                                                                          116


Pre-Production                                                                     WM8958
                 REGISTER      BIT           LABEL   DEFAULT           DESCRIPTION
                 ADDRESS
                                10    LINEOUT2P_ENA     0    LINEOUT2P Line Out and
                                                             LINEOUT2PMIX Enable
                                                             0 = Disabled
                                                             1 = Enabled
                                 9    SPKRVOL_ENA       0    SPKMIXR Mixer and SPKRVOL
                                                             PGA Enable
                                                             0 = Disabled
                                                             1 = Enabled
                                                             Note that SPKMIXR and SPKRVOL
                                                             are also enabled when
                                                             SPKOUTR_ENA is set.
                                 8    SPKLVOL_ENA       0    SPKMIXL Mixer and SPKLVOL
                                                             PGA Enable
                                                             0 = Disabled
                                                             1 = Enabled
                                                             Note that SPKMIXL and SPKLVOL
                                                             are also enabled when
                                                             SPKOUTL_ENA is set.
                                 7    MIXOUTLVOL_ENA    0    MIXOUTL Left Volume Control
                                                             Enable
                                                             0 = Disabled
                                                             1 = Enabled
                                 6    MIXOUTRVOL_ENA    0    MIXOUTR Right Volume Control
                                                             Enable
                                                             0 = Disabled
                                                             1 = Enabled
                                 5    MIXOUTL_ENA       0    MIXOUTL Left Output Mixer Enable
                                                             0 = Disabled
                                                             1 = Enabled
                                 4    MIXOUTR_ENA       0    MIXOUTR Right Output Mixer
                                                             Enable
                                                             0 = Disabled
                                                             1 = Enabled
                R56 (0038h)      6    HPOUT2_IN_ENA     0    HPOUT2MIX Mixer and Input Stage
                AntiPOP (1)                                  Enable
                                                             0 = Disabled
                                                             1 = Enabled
               Table 60 Output Signal Paths Enable
                                                                        PP, March 2014, Rev 3.5
w
                                                                                           117


WM8958                                                                                         Pre-Production
       HEADPHONE SIGNAL PATHS ENABLE
       The HPOUT1L and HPOUT1R output paths can be actively discharged to AGND through internal
       resistors if desired. This is desirable at start-up in order to achieve a known output stage condition
       prior to enabling the VMID reference voltage. This is also desirable in shutdown to prevent the
       external connections from being affected by the internal circuits. The HPOUT1L and HPOUT1R
       outputs are shorted to AGND by default; the short circuit is removed on each of these paths by setting
       the applicable fields HPOUT1L_RMV_SHORT or HPOUT1R_RMV_SHORT.
       The ground-referenced Headphone output drivers are designed to suppress pops and clicks when
       enabled or disabled. However, it is necessary to control the drivers in accordance with a defined
       sequence in start-up and shutdown to achieve the pop suppression. It is also necessary to schedule
       the DC Servo offset correction at the appropriate point in the sequence (see “DC Servo”). Table 61
       and Table 62 describe the recommended sequences for enabling and disabling these output drivers.
                SEQUENCE                     HEADPHONE ENABLE
         Step 1                         HPOUT1L_ENA = 1
                                        HPOUT1R_ENA = 1
         Step 2
                                        20s delay
         Step 3                         HPOUT1L_DLY = 1
                                        HPOUT1R_DLY = 1
         Step 4
                                        DC offset correction
         Step 5                         HPOUT1L_OUTP = 1
                                        HPOUT1L_RMV_SHORT = 1
                                        HPOUT1R_OUTP = 1
                                        HPOUT1R_RMV_SHORT = 1
       Table 61 Headphone Output Enable Sequence
                SEQUENCE                    HEADPHONE DISABLE
         Step 1                         HPOUT1L_RMV_SHORT = 0
                                        HPOUT1L_DLY = 0
                                        HPOUT1L_OUTP = 0
                                        HPOUT1R_RMV_SHORT = 0
                                        HPOUT1R_DLY = 0
                                        HPOUT1R_OUTP = 0
         Step 2                         HPOUT1L_ENA = 0
                                        HPOUT1R_ENA = 0
       Table 62 Headphone Output Disable Sequence
       The register bits relating to pop suppression control are defined in Table 63.
                                                                                      PP, March 2014, Rev 3.5
w
                                                                                                         118


Pre-Production                                                                               WM8958
                 REGISTER      BIT         LABEL         DEFAULT             DESCRIPTION
                  ADDRESS
                R1 (0001h)      9     HPOUT1L_ENA             0  Enables HPOUT1L input stage
                Power                                            0 = Disabled
                Management                                       1 = Enabled
                (1)
                                                                 For normal operation, this bit should
                                                                 be set as the first step of the
                                                                 HPOUT1L Enable sequence.
                                8     HPOUT1R_ENA             0  Enables HPOUT1R input stage
                                                                 0 = Disabled
                                                                 1 = Enabled
                                                                 For normal operation, this bit should
                                                                 be set as the first step of the
                                                                 HPOUT1R Enable sequence.
                R96 (0060h)     7     HPOUT1L_RMV_            0  Removes HPOUT1L short
                Analogue HP           SHORT                      0 = HPOUT1L short enabled
                (1)                                              1 = HPOUT1L short removed
                                                                 For normal operation, this bit should
                                                                 be set as the final step of the
                                                                 HPOUT1L Enable sequence.
                                6     HPOUT1L_OUTP            0  Enables HPOUT1L output stage
                                                                 0 = Disabled
                                                                 1 = Enabled
                                                                 For normal operation, this bit should
                                                                 be set to 1 after the DC offset
                                                                 cancellation has been scheduled.
                                5     HPOUT1L_DLY             0  Enables HPOUT1L intermediate stage
                                                                 0 = Disabled
                                                                 1 = Enabled
                                                                 For normal operation, this bit should
                                                                 be set to 1 after the output signal path
                                                                 has been configured, and before DC
                                                                 offset cancellation is scheduled. This
                                                                 bit should be set with at least 20us
                                                                 delay after HPOUT1L_ENA.
                                3     HPOUT1R_RMV_            0  Removes HPOUT1R short
                                      SHORT                      0 = HPOUT1R short enabled
                                                                 1 = HPOUT1R short removed
                                                                 For normal operation, this bit should
                                                                 be set as the final step of the
                                                                 HPOUT1R Enable sequence.
                                2     HPOUT1R_OUTP            0  Enables HPOUT1R output stage
                                                                 0 = Disabled
                                                                 1 = Enabled
                                                                 For normal operation, this bit should
                                                                 be set to 1 after the DC offset
                                                                 cancellation has been scheduled.
                                1     HPOUT1R_DLY             0  Enables HPOUT1R intermediate stage
                                                                 0 = Disabled
                                                                 1 = Enabled
                                                                 For normal operation, this bit should
                                                                 be set to 1 after the output signal path
                                                                 has been configured, and before DC
                                                                 offset cancellation is scheduled. This
                                                                 bit should be set with at least 20us
                                                                 delay after HPOUT1R_ENA.
               Table 63 Headphone Output Signal Paths Control
                                                                               PP, March 2014, Rev 3.5
w
                                                                                                      119


WM8958                                                                                      Pre-Production
       OUTPUT MIXER CONTROL
       The Output Mixer path select and volume controls are described in Table 64 for the Left Channel
       (MIXOUTL) and Table 65 for the Right Channel (MIXOUTR). The gain of each of input path may be
       controlled independently in the range 0dB to -9dB.
       Note that the DAC input levels may also be controlled by the DAC digital volume controls (see “Digital
       to Analogue Converter (DAC)”) and the Audio Interface digital volume controls (see “Digital Volume
       and Filter Control”).
       When using the IN2LP, IN2LN, IN2RP or IN2RN signal paths to the output mixers, the buffered VMID
       reference must be enabled, using the VMID_BUF_ENA register, as described in “Reference Voltages
       and Master Bias”.
           REGISTER         BIT           LABEL            DEFAULT               DESCRIPTION
           ADDRESS
         R45 (002Dh)         5   IN2RN_TO_MIXOUTL              0      IN2RN to MIXOUTL Mute
         Output Mixer                                                 0 = Mute
         (1)                                                          1 = Un-mute
                                                                      Note that VMID_BUF_ENA must be
                                                                      set when using the IN2RN input to
                                                                      MIXOUTL.
         R49 (0031h)        8:6  IN2RN_MIXOUTL_VOL            000     IN2RN to MIXOUTL Volume
         Output Mixer            [2:0]                                0dB to -9dB in 3dB steps
         (5)                                                          X00 = 0dB
                                                                      X01 = -3dB
                                                                      X10 = -6dB
                                                                      X11 = -9dB
         R45 (002Dh)         4   IN2LN_TO_MIXOUTL              0      IN2LN to MIXOUTL Mute
         Output Mixer                                                 0 = Mute
         (1)                                                          1 = Un-mute
                                                                      Note that VMID_BUF_ENA must be
                                                                      set when using the IN2LN input to
                                                                      MIXOUTL.
         R47 (002Fh)        8:6  IN2LN_MIXOUTL_VOL            000     IN2LN to MIXOUTL Volume
         Output Mixer            [2:0]                                0dB to -9dB in 3dB steps
         (3)                                                          X00 = 0dB
                                                                      X01 = -3dB
                                                                      X10 = -6dB
                                                                      X11 = -9dB
         R45 (002Dh)         2   IN1L_TO_MIXOUTL               0      IN1L PGA Output to MIXOUTL
         Output Mixer                                                 Mute
         (1)                                                          0 = Mute
                                                                      1 = Un-mute
         R47 (002Fh)        2:0  IN1L_MIXOUTL_VOL             000     IN1L PGA Output to MIXOUTL
         Output Mixer            [2:0]                                Volume
         (3)                                                          0dB to -9dB in 3dB steps
                                                                      X00 = 0dB
                                                                      X01 = -3dB
                                                                      X10 = -6dB
                                                                      X11 = -9dB
         R45 (002Dh)         3   IN1R_TO_MIXOUTL               0      IN1R PGA Output to MIXOUTL
         Output Mixer                                                 Mute
         (1)                                                          0 = Mute
                                                                      1 = Un-mute
                                                                                   PP, March 2014, Rev 3.5
w
                                                                                                        120


Pre-Production                                                                             WM8958
                  REGISTER      BIT           LABEL         DEFAULT           DESCRIPTION
                  ADDRESS
                R47 (002Fh)     5:3   IN1R_MIXOUTL_VOL        000   IN1R PGA Output to MIXOUTL
                Output Mixer          [2:0]                         Volume
                (3)                                                 0dB to -9dB in 3dB steps
                                                                    X00 = 0dB
                                                                    X01 = -3dB
                                                                    X10 = -6dB
                                                                    X11 = -9dB
                R45 (002Dh)      1    IN2LP_TO_MIXOUTL         0    IN2LP to MIXOUTL Mute
                Output Mixer                                        0 = Mute
                (1)                                                 1 = Un-mute
                                                                    Note that VMID_BUF_ENA must be
                                                                    set when using the IN2LP input to
                                                                    MIXOUTL.
                R47 (002Fh)    11:9   IN2LP_MIXOUTL_VOL       000   IN2LP to MIXOUTL Volume
                Output Mixer          [2:0]                         0dB to -9dB in 3dB steps
                (3)                                                 X00 = 0dB
                                                                    X01 = -3dB
                                                                    X10 = -6dB
                                                                    X11 = -9dB
                R45 (002Dh)      7    MIXINR_TO_MIXOUTL        0    MIXINR Output (Right ADC bypass)
                Output Mixer                                        to MIXOUTL Mute
                (1)                                                 0 = Mute
                                                                    1 = Un-mute
                R49 (0031h)     5:3   MIXINR_MIXOUTL_VO       000   MIXINR Output (Right ADC bypass)
                Output Mixer          L [2:0]                       to MIXOUTL Volume
                (5)                                                 0dB to -9dB in 3dB steps
                                                                    X00 = 0dB
                                                                    X01 = -3dB
                                                                    X10 = -6dB
                                                                    X11 = -9dB
                R45 (002Dh)      6    MIXINL_TO_MIXOUTL        0    MIXINL Output (Left ADC bypass)
                Output Mixer                                        to MIXOUTL Mute
                (1)                                                 0 = Mute
                                                                    1 = Un-mute
                R49 (0031h)     2:0   MIXINL_MIXOUTL_VOL      000   MIXINL Output (Left ADC bypass)
                Output Mixer          [2:0]                         to MIXOUTL Volume
                (5)                                                 0dB to -9dB in 3dB steps
                                                                    X00 = 0dB
                                                                    X01 = -3dB
                                                                    X10 = -6dB
                                                                    X11 = -9dB
                R45 (002Dh)      0    DAC1L_TO_MIXOUTL         0    Left DAC1 to MIXOUTL Mute
                Output Mixer                                        0 = Mute
                (1)                                                 1 = Un-mute
                R49 (0031h)    11:9   DAC1L_MIXOUTL_VOL       000   Left DAC1 to MIXOUTL Volume
                Output Mixer          [2:0]                         0dB to -9dB in 3dB steps
                (5)                                                 X00 = 0dB
                                                                    X01 = -3dB
                                                                    X10 = -6dB
                                                                    X11 = -9dB
               Table 64 Left Output Mixer (MIXOUTL) Control
                                                                               PP, March 2014, Rev 3.5
w
                                                                                                     121


WM8958                                                                  Pre-Production
         REGISTER   BIT        LABEL      DEFAULT            DESCRIPTION
         ADDRESS
       R46 (002Eh)   5  IN2LN_TO_MIXOUTR     0    IN2LN to MIXOUTR Mute
       Output Mixer                               0 = Mute
       (2)                                        1 = Un-mute
                                                  Note that VMID_BUF_ENA must be
                                                  set when using the IN2LN input to
                                                  MIXOUTR.
       R50 (0032h)  8:6 IN2LN_MIXOUTR_VOL   000   IN2LN to MIXOUTR Volume
       Output Mixer     [2:0]                     0dB to -9dB in 3dB steps
       (6)                                        X00 = 0dB
                                                  X01 = -3dB
                                                  X10 = -6dB
                                                  X11 = -9dB
       R46 (002Eh)   4  IN2RN_TO_MIXOUTR     0    IN2RN to MIXOUTR Mute
       Output Mixer                               0 = Mute
       (2)                                        1 = Un-mute
                                                  Note that VMID_BUF_ENA must be
                                                  set when using the IN2RN input to
                                                  MIXOUTR.
       R48 (0030h)  8:6 IN2RN_MIXOUTR_VOL   000   IN2RN to MIXOUTR Volume
       Output Mixer     [2:0]                     0dB to -9dB in 3dB steps
       (4)                                        X00 = 0dB
                                                  X01 = -3dB
                                                  X10 = -6dB
                                                  X11 = -9dB
       R46 (002Eh)   3  IN1L_TO_MIXOUTR      0    IN1L PGA Output to MIXOUTR Mute
       Output Mixer                               0 = Mute
       (2)                                        1 = Un-mute
       R48 (0030h)  5:3 IN1L_MIXOUTR_VOL    000   IN1L PGA Output to MIXOUTR
       Output Mixer     [2:0]                     Volume
       (4)                                        0dB to -9dB in 3dB steps
                                                  X00 = 0dB
                                                  X01 = -3dB
                                                  X10 = -6dB
                                                  X11 = -9dB
       R46 (002Eh)   2  IN1R_TO_MIXOUTR      0    IN1R PGA Output to MIXOUTR
       Output Mixer                               Mute
       (2)                                        0 = Mute
                                                  1 = Un-mute
       R48 (0030h)  2:0 IN1R_MIXOUTR_VOL    000   IN1R PGA Output to MIXOUTR
       Output Mixer     [2:0]                     Volume
       (4)                                        0dB to -9dB in 3dB steps
                                                  X00 = 0dB
                                                  X01 = -3dB
                                                  X10 = -6dB
                                                  X11 = -9dB
       R46 (002Eh)   1  IN2RP_TO_MIXOUTR     0    IN2RP to MIXOUTR Mute
       Output Mixer                               0 = Mute
       (2)                                        1 = Un-mute
                                                  Note that VMID_BUF_ENA must be
                                                  set when using the IN2RP input to
                                                  MIXOUTR.
                                                              PP, March 2014, Rev 3.5
w
                                                                                  122


Pre-Production                                                                              WM8958
                  REGISTER      BIT           LABEL          DEFAULT           DESCRIPTION
                  ADDRESS
                R48 (0030h)    11:9   IN2RP_MIXOUTR_VOL        000   IN2RP to MIXOUTR Volume
                Output Mixer          [2:0]                          0dB to -9dB in 3dB steps
                (4)                                                  X00 = 0dB
                                                                     X01 = -3dB
                                                                     X10 = -6dB
                                                                     X11 = -9dB
                R46 (002Eh)      7    MIXINL_TO_MIXOUTR         0    MIXINL Output (Left ADC bypass) to
                Output Mixer                                         MIXOUTR Mute
                (2)                                                  0 = Mute
                                                                     1 = Un-mute
                R50 (0032h)     5:3   MIXINL_MIXOUTR_VO        000   MIXINL Output (Left ADC bypass) to
                Output Mixer          L[2:0]                         MIXOUTR Volume
                (6)                                                  0dB to -9dB in 3dB steps
                                                                     X00 = 0dB
                                                                     X01 = -3dB
                                                                     X10 = -6dB
                                                                     X11 = -9dB
                R46 (002Eh)      6    MIXINR_TO_MIXOUTR         0    MIXINR Output (Right ADC bypass)
                Output Mixer                                         to MIXOUTR Mute
                (2)                                                  0 = Mute
                                                                     1 = Un-mute
                R50 (0032h)     2:0   MIXINR_MIXOUTR_VO        000   MIXINR Output (Right ADC bypass)
                Output Mixer          L [2:0]                        to MIXOUTR Volume
                (6)                                                  0dB to -9dB in 3dB steps
                                                                     X00 = 0dB
                                                                     X01 = -3dB
                                                                     X10 = -6dB
                                                                     X11 = -9dB
                R46 (002Eh)      0    DAC1R_TO_MIXOUTR          0    Right DAC1 to MIXOUTR Mute
                Output Mixer                                         0 = Mute
                (2)                                                  1 = Un-mute
                R50 (0032h)    11:9   DAC1R_MIXOUTR_VO         000   Right DAC1 to MIXOUTR Volume
                Output Mixer          L [2:0]                        0dB to -9dB in 3dB steps
                (6)                                                  X00 = 0dB
                                                                     X01 = -3dB
                                                                     X10 = -6dB
                                                                     X11 = -9dB
               Table 65 Right Output Mixer (MIXOUTR) Control
                                                                                PP, March 2014, Rev 3.5
w
                                                                                                   123


WM8958                                                                                         Pre-Production
       SPEAKER MIXER CONTROL
       The Speaker Mixer path select and volume controls are described in Table 66 for the Left Channel
       (SPKMIXL) and Table 67 for the Right Channel (SPKMIXR).
       Care should be taken when enabling more than one path to a speaker mixer in order to avoid clipping.
       The gain of each input path is adjustable using a selectable -3dB control in each path to facilitate this.
       Each Speaker Mixer output is also controlled by an additional independent volume control.
       Note that the DAC input levels may also be controlled by the DAC digital volume controls (see “Digital
       to Analogue Converter (DAC)”) and the Audio Interface digital volume controls (see “Digital Volume
       and Filter Control”).
       When using the IN1LP or IN1RP signal paths to the speaker mixers, the buffered VMID reference
       must be enabled, using the VMID_BUF_ENA register, as described in “Reference Voltages and
       Master Bias”.
                                                                                     PP, March 2014, Rev 3.5
w
                                                                                                            124


Pre-Production                                                                              WM8958
                 REGISTER       BIT           LABEL          DEFAULT           DESCRIPTION
                 ADDRESS
                R54 (0034h)      9    DAC2L_TO_SPKMIXL          0    Left DAC2 to SPKMIXL Mute
                Speaker Mixer                                        0 = Mute
                                                                     1 = Un-mute
                                 7    MIXINL_TO_SPKMIXL         0    MIXINL (Left ADC bypass) to
                                                                     SPKMIXL Mute
                                                                     0 = Mute
                                                                     1 = Un-mute
                                 5    IN1LP_TO_SPKMIXL          0    IN1LP to SPKMIXL Mute
                                                                     0 = Mute
                                                                     1 = Un-mute
                                                                     Note that VMID_BUF_ENA must
                                                                     be set when using the IN1LP input
                                                                     to SPKMIXL.
                                 3    MIXOUTL_TO_SPKMIX         0    Left Mixer Output to SPKMIXL
                                      L                              Mute
                                                                     0 = Mute
                                                                     1 = Un-mute
                                 1    DAC1L_TO_SPKMIXL          0    Left DAC1 to SPKMIXL Mute
                                                                     0 = Mute
                                                                     1 = Un-mute
                R34 (0022h)      6    DAC2L_SPKMIXL_VOL         0    Left DAC2 to SPKMIXL Fine
                SPKMIXL                                              Volume Control
                Attenuation                                          0 = 0dB
                                                                     1 = -3dB
                                 5    MIXINL_SPKMIXL_VOL        0    MIXINL (Left ADC bypass) to
                                                                     SPKMIXL Fine Volume Control
                                                                     0 = 0dB
                                                                     1 = -3dB
                                 4    IN1LP_SPKMIXL_VOL         0    IN1LP to SPKMIXL Fine Volume
                                                                     Control
                                                                     0 = 0dB
                                                                     1 = -3dB
                                 3    MIXOUTL_SPKMIXL_V         0    Left Mixer Output to SPKMIXL Fine
                                      OL                             Volume Control
                                                                     0 = 0dB
                                                                     1 = -3dB
                                 2    DAC1L_SPKMIXL_VOL         0    Left DAC1 to SPKMIXL Fine
                                                                     Volume Control
                                                                     0 = 0dB
                                                                     1 = -3dB
                                1:0   SPKMIXL_VOL [1:0]        11    Left Speaker Mixer Volume Control
                                                                     00 = 0dB
                                                                     01 = -6dB
                                                                     10 = -12dB
                                                                     11 = Mute
               Table 66 Left Speaker Mixer (SPKMIXL) Control
                                                                                 PP, March 2014, Rev 3.5
w
                                                                                                    125


WM8958                                                                             Pre-Production
         REGISTER       BIT           LABEL           DEFAULT           DESCRIPTION
         ADDRESS
        R54 (0034h)      8    DAC2R_TO_SPKMIXR           0    Right DAC2 to SPKMIXR Mute
        Speaker                                               0 = Mute
        Mixer                                                 1 = Un-mute
                         6    MIXINR_TO_SPKMIXR          0    MIXINR (Right ADC bypass) to
                                                              SPKMIXR Mute
                                                              0 = Mute
                                                              1 = Un-mute
                         4    IN1RP_TO_SPKMIXR           0    IN1RP to SPKMIXR Mute
                                                              0 = Mute
                                                              1 = Un-mute
                                                              Note that VMID_BUF_ENA must
                                                              be set when using the IN1RP input
                                                              to SPKMIXR.
                         2    MIXOUTR_TO_SPKMIX          0    Right Mixer Output to SPKMIXR
                              R                               Mute
                                                              0 = Mute
                                                              1 = Un-mute
                         0    DAC1R_TO_SPKMIXR           0    Right DAC1 to SPKMIXR Mute
                                                              0 = Mute
                                                              1 = Un-mute
        R35 (0023h)      6    DAC2R_SPKMIXR_VOL          0    Right DAC2 to SPKMIXR Fine
        SPKMIXR                                               Volume Control
        Attenuation                                           0 = 0dB
                                                              1 = -3dB
                         5    MIXINR_SPKMIXR_VOL         0    MIXINR (Right ADC bypass) to
                                                              SPKMIXR Fine Volume Control
                                                              0 = 0dB
                                                              1 = -3dB
                         4    IN1RP_SPKMIXR_VOL          0    IN1RP to SPKMIXR Fine Volume
                                                              Control
                                                              0 = 0dB
                                                              1 = -3dB
                         3    MIXOUTR_SPKMIXR_V          0    Right Mixer Output to SPKMIXR
                              OL                              Fine Volume Control
                                                              0 = 0dB
                                                              1 = -3dB
                         2    DAC1R_SPKMIXR_VOL          0    Right DAC1 to SPKMIXR Fine
                                                              Volume Control
                                                              0 = 0dB
                                                              1 = -3dB
                        1:0   SPKMIXR_VOL [1:0]         11    Right Speaker Mixer Volume
                                                              Control
                                                              00 = 0dB
                                                              01 = -6dB
                                                              10 = -12dB
                                                              11 = Mute
       Table 67 Right Speaker Mixer (SPKMIXR) Control
                                                                        PP, March 2014, Rev 3.5
w
                                                                                             126


Pre-Production                                                                                                 WM8958
               OUTPUT SIGNAL PATH VOLUME CONTROL
               There are six output PGAs - MIXOUTLVOL, MIXOUTRVOL, HPOUT1LVOL, HPOUT1RVOL,
               SPKLVOL and SPKRVOL. Each can be independently controlled, with MIXOUTLVOL and
               MIXOUTRVOL providing volume control to both the earpiece and line drivers, HPOUT1LVOL and
               HPOUT1RVOL to the headphone driver, and SPKLVOL and SPKRVOL to the speaker drivers.
               The volume control of each of these output PGAs can be adjusted over a wide range of values. To
               minimise pop noise, it is recommended that only the MIXOUTLVOL, MIXOUTRVOL, HPOUT1LVOL,
               HPOUT1RVOL, SPKLVOL and SPKRVOL are modified while the output signal path is active. Other
               gain controls are provided in the signal paths to provide scaling of signals from different sources, and
               to prevent clipping when multiple signals are mixed. However, to prevent pop noise, it is
               recommended that those other gain controls should not be modified while the signal path is active.
               To prevent "zipper noise", a zero-cross function is provided on the output PGAs. When this feature is
               enabled, volume updates will not take place until a zero-crossing is detected. In the case of a long
               period without zero-crossings, a timeout function is provided. When the zero-cross function is
               enabled, the volume will update after the timeout period if no earlier zero-cross has occurred. The
               timeout clock is enabled using TOCLK_ENA; the timeout period is set by TOCLK_DIV. See “Clocking
               and Sample Rates” for more information on these fields.
               The mixer output PGA controls are shown in Table 68. The MIXOUT_VU bits control the loading of the
               output mixer PGA volume data. When MIXOUT_VU is set to 0, the volume control data will be loaded
               into the respective control register, but will not actually change the gain setting. The output mixer PGA
               volume settings are both updated when a 1 is written to either MIXOUT_VU bit. This makes it possible
               to update the gain of both output paths simultaneously.
                  REGISTER         BIT             LABEL               DEFAULT                 DESCRIPTION
                  ADDRESS
                 R32 (0020h)        8     MIXOUT_VU                        N/A     Mixer Output PGA Volume Update
                 Left OPGA                                                         Writing a 1 to this bit will update
                 Volume                                                            MIXOUTLVOL and MIXOUTRVOL
                                                                                   volumes simultaneously.
                                    7     MIXOUTL_ZC                        0      MIXOUTLVOL (Left Mixer Output
                                                                                   PGA) Zero Cross Enable
                                                                                   0 = Zero cross disabled
                                                                                   1 = Zero cross enabled
                                    6     MIXOUTL_MUTE_N                    1      MIXOUTLVOL (Left Mixer Output
                                                                                   PGA) Mute
                                                                                   0 = Mute
                                                                                   1 = Un-mute
                                   5:0    MIXOUTL_VOL [5:0]                39h     MIXOUTLVOL (Left Mixer Output
                                                                          (0dB)    PGA) Volume
                                                                                   -57dB to +6dB in 1dB steps
                                                                                   00_0000 = -57dB
                                                                                   00_0001 = -56dB
                                                                                   … (1dB steps)
                                                                                   11_1111 = +6dB
                                                                                   (See Table 71 for output PGA
                                                                                   volume control range)
                 R33 (0021h)        8     MIXOUT_VU                        N/A     Mixer Output PGA Volume Update
                 Right OPGA                                                        Writing a 1 to this bit will update
                 Volume                                                            MIXOUTLVOL and MIXOUTRVOL
                                                                                   volumes simultaneously.
                                    7     MIXOUTR_ZC                        0      MIXOUTRVOL (Right Mixer Output
                                                                                   PGA) Zero Cross Enable
                                                                                   0 = Zero cross disabled
                                                                                   1 = Zero cross enabled
                                    6     MIXOUTR_MUTE_N                    1      MIXOUTLVOL (Right Mixer Output
                                                                                   PGA) Mute
                                                                                   0 = Mute
                                                                                   1 = Un-mute
                                                                                                PP, March 2014, Rev 3.5
w
                                                                                                                       127


WM8958                                                                                            Pre-Production
          REGISTER          BIT           LABEL             DEFAULT                 DESCRIPTION
           ADDRESS
                            5:0    MIXOUTR_VOL [5:0]           39h      MIXOUTRVOL (Right Mixer Output
                                                              (0dB)     PGA) Volume
                                                                        -57dB to +6dB in 1dB steps
                                                                        00_0000 = -57dB
                                                                        00_0001 = -56dB
                                                                        … (1dB steps)
                                                                        11_1111 = +6dB
                                                                        (See Table 71 for output PGA
                                                                        volume control range)
       Table 68 Mixer Output PGA (MIXOUTLVOL, MIXOUTRVOL) Control
       The headphone output PGA is configurable between two input sources. The default input to each
       headphone output PGA is the respective output mixer (MIXOUTL or MIXOUTR). A direct path from
       the DAC1L or DAC1R can be selected using the DAC1L_TO_HPOUT1L and DAC1R_TO_HPOUT1R
       register bits. When these bits are selected, a DAC to Headphone playback path is possible without
       using the output mixers; this offers reduced power consumption by allowing the output mixers to be
       disabled in this typical usage case.
       The headphone output PGA controls are shown in Table 69. The HPOUT1_VU bits control the loading
       of the headphone PGA volume data. When HPOUT1_VU is set to 0, the volume control data will be
       loaded into the respective control register, but will not actually change the gain setting. The
       headphone PGA volume settings are both updated when a 1 is written to either HPOUT1_VU bit. This
       makes it possible to update the gain of both output paths simultaneously.
          REGISTER          BIT           LABEL             DEFAULT                 DESCRIPTION
           ADDRESS
         R28 (001Ch)         8     HPOUT1_VU                   N/A       Headphone Output PGA Volume
         Left Output                                                     Update
         Volume                                                          Writing a 1 to this bit will update
                                                                         HPOUT1LVOL and HPOUT1RVOL
                                                                         volumes simultaneously.
                             7     HPOUT1L_ZC                   0        HPOUT1LVOL (Left Headphone
                                                                         Output PGA) Zero Cross Enable
                                                                         0 = Zero cross disabled
                                                                         1 = Zero cross enabled
                             6     HPOUT1L_MUTE_N               1        HPOUT1LVOL (Left Headphone
                                                                         Output PGA) Mute
                                                                         0 = Mute
                                                                         1 = Un-mute
                            5:0    HPOUT1L_VOL [5:0]           2Dh       HPOUT1LVOL (Left Headphone
                                                             (-12dB)     Output PGA) Volume
                                                                         -57dB to +6dB in 1dB steps
                                                                         00_0000 = -57dB
                                                                         00_0001 = -56dB
                                                                         … (1dB steps)
                                                                         11_1111 = +6dB
                                                                         (See Table 71 for output PGA
                                                                         volume control range)
         R45 (002Dh)         8     DAC1L_TO_HPOUT1              0        HPOUT1LVOL (Left Headphone
         Output Mixer              L                                     Output PGA) Input Select
         (1)                                                             0 = MIXOUTL
                                                                         1 = DAC1L
         R29 (001Dh)         8     HPOUT1_VU                   N/A       Headphone Output PGA Volume
         Right Output                                                    Update
         Volume                                                          Writing a 1 to this bit will update
                                                                         HPOUT1LVOL and HPOUT1RVOL
                                                                         volumes simultaneously.
                                                                                     PP, March 2014, Rev 3.5
w
                                                                                                             128


Pre-Production                                                                                             WM8958
                  REGISTER        BIT             LABEL              DEFAULT                DESCRIPTION
                   ADDRESS
                                   7      HPOUT1R_ZC                      0      HPOUT1RVOL (Right Headphone
                                                                                 Output PGA) Zero Cross Enable
                                                                                 0 = Zero cross disabled
                                                                                 1 = Zero cross enabled
                                   6      HPOUT1R_MUTE_N                  1      HPOUT1RVOL (Right Headphone
                                                                                 Output PGA) Mute
                                                                                 0 = Mute
                                                                                 1 = Un-mute
                                  5:0     HPOUT1R_VOL [5:0]             2Dh      HPOUT1RVOL (Right Headphone
                                                                      (-12dB)    Output PGA) Volume
                                                                                 -57dB to +6dB in 1dB steps
                                                                                 00_0000 = -57dB
                                                                                 00_0001 = -56dB
                                                                                 … (1dB steps)
                                                                                 11_1111 = +6dB
                                                                                 (See Table 71 for output PGA
                                                                                 volume control range)
                 R46 (002Eh)       8      DAC1R_TO_HPOUT1                 0      HPOUT1RVOL (Right Headphone
                 Output Mixer             R                                      Output PGA) Input Select
                 (2)                                                             0 = MIXOUTR
                                                                                 1 = DAC1R
               Table 69 Headphone Output PGA (HPOUT1LVOL, HPOUT1RVOL) Control
               The speaker output PGA controls are shown in Table 70.The SPKOUT_VU bits control the loading of
               the speaker PGA volume data. When SPKOUT_VU is set to 0, the volume control data will be loaded
               into the respective control register, but will not actually change the gain setting. The speaker PGA
               volume settings are both updated when a 1 is written to either SPKOUT_VU bit. This makes it
               possible to update the gain of both output paths simultaneously.
                  REGISTER        BIT             LABEL               DEFAULT                DESCRIPTION
                   ADDRESS
                 R38 (0026h)       8     SPKOUT_VU                       N/A      Speaker Output PGA Volume
                 Speaker                                                          Update
                 Volume Left                                                      Writing a 1 to this bit will update
                                                                                  SPKLVOL and SPKRVOL volumes
                                                                                  simultaneously.
                                   7     SPKOUTL_ZC                        0      SPKLVOL (Left Speaker Output
                                                                                  PGA) Zero Cross Enable
                                                                                  0 = Zero cross disabled
                                                                                  1 = Zero cross enabled
                                   6     SPKOUTL_MUTE_N                    1      SPKLVOL (Left Speaker Output
                                                                                  PGA) Mute
                                                                                  0 = Mute
                                                                                  1 = Un-mute
                                  5:0    SPKOUTL_VOL [5:0]               39h      SPKLVOL (Left Speaker Output
                                                                        (0dB)     PGA) Volume
                                                                                  -57dB to +6dB in 1dB steps
                                                                                  00_0000 = -57dB
                                                                                  00_0001 = -56dB
                                                                                  … (1dB steps)
                                                                                  11_1111 = +6dB
                                                                                  (See Table 71 for output PGA
                                                                                  volume control range)
                                                                                             PP, March 2014, Rev 3.5
w
                                                                                                                      129


WM8958                                                                              Pre-Production
         REGISTER      BIT           LABEL        DEFAULT              DESCRIPTION
         ADDRESS
        R39 (0027h)     8    SPKOUT_VU              N/A     Speaker PGA Volume Update
        Speaker                                             Writing a 1 to this bit will update
        Volume Right                                        SPKLVOL and SPKRVOL volumes
                                                            simultaneously.
                        7    SPKOUTR_ZC              0      SPKRVOL (Right Speaker Output
                                                            PGA) Zero Cross Enable
                                                            0 = Zero cross disabled
                                                            1 = Zero cross enabled
                        6    SPKOUTR_MUTE_N          1      SPKRVOL (Right Speaker Output
                                                            PGA) Mute
                                                            0 = Mute
                                                            1 = Un-mute
                       5:0   SPKOUTR_VOL [5:0]      39h     SPKRVOL (Right Speaker Output
                                                   (0dB)    PGA) Volume
                                                            -57dB to +6dB in 1dB steps
                                                            00_0000 = -57dB
                                                            00_0001 = -56dB
                                                            … (1dB steps)
                                                            11_1111 = +6dB
                                                            (See Table 71 for output PGA
                                                            volume control range)
       Table 70 Speaker Output PGA (SPKLVOL, SPKRVOL) Control
        PGA GAIN SETTING       VOLUME (dB)    PGA GAIN SETTING       VOLUME (dB)
                00h                -57              20h                    -25
                01h                -56              21h                    -24
                02h                -55              22h                    -23
                03h                -54              23h                    -22
                04h                -53              24h                    -21
                05h                -52              25h                    -20
                06h                -51              26h                    -19
                07h                -50              27h                    -18
                08h                -49              28h                    -17
                09h                -48              29h                    -16
                0Ah                -47              2Ah                    -15
                0Bh                -46              2Bh                    -14
                0Ch                -45              2Ch                    -13
                0Dh                -44              2Dh                    -12
                0Eh                -43              2Eh                    -11
                0Fh                -42              2Fh                    -10
                10h                -41              30h                     -9
                11h                -40              31h                     -8
                12h                -39              32h                     -7
                13h                -38              33h                     -6
                14h                -37              34h                     -5
                15h                -36              35h                     -4
                16h                -35              36h                     -3
                17h                -34              37h                     -2
                18h                -33              38h                     -1
                19h                -32              39h                     0
                1Ah                -31              3Ah                    +1
                1Bh                -30              3Bh                    +2
                1Ch                -29              3Ch                    +3
                                                                       PP, March 2014, Rev 3.5
w
                                                                                                130


Pre-Production                                                                                            WM8958
                 PGA GAIN SETTING             VOLUME (dB)      PGA GAIN SETTING            VOLUME (dB)
                         1Dh                       -28                  3Dh                     +4
                          1Eh                      -27                  3Eh                     +5
                          1Fh                      -26                  3Fh                     +6
               Table 71 Output PGA Volume Range
               SPEAKER BOOST MIXER
               Each Class D/AB speaker driver has its own boost mixer which performs a dual role. It allows the
               output from the left speaker mixer (via SPKLVOL), right speaker mixer (via SPKRVOL), or the ‘Direct
               Voice’ path to be routed to either speaker driver. The speaker boost mixers are controlled using the
               registers defined in Table 72 below.
               The ‘Direct Voice’ path is the differential input, VRXN-VRXP, routed directly to the output drivers,
               providing a low power differential path from baseband voice to loudspeakers. Note that a phase
               inversion exists between VRXP and SPKOUTxP. The ‘Direct Voice’ path output therefore represents
               VVRXN - VVRXP.
               The second function of the speaker boost mixers is that they provide an additional AC gain (boost)
               function to shift signal levels between the AVDD1 and SPKVDD voltage domains for maximum output
               power. The AC gain (boost) function is described in the “Analogue Outputs” section.
                  REGISTER          BIT             LABEL           DEFAULT                 DESCRIPTION
                  ADDRESS
                 R36 (0024h)         5      IN2LRP_TO_SPKOUT            0        Direct Voice (VRXN-VRXP) to Left
                 SPKOUT                     L                                    Speaker Mute
                 Mixers                                                          0 = Mute
                                                                                 1 = Un-mute
                                     4      SPKMIXL_TO_SPKOU            1        SPKMIXL Left Speaker Mixer to
                                            TL                                   Left Speaker Mute
                                                                                 0 = Mute
                                                                                 1 = Un-mute
                                     3      SPKMIXR_TO_SPKO             0        SPKMIXR Right Speaker Mixer to
                                            UTL                                  Left Speaker Mute
                                                                                 0 = Mute
                                                                                 1 = Un-mute
                                     2      IN2LRP_TO_SPKOUT            0        Direct Voice (VRXN-VRXP) to Right
                                            R                                    Speaker Mute
                                                                                 0 = Mute
                                                                                 1 = Un-mute
                                     1      SPKMIXL_TO_SPKOU            0        SPKMIXL Left Speaker Mixer to
                                            TR                                   Right Speaker Mute
                                                                                 0 = Mute
                                                                                 1 = Un-mute
                                     0      SPKMIXR_TO_SPKO             1        SPKMIXR Right Speaker Mixer to
                                            UTR                                  Right Speaker Mute
                                                                                 0 = Mute
                                                                                 1 = Un-mute
               Table 72 Speaker Boost Mixer (SPKOUTLBOOST, SPKOUTRBOOST) Control
               EARPIECE DRIVER MIXER
               The earpiece driver has a dedicated mixer, HPOUT2MIX, which is controlled using the registers
               defined in Table 73. The earpiece driver is configurable to select output from the left output mixer (via
               MIXOUTLVOL), the right output mixer (via MIXOUTRVOL), or the ‘Direct Voice’ path.
               The ‘Direct Voice’ path is the differential input, VRXN-VRXP, routed directly to the output drivers,
               providing a low power differential path from baseband voice to earpiece. Note that a phase inversion
               exists between VRXP and HPOUT2P. The ‘Direct Voice’ path output therefore represents VVRXN -
               VVRXP.
                                                                                             PP, March 2014, Rev 3.5
w
                                                                                                                   131


WM8958                                                                                          Pre-Production
       Care should be taken to avoid clipping when enabling more than one path to the earpiece driver. The
       HPOUT2VOL volume control can be used to avoid clipping when more than one full scale signal is
       input to the mixer.
          REGISTER          BIT           LABEL             DEFAULT                  DESCRIPTION
           ADDRESS
         R31 (001Fh)         5      HPOUT2_MUTE                  1        HPOUT2 (Earpiece Driver) Mute
         HPOUT2                                                           0 = Un-mute
         Volume                                                           1 = Mute
                             4      HPOUT2_VOL                   0        HPOUT2 (Earpiece Driver) Volume
                                                                          0 = 0dB
                                                                          1 = -6dB
         R51 (0033h)         5      IN2LRP_TO_HPOUT2             0        Direct Voice (VRXN-VRXP) to
         HPOUT2                                                           Earpiece Driver
         Mixer                                                            0 = Mute
                                                                          1 = Un-mute
                             4      MIXOUTLVOL_TO_HP             0        MIXOUTLVOL (Left Output Mixer
                                    OUT2                                  PGA) to Earpiece Driver
                                                                          0 = Mute
                                                                          1 = Un-mute
                             3      MIXOUTRVOL_TO_HP             0        MIXOUTRVOL (Right Output Mixer
                                    OUT2                                  PGA) to Earpiece Driver
                                                                          0 = Mute
                                                                          1 = Un-mute
       Table 73 Earpiece Driver Mixer (HPOUT2MIX) Control
       LINE OUTPUT MIXERS
       The WM8958 provides two pairs of line outputs, both with highly configurable output mixers. The
       outputs LINEOUT1N and LINEOUT1P can be configured as two single-ended outputs or as a
       differential output. In the same manner, LINEOUT2N and LINEOUT2P can be configured either as two
       single-ended outputs or as a differential output. The respective line output mixers can be configured in
       single-ended mode or differential mode; each mode supports multiple signal path configurations.
       LINEOUT1 single-ended mode is selected by setting LINEOUT1_MODE = 1. In single-ended mode,
       any of three possible signal paths may be enabled:
                  MIXOUTL (left output mixer) to LINEOUT1P
                  MIXOUTR (right output mixer) to LINEOUT1N
                  MIXOUTL (left output mixer) to LINEOUT1N
       LINEOUT1 differential mode is selected by setting LINEOUT1_MODE = 0. In differential mode, any of
       three possible signal paths may be enabled:
                  MIXOUTL (left output mixer) to LINEOUT1N and LINEOUT1P
                  IN1L (input PGA) to LINEOUT1N and LINEOUT1P
                  IN1R (input PGA) to LINEOUT1N and LINEOUT1P
       The LINEOUT1 output mixers are controlled as described in Table 74. Care should be taken to avoid
       clipping when enabling more than one path to the line output mixers. The LINEOUT1_VOL control can
       be used to provide -6dB attenuation when more than one full scale signal is applied.
       When using the LINEOUT1 mixers in single-ended mode, a buffered VMID must be enabled. This is
       achieved by setting LINEOUT_VMID_BUF_ENA, as described in the “Analogue Outputs” section.
                                                                                      PP, March 2014, Rev 3.5
w
                                                                                                           132


Pre-Production                                                                          WM8958
                 REGISTER      BIT        LABEL         DEFAULT             DESCRIPTION
                  ADDRESS
                R30 (001Eh)     6   LINEOUT1N_MUTE         1    LINEOUT1N Line Output Mute
                Line Outputs                                    0 = Un-mute
                Volume                                          1 = Mute
                                5   LINEOUT1P_MUTE         1    LINEOUT1P Line Output Mute
                                                                0 = Un-mute
                                                                1 = Mute
                                4   LINEOUT1_VOL           0    LINEOUT1 Line Output Volume
                                                                0 = 0dB
                                                                1 = -6dB
                                                                Applies to both LINEOUT1N and
                                                                LINEOUT1P
                R52 (0034h)     6   MIXOUTL_TO_LINEO       0    MIXOUTL to Single-Ended Line
                Line Mixer (1)      UT1N                        Output on LINEOUT1N
                                                                0 = Mute
                                                                1 = Un-mute
                                                                (LINEOUT1_MODE = 1)
                                5   MIXOUTR_TO_LINE        0    MIXOUTR to Single-Ended Line
                                    OUT1N                       Output on LINEOUT1N
                                                                0 = Mute
                                                                1 = Un-mute
                                                                (LINEOUT1_MODE = 1)
                                4   LINEOUT1_MODE          0    LINEOUT1 Mode Select
                                                                0 = Differential
                                                                1 = Single-Ended
                                2   IN1R_TO_LINEOUT1       0    IN1R Input PGA to Differential Line
                                    P                           Output on LINEOUT1
                                                                0 = Mute
                                                                1 = Un-mute
                                                                (LINEOUT1_MODE = 0)
                                1   IN1L_TO_LINEOUT1       0    IN1L Input PGA to Differential Line
                                    P                           Output on LINEOUT1
                                                                0 = Mute
                                                                1 = Un-mute
                                                                (LINEOUT1_MODE = 0)
                                0   MIXOUTL_TO_LINEO       0    Differential Mode
                                    UT1P                        (LINEOUT1_MODE = 0):
                                                                MIXOUTL to Differential Output on
                                                                LINEOUT1
                                                                0 = Mute
                                                                1 = Un-mute
                                                                Single Ended Mode
                                                                (LINEOUT1_MODE = 1):
                                                                MIXOUTL to Single-Ended Line
                                                                Output on LINEOUT1P
                                                                0 = Mute
                                                                1 = Un-mute
               Table 74 LINEOUT1N and LINEOUT1P Control
                                                                             PP, March 2014, Rev 3.5
w
                                                                                                  133


WM8958                                                                                       Pre-Production
       LINEOUT2 single-ended mode is selected by setting LINEOUT2_MODE = 1. In single-ended mode,
       any of three possible signal paths may be enabled:
                 MIXOUTR (right output mixer) to LINEOUT2P
                 MIXOUTL (left output mixer) to LINEOUT2N
                 MIXOUTR (right output mixer) to LINEOUT2N
       LINEOUT2 differential mode is selected by setting LINEOUT2_MODE = 0. In differential mode, any of
       three possible signal paths may be enabled:
                 MIXOUTR (right output mixer) to LINEOUT2N and LINEOUT2P
                 IN1L (input PGA) to LINEOUT2P and LINEOUT2P
                 IN1R (input PGA) to LINEOUT2N and LINEOUT2P
       The LINEOUT2 output mixers are controlled as described in Table 75. Care should be taken to avoid
       clipping when enabling more than one path to the line output mixers. The LINEOUT2_VOL control can
       be used to provide -6dB attenuation when more than one full scale signal is applied.
       When using the LINEOUT2 mixers in single-ended mode, a buffered VMID must be enabled. This is
       achieved by setting LINEOUT_VMID_BUF_ENA, as described in the “Analogue Outputs” section.
                                                                                    PP, March 2014, Rev 3.5
w
                                                                                                       134


Pre-Production                                                                          WM8958
                 REGISTER      BIT        LABEL         DEFAULT             DESCRIPTION
                 ADDRESS
                R30 (001Eh)     2   LINEOUT2N_MUTE         1    LINEOUT2N Line Output Mute
                Line Outputs                                    0 = Un-mute
                Volume                                          1 = Mute
                                1   LINEOUT2P_MUTE         1    LINEOUT2P Line Output Mute
                                                                0 = Un-mute
                                                                1 = Mute
                                0   LINEOUT2_VOL           0    LINEOUT2 Line Output Volume
                                                                0 = 0dB
                                                                1 = -6dB
                                                                Applies to both LINEOUT2N and
                                                                LINEOUT2P
                R53 (0035h)     6   MIXOUTR_TO_LINEO       0    MIXOUTR to Single-Ended Line
                Line Mixer (2)      UT2N                        Output on LINEOUT2N
                                                                0 = Mute
                                                                1 = Un-mute
                                                                (LINEOUT2_MODE = 1)
                                5   MIXOUTL_TO_LINEO       0    MIXOUTL to Single-Ended Line
                                    UT2N                        Output on LINEOUT2N
                                                                0 = Mute
                                                                1 = Un-mute
                                                                (LINEOUT2_MODE = 1)
                                4   LINEOUT2_MODE          0    LINEOUT2 Mode Select
                                                                0 = Differential
                                                                1 = Single-Ended
                                2   IN1L_TO_LINEOUT2P      0    IN1L Input PGA to Differential Line
                                                                Output on LINEOUT2
                                                                0 = Mute
                                                                1 = Un-mute
                                                                (LINEOUT2_MODE = 0)
                                1   IN1R_TO_LINEOUT2P      0    IN1R Input PGA to Differential Line
                                                                Output on LINEOUT2
                                                                0 = Mute
                                                                1 = Un-mute
                                                                (LINEOUT2_MODE = 0)
                                0   MIXOUTR_TO_LINEO       0    Differential Mode
                                    UT2P                        (LINEOUT2_MODE = 0):
                                                                MIXOUTR to Differential Output on
                                                                LINEOUT2
                                                                0 = Mute
                                                                1 = Un-mute
                                                                Single-Ended Mode
                                                                (LINEOUT2_MODE = 0):
                                                                MIXOUTR to Single-Ended Line
                                                                Output on LINEOUT2P
                                                                0 = Mute
                                                                1 = Un-mute
               Table 75 LINEOUT2N and LINEOUT2P Control
                                                                             PP, March 2014, Rev 3.5
w
                                                                                                  135


WM8958                                                                                              Pre-Production
CHARGE PUMP
            The WM8958 incorporates a dual-mode Charge Pump which generates the supply rails for the
            headphone output drivers, HPOUT1L and HPOUT1R.
            The Charge Pump has a single supply input, CPVDD, and generates split rails CPVOUTP and
            CPVOUTN according to the selected mode of operation.
            The Charge Pump connections are illustrated in Figure 31 (see “Applications Information” for external
            component values). An input decoupling capacitor may also be required at CPVDD, depending upon
            the system configuration.
                                   CPCA              CPCB
              CPVDD                                                         CPVOUTP
                                         Charge Pump
                                                                            CPVOUTN
              CPGND
            Figure 31 Charge Pump External Connections
            The Charge Pump is enabled by setting the CP_ENA bit. When enabled, the charge pump adjusts the
            output voltages (CPVOUTP and CPVOUTN) as well as the switching frequency in order to optimise
            the power consumption according to the operating conditions. This can take two forms, which are
            selected using the CP_DYN_PWR register bit.
                 Register control (CP_DYN_PWR = 0)
                 Dynamic control (CP_DYN_PWR = 1)
            Under Register control, the HPOUT1L_VOL and HPOUT1R_VOL register settings are used to control
            the charge pump mode of operation.
            Under Dynamic control, the audio signal level in the digital audio interface is used to control the
            charge pump mode of operation. The CP_DYN_SRC_SEL register determines which of the digital
            signal paths is used for this function - this may be AIF1 Timeslot 0, AIF Timeslot 1 or AIF2. The
            CP_DYN_SRC_SEL should be set according to the active source for the HPOUT1L and HPOUT1R
            outputs.
            The Dynamic Charge Pump Control mode is the Wolfson ‘Class W’ mode, which allows the power
            consumption to be optimised in real time, but can only be used if a single AIF source is the only signal
            source. The Class W mode should not be used if any of the bypass paths are used to feed analogue
            inputs into the output signal path, or if more than one AIF source is used to feed the headphone
            output via the Digital Mixers.
            Under the recommended usage conditions of the WM8958, the Charge Pump will be enabled by
            running the default headphone Start-Up sequence as described in the “Control Write Sequencer”
            section. (Similarly, it will be disabled by running the Shut-Down sequence.) In these cases, the user
            does not need to write to the CP_ENA bit. The Charge Pump operating mode defaults to Register
            control; Dynamic control may be selected by setting the CP_DYN_PWR register bit, if appropriate.
            Note that the charge pump clock is derived from internal clock SYSCLK; either MCLK or the FLL
            output selectable using the SYSCLK_SRC bit. Under normal circumstances an external clock signal
            must be present for the charge pump to function. However, the FLL has a free-running mode that
            does not require an external clock but will generate an internal clock suitable for running the charge
            pump. The clock division from SYSCLK is handled transparently by the WM8958 without user
                                                                                         PP, March 2014, Rev 3.5
w
                                                                                                                136


Pre-Production                                                                                          WM8958
               intervention, as long as SYSCLK and sample rates are set correctly. Refer to the “Clocking and
               Sample Rates” section for more detail on the FLL and clocking configuration.
               When the Charge Pump is disabled, the output can be left floating or can be actively discharged,
               depending on the CP_DISCH control bit.
               If the headphone output drivers (HPOUT1L and HPOUT1R) are not used, then the Charge Pump and
               the associated external components are not required. The Charge Pump and Headphone drivers
               should not be enabled in this case (CP_ENA=0, HPOUT1L_ENA=0, HPOUT1R_ENA=0).
               If the Charge Pump is not used, and the associated external components are omitted, then the CPCA
               and CPCB pins can be left floating; the CPVOUTP and CPVOUTN pins should be grounded as
               illustrated in Figure 32.
               Note that, when the Charge Pump is disabled, it is still recommended that the CPVDD pin is kept
               within its recommended operating conditions.
               Figure 32 External Configuration when Charge Pump not used
               The Charge Pump control fields are described in Table 76.
                    REGISTER          BIT          LABEL          DEFAULT                 DESCRIPTION
                    ADDRESS
                  R76 (004Ch)         15    CP_ENA                     0        Enable charge-pump digits
                  Charge Pump                                                   0 = Disable
                  (1)                                                           1 = Enable
                  R77 (004Dh)         15    CP_DISCH                   1        Charge Pump Discharge Select
                  Charge Pump                                                   0 = Charge Pump outputs floating
                  (2)                                                           when disabled
                                                                                1 = Charge Pump outputs
                                                                                discharged when disabled
                  R81 (0051h)         9:8   CP_DYN_SRC_SEL            00        Selects the digital audio source for
                  Class W (1)                                                   envelope tracking
                                                                                00 = AIF1, DAC Timeslot 0
                                                                                01 = AIF1, DAC Timeslot 1
                                                                                10 = AIF2, DAC data
                                                                                11 = Reserved
                                       0    CP_DYN_PWR                 0        Enable dynamic charge pump
                                                                                power control
                                                                                0 = charge pump controlled by
                                                                                volume register settings (Class G)
                                                                                1 = charge pump controlled by
                                                                                real-time audio level (Class W)
               Table 76 Charge Pump Control
                                                                                           PP, March 2014, Rev 3.5
w
                                                                                                                 137


WM8958                                                                                               Pre-Production
DC SERVO
         The WM8958 provides a DC servo circuit on the headphone outputs HPOUT1L and HPOUT1R in
         order to remove DC offset from these ground-referenced outputs. When enabled, the DC servo
         ensures that the DC level of these outputs remains within 1mV of ground. Removal of the DC offset is
         important because any deviation from GND at the output pin will cause current to flow through the
         load under quiescent conditions, resulting in increased power consumption. Additionally, the presence
         of DC offsets can result in audible pops and clicks at power up and power down.
         The recommended usage of the DC Servo is initialised by running the default Start-Up sequence as
         described in the “Control Write Sequencer” section. The default Start-Up sequence executes a series
         of DC offset corrections, after which the measured offset correction is maintained on the headphone
         output channels. If a different usage is required, eg. if a periodic DC offset correction is required, then
         the default Start-Up sequence may be modified according to specific requirements. The relevant
         control fields are described in the following paragraphs and are defined in Table 77.
         DC SERVO ENABLE AND START-UP
         The DC Servo circuit is enabled on HPOUT1L and HPOUT1R by setting DCS_ENA_CHAN_0 and
         DCS_ENA_CHAN_1 respectively. When the DC Servo is enabled, the DC offset correction can be
         commanded in a number of different ways, including single-shot and periodically recurring events.
         Writing a logic 1 to DCS_TRIG_STARTUP_n initiates a series of DC offset measurements and applies
         the necessary correction to the associated output; (‘n’ = 0 for Left channel, 1 for Right channel). On
         completion, the headphone output will be within 1mV of AGND. This is the DC Servo mode selected
         by the default Start-Up sequence. Completion of the DC offset correction triggered in this way is
         indicated by the DCS_STARTUP_COMPLETE field, as described in Table 77. Typically, this operation
         takes 86ms per channel.
         For correct operation of the DC Servo Start-Up mode, it is important that there is no active audio
         signal present on the signal path while the mode is running. The DC Servo Start-Up mode should be
         scheduled at the correct position within the Headphone Output Enable sequence, as described in the
         “Analogue Output Signal Path” section. All other stages of the analogue signal path should be fully
         enabled prior to commanding the Start-Up mode; the DAC Digital Mute function should be used,
         where appropriate, to ensure there is no active audio signal present during the DC Servo
         measurements.
         Writing a logic 1 to DCS_TRIG_DAC_WR_n causes the DC offset correction to be set to the value
         contained in the DCS_DAC_WR_VAL_n fields in Register R87. This mode is useful if the required
         offset correction has already been determined and stored; it is faster than the
         DCS_TRIG_STARTUP_n mode, but relies on the accuracy of the stored settings. Completion of the
         DC offset correction triggered in this way is indicated by the DCS_DAC_WR_COMPLETE field, as
         described in Table 77. Typically, this operation takes 2ms per channel.
         For pop-free operation of the DC Servo DAC Write mode, it is important that the mode is scheduled at
         the correct position within the Headphone Output Enable sequence, as described in the “Analogue
         Output Signal Path” section.
         The current DC offset value for each Headphone output channel can be read from the
         DCS_DAC_WR_VAL_n fields. These values may form the basis of settings that are subsequently
         used by the DC Servo in DAC Write mode. Note that these fields have a different definition for Read
         and Write, as described in Table 77.
         When using either of the DC Servo options above, the status of the DC offset correction process is
         indicated by the DCS_CAL_COMPLETE field; this is the logical OR of the
         DCS_STARTUP_COMPLETE and DCS_DAC_WR_COMPLETE fields.
         The DCS_DAC_WR_COMPLETE bits can be used as inputs to the Interrupt control circuit or used to
         generate an external logic signal on a GPIO pin. See “Interrupts” and “General Purpose Input/Output”
         for further details.
         The DC Servo control fields associated with start-up operation are described in Table 77. It is
         important to note that, to minimise audible pops/clicks, the Start-Up and DAC Write modes of DC
         Servo operation should be commanded as part of a control sequence which includes muting and
         shorting of the headphone outputs; a suitable sequence is defined in the default Start-Up sequence.
                                                                                         PP, March 2014, Rev 3.5
w
                                                                                                                138


Pre-Production                                                                  WM8958
                REGISTER     BIT        LABEL   DEFAULT           DESCRIPTION
                ADDRESS
               R84 (0054h)    5  DCS_TRIG_START     0   Writing 1 to this bit selects Start-
               DC Servo (1)      UP_1                   Up DC Servo mode for
                                                        HPOUT1R.
                                                        In readback, a value of 1
                                                        indicates that the DC Servo
                                                        Start-Up correction is in
                                                        progress.
                              4  DCS_TRIG_START     0   Writing 1 to this bit selects Start-
                                 UP_0                   Up DC Servo mode for
                                                        HPOUT1L.
                                                        In readback, a value of 1
                                                        indicates that the DC Servo
                                                        Start-Up correction is in
                                                        progress.
                              3  DCS_TRIG_DAC_W     0   Writing 1 to this bit selects DAC
                                 R_1                    Write DC Servo mode for
                                                        HPOUT1R.
                                                        In readback, a value of 1
                                                        indicates that the DC Servo DAC
                                                        Write correction is in progress.
                              2  DCS_TRIG_DAC_W     0   Writing 1 to this bit selects DAC
                                 R_0                    Write DC Servo mode for
                                                        HPOUT1L.
                                                        In readback, a value of 1
                                                        indicates that the DC Servo DAC
                                                        Write correction is in progress.
                              1  DCS_ENA_CHAN_1     0   DC Servo enable for HPOUT1R
                                                        0 = Disabled
                                                        1 = Enabled
                              0  DCS_ENA_CHAN_0     0   DC Servo enable for HPOUT1L
                                                        0 = Disabled
                                                        1 = Enabled
               R87 (0057h)  15:8 DCS_DAC_WR_VA    00h   Writing to this field sets the DC
               DC Servo (4)      L_1 [7:0]              Offset value for HPOUT1R in
                                                        DAC Write DC Servo mode.
                                                        Reading this field gives the
                                                        current DC Offset value for
                                                        HPOUT1R.
                                                        Two’s complement format.
                                                        LSB is 0.25mV.
                                                        Range is -32mV to +31.75mV
                             7:0 DCS_DAC_WR_VA    00h   Writing to this field sets the DC
                                 L_0 [7:0]              Offset value for HPOUT1L in
                                                        DAC Write DC Servo mode.
                                                        Reading this field gives the
                                                        current DC Offset value for
                                                        HPOUT1L.
                                                        Two’s complement format.
                                                        LSB is 0.25mV.
                                                        Range is -32mV to +31.75mV
               R88 (0058h)   9:8 DCS_CAL_COMPL     00   DC Servo Complete status
               DC Servo          ETE [1:0]              0 = DAC Write or Start-Up DC
               Readback                                 Servo mode not completed.
                                                        1 = DAC Write or Start-Up DC
                                                        Servo mode complete.
                                                        Bit [1] = HPOUT1R
                                                        Bit [0] = HPOUT1L
                                                                   PP, March 2014, Rev 3.5
w
                                                                                          139


WM8958                                                                                           Pre-Production
          REGISTER           BIT             LABEL            DEFAULT                 DESCRIPTION
           ADDRESS
                             5:4       DCS_DAC_WR_CO              00        DC Servo DAC Write status
                                       MPLETE [1:0]                         0 = DAC Write DC Servo mode
                                                                            not completed.
                                                                            1 = DAC Write DC Servo mode
                                                                            complete.
                                                                            Bit [1] = HPOUT1R
                                                                            Bit [0] = HPOUT1L
                             1:0       DCS_STARTUP_C              00        DC Servo Start-Up status
                                       OMPLETE [1:0]                        0 = Start-Up DC Servo mode not
                                                                            completed.
                                                                            1 = Start-Up DC Servo mode
                                                                            complete.
                                                                            Bit [1] = HPOUT1R
                                                                            Bit [0] = HPOUT1L
       Table 77 DC Servo Enable and Start-Up Modes
       DC SERVO ACTIVE MODES
       The DC Servo modes described above are suitable for initialising the DC offset correction circuit on
       the Headphone outputs as part of a controlled start-up sequence which is executed before the signal
       path is fully enabled. Additional modes are available for use whilst the signal path is active; these
       modes may be of benefit following a large change in signal gain, which can lead to a change in DC
       offset level. Periodic updates may also be desirable to remove slow drifts in DC offset caused by
       changes in parameters such as device temperature.
       The DC Servo circuit is enabled on HPOUT1L and HPOUT1R by setting DCS_ENA_CHAN_0 and
       DCS_ENA_CHAN_1 respectively, as described earlier in Table 77.
       Writing a logic 1 to DCS_TRIG_SINGLE_n initiates a single DC offset measurement and adjustment
       to the associated output; (‘n’ = 0 for Left channel, 1 for Right channel). This will adjust the DC offset
       correction on the selected channel by no more than 1LSB (0.25mV).
       Setting DCS_TIMER_PERIOD_01 to a non-zero value will cause a single DC offset measurement and
       adjustment to be scheduled on a periodic basis. Periodic rates ranging from every 0.52s to in excess
       of 2 hours can be selected.
       Writing a logic 1 to DCS_TRIG_SERIES_n initiates a series of DC offset measurements and applies
       the necessary correction to the associated output. The number of DC Servo operations performed is
       determined by DCS_SERIES_NO_01. A maximum of 128 operations may be selected, though a much
       lower value will be sufficient in most applications.
       The DC Servo control fields associated with active modes (suitable for use on a signal path that is in
       active use) are described in Table 78.
                                                                                       PP, March 2014, Rev 3.5
w
                                                                                                           140


Pre-Production                                                                                             WM8958
                   REGISTER           BIT            LABEL            DEFAULT                DESCRIPTION
                   ADDRESS
                 R84 (0054h)          13      DCS_TRIG_SINGLE             0        Writing 1 to this bit selects a
                 DC Servo (1)                 _1                                   single DC offset correction for
                                                                                   HPOUT1R.
                                                                                   In readback, a value of 1
                                                                                   indicates that the DC Servo
                                                                                   single correction is in progress.
                                      12      DCS_TRIG_SINGLE             0        Writing 1 to this bit selects a
                                              _0                                   single DC offset correction for
                                                                                   HPOUT1L.
                                                                                   In readback, a value of 1
                                                                                   indicates that the DC Servo
                                                                                   single correction is in progress.
                                       9      DCS_TRIG_SERIES             0        Writing 1 to this bit selects a
                                              _1                                   series of DC offset corrections
                                                                                   for HPOUT1R.
                                                                                   In readback, a value of 1
                                                                                   indicates that the DC Servo DAC
                                                                                   Write correction is in progress.
                                       8      DCS_TRIG_SERIES             0        Writing 1 to this bit selects a
                                              _0                                   series of DC offset corrections
                                                                                   for HPOUT1L.
                                                                                   In readback, a value of 1
                                                                                   indicates that the DC Servo DAC
                                                                                   Write correction is in progress.
                 R85 (0055h)         11:5     DCS_SERIES_NO_          010 1010     Number of DC Servo updates to
                 DC Servo (2)                 01 [6:0]                             perform in a series event.
                                                                                   0 = 1 update
                                                                                   1 = 2 updates
                                                                                   ...
                                                                                   127 = 128 updates
                                      3:0     DCS_TIMER_PERI            1010       Time between periodic updates.
                                              OD_01 [3:0]                          Time is calculated as
                                                                                   0.251s x (2^PERIOD),
                                                                                   where PERIOD =
                                                                                   DCS_TIMER_PERIOD_01.
                                                                                   0000 = Off
                                                                                   0001 = 0.502s
                                                                                   ….
                                                                                   1010 = 257s (4min 17s)
                                                                                   1111 = 8225s (2hr 17min)
               Table 78 DC Servo Active Modes
               GPIO / INTERRUPT OUTPUTS FROM DC SERVO
               When using the DC Servo Start-Up or DAC Write modes, the DCS_CAL_COMPLETE register
               provides readback of the status of the DC offset correction. This can be read from register R88 as
               described in Table 77.
               The DCS_CAL_COMPLETE bits can also be used as inputs to the Interrupt control circuit and used to
               trigger an Interrupt event - see “Interrupts”.
               The DCS_CAL_COMPLETE bits can also be used as inputs to the GPIO function and used to
               generate external logic signals indicating the DC Servo status. See “General Purpose Input/Output”
               for details of how to configure a GPIO pin to output the DC Servo status.
                                                                                             PP, March 2014, Rev 3.5
w
                                                                                                                    141


WM8958                                                                                            Pre-Production
ANALOGUE OUTPUTS
              The speaker, headphone, earpiece and line outputs are highly configurable and may be used in many
              different ways.
              SPEAKER OUTPUT CONFIGURATIONS
              The speaker outputs SPKOUTL and SPKOUTR can be driven by either of the speaker mixers,
              SPKMIXL or SPKMIXR, or by the low power, differential Direct Voice path from IN2LP/VRXN and
              IN2RP/VRXP. Fine volume control is available on the speaker mixer paths using the SPKLVOL and
              SPKRVOL PGAs. A boost function is available on both the speaker mixer paths and the Direct Voice
              path. For information on the speaker mixing options, refer to the “Analogue Output Signal Path”
              section.
              The speaker outputs SPKOUTL and SPKOUTR operate in a BTL configuration in Class AB or Class D
              amplifier modes. The default mode is Class D, but Class AB mode can be selected by setting the
              SPKOUT_CLASSAB register bit, as defined in Table 80.
              The speaker outputs can be configured as a pair of stereo outputs, or as a single mono output. Note
              that, for applications requiring only a single speaker output, it is possible to improve the THD
              performance by configuring the speaker outputs in mono mode. See “Typical Performance” for further
              details.
              The mono configuration is selected by applying a logic high input to the SPKMODE pin (A4), as
              described in Table 79. For Stereo mode this pin should be connected to GND. Note that SPKMODE is
              referenced to DBVDD1.
              An internal pull-up resistor is enabled by default on the SPKMODE pin; this can be configured using
              the SPKMODE_PU register bit described in Table 80.
                   SPEAKER CONFIGURATION                 SPKMODE PIN (A4)
                           Stereo Mode                           GND
                           Mono Mode                          DBVDD1
              Table 79 SPKMODE Pin Function
              In the mono configuration, the P channels, SPKOUTLP and SPKOUTRP should be connected
              together on the PCB, and similarly with the N channels, SPKOUTLN and SPKOUTRN, as illustrated in
              Figure 33. In this configuration both left and right speaker drivers should be enabled
              (SPKOUTL_ENA=1 and SPKOUTR_ENA=1), but path selection and volume controls are available on
              left channel only (SPKMIXL, SPKLVOL and SPKOUTLBOOST).
              Note that the minimum speaker load resistance and the maximum power output has a dependency on
              the SPKMODE output configuration, and also on the Class D/AB mode selection. See “Electrical
              Characteristics” for further details.
                                      Stereo                                          Mono
              Figure 33 Stereo / Mono Speaker Output Configurations
                                                                                         PP, March 2014, Rev 3.5
w
                                                                                                             142


Pre-Production                                                                                            WM8958
               Eight levels of AC signal boost are provided in order to deliver maximum output power for many
               commonly-used SPKVDD/AVDD1 combinations. (Note that SPKVDD1 powers the Left Speaker
               driver, and SPKVDD2 powers the Right Speaker driver; it is assumed that SPKVDD1 = SPKVDD2 =
               SPKVDD.)
               The signal boost options are available in both Class AB and Class D modes. The AC boost levels
               from 0dB to +12dB are selected using register bits SPKOUTL_BOOST and SPKOUTR_BOOST. To
               prevent pop noise, SPKOUTL_BOOST and SPKOUTR_BOOST should not be modified while the
               speaker outputs are enabled. Figure 34 illustrates the speaker outputs and the mixing and gain/boost
               options available.
               Ultra-low leakage and high PSRR allow the speaker supply SPKVDD to be directly connected to a
               lithium battery. Note that an appropriate SPKVDD supply voltage must be provided to prevent
               waveform clipping when speaker boost is used.
               DC gain is applied automatically in both Class AB and Class D modes with a shift from VMID to
               SPKVDD/2. This provides optimum signal swing for maximum output power. In Class AB mode, an
               ultra-high PSRR mode is available, in which the DC reference for the speaker driver is fixed at VMID.
               This mode is selected by enabling the SPKAB_REF_SEL bit (see Table 80). In this mode, the output
               power is limited but the driver will still be capable of driving more than 500mW in 8 while maintaining
               excellent suppression of noise on SPKVDD (for example, TDMA noise in a GSM phone application).
               The AC and DC gain functions are illustrated in Figure 34.
               Figure 34 Speaker Output Configuration and AC Boost Operation
                                                                                              PP, March 2014, Rev 3.5
w
                                                                                                                   143


WM8958                                                                                        Pre-Production
           REGISTER         BIT           LABEL           DEFAULT                 DESCRIPTION
           ADDRESS
         R35 (0023h)         8      SPKOUT_CLASSAB             0       Speaker Class AB Mode Enable
         SPKMIXR                                                       0 = Class D mode
         Attenuation                                                   1 = Class AB mode
         R37 (0025h)        5:3     SPKOUTL_BOOST             000      Left Speaker Gain Boost
         ClassD                     [2:0]                    (1.0x)    000 = 1.00x boost (+0dB)
                                                                       001 = 1.19x boost (+1.5dB)
                                                                       010 = 1.41x boost (+3.0dB)
                                                                       011 = 1.68x boost (+4.5dB)
                                                                       100 = 2.00x boost (+6.0dB)
                                                                       101 = 2.37x boost (+7.5dB)
                                                                       110 = 2.81x boost (+9.0dB)
                                                                       111 = 3.98x boost (+12.0dB)
                            2:0     SPKOUTR_BOOST             000      Right Speaker Gain Boost
                                    [2:0]                    (1.0x)    000 = 1.00x boost (+0dB)
                                                                       001 = 1.19x boost (+1.5dB)
                                                                       010 = 1.41x boost (+3.0dB)
                                                                       011 = 1.68x boost (+4.5dB)
                                                                       100 = 2.00x boost (+6.0dB)
                                                                       101 = 2.37x boost (+7.5dB)
                                                                       110 = 2.81x boost (+9.0dB)
                                                                       111 = 3.98x boost (+12.0dB)
         R34 (0022h)         8      SPKAB_REF_SEL              0       Selects Reference for Speaker in
         SPKMIXL                                                       Class AB mode
         Attenuation                                                   0 = SPKVDD/2
                                                                       1 = VMID
         R1825               1      SPKMODE_PU                 1       SPKMODE Pull-up enable
         (0721h)                                                       0 = Disabled
         Pull Control                                                  1 = Enabled
         (2)
       Table 80 Speaker Mode and Boost Control
       Clocking of the Class D output driver is derived from SYSCLK. The clocking frequency division is
       configured automatically, according to the AIFn_SR and AIFnCLK_RATE registers. (See “Clocking
       and Sample Rates” for further details of the system clocks and control registers.)
       The Class D switching clock is enabled whenever SPKOUTL_ENA or SPKOUTR_ENA is set,
       provided also that SPKOUT_CLASSAB = 0. The frequency is as described in Table 81.
       When AIF1CLK is selected as the SYSCLK source (SYSCLK_SRC = 0), then the Class D clock
       frequency is controlled by the AIF1_SR and AIF1CLK_RATE registers.
       When AIF2CLK is selected as the SYSCLK source (SYSCLK_SRC = 1), then the Class D clock
       frequency is controlled by the AIF2_SR and AIF2CLK_RATE registers.
       Note that the applicable clocks (SYSCLK, AIF1CLK or AIF2CLK) must be present and enabled when
       using the speaker outputs in Class D mode.
                                                                                     PP, March 2014, Rev 3.5
w
                                                                                                        144


Pre-Production                                                                                            WM8958
                    SAMPLE                               SYSCLK RATE (AIFnCLK / fs ratio)
                  RATE (kHz)       128       192         256      384        512          768       1024      1536
                  8                256       256        341.3     256       341.3        256        341.3     256
                  11.025         352.8      352.8       352.8    352.8      352.8       352.8       352.8
                  12               384       384         384      384        384         384         384
                  16             341.3       384        341.3     384       341.3        384
                  22.05          352.8      352.8       352.8    352.8      352.8
                  24               384       384         384      384        384
                  32             341.3       384        341.3     384
                  44.1           352.8      352.8       352.8
                  48               384       384         384
                  88.2           352.8
                  96               384
               Table 81 Class D Switching Frequency (kHz)
               HEADPHONE OUTPUT CONFIGURATIONS
               The headphone outputs HPOUT1L and HPOUT1R are driven by the headphone output PGAs
               HPOUT1LVOL and HPOUT1RVOL. Each PGA has its own dedicated volume control, as described in
               the “Analogue Output Signal Path” section. The input to these PGAs can be either the output mixers
               MIXOUTL and MIXOUTR or the direct DAC1 outputs DAC1L and DAC1R.
               The headphone output driver is capable of driving up to 30mW into a 16Ω load or 25mW into a 32Ω
               load such as a stereo headset or headphones. The outputs are ground-referenced, eliminating any
               requirement for AC coupling capacitors. This is achieved by having separate positive and negative
               supply rails powered by an on-chip charge pump. A DC Servo circuit removes any DC offset from the
               headphone outputs, suppressing ‘pop’ noise and minimising power consumption. The Charge Pump
               and DC Servo are described separately (see “Charge Pump” and “DC Servo” respectively).
               It is recommended to connect a zobel network to the headphone output pins HPOUT1L and
               HPOUT1R for best audio performance in all applications. The components of the zobel network have
               the effect of dampening high frequency oscillations or instabilities that can arise outside the audio
               band under certain conditions. Possible sources of these instabilities include the inductive load of a
               headphone coil or an active load in the form of an external line amplifier. The capacitance of lengthy
               cables or PCB tracks can also lead to amplifier instability. The zobel network should comprise of a
               20 resistor and 100nF capacitor in series with each other, as illustrated in Figure 35.
               If any ground-referenced headphone output is not used, then the zobel network components can be
               omitted from the corresponding output pin, and the pin can be left floating. The respective headphone
               driver(s) should not be enabled in this case.
               Figure 35 Zobel Network Components for HPOUT1L and HPOUT1R
                                                                                              PP, March 2014, Rev 3.5
w
                                                                                                                 145


WM8958                                                                                             Pre-Production
       The headphone output incorporates a common mode, or ground loop, feedback path which provides
       rejection of system-related ground noise. The return path is via HPOUT1FB. This pin must be
       connected to ground for normal operation of the headphone output. No register configuration is
       required.
       Note that the HPOUT1FB pin should be connected to GND close to the headphone jack, as illustrated
       in Figure 35.
       EARPIECE DRIVER OUTPUT CONFIGURATIONS
       The earpiece driver outputs HPOUT2P and HPOUT2N are driven by the HPOUT2MIX output mixer,
       which can take inputs from the mixer output PGAs MIXOUTLVOL and MIXOUTRVOL, or from the low
       power, differential Direct Voice path IN2LP/VRXN and IN2RP/VRXP. Fine volume control is available
       on the output mixer paths using MIXOUTLVOL and MIXOUTRVOL. A selectable -6dB attenuation is
       available on the HPOUT2MIX output, as described in Table 73 (refer to the “Analogue Output Signal
       Path” section).
       The earpiece outputs are designed to operate in a BTL configuration, driving 50mW into a typical 16
       ear speaker.
       For suppression of pop noise there are two separate enables for the earpiece driver; HPOUT2_ENA
       enables the output stage and HPOUT2_IN_ENA enables the mixer and input stage.
       HPOUT2_IN_ENA should be enabled a minimum of 50s before HPOUT2_ENA – see “Control Write
       Sequencer” section for an example power sequence.
       LINE OUTPUT CONFIGURATIONS
       The four line outputs LINEOUT1P, LINEOUT1N, LINEOUT2P and LINEOUT2N provide a highly
       flexible combination of differential and single-ended configurations, each driven by a dedicated output
       mixer. There is a selectable -6dB gain option in each mixer to avoid clipping when mixing more than
       one signal into a line output. Additional volume control is available at other locations within each of the
       supported signal paths. For more information about the line output mixing options, refer to the
       “Analogue Output Signal Path” section.
       Typical applications for the line outputs (single-ended or differential) are:
                 Handset or headset microphone output to external voice CODEC
                 Stereo line output
                 Output to external speaker driver(s) to support additional loudspeakers
       When single-ended mode is selected for either LINEOUT1 or LINEOUT2, a buffered VMID must be
       enabled as a reference for the outputs. This is enabled by setting the LINEOUT_VMID_BUF_ENA bit
       as defined in Table 82.
          REGISTER         BIT                LABEL              DEFAULT                 DESCRIPTION
           ADDRESS
          R56 (0038h)       7       LINEOUT_VMID_BUF_E               0         Enables VMID reference for line
          AntiPOP (1)               NA                                         outputs in single-ended mode
                                                                               0 = Disabled
                                                                               1 = Enabled
       Table 82 LINEOUT VMID Buffer for Single-Ended Operation
       Some example line output configurations are listed and illustrated below.
                 Differential line output from Mic/Line input on IN1L PGA
                 Differential line output from Mic/Line input on IN1R PGA
                 Stereo differential line output from output mixers MIXOUTL and MIXOUTR
                 Stereo single-ended line output from output mixer to either LINEOUT1 or LINEOUT2
                 Mono single-ended line output from output mixer
                                                                                        PP, March 2014, Rev 3.5
w
                                                                                                             146


Pre-Production                                                                                                                              WM8958
                                                                                                         LINEOUT1NMIX
                                                                                               MIXOUTLVOL
                                                                                               MIXOUTRVOL
                                                                                                     IN1R            +                       LINEOUT1N
                                                                                                      IN1L
                                                                                                                             Ground Loop
                                                                                                             0dB or -6dB    Noise Rejection
                                                                                                         LINEOUT1PMIX
                                                                                               MIXOUTLVOL
                                                                    IN1L
                                                                    IN1R
                                                                                                      IN1L
                                                                                                     IN1R
                                                                                                                     +                       LINEOUT1P
                                                                                                             0dB or -6dB     Ground Loop
                                                                                                                            Noise Rejection
                                                                           Min = -57dB
                                                                           Max = +6dB
                                                                           Step = 1dB
                                                                             MIXOUTLVOL
                                                                           Min = -57dB
                                                                           Max = +6dB
                                                                           Step = 1dB
                                                                             MIXOUTRVOL
                                                                                                         LINEOUT2NMIX
                                                                                               MIXOUTLVOL
                                                                                              MIXOUTRVOL
                                                                                                    IN1R             +                       LINEOUT2N
                                                                                                     IN1L
                                                                                                                             Ground Loop
                                                                                                             0dB or -6dB    Noise Rejection
                                                                                                         LINEOUT2PMIX
                                                                                              MIXOUTRVOL
                                                                   IN1L
                                                                   IN1R
                                                                                                    IN1L
                                                                                                    IN1R
                                                                                                                     +                       LINEOUT2P
                                                                                                             0dB or -6dB     Ground Loop
                                                                                                                            Noise Rejection
               LINEOUT1N_MUTE=0, LINEOUT1P_MUTE=0             LINEOUT1N_MUTE=0, LINEOUT1P_MUTE=0
               LINEOUT2N_MUTE=0, LINEOUT2P_MUTE=0             LINEOUT2N_MUTE=0, LINEOUT2P_MUTE=0
               LINEOUT1_MODE=0                                LINEOUT1_MODE=0
               LINEOUT2_MODE=0                                LINEOUT2_MODE=0
               IN1L_TO_LINEOUT1P=1                            IN1R_TO_LINEOUT1P=1
               IN1R_TO_LINEOUT2P=1                            IN1L_TO_LINEOUT2P=1
               Figure 36 Differential Line Out from input PGA Figure 37 Differential Line Out from input PGA
               IN1L (to LINEOUT1) and IN1R (to LINEOUT2)      IN1R (to LINEOUT1) and IN1L (to LINEOUT2)
                                                                                                       LINEOUT1NMIX
                                                                                            MIXOUTLVOL
                                                                                            MIXOUTRVOL
                                                                                                 IN1R               +                       LINEOUT1N
                                                                                                  IN1L
                                                                                                            0dB or -6dB   Ground Loop
                                                                                                                         Noise Rejection
                                                                                                       LINEOUT1PMIX
                                                                                            MIXOUTLVOL
                                                                 IN1L
                                                                 IN1R
                                                                                                 IN1L
                                                                                                 IN1R
                                                                                                                    +                       LINEOUT1P
                                                                                                            0dB or -6dB
                                                                                                                          Ground Loop
                                                                                                                         Noise Rejection
                                                                         Min = -57dB
                                                                         Max = +6dB
                                                                         Step = 1dB
                                                                           MIXOUTLVOL
                                                                         Min = -57dB
                                                                         Max = +6dB
                                                                         Step = 1dB
                                                                           MIXOUTRVOL
                                                                                                       LINEOUT2NMIX
                                                                                            MIXOUTLVOL
                                                                                            MIXOUTRVOL
                                                                                                IN1R                +                       LINEOUT2N
                                                                                                 IN1L
                                                                                                                          Ground Loop
                                                                                                            0dB or -6dB  Noise Rejection
                                                                                                       LINEOUT2PMIX
                                                                                            MIXOUTRVOL
                                                                IN1L
                                                                IN1R
                                                                                                IN1L
                                                                                                IN1R
                                                                                                                    +                       LINEOUT2P
                                                                                                            0dB or -6dB
                                                                                                                          Ground Loop
                                                                                                                         Noise Rejection
               LINEOUT1N_MUTE=0, LINEOUT1P_MUTE=0             LINEOUT1N_MUTE=0, LINEOUT1P_MUTE=0
               LINEOUT2N_MUTE=0, LINEOUT2P_MUTE=0             LINEOUT2N_MUTE=0, LINEOUT2P_MUTE=0
               LINEOUT1_MODE=0                                LINEOUT1_MODE=1
               LINEOUT2_MODE=0                                MIXOUTL_TO_LINEOUT1P=1
               MIXOUTL_TO_LINEOUT1P=1                         MIXOUTR_TO_LINEOUT1N=1
               MIXOUTR_TO_LINEOUT2P=1                         LINEOUT_VMID_BUF_ENA=1
               Figure 38    Stereo Differential Line Out from Figure 39                Stereo Single-Ended Line Out from
               MIXOUTL and MIXOUTR                            MIXOUTL and MIXOUTR to LINEOUT1
                                                                                                                 PP, March 2014, Rev 3.5
w
                                                                                                                                                       147


WM8958                                                                                             Pre-Production
       LINEOUT1N_MUTE=0, LINEOUT1P_MUTE=0                    LINEOUT1N_MUTE=0, LINEOUT1P_MUTE=0
       LINEOUT2N_MUTE=0, LINEOUT2P_MUTE=0                    LINEOUT2N_MUTE=0, LINEOUT2P_MUTE=0
       LINEOUT1_MODE=1                                       LINEOUT1_MODE=1
       MIXOUTL_TO_LINEOUT2N=1                                LINEOUT2_MODE=1
       MIXOUTR_TO_LINEOUT2P=1                                MIXOUTL_TO_LINEOUT1N=1 and/or
       LINEOUT_VMID_BUF_ENA=1                                MIXOUTL_TO_LINEOUT1P=1
                                                             MIXOUTR_TO_LINEOUT2N=1 and/or
                                                             MIXOUTR_TO_LINEOUT2P=1
                                                             LINEOUT_VMID_BUF_ENA=1
       Figure 40    Stereo Single-Ended Line Out from        Figure 41      Mono Line Out to LINEOUT1N,
       MIXOUTL and MIXOUTR to LINEOUT2                       LINEOUT1P, LINEOUT2N, LINEOUT2P
           The line outputs incorporate a common mode, or ground loop, feedback path which provides rejection
           of system-related ground noise. The return path, via LINEOUTFB, is enabled separately for
           LINEOUT1 and LINEOUT2 using the LINEOUT1_FB and LINEOUT2_FB bits as defined in Table 83.
           Ground loop feedback is a benefit to single-ended line outputs only; it is not applicable to differential
           outputs, which already inherently offer common mode noise rejection.
             REGISTER         BIT             LABEL            DEFAULT                 DESCRIPTION
              ADDRESS
             R55 (0037h)       7     LINEOUT1_FB                   0       Enable ground loop noise
             Additional                                                    feedback on LINEOUT1
             Control                                                       0 = Disabled
                                                                           1 = Enabled
                               6     LINEOUT2_FB                   0       Enable ground loop noise
                                                                           feedback on LINEOUT2
                                                                           0 = Disabled
                                                                           1 = Enabled
           Table 83 Line Output Ground Loop Feedback Enable
                                                                                        PP, March 2014, Rev 3.5
w
                                                                                                               148


Pre-Production                                                                                            WM8958
EXTERNAL ACCESSORY DETECTION
               The WM8958 accessory detection circuit measures the impedance of an external load connected to
               the MICDET pin. This feature can be used to detect the insertion or removal of a microphone, and the
               status of the associated hookswitch. It can also be used to detect push-button status or the
               connection of other external accessories.
               The microphone detection circuit measures the impedance connected to MICDET, and reports
               whether the measured impedance lies within one of 9 pre-defined levels (including the ‘no accessory
               detected’ level). This means it can detect the presence of a typical microphone and up to 7 push-
               buttons. One of the impedance levels is specifically designed to detect a video accessory (typical
               75Ω) load if required.
               The microphone detection circuit uses the MICBIAS2 output as a reference. The WM8958 will
               automatically enable MICBIAS2 when required in order to perform the detection function; this allows
               the detection function to be supported in low-power standby operating conditions.
               Microphone detection is enabled by setting the MICD_ENA register. When microphone detection is
               enabled, the WM8958 performs a number of measurements in order to determine the MICDET
               impedance. The measurement process is repeated at a cyclic rate controlled by MICD_RATE. (The
               MICD_RATE register selects the delay between completion of one measurement and the start of the
               next.)
               For best accuracy, the measured impedance is only deemed valid after more than one successive
               measurement has produced the same result. The MICD_DBTIME register provides control of the de-
               bounce period; this can be either 2 measurements or 4 measurements.
               When the microphone detection result has settled (ie. after the applicable de-bounce period), the
               WM8958 indicates valid data by setting the MICD_VALID bit. The measured impedance is indicated
               using the MICD_LVL and MICD_STS register bits, as described in Table 84.
               The MICD_VALID bit, when set, remains asserted for as long as the microphone detection function is
               enabled (ie. while MICD_ENA = 1). If the detected impedance changes, then the MICD_LVL and
               MICD_STS fields will change, but the MICD_VALID bit will remain set, indicating valid data at all
               times.
               Note that the impedance levels quoted in the MICD_LVL description assume that a microphone (475Ω
               to 30kΩ impedance) is also present on the MICDET pin. The limits quoted in the “Electrical
               Characteristics” refer to the combined effective impedance on the MICDET pin. Typical external
               components are described in the “Applications Information” section.
               The microphone detection reports a measurement result in one of the pre-defined impedance levels.
               Each measurement level can be enabled or disabled independently; this provides flexibility according
               to the required thresholds, and offers a faster measurement time in some applications. The
               MICD_LVL_SEL register is described in detail later in this section.
               Clocking for the microphone detection function is derived from SYSCLK (defined in the “Clocking and
               Sample Rates” section).
               When AIF1CLK is selected as the SYSCLK source (SYSCLK_SRC = 0), then AIF1CLK must be
               present and enabled when using the accessory detect function. The AIF1_SR and AIF1CLK_RATE
               registers must be set to values that are consistent with the available AIF1CLK frequency.
               When AIF2CLK is selected as the SYSCLK source (SYSCLK_SRC = 1), then AIF2CLK must be
               present and enabled when using the accessory detect function. The AIF2_SR and AIF2CLK_RATE
               registers must be set to values that are consistent with the available AIF2CLK frequency.
               The Frequency Locked Loop (FLL) free-running mode provides flexibility to clock the microphone
               detection function without any external reference clock, eg. in low-power standby operating conditions.
               See “Clocking and Sample Rates” for details of the WM8958 clocking options and FLL.
               The accessory detection function can also be supported using a low frequency (eg. 32kHz) clock, as
               described later in this section, see “Accessory Detection with Low Frequency SYSCLK”.
               The microphone detection function is an input to the Interrupt control circuit and can be used to trigger
               an Interrupt event every time an accessory insertion, removal or impedance change is detected. See
               “Interrupts” for further details.
                                                                                               PP, March 2014, Rev 3.5
w
                                                                                                                    149


WM8958                                                                                              Pre-Production
       The microphone detection function can also generate a GPIO output, providing an external indication
       of the microphone detection. This GPIO output is pulsed every time an accessory insertion, removal
       or impedance change is detected. See “General Purpose Input/Output” for details of how to configure
       a GPIO pin to output the microphone detection signal.
       The register fields associated with Microphone Detection (or other accessories) are described in Table
       84. The external circuit configuration is illustrated in Figure 42.
          REGISTER         BIT             LABEL                DEFAULT                 DESCRIPTION
          ADDRESS
        R208              15:12   MICD_BIAS_STARTTI               0101     Mic Detect Bias Startup Delay
        (00D0h)                   ME [3:0]                                 (If MICBIAS2 is not enabled already,
        Mic Detect 1                                                       this field selects the delay time
                                                                           allowed for MICBIAS2 to startup prior
                                                                           to performing the MICDET function.)
                                                                           0000 = 0ms (continuous)
                                                                           0001 = 0.25ms
                                                                           0010 = 0.5ms
                                                                           0011 = 1ms
                                                                           0100 = 2ms
                                                                           0101 = 4ms
                                                                           0110 = 8ms
                                                                           0111 = 16ms
                                                                           1000 = 32ms
                                                                           1001 = 64ms
                                                                           1010 = 128ms
                                                                           1011 = 256ms
                                                                           1100 to 1111 = 512ms
                          11:8    MICD_RATE [3:0]                 0110     Mic Detect Rate
                                                                           (Selects the delay between
                                                                           successive Mic Detect
                                                                           measurements.)
                                                                           0000 = 0ms (continuous)
                                                                           0001 = 0.25ms
                                                                           0010 = 0.5ms
                                                                           0011 = 1ms
                                                                           0100 = 2ms
                                                                           0101 = 4ms
                                                                           0110 = 8ms
                                                                           0111 = 16ms
                                                                           1000 = 32ms
                                                                           1001 = 64ms
                                                                           1010 = 128ms
                                                                           1011 = 256ms
                                                                           1100 to 1111 = 512ms
                            1     MICD_DBTIME                       0      Mic Detect De-bounce
                                                                           0 = 2 measurements
                                                                           1 = 4 measurements
                            0     MICD_ENA                          0      Mic Detect Enable
                                                                           0 = Disabled
                                                                           1 = Enabled
                                                                                         PP, March 2014, Rev 3.5
w
                                                                                                              150


Pre-Production                                                                                          WM8958
                   REGISTER         BIT           LABEL            DEFAULT                  DESCRIPTION
                   ADDRESS
                 R209              7:0     MICD_LVL_SEL [7:0]        0111_      Mic Detect Level Select
                 (00D1h)                                              1111      (enables Mic Detection in specific
                 Mic Detect 2                                                   impedance ranges)
                                                                                [7] = Not used - must be set to 0
                                                                                [6] = Enable >475 ohm detection
                                                                                [5] = Enable 326 ohm detection
                                                                                [4] = Enable 152 ohm detection
                                                                                [3] = Enable 77 ohm detection
                                                                                [2] = Enable 47.6 ohm detection
                                                                                [1] = Enable 29.4 ohm detection
                                                                                [0] = Enable 14 ohm detection
                                                                                Note that the impedance values
                                                                                quoted assume that a microphone
                                                                                (475ohm-30kohm) is also present on
                                                                                the MICDET pin.
                 R210              10:2    MICD_LVL [8:0]           0_0000_     Mic Detect Level
                 (00D2h)                                              0000      (indicates the measured impedance)
                 Mic Detect 3                                                   [8] = Not used
                                                                                [7] = >475 ohm, <30k ohm
                                                                                [6] = 326 ohm
                                                                                [5] = 152 ohm
                                                                                [4] = 77 ohm
                                                                                [3] = 47.6 ohm
                                                                                [2] = 29.4 ohm
                                                                                [1] = 14 ohm
                                                                                [0] = <3 ohm
                                                                                Note that the impedance values
                                                                                quoted assume that a microphone
                                                                                (475ohm-30kohm) is also present on
                                                                                the MICDET pin.
                                     1     MICD_VALID                   0       Mic Detect Data Valid
                                                                                0 = Not Valid
                                                                                1 = Valid
                                     0     MICD_STS                     0       Mic Detect Status
                                                                                0 = No Mic Accessory present
                                                                                (impedance is >30k ohm)
                                                                                1 = Mic Accessory is present
                                                                                (impedance is <30k ohm)
               Table 84 Microphone Detect Control
               The external connections for the Microphone Detect circuit are illustrated in Figure 42. In typical
               applications, it can be used to detect a microphone or button press.
               The microphone detection function uses MICBIAS2 as a reference. The microphone detection
               function will automatically enable MICBIAS2 when required for MICDET impedance measurement.
               If MICBIAS2 is not already enabled (ie. if MICB2_ENA = 0), then MICBIAS2 will be enabled for short
               periods of time only, every time the impedance measurement is scheduled. To allow time for the
               MICBIAS2 source to start-up, a time delay is applied before the measurement is performed; this is
               configured using the MICD_BIAS_STARTTIME register, as described in Table 84.
               The MICD_BIAS_STARTTIME register should be set to 16ms or more if MICB2_RATE = 1 (pop-free
               start-up / shut-down). The MICD_BIAS_STARTTIME register should be set to 0.25ms or more if
               MICB2_RATE = 0 (fast start-up / shut-down).
               If the MICBIAS2 reference is not enabled continuously (ie. if MICB2_ENA = 0), then the MICBIAS2
               discharge bit (MICB2_DISCH) should be set to 0.
                                                                                             PP, March 2014, Rev 3.5
w
                                                                                                                   151


WM8958                                                                                             Pre-Production
       The MICBIAS sources are configured using the registers described in Table 1, in the “Analogue Input
       Signal Path” section.
       Figure 42 Microphone Detect Interface
       The MICD_LVL_SEL [7:0] register bits allow each of the impedance measurement levels to be
       enabled or disabled independently. This allows the function to be tailored to the particular application
       requirements.
       If one or more bits within the MICD_LVL_SEL register is set to 0, then the corresponding impedance
       level will be disabled. Any measured impedance which lies in a disabled level will be reported as the
       next lowest, enabled level.
       For example, the MICD_LVL_SEL [3] bit enables the detection of impedances around 77. If
       MICD_LVL_SEL [3] = 0, then an external impedance of 77 will not be indicated as 77 but will be
       indicated as 47; this would be reported in the MICD_LVL register as MICD_LVL [3] = 1.
       With all measurement levels enabled, the WM8958 can detect the presence of a typical microphone
       and up to 7 push-buttons. The microphone detect function is specifically designed to detect a video
       accessory (typical 75) load if required.
       See “Applications Information” for typical recommended external components for microphone, video
       or push-button accessory detection.
       The microphone detection circuit assumes that a 2.2k (2%) resistor is connected to MICBIAS2, as
       illustrated. Different resistor values will lead to inaccuracy in the impedance measurement.
       The measurement accuracy of the microphone detect function is assured whenever the connected
       load is within the applicable limits specified in the “Electrical Characteristics”. Note that a 2.2k (2%)
       resistor must also be connected between MICDET and MICBIAS2.
       Note that the connection of a microphone will change the measured impedance on the MICDET pin;
       see “Applications Information” for recommended components for typical applications.
       The measurement time varies between 100s and 500s according to the impedance of the external
       load. A high impedance will be measured faster than a low impedance.
                                                                                        PP, March 2014, Rev 3.5
w
                                                                                                              152


Pre-Production                                                                                                WM8958
                         The timing of the microphone detect function is illustrated in Figure 43. Two different cases are
                         shown, according to whether MICBIAS2 is enabled periodically by the impedance measurement
                         function (MICB2_ENA=0), or is enabled at all times (MICB2_ENA=1).
Figure 43 Microphone Detect Timing
                         ACCESSORY DETECTION WITH LOW FREQUENCY SYSCLK
                         Clocking for the microphone detection function can be derived from AIF1CLK or AIF2CLK, as
                         described earlier.
                         Under normal circumstances, the AIFn_SR and AIFnCLK_RATE registers must be set to values that
                         are consistent with the available AIFnCLK frequency. The register settings support AIFnCLK
                         frequencies of 1.024MHz or higher.
                         The microphone detection function can also be supported using a low frequency (eg. 32kHz) clock. In
                         this case, the selected SYSCLK source (AIF1CLK or AIF2CLK) should be configured with the
                         following register settings:
                                         AIFnCLK_RATE = 0001 (AIFnCLK / fs = 128)
                                         AIFn_SR = 0000 (fs = 8kHz).
                         The register settings above configure the WM8958 for AIFnCLK = 1.024MHz. If the available clock is
                         a different frequency (eg. 32kHz), then the timings set by the MICD_RATE and
                         MICD_BIAS_STARTUP registers will be scaled accordingly. In the case of a 32kHz clock, these times
                         will be extended by a factor of 32 (calculated as 1024000 / 32000).
                         For example, under normal circumstances, setting MICD_RATE = 0011 selects a 1ms delay between
                         successive measurements. Using a 32kHz reference clock, and the register settings above, then
                         MICD_RATE = 0011 will select a 32ms delay.
                                                                                                  PP, March 2014, Rev 3.5
w
                                                                                                                       153


WM8958                                                                                                      Pre-Production
GENERAL PURPOSE INPUT/OUTPUT
              The WM8958 provides a number of GPIO functions to enable interfacing and detection of external
              hardware and to provide logic outputs to other devices. The input functions can be polled directly or
              can be used to generate an Interrupt (IRQ) event. The GPIO and Interrupt circuits support the
              following functions:
                        Alternate interface functions (AIF2, AIF3)
                        Button detect (GPIO input)
                        Logic ‘1’ and logic ‘0’ output (GPIO output)
                        Interrupt (IRQ) status output
                        Over-Temperature detection
                        Microphone accessory status detection
                        Frequency Locked Loop (FLL) Lock status output
                        Sample Rate Conversion (SRC) Lock status output
                        Dynamic Range Control (DRC) Signal activity detection
                        Control Write Sequencer status output
                        Digital Core FIFO error status output
                        Clock output (SYSCLK divided by OPCLK_DIV)
                        Frequency Locked Loop (FLL) Clock output
              GPIO CONTROL
              For each GPIO, the selected function is determined by the GPn_FN field, where n identifies the GPIO
              pin (1, 6, 8, 9, 10, 11). The pin direction, set by GPn_DIR, must be set according to function selected
              by GPn_FN.
              The alternate audio interfaces AIF2 and AIF3 are both supported using GPIO pins; the applicable pin
              functions are selected by setting the corresponding GPn_FN register to 00h. See Table 86 for the
              definition of which AIF function is available on each GPIO pin.
              See “Digital Audio Interface Control” for details of AIF2 and AIF3.
              When a pin is configured as a GPIO input (GPn_DIR = 1), the logic level at the pin can be read from
              the respective GPn_LVL bit. Note that GPn_LVL is not affected by the GPn_POL bit.
              A de-bounce circuit can be enabled on any GPIO input, to avoid false event triggers. This is enabled
              on each pin by setting the respective GPn_DB bit.
              When a pin is configured as a Logic Level output (GPn_DIR = 0, GPn_FN = 01h), its level can be set
              to logic 0 or logic 1 using the GPn_LVL field.
              When a pin is configured as an output (GPn_DIR = 0), the polarity can be inverted using the
              GPn_POL bit. When GPn_POL = 1, then the selected output function is inverted. In the case of Logic
              Level output (GPn_FN = 01h), the external output will be the opposite logic level to GPn_LVL when
              GPn_POL = 1.
              A GPIO output can be either CMOS driven or Open Drain. This is selected on each pin using the
              respective GPn_OP_CFG bit.
              Internal pull-up and pull-down resistors may be enabled using the GPn_PU and GPn_PD fields; this
              allows greater flexibility to interface with different signals from other devices. (Note that if GPn_PU and
              GPn_PD are both set for any GPIO pin, then the pull-up and pull-down will be disabled.)
              Each of the GPIO pins is an input to the Interrupt control circuit and can be used to trigger an Interrupt
              event. An interrupt event is triggered on the rising and falling edge of the GPIO input. The associated
              interrupt bit is latched once set; it can be polled at any time or used to control the IRQ signal. See
              “Interrupts” for more details of the Interrupt event handling.
                                                                                                 PP, March 2014, Rev 3.5
w
                                                                                                                      154


Pre-Production                                                                                              WM8958
               The register fields that control the GPIO pins are described in Table 85.
                  REGISTER            BIT            LABEL         DEFAULT                    DESCRIPTION
                   ADDRESS
                R1792                 15       GPn_DIR                   1         GPIOn Pin Direction
                (0700h)                                                            0 = Output
                GPIO 1                                                             1 = Input
                                      14       GPn_PU                    0         GPIOn Pull-Up Enable
                R1797                                                              0 = Disabled
                (0705h)
                                                                                   1 = Enabled
                GPIO 6
                                      13       GPn_PD                    1         GPIOn Pull-Down Enable
                                                                                   0 = Disabled
                R1799
                                                                                   1 = Enabled
                (0707h)
                                      10       GPn_POL                   0         GPIOn Polarity Select
                GPIO 8
                                                                                   0 = Non-inverted (Active High)
                                                                                   1 = Inverted (Active Low)
                to
                                       9       GPn_OP_CFG                0         GPIOn Output Configuration
                                                                                   0 = CMOS
                R1802
                (070Ah)                                                            1 = Open Drain
                GPIO 11                8       GPn_DB                    1         GPIOn Input De-bounce
                                                                                   0 = Disabled
                                                                                   1 = Enabled
                                       6       GPn_LVL                   0         GPIOn level. Write to this bit to set
                                                                                   a GPIO output. Read from this bit to
                                                                                   read GPIO input level.
                                                                                   For output functions only, when
                                                                                   GPn_POL is set, the register
                                                                                   contains the opposite logic level to
                                                                                   the external pin.
                                      4:0      GPn_FN [4:0]                        GPIOn Pin Function
                                                                                   (see Table 86 for details)
                                                                                   GP1_FN default = 0000
                                                                                   GP6_FN default = 0001
                                                                                   GP8_FN default = 0001
                                                                                   GP9_FN default = 0001
                                                                                   GP10_FN default = 0001
                                                                                   GP11_FN default = 0001
                Note: n is a number (1, 6, 8, 9, 10, 11) that identifies the individual GPIO.
               Table 85 GPIO1, GPIO6, GPIO8, GPIO9, GPIO10 to GPIO11 Control
               GPIO FUNCTION SELECT
               The available GPIO functions are described in Table 86. The function of each GPIO is set using the
               GPn_FN register, where n identifies the GPIO pin (1, 6, 8, 9, 10, 11). Note that the respective
               GPn_DIR must also be set according to whether the function is an input or output.
                 GPn_FN            DESCRIPTION                                     COMMENTS
                    00h        GPIO1 - ADCLRCLK1          Alternate Audio Interface connections.
                               GPIO6 - ADCLRCLK2
                               GPIO8 - DACDAT3
                               GPIO9 - ADCDAT3
                               GPIO10 - LRCLK3
                               GPIO11 - BCLK3
                    01h        Button detect input /      GPn_DIR = 0: GPIO pin logic level is set by GPn_LVL.
                               Logic level output         GPn_DIR = 1: Button detect or logic level input.
                    02h        Reserved
                                                                                                PP, March 2014, Rev 3.5
w
                                                                                                                       155


WM8958                                                                                 Pre-Production
         GPn_FN        DESCRIPTION                               COMMENTS
           03h     IRQ                   Interrupt (IRQ) output
                                         0 = IRQ not asserted
                                         1 = IRQ asserted
           04h     Temperature           Indicates Temperature Shutdown Sensor status
                   (Shutdown) status     0 = Temperature is below shutdown level
                   output
                                         1 = Temperature is above shutdown level
           05h     Microphone Detect     Microphone Detect (MICDET accessory) IRQ output
                                         A single 31s pulse is output whenever an accessory
                                         insertion, removal or impedance change is detected.
           06h     Reserved
           07h     Reserved
           08h     Reserved
           09h     FLL1 Lock             Indicates FLL1 Lock status
                                         0 = Not locked
                                         1 = Locked
           0Ah     FLL2 Lock             Indicates FLL2 Lock status
                                         0 = Not locked
                                         1 = Locked
           0Bh     SRC1 Lock             Indicates SRC1 Lock status
                                         0 = Not locked
                                         1 = Locked
           0Ch     SRC2 Lock             Indicates SRC2 Lock status
                                         0 = Not locked
                                         1 = Locked
           0Dh     AIF1 DRC1 Signal      Indicates AIF1 DRC1 Signal Detect status
                   Detect                0 = Signal threshold not exceeded
                                         1 = Signal threshold exceeded
           0Eh     AIF1 DRC2 Signal      Indicates AIF1 DRC2 Signal Detect status
                   Detect                0 = Signal threshold not exceeded
                                         1 = Signal threshold exceeded
           0Fh     AIF2 DRC Signal       Indicates AIF2 DRC Signal Detect status
                   Detect                0 = Signal threshold not exceeded
                                         1 = Signal threshold exceeded
           10h     Write Sequencer       Indicates Write Sequencer status
                   Status                0 = Write Sequencer Idle
                                         1 = Write Sequence Busy
           11h     FIFO Error            Indicates a Digital Core FIFO Error condition
                                         0 = Normal operation
                                         1 = FIFO Error
           12h     Clock Output OPCLK    GPIO Clock derived from SYSCLK
           13h     Temperature (Warning) Indicates Temperature Warning Sensor status
                   status output         0 = Temperature is below warning level
                                         1 = Temperature is above warning level
           14h     DC Servo Done         Indicates DC Servo status on HPOUT1L and HPOUT1R
                                         0 = DC Servo not complete
                                         1 = DC Servo complete
           15h     FLL1 Clock Output     Clock output from FLL1
           16h     FLL2 Clock Output     Clock output from FLL2
        17h to 1Fh Reserved
       Table 86 GPIO Function Select
                                                                             PP, March 2014, Rev 3.5
w
                                                                                                 156


Pre-Production                                                                                            WM8958
               BUTTON DETECT (GPIO INPUT)
               Button detect functionality can be selected on any GPIO pin by setting the respective GPIO registers
               as described in “GPIO Control”. The same functionality can be used to support a Jack Detect input
               function.
               It is recommended to enable the GPIO input de-bounce feature when using GPIOs as button input or
               Jack Detect input.
               The GPn_LVL fields may be read to determine the logic levels on a GPIO input, after the selectable
               de-bounce controls. Note that GPn_LVL is not affected by the GPn_POL bit.
               The de-bounced GPIO signals are also inputs to the Interrupt control circuit. An interrupt event is
               triggered on the rising and falling edge of the GPIO input. The associated interrupt bits are latched
               once set; it can be polled at any time or used to control the IRQ signal. See “Interrupts” for more
               details of the Interrupt event handling.
               LOGIC ‘1’ AND LOGIC ‘0’ OUTPUT (GPIO OUTPUT)
               The WM8958 can be programmed to drive a logic high or logic low level on any GPIO pin by selecting
               the “GPIO Output” function as described in “GPIO Control”. The output logic level is selected using the
               respective GPn_LVL bit.
               Note that the polarity of the GPIO output can be inverted using the GPn_POL registers. If GPn_POL =
               1, then the external output will be the opposite logic level to GPn_LVL.
               INTERRUPT (IRQ) STATUS OUTPUT
               The WM8958 has an Interrupt Controller which can be used to indicate when any selected Interrupt
               events occur. An interrupt can be generated by any of the events described throughout the GPIO
               function definition above. Individual interrupts may be masked in order to configure the Interrupt as
               required. See “Interrupts” for further details.
               The Interrupt (IRQ) status may be output directly on any GPIO pin by setting the respective GPIO
               registers as described in “GPIO Control”.
               OVER-TEMPERATURE DETECTION
               The WM8958 incorporates a temperature sensor which detects when the device temperature is within
               normal limits or if the device is approaching a hazardous temperature condition.
               The Temperature status may be output directly on any GPIO pin by setting the respective GPIO
               registers as described in “GPIO Control”. Any GPIO pin can be used to indicate either a Warning
               Temperature event or the Shutdown Temperature event. De-bounce can be applied to the applicable
               signal using the register bits described in Table 87.
               The Warning Temperature and Shutdown Temperature status are inputs to the Interrupt control circuit,
               after the selectable de-bounce. An interrupt event may be triggered on the rising and falling edges of
               these signals. The associated interrupt bit is latched once set; it can be polled at any time or used to
               control the IRQ signal. See “Interrupts” for more details of the Interrupt event handling.
               Note that the temperature sensor can be configured to automatically disable the audio outputs of the
               WM8958 (see “Thermal Shutdown”). In some applications, it may be preferable to manage the
               temperature sensor event through GPIO or Interrupt functions, allowing a host processor to implement
               a controlled system response to an over-temperature condition.
               The temperature sensor must be enabled by setting the TSHUT_ENA register bit. When the
               TSHUT_OPDIS is also set, then a device over-temperature condition will cause the speaker outputs
               (SPKOUTL and SPKOUTR) of the WM8958 to be disabled.
                                                                                               PP, March 2014, Rev 3.5
w
                                                                                                                   157


WM8958                                                                                           Pre-Production
           REGISTER         BIT        LABEL         DEFAULT                      DESCRIPTION
            ADDRESS
          R2 (0002h)         14     TSHUT_EN             1         Thermal sensor enable
          Power                     A                              0 = Disabled
          Management                                               1 = Enabled
          (2)
                             13     TSHUT_OP             1         Thermal shutdown control
                                    DIS                            (Causes audio outputs to be disabled if an
                                                                   overtemperature occurs. The thermal sensor
                                                                   must also be enabled.)
                                                                   0 = Disabled
                                                                   1 = Enabled
          R1864               0     TEMP_WAR             0         Thermal Warning de-bounce
          (0748h)                   N_DB                           0 = Disabled
          IRQ                                                      1 = Enabled
          Debounce
                              0     TEMP_SHU             0         Thermal shutdown de-bounce
                                    T_DB                           0 = Disabled
                                                                   1 = Enabled
       Table 87 Temperature Sensor Enable and GPIO/Interrupt Control
       MICROPHONE ACCESSORY STATUS DETECTION
       The WM8958 provides an impedance measurement circuit on the MICDET pin to detect the
       connection of a microphone or other external accessory. See “External Accessory Detection” for
       further details.
       A logic signal from the microphone detect circuit may be output directly on any GPIO pin by setting the
       respective GPIO registers as described in “GPIO Control”. This logic signal is set high for a single
       pulse duration of 31s whenever an accessory insertion, removal or impedance change is detected.
       The microphone detection circuit is also an input to the Interrupt control circuit. An interrupt event is
       triggered whenever an accessory insertion, removal or impedance change is detected. The
       associated interrupt bit is latched once set; it can be polled at any time or used to control the IRQ
       signal. See “Interrupts” for more details of the Interrupt event handling.
       FREQUENCY LOCKED LOOP (FLL) LOCK STATUS OUTPUT
       The WM8958 maintains a flag indicating the lock status of each of FLLs, which may be used to control
       other events if required. See “Clocking and Sample Rates” for more details of the FLL.
       The FLL Lock signals may be output directly on any GPIO pin by setting the respective GPIO registers
       as described in “GPIO Control”.
       The FLL Lock signals are inputs to the Interrupt control circuit. An interrupt event is triggered on the
       rising and falling edges of the FLL Lock signals. The associated interrupt bits are latched once set;
       they can be polled at any time or used to control the IRQ signal. See “Interrupts” for more details of
       the Interrupt event handling.
       SAMPLE RATE CONVERTER (SRC) LOCK STATUS OUTPUT
       The WM8958 maintains a flag indicating the lock status of each of Sample Rate Converters, which
       may be used to control other events if required. See “Sample Rate Conversion” for more details of the
       Sample Rate Converters.
       The SRC Lock signals may be output directly on any GPIO pin by setting the respective GPIO
       registers as described in “GPIO Control”.
       The SRC Lock signals are inputs to the Interrupt control circuit, after the selectable de-bounce. An
       interrupt event is triggered on the rising and falling edges of the SRC Lock signals. The associated
       interrupt bits are latched once set; they can be polled at any time or used to control the IRQ signal.
       See “Interrupts” for more details of the Interrupt event handling.
                                                                                      PP, March 2014, Rev 3.5
w
                                                                                                             158


Pre-Production                                                                                            WM8958
               DYNAMIC RANGE CONTROL (DRC) SIGNAL ACTIVITY DETECTION
               Signal activity detection is provided on each of the Dynamic Range Controllers (DRCs). These may be
               configured to indicate when a signal is present on the respective signal path. The signal activity status
               signals may be used to control other events if required. See “Digital Core Architecture” for more
               details of the DRCs and the available digital signal paths.
               When a DRC is enabled, as described in “Dynamic Range Control (DRC)”, then signal activity
               detection can be enabled by setting the respective [DRC]_SIG_DET register bit. The applicable
               threshold can be defined either as a Peak level (Crest Factor) or an RMS level, depending on the
               [DRC]_SIG_DET_MODE register bit. When Peak level is selected, the threshold is determined by
               [DRC]_SIG_DET_PK, which defines the applicable Crest Factor (Peak to RMS ratio) threshold. If
               RMS level is selected, then the threshold is set using [DRC]_SIG_DET_RMS. These register fields
               are set independently for each of the three Dynamic Range Controllers, as described in Table 88.
               When the DRC is enabled in any of the ADC (digital record) paths, the associated High Pass Filter
               (HPF) must be enabled also; this ensures that DC offsets are removed prior to the DRC processing.
               The output path HPF control registers are described in Table 41 (for AIF1 output paths) and Table 49
               (for AIF2 output paths). These are described in the “Digital Volume and Filter Control” section.
               The DRC Signal Detect signals may be output directly on any GPIO pin by setting the respective
               GPIO registers as described in “GPIO Control”.
               The DRC Signal Detect signals are inputs to the Interrupt control circuit. An interrupt event is triggered
               on the rising edge of the DRC Signal Detect signals. The associated interrupt bits are latched once
               set; they can be polled at any time or used to control the IRQ signal. See “Interrupts” for more details
               of the Interrupt event handling.
                   REGISTER          BIT           LABEL           DEFAULT                  DESCRIPTION
                   ADDRESS
                 R1088             15:11      AIF1DRC1_SIG_          00000      AIF1 DRC1 Signal Detect RMS
                 (0440h)                      DET_RMS [4:0]                     Threshold.
                 AIF1 DRC1                                                      This is the RMS signal level for signal
                 (1)                                                            detect to be indicated when
                                                                                AIF1DRC1_SIG_DET_MODE=1.
                                                                                00000 = -30dB
                                                                                00001 = -31.5dB
                                                                                …. (1.5dB steps)
                                                                                11110 = -75dB
                                                                                11111 = -76.5dB
                                    10:9      AIF1DRC1_SIG_            00       AIF1 DRC1 Signal Detect Peak
                                              DET_PK [1:0]                      Threshold.
                                                                                This is the Peak/RMS ratio, or Crest
                                                                                Factor, level for signal detect to be
                                                                                indicated when
                                                                                AIF1DRC1_SIG_DET_MODE=0.
                                                                                00 = 12dB
                                                                                01 = 18dB
                                                                                10 = 24dB
                                                                                11 = 30dB
                                      7       AIF1DRC1_SIG_             1       AIF1 DRC1 Signal Detect Mode
                                              DET_MODE                          0 = Peak threshold mode
                                                                                1 = RMS threshold mode
                                      6       AIF1DRC1_SIG_             0       AIF1 DRC1 Signal Detect Enable
                                              DET                               0 = Disabled
                                                                                1 = Enabled
                                                                                              PP, March 2014, Rev 3.5
w
                                                                                                                     159


WM8958                                                                                     Pre-Production
         REGISTER       BIT           LABEL          DEFAULT                  DESCRIPTION
          ADDRESS
        R1104          15:11    AIF1DRC2_SIG_          00000      AIF1 DRC2 Signal Detect RMS
        (0450h)                 DET_RMS [4:0]                     Threshold.
        AIF1 DRC2                                                 This is the RMS signal level for signal
        (1)                                                       detect to be indicated when
                                                                  AIF1DRC2_SIG_DET_MODE=1.
                                                                  00000 = -30dB
                                                                  00001 = -31.5dB
                                                                  …. (1.5dB steps)
                                                                  11110 = -75dB
                                                                  11111 = -76.5dB
                       10:9     AIF1DRC2_SIG_            00       AIF1 DRC2 Signal Detect Peak
                                DET_PK [1:0]                      Threshold.
                                                                  This is the Peak/RMS ratio, or Crest
                                                                  Factor, level for signal detect to be
                                                                  indicated when
                                                                  AIF1DRC2_SIG_DET_MODE=0.
                                                                  00 = 12dB
                                                                  01 = 18dB
                                                                  10 = 24dB
                                                                  11 = 30dB
                         7      AIF1DRC2_SIG_             1       AIF1 DRC2 Signal Detect Mode
                                DET_MODE                          0 = Peak threshold mode
                                                                  1 = RMS threshold mode
                         6      AIF1DRC2_SIG_             0       AIF1 DRC2 Signal Detect Enable
                                DET                               0 = Disabled
                                                                  1 = Enabled
        R1344          15:11    AIF2DRC_SIG_D          00000      AIF2 DRC Signal Detect RMS
        (0540h)                 ET_RMS [4:0]                      Threshold.
        AIF2 DRC (1)                                              This is the RMS signal level for signal
                                                                  detect to be indicated when
                                                                  AIF2DRC_SIG_DET_MODE=1.
                                                                  00000 = -30dB
                                                                  00001 = -31.5dB
                                                                  …. (1.5dB steps)
                                                                  11110 = -75dB
                                                                  11111 = -76.5dB
                       10:9     AIF2DRC_SIG_D            00       AIF2 DRC Signal Detect Peak
                                ET_PK [1:0]                       Threshold.
                                                                  This is the Peak/RMS ratio, or Crest
                                                                  Factor, level for signal detect to be
                                                                  indicated when
                                                                  AIF2DRC_SIG_DET_MODE=0.
                                                                  00 = 12dB
                                                                  01 = 18dB
                                                                  10 = 24dB
                                                                  11 = 30dB
                         7      AIF2DRC_SIG_D             1       AIF2 DRC Signal Detect Mode
                                ET_MODE                           0 = Peak threshold mode
                                                                  1 = RMS threshold mode
                         6      AIF2DRC_SIG_D             0       AIF2 DRC Signal Detect Enable
                                ET                                0 = Disabled
                                                                  1 = Enabled
       Table 88 DRC Signal Activity Detect GPIO/Interrupt Control
                                                                               PP, March 2014, Rev 3.5
w
                                                                                                      160


Pre-Production                                                                                              WM8958
               CONTROL WRITE SEQUENCER STATUS DETECTION
               The WM8958 Control Write Sequencer (WSEQ) can be used to execute a sequence of register write
               operations in response to a simple trigger event. When the Control Write Sequencer is executing a
               sequence, normal access to the register map via the Control Interface is restricted. See “Control Write
               Sequencer” for details of the Control Write Sequencer.
               The WM8958 generates a signal indicating the status of the Control Write Sequencer, in order to
               signal to the host processor whether the Control Interface functionality is restricted due to an ongoing
               Control Sequence. The WSEQ_DONE flag indicates that the sequencer has completed the
               commanded sequence.
               The Write Sequencer status may be output directly on any GPIO pin by setting the respective GPIO
               registers as described in “GPIO Control”.
               The Write Sequencer status is an input to the Interrupt control circuit. An interrupt event is triggered
               on completion of a Control Sequence. The associated interrupt bit is latched once set; it can be polled
               at any time or used to control the IRQ signal. See “Interrupts” for more details of the Interrupt event
               handling.
               DIGITAL CORE FIFO ERROR STATUS DETECTION
               The WM8958 monitors the Digital Core for error conditions which may occur if a clock rate mismatch
               is detected. Under these conditions, the digital audio may become corrupted.
               The most likely cause of a Digital Core FIFO Error condition is an incorrect system clocking
               configuration. See “Clocking and Sample Rates” for the WM8958 system clocking requirements.
               The Digital Core FIFO Error function is provided in order that the system configuration can be verified
               during product development.
               The FIFO Error signal may be output directly on any GPIO pin by setting the respective GPIO
               registers as described in “GPIO Control”.
               The FIFO Error signal is an input to the Interrupt control circuit. An interrupt event is triggered on the
               rising edge of the FIFO Error signal. The associated interrupt bit is latched once set; it can be polled at
               any time or used to control the IRQ signal. See “Interrupts” for more details of the Interrupt event
               handling.
               OPCLK CLOCK OUTPUT
               A clock output (OPCLK) derived from SYSCLK may be output on any GPIO pin by setting the
               respective GPIO registers as described in “GPIO Control”. This clock is enabled by register bit
               OPCLK_ENA, and its frequency is controlled by OPCLK_DIV.
               See “Clocking and Sample Rates” for more details of the System Clock (SYSCLK).
                   REGISTER         BIT       LABEL        DEFAULT                        DESCRIPTION
                    ADDRESS
                  R2 (0002h)       11      OPCLK_EN             0      GPIO Clock Output (OPCLK) Enable
                  Power                    A                           0 = Disabled
                  Management                                           1 = Enabled
                  (2)
                  R521 (0209h)      2:0    OPCLK_DIV          000      GPIO Output Clock (OPCLK) Divider
                  Clocking 1                                           000 = SYSCLK
                                                                       001 = SYSCLK / 2
                                                                       010 = SYSCLK / 3
                                                                       011 = SYSCLK / 4
                                                                       100 = SYSCLK / 6
                                                                       101 = SYSCLK / 8
                                                                       110 = SYSCLK / 12
                                                                       111 = SYSCLK / 16
               Table 89 OPCLK Control
                                                                                               PP, March 2014, Rev 3.5
w
                                                                                                                      161


WM8958                                                                                  Pre-Production
       FLL CLOCK OUTPUT
       The FLL Clock outputs may be output directly on any GPIO pin by setting the respective GPIO
       registers as described in “GPIO Control”.
       See “Clocking and Sample Rates” for more details of the WM8958 system clocking and for details of
       how to enable and configure the Frequency Locked Loops.
                                                                             PP, March 2014, Rev 3.5
w
                                                                                                   162


Pre-Production                                                                                                             WM8958
INTERRUPTS
                            The Interrupt Controller has multiple inputs. These include the GPIO input pins, the FLL Lock circuits,
                            SRC Lock circuit, Microphone activity detection, Over-temperature indication, Digital FIFO error
                            detection and the Write Sequencer status flag. Any combination of these inputs can be used to trigger
                            an Interrupt Request (IRQ) event.
                            There is an Interrupt register field associated with each of the interrupt inputs. These fields are
                            asserted whenever a logic edge is detected on the respective input. Some inputs are triggered on
                            rising edges only; some are triggered on both edges, as noted in Table 90. The Interrupt register fields
                            are held in Registers R1840 and R1841. The Interrupt flags can be polled at any time from these
                            registers, or else in response to the Interrupt Request (IRQ) output being signalled via a GPIO pin.
                            All of the Interrupts are edge-triggered, as noted above. Many of these are triggered on both the rising
                            and falling edges and, therefore, the Interrupt registers cannot indicate which edge has been
                            detected. The “Raw Status” fields in Register R1842 provide readback of the current value of selected
                            inputs to the Interrupt Controller. Note that the logic levels of any GPIO inputs can be read using the
                            GPn_LVL registers, as described in Table 85.
                            Individual mask bits can select or deselect different functions from the Interrupt controller. These are
                            listed within the Interrupt Status Mask registers, as described in Table 90. Note that the Interrupt
                            register fields remain valid, even when masked, but the masked interrupts will not cause the Interrupt
                            Request (IRQ) output to be asserted.
                            The Interrupt Request (IRQ) output represents the logical ‘OR’ of all the unmasked interrupts. The
                            Interrupt register fields are latching fields and, once they are set, they are not reset until a ‘1’ is written
                            to the respective register bit(s). The Interrupt Request (IRQ) output is not reset until each of the
                            unmasked interrupts has been reset.
                            De-bouncing of the GPIO inputs can be enabled using the register bits described in Table 85. De-
                            bouncing is also available on the Temperature Warning and Temperature Shutdown inputs to the
                            Interrupt Controller, in order to avoid false detections - see Table 90 for the associated registers.
                            The Interrupt Request (IRQ) output can be globally masked by setting the IM_IRQ register. Under
                            default conditions, the Interrupt Request (IRQ) is not masked.
                            The Interrupt Request (IRQ) flag may be output on a GPIO pin - see “General Purpose Input/Output”.
                            The WM8958 Interrupt Controller circuit is illustrated in Figure 44. (Note that not all interrupt inputs are
                            shown.) The associated control fields are described in Table 90.
Figure 44 Interrupt Controller
                                                                                                             PP, March 2014, Rev 3.5
w
                                                                                                                                      163


WM8958                                                                   Pre-Production
        REGISTER BIT    LABEL   DEFAULT                  DESCRIPTION
         ADDRESS
       R1840     10  GP11_EINT     0    GPIO11 Interrupt
       (0730h)                          (Rising and falling edge triggered)
       Interrupt                        Note: Cleared when a ‘1’ is written.
       Status 1
                  9  GP10_EINT     0    GPIO10 Interrupt
                                        (Rising and falling edge triggered)
                                        Note: Cleared when a ‘1’ is written.
                  8  GP9_EINT      0    GPIO9 Interrupt
                                        (Rising and falling edge triggered)
                                        Note: Cleared when a ‘1’ is written.
                  7  GP8_EINT      0    GPIO8 Interrupt
                                        (Rising and falling edge triggered)
                                        Note: Cleared when a ‘1’ is written.
                  5  GP6_EINT      0    GPIO6 Interrupt
                                        (Rising and falling edge triggered)
                                        Note: Cleared when a ‘1’ is written.
                  0  GP1_EINT      0    GPIO1 Interrupt
                                        (Rising and falling edge triggered)
                                        Note: Cleared when a ‘1’ is written.
       R1841     15  TEMP_WAR      0    Temperature Warning Interrupt
       (0731h)       N_EINT             (Rising and falling edge triggered)
       Interrupt                        Note: Cleared when a ‘1’ is written.
       Status 2
                 14  DCS_DONE      0    DC Servo Interrupt
                     _EINT              (Rising edge triggered)
                                        Note: Cleared when a ‘1’ is written.
                 13  WSEQ_DO       0    Write Sequencer Interrupt
                     NE_EINT            (Rising edge triggered)
                                        Note: Cleared when a ‘1’ is written.
                 12  FIFOS_ERR     0    Digital Core FIFO Error Interrupt
                     _EINT              (Rising edge triggered)
                                        Note: Cleared when a ‘1’ is written.
                 11  AIF2DRC_SI    0    AIF2 DRC Activity Detect Interrupt
                     G_DET_EIN          (Rising edge triggered)
                     T
                                        Note: Cleared when a ‘1’ is written.
                 10  AIF1DRC2_     0    AIF1 DRC2 (Timeslot 1) Activity Detect
                     SIG_DET_EI         Interrupt
                     NT                 (Rising edge triggered)
                                        Note: Cleared when a ‘1’ is written.
                  9  AIF1DRC1_     0    AIF1 DRC1 (Timeslot 0) Activity Detect
                     SIG_DET_EI         Interrupt
                     NT                 (Rising edge triggered)
                                        Note: Cleared when a ‘1’ is written.
                  8  SRC2_LOC      0    SRC2 Lock Interrupt
                     K_EINT             (Rising and falling edge triggered)
                                        Note: Cleared when a ‘1’ is written.
                  7  SRC1_LOC      0    SRC1 Lock Interrupt
                     K_EINT             (Rising and falling edge triggered)
                                        Note: Cleared when a ‘1’ is written.
                  6  FLL2_LOCK     0    FLL2 Lock Interrupt
                     _EINT              (Rising and falling edge triggered)
                                        Note: Cleared when a ‘1’ is written.
                  5  FLL1_LOCK     0    FLL1 Lock Interrupt
                     _EINT              (Rising and falling edge triggered)
                                        Note: Cleared when a ‘1’ is written.
                                                              PP, March 2014, Rev 3.5
w
                                                                                   164


Pre-Production                                                                        WM8958
                REGISTER     BIT    LABEL   DEFAULT                  DESCRIPTION
                 ADDRESS
                              1  MICD_EINT     0    Microphone Detection Interrupt
                                                    (Rising edge triggered)
                                                    Note: Cleared when a ‘1’ is written.
                              0  TEMP_SHU      0    Temperature Shutdown Interrupt
                                 T_EINT             (Rising and falling edge triggered)
                                                    Note: Cleared when a ‘1’ is written.
               R1842         15  TEMP_WAR      0    Temperature Warning status
               (0732h)           N_STS              0 = Temperature is below warning level
               Interrupt Raw                        1 = Temperature is above warning level
               Status 2
                             14  DCS_DONE      0    DC Servo status
                                 _STS               0 = DC Servo not complete
                                                    1 = DC Servo complete
                             13  WSEQ_DO       0    Write Sequencer status
                                 NE_STS             0 = Sequencer Busy (sequence in progress)
                                                    1 = Sequencer Idle
                             12  FIFOS_ERR     0    Digital Core FIFO Error status
                                 _STS               0 = Normal operation
                                                    1 = FIFO Error
                             11  AIF2DRC_SI    0    AIF2 DRC Signal Detect status
                                 G_DET_ST           0 = Signal threshold not exceeded
                                 S
                                                    1 = Signal threshold exceeded
                             10  AIF1DRC2_     0    AIF1 DRC2 (Timeslot 1) Signal Detect status
                                 SIG_DET_S          0 = Signal threshold not exceeded
                                 TS
                                                    1 = Signal threshold exceeded
                              9  AIF1DRC1_     0    AIF1 DRC1 (Timeslot 0) Signal Detect status
                                 SIG_DET_S          0 = Signal threshold not exceeded
                                 TS
                                                    1 = Signal threshold exceeded
                              8  SRC2_LOC      0    SRC2 Lock status
                                 K_STS              0 = Not locked
                                                    1 = Locked
                              7  SRC1_LOC      0    SRC1 Lock status
                                 K_STS              0 = Not locked
                                                    1 = Locked
                              6  FLL2_LOCK     0    FLL2 Lock status
                                 _STS               0 = Not locked
                                                    1 = Locked
                              5  FLL1_LOCK     0    FLL1 Lock status
                                 _STS               0 = Not locked
                                                    1 = Locked
                              0  TEMP_SHU      0    Temperature Shutdown status
                                 T_STS              0 = Temperature is below shutdown level
                                                    1 = Temperature is above shutdown level
               R1848         10  IM_GP11_EI    1    GPIO11 Interrupt mask.
               (0738h)           NT                 0 = Do not mask interrupt.
               Interrupt                            1 = Mask interrupt.
               Status 1
                              9  IM_GP10_EI    1    GPIO10 Interrupt mask.
               Mask
                                 NT                 0 = Do not mask interrupt.
                                                    1 = Mask interrupt.
                              8  IM_GP9_EI     1    GPIO9 Interrupt mask.
                                 NT                 0 = Do not mask interrupt.
                                                    1 = Mask interrupt.
                                                                          PP, March 2014, Rev 3.5
w
                                                                                             165


WM8958                                                                  Pre-Production
        REGISTER BIT   LABEL    DEFAULT                 DESCRIPTION
         ADDRESS
                  7  IM_GP8_EI     1    GPIO8 Interrupt mask.
                     NT                 0 = Do not mask interrupt.
                                        1 = Mask interrupt.
                  5  IM_GP6_EI     1    GPIO6 Interrupt mask.
                     NT                 0 = Do not mask interrupt.
                                        1 = Mask interrupt.
                  0  IM_GP1_EI     1    GPIO1 Interrupt mask.
                     NT                 0 = Do not mask interrupt.
                                        1 = Mask interrupt.
       R1849     15  IM_TEMP_      1    Temperature Warning Interrupt mask.
       (0739h)       WARN_EIN           0 = Do not mask interrupt.
       Interrupt     T
                                        1 = Mask interrupt.
       Status 2
                 14  IM_DCS_D      1    DC Servo Interrupt mask.
       Mask
                     ONE_EINT           0 = Do not mask interrupt.
                                        1 = Mask interrupt.
                 13  IM_WSEQ_      1    Write Sequencer Interrupt mask.
                     DONE_EINT          0 = Do not mask interrupt.
                                        1 = Mask interrupt.
                 12  IM_FIFOS_     1    Digital Core FIFO Error Interrupt mask.
                     ERR_EINT           0 = Do not mask interrupt.
                                        1 = Mask interrupt.
                 11  IM_AIF2DR     1    AIF2 DRC Activity Detect Interrupt mask.
                     C_SIG_DET          0 = Do not mask interrupt.
                     _EINT
                                        1 = Mask interrupt.
                 10  IM_AIF1DR     1    AIF1 DRC2 (Timeslot 1) Activity Detect
                     C2_SIG_DE          Interrupt mask.
                     T_EINT             0 = Do not mask interrupt.
                                        1 = Mask interrupt.
                  9  IM_AIF1DR     1    AIF1 DRC1 (Timeslot 0) Activity Detect
                     C1_SIG_DE          Interrupt mask.
                     T_EINT             0 = Do not mask interrupt.
                                        1 = Mask interrupt.
                  8  IM_SRC2_L     1    SRC2 Lock Interrupt mask.
                     OCK_EINT           0 = Do not mask interrupt.
                                        1 = Mask interrupt.
                  7  IM_SRC1_L     1    SRC1 Lock Interrupt mask.
                     OCK_EINT           0 = Do not mask interrupt.
                                        1 = Mask interrupt.
                  6  IM_FLL2_L     1    FLL2 Lock Interrupt mask.
                     OCK_EINT           0 = Do not mask interrupt.
                                        1 = Mask interrupt.
                  5  IM_FLL1_L     1    FLL1 Lock Interrupt mask.
                     OCK_EINT           0 = Do not mask interrupt.
                                        1 = Mask interrupt.
                  1  IM_MICD_EI    1    Microphone Detection Interrupt mask.
                     NT                 0 = Do not mask interrupt.
                                        1 = Mask interrupt.
                  0  IM_TEMP_S     1    Temperature Shutdown Interrupt mask.
                     HUT_EINT           0 = Do not mask interrupt.
                                        1 = Mask interrupt.
       R1856      0  IM_IRQ        0    IRQ Output Interrupt mask.
       (0740h)                          0 = Do not mask interrupt.
       Interrupt                        1 = Mask interrupt.
       Control
                                                             PP, March 2014, Rev 3.5
w
                                                                                  166


Pre-Production                                                                        WM8958
                 REGISTER        BIT      LABEL  DEFAULT              DESCRIPTION
                  ADDRESS
                R1864             5     TEMP_WAR    1    Temperature Warning de-bounce
                (0748h)                 N_DB             0 = Disabled
                IRQ                                      1 = Enabled
                Debounce
                                  0     TEMP_SHU    1    Temperature Shutdown de-bounce
                                        T_DB             0 = Disabled
                                                         1 = Enabled
               Table 90 Interrupt Configuration
                                                                           PP, March 2014, Rev 3.5
w
                                                                                              167


WM8958                                                                                                  Pre-Production
DIGITAL AUDIO INTERFACE
                 The WM8958 provides digital audio interfaces for inputting DAC data and outputting ADC or Digital
                 Microphone data. Flexible routing options also allow digital audio to be switched or mixed between
                 interfaces without involving any DAC or ADC.
                 The WM8958 provides two full audio interfaces, AIF1 and AIF2. A third interface, AIF3, supports Mono
                 PCM digital audio paths to/from the AIF2 DSP functions. AIF3 can also be configured using
                 multiplexers to provide alternate connections to AIF1 or AIF2.
                 The digital audio interfaces provide flexible connectivity with multiple processors (eg. Applications
                 processor, Baseband processor and Wireless transceiver). A typical configuration is illustrated in
                 Figure 45.
                     Applications
                                                    Audio Interface 1
                      Processor
                      Baseband
                                                   Audio Interface 2
                      Processor
                       Wireless
                                                   Audio Interface 3
                     Transceiver
                                                                         WM8958
                 Figure 45 Typical AIF Connections
                 In the general case, the digital audio interface uses four pins:
                           ADCDAT: ADC data output
                           DACDAT: DAC data input
                           LRCLK: Left/Right data alignment clock
                           BCLK: Bit clock, for synchronisation
                 In master interface mode, the clock signals BCLK and LRCLK are outputs from the WM8958. In slave
                 mode, these signals are inputs, as illustrated below.
                 As an option, a GPIO pin can be configured as the Left/Right clock for the ADC. In this case, the
                 LRCLK pin is dedicated to the DAC, allowing the ADC and DAC to be clocked independently.
                 Four different audio data formats are supported each digital audio interface:
                           Left justified
                           Right justified
                            2
                           IS
                           DSP mode
                 All four of these modes are MSB first. They are described in the following sections. Refer to the
                 “Signal Timing Requirements” section for timing information.
                                                                                               PP, March 2014, Rev 3.5
w
                                                                                                                  168


Pre-Production                                                                                            WM8958
               Time Division Multiplexing (TDM) is available in all four data format modes. On AIF1, the WM8958
               can transmit and receive data on two stereo pairs of timeslots simultaneously. On AIF2, the applicable
               timeslot pair is selectable using register control bits.
               Two variants of DSP mode are supported - ‘Mode A’ and ‘Mode B’. Mono operation can be selected
               on either audio interface in both DSP modes. PCM operation is supported using the DSP mode.
               MASTER AND SLAVE MODE OPERATION
               The WM8958 digital audio interfaces can operate as a master or slave as shown in Figure 46 and
               Figure 47. The associated control bits are described in “Digital Audio Interface Control”.
               Figure 46 Master Mode                                    Figure 47 Slave Mode
               OPERATION WITH TDM
               Time division multiplexing (TDM) allows multiple devices to transfer data simultaneously on the same
               bus. The WM8958 ADCs and DACs support TDM in master and slave modes for all data formats and
               word lengths. TDM is enabled and configured using register bits defined in the “Digital Audio Interface
               Control” section.
                                 BCLK                                                   BCLK
                                 LRCLK                                                  LRCLK
                       WM8958                           Processor              WM8958                      Processor
                                 ADCDAT                                                 ADCDAT
                                 DACDAT                                                 DACDAT
                                 BCLK                                                   BCLK
                     WM8958      LRCLK                                       WM8958     LRCLK
                     or similar                                              or similar
                      CODEC      ADCDAT                                       CODEC     ADCDAT
                                 DACDAT                                                 DACDAT
               Figure 48 TDM with WM8958 as Master                      Figure 49 TDM with Other CODEC as Master
                                                                                              PP, March 2014, Rev 3.5
w
                                                                                                                  169


WM8958                                                                                           Pre-Production
                          BCLK
                          LRCLK
               WM8958                            Processor
                          ADCDAT
                          DACDAT
                          BCLK
             WM8958       LRCLK
             or similar
              CODEC       ADCDAT
                          DACDAT
       Figure 50 TDM with Processor as Master
       Note: The WM8958 is a 24-bit device. If the user operates the WM8958 in 32-bit mode then the 8
       LSBs will be ignored on the receiving side and not driven on the transmitting side. It is therefore
       recommended to add a pull-down resistor if necessary to the DACDAT line and the ADCDAT line in
       TDM mode.
       AUDIO DATA FORMATS (NORMAL MODE)
       The audio data modes supported by the WM8958 are described below. Note that the polarity of the
       BCLK and LRCLK signals can be inverted if required; the following descriptions all assume the
       default, non-inverted polarity of these signals.
       In Right Justified mode, the LSB is available on the last rising edge of BCLK before a LRCLK
       transition. All other bits are transmitted before (MSB first). Depending on word length, BCLK frequency
       and sample rate, there may be unused BCLK cycles after each LRCLK transition.
       Figure 51 Right Justified Audio Interface (assuming n-bit word length)
       In Left Justified mode, the MSB is available on the first rising edge of BCLK following a LRCLK
       transition. The other bits up to the LSB are then transmitted in order. Depending on word length,
       BCLK frequency and sample rate, there may be unused BCLK cycles before each LRCLK transition.
                                                                                      PP, March 2014, Rev 3.5
w
                                                                                                           170


Pre-Production                                                                                                       WM8958
               Figure 52 Left Justified Audio Interface (assuming n-bit word length)
                   2
               In I S mode, the MSB is available on the second rising edge of BCLK following a LRCLK transition.
               The other bits up to the LSB are then transmitted in order. Depending on word length, BCLK
               frequency and sample rate, there may be unused BCLK cycles between the LSB of one sample and
               the MSB of the next.
                                                                                1/fs
                                                 LEFT CHANNEL                                  RIGHT CHANNEL
                     LRCLK
                      BCLK
                                        1 BCLK                                       1 BCLK
                  DACDAT/
                                         1   2 3                   n-2  n-1   n       1   2  3            n-2  n-1 n
                   ADCDAT
                                       MSB                                  LSB
                                                 Input Word Length (WL)
               Figure 53 I2S Justified Audio Interface (assuming n-bit word length)
                                                                                          st                  nd
               In DSP mode, the left channel MSB is available on either the 1 (mode B) or 2 (mode A) rising edge
               of BCLK following a rising edge of LRCLK. Right channel data immediately follows left channel data.
               Depending on word length, BCLK frequency and sample rate, there may be unused BCLK cycles
               between the LSB of the right channel data and the next sample.
               The selected mode (Mode A or Mode B) is determined by the AIFnDAC_LRCLK_INV bits for the AIFn
               digital input (playback) signal paths, and by the AIFnADC_LRCLK_INV bits for the AIFn digital output
               (record) signal paths.
               Note that the DSP Mode is selected independently for the input/output paths of each digital audio
               interface.
               In device master mode, the LRCLK output will resemble the frame pulse shown in Figure 54 and
               Figure 55. In device slave mode, Figure 56 and Figure 57, it is possible to use any length of frame
               pulse less than 1/fs, providing the falling edge of the frame pulse occurs greater than one BCLK
               period before the rising edge of the next frame pulse.
                                                                                                         PP, March 2014, Rev 3.5
w
                                                                                                                            171


WM8958                                                                                           Pre-Production
       Figure 54 DSP Mode A (AIFnDAC_LRCLK_INV / AIFnADC_LRCLK_INV=0, Master)
                                                                    1/fs
            LRCLK
             BCLK
                               LEFT CHANNEL                       RIGHT CHANNEL
          DACDAT/
                         1  2 3                   n-2 n-1   n 1 2 3           n-2 n-1 n
          ADCDAT
                        MSB                               LSB
                              Input Word Length (WL)
       Figure 55 DSP B Mode (AIFnDAC_LRCLK_INV / AIFnADC_LRCLK_INV=1, Master)
       Figure 56 DSP Mode A (AIFnDAC_LRCLK_INV / AIFnADC_LRCLK_INV =0, Slave)
       Figure 57 DSP Mode B (AIFnDAC_LRCLK_INV / AIFnADC_LRCLK_INV =1, Slave)
                                                                                        PP, March 2014, Rev 3.5
w
                                                                                                           172


Pre-Production                                                                                              WM8958
               Mono mode operation is available in DSP interface mode. When Mono mode is enabled, the audio
                                                                        st               nd
               data is transmitted or received starting on either the 1 (mode B) or 2 (mode A) rising edge of BCLK
               following a rising edge of LRCLK.
               PCM operation is supported in DSP interface mode. WM8958 ADC data that is output on the Left
               Channel will be read as mono PCM data by the receiving equipment. Mono PCM data received by the
               WM8958 will be treated as Left Channel data. This data may be routed to the Left/Right DACs using
               the control fields described in the “Digital Mixing” and “Digital Audio Interface Control” sections.
               AUDIO DATA FORMATS (TDM MODE)
               TDM is supported in master and slave modes. All audio interface data formats support time division
               multiplexing (TDM) for ADC and DAC data.
               When more than one pair of ADC or DAC data channels is enabled on AIF1, the WM8958 will transmit
               and receive data in both Slot 0 and Slot 1.
               In the case of AIF2, the ADC or DAC data can be transmitted or received in either timeslot; the
               required timeslot is selected using register control bits when TDM is enabled.
               When TDM is enabled, the ADCDAT pin will be tri-stated immediately before and immediately after
               data transmission, to allow another ADC device to drive this signal line for the remainder of the
               sample period. Note that it is important that two ADC devices do not attempt to drive the data pin
               simultaneously. A short circuit may occur if the transmission time of the two ADC devices overlap with
               each other. See “Audio Interface Timing” for details of the ADCDAT output relative to BCLK signal.
               Note that it is possible to ensure a gap exists between transmissions by setting the transmitted word
               length to a value higher than the actual length of the data. For example, if 32-bit word length is
               selected where only 24-bit data is available, then the WM8958 interface will tri-state after transmission
               of the 24-bit data, ensuring a gap after the WM8958 TDM slot.
               On AIF1, TDM can be used to transmit or receive up to four signal paths. Each enabled signal path is
               transmitted (on ADCDAT) or received (on DACDAT) sequentially. If one or more of the signal paths is
               disabled, then the position of remaining data blocks within the LRCLK frame may differ from those
               illustrated in Figure 58 to Figure 62, as the affected channel(s) will revert to the ‘normal’ (non-TDM)
               format. When the AIF1ADC_TDM register is set, then the ADCDAT1 output is tri-stated when not
               outputting data.
               On AIF2, the TDM format is enabled by register control (AIF2ADC_TDM and AIF2DAC_TDM for the
               output and input paths respectively). When TDM is enabled on AIF2, the data formats shown in Figure
               58 to Figure 62 are always selected, and the WM8958 transmits or receives data in one of the two
               available timeslots; the ADCDAT2 output is tri-stated when not outputting data.
               In all cases, the BCLK frequency must be high enough to allow data from the relevant time slots to be
               transferred. The relative timing of Slot 0 and Slot 1 depends upon the selected data format; the TDM
               timing for four input or output channels is shown in Figure 58 to Figure 62.
               Figure 58 TDM in Right-Justified Mode
                                                                                                PP, March 2014, Rev 3.5
w
                                                                                                                    173


WM8958                                               Pre-Production
       Figure 59 TDM in Left-Justified Mode
                         2
       Figure 60 TDM in I S Mode
       Figure 61 TDM in DSP Mode A
       Figure 62 TDM in DSP Mode B
                                            PP, March 2014, Rev 3.5
w
                                                               174


Pre-Production                                                                                               WM8958
DIGITAL AUDIO INTERFACE CONTROL
                 This section describes the configuration of the WM8958 digital audio interface paths.
                 Interfaces AIF1 and AIF2 can be configured as Master or Slave, or can be tri-stated. Each input and
                 output signal path can be independently enabled or disabled. AIF output (digital record) and AIF input
                 (digital playback) paths can use a common Left/Right clock, or can use separate clocks for mixed
                 sample rates.
                 Interfaces AIF1 and AIF2 each support flexible formats, word-length, TDM configuration, channel
                 swapping and input path digital boost functions. 8-bit companding modes and digital loopback is also
                 possible.
                 A third interface, AIF3, supports Mono PCM digital audio paths to/from the AIF2 DSP functions. AIF3
                 can also be configured using multiplexers to provide alternate connections to AIF1 or AIF2. Note that
                 AIF3 operates in Master mode only.
                 AIF1 - MASTER / SLAVE AND TRI-STATE CONTROL
                 The Digital Audio Interface AIF1 can operate in Master or Slave modes, selected by AIF1_MSTR. In
                 Master mode, the BCLK1 and LRCLK1 signals are generated by the WM8958 when one or more AIF1
                 channels is enabled.
                 When AIF1_LRCLK_FRC or AIF1_CLK_FRC is set in Master mode, then LRCLK1 and ADCLRCLK1
                 are output at all times, including when none of the AIF1 audio channels is enabled. Note that LRCLK1
                 and ADCLRCLK1 are derived from BCLK1, and either an internal or external BCLK1 signal must also
                 be present to generate LRCLK1 or ADCLRCLK1.
                 When AIF1_CLK_FRC is set in Master mode, then BCLK1 is output at all times, including when none
                 of the AIF1 audio channels is enabled.
                 The AIF1 interface can be tri-stated by setting the AIF1_TRI register. When this bit is set, then all of
                 the AIF1 outputs are un-driven (high-impedance). Note that the GPIO1/ADCLRCLK1 pin is a
                 configurable pin which may take different functions independent of AIF1. The AIF1_TRI register only
                 controls the GPIO1/ADCLRCLK1 pin when its function is set to ADCLRCLK1. See “General Purpose
                 Input/Output” to configure the GPIO1 pin.
                     REGISTER         BIT        LABEL      DEFAULT                        DESCRIPTION
                     ADDRESS
                   R770 (0302h)       15      AIF1_TRI           0       AIF1 Audio Interface tri-state
                   AIF1                                                  0 = AIF1 pins operate normally
                   Master/Slave                                          1 = Tri-state all AIF1 interface pins
                                                                         Note that the GPIO1 pin is controlled by this
                                                                         register only when configured as
                                                                         ADCLRCLK1.
                                      14      AIF1_MSTR          0       AIF1 Audio Interface Master Mode Select
                                                                         0 = Slave mode
                                                                         1 = Master mode
                                      13      AIF1_CLK_F         0       Forces BCLK1, LRCLK1 and ADCLRCLK1 to
                                              RC                         be enabled when all AIF1 audio channels are
                                                                         disabled.
                                                                         0 = Normal
                                                                         1 = BCLK1, LRCLK1 and ADCLRCLK1
                                                                         always enabled in Master mode
                                      12      AIF1_LRCL          0       Forces LRCLK1 and ADCLRCLK1 to be
                                              K_FRC                      enabled when all AIF1 audio channels are
                                                                         disabled.
                                                                         0 = Normal
                                                                         1 = LRCLK1 and ADCLRCLK1 always
                                                                         enabled in Master mode
                 Table 91 AIF1 Master / Slave and Tri-state Control
                                                                                                PP, March 2014, Rev 3.5
w
                                                                                                                     175


WM8958                                                                                        Pre-Production
       AIF1 - SIGNAL PATH ENABLE
       The AIF1 interface supports up to four input channels and up to four output channels. All enabled
       channels are transmitted (on ADCDAT) or received (on DACDAT) sequentially, using time division
       multiplexing (TDM).
       Each of the available channels can be enabled or disabled using the register bits defined in Table 92.
       These register controls are illustrated in Figure 67.
           REGISTER         BIT        LABEL        DEFAULT                 DESCRIPTION
           ADDRESS
         R4 (0004h)          11    AIF1ADC2L            0    Enable AIF1ADC2 (Left) output path (AIF1,
         Power                     _ENA                      Timeslot 1)
         Management                                          0 = Disabled
         (4)                                                 1 = Enabled
                             10    AIF1ADC2R            0    Enable AIF1ADC2 (Right) output path (AIF1,
                                   _ENA                      Timeslot 1)
                                                             0 = Disabled
                                                             1 = Enabled
                              9    AIF1ADC1L            0    Enable AIF1ADC1 (Left) output path (AIF1,
                                   _ENA                      Timeslot 0)
                                                             0 = Disabled
                                                             1 = Enabled
                              8    AIF1ADC1R            0    Enable AIF1ADC1 (Right) output path (AIF1,
                                   _ENA                      Timeslot 0)
                                                             0 = Disabled
                                                             1 = Enabled
         R5 (0005h)          11    AIF1DAC2L            0    Enable AIF1DAC2 (Left) input path (AIF1,
         Power                     _ENA                      Timeslot 1)
         Management                                          0 = Disabled
         (5)                                                 1 = Enabled
                             10    AIF1DAC2R            0    Enable AIF1DAC2 (Right) input path (AIF1,
                                   _ENA                      Timeslot 1)
                                                             0 = Disabled
                                                             1 = Enabled
                              9    AIF1DAC1L            0    Enable AIF1DAC1 (Left) input path (AIF1,
                                   _ENA                      Timeslot 0)
                                                             0 = Disabled
                                                             1 = Enabled
                              8    AIF1DAC1R            0    Enable AIF1DAC1 (Right) input path (AIF1,
                                   _ENA                      Timeslot 0)
                                                             0 = Disabled
                                                             1 = Enabled
       Table 92 AIF1 Signal Path Enable
       AIF1 - BCLK AND LRCLK CONTROL
       The BCLK1 frequency is controlled relative to AIF1CLK by the AIF1_BCLK_DIV divider. See “Clocking
       and Sample Rates” for details of the AIF1 clock, AIF1CLK.
       The LRCLK1 frequency is controlled relative to BCLK1 by the AIF1DAC_RATE divider.
       In Master mode, the LRCLK1 output is generated by the WM8958 when any of the AIF1 channels is
       enabled. (Note that, when GPIO1 is configured as ADCLRCLK1, then only the AIF1 DAC channels will
       cause LRCLK1 to be output.)
       In Slave mode, the LRCLK1 output is disabled by default to allow another digital audio interface to
       drive this pin. It is also possible to force the LRCLK1 signal to be output, using the
       AIF1DAC_LRCLK_DIR or AIF1ADC_LRCLK_DIR register bits, allowing mixed master and slave
       modes. (Note that, when GPIO1 is configured as ADCLRCLK1, then only the AIF1DAC_LRCLK_DIR
       bit will force the LRCLK1 signal.)
                                                                                  PP, March 2014, Rev 3.5
w
                                                                                                         176


Pre-Production                                                                                          WM8958
               When the GPIO1 pin is configured as ADCLRCLK1, then the ADCLRCLK1 frequency is controlled
               relative to BCLK1 by the AIF1ADC_RATE divider. In this case, the ADCLRCLK1 is dedicated to AIF1
               output, and the LRCLK1 pin is dedicated to AIF1 input, allowing different sample rates to be supported
               in the two paths.
               In Master mode, with GPIO1 pin configured as ADCLRCLK1, this output is enabled when any of the
               AIF1 ADC channels is enabled. The ADCLRCLK1 signal can also be enabled in Slave mode, using
               the AIF1ADC_LRCLK_DIR bit, allowing mixed master and slave modes.
               When the GPIO1 pin is not configured as ADCLRCLK1, then the LRCLK1 signal applies to the ADC
               and DAC channels, at a rate set by AIF1DAC_RATE.
               See “General Purpose Input/Output” for the configuration of GPIO1. Note that, in Ultrasonic (4FS)
               mode, the GPIO1 pin must be configured as ADCLRCLK1.
               The BCLK1 output can be inverted using the AIF1_BCLK_INV register bit. The LRCLK1 and
               ADCLRCLK1 output (when selected) can be inverted using the AIF1DAC_LRCLK_INV and
               AIF1ADC_LRCLK_INV register controls respectively.
               Note that in Slave mode, when BCLK1 is an input, the AIF1_BCLK_INV register selects the polarity of
               the received BCLK1 signal. Under default conditions, DACDAT1 input is captured on the rising edge
               of BCLK1, as illustrated in Figure 5. When AIF1_BCLK_INV = 1, DACDAT1 input is captured on the
               falling edge of BCLK1.
               The AIF1 clock generators are controlled as illustrated in Figure 63.
               Figure 63 Audio Interface 1 - BCLK and LRCLK Control
                                                                                            PP, March 2014, Rev 3.5
w
                                                                                                                 177


WM8958                                                                      Pre-Production
        REGISTER     BIT    LABEL   DEFAULT                  DESCRIPTION
         ADDRESS
       R768 (0300h)   8  AIF1_BCLK      0   BCLK1 Invert
       AIF1 Control      _INV               0 = BCLK1 not inverted
       (1)                                  1 = BCLK1 inverted
                                            Note that AIF1_BCLK_INV selects the BCLK1
                                            polarity in Master mode and in Slave mode.
       R771 (0303h)  8:4 AIF1_BCLK   00100  BCLK1 Rate
       AIF1 BCLK         _DIV [4:0]         00000 = AIF1CLK
                                            00001 = AIF1CLK / 1.5
                                            00010 = AIF1CLK / 2
                                            00011 = AIF1CLK / 3
                                            00100 = AIF1CLK / 4
                                            00101 = AIF1CLK / 5
                                            00110 = AIF1CLK / 6
                                            00111 = AIF1CLK / 8
                                            01000 = AIF1CLK / 11
                                            01001 = AIF1CLK / 12
                                            01010 = AIF1CLK / 16
                                            01011 = AIF1CLK / 22
                                            01100 = AIF1CLK / 24
                                            01101 = AIF1CLK / 32
                                            01110 = AIF1CLK / 44
                                            01111 = AIF1CLK / 48
                                            10000 = AIF1CLK / 64
                                            10001 = AIF1CLK / 88
                                            10010 = AIF1CLK / 96
                                            10011 = AIF1CLK / 128
                                            10100 = AIF1CLK / 176
                                            10101 = AIF1CLK / 192
                                            10110 - 11111 = Reserved
                                                             2
       R772 (0304h)  12  AIF1ADC_L      0   Right, left and I S modes – ADCLRCLK1
       AIF1ADC           RCLK_INV           polarity
       LRCLK                                0 = normal ADCLRCLK1 polarity
                                            1 = invert ADCLRCLK1 polarity
                                            Note that AIF1ADC_LRCLK_INV selects the
                                            ADCLRCLK1 polarity in Master mode and in
                                            Slave mode.
                                            DSP Mode – mode A/B select
                                            0 = MSB is available on 2nd BCLK1 rising
                                            edge after ADCLRCLK1 rising edge (mode A)
                                            1 = MSB is available on 1st BCLK1 rising
                                            edge after ADCLRCLK1 rising edge (mode B)
                     11  AIF1ADC_L      0   Allows ADCLRCLK1 to be enabled in Slave
                         RCLK_DIR           mode
                                            0 = Normal
                                            1 = ADCLRCLK1 enabled in Slave mode
                    10:0 AIF1ADC_R    040h  ADCLRCLK1 Rate
                         ATE [10:0]         ADCLRCLK1 clock output =
                                            BCLK1 / AIF1ADC_RATE
                                            Integer (LSB = 1)
                                            Valid from 8..2047
                                                                  PP, March 2014, Rev 3.5
w
                                                                                      178


Pre-Production                                                                                              WM8958
                   REGISTER         BIT        LABEL        DEFAULT                       DESCRIPTION
                   ADDRESS
                                                                                          2
                 R773 (0305h)       12      AIF1DAC_L           0        Right, left and I S modes – LRCLK1 polarity
                 AIF1DAC                    RCLK_INV                     0 = normal LRCLK1 polarity
                 LRCLK                                                   1 = invert LRCLK1 polarity
                                                                         Note that AIF1DAC_LRCLK_INV selects the
                                                                         LRCLK1 polarity in Master mode and in Slave
                                                                         mode.
                                                                         DSP Mode – mode A/B select
                                                                         0 = MSB is available on 2nd BCLK1 rising
                                                                         edge after LRCLK1 rising edge (mode A)
                                                                         1 = MSB is available on 1st BCLK1 rising
                                                                         edge after LRCLK1 rising edge (mode B)
                                    11      AIF1DAC_L           0        Allows LRCLK1 to be enabled in Slave mode
                                            RCLK_DIR                     0 = Normal
                                                                         1 = LRCLK1 enabled in Slave mode
                                   10:0     AIF1DAC_R         040h       LRCLK1 Rate
                                            ATE [10:0]                   LRCLK1 clock output =
                                                                         BCLK1 / AIF1DAC_RATE
                                                                         Integer (LSB = 1)
                                                                         Valid from 8..2047
               Table 93 AIF1 BCLK and LRCLK Control
               AIF1 - DIGITAL AUDIO DATA CONTROL
               The register bits controlling the audio data format, word length, left/right channel selection and TDM
               control for AIF1 are described in Table 94.
                                                                                  st              nd
               In DSP mode, the left channel MSB is available on either the 1 (mode B) or 2 (mode A) rising edge
               of BCLK following a rising edge of LRCLK (assuming default BCLK polarity).
               When the AIF1DAC_LRCLK_INV bit is set in DSP mode, then DSP Mode B is selected for the AIF1
               digital input (playback) signal path. When the AIF1DAC_LRCLK_INV bit is not set, then DSP Mode A
               is selected.
               When the AIF1ADC_LRCLK_INV bit is set in DSP mode, then DSP Mode B is selected for the AIF1
               digital output (record) signal path. When the AIF1ADC_LRCLK_INV bit is not set, then DSP Mode A is
               selected.
               Note that the DSP Mode is selected independently for the input/output paths of each digital audio
               interface. Also note that the AIF1ADCLRCLK_INV bits remain valid even when the LRCLK signal is
               common for both paths. See Table 93 for details of the AIF1DAC_LRCLK_INV and
               AIF1ADC_LRCLK_INV register fields.
               A digital gain function is available at the audio interface input path to boost the DAC volume when a
               small signal is received on DACDAT1. This is controlled using the AIF1DAC_BOOST register. To
               prevent clipping, this function should not be used when the boosted data is expected to be greater
               than 0dBFS.
                   REGISTER         BIT        LABEL        DEFAULT                       DESCRIPTION
                   ADDRESS
                 R768 (0300h)       15      AIF1ADCL_           0        AIF1 Left Digital Audio interface source
                 AIF1 Control               SRC                          0 = Left ADC data is output on left channel
                 (1)                                                     1 = Right ADC data is output on left channel
                                    14      AIF1ADCR_           1        AIF1 Right Digital Audio interface source
                                            SRC                          0 = Left ADC data is output on right channel
                                                                         1 = Right ADC data is output on right channel
                                                                                               PP, March 2014, Rev 3.5
w
                                                                                                                     179


WM8958                                                                                             Pre-Production
           REGISTER          BIT        LABEL       DEFAULT                         DESCRIPTION
            ADDRESS
                              13     AIF1ADC_T          0         AIF1 transmit (ADC) TDM Control
                                     DM                           0 = ADCDAT1 drives logic ‘0’ when not
                                                                  transmitting data
                                                                  1 = ADCDAT1 is tri-stated when not
                                                                  transmitting data
                             6:5     AIF1_WL            10        AIF1 Digital Audio Interface Word Length
                                     [1:0]                        00 = 16 bits
                                                                  01 = 20 bits
                                                                  10 = 24 bits
                                                                  11 = 32 bits
                                                                  Note - 8-bit modes can be selected using the
                                                                  “Companding” control bits.
                             4:3     AIF1_FMT           10        AIF1 Digital Audio Interface Format
                                     [1:0]                        00 = Right justified
                                                                  01 = Left justified
                                                                        2
                                                                  10 = I S Format
                                                                  11 = DSP Mode
          R769 (0301h)        15     AIF1DACL_          0         AIF1 Left Receive Data Source Select
          AIF1 Control               SRC                          0 = Left DAC receives left interface data
          (2)                                                     1 = Left DAC receives right interface data
                              14     AIF1DACR_          1         AIF1 Right Receive Data Source Select
                                     SRC                          0 = Right DAC receives left interface data
                                                                  1 = Right DAC receives right interface data
                           11:10     AIF1DAC_B          00        AIF1 Input Path Boost
                                     OOST [1:0]                   00 = 0dB
                                                                  01 = +6dB (input must not exceed -6dBFS)
                                                                  10 = +12dB (input must not exceed -12dBFS)
                                                                  11 = +18dB (input must not exceed -18dBFS)
          R774 (0306h)         1     AIF1DACL_           0        AIF1 Left Receive Data Invert
          AIF1 DAC                   DAT_INV                      0 = Not inverted
          Data                                                    1 = Inverted
                               0     AIF1DACR_          0         AIF1 Right Receive Data Invert
                                     DAT_INV                      0 = Not inverted
                                                                  1 = Inverted
          R775 (0307h)         1     AIF1ADCL_           0        AIF1 Left Transmit Data Invert
          AIF1 ADC                   DAT_INV                      0 = Not inverted
          Data                                                    1 = Inverted
                               0     AIF1ADCR_          0         AIF1 Right Transmit Data Invert
                                     DAT_INV                      0 = Not inverted
                                                                  1 = Inverted
       Table 94 AIF1 Digital Audio Data Control
       AIF1 - MONO MODE
       AIF1 can be configured to operate in mono DSP mode by setting AIF1_MONO = 1 as described in
       Table 95. Note that mono mode is only supported in DSP mode, ie when AIF1_FMT = 11.
       In mono mode, the Left channel data or the Right channel data may be selected for output on
       ADCDAT1. The selected channel is determined by the AIF1ADC1L_ENA and AIF1ADC1R_ENA bits.
       (If both bits are set, then the Right channel data is selected.)
       In mono mode, the DACDAT1 input can be enabled on the Left and/or Right signal paths using the
       AIF1DAC1L_ENA and AIF1DAC1R_ENA bits. The mono input can be enabled on both paths at the
       same time if required.
       Note that AIF1 TDM mode and AIF1 Mono mode cannot be supported simultaneously.
                                                                                        PP, March 2014, Rev 3.5
w
                                                                                                             180


Pre-Production                                                                                              WM8958
                   REGISTER         BIT         LABEL       DEFAULT                       DESCRIPTION
                   ADDRESS
                 R769 (0301h)        8       AIF1_MONO           0       AIF1 DSP Mono Mode
                 AIF1 Control                                            0 = Disabled
                 (2)                                                     1 = Enabled
                                                                         Note that Mono Mode is only supported when
                                                                         AIF1_FMT = 11.
               Table 95 AIF1 Mono Mode Control
               AIF1 - COMPANDING
               The WM8958 supports A-law and -law companding on both transmit (ADC) and receive (DAC) sides
               of AIF1. This is configured using the register bits described in Table 96.
                   REGISTER         BIT         LABEL       DEFAULT                       DESCRIPTION
                   ADDRESS
                 R769 (0301h)        4       AIF1DAC_C           0       AIF1 Receive Companding Enable
                 AIF1 Control                OMP                         0 = Disabled
                 (2)                                                     1 = Enabled
                                     3       AIF1DAC_C           0       AIF1 Receive Companding Type
                                             OMPMODE                     0 = µ-law
                                                                         1 = A-law
                                     2       AIF1ADC_C           0       AIF1 Transmit Companding Enable
                                             OMP                         0 = Disabled
                                                                         1 = Enabled
                                     1       AIF1ADC_C           0       AIF1 Transmit Companding Type
                                             OMPMODE                     0 = µ-law
                                                                         1 = A-law
               Table 96 AIF1 Companding
               Companding involves using a piecewise linear approximation of the following equations (as set out by
               ITU-T G.711 standard) for data compression:
               -law (where =255 for the U.S. and Japan):
                          F(x) = ln( 1 + |x|) / ln( 1 + )          } for -1 ≤ x ≤ 1
               A-law (where A=87.6 for Europe):
                          F(x) = A|x| / ( 1 + lnA)                    for x ≤ 1/A
                          F(x) = ( 1 + lnA|x|) / (1 + lnA)            for 1/A ≤ x ≤ 1
               The companded data is also inverted as recommended by the G.711 standard (all 8 bits are inverted
               for -law, all even data bits are inverted for A-law). The data will be transmitted as the first 8 MSBs of
               data.
               Companding converts 13 bits (-law) or 12 bits (A-law) to 8 bits using non-linear quantization. This
               provides greater precision for low amplitude signals than for high amplitude signals, resulting in a
               greater usable dynamic range than 8 bit linear quantization. The companded signal is an 8-bit word
               comprising sign (1 bit), exponent (3 bits) and mantissa (4 bits).
               AIF1 8-bit mode is selected whenever AIF1DAC_COMP=1 or AIF1ADC_COMP=1. The use of 8-bit
               data allows samples to be passed using as few as 8 BCLK1 cycles per LRCLK1 frame. When using
               DSP mode B, 8-bit data words may be transferred consecutively every 8 BCLK1 cycles.
               AIF1 8-bit mode (without Companding) may be enabled by setting AIF1DAC_COMPMODE=1 or
               AIF1ADC_COMPMODE=1, when AIF1DAC_COMP=0 and AIF1ADC_COMP=0.
                  BIT7                    BIT[6:4]                                    BIT[3:0]
                 SIGN                  EXPONENT                                     MANTISSA
               Table 97 8-bit Companded Word Composition
                                                                                               PP, March 2014, Rev 3.5
w
                                                                                                                     181


WM8958                                                                                                         Pre-Production
                                                               u-law Companding
                                                                                                           1
                                   120
                                                                                                           0.9
                                   100                                                                     0.8
                Companded Output                                                                                  Normalised Output
                                                                                                           0.7
                                    80                                                                     0.6
                                                                                                           0.5
                                    60
                                                                                                           0.4
                                    40                                                                     0.3
                                                                                                           0.2
                                    20
                                                                                                           0.1
                                     0                                                                     0
                                         0   0.1   0.2   0.3     0.4    0.5    0.6   0.7   0.8   0.9   1
                                                                 Normalised Input
         Figure 64 µ-Law Companding
                                                               A-law Companding
                                                                                                           1
                                   120
                                                                                                           0.9
                                   100                                                                     0.8
           Companded Output                                                                                      Normalised Output
                                                                                                           0.7
                                   80                                                                      0.6
                                                                                                           0.5
                                   60
                                                                                                           0.4
                                   40                                                                      0.3
                                                                                                           0.2
                                   20
                                                                                                           0.1
                                    0                                                                      0
                                         0         0.2           0.4          0.6          0.8         1
                                                                 Normalised Input
         Figure 65 A-Law Companding
                                                                                                  PP, March 2014, Rev 3.5
w
                                                                                                                                      182


Pre-Production                                                                                             WM8958
               AIF1 - LOOPBACK
               The AIF1 interface can provide a Loopback option. When the AIF1_LOOPBACK bit is set, then AIF1
               digital audio output is routed to the AIF1 digital audio input. The normal input (DACDAT1) is not used
               when AIF1 Loopback is enabled.
                  REGISTER          BIT        LABEL       DEFAULT                         DESCRIPTION
                   ADDRESS
                 R769 (0301h)        0      AIF1_LOOP           0        AIF1 Digital Loopback Function
                 AIF1 Control               BACK                         0 = No loopback
                 (2)                                                     1 = Loopback enabled (ADCDAT1 data output
                                                                         is directly input to DACDAT1 data input).
               Table 98 AIF1 Loopback
               AIF1 - DIGITAL PULL-UP AND PULL-DOWN
               The WM8958 provides integrated pull-up and pull-down resistors on each of the DACDAT1, LRCLK1
               and BCLK1 pins. This provides a flexible capability for interfacing with other devices.
               Each of the pull-up and pull-down resistors can be configured independently using the register bits
               described in Table 99. Note that if the Pull-up and Pull-down are both enabled for any pin, then the
               pull-up and pull-down will be disabled.
                   REGISTER         BIT         LABEL          DEFAULT                       DESCRIPTION
                   ADDRESS
                 R1824                5     DACDAT1_PU              0         DACDAT1 Pull-up enable
                 (0720h)                                                      0 = Disabled
                 Pull Control                                                 1 = Enabled
                 (1)
                                      4     DACDAT1_PD              0         DACDAT1 Pull-down enable
                                                                              0 = Disabled
                                                                              1 = Enabled
                                      3     DACLRCLK1_              0         LRCLK1 Pull-up enable
                                            PU                                0 = Disabled
                                                                              1 = Enabled
                                      2     DACLRCLK1_              0         LRCLK1 Pull-down enable
                                            PD                                0 = Disabled
                                                                              1 = Enabled
                                      1     BCLK1_PU                0         BCLK1 Pull-up enable
                                                                              0 = Disabled
                                                                              1 = Enabled
                                      0     BCLK1_PD                0         BCLK1 Pull-down enable
                                                                              0 = Disabled
                                                                              1 = Enabled
               Table 99 AIF1 Digital Pull-Up and Pull-Down Control
                                                                                                PP, March 2014, Rev 3.5
w
                                                                                                                   183


WM8958                                                                                             Pre-Production
       AIF2 - MASTER / SLAVE AND TRI-STATE CONTROL
       The Digital Audio Interface AIF2 can operate in Master or Slave modes, selected by AIF2_MSTR. In
       Master mode, the BCLK2 and LRCLK2 signals are generated by the WM8958 when one or more AIF2
       channels is enabled.
       When AIF2_LRCLK_FRC or AIF2_CLK_FRC is set in Master mode, then LRCLK2 and ADCLRCLK2
       are output at all times, including when none of the AIF2 audio channels is enabled. Note that LRCLK2
       and ADCLRCLK2 are derived from BCLK2, and either an internal or external BCLK2 signal must also
       be present to generate LRCLK2 or ADCLRCLK2.
       When AIF2_CLK_FRC is set in Master mode, then BCLK2 is output at all times, including when none
       of the AIF2 audio channels is enabled.
       Note that the ADCLRCLK2 pin is also a GPIO pin, whose function is configurable. This pin must be
       configured for AIF functionality when used as audio interface pin. See “General Purpose
       Input/Output”.
       The AIF2 interface can be tri-stated by setting the AIF2_TRI register. When this bit is set, then all of
       the AIF2 outputs are un-driven (high-impedance). The AIF2_TRI register only affects those pins which
       are configured for AIF2 functions; it does not affect pins which are configured for other functions.
           REGISTER         BIT        LABEL       DEFAULT                         DESCRIPTION
           ADDRESS
         R786 (0312h)       15      AIF2_TRI            0        AIF2 Audio Interface tri-state
         AIF2                                                    0 = AIF2 pins operate normally
         Master/Slave                                            1 = Tri-state all AIF2 interface pins
                                                                 Note that pins not configured as AIF2
                                                                 functions are not affected by this register.
                            14      AIF2_MSTR           0        AIF2 Audio Interface Master Mode Select
                                                                 0 = Slave mode
                                                                 1 = Master mode
                            13      AIF2_CLK_F          0        Forces BCLK2, LRCLK2 and ADCLRCLK2 to
                                    RC                           be enabled when all AIF2 audio channels are
                                                                 disabled.
                                                                 0 = Normal
                                                                 1 = BCLK2, LRCLK2 and ADCLRCLK2
                                                                 always enabled in Master mode
                            12      AIF2_LRCL           0        Forces LRCLK2 and ADCLRCLK2 to be
                                    K_FRC                        enabled when all AIF2 audio channels are
                                                                 disabled.
                                                                 0 = Normal
                                                                 1 = LRCLK2 and ADCLRCLK2 always
                                                                 enabled in Master mode
       Table 100 AIF2 Master / Slave and Tri-state Control
                                                                                        PP, March 2014, Rev 3.5
w
                                                                                                              184


Pre-Production                                                                                          WM8958
               AIF2 - SIGNAL PATH ENABLE
               The AIF2 interface supports two input channels and two output channels. Each of the available
               channels can be enabled or disabled using the register bits defined in Table 101. These register
               controls are illustrated in Figure 67.
                   REGISTER          BIT        LABEL    DEFAULT                       DESCRIPTION
                   ADDRESS
                 R4 (0004h)          13      AIF2ADCL_        0       Enable AIF2ADC (Left) output path
                 Power                       ENA                      0 = Disabled
                 Management                                           1 = Enabled
                 (4)
                                                                      This bit must be set for AIF2 or AIF3 output of
                                                                      the AIF2ADC (Left) signal.
                                     12      AIF2ADCR_        0       Enable AIF2ADC (Right) output path
                                             ENA                      0 = Disabled
                                                                      1 = Enabled
                                                                      This bit must be set for AIF2 or AIF3 output of
                                                                      the AIF2ADC (Left) signal.
                 R5 (0005h)          13      AIF2DACL_        0       Enable AIF2DAC (Left) input path
                 Power                       ENA                      0 = Disabled
                 Management                                           1 = Enabled
                 (5)
                                     12      AIF2DACR_        0       Enable AIF2DAC (Right) input path
                                             ENA                      0 = Disabled
                                                                      1 = Enabled
                 R784 (0310h)         1      AIF2TXL_E        1       Enable AIF2DAC (Left) input path
                 AIF2 Control                NA                       0 = Disabled
                 (1)                                                  1 = Enabled
                                                                      This bit must be set for AIF2 output of the
                                                                      AIF2ADC (Left) signal. For AIF3 output only,
                                                                      this bit can be set to 0.
                                      0      AIF2TXR_E        1       Enable AIF2DAC (Right) input path
                                             NA                       0 = Disabled
                                                                      1 = Enabled
                                                                      This bit must be set for AIF2 output of the
                                                                      AIF2ADC (Left) signal. For AIF3 output only,
                                                                      this bit can be set to 0.
               Table 101 AIF2 Signal Path Enable
               AIF2 - BCLK AND LRCLK CONTROL
               The BCLK2 frequency is controlled relative to AIF2CLK by the AIF2_BCLK_DIV divider. See “Clocking
               and Sample Rates” for details of the AIF2 clock, AIF2CLK.
               The LRCLK2 frequency is controlled relative to BCLK2 by the AIF2DAC_RATE divider.
               In Master mode, the LRCLK2 output is generated by the WM8958 when any of the AIF2 channels is
               enabled. (Note that, when GPIO6 is configured as ADCLRCLK2, then only the AIF2 DAC channels will
               cause LRCLK2 to be output.)
               In Slave mode, the LRCLK2 output is disabled by default to allow another digital audio interface to
               drive this pin. It is also possible to force the LRCLK2 signal to be output, using the
               AIF2DAC_LRCLK_DIR or AIF2ADC_LRCLK_DIR register bits, allowing mixed master and slave
               modes. (Note that, when GPIO6 is configured as ADCLRCLK2, then only the AIF2DAC_LRCLK_DIR
               bit will force the LRCLK2 signal.)
               When the GPIO6 pin is configured as ADCLRCLK2, then the ADCLRCLK2 frequency is controlled
               relative to BCLK2 by the AIF2ADC_RATE divider. In this case, the ADCLRCLK2 is dedicated to AIF2
               output, and the LRCLK2 pin is dedicated to AIF2 input, allowing different sample rates to be supported
               in the two paths.
                                                                                             PP, March 2014, Rev 3.5
w
                                                                                                                  185


WM8958                                                                                   Pre-Production
       In Master mode, with GPIO6 pin configured as ADCLRCLK2, this output is enabled when any of the
       AIF2 ADC channels is enabled. The ADCLRCLK2 signal can also be enabled in Slave mode, using
       the AIF2ADC_LRCLK_DIR bit, allowing mixed master and slave modes.
       See “General Purpose Input/Output” for the configuration of GPIO6.
       The BCLK2 output can be inverted using the AIF2_BCLK_INV register bit. The LRCLK2 and
       ADCLRCLK2 output (when selected) can be inverted using the AIF2DAC_LRCLK_INV and
       AIF2ADC_LRCLK_INV register controls respectively.
       Note that in Slave mode, when BCLK2 is an input, the AIF2_BCLK_INV register selects the polarity of
       the received BCLK2 signal. Under default conditions, DACDAT2 input is captured on the rising edge
       of BCLK2, as illustrated in Figure 5. When AIF2_BCLK_INV = 1, DACDAT2 input is captured on the
       falling edge of BCLK2.
       The AIF2 clock generators are controlled as illustrated in Figure 66.
       Figure 66 Audio Interface 2 - BCLK and LRCLK Control
                                                                               PP, March 2014, Rev 3.5
w
                                                                                                     186


Pre-Production                                                                       WM8958
                REGISTER     BIT    LABEL   DEFAULT                  DESCRIPTION
                 ADDRESS
               R784 (0310h)   8  AIF2_BCLK      0   BCLK2 Invert
               AIF2 Control      _INV               0 = BCLK2 not inverted
               (1)                                  1 = BCLK2 inverted
                                                    Note that AIF2_BCLK_INV selects the BCLK2
                                                    polarity in Master mode and in Slave mode.
               R787 (0313h)  8:4 AIF2_BCLK   00100  BCLK2 Rate
               AIF2 BCLK         _DIV [4:0]         00000 = AIF2CLK
                                                    00001 = AIF2CLK / 1.5
                                                    00010 = AIF2CLK / 2
                                                    00011 = AIF2CLK / 3
                                                    00100 = AIF2CLK / 4
                                                    00101 = AIF2CLK / 5
                                                    00110 = AIF2CLK / 6
                                                    00111 = AIF2CLK / 8
                                                    01000 = AIF2CLK / 11
                                                    01001 = AIF2CLK / 12
                                                    01010 = AIF2CLK / 16
                                                    01011 = AIF2CLK / 22
                                                    01100 = AIF2CLK / 24
                                                    01101 = AIF2CLK / 32
                                                    01110 = AIF2CLK / 44
                                                    01111 = AIF2CLK / 48
                                                    10000 = AIF2CLK / 64
                                                    10001 = AIF2CLK / 88
                                                    10010 = AIF2CLK / 96
                                                    10011 = AIF2CLK / 128
                                                    10100 = AIF2CLK / 176
                                                    10101 = AIF2CLK / 192
                                                    10110 - 11111 = Reserved
                                                                     2
               R788 (0314h)  12  AIF2ADC_L      0   Right, left and I S modes – ADCLRCLK2
               AIF2ADC           RCLK_INV           polarity
               LRCLK                                0 = normal ADCLRCLK2 polarity
                                                    1 = invert ADCLRCLK2 polarity
                                                    Note that AIF2ADC_LRCLK_INV selects the
                                                    ADCLRCLK2 polarity in Master mode and in
                                                    Slave mode.
                                                    DSP Mode – mode A/B select
                                                    0 = MSB is available on 2nd BCLK2 rising
                                                    edge after ADCLRCLK2 rising edge (mode A)
                                                    1 = MSB is available on 1st BCLK2 rising
                                                    edge after ADCLRCLK2 rising edge (mode B)
                             11  AIF2ADC_L      0   Allows ADCLRCLK2 to be enabled in Slave
                                 RCLK_DIR           mode
                                                    0 = Normal
                                                    1 = ADCLRCLK2 enabled in Slave mode
                            10:0 AIF2ADC_R    040h  ADCLRCLK2 Rate
                                 ATE [10:0]         ADCLRCLK2 clock output =
                                                    BCLK2 / AIF2ADC_RATE
                                                    Integer (LSB = 1)
                                                    Valid from 8..2047
                                                                     2
               R789 (0315h)  12  AIF2DAC_L      0   Right, left and I S modes – LRCLK2 polarity
               AIF2DAC           RCLK_INV           0 = normal LRCLK2 polarity
               LRCLK                                1 = invert LRCLK2 polarity
                                                    Note that AIF2DAC_LRCLK_INV selects the
                                                    LRCLK2 polarity in Master mode and in Slave
                                                    mode.
                                                                          PP, March 2014, Rev 3.5
w
                                                                                              187


WM8958                                                                                            Pre-Production
           REGISTER         BIT        LABEL        DEFAULT                      DESCRIPTION
           ADDRESS
                                                                 DSP Mode – mode A/B select
                                                                 0 = MSB is available on 2nd BCLK2 rising
                                                                 edge after LRCLK2 rising edge (mode A)
                                                                 1 = MSB is available on 1st BCLK2 rising
                                                                 edge after LRCLK2 rising edge (mode B)
                            11      AIF2DAC_L           0        Allows LRCLK2 to be enabled in Slave mode
                                    RCLK_DIR                     0 = Normal
                                                                 1 = LRCLK2 enabled in Slave mode
                           10:0     AIF2DAC_R         040h       LRCLK2 Rate
                                    ATE [10:0]                   LRCLK2 clock output =
                                                                 BCLK2 / AIF2DAC_RATE
                                                                 Integer (LSB = 1)
                                                                 Valid from 8..2047
       Table 102 AIF2 BCLK and LRCLK Control
       AIF2 - DIGITAL AUDIO DATA CONTROL
       The register bits controlling the audio data format, word length, left/right channel selection and TDM
       control for AIF2 are described in Table 103.
       When TDM mode is enabled on AIF2, the WM8958 can transmit and receive audio data in Slot 0 or
       Slot 1. In this case, the ADCDAT2 output is tri-stated during the unused timeslot, allowing another
       device to transmit data on the same pin. See “Signal Timing Requirements” for the associated timing
       details. (Note that, when TDM is not enabled on AIF2, the ADCDAT2 output is driven logic ‘0’ during
       the unused timeslot.)
                                                                          st              nd
       In DSP mode, the left channel MSB is available on either the 1 (mode B) or 2 (mode A) rising edge
       of BCLK following a rising edge of LRCLK (assuming default BCLK polarity).
       When the AIF2DAC_LRCLK_INV bit is set in DSP mode, then DSP Mode B is selected for the AIF2
       digital input (playback) signal path. When the AIF2DAC_LRCLK_INV bit is not set, then DSP Mode A
       is selected.
       When the AIF2ADC_LRCLK_INV bit is set in DSP mode, then DSP Mode B is selected for the AIF2
       digital output (record) signal path. When the AIF2ADC_LRCLK_INV bit is not set, then DSP Mode A is
       selected.
       Note that the DSP Mode is selected independently for the input/output paths of each digital audio
       interface. Also note that the AIF2ADCLRCLK_INV bits remain valid even when the LRCLK signal is
       common for both paths. See Table 102 for details of the AIF2DAC_LRCLK_INV and
       AIF2ADC_LRCLK_INV register fields.
       A digital gain function is available at the audio interface input path to boost the DAC volume when a
       small signal is received on DACDAT2. This is controlled using the AIF2DAC_BOOST register. To
       prevent clipping, this function should not be used when the boosted data is expected to be greater
       than 0dBFS.
           REGISTER         BIT        LABEL        DEFAULT                      DESCRIPTION
           ADDRESS
         R784 (0310h)       15      AIF2ADCL_           0        AIF2 Left Digital Audio interface source
         AIF2 Control               SRC                          0 = Left ADC data is output on left channel
         (1)                                                     1 = Right ADC data is output on left channel
                            14      AIF2ADCR_           1        AIF2 Right Digital Audio interface source
                                    SRC                          0 = Left ADC data is output on right channel
                                                                 1 = Right ADC data is output on right channel
                            13      AIF2ADC_T           0        AIF2 transmit (ADC) TDM Enable
                                    DM                           0 = Normal ADCDAT2 operation
                                                                 1 = TDM enabled on ADCDAT2
                                                                                       PP, March 2014, Rev 3.5
w
                                                                                                             188


Pre-Production                                                                                  WM8958
                 REGISTER       BIT        LABEL     DEFAULT                   DESCRIPTION
                  ADDRESS
                                 12     AIF2ADC_T        0   AIF2 transmit (ADC) TDM Slot Select
                                        DM_CHAN              0 = Slot 0
                                                             1 = Slot 1
                                6:5     AIF2_WL          10  AIF2 Digital Audio Interface Word Length
                                        [1:0]                00 = 16 bits
                                                             01 = 20 bits
                                                             10 = 24 bits
                                                             11 = 32 bits
                                                             Note - 8-bit modes can be selected using the
                                                             “Companding” control bits.
                                4:3     AIF2_FMT         10  AIF2 Digital Audio Interface Format
                                        [1:0]                00 = Right justified
                                                             01 = Left justified
                                                                   2
                                                             10 = I S Format
                                                             11 = DSP Mode
                R785 (0311h)     15     AIF2DACL_        0   AIF2 Left Receive Data Source Select
                AIF2 Control            SRC                  0 = Left DAC receives left interface data
                (2)                                          1 = Left DAC receives right interface data
                                 14     AIF2DACR_        1   AIF2 Right Receive Data Source Select
                                        SRC                  0 = Right DAC receives left interface data
                                                             1 = Right DAC receives right interface data
                                 13     AIF2DAC_T        0   AIF2 receive (DAC) TDM Enable
                                        DM                   0 = Normal DACDAT2 operation
                                                             1 = TDM enabled on DACDAT2
                                 12     AIF2DAC_T        0   AIF2 receive (DAC) TDM Slot Select
                                        DM_CHAN              0 = Slot 0
                                                             1 = Slot 1
                               11:10    AIF2DAC_B        00  AIF2 Input Path Boost
                                        OOST [1:0]           00 = 0dB
                                                             01 = +6dB (input must not exceed -6dBFS)
                                                             10 = +12dB (input must not exceed -12dBFS)
                                                             11 = +18dB (input must not exceed -18dBFS)
                R790 (0316h)      1     AIF2DACL_         0  AIF2 Left Receive Data Invert
                AIF2 DAC                DAT_INV              0 = Not inverted
                Data                                         1 = Inverted
                                  0     AIF2DACR_        0   AIF2 Right Receive Data Invert
                                        DAT_INV              0 = Not inverted
                                                             1 = Inverted
                R791 (0317h)      1     AIF2ADCL_         0  AIF2 Left Transmit Data Invert
                AIF2 ADC                DAT_INV              0 = Not inverted
                Data                                         1 = Inverted
                                  0     AIF2ADCR_        0   AIF2 Right Transmit Data Invert
                                        DAT_INV              0 = Not inverted
                                                             1 = Inverted
               Table 103 AIF2 Digital Audio Data Control
                                                                                   PP, March 2014, Rev 3.5
w
                                                                                                        189


WM8958                                                                                           Pre-Production
       AIF2 - MONO MODE
       AIF2 can be configured to operate in mono DSP mode by setting AIF2_MONO = 1 as described in
       Table 104. Note that mono mode is only supported in DSP mode, ie when AIF2_FMT = 11.
       In mono mode, the Left channel data or the Right channel data may be selected for output on
       ADCDAT2. The selected channel is determined by the AIF2ADCL_ENA and AIF2ADCR_ENA bits. (If
       both bits are set, then the Right channel data is selected.)
       In mono mode, the DACDAT2 input can be enabled on the Left and/or Right signal paths using the
       AIF2DACL_ENA and AIF2DACR_ENA bits. The mono input can be enabled on both paths at the
       same time if required.
          REGISTER          BIT        LABEL       DEFAULT                         DESCRIPTION
           ADDRESS
         R785 (0311h)        8      AIF2_MONO           0        AIF2 DSP Mono Mode
         AIF2 Control                                            0 = Disabled
         (2)                                                     1 = Enabled
                                                                 Note that Mono Mode is only supported when
                                                                 AIF2_FMT = 11.
       Table 104 AIF2 Mono Mode Control
       AIF2 - COMPANDING
       The WM8958 supports A-law and -law companding on both transmit (ADC) and receive (DAC) sides
       of AIF2. This is configured using the register bits described in Table 105.
       For more details on Companding, see the Audio Interface AIF1 description above.
          REGISTER          BIT        LABEL       DEFAULT                         DESCRIPTION
           ADDRESS
         R785 (0311h)        4      AIF2DAC_C           0        AIF2 Receive Companding Enable
         AIF2 Control               OMP                          0 = Disabled
         (2)                                                     1 = Enabled
                             3      AIF2DAC_C           0        AIF2 Receive Companding Type
                                    OMPMODE                      0 = µ-law
                                                                 1 = A-law
                             2      AIF2ADC_C           0        AIF2 Transmit Companding Enable
                                    OMP                          0 = Disabled
                                                                 1 = Enabled
                             1      AIF2ADC_C           0        AIF2 Transmit Companding Type
                                    OMPMODE                      0 = µ-law
                                                                 1 = A-law
       Table 105 AIF2 Companding
       AIF2 - LOOPBACK
       The AIF2 interface can provide a Loopback option. When the AIF2_LOOPBACK bit is set, then AIF2
       digital audio output is routed to the AIF2 digital audio input. The normal input (DACDAT2) is not used
       when AIF2 Loopback is enabled.
          REGISTER          BIT        LABEL       DEFAULT                         DESCRIPTION
           ADDRESS
         R785 (0311h)        0      AIF2_LOOP           0        AIF2 Digital Loopback Function
         AIF2 Control               BACK                         0 = No loopback
         (2)                                                     1 = Loopback enabled (ADCDAT2 data output
                                                                 is directly input to DACDAT2 data input).
       Table 106 AIF2 Loopback
                                                                                        PP, March 2014, Rev 3.5
w
                                                                                                           190


Pre-Production                                                                                        WM8958
               AIF2 - DIGITAL PULL-UP AND PULL-DOWN
               The WM8958 provides integrated pull-up and pull-down resistors on each of the DACDAT2,
               DACLRCLK2 and BCLK2 pins. This provides a flexible capability for interfacing with other devices.
               Each of the pull-up and pull-down resistors can be configured independently using the register bits
               described in Table 107. Note that if the Pull-up and Pull-down are both enabled for any pin, then the
               pull-up and pull-down will be disabled.
               Note that pull-up and pull-down resistors are also provided on the GPIO6/ADCLRCLK2 pin; this is
               described in the “General Purpose Input/Output” section.
                   REGISTER        BIT         LABEL          DEFAULT                   DESCRIPTION
                   ADDRESS
                 R1794             14      BCLK2_PU              0         BCLK2 Pull-up enable
                 (0702h)                                                   0 = Disabled
                 Pull Control                                              1 = Enabled
                 (BCLK2)
                                   13      BCLK2_PD              1         BCLK2 Pull-down enable
                                                                           0 = Disabled
                                                                           1 = Enabled
                 R1795             14      DACLRCLK2_            0         DACLRCLK2 Pull-up enable
                 (0703h)                   PU                              0 = Disabled
                 Pull Control                                              1 = Enabled
                 (DACLRCLK2)
                                   13      DACLRCLK2_            1         DACLRCLK2 Pull-down enable
                                           PD                              0 = Disabled
                                                                           1 = Enabled
                 R1796             14      DACDAT2_PU            0         DACDAT2 Pull-up enable
                 (0704h)                                                   0 = Disabled
                 Pull Control                                              1 = Enabled
                 (DACDAT2)
                                   13      DACDAT2_PD            1         DACDAT2 Pull-down enable
                                                                           0 = Disabled
                                                                           1 = Enabled
               Table 107 AIF2 Digital Pull-Up and Pull-Down Control
                                                                                           PP, March 2014, Rev 3.5
w
                                                                                                                191


WM8958                                                                                                                                                                                                                                                                                                                                                Pre-Production
         AIF3 - SIGNAL PATH CONFIGURATION AND TRI-STATE CONTROL
         The AIF3 interface provides Mono PCM digital audio paths to/from the AIF2 DSP functions. The AIF3
         interface can also support stereo digital audio paths via multiplexers to provide alternate connections
         to AIF1 or AIF2. The relevant multiplexers are illustrated in Figure 67.
             AIF1ADC1R_ENA        AIF1ADC1L_ENA        AIF1ADC2R_ENA        AIF1ADC2L_ENA              AIF1DAC1R_ENA        AIF1DAC1L_ENA            AIF1DAC2R_ENA        AIF1DAC2L_ENA                 AIF2DACR_ENA        AIF2DACL_ENA              AIF2ADCR_ENA        AIF2ADCL_ENA
                                                                                                                                                                                               AIF2DAC_SRC
                                                                                                                                                                                                                       Left / Right source select /
                                    Left / Right source select / Mono Mix control
                                                                                                                                                                                                                            Mono Mix control
                                                                                                                                                                                                                                                                                                           AIF3ADC_SRC[1:0]
                                                                                                                                                                                                                                                      AIF2TXR_ENA         AIF2TXL_ENA
                             0R                   0L                   1R                   1L                         0R                   0L                       1R                   1L                           0R                  0L                        0R                  0L
                                                    DIGITAL AUDIO                                                                                                                                          DIGITAL AUDIO                                                                                MONO PCM
                                                  INTERFACE 1 (AIF1)                                                                                                                                     INTERFACE 2 (AIF2)                                                                             INTERFACE
                                                                                                                 AIF1_DACDAT_SRC                                                                                                                                      AIF2_DACDAT_SRC
                                                                                                                                                                                                                                                                                                           AIF3_ADCDAT_SRC[1:0]
                                                                                                                                                                                                                                                                                                                                                      LRCLK2           BCLK2
                                                                                                                                                                                                                                                                                                                                                      LRCLK1           BCLK1
                                                                                                                                                                                                                                                                                                    AIF2_ADCDAT_SRC
                                                        BCLK1                                                                                                                                                           BCLK2               LRCLK2
                                                                                                                                                                                                                                                     DACDAT2
                                                                                                                                                                                                                                                                          GPIO6/ADCLRCLK2
                                                                                                                                                                                                                                                                                              ADCDAT2
                                                                                                                                                                                                                                                                                                                      GPIO9/ADCDAT3   GPIO8/DACDAT3    GPIO10/LRCLK3   GPIO11/BCLK3
                                                                             LRCLK1
                                                                                                 DACDAT1               ADCDAT1
                                                                                                                                            GPIO1/ADCLRCLK1
         Figure 67 Audio Interface AIF3 Configuration
         Note that all of the AIF3 connections are supported on pins which also provide GPIO functions. These
         pins must be configured as AIF functions when used as audio interface pins. See “General Purpose
         Input/Output”.
         The GPIO8 pin supports the DACDAT3 function, which provides the input to the AIF3 Mono PCM
         interface.
         When AIF3 Mono PCM input is used, this must be configured as an input to the AIF2 input paths
         using the AIF2DAC_SRC register as described in Table 108. The AIF3 Mono input may be selected
         on either channel (Left or Right), with AIF2 input enabled on the opposite channel at the same time.
         When AIF3 Mono PCM input is used, the AIF2 input paths must be enabled using the
         AIF2DACR_ENA and AIF2DACL_ENA register bits defined in Table 101.
         The DACDAT3 input pin can also be used as an input (mono or stereo) to AIF1 or AIF2. The data
         input source for AIF1 is selected using the AIF1_DACDAT_SRC register. The data input source for
         AIF2 is selected using the AIF2_DACDAT_SRC register.
         The DACDAT3 input pin can also be routed to the ADCDAT2 output. The ADCDAT2 source is
         selected using the AIF2_ADCDAT_SRC register.
                                                                                                                                                                                                                                                                                                                PP, March 2014, Rev 3.5
w
                                                                                                                                                                                                                                                                                                                                                                                      192


Pre-Production                                                                                                WM8958
               The GPIO9 pin supports the ADCDAT3 function, which supports the output from the AIF3 Mono PCM
               interface. The source for the ADCDAT3 pin is selected using the AIF3_ADCDAT_SRC register.
               When AIF3 Mono PCM output is used, the data source must be configured using the AIF3ADC_SRC
               register; this selects either the Left or Right AIF2 output paths as the data source.
               When AIF3 Mono PCM output is used, the AIF2 output paths must be enabled using the
               AIF2ADCR_ENA and AIF2ADCL_ENA register bits. Note that, if AIF3 Mono PCM output is required
               and AIF2 output is not used, then the AIF2 output can be disabled using the AIF2TXL_ENA and
               AIF2TXR_ENA registers. See Table 101 for details of these registers.
               The ADCDAT3 pin can also be used as an alternate data output (mono or stereo) from AIF1 or AIF2,
               or can be connected to the DACDAT2 data input.
               The AIF3 interface can be tri-stated by setting the AIF3_TRI register. When this bit is set, then all of
               the AIF3 outputs are un-driven (high-impedance). The AIF3_TRI register only affects those pins which
               are configured for AIF3 functions; it does not affect pins which are configured for other functions.
               The AIF3 control registers are described in Table 108.
                   REGISTER          BIT        LABEL        DEFAULT                        DESCRIPTION
                   ADDRESS
                 R6 (0006h)         10:9     AIF3ADC_S           00       AIF3 Mono PCM output source select
                 Power                       RC [1:0]                     00 = None
                 Management                                               01 = AIF2ADC (Left) output path
                 (6)
                                                                          10 = AIF2ADC (Right) output path
                                                                          11 = Reserved
                                     8:7     AIF2DAC_S           00       AIF2 input path select
                                             RC [1:0]                     00 = Left and Right inputs from AIF2
                                                                          01 = Left input from AIF2; Right input from
                                                                          AIF3
                                                                          10 = Left input from AIF3; Right input from
                                                                          AIF2
                                                                          11 = Reserved
                                      5      AIF3_TRI             0       AIF3 Audio Interface tri-state
                                                                          0 = AIF3 pins operate normally
                                                                          1 = Tri-state all AIF3 interface pins
                                                                          Note that pins not configured as AIF3
                                                                          functions are not affected by this register.
                                     4:3     AIF3_ADCD           00       GPIO9/ADCDAT3 Source select
                                             AT_SRC                       00 = AIF1 ADCDAT1
                                             [1:0]
                                                                          01 = AIF2 ADCDAT2
                                                                          10 = DACDAT2
                                                                          11 = AIF3 Mono PCM output
                                                                          Note that GPIO9 must be configured as
                                                                          ADCDAT3.
                                      2      AIF2_ADCD            0       ADCDAT2 Source select
                                             AT_SRC                       0 = AIF2 ADCDAT2
                                                                          1 = GPIO8/DACDAT3
                                                                          For selection 1, the GPIO8 pin must also be
                                                                          configured as DACDAT3.
                                      1      AIF2_DACD            0       AIF2 DACDAT Source select
                                             AT_SRC                       0 = DACDAT2
                                                                          1 = GPIO8/DACDAT3
                                                                          For selection 1, the GPIO8 pin must also be
                                                                          configured as DACDAT3.
                                                                                                 PP, March 2014, Rev 3.5
w
                                                                                                                       193


WM8958                                                                                           Pre-Production
          REGISTER          BIT      LABEL       DEFAULT                         DESCRIPTION
           ADDRESS
                             0    AIF1_DACD          0         AIF1 DACDAT Source select
                                  AT_SRC                       0 = DACDAT1
                                                               1 = GPIO8/DACDAT3
                                                               Note that, for selection 1, the GPIO8 pin must
                                                               be configured as DACDAT3.
       Table 108 AIF3 Signal Path Configuration
       AIF3 - BCLK AND LRCLK CONTROL
       The GPIO10 pin supports the LRCLK3 function. When configured as LRCLK3, this pin outputs the
       LRCLK signal from AIF1 or AIF2. The applicable AIF source is determined automatically as defined in
       Table 109. Note that the LRCLK3 signal is also controlled by the logic illustrated in Figure 63 (AIF1) or
       Figure 66 (AIF2), depending on the selected AIF source.
       The GPIO11 pin supports the BCLK3 function. When configured as BCLK3, this pin outputs the BCLK
       signal from AIF1 or AIF2. The applicable AIF source is determined automatically as defined in Table
       109. Note that the BCLK3 signal is also controlled by the logic illustrated in Figure 63 (AIF1) or Figure
       66 (AIF2), depending on the selected AIF source.
                           CONDITION                                          DESCRIPTION
         AIF1_DACDAT_SRC = 1                             AIF1 selected as BCLK3 / LRCLK3 source
         (DACDAT3 selected as AIF1 data input)
         or
         AIF3_ADCDAT_SRC[1:0] = 00
         (AIF1 data output selected on ADCDAT3)
         All other conditions                            AIF2 selected as BCLK3 / LRCLK3 source
       Table 109 BCLK3 / LRCLK3 Configuration
       The LRCLK3 output can be inverted by setting the AIF3_LRCLK_INV register. Note that AIF3
       operates in Master mode only.
          REGISTER          BIT      LABEL       DEFAULT                         DESCRIPTION
           ADDRESS
                                                                                2
         R800 (0320h)        7    AIF3_LRCL          0         Right, left and I S modes – LRCLK3 polarity
         AIF3 Control             K_INV                        0 = normal LRCLK3 polarity
         (1)                                                   1 = invert LRCLK3 polarity
                                                               DSP Mode – mode A/B select
                                                               0 = MSB is available on 2nd BCLK3 rising
                                                               edge after LRCLK3 rising edge (mode A)
                                                               1 = MSB is available on 1st BCLK3 rising
                                                               edge after LRCLK3 rising edge (mode B)
       Table 110 AIF3 LRCLK Control
                                                                                      PP, March 2014, Rev 3.5
w
                                                                                                            194


Pre-Production                                                                                               WM8958
               AIF3 - DIGITAL AUDIO DATA CONTROL
               The register bits controlling the AIF3 Mono PCM interface are described in Table 111.
               Note that these registers control the AIF3 Mono PCM interface only; they are not applicable to the
               ADCDAT3 and DACDAT3 signal paths when these pins are selected as alternate inputs to the AIF1 or
               AIF2 interfaces.
               The audio data format for AIF3 is set the same as AIF2; this is controlled using the AIF2_FMT
               register, as described in see Table 103.
                                                                                            st                nd
               In DSP mode, the AIF3 Mono channel MSB is available on either the 1 (mode B) or 2 (mode A)
               rising edge of BCLK following a rising edge of LRCLK. The applicable DSP mode is selected using the
               AIF3_LRCLK_INV bit, as described in Table 110.
               In Left justified, Right justified and I2S modes, the AIF3 Mono interface data is transmitted and
               received in the Left channel data bits of the ADCDAT3 and DACDAT3 channels.
               A digital gain function is available at the audio interface input path to boost the DAC volume when a
               small signal is received on DACDAT3. This is controlled using the AIF3DAC_BOOST register. To
               prevent clipping, this function should not be used when the boosted data is expected to be greater
               than 0dBFS.
                   REGISTER         BIT         LABEL       DEFAULT                      DESCRIPTION
                    ADDRESS
                  R800 (0320h)      6:5     AIF3_WL            10        AIF3 Digital Audio Interface Word Length
                  AIF3 Control              [1:0]                        00 = 16 bits
                  (1)                                                    01 = 20 bits
                                                                         10 = 24 bits
                                                                         11 = 32 bits
                                                                         Note - 8-bit modes can be selected using the
                                                                         “Companding” control bits.
                                                                         Note that this controls the AIF3 Mono PCM
                                                                         interface path only; it does not affect AIF3
                                                                         inputs/outputs routed to AIF1 or AIF2.
                  R801 (0321h)     11:10    AIF3DAC_B          00        AIF3 Input Path Boost
                  AIF3 Control              OOST [1:0]                   00 = 0dB
                  (2)                                                    01 = +6dB (input must not exceed -6dBFS)
                                                                         10 = +12dB (input must not exceed -12dBFS)
                                                                         11 = +18dB (input must not exceed -18dBFS)
                                                                         Note that this controls the AIF3 Mono PCM
                                                                         interface path only; it does not affect
                                                                         DACDAT3 input to AIF1 or AIF2.
                  R802 (0322h)       0      AIF3DAC_D           0        AIF3 Receive Data Invert
                  AIF3DAC                   AT_INV                       0 = Not inverted
                  Data                                                   1 = Inverted
                                                                         Note that this controls the AIF3 Mono PCM
                                                                         interface path only; it does not affect
                                                                         DACDAT3 input to AIF1 or AIF2.
                  R803 (0323h)       0      AIF3ADC_D           0        AIF3 Transmit Data Invert
                  AIF3ADC                   AT_INV                       0 = Not inverted
                  Data                                                   1 = Inverted
                                                                         Note that this controls the AIF3 Mono PCM
                                                                         interface path only; it does not affect
                                                                         ADCDAT3 output from AIF1 or AIF2.
               Table 111 AIF3 Digital Audio Data Control
                                                                                                 PP, March 2014, Rev 3.5
w
                                                                                                                      195


WM8958                                                                                             Pre-Production
       AIF3 - COMPANDING
       The WM8958 supports A-law and -law companding on both transmit (ADC) and receive (DAC) sides
       of AIF3. This is configured using the register bits described in Table 112.
       Note that these registers control the AIF3 Mono PCM interface only; they are not applicable to the
       ADCDAT3 and DACDAT3 signal paths when these pins are selected as alternate inputs to the AIF1 or
       AIF2 interfaces.
       For more details on Companding, see the Audio Interface AIF1 description above.
          REGISTER         BIT        LABEL        DEFAULT                        DESCRIPTION
           ADDRESS
         R801 (0321h)        4     AIF3DAC_C            0        AIF3 Receive Companding Enable
         AIF3 Control              OMP                           0 = Disabled
         (2)                                                     1 = Enabled
                                                                 Note that this controls the AIF3 Mono PCM
                                                                 interface path only; it does not affect
                                                                 DACDAT3 input to AIF1 or AIF2.
                             3     AIF3DAC_C            0        AIF3 Receive Companding Type
                                   OMPMODE                       0 = µ-law
                                                                 1 = A-law
                                                                 Note that this controls the AIF3 Mono PCM
                                                                 interface path only; it does not affect
                                                                 DACDAT3 input to AIF1 or AIF2.
                             2     AIF3ADC_C            0        AIF3 Transmit Companding Enable
                                   OMP                           0 = Disabled
                                                                 1 = Enabled
                                                                 Note that this controls the AIF3 Mono PCM
                                                                 interface path only; it does not affect
                                                                 ADCDAT3 output from AIF1 or AIF2.
                             1     AIF3ADC_C            0        AIF3 Transmit Companding Type
                                   OMPMODE                       0 = µ-law
                                                                 1 = A-law
                                                                 Note that this controls the AIF3 Mono PCM
                                                                 interface path only; it does not affect
                                                                 ADCDAT3 output from AIF1 or AIF2.
       Table 112 AIF3 Companding
       AIF3 - LOOPBACK
       The AIF3 interface can provide a Loopback option. When the AIF3_LOOPBACK bit is set, then AIF3
       Mono PCM output is routed to the AIF3 Mono PCM input. The normal input (DACDAT3) is not used
       when AIF3 Loopback is enabled.
          REGISTER         BIT        LABEL        DEFAULT                        DESCRIPTION
           ADDRESS
         R801 (0321h)        0     AIF3_LOOP            0        AIF3 Digital Loopback Function
         AIF3 Control              BACK                          0 = No loopback
         (2)                                                     1 = Loopback enabled (AIF3 Mono PCM data
                                                                 output is directly input to AIF3 Mono PCM
                                                                 data input).
       Table 113 AIF3 Loopback
                                                                                         PP, March 2014, Rev 3.5
w
                                                                                                             196


Pre-Production                                                                                            WM8958
CLOCKING AND SAMPLE RATES
               The WM8958 requires a clock for each of the Digital Audio Interfaces (AIF1 and AIF2). These may be
               derived from a common clock reference, or from independent references. Under typical clocking
               configurations, many commonly-used audio sample rates can be derived directly from the external
               reference; for additional flexibility, the WM8958 incorporates two Frequency Locked Loop (FLL)
               circuits to perform frequency conversion and filtering.
               External clock signals may be connected via MCLK1 and MCLK2. In AIF Slave modes, the BCLK or
               LRCLK signals may be used as a reference for the AIF clocks.
               The WM8958 performs stereo full-duplex sample rate conversion between the audio interfaces AIF1
               and AIF2, enabling digital audio to be routed between the interfaces, and asynchronous audio data to
               be mixed together. See “Sample Rate Conversion” for further details.
               In AIF Slave modes, it is important to ensure the applicable AIF clock (AIF1CLK or AIF2CLK) is
               synchronised with the associated external LRCLK. This can be achieved by selecting an MCLK input
               that is derived from the same reference as the LRCLK, or can be achieved by selecting the external
               BCLK or LRCLK signals as a reference input to one of the FLLs, as a source for the AIF clock.
               If the AIF clock is not synchronised with the LRCLK, then clicks arising from dropped or repeated
               audio samples will occur, due to the inherent tolerances of multiple, asynchronous, system clocks.
               See “Applications Information” for further details on valid clocking configurations.
               Clocking for the Audio Interfaces is provided by AIF1CLK and AIF2CLK for AIF1 and AIF2
               respectively. An additional internal clock, SYSCLK is derived from either AIF1CLK or AIF2CLK in
               order to support the DSP core functions, Charge Pump, Class D switching amplifier, DC servo control,
               Control Write Sequencer and other internal functions. A further clock, DSP2CLK, is derived from
               either AIF1CLK or AIF2CLK in order to support the Multiband Compressor (MBC) function.
               The following operating limits must be observed when configuring the WM8958 clocks. Failure to
               observe these limits will result in degraded performance and/or incorrect system functionality. Latency
               in the WM8958 signal paths is reduced at high SYSCLK frequencies; power consumption is reduced
               at low SYSCLK frequencies.
                          SYSCLK  12.5MHz
                          SYSCLK  4.096MHz
                          SYSCLK  256 x fs (where fs = fastest audio sample rate in use)
                          AIF1CLK  12.5MHz
                          AIF1CLK  256 x AIF1 sample rate (AIF1_SR)
                          AIF2CLK  12.5MHz
                          AIF2CLK  256 x AIF2 sample rate (AIF2_SR)
                          DSP2CLK  256 x AIFn sample rate (when MBC is enabled on the AIFn playback path)
               Note that, if DAC_OSR128 = 0 and ADC_OSR128 = 0, then a slower SYSCLK frequency is possible;
               in this case, the requirement is SYSCLK  2.048MHz.
               Note that, under specific operating conditions, clocking ratios of 128 x fs and 192 x fs are possible;
               this is described in the “Digital to Analogue Converter (DAC)” section.
               The SYSCLK frequency must be  256 x fs, (where fs is the faster rate of AIF1_SR or AIF2_SR). The
               SYSCLK frequency is derived from AIF1CLK or AIF2CLK, as selected by the SYSCLK_SRC register
               (see Table 118).
                                                                                               PP, March 2014, Rev 3.5
w
                                                                                                                  197


WM8958                                                                                                                Pre-Production
                           Note that the bandwidth of the digital audio mixing paths will be determined by the sample rate of
                           whichever AIF is selected as the SYSCLK source. When using only one audio interface, the active
                           interface should be selected as the SYSCLK source. For best audio performance when using AIF1
                           and AIF2 simultaneously, the SYSCLK source must select the AIF with the highest sample rate
                           (AIFn_SR).
                           The AIFnCLK / fs ratio is the ratio of AIFnCLK to the AIFn sample rate, where ‘n’ identifies the
                           applicable audio interface AIF1 or AIF2. The AIF clocking ratio and sample rate are set by the
                           AIFnCLK_RATE and AIFn_SR register fields, defined in Table 115 and Table 117.
                           Note that, in the case of mixed input/output path sample rates on either interface, then
                           AIFnCLK_RATE and AIFn_SR are set according to the higher of the two sample rates.
                           The clocking configuration for AIF1CLK, AIF2CLK, SYSCLK and DSP2CLK is illustrated in Figure 68.
                           The SYSCLK_SRC register is defined in Table 118.
                           The WM8958 provides integrated pull-up and pull-down resistors on the MCLK1 and MCLK2 pins.
                           This provides a flexible capability for interfacing with other devices. This is configured as described in
                           Table 118. Note that if the Pull-up and Pull-down are both enabled for any pin, then the pull-up and
                           pull-down will be disabled.
Figure 68 Audio Interface Clock Control
                           AIF1CLK ENABLE
                           The AIF1CLK_SRC register is used to select the AIF1CLK source. The source may be MCLK1,
                           MCLK2, FLL1 or FLL2. If either of the Frequency Locked Loops is selected as the source, then the
                           FLL(s) must be enabled and configured as described later.
                           The AIF1CLK clock may be adjusted by the AIF1CLK_DIV divider, which provides a divide-by-two
                           option. The selected source may also be inverted by setting the AIF1CLK_INV bit.
                           The maximum AIF1CLK frequency is specified in the “Electrical Characteristics” section. Note that,
                           when AIF1CLK_DIV = 1, the maximum frequency limit applies to the divided-down AIF1CLK
                           frequency.
                           The AIF1CLK is enabled by the register bit AIF1CLK_ENA. This bit should be set to 0 when
                           reconfiguring the clock sources. It is not recommended to change AIF1CLK_SRC while the
                           AIF1CLK_ENA bit is set.
                                                                                                            PP, March 2014, Rev 3.5
w
                                                                                                                                 198


Pre-Production                                                                                          WM8958
                   REGISTER         BIT         LABEL         DEFAULT                    DESCRIPTION
                   ADDRESS
                 R512 (0200h)       4:3     AIF1CLK_SR             00       AIF1CLK Source Select
                 AIF 1                      C                               00 = MCLK1
                 Clocking (1)                                               01 = MCLK2
                                                                            10 = FLL1
                                                                            11 = FLL2
                                     2      AIF1CLK_INV             0       AIF1CLK Invert
                                                                            0 = AIF1CLK not inverted
                                                                            1 = AIF1CLK inverted
                                     1      AIF1CLK_DIV             0       AIF1CLK Divider
                                                                            0 = AIF1CLK
                                                                            1 = AIF1CLK / 2
                                     0      AIF1CLK_EN              0       AIF1CLK Enable
                                            A                               0 = Disabled
                                                                            1 = Enabled
               Table 114 AIF1CLK Enable
               AIF1 CLOCKING CONFIGURATION
               The WM8958 supports a wide range of standard audio sample rates from 8kHz to 96kHz. The AIF1
               clocking configuration is selected using 4 control fields, which are set according to the required AIF
               digital audio sample rate, and the ADC/DAC clocking rate.
               The AIF1_SR register is set according to the AIF1 sample rate. Note that 88.2kHz and 96kHz modes
               are supported for AIF1 input (DAC playback) only.
               The AIF1CLK_RATE register is set according to the ratio of AIF1CLK to the AIF1 sample rate. Note
               that there a some restrictions on the supported clocking ratios, depending on the selected sample rate
               and operating conditions. The supported configurations are detailed in the “Digital Microphone
               Interface”, “Analogue to Digital Converter (ADC)” and “Digital to Analogue Converter (DAC)” sections,
               according to each applicable function.
               The audio interface can support different sample rates for the input data (DAC path) and output data
               (ADC path) simultaneously. In this case, the AIF1_SR and AIF1CLK_RATE fields should be set
               according to the faster of the two sample rates.
               When different sample rates are used for input data (DAC path) and output data (ADC path), the
               clocking of the slower path is set using AIF1DAC_DIV (if the AIF input path has the slower sample
               rate) or AIF1ADC_DIV (if the AIF output path has the slower sample rate). The appropriate divider is
               set according to the ratio of the two sample rates.
               For example, if AIF1 input uses 48kHz sample rate, and AIF1 output uses 8kHz, then AIF1ADC_DIV
               should be set to 110b (divide by 6).
               Note that the audio interface cannot support every possible combination of input and output sample
               rate simultaneously, but only where the ratio of the sample rates matches the available AIF1ADC_DIV
               or AIF1DAC_DIV divider settings.
               Note that the WM8958 performs sample rate conversion, where necessary, to provide digital mixing
               and interconnectivity between the Audio Interfaces and the DSP Core functions. One stereo Sample
               Rate Converter (SRC) is provided for audio input; a second stereo SRC is provided for audio output.
               Each SRC is automatically configured on AIF1 or AIF2, depending on the selected Clocking and
               Sample Rate settings. The WM8958 cannot support configurations that would require SRC on the
               input or output paths of both interfaces simultaneously. See “Sample Rate Conversion” for further
               details.
                                                                                            PP, March 2014, Rev 3.5
w
                                                                                                                 199


WM8958                                                                            Pre-Production
          REGISTER       BIT      LABEL      DEFAULT               DESCRIPTION
          ADDRESS
        R513 (0201h)     5:3   AIF1DAC_DIV     000   Selects the AIF1 input path sample rate
        AIF 1                                        relative to the AIF1 output path sample
        Clocking (2)                                 rate.
                                                     This field should only be changed from
                                                     default in modes where the AIF1 input
                                                     path sample rate is slower than the AIF1
                                                     output path sample rate.
                                                     000 = Divide by 1
                                                     001 = Divide by 1.5
                                                     010 = Divide by 2
                                                     011 = Divide by 3
                                                     100 = Divide by 4
                                                     101 = Divide by 5.5
                                                     110 = Divide by 6
                                                     111 = Reserved
                         2:0   AIF1ADC_DIV      000  Selects the AIF1 output path sample rate
                                                     relative to the AIF1 input path sample
                                                     rate.
                                                     This field should only be changed from
                                                     default in modes where the AIF1 output
                                                     path sample rate is slower than the AIF1
                                                     input path sample rate.
                                                     000 = Divide by 1
                                                     001 = Divide by 1.5
                                                     010 = Divide by 2
                                                     011 = Divide by 3
                                                     100 = Divide by 4
                                                     101 = Divide by 5.5
                                                     110 = Divide by 6
                                                     111 = Reserved
        R528 (0210h)     7:4   AIF1_SR         1000  Selects the AIF1 Sample Rate (fs)
        AIF1 Rate                                    0000 = 8kHz
                                                     0001 = 11.025kHz
                                                     0010 = 12kHz
                                                     0011 = 16kHz
                                                     0100 = 22.05kHz
                                                     0101 = 24kHz
                                                     0110 = 32kHz
                                                     0111 = 44.1kHz
                                                     1000 = 48kHz
                                                     1001 = 88.2kHz
                                                     1010 = 96kHz
                                                     All other codes = Reserved
                                                     Note that 88.2kHz and 96kHz modes are
                                                     supported for AIF1 input (DAC playback)
                                                     only.
                         3:0   AIF1CLK_RAT     0011  Selects the AIF1CLK / fs ratio
                               E                     0000 = Reserved
                                                     0001 = 128
                                                     0010 = 192
                                                     0011 = 256
                                                     0100 = 384
                                                     0101 = 512
                                                     0110 = 768
                                                     0111 = 1024
                                                     1000 = 1408
                                                     1001 = 1536
                                                     All other codes = Reserved
       Table 115 AIF1 Clocking Configuration
                                                                       PP, March 2014, Rev 3.5
w
                                                                                            200


Pre-Production                                                                                          WM8958
               AIF2CLK ENABLE
               The AIF2CLK_SRC register is used to select the AIF2CLK source. The source may be MCLK1,
               MCLK2, FLL1 or FLL2. If either of the Frequency Locked Loops is selected as the source, then the
               FLL(s) must be enabled and configured as described later.
               The AIF2CLK clock may be adjusted by the AIF2CLK_DIV divider, which provides a divide-by-two
               option. The selected source may also be inverted by setting the AIF2CLK_INV bit.
               The maximum AIF2CLK frequency is specified in the “Electrical Characteristics” section. Note that,
               when AIF2CLK_DIV = 1, the maximum frequency limit applies to the divided-down AIF2CLK
               frequency.
               The AIF2CLK is enabled by the register bit AIF2CLK_ENA. This bit should be set to 0 when
               reconfiguring the clock sources. It is not recommended to change AIF2CLK_SRC while the
               AIF2CLK_ENA bit is set.
                   REGISTER         BIT         LABEL         DEFAULT                    DESCRIPTION
                   ADDRESS
                 R516 (0204h)       4:3     AIF2CLK_SR             00       AIF2CLK Source Select
                 AIF 2                      C                               00 = MCLK1
                 Clocking (1)                                               01 = MCLK2
                                                                            10 = FLL1
                                                                            11 = FLL2
                                     2      AIF2CLK_INV             0       AIF2CLK Invert
                                                                            0 = AIF2CLK not inverted
                                                                            1 = AIF2CLK inverted
                                     1      AIF2CLK_DIV             0       AIF2CLK Divider
                                                                            0 = AIF2CLK
                                                                            1 = AIF2CLK / 2
                                     0      AIF2CLK_EN              0       AIF2CLK Enable
                                            A                               0 = Disabled
                                                                            1 = Enabled
               Table 116 AIF2CLK Enable
               AIF2 CLOCKING CONFIGURATION
               The WM8958 supports a wide range of standard audio sample rates from 8kHz to 96kHz. The AIF2
               clocking configuration is selected using 4 control fields, which are set according to the required AIF
               digital audio sample rate, and the ADC/DAC clocking rate.
               The AIF2_SR register is set according to the AIF2 sample rate. Note that 88.2kHz and 96kHz modes
               are supported for AIF2 input (DAC playback) only.
               The AIF2CLK_RATE register is set according to the ratio of AIF2CLK to the AIF2 sample rate. Note
               that there a some restrictions on the supported clocking ratios, depending on the selected sample rate
               and operating conditions. The supported configurations are detailed in the “Digital Microphone
               Interface”, “Analogue to Digital Converter (ADC)” and “Digital to Analogue Converter (DAC)” sections,
               according to each applicable function.
               The audio interface can support different sample rates for the input data (DAC path) and output data
               (ADC path) simultaneously. In this case, the AIF2_SR and AIF2CLK_RATE fields should be set
               according to the faster of the two sample rates.
               When different sample rates are used for input data (DAC path) and output data (ADC path), the
               clocking of the slower path is set using AIF2DAC_DIV (if the AIF input path has the slower sample
               rate) or AIF2ADC_DIV (if the AIF output path has the slower sample rate). The appropriate divider is
               set according to the ratio of the two sample rates.
               For example, if AIF2 input uses 48kHz sample rate, and AIF2 output uses 8kHz, then AIF2ADC_DIV
               should be set to 110b (divide by 6).
               Note that the audio interface cannot support every possible combination of input and output sample
               rate simultaneously, but only where the ratio of the sample rates matches the available AIF2ADC_DIV
               or AIF2DAC_DIV divider settings.
                                                                                            PP, March 2014, Rev 3.5
w
                                                                                                                 201


WM8958                                                                                        Pre-Production
       Note that the WM8958 performs sample rate conversion, where necessary, to provide digital mixing
       and interconnectivity between the Audio Interfaces and the DSP Core functions. One stereo Sample
       Rate Converter (SRC) is provided for audio input; a second stereo SRC is provided for audio output.
       Each SRC is automatically configured on AIF1 or AIF2, depending on the selected Clocking and
       Sample Rate settings. The WM8958 cannot support configurations that would require SRC on the
       input or output paths of both interfaces simultaneously. See “Sample Rate Conversion” for further
       details.
        REGISTER      BIT        LABEL        DEFAULT                        DESCRIPTION
         ADDRESS
         R517         5:3     AIF2DAC_DIV        000       Selects the AIF2 input path sample rate relative
         (0205h)                                           to the AIF2 output path sample rate.
         AIF 2                                             This field should only be changed from default in
         Clocking                                          modes where the AIF2 input path sample rate is
         (2)                                               slower than the AIF2 output path sample rate.
                                                           000 = Divide by 1
                                                           001 = Divide by 1.5
                                                           010 = Divide by 2
                                                           011 = Divide by 3
                                                           100 = Divide by 4
                                                           101 = Divide by 5.5
                                                           110 = Divide by 6
                                                           111 = Reserved
                      2:0     AIF2ADC_DIV         000      Selects the AIF2 output path sample rate
                                                           relative to the AIF2 input path sample rate.
                                                           This field should only be changed from default in
                                                           modes where the AIF2 output path sample rate
                                                           is slower than the AIF2 input path sample rate.
                                                           000 = Divide by 1
                                                           001 = Divide by 1.5
                                                           010 = Divide by 2
                                                           011 = Divide by 3
                                                           100 = Divide by 4
                                                           101 = Divide by 5.5
                                                           110 = Divide by 6
                                                           111 = Reserved
         R529         7:4     AIF2_SR            1000      Selects the AIF2 Sample Rate (fs)
         (0211h)                                           0000 = 8kHz
         AIF2                                              0001 = 11.025kHz
         Rate
                                                           0010 = 12kHz
                                                           0011 = 16kHz
                                                           0100 = 22.05kHz
                                                           0101 = 24kHz
                                                           0110 = 32kHz
                                                           0111 = 44.1kHz
                                                           1000 = 48kHz
                                                           1001 = 88.2kHz
                                                           1010 = 96kHz
                                                           All other codes = Reserved
                                                           Note that 88.2kHz and 96kHz modes are
                                                           supported for AIF2 input (DAC playback) only.
                                                                                    PP, March 2014, Rev 3.5
w
                                                                                                         202


Pre-Production                                                                                          WM8958
                REGISTER        BIT        LABEL        DEFAULT                       DESCRIPTION
                 ADDRESS
                                3:0     AIF2CLK_RAT        0011      Selects the AIF2CLK / fs ratio
                                        E                            0000 = Reserved
                                                                     0001 = 128
                                                                     0010 = 192
                                                                     0011 = 256
                                                                     0100 = 384
                                                                     0101 = 512
                                                                     0110 = 768
                                                                     0111 = 1024
                                                                     1000 = 1408
                                                                     1001 = 1536
                                                                     All other codes = Reserved
               Table 117 AIF2 Clocking Configuration
               MISCELLANEOUS CLOCK CONTROLS
               SYSCLK provides clocking for many of the WM8958 functions. SYSCLK clock is required to support
               DSP Core functions and also the Charge Pump, Class D switching amplifier, DC servo control,
               Control Write Sequencer and other internal functions.
               The SYSCLK_SRC register is used to select the SYSCLK source. The source may be AIF1CLK or
               AIF2CLK, as illustrated in Figure 69. Note that the bandwidth of the digital audio mixing paths will be
               determined by the sample rate of whichever AIF is selected as the SYSCLK source. When using only
               one audio interface, the active interface should be selected as the SYSCLK source. For best audio
               performance when using AIF1 and AIF2 simultaneously, the SYSCLK source must select the AIF with
               the highest sample rate (AIFn_SR).
               The SYSCLK_SRC register is also used to select the DSP2CLK source; the DSP2CLK clock is
               required for the Multiband Compressor (MBC) function. The MBC can enabled on the AIF1 or AIF2
               input paths, regardless of the SYSCLK_SRC setting, provided that the minimum clocking requirement
               for the MBC is satisfied. See “Multiband Compressor” for further details.
               The MBC clocking is enabled using the DSP2CLK_ENA bit, as illustrated in Figure 69. See “Multiband
               Compressor” for further details of the MBC clocking requirements.
               The AIF1 DSP processing clock is derived from SYSCLK, and enabled by AIF1DSPCLK_ENA.
               The AIF2 DSP processing clock is derived from SYSCLK, and enabled by AIF2DSPCLK_ENA.
               The clocking of the WM8958 ADC, DAC, digital mixer and digital microphone functions is enabled by
               setting SYSDSPCLK_ENA. See “Digital Microphone Interface” for details of the DMICCLK frequency.
               Two modes of ADC / Digital Microphone operation can be selected using the ADC_OSR128 bit. This
               bit is enabled by default, giving best audio performance. De-selecting this bit provides a low power
               alternative setting.
               A high performance mode of DAC operation can be selected by setting the DAC_OSR128 bit. When
               the DAC_OSR128 bit is set, the audio performance is improved, but power consumption is also
               increased.
               A clock is required for the Charge Pump circuit when the ground-referenced headphone outputs
               (HPOUT1L and HPOUT1R) are enabled. The Charge Pump clock is derived from SYSCLK whenever
               the Charge Pump is enabled. The Charge Pump clock division is configured automatically.
               A clock is required for the Class D speaker driver circuit when the speaker outputs (SPKOUTL and
               SPKOUTR) are enabled. The Class D clock is derived from SYSCLK whenever these outputs are
               enabled in Class D mode. The Class D clock division is configured automatically. See “Analogue
               Outputs” for details of the Class D switching frequency.
               A clock output (OPCLK) derived from SYSCLK may be output on a GPIO pin. This clock is enabled by
               register big OPCLK_ENA, and its frequency of this clock is controlled by OPCLK_DIV. See General
               Purpose Input/Output” to configure a GPIO pin for this function.
                                                                                            PP, March 2014, Rev 3.5
w
                                                                                                                 203


WM8958                                                                                       Pre-Production
       A slow clock (TOCLK) is derived internally in order to control volume update timeouts when the zero-
       cross option is selected. This clock is enabled by register bit TOCLK_ENA, and its frequency is
       controlled by TOCLK_DIV.
       A de-bounce control is provided for GPIO inputs and for other functions that may be selected as GPIO
       outputs. The de-bounced clock frequency is controlled by DBCLK_DIV.
       The WM8958 generates a 256kHz clock for internal functions; TOCLK and DBCLK are derived from
       this 256kHz clock. In order to generate this clock correctly when SYSCLK_SRC = 0, valid settings are
       required for AIF1_SR and AIF1CLK_RATE. To generate this clock correctly when SYSCLK_SRC = 1,
       valid settings are required for AIF2_SR and AIF2CLK_RATE.
       The WM8958 Clocking is illustrated in Figure 69.
       Figure 69 System Clocking
                                                                                    PP, March 2014, Rev 3.5
w
                                                                                                        204


Pre-Production                                                                     WM8958
                 REGISTER    BIT    LABEL   DEFAULT               DESCRIPTION
                 ADDRESS
               R2 (0002h)    11  OPCLK_ENA     0    GPIO Clock Output (OPCLK) Enable
               Power                                0 = Disabled
               Management                           1 = Enabled
               (2)
               R520 (0208h)  14  DSP2CLK_EN    0    MBC Processor Clock Enable
               Clocking (1)      A                  0 = Disabled
                                                    1 = Enabled
                              4  TOCLK_ENA     0    Slow Clock (TOCLK) Enable
                                                    0 = Disabled
                                                    1 = Enabled
                                                    This clock is required for zero-cross
                                                    timeout.
                              3  AIF1DSPCLK    0    AIF1 Processing Clock Enable
                                 _ENA               0 = Disabled
                                                    1 = Enabled
                              2  AIF2DSPCLK    0    AIF2 Processing Clock Enable
                                 _ENA               0 = Disabled
                                                    1 = Enabled
                              1  SYSDSPCLK_    0    Digital Mixing Processor Clock Enable
                                 ENA                0 = Disabled
                                                    1 = Enabled
                              0  SYSCLK_SRC    0    SYSCLK Source Select
                                                    0 = AIF1CLK
                                                    1 = AIF2CLK
               R521 (0209h) 10:8 TOCLK_DIV    000   Slow Clock (TOCLK ) Divider
               Clocking (2)                         (Sets TOCLK rate relative to 256kHz.)
                                                    000 = Divide by 256 (1kHz)
                                                    001 = Divide by 512 (500Hz)
                                                    010 = Divide by 1024 (250Hz)
                                                    011 = Divide by 2048 (125Hz)
                                                    100 = Divide by 4096 (62.5Hz)
                                                    101 = Divide by 8192 (31.2Hz)
                                                    110 = Divide by 16384 (15.6Hz)
                                                    111 = Divide by 32768 (7.8Hz)
                             6:4 DBCLK_DIV    000   De-bounce Clock (DBCLK) Divider
                                                    (Sets DBCLK rate relative to 256kHz.)
                                                    000 = Divide by 256 (1kHz)
                                                    001 = Divide by 2048 (125Hz)
                                                    010 = Divide by 4096 (62.5Hz)
                                                    011 = Divide by 8192 (31.2Hz)
                                                    100 = Divide by 16384 (15.6Hz)
                                                    101 = Divide by 32768 (7.8Hz)
                                                    110 = Divide by 65536 (3.9Hz)
                                                    111 = Divide by 131072 (1.95Hz)
                                                                      PP, March 2014, Rev 3.5
w
                                                                                          205


WM8958                                                                                            Pre-Production
           REGISTER         BIT         LABEL            DEFAULT                     DESCRIPTION
           ADDRESS
                            2:0     OPCLK_DIV               000        GPIO Output Clock (OPCLK) Divider
                                                                       0000 = SYSCLK
                                                                       0001 = SYSCLK / 2
                                                                       0010 = SYSCLK / 3
                                                                       0011 = SYSCLK / 4
                                                                       0100 = SYSCLK / 5.5
                                                                       0101 = SYSCLK / 6
                                                                       0110 = SYSCLK / 8
                                                                       0111 = SYSCLK / 12
                                                                       1000 = SYSCLK / 16
                                                                       1001 to 1111 = Reserved
         R1568               1      ADC_OSR128                1        ADC / Digital Microphone Oversample
         (0620h)                                                       Rate Select
         Oversampling                                                  0 = Low Power
                                                                       1 = High Performance
                             0      DAC_OSR128                0        DAC Oversample Rate Select
                                                                       0 = Low Power
                                                                       1 = High Performance
         R1793              14      MCLK2_PU                  0        MCLK2 Pull-up enable
         (0701h)                                                       0 = Disabled
         Pull Control                                                  1 = Enabled
         (MCLK2)
                            13      MCLK2_PD                  1        MCLK2 Pull-down enable
                                                                       0 = Disabled
                                                                       1 = Enabled
         R1824               7      MCLK1_PU                  0        MCLK1 Pull-up enable
         (0720h)                                                       0 = Disabled
         Pull Control                                                  1 = Enabled
         (1)
                             6      MCLK1_PD                  0        MCLK1 Pull-down enable
                                                                       0 = Disabled
                                                                       1 = Enabled
       Table 118 System Clocking
       BCLK AND LRCLK CONTROL
       The digital audio interfaces (AIF1 and AIF2) use BCLK and LRCLK signals for synchronisation. In
       master mode, these are output signals, generated by the WM8958. In slave mode, these are input
       signals to the WM8958. It is also possible to support mixed master/slave operation.
       The BCLK and LRCLK signals are controlled as illustrated in Figure 70. See the “Digital Audio
       Interface Control” section for further details of the relevant control registers.
                                                                                         PP, March 2014, Rev 3.5
w
                                                                                                            206


Pre-Production                                             WM8958
               Figure 70 BCLK and LRCLK Control
                                                PP, March 2014, Rev 3.5
w
                                                                   207


WM8958                                                                                         Pre-Production
       CONTROL INTERFACE CLOCKING
       Register map access is possible with or without a system clock. Clocking is provided from SYSCLK;
       the SYSCLK_SRC register selects either AIF1CLK or AIF2CLK as the applicable SYSCLK source.
       When AIF1CLK is the SYSCLK source (ie. SYSCLK_SRC = 0), and AIF1CLK_ENA = 1, then an
       active clock source for AIF1CLK must be present for control interface clocking. If the AIF1CLK source
       is stopped, then AIF1CLK_ENA must be set to 0 for control register access.
       When AIF2CLK is the SYSCLK source (ie. SYSCLK_SRC = 1), and AIF2CLK_ENA = 1, then an
       active clock source for AIF2CLK must be present for control interface clocking. If the AIF2CLK source
       is stopped, then AIF2CLK_ENA must be set to 0 for control register access.
       FREQUENCY LOCKED LOOP (FLL)
       Two integrated FLLs are provided to support the clocking requirements of the WM8958. These can be
       enabled and configured independently according to the available reference clocks and the application
       requirements. The reference clock may be a high frequency (eg. 12.288MHz) or low frequency (eg.
       32.768kHz).
       The FLL is tolerant of jitter and may be used to generate a stable AIF clock from a less stable input
       reference. The FLL characteristics are summarised in “Electrical Characteristics”. Note that the FLL
       can be used to generate a free-running clock in the absence of an external reference source. This is
       described in the “Free-Running FLL Clock” section below.
       The input reference for FLL1 is selected using FLL1_REFCLK_SRC. The available options are
       MCLK1, MCLK2, BCLK1 or LRCLK1. The input reference for FLL2 is selected using
       FLL2_REFCLK_SRC. The available options are MCLK1, MCLK2, BCLK2 or LRCLK2.
       The FLLs can be bypassed using the FLL1_BYP or FLL2_BYP registers. This allows the BCLKn clock
       to be used as the AIFnCLK reference, without enabling the respective FLL.
       The FLL input reference and bypass configurations are illustrated in Figure 71.
       Figure 71 FLL Input Reference Selection
       The following description is applicable to FLL1 and FLL2. The associated register control fields are
       described in Table 121 for FLL1 and Table 122 for FLL2.
       The FLL control registers are illustrated in Figure 72.
                                                                                    PP, March 2014, Rev 3.5
w
                                                                                                         208


Pre-Production                                                                                                        WM8958
Figure 72 FLL Configuration
                           The FLL is enabled using the FLLn_ENA register bit (where n = 1 for FLL1 and n = 2 for FLL2). Note
                           that the other FLL registers should be configured before enabling the FLL; the FLLn_ENA register bit
                           should be set as the final step of the FLLn enable sequence.
                           When changing FLL settings, it is recommended that the digital circuit be disabled via FLLn_ENA and
                           then re-enabled after the other register settings have been updated. When changing the input
                           reference frequency FREF, it is recommended that the FLL be reset by setting FLLn_ENA to 0.
                           The field FLLn_REFCLK_DIV provides the option to divide the input reference (MCLK, BCLK or
                           LRCLK) by 1, 2, 4 or 8. This field should be set to bring the reference down to 13.5MHz or below. For
                           best performance, it is recommended that the highest possible frequency - within the 13.5MHz limit -
                           should be selected.
                           The FLL output frequency is directly determined from FLLn_FRATIO, FLLn_OUTDIV and the real
                           number represented by N.K.
                           The integer value, N, is held in the FLLn_N register field. The fractional portion, K, is determined by
                           the ratio FLLn_THETA / FLLn_LAMBDA.
                           Note that the FLLn_EFS_ENA register bit must be enabled in fractional mode (ie. whenever
                           FLLn_THETA > 0).
                           The FLL output frequency is generated according to the following equation:
                                       FOUT = (FVCO / FLLn_OUTDIV)
                           The FLL operating frequency, FVCO is set according to the following equation:
                                       FVCO = (FREF x N.K x FLLn_FRATIO)
                           FREF is the input frequency, as determined by FLLn_REFCLK_DIV.
                           FVCO must be in the range 90-100 MHz. Frequencies outside this range cannot be supported.
                           Note that the output frequencies that do not lie within the ranges quoted above cannot be guaranteed
                           across the full range of device operating conditions.
                                                                                                        PP, March 2014, Rev 3.5
w
                                                                                                                              209


WM8958                                                                                       Pre-Production
       In order to follow the above requirements for FVCO, the value of FLLn_OUTDIV should be selected
       according to the desired output FOUT. The divider, FLLn_OUTDIV, must be set so that FVCO is in the
       range 90-100MHz. The available divisions are integers from 4 to 64. Some typical settings of
       FLLn_OUTDIV are noted in Table 119.
               OUTPUT FREQUENCY FOUT                              FLLn_OUTDIV
          1.875 MHz - 2.0833 MHz                      101111 (divide by 48)
          2.8125 MHz - 3.125 MHz                      011111 (divide by 32)
          3.75 MHz - 4.1667 MHz                       010111 (divide by 24)
          5.625 MHz - 6.25 MHz                        001111 (divide by 16)
          11.25 MHz - 12.5 MHz                        000111 (divide by 8)
          18 MHz - 20 MHz                             000100 (divide by 5)
          22.5 MHz - 25 MHz                           000011 (divide by 4)
       Table 119 Selection of FLLn_OUTDIV
       The value of FLLn_FRATIO should be selected as described in Table 120.
             REFERENCE FREQUENCY FREF                             FLLn_FRATIO
          1MHz - 13.5MHz                              0h (divide by 1)
          256kHz - 1MHz                               1h (divide by 2)
          128kHz - 256kHz                             2h (divide by 4)
          64kHz - 128kHz                              3h (divide by 8)
          Less than 64kHz                             4h (divide by 16)
       Table 120 Selection of FLLn_FRATIO
       In order to determine the remaining FLL parameters, the FLL operating frequency, FVCO, must be
       calculated, as given by the following equation:
                  FVCO = (FOUT x FLLn_OUTDIV)
       The value of N.K can then be determined as follows:
                  N.K = FVCO / (FLLn_FRATIO x FREF)
       Note that, in the above equations:
                  FLLn_OUTDIV is the FOUT clock ratio.
                  FREF is the input frequency, after division by FLL_REFCLK_DIV, where applicable.
                  FLLn_FRATIO is the FVCO clock ratio (1, 2, 4, 8 or 16).
       The value of N is held in the FLLn_N register field.
       The value of K is determined by the ratio FLLn_THETA / FLLn_LAMBDA.
       The FLLn_N, FLLn_THETA and FLLn_LAMBDA fields are all coded as integers (LSB = 1).
                                                                                  PP, March 2014, Rev 3.5
w
                                                                                                       210


Pre-Production                                                                                           WM8958
               In Fractional Mode (FLLn_THETA > 0 and FLLn_EFS_ENA = 1), the register fields FLLn_THETA and
               FLLn_LAMBDA can be calculated as follows:
                           Calculate GCD(FLL) using the ‘Greatest Common Denominator’ function:
                           GCD(FLL) = GCD(FLLn_FRATIO x FREF, FVCO)
                           where GCD(x, y) is the greatest common denominator of x and y
                           Next, calculate FLLn_THETA and FLLn_LAMBDA using the following equations:
                           FLLn_THETA = (FVCO - (FLLn_N x FLLn_FRATIO x FREF)) / GCD(FLL)
                           FLLn_LAMBDA = (FLLn_FRATIO x FREF) / GCD(FLL)
               Note that, in Fractional Mode, the values of FLLn_THETA and FLLn_LAMBDA must be co-prime (ie.
               not divisible by any common integer). The calculation above ensures that the values will be co-prime.
               The value of K must be a fraction less than 1 (ie. FLLn_THETA must be less than FLLn_LAMBDA).
               The FLL1 control registers are described in Table 121. The FLL2 control registers are described in
               Table 122. Example settings for a variety of reference frequencies and output frequencies are shown
               in Table 124.
                    REGISTER             BIT          LABEL          DEFAULT                DESCRIPTION
                    ADDRESS
                 R544 (0220h)             0     FLL1_ENA                 0      FLL1 Enable
                 FLL1 Control (1)                                               0 = Disabled
                                                                                1 = Enabled
                                                                                This should be set as the final step of
                                                                                the FLL1 enable sequence, ie. after
                                                                                the other FLL registers have been
                                                                                configured.
                 R545 (0221h)           13:8    FLL1_OUTDIV           000000    FLL1 FOUT clock divider
                 FLL1 Control (2)               [5:0]                           000000 = Reserved
                                                                                000001 = Reserved
                                                                                000010 = Reserved
                                                                                000011 = 4
                                                                                000100 = 5
                                                                                000101 = 6
                                                                                …
                                                                                111110 = 63
                                                                                111111 = 64
                                                                                (FOUT = FVCO / FLL1_OUTDIV)
                                         2:0    FLL1_FRATIO             000     FLL1 FVCO clock divider
                                                [2:0]                           000 = 1
                                                                                001 = 2
                                                                                010 = 4
                                                                                011 = 8
                                                                                1XX = 16
                 R546 (0222h)           15:0    FLL1_THETA             0000h    FLL Fractional multiply for FREF
                 FLL1 Control (3)               [15:0]                          This field sets the numerator
                                                                                (multiply) part of the FLL1_THETA /
                                                                                FLL1_LAMBDA ratio.
                                                                                Coded as LSB = 1.
                 R547 (0223h)           14:5    FLL1_N [9:0]           000h     FLL1 Integer multiply for FREF
                 FLL1 Control (4)                                               (LSB = 1)
                                                                                            PP, March 2014, Rev 3.5
w
                                                                                                                  211


WM8958                                                                          Pre-Production
           REGISTER         BIT         LABEL   DEFAULT              DESCRIPTION
           ADDRESS
         R548 (0224h)       15     FLL1_BYP        0    FLL1 Bypass Select
         FLL1 Control (5)                               0 = Disabled
                                                        1 = Enabled
                                                        When FLL1_BYP is set, the FLL1
                                                        output is derived directly from
                                                        BCLK1. In this case, FLL1 can be
                                                        disabled.
                           4:3     FLL1_REFCLK_   00    FLL1 Clock Reference Divider
                                   DIV [1:0]            00 = MCLK / 1
                                                        01 = MCLK / 2
                                                        10 = MCLK / 4
                                                        11 = MCLK / 8
                                                        MCLK (or other input reference) must
                                                        be divided down to <=13.5MHz.
                                                        For lower power operation, the
                                                        reference clock can be divided down
                                                        further if desired.
                           1:0     FLL1_REFCLK_   00    FLL1 Clock source
                                   SRC [1:0]            00 = MCLK1
                                                        01 = MCLK2
                                                        10 = LRCLK1
                                                        11 = BCLK1
         R550 (0226h)      15:0    FLL1_LAMBDA   0000h  FLL Fractional multiply for FREF
         FLL1 EFS1                 [15:0]               This field sets the denominator
                                                        (dividing) part of the FLL1_THETA /
                                                        FLL1_LAMBDA ratio.
                                                        Coded as LSB = 1.
         R551 (0227h)      2:1                    11    Reserved - Do not change
         FLL1 EFS2           0     FLL1_EFS_ENA    0    FLL Fractional Mode EFS enable
                                                        0 = Integer Mode
                                                        1 = Fractional Mode
                                                        This bit should be set to 1 when
                                                        FLL1_THETA > 0.
       Table 121 FLL1 Register Map
           REGISTER         BIT         LABEL   DEFAULT              DESCRIPTION
           ADDRESS
         R576 (0240h)        0     FLL2_ENA        0    FLL2 Enable
         FLL2 Control (1)                               0 = Disabled
                                                        1 = Enabled
                                                        This should be set as the final step of
                                                        the FLL2 enable sequence, ie. after
                                                        the other FLL registers have been
                                                        configured.
                                                                     PP, March 2014, Rev 3.5
w
                                                                                          212


Pre-Production                                                                     WM8958
                 REGISTER        BIT       LABEL  DEFAULT              DESCRIPTION
                 ADDRESS
               R577 (0241h)     13:8 FLL2_OUTDIV   000000 FLL2 FOUT clock divider
               FLL2 Control (2)      [5:0]                000000 = Reserved
                                                          000001 = Reserved
                                                          000010 = Reserved
                                                          000011 = 4
                                                          000100 = 5
                                                          000101 = 6
                                                          …
                                                          111110 = 63
                                                          111111 = 64
                                                          (FOUT = FVCO / FLL2_OUTDIV)
                                2:0  FLL2_FRATIO     000  FLL2 FVCO clock divider
                                     [2:0]                000 = 1
                                                          001 = 2
                                                          010 = 4
                                                          011 = 8
                                                          1XX = 16
               R578 (0242h)     15:0 FLL2_THETA     0000h FLL Fractional multiply for FREF
               FLL2 Control (3)      [15:0]               This field sets the numerator
                                                          (multiply) part of the FLL2_THETA /
                                                          FLL2_LAMBDA ratio.
                                                          Coded as LSB = 1.
               R579 (0243h)     14:5 FLL2_N [9:0]   000h  FLL2 Integer multiply for FREF
               FLL2 Control (4)                           (LSB = 1)
               R580 (0244h)      15  FLL2_BYP         0   FLL2 Bypass Select
               FLL2 Control (5)                           0 = Disabled
                                                          1 = Enabled
                                                          When FLL2_BYP is set, the FLL2
                                                          output is derived directly from
                                                          BCLK2. In this case, FLL2 can be
                                                          disabled.
                                4:3  FLL2_REFCLK_    00   FLL2 Clock Reference Divider
                                     DIV [1:0]            00 = MCLK / 1
                                                          01 = MCLK / 2
                                                          10 = MCLK / 4
                                                          11 = MCLK / 8
                                                          MCLK (or other input reference) must
                                                          be divided down to <=13.5MHz.
                                                          For lower power operation, the
                                                          reference clock can be divided down
                                                          further if desired.
                                1:0  FLL2_REFCLK_    00   FLL2 Clock source
                                     SRC [1:0]            00 = MCLK1
                                                          01 = MCLK2
                                                          10 = LRCLK2
                                                          11 = BCLK2
               R582 (0246h)     15:0 FLL2_LAMBDA    0000h FLL Fractional multiply for FREF
               FLL2 EFS1             [15:0]               This field sets the denominator
                                                          (dividing) part of the FLL2_THETA /
                                                          FLL2_LAMBDA ratio.
                                                          Coded as LSB = 1.
               R583 (0247h)     2:1                   11  Reserved - Do not change
                                                                       PP, March 2014, Rev 3.5
w
                                                                                           213


WM8958                                                                        Pre-Production
           REGISTER        BIT         LABEL    DEFAULT             DESCRIPTION
           ADDRESS
         FLL2 EFS2          0      FLL2_EFS_ENA    0    FLL Fractional Mode EFS enable
                                                        0 = Integer Mode
                                                        1 = Fractional Mode
                                                        This bit should be set to 1 when
                                                        FLL2_THETA > 0.
       Table 122 FLL2 Register Map
                                                                    PP, March 2014, Rev 3.5
w
                                                                                         214


Pre-Production                                                                                                WM8958
               FREE-RUNNING FLL CLOCK
               The FLL can generate a clock signal even when no external reference is available. However, it should
               be noted that the accuracy of this clock is reduced, and a reference source should always be used
               where possible. The free-running FLL modes are not sufficiently accurate for hi-fi ADC or DAC
               operations, but are suitable for clocking most other functions, including the Write Sequencer, Charge
               Pump, DC Servo and Class D loudspeaker driver. The free-running FLL operation is ideal for clocking
               the accessory detection function during low-power standby operating conditions (see “External
               Accessory Detection”).
               If an accurate reference clock is initially available, then the FLL should be configured as described
               above. The FLL will continue to generate a stable output clock after the reference input is stopped or
               disconnected.
               If no reference clock is available at the time of starting up the FLL, then an internal clock frequency of
               approximately 12MHz can be generated by implementing the following sequence:
                          Enable the FLL Analogue Oscillator (FLLn_OSC_ENA = 1)
                          Set the FOUT clock divider to divide by 8 (FLLn_OUTDIV = 000111)
                          Configure the oscillator frequency by setting FLLn_FRC_NCO = 1 and
                           FLLn_FRC_NCO_VAL = 19h
               Note that the free-running FLL mode is not suitable for hi-fi CODEC applications. In the absence of
               any reference clock, the FLL output is subject to a very wide tolerance; see “Electrical Characteristics”
               for details of the FLL accuracy.
               Note that the free-running FLL clock is selected as SYSCLK using the registers noted in Figure 68.
               The free-running FLL clock may be used to support analogue functions, for which the digital audio
               interface is not used, and there is no applicable Sample Rate (fs). When SYSCLK is required for
               circuits such the Class D, DC Servo, Control Write Sequencer or Charge Pump, then valid Sample
               Rate register settings are still required, even though the digital audio interface is not active.
               For correct functionality when SYSCLK_SRC = 0, valid settings are required for AIF1_SR and
               AIF1CLK_RATE. In the case where SYSCLK_SRC = 1, then valid settings are required for AIF2_SR
               and AIF2CLK_RATE.
               The control registers applicable to FLL free-running modes are described in Table 123.
                                                                                                PP, March 2014, Rev 3.5
w
                                                                                                                     215


WM8958                                                                                              Pre-Production
            REGISTER             BIT            LABEL         DEFAULT                 DESCRIPTION
             ADDRESS
         R544 (0220h)             1       FLL1_OSC_ENA            0        FLL1 Oscillator enable
         FLL1 Control (1)                                                  0 = Disabled
                                                                           1 = Enabled
                                                                           (Note that this field is required for
                                                                           free-running FLL1 modes only)
         R548 (0224h)           12:7      FLL1_FRC_NCO           19h       FLL1 Forced oscillator value
         FLL1 Control (5)                 _VAL [5:0]                       Valid range is 000000 to 111111
                                                                           0x19h (011001) = 12MHz approx
                                                                           (Note that this field is required for
                                                                           free-running FLL modes only)
                                  6       FLL1_FRC_NCO            0        FLL1 Forced control select
                                                                           0 = Normal
                                                                           1 = FLL1 oscillator controlled by
                                                                           FLL1_FRC_NCO_VAL
                                                                           (Note that this field is required for
                                                                           free-running FLL modes only)
         R576 (0240h)             1       FLL2_OSC_ENA            0        FLL2 Oscillator enable
         FLL2 Control (1)                                                  0 = Disabled
                                                                           1 = Enabled
                                                                           (Note that this field is required for
                                                                           free-running FLL2 modes only)
         R580 (0244h)           12:7      FLL2_FRC_NCO           19h       FLL2 Forced oscillator value
         FLL2 Control (5)                 _VAL [5:0]                       Valid range is 000000 to 111111
                                                                           0x19h (011001) = 12MHz approx
                                                                           (Note that this field is required for
                                                                           free-running FLL modes only)
                                  6       FLL2_FRC_NCO            0        FLL2 Forced control select
                                                                           0 = Normal
                                                                           1 = FLL2 oscillator controlled by
                                                                           FLL2_FRC_NCO_VAL
                                                                           (Note that this field is required for
                                                                           free-running FLL modes only)
       Table 123 FLL Free-Running Mode
       GPIO OUTPUTS FROM FLL
       For each FLL, the WM8958 has an internal signal which indicates whether the FLL Lock has been
       achieved. The FLL Lock status is an input to the Interrupt control circuit and can be used to trigger an
       Interrupt event - see “Interrupts”.
       The FLL Lock signal can be output directly on a GPIO pin as an external indication of FLL Lock. See
       “General Purpose Input/Output” for details of how to configure a GPIO pin to output the FLL Lock
       signal.
       The FLL Clock can be output directly on a GPIO pin as a clock signal for other circuits. Note that the
       FLL Clock may be output even if the FLL is not selected as the WM8958 SYSCLK source. The FLL
       clocking configuration is illustrated in Figure 71. See “General Purpose Input/Output” for details of how
       to configure a GPIO pin to output the FLL Clock.
                                                                                       PP, March 2014, Rev 3.5
w
                                                                                                               216


Pre-Production                                                                                      WM8958
               EXAMPLE FLL CALCULATION
               The following example illustrates how to derive the FLL1 registers to generate 12.288 MHz output
               (FOUT) from a 12.000 MHz reference clock (FREF):
                         Set FLL1_REFCLK_DIV in order to generate FREF <=13.5MHz:
                          FLL1_REFCLK_DIV = 00 (divide by 1)
                         Set FLL1_OUTDIV for the required output frequency as shown in Table 119:-
                          FOUT = 12.288 MHz, therefore FLL1_OUTDIV = 7h (divide by 8)
                         Set FLL1_FRATIO for the given reference frequency as shown in Table 120:
                          FREF = 12MHz, therefore FLL1_FRATIO = 0h (divide by 1)
                         Calculate FVCO as given by FVCO = FOUT x FLL1_OUTDIV:-
                          FVCO = 12.288 x 8 = 98.304MHz
                         Calculate N.K as given by N.K = FVCO / (FLL1_FRATIO x FREF):
                          N.K = 98.304 / (1 x 12) = 8.192
                         Set FLL1_EFS_ENA according to whether N.K is an integer.
                          N.K has a fractional part, therefore FLL1_EFS_ENA = 1
                         Determine FLL1_N from the integer portion of N.K:-
                          FLL_N = 8.
                         Determine GCD(FLL), as given by GCD(FLL) = GCD(FLL1_FRATIO x FREF, FVCO):
                          GCD(FLL) = GCD(1 x 12000000, 98304000) = 96000
                         Determine FLL1_THETA, as given by
                          FLL1_THETA = (FVCO - (FLL1_N x FLL1_FRATIO x FREF)) / GCD(FLL):
                          FLL1_THETA = (98304000 - (8 x 1 x 12000000)) / 96000
                          FLL1_THETA = 24 (0018h)
                         Determine FLL_LAMBDA, as given by
                          FLL1_LAMBDA = (FLL1_FRATIO x FREF) / GCD(FLL):
                          FLL1_LAMBDA = (1 x 12000000) / 96000
                          FLL1_LAMBDA = 125 (007Dh)
                                                                                        PP, March 2014, Rev 3.5
w
                                                                                                           217


WM8958                                                                                                       Pre-Production
                              EXAMPLE FLL SETTINGS
                              Table 124 provides example FLL settings for generating common SYSCLK frequencies from a variety
                              of low and high frequency reference inputs.
    FSOURCE      FOUT (MHz)      FREF       N.K    FRATIO     FVCO (MHz)  OUTDIV      FLLn_N   FLLn_     FLLn_       FLLn_
                               Divider                                                        EFS_ENA    THETA     LAMBDA
 32.000 kHz       12.288           1        192      16         98.304       8         0C0h      0
 32.000 kHz       11.2896          1       176.4     16        90.3168       8         0B0h      1       0002h       0005h
 32.768 kHz       12.288           1       187.5     16         98.304       8         0BBh      1       0001h       0002h
 32.768 kHz       11.2896          1     172.2656    16        90.3168       8         0ACh      1       0011h       0040h
 44.1 kHz         11.2896          1        128      16        90.3168       8         080h      0
 48 kHz           12.288           1        128      16         98.304       8         080h      0
 128 kHz          2.048            1         96       8         98.304      48         060h      0
 128 kHz          12.288           1         96       8         98.304       8         060h      0
 512 kHz          2.048            1         96       2         98.304      48         060h      0
 512 kHz          12.288           1         96       2         98.304       8         060h      0
 1.4112 MHz       11.2896          1         64       1        90.3168       8         040h      0
 2.8224 MHz       11.2896          1         32       1        90.3168       8         020h      0
 1.536 MHz        12.288           1         64       1         98.304       8         040h      0
 3.072 MHz        12.288           1         32       1         98.304       8         020h      0
 11.2896          12.288           1      8.7075      1         98.304       8         008h      1       0068h       0093h
 12.000 MHz       12.288           1       8.192      1         98.304       8         008h      1       0018h       007Dh
 12.000 MHz       11.2896          1      7.5264      1        90.3168       8         007h      1       0149h       0271h
 12.288 MHz       12.288           1          8       1         98.304       8         008h      0
 12.288 MHz       11.2896          1        7.35      1        90.3168       8         007h      1       0007h       0014h
 13.000 MHz       12.288           1      7.5618      1         98.304       8         007h      1       0391h       0659h
 13.000 MHz       11.2896          1      6.9474      1        90.3168       8         006h      1       1E12h      1FBDh
 19.200 MHz       12.288           2       10.24      1         98.304       8         00Ah      1       0006h       0019h
 19.200 MHz       11.2896          2       9.408      1        90.3168       8         009h      1       0033h       007Dh
 24 MHz           12.288           2       8.192      1         98.304       8         008h      1       0018h       007Dh
 24 MHz           11.2896          2      7.5264      1        90.3168       8         007h      1       0149h       0271h
 26 MHz           12.288           2      7.5618      1         98.304       8         007h      1       0391h       0659h
 26 MHz           11.2896          2      6.9474      1        90.3168       8         006h      1       1E12h      1FBDh
 27 MHz           12.288           2      7.2818      1         98.304       8         007h      1       013Dh       0465h
 27 MHz           11.2896          2      6.6901      1        90.3168       8         006h      1       050Eh       0753h
 FOUT = (FSOURCE / FREF Divider) * N.K * FRATIO / OUTDIV
 The values of N and K are contained in the FLLn_N, FLLn_THETA and FLLn_LAMBDA registers as shown above.
 See Table 121 and Table 122 for the coding of the FLLn_REFCLK_DIV, FLLn_FRATIO and FLLn_OUTDIV registers.
Table 124 Example FLL Settings
                                                                                                    PP, March 2014, Rev 3.5
w
                                                                                                                        218


Pre-Production                                                                                             WM8958
SAMPLE RATE CONVERSION
               The WM8958 supports two main digital audio interfaces, AIF1 and AIF2. These interfaces are
               configured independently and may operate entirely asynchronously to each other. The WM8958
               performs stereo full-duplex sample rate conversion between the audio interfaces, allowing digital
               audio to be routed between the interfaces, and allowing asynchronous audio data to be mixed
               together.
               The Sample Rate Converters (SRCs) are configured automatically within the WM8958, and no user
               settings are required. The SRCs are enabled automatically when required and are disabled at other
               times. Synchronisation between the audio interfaces is not instantaneous when the clocking or sample
               rate configurations are updated; the lock status of the SRCs is signalled via the GPIO or Interrupt
               circuits, as described in “General Purpose Input/Output” and “Interrupts”.
               Separate clocks can be used for AIF1 and AIF2, allowing asynchronous operation on these interfaces.
               The digital mixing core is clocked by SYSCLK, which is linked to either AIF1CLK or AIF2CLK, as
               described in “Clocking and Sample Rates”. The digital mixing core is, therefore, always synchronised
               to AIF1, or to AIF2, or to both interfaces at once.
               SAMPLE RATE CONVERTER 1 (SRC1)
               SRC1 performs sample rate conversion of digital audio data input to the WM8958. Sample Rate
               Conversion is required when digital audio data is received on an audio interface that is not
               synchronised to the digital mixing core.
               SRC1 is automatically configured on AIF1 or AIF2, depending on the selected Clocking and Sample
               Rate configuration. Note that SRC1 cannot convert input data on AIF1 and AIF2 simultaneously.
               Sample Rate conversion on AIF1 is only supported on TDM Timeslot 0.
               The SRC1 Lock status indicates when audio data can be received on the interface channel that is not
               synchronised to the digital mixing core. No audio will be present on this signal path until SRC1 Lock is
               achieved.
               SAMPLE RATE CONVERTER 2 (SRC2)
               SRC2 performs sample rate conversion of digital audio data output from the WM8958. Sample Rate
               Conversion is required when digital audio data is transmitted on an audio interface that is not
               synchronised to the digital mixing core.
               SRC2 is automatically configured on AIF1 or AIF2, depending on the selected Clocking and Sample
               Rate configuration. Note that SRC2 cannot convert output data on AIF1 and AIF2 simultaneously.
               Sample Rate conversion on AIF1 is only supported on TDM Timeslot 0.
               The SRC2 Lock status indicates when audio data can be transmitted on the interface channel that is
               not synchronised to the digital mixing core. No audio will be present on this signal path until SRC2
               Lock is achieved.
               SAMPLE RATE CONVERTER RESTRICTIONS
               The following restrictions apply to the configuration of the WM8958 Sample Rate Converters.
               No SRC on AIF1 Timeslot 1. Sample Rate Conversion on audio interface AIF1 is not supported on
               the TDM Timeslot 1. Therefore, it is not possible to route digital audio between AIF1 Timeslot 1 and
               AIF2, or to mix together audio from these interface paths. Note that this only applies when the SRC is
               applied to AIF1.
               Maximum of three sample rates in the system. The audio sample rate of AIF1 input and AIF1
               output may be different to each other. The audio sample rate of AIF2 input and AIF2 output may be
               different to each other. However, it is not possible to have four different sample rates operating
               simultaneously, as this would require sample rate conversion in too many paths. A maximum of three
               different sample rates can be supported in the system.
                                                                                             PP, March 2014, Rev 3.5
w
                                                                                                                  219


WM8958                                                                                       Pre-Production
       No SRC capability when using 88.2kHz or 96kHz AIF input (DAC playback). If either interface is
       configured for 88.2kHz or 96kHz sample rate, then the digital mixing core must also be configured for
       this sample rate. Sample Rate Conversion cannot be supported in this mode, therefore AIF output is
       not supported at any sample rate under these conditions.
       Restricted Sample Rate options when AIF1 and AIF2 are synchronised. When the same clock
       source is used for AIF1CLK and AIF2CLK, and mixed sample rates are selected on both interfaces,
       then the DAC sample rate of one interface must be the same as the ADC sample rate of the other.
                If AIF1CLK_SRC = AIF2CLK_SRC
                And AIF1DAC_DIV ≠ AIF1ADC_DIV
                And AIF2DAC_DIV ≠ AIF2ADC_DIV
                Then the DAC sample rate of one interface must be the same as the ADC sample rate of
                 the other.
       Restricted Sample Rate options when AIF1 and AIF2 are not synchronised. When a different
       clock source is used for AIF1CLK and AIF2CLK, then the AIF to which the SYSCLK is synchronised
       cannot be mixed sample rates.
                If AIF1CLK_SRC ≠ AIF2CLK_SRC
                And SYSCLK_SRC =0
                Then AIF1DAC_DIV and AIF1ADC_DIV must be set to 000
                If AIF1CLK_SRC ≠ AIF2CLK_SRC
                And SYSCLK_SRC =1
                Then AIF2DAC_DIV and AIF2ADC_DIV must be set to 000
                                                                                  PP, March 2014, Rev 3.5
w
                                                                                                       220


Pre-Production                                                                                           WM8958
               SAMPLE RATE CONVERTER CONFIGURATION ERROR INDICATION
               The WM8958 verifies the register settings relating to Clocking, Sample Rates and Sample Rate
               Conversion. If an invalid configuration is attempted, then the SR_ERROR register will indicate the
               error by showing a non-zero value. This read-only field may be checked to confirm that the WM8958
               can support the selected Clocking and Sample Rate settings.
                  REGISTER        BIT       LABEL        DEFAULT                     DESCRIPTION
                  ADDRESS
                R530 (0212h)      3:0    SR_ERROR           0000      Sample Rate Configuration status
                Rate Status              [3:0]                        Indicates an error with the register settings
                                                                      related to sample rate configuration
                                                                      0000 = No errors
                                                                      0001 = Invalid sample rate
                                                                      0010 = Invalid AIF divide
                                                                      0011 = ADC and DAC divides both set in an
                                                                      interface
                                                                      0100 = Invalid combination of AIF divides
                                                                      and sample-rate
                                                                      0101 = Invalid set of enables for 96kHz
                                                                      mode
                                                                      0110 = Invalid SYSCLK rate (derived from
                                                                      AIF1CLK_RATE or AIF2CLK_RATE)
                                                                      0111 = Mixed ADC and DAC rates in
                                                                      SYSCLK AIF when AIFs are asynchronous
                                                                      1000 = Invalid combination of sample rates
                                                                      when both AIFs are from the same clock
                                                                      source
                                                                      1001 = Invalid combination of mixed
                                                                      ADC/DAC AIFs when both from the same
                                                                      clock source
                                                                      1010 = AIF1DAC2 (Timeslot 1) ports enabled
                                                                      when SRCs connected to AIF1
               Table 125 Sample Rate Converter Configuration Status
                                                                                            PP, March 2014, Rev 3.5
w
                                                                                                                    221


WM8958                                                                                                                    Pre-Production
CONTROL INTERFACE
                            The WM8958 is controlled by writing to registers through a 2-wire serial control interface. Readback is
                            available for all registers, including Chip ID and power management status.
                            Note that the Control Interface function can be supported with or without system clocking. Where
                            possible, the register map access is synchronised with SYSCLK in order to ensure predictable
                            operation of cross-domain functions. See “Clocking and Sample Rates” for further details of Control
                            Interface clocking.
                            The WM8958 is a slave device on the control interface; SCLK is a clock input, while SDAT is a bi-
                            directional data pin. To allow arbitration of multiple slaves (and/or multiple masters) on the same
                            interface, the WM8958 transmits logic 1 by tri-stating the SDAT pin, rather than pulling it high. An
                            external pull-up resistor is required to pull the SDAT line high so that the logic 1 can be recognised by
                            the master.
                            In order to allow many devices to share a single 2-wire control bus, every device on the bus has a
                            unique 8-bit device ID (this is not the same as the address of each register in the WM8958). The
                            device ID is selectable on the WM8958, using the ADDR pin as shown in Table 126. The LSB of the
                            Device ID is the Read/Write bit; this bit is set to logic 1 for “Read” and logic 0 for “Write”.
                            An internal pull-down resistor is enabled by default on the ADDR pin; this can be configured using the
                            ADDR_PD register bit described in Table 128.
                                         ADDR                            DEVICE ID
                                          Low                        0011 0100 (34h)
                                         High                        0011 0110 (36h)
                            Table 126 Control Interface Device ID Selection
                            The WM8958 operates as a slave device only. The controller indicates the start of data transfer with a
                            high to low transition on SDAT while SCLK remains high. This indicates that a device ID, register
                            address and data will follow. The WM8958 responds to the start condition and shifts in the next eight
                            bits on SDAT (8-bit device ID, including Read/Write bit, MSB first). If the device ID received matches
                            the device ID of the WM8958, then the WM8958 responds by pulling SDAT low on the next clock
                            pulse (ACK). If the device ID is not recognised or the R/W bit is set incorrectly, the WM8958 returns to
                            the idle condition and waits for a new start condition and valid address.
                            If the device ID matches the device ID of the WM8958, the data transfer continues as described
                            below. The controller indicates the end of data transfer with a low to high transition on SDAT while
                            SCLK remains high. After receiving a complete address and data sequence the WM8958 returns to
                            the idle state and waits for another start condition. If a start or stop condition is detected out of
                            sequence at any point during data transfer (i.e. SDAT changes while SCLK is high), the device returns
                            to the idle condition.
                            The WM8958 supports the following read and write operations:
                                      Single write
                                      Single read
                                      Multiple write using auto-increment
                                      Multiple read using auto-increment
                            The sequence of signals associated with a single register write operation is illustrated in Figure 73.
Figure 73 Control Interface 2-wire (I2C) Register Write
                                                                                                              PP, March 2014, Rev 3.5
w
                                                                                                                                    222


Pre-Production                                                                                                         WM8958
                            The sequence of signals associated with a single register read operation is illustrated in Figure 74.
Figure 74 Control Interface 2-wire (I2C) Register Read
                            The Control Interface also supports other register operations, as listed above. The interface protocol
                            for these operations is summarised below. The terminology used in the following figures is detailed in
                            Table 127.
                            Note that, for multiple write and multiple read operations, the auto-increment option must be enabled.
                            This feature is enabled by default, as noted in Table 128.
                                   TERMINOLOGY                                  DESCRIPTION
                                          S                                     Start Condition
                                          Sr                                    Repeated start
                                          A                                Acknowledge (SDA Low)
                                          ¯¯
                                          A                              Not Acknowledge (SDA High)
                                          P                                     Stop Condition
                                         R/W̄¯                   ReadNotWrite                     0 = Write
                                                                                                  1 = Read
                                     [White field]                  Data flow from bus master to WM8958
                                      [Grey field]                  Data flow from WM8958 to bus master
                            Table 127 Control Interface Terminology
Figure 75 Single Register Write to Specified Address
Figure 76 Single Register Read from Specified Address
                                                                                                           PP, March 2014, Rev 3.5
w
                                                                                                                                 223


WM8958                                                                                                             Pre-Production
Figure 77 Multiple Register Write to Specified Address using Auto-increment
Figure 78 Multiple Register Read from Specified Address using Auto-increment
Figure 79 Multiple Register Read from Last Address using Auto-increment
                            Multiple Write and Multiple Read operations enable the host processor to access sequential blocks of
                            the data in the WM8958 register map faster than is possible with single register operations. The auto-
                            increment option is enabled when the AUTO_INC register bit is set. This bit is defined in Table 128.
                            Auto-increment is enabled by default.
                                 REGISTER           BIT           LABEL        DEFAULT                  DESCRIPTION
                                 ADDRESS
                              R257 (0101h)           2      AUTO_INC               1         Enables address auto-increment
                              Control Interface                                              0 = Disabled
                                                                                             1 = Enabled
                              R1825 (0721h)          8      ADDR_PD                1         ADDR Pull-down enable
                              Pull Control (2)                                               0 = Disabled
                                                                                             1 = Enabled
                            Table 128 Control Interface Configuration
                                                                                                        PP, March 2014, Rev 3.5
w
                                                                                                                              224


Pre-Production                                                                                          WM8958
CONTROL WRITE SEQUENCER
               The Control Write Sequencer is a programmable unit that forms part of the WM8958 control interface
               logic. It provides the ability to perform a sequence of register write operations with the minimum of
               demands on the host processor - the sequence may be initiated by a single operation from the host
               processor and then left to execute independently.
               Default sequences for Start-Up of each output driver and Shut-Down are provided (see “Default
               Sequences” section). It is recommended that these default sequences are used unless changes
               become necessary.
               When a sequence is initiated, the sequencer performs a series of pre-defined register writes. The host
               processor informs the sequencer of the start index of the required sequence within the sequencer’s
               memory. At each step of the sequence, the contents of the selected register fields are read from the
               sequencer’s memory and copied into the WM8958 control registers. This continues sequentially
               through the sequencer’s memory until an “End of Sequence” bit is encountered; at this point, the
               sequencer stops and an Interrupt status flag is asserted. For cases where the timing of the write
               sequence is important, a programmable delay can be set for specific steps within the sequence.
               Note that the Control Write Sequencer’s internal clock is derived from the internal clock SYS_CLK
               which must be enabled as described in “Clocking and Sample Rates”. The clock division from
               SYS_CLK is handled transparently by the WM8958 without user intervention, provided that SYS_CLK
               is configured as specified in “Clocking and Sample Rates”.
               INITIATING A SEQUENCE
               The Register fields associated with running the Control Write Sequencer are described in Table 129.
               Note that the operation of the Control Write Sequencer also requires the internal clock SYS_CLK to
               be configured as described in “Clocking and Sample Rates”.
               The Write Sequencer is enabled by setting the WSEQ_ENA bit. The start index of the required
               sequence must be written to the WSEQ_START_INDEX field.
               The Write Sequencer stores up to 128 register write commands. These are defined in Registers
               R12288 to R12799. There are 4 registers used to define each of the 128 possible commands. The
               value of WSEQ_START_INDEX selects the registers applicable to the first write command in the
               selected sequence.
               Setting the WSEQ_START bit initiates the sequencer at the given start index. The Write Sequencer
               can be interrupted by writing a logic 1 to the WSEQ_ABORT bit.
               The current status of the Write Sequencer can be read using two further register fields - when the
               WSEQ_BUSY bit is asserted, this indicates that the Write Sequencer is busy. Note that, whilst the
               Control Write Sequencer is running a sequence (indicated by the WSEQ_BUSY bit), normal read/write
               operations to the Control Registers cannot be supported. The index of the current step in the Write
               Sequencer can be read from the WSEQ_CURRENT_INDEX field; this is an indicator of the
               sequencer’s progress. On completion of a sequence, this field holds the index of the last step within
               the last commanded sequence.
               When the Write Sequencer reaches the end of a sequence, it asserts the WSEQ_DONE_EINT flag in
               Register R1841 (see Table 90). This flag can be used to generate an Interrupt Event on completion of
               the sequence. Note that the WSEQ_DONE_EINT flag is asserted to indicate that the WSEQ is NOT
               Busy.
                                                                                             PP, March 2014, Rev 3.5
w
                                                                                                                 225


WM8958                                                                                             Pre-Production
           REGISTER         BIT           LABEL            DEFAULT                    DESCRIPTION
            ADDRESS
         R272 (0110h)        15      WSEQ_ENA                   0        Write Sequencer Enable.
         Write                                                           0 = Disabled
         Sequencer                                                       1 = Enabled
         Ctrl (1)
                              9      WSEQ_ABORT                 0        Writing a 1 to this bit aborts the
                                                                         current sequence and returns control
                                                                         of the device back to the serial
                                                                         control interface.
                              8      WSEQ_START                 0        Writing a 1 to this bit starts the write
                                                                         sequencer at the index location
                                                                         selected by WSEQ_START_INDEX.
                                                                         The sequence continues until it
                                                                         reaches an “End of sequence” flag.
                                                                         At the end of the sequence, this bit
                                                                         will be reset by the Write Sequencer.
                            6:0      WSEQ_START_           000_0000      Sequence Start Index. This field
                                     INDEX [6:0]                         determines the memory location of
                                                                         the first command in the selected
                                                                         sequence. There are 127 Write
                                                                         Sequencer RAM addresses:
                                                                         00h = WSEQ_ADDR0 (R12288)
                                                                         01h = WSEQ_ADDR1 (R12292)
                                                                         02h = WSEQ_ADDR2 (R12296)
                                                                         ….
                                                                         7Fh = WSEQ_ADDR127 (R12796)
         R273 (0111h)        8       WSEQ_BUSY                  0        Sequencer Busy flag (Read Only).
         Write                       (read only)                         0 = Sequencer idle
         Sequencer                                                       1 = Sequencer busy
         Ctrl (2)
                                                                         Note: it is not possible to write to
                                                                         control registers via the control
                                                                         interface while the Sequencer is
                                                                         Busy.
                            6:0      WSEQ_CURRE            000_0000      Sequence Current Index. This
                                     NT_INDEX [6:0]                      indicates the memory location of the
                                     (read only)                         most recently accessed command in
                                                                         the write sequencer memory.
                                                                         Coding is the same as
                                                                         WSEQ_START_INDEX.
       Table 129 Write Sequencer Control - Initiating a Sequence
       PROGRAMMING A SEQUENCE
       A sequence consists of write operations to data bits (or groups of bits) within the control registers.
       Each write operation is defined by a block of 4 registers, which contain 6 fields as described in this
       section.
       The block of 4 registers is the same for up to 128 steps held in the sequencer memory. Multiple
       sequences can be held in the memory at the same time; each sequence occupies its own range within
       the 128 available register blocks.
       The following 6 fields are replicated 128 times - one for each of the sequencer’s 128 steps. In the
       following descriptions, the term ‘n’ is used to denote the step number, from 0 to 127.
       WSEQ_ADDRn is a 14-bit field containing the Control Register Address in which the data should be
       written.
       WSEQ_DATAn is an 8-bit field which contains the data to be written to the selected Control Register.
       The WSEQ_DATA_WIDTHn field determines how many of these bits are written to the selected
       register; the most significant bits (above the number indicated by WSEQ_DATA_WIDTHn) are
       ignored.
                                                                                       PP, March 2014, Rev 3.5
w
                                                                                                               226


Pre-Production                                                                                               WM8958
               WSEQ_DATA_STARTn is a 4-bit field which identifies the LSB position within the selected Control
               Register to which the data should be written. For example, setting WSEQ_DATA_STARTn = 0100 will
               select bit 4 as the LSB position; in this case, 4-bit data would be written to bits 7:4.
               WSEQ_DATA_WIDTHn is a 3-bit field which identifies the width of the data block to be written. This
               enables selected portions of a Control Register to be updated without any concern for other bits within
               the same register, eliminating the need for read-modify-write procedures. Values of 0 to 7 correspond
               to data widths of 1 to 8 respectively. For example, setting WSEQ_DATA_WIDTHn = 010 will cause a
               3-bit data block to be written. Note that the maximum value of this field corresponds to an 8-bit data
               block; writing to register fields greater than 8 bits wide must be performed using two separate
               operations of the Control Write Sequencer.
               WSEQ_DELAYn is a 4-bit field which controls the waiting time between the current step and the next
               step in the sequence i.e. the delay occurs after the write in which it was called. The total delay time
               per step (including execution) is defined below, giving a useful range of execution/delay times from
               562s up to 2.048s per step:
                                      WSEQ_DELAY
                           T = k × (2            + 8)
                           where k = 62.5s (under recommended operating conditions)
               WSEQ_EOSn is a 1-bit field which indicates the End of Sequence. If this bit is set, then the Control
               Write Sequencer will automatically stop after this step has been executed.
               The register definitions for Step 0 are described in Table 130. The equivalent definitions also apply to
               Step 1 through to Step 127, in the subsequent register address locations.
                   REGISTER          BIT         LABEL          DEFAULT                      DESCRIPTION
                   ADDRESS
                 R12288             13:0    WSEQ_ADDR             0000h       Control Register Address to be written to
                 (3000h)                    0 [13:0]                          in this sequence step.
                 Write
                 Sequencer 0
                 R12289              7:0    WSEQ_DATA               00h       Data to be written in this sequence step.
                 (3001h)                    0 [7:0]                           When the data width is less than 8 bits,
                 Write                                                        then one or more of the MSBs of
                 Sequencer 1                                                  WSEQ_DATAn are ignored. It is
                                                                              recommended that unused bits be set to
                                                                              0.
                 R12290             10:8    WSEQ_DATA               000       Width of the data block written in this
                 (3002h)                    _WIDTH0 [2:0]                     sequence step.
                 Write                                                        000 = 1 bit
                 Sequencer 2                                                  001 = 2 bits
                                                                              010 = 3 bits
                                                                              011 = 4 bits
                                                                              100 = 5 bits
                                                                              101 = 6 bits
                                                                              110 = 7 bits
                                                                              111 = 8 bits
                                     3:0    WSEQ_DATA              0000       Bit position of the LSB of the data block
                                            _START0 [3:0]                     written in this sequence step.
                                                                              0000 = Bit 0
                                                                              …
                                                                              1111 = Bit 15
                 R12291               8     WSEQ_EOS0                0        End of Sequence flag. This bit indicates
                 (3003h)                                                      whether the Control Write Sequencer
                 Write                                                        should stop after executing this step.
                 Sequencer 3                                                  0 = Not end of sequence
                                                                              1 = End of sequence (Stop the
                                                                              sequencer after this step).
                                     3:0    WSEQ_DELA              0000       Time delay after executing this step.
                                            Y0 [3:0]                          Total time per step (including execution)
                                                                                             WSEQ_DELAY
                                                                              = 62.5µs × (2             + 8)
               Table 130 Write Sequencer Control - Programming a Sequence
                                                                                                 PP, March 2014, Rev 3.5
w
                                                                                                                      227


WM8958                                                                                             Pre-Production
       Note that a ‘Dummy’ write can be inserted into a control sequence by commanding the sequencer to
       write a value of 0 to bit 0 of Register R255 (00FFh). This is effectively a write to a non-existent register
       location. This can be used in order to create placeholders ready for easy adaptation of a control
       sequence. For example, a sequence could be defined to power-up a mono signal path from DACL to
       headphone, with a ‘dummy’ write included to leave space for easy modification to a stereo signal path
       configuration. Dummy writes can also be used in order to implement additional time delays between
       register writes. Dummy writes are included in both of the Headphone start-up sequences - see Table
       131 and Table 132.
       In summary, the Control Register to be written is set by the WSEQ_ADDRn field. The data bits that
       are written are determined by a combination of WSEQ_DATA_STARTn, WSEQ_DATA_WIDTHn and
       WSEQ_DATAn. This is illustrated below for an example case of writing to the VMID_SEL field within
       Register R1 (0001h).
       In this example, the Start Position is bit 01 (WSEQ_DATA_STARTn = 0001b) and the Data width is 2
       bits (WSEQ_DATA_WIDTHn = 0001b). With these settings, the Control Write Sequencer would
       update the Control Register R1 [2:1] with the contents of WSEQ_DATAn [1:0].
       Figure 80 Control Write Sequencer Example
       DEFAULT SEQUENCES
       When the WM8958 is powered up, a number of Control Write Sequences are available through
       default settings in the sequencer memory locations. The pre-programmed default settings include
       Start-Up and Shut-Down sequences for each of the output drivers. Note that the default sequences do
       not include audio signal path or gain setting configuration; this must be implemented prior to
       scheduling any of the default Start-Up sequences.
       The entire sequencer memory may be programmed to users’ own settings at any time, as described in
       “Programming a Sequence”. Users’ own settings remain in memory regardless of WSEQ_ENA, and
       are not affected by software resets (i.e. writing to Register R0). However, any non-default sequences
       are lost when the device is powered down.
       The following default control sequences are provided:
       1.    Headphone Cold Start-Up - This sequence powers up the headphone driver and charge pump. It
             commands the DC Servo to perform offset correction. It enables the master bias required for
             analogue functions. This sequence is intended for enabling the headphone output after initial
             power-on, when DC offset correction has not previously been run.
                                                                                        PP, March 2014, Rev 3.5
w
                                                                                                              228


Pre-Production                                                                                                      WM8958
                         2.    Headphone Warm Start-Up - This sequence is similar to the Headphone Cold Start-Up, but does
                               not include the DC Servo operation. This sequence is intended for fast enabling of the
                               headphone output when DC offset correction has previously been scheduled and provided the
                               analogue gain settings have not been updated since scheduling the DC offset correction.
                         3.    Speaker Start-Up - This sequence powers up the stereo speaker driver. It also enables the
                               master bias required for analogue functions.
                         4.    Earpiece Start-Up - This sequence powers up the earpiece driver. It also enables the master bias
                               required for analogue functions. The soft-start VMID option is used in order to suppress pops
                               when the driver is enabled. This sequence is intended for enabling the earpiece driver when the
                               master bias has not previously been enabled.
                         5.    Line Output Start-Up - This sequence powers up the line outputs. Active discharge of the line
                               outputs is selected, followed by the soft-start VMID enable, followed by selection of the master
                               bias and un-muting of the line outputs. This sequence is intended for enabling the line drivers
                               when the master bias has not previously been enabled.
                         6.    Speaker and Headphone Fast Shut-Down - This sequence implements a fast shutdown of the
                               speaker and headphone drivers. It also disables the DC Servo and charge pump circuits, and
                               disables the analogue bias circuits using the soft-start (ramp) feature. This sequence is intended
                               as a shut-down sequence when only the speaker or headphone drivers are enabled.
                         7.    Generic Shut-Down - This sequence shuts down all of the WM8958 output drivers, DC Servo,
                               charge pump and analogue bias circuits. It is similar to the Fast Shut-Down sequence, with the
                               additional control of the earpiece and line output drivers. Active discharge of the line outputs is
                               included and all drivers are disabled as part of this sequence.
                         Specific details of each of these sequences is provided below.
                         Headphone Cold Start-Up
                         The Headphone Cold Start-Up sequence is initiated by writing 8100h to Register 272 (0110h). This
                         single operation starts the Control Write Sequencer at Index Address 0 (00h) and executes the
                         sequence defined in Table 131.
                         This sequence takes approximately 296ms to run.
 WSEQ        REGISTER    WIDTH         START        DATA      DELAY      EOS                      DESCRIPTION
 INDEX        ADDRESS
 0 (00h)     R57 (0039h)  5 bits        Bit 2        1Bh        0h        0b        STARTUP_BIAS_ENA = 1
                                                                                    VMID_BUF_ENA = 1
                                                                                    VMID_RAMP[1:0] = 11b
                                                                                    (delay = 0.5625ms)
 1 (01h)      R1 (0001h)  3 bits        Bit 0        03h        9h        0b        BIAS_ENA = 1
                                                                                    VMID_SEL[1:0] = 01b
                                                                                    (delay = 32.5ms)
 2 (02h)     R76 (004Ch)    1 bit       Bit 15       01h        6h        0b        CP_ENA = 1
                                                                                    (delay = 4.5ms)
 3 (03h)     R1 (0001h)   2 bits        Bit 8        03h        0h        0b        HPOUT1R_ENA = 1
                                                                                    HPOUT1L_ENA = 1
                                                                                    (delay = 0.5625ms)
 4 (04h)     R96 (0060h)  5 bits        Bit 1        11h        0h        0b        HPOUT1R_DLY = 1
                                                                                    HPOUT1L_DLY = 1
                                                                                    (delay = 0.5625ms)
 5 (05h)     R84 (0054h)  6 bits        Bit 0        33h        Ch        0b        DCS_ENA_CHAN_0 = 1
                                                                                    DCS_ENA_CHAN_1 = 1
                                                                                    DCS_TRIG_STARTUP_0 = 1
                                                                                    DCS_TRIG_STARTUP_1 = 1
                                                                                    (delay = 256.5ms)
                                                                                                         PP, March 2014, Rev 3.5
w
                                                                                                                              229


WM8958                                                                                                       Pre-Production
  WSEQ      REGISTER     WIDTH        START       DATA      DELAY       EOS                  DESCRIPTION
  INDEX     ADDRESS
  6 (06h)     R255         1 bit       Bit 0       00h        0h         0b    Dummy Write for expansion
             (00FFh)                                                           (delay = 0.5625ms)
  7 (07h)  R96 (0060h)    6 bits       Bit 2       3Bh        0h         1b    HPOUT1R_OUTP = 1
                                                                               HPOUT1R_RMV_SHORT =1
                                                                               HPOUT1_DLY = 1
                                                                               HPOUT1L_OUTP = 1
                                                                               HPOUT1L_RMV_SHORT = 1
                                                                               (delay = 0.5625ms)
Table 131 Headphone Cold Start-Up Default Sequence
                         Headphone Warm Start-Up
                         The Headphone Warm Start-Up sequence can be initiated by writing 8108h to Register 272 (0110h).
                         This single operation starts the Control Write Sequencer at Index Address 8 (08h) and executes the
                         sequence defined in Table 132.
                         This sequence takes approximately 40ms to run.
  WSEQ      REGISTER     WIDTH        START       DATA      DELAY       EOS                  DESCRIPTION
  INDEX     ADDRESS
  8 (08h)  R57 (0039h)    5 bits       Bit 2       1Bh        0h         0b    STARTUP_BIAS_ENA = 1
                                                                               VMID_BUF_ENA = 1
                                                                               VMID_RAMP[1:0] = 11b
                                                                               (delay = 0.5625ms)
  9 (09h)   R1 (0001h)    3 bits       Bit 0       03h        9h         0b    BIAS_ENA = 1
                                                                               VMID_SEL[1:0] = 01b
                                                                               (delay = 32.5ms)
10 (0Ah)   R76 (004Ch)    1 bits       Bit 15      01h        6h         0b    CP_ENA = 1
                                                                               (delay = 4.5ms)
11 (0Bh)    R1 (0001h)    2 bits       Bit 8       03h        0h         0b    HPOUT1R_ENA = 1
                                                                               HPOUT1L_ENA = 1
                                                                               (delay = 0.5625ms)
12 (0Ch)   R96 (0060h)    5 bits       Bit 1       11h        0h         0b    HPOUT1R_DLY = 1
                                                                               HPOUT1L_DLY = 1
                                                                               (delay = 0.5625ms)
13 (0Dh)   R84 (0054h)    2 bits       Bit 0       03h        0h         0b    DCS_ENA_CHAN_0 = 1
                                                                               DCS_ENA_CHAN_1 = 1
                                                                               (delay = 0.5625ms)
14 (0Eh)      R255        1 bits       Bit 0       00h        0h         0b    Dummy Write for expansion
             (00FFh)                                                           (delay = 0.5625ms)
 15 (0Fh)  R96 (0060h)    6 bits       Bit 2       3Bh        0h         1b    HPOUT1R_OUTP = 1
                                                                               HPOUT1R_RMV_SHORT =1
                                                                               HPOUT1_DLY = 1
                                                                               HPOUT1L_OUTP = 1
                                                                               HPOUT1L_RMV_SHORT = 1
                                                                               (delay = 0.5625ms)
Table 132 Headphone Warm Start-Up Default Sequence
                                                                                                   PP, March 2014, Rev 3.5
w
                                                                                                                       230


Pre-Production                                                                                                   WM8958
                           Speaker Start-Up
                           The Speaker Start-Up sequence can be initiated by writing 8110h to Register 272 (0110h). This single
                           operation starts the Control Write Sequencer at Index Address 16 (10h) and executes the sequence
                           defined in Table 133.
                           This sequence takes approximately 34ms to run.
  WSEQ       REGISTER      WIDTH        START      DATA       DELAY     EOS                     DESCRIPTION
  INDEX      ADDRESS
 16 (10h)     R57 (39h)     5 bits       Bit 2       1Bh        0h       0b      STARTUP_BIAS_ENA = 1
                                                                                 VMID_BUF_ENA = 1
                                                                                 VMID_RAMP[1:0] = 11b
                                                                                 (delay = 0.5625ms)
 17 (11h)      R1 (01h)     3 bits       Bit 0       03h        9h       0b      BIAS_ENA = 1
                                                                                 VMID_SEL[1:0] = 01b
                                                                                 (delay = 32.5ms)
 18 (12h)      R1 (01h)     2 bits       Bit 12      03h        0h       1b      SPKOUTL_ENA = 1
                                                                                 SPKOUTR_ENA = 1
                                                                                 (delay = 0.5625ms)
Table 133 Speaker Start-Up Default Sequence
                           Earpiece Start-Up
                           The Earpiece Start-Up sequence can be initiated by writing 8113h to Register 272 (0110h). This single
                           operation starts the Control Write Sequencer at Index Address 19 (13h) and executes the sequence
                           defined in Table 134.
                           This sequence takes approximately 259ms to run.
  WSEQ       REGISTER      WIDTH        START      DATA       DELAY     EOS                     DESCRIPTION
  INDEX      ADDRESS
 19 (13h)     R57 (39h)     6 bits       Bit 1       27h        0h       0b      BIAS_SRC = 1
                                                                                 STARTUP_BIAS_ENA = 1
                                                                                 VMID_BUF_ENA = 1
                                                                                 VMID_RAMP[1:0] = 10b
                                                                                 (delay = 0.5625ms)
 20 (14h)     R56 (38h)      1 bit       Bit 6       01h        0h       0b      HPOUT2_IN_ENA = 1
                                                                                 (delay = 0.5625ms)
 21 (15h)     R31 (1Fh)      1 bit       Bit 5       00h        0h       1b      HPOUT2_MUTE = 0
                                                                                 (delay = 0.5625ms)
 22 (16h)      R1 (01h)      1 bit       Bit 11      01h        0h       0b      HPOUT2_ENA = 1
                                                                                 (delay = 0.5625ms)
 23 (17h)      R1 (01h)     3 bits       Bit 0       03h        Ch       0b      BIAS_ENA = 1
                                                                                 VMID_SEL[1:0] = 01b
                                                                                 (delay = 256.5ms)
 24 (18h)     R57 (39h)      1 bit       Bit 1       00h        0h       0b      BIAS_SRC = 0
                                                                                 (delay = 0.5625ms)
Table 134 Earpiece Start-Up Default Sequence
                                                                                                      PP, March 2014, Rev 3.5
w
                                                                                                                            231


WM8958                                                                                                       Pre-Production
                           Line Output Start-Up
                           The Line Output Start-Up sequence can be initiated by writing 8119h to Register 272 (0110h). This
                           single operation starts the Control Write Sequencer at Index Address 25 (19h) and executes the
                           sequence defined in Table 135.
                           This sequence takes approximately 517ms to run.
  WSEQ      REGISTER        WIDTH      START        DATA     DELAY     EOS                   DESCRIPTION
  INDEX      ADDRESS
 25 (19h)    R56 (38h)      2 bits       Bit 4       03h       0h       0b     LINEOUT2_DISCH = 1
                                                                               LINEOUT1_DISCH = 1
                                                                               (delay = 0.5625ms)
26 (1Ah)     R57 (39h)      6 bits       Bit 1       27h       0h       0b     BIAS_SRC = 1
                                                                               STARTUP_BIAS_ENA = 1
                                                                               VMID_BUF_ENA = 1
                                                                               VMID_RAMP[1:0] = 10b
                                                                               (delay = 0.5625ms)
27 (1Bh)     R56 (38h)       1 bit       Bit 7       01h       0h       0b     LINEOUT_VMID_BUF_ENA = 1
                                                                               (delay = 0.5625ms)
28 (1Ch)      R3 (03h)      4 bits      Bit 10       0Fh       0h       0b     LINEOUT2P_ENA = 1
                                                                               LINEOUT2N_ENA = 1
                                                                               LINEOUT1P_ENA = 1
                                                                               LINEOUT1N_ENA = 1
                                                                               (delay = 0.5625ms)
29 (1Dh)     R56 (38h)      2 bits       Bit 4       00h       0h       0b     LINEOUT2_DISCH = 0
                                                                               LINEOUT1_DISCH = 0
                                                                               (delay = 0.5625ms)
30 (1Eh)      R1 (01h)      3 bits       Bit 0       03h       Dh       0b     BIAS_ENA = 1
                                                                               VMID_SEL = 01b
                                                                               (delay = 512.5ms)
 31 (1Fh)    R57 (39h)       1 bit       Bit 1       00h       0h       0b     BIAS_SRC = 0
                                                                               (delay = 0.5625ms)
 32 (20h)    R30 (1Eh)      2 bits       Bit 5       00h       0h       0b     LINEOUT1P_MUTE = 0
                                                                               LINEOUT1N_MUTE = 0
                                                                               (delay = 0.5625ms)
 33 (21h)    R30 (1Eh)      2 bits       Bit 1       00h       0h       1b     LINEOUT2P_MUTE = 0
                                                                               LINEOUT2N_MUTE = 0
                                                                               (delay = 0.5625ms)
Table 135 Line Output Start-Up Default Sequence
                                                                                                   PP, March 2014, Rev 3.5
w
                                                                                                                        232


Pre-Production                                                                                                  WM8958
                         Speaker and Headphone Fast Shut-Down
                         The Speaker and Headphone Fast Shut-Down sequence can be initiated by writing 8122h to Register
                         272 (0110h). This single operation starts the Control Write Sequencer at Index Address 34 (22h) and
                         executes the sequence defined in Table 136.
                         This sequence takes approximately 37ms to run.
  WSEQ       REGISTER    WIDTH       START       DATA      DELAY       EOS                    DESCRIPTION
  INDEX      ADDRESS
 34 (22h)     R96 (60h)   7 bits      Bit 1        00h        0h        0b      HPOUT1R_DLY = 0
                                                                                HPOUT1R_OUTP = 0
                                                                                HPOUT1R_RMV_SHORT = 0
                                                                                HPOUT1L_DLY = 0
                                                                                HPOUT1L_OUTP = 0
                                                                                HPOUT1L_RMV_SHORT = 0
                                                                                (delay = 0.5625ms)
 35 (23h)     R84 (54h)   2 bits      Bit 0        00h        0h        0b      DCS_ENA_CHAN_0 = 0
                                                                                DCS_ENA_CHAN_1 = 0
                                                                                (delay = 0.5625ms)
 36 (24h)      R1 (01h)   2 bits      Bit 8        00h        0h        0b      HPOUT1R_ENA = 0
                                                                                HPOUT1L_ENA = 0
                                                                                (delay = 0.5625ms)
 37 (25h)     R76 (4Ch)    1 bit      Bit 15       00h        0h        0b      CP_ENA = 0
                                                                                (delay = 0.5625ms)
 38 (26h)      R1 (01h)   2 bits      Bit 12       00h        0h        0b      SPKOUTL_ENA = 0
                                                                                SPKOUTR_ENA = 0
                                                                                (delay = 0.5625ms)
 39 (27h)     R57 (39h)   6 bits      Bit 1        37h        0h        0b      BIAS_SRC = 1
                                                                                STARTUP_BIAS_ENA = 1
                                                                                VMID_BUF_ENA = 1
                                                                                VMID_RAMP[1:0] = 11b
                                                                                (delay = 0.5625ms)
 40 (28h)      R1 (01h)   3 bits      Bit 0        00h        9h        0b      BIAS_ENA = 0
                                                                                VMID_SEL = 00b
                                                                                (delay = 32.5ms)
 41 (29h)     R57 (39h)   6 bits      Bit 1        00h        0h        1b      BIAS_SRC = 0
                                                                                STARTUP_BIAS_ENA = 0
                                                                                VMID_BUF_ENA = 0
                                                                                VMID_RAMP[1:0] = 00b
                                                                                (delay = 0.5625ms)
Table 136 Speaker and Headphone Fast Shut-Down Default Sequence
                                                                                                     PP, March 2014, Rev 3.5
w
                                                                                                                        233


WM8958                                                                                             Pre-Production
                   Generic Shut-Down
                   The Generic Shut-Down sequence can be initiated by writing 812Ah to Register 272 (0110h). This
                   single operation starts the Control Write Sequencer at Index Address 42 (2Ah) and executes the
                   sequence defined in Table 137.
                   This sequence takes approximately 522ms to run.
 WSEQ    REGISTER  WIDTH      START        DATA     DELAY      EOS                    DESCRIPTION
 INDEX   ADDRESS
42 (2Ah) R31 (1Fh)  1 bit       Bit 5       01h        0h       0b     HPOUT2_MUTE = 1
                                                                       (delay = 0.5625ms)
43 (2Bh) R30 (1Eh) 6 bits       Bit 1       33h        0h       0b     LINEOUT2P_MUTE = 1
                                                                       LINEOUT2N_MUTE = 1
                                                                       LINEOUT1P_MUTE = 1
                                                                       LINEOUT1N_MUTE = 1
                                                                       (delay = 0.5625ms)
44 (2Ch) R96 (60h) 7 bits       Bit 1       00h        0h       0b     HPOUT1R_DLY = 0
                                                                       HPOUT1R_OUTP = 0
                                                                       HPOUT1R_RMV_SHORT = 0
                                                                       HPOUT1L_DLY = 0
                                                                       HPOUT1L_OUTP = 0
                                                                       HPOUT1L_RMV_SHORT = 0
                                                                       (delay = 0.5625ms)
45 (2Dh) R84 (54h) 2 bits       Bit 0       00h        0h       0b     DCS_ENA_CHAN_0 = 0
                                                                       DCS_ENA_CHAN_1 = 0
                                                                       (delay = 0.5625ms)
46 (2Eh)  R1 (01h) 2 bits       Bit 8       00h        0h       0b     HPOUT1R_ENA = 0
                                                                       HPOUT1L_ENA = 0
                                                                       (delay = 0.5625ms)
47 (2Fh) R76 (4Ch)  1 bit      Bit 15       00h        0h       0b     CP_ENA = 0
                                                                       (delay = 0.5625ms)
48 (30h)  R1 (01h) 2 bits      Bit 12       00h        0h       0b     SPKOUTL_ENA = 0
                                                                       SPKOUTR_ENA = 0
                                                                       (delay = 0.5625ms)
49 (31h) R57 (39h) 6 bits       Bit 1       17h        0h       0b     BIAS_SRC = 1
                                                                       STARTUP_BIAS_ENA = 1
                                                                       VMID_BUF_ENA = 1
                                                                       VMID_RAMP[1:0] = 01b
                                                                       (delay = 0.5625ms)
50 (32h)  R1 (01h) 3 bits       Bit 0       00h        Dh       0b     BIAS_ENA = 0
                                                                       VMID_SEL = 00b
                                                                       (delay = 512.5ms)
51 (33h)  R1 (01h)  1 bit      Bit 11       00h        0h       0b     HPOUT2_ENA = 0
                                                                       (delay = 0.5625ms)
52 (34h) R56 (38h) 2 bits       Bit 4       03h        0h       0b     LINEOUT2_DISCH = 1
                                                                       LINEOUT1_DISCH = 1
                                                                       (delay = 0.5625ms)
53 (35h) R55 (37h)  1 bit       Bit 0       01h        0h       0b     VROI = 1
                                                                       (delay = 0.5625ms)
54 (36h) R56 (38h)  1 bit       Bit 6       00h        0h       0b     HPOUT2_IN_ENA =0
                                                                       (delay = 0.5625ms)
55 (37h)  R3 (03h) 4 bits      Bit 10       00h        0h       0b     LINEOUT2P_ENA = 0
                                                                       LINEOUT2N_ENA = 0
                                                                       LINEOUT1P_ENA = 0
                                                                       LINEOUT1N_ENA = 0
                                                                       (delay = 0.5625ms)
                                                                                          PP, March 2014, Rev 3.5
w
                                                                                                             234


Pre-Production                                                                                                   WM8958
  WSEQ       REGISTER    WIDTH        START       DATA      DELAY     EOS                      DESCRIPTION
  INDEX      ADDRESS
 56 (38h)    R56 (38h)    1 bit        Bit 7       00h         0h      0b      LINEOUT_VMID_BUF_ENA = 0
                                                                               (delay = 0.5625ms)
 57 (39h)    R55 (37h)    1 bit        Bit 0       00h         0h      0b      VROI = 0
                                                                               (delay = 0.5625ms)
58 (3Ah)     R57 (39h)    6 bits       Bit 1       00h         0h      1b      BIAS_SRC = 0
                                                                               STARTUP_BIAS_ENA = 0
                                                                               VMID_BUF_ENA = 0
                                                                               VMID_RAMP[1:0] = 00b
                                                                               (delay = 0.5625ms)
Table 137 Generic Shut-Down Default Sequence
POP SUPPRESSION CONTROL
                         The WM8958 incorporates a number of features, including Wolfson’s SilentSwitch™ technology,
                         designed to suppress pops normally associated with Start-Up, Shut-Down or signal path control. To
                         achieve maximum benefit from these features, careful attention is required to the sequence and timing
                         of these controls. Note that, under the recommended usage conditions of the WM8958, these features
                         will be configured by running the default Start-Up and Shut-Down sequences as described in the
                         “Control Write Sequencer” section. In these cases, the user does not need to set these register fields
                         directly.
                         The Pop Suppression controls relating to the Headphone / Line Output drivers are described in the
                         “Analogue Output Signal Path” section.
                         Additional bias controls, also pre-programmed into Control Write Sequencer, are described in the
                         “Reference Voltages and Master Bias” section.
                         DISABLED LINE OUTPUT CONTROL
                         The line outputs are biased to VMID in normal operation. To avoid audible pops caused by a disabled
                         signal path dropping to AGND, the WM8958 can maintain these connections at VMID when the
                         relevant output stage is disabled. This is achieved by connecting a buffered VMID reference to the
                         output.
                         The buffered VMID reference is enabled by setting VMID_BUF_ENA. The output resistance is
                         selectable, using the VROI register bit.
                         Note that, if LINEOUTn_DISCH=1 (see Table 139), then the respective output will be discharged to
                         AGND, and will not be connected to VMID.
                             REGISTER         BIT        LABEL       DEFAULT                     DESCRIPTION
                             ADDRESS
                           R55 (0037h)         0      VROI               0       Buffered VMID to Analogue Line Output
                           Additional                                            Resistance (Disabled Outputs)
                           Control                                               0 = 20k from buffered VMID to output
                                                                                 1 = 500 from buffered VMID to output
                           R57 (0039h)         3      VMID_BUF           0       VMID Buffer Enable
                           AntiPOP (2)                _ENA                       0 = Disabled
                                                                                 1 = Enabled (provided VMID_SEL > 00)
                         Table 138 Disabled Line Output Control
                                                                                                      PP, March 2014, Rev 3.5
w
                                                                                                                           235


WM8958                                                                                             Pre-Production
       LINE OUTPUT DISCHARGE CONTROL
       The line output paths can be actively discharged to AGND through internal resistors if desired. This is
       desirable at start-up in order to achieve a known output stage condition prior to enabling the soft-start
       VMID reference voltage. This is also desirable in shut-down to prevent the external connections from
       being affected by the internal circuits.
       The line outputs LINEOUT1P and LINEOUT1N are discharged to AGND by setting
       LINEOUT1_DISCH. The line outputs LINEOUT2P and LINEOUT2N are discharged to AGND by
       setting LINEOUT2_DISCH.
       The discharge resistance is dependent upon the respective LINEOUTn_ENA bit, and also according
       to the VROI bit (see Table 138). The discharge resistance is noted in the “Electrical Characteristics”
       section.
           REGISTER          BIT          LABEL           DEFAULT                     DESCRIPTION
           ADDRESS
         R56 (0038h)          5     LINEOUT1_DISC               0         Discharges LINEOUT1P and
         AntiPOP (1)                H                                     LINEOUT1N outputs
                                                                          0 = Not active
                                                                          1 = Actively discharging LINEOUT1P
                                                                          and LINEOUT1N
                              4     LINEOUT2_DISC               0         Discharges LINEOUT2P and
                                    H                                     LINEOUT2N outputs
                                                                          0 = Not active
                                                                          1 = Actively discharging LINEOUT2P
                                                                          and LINEOUT2N
       Table 139 Line Output Discharge Control
       VMID REFERENCE DISCHARGE CONTROL
       The VMID reference can be actively discharged to AGND through internal resistors. This is desirable
       at start-up in order to achieve a known initial condition prior to enabling the soft-start VMID reference;
       this ensures maximum suppression of audible pops associated with start-up. VMID is discharged by
       setting VMID_DISCH.
           REGISTER          BIT          LABEL           DEFAULT                     DESCRIPTION
           ADDRESS
         R57 (0039h)          0     VMID_DISCH                  0         Connects VMID to ground
         AntiPOP (2)                                                      0 = Disabled
                                                                          1 = Enabled
       Table 140 VMID Reference Discharge Control
       INPUT VMID CLAMPS
       The analogue inputs can be clamped to Vmid using the INPUTS_CLAMP bit described below. This
       allows pre-charging of the input AC coupling capacitors during power-up. Note that all eight inputs are
       clamped using the same control bit.
       Note that INPUTS_CLAMP must be set to 0 when the analogue input signal paths are in use.
           REGISTER             BIT           LABEL            DEFAULT                  DESCRIPTION
            ADDRESS
        R21 (15h)                6     INPUTS_CLAMP                0        Input pad VMID clamp
        Input Mixer (1)                                                     0 = Clamp de-activated
                                                                            1 = Clamp activated
       Table 141 Input VMID Clamps
                                                                                        PP, March 2014, Rev 3.5
w
                                                                                                             236


Pre-Production                                                                                         WM8958
LDO REGULATORS
               The WM8958 provides two integrated Low Drop-Out Regulators (LDOs). These are provided to
               generate the appropriate power supplies for internal circuits, simplifying and reducing the
               requirements for external supplies and associated components. A reference circuit powered by
               AVDD2 ensures the accuracy of the LDO regulator voltage settings.
               Note that the integrated LDOs are only intended for generating the AVDD1 and DCVDD supply rails
               for the WM8958; they are not suitable for powering any additional or external loads.
               LDO1 is intended for generating AVDD1 - the primary analogue power domain of the WM8958. LDO1
               is powered by LDO1VDD and is enabled when a logic ‘1’ is applied to the LDO1ENA pin. The logic
               level is determined with respect to the DBVDD1 voltage domain. The LDO1 start-up time is dependent
               on the external AVDD1 and VREFC capacitors; the start-up time is noted in the “Electrical
               Characteristics” section for the recommended external component conditions.
               When LDO1 is enabled, the output voltage is controlled by the LDO1_VSEL register field. Note that
               the LDO1 voltage difference LDO1VDD - AVDD1 must be higher than the LDO1 Drop-Out voltage
               (see “Electrical Characteristics”).
               When LDO1 is disabled (by applying a logic ‘0’ to the LDO1ENA pin), the output can be left floating or
               can be actively discharged, depending on the LDO1_DISCH control bit.
               It is possible to supply AVDD1 from an external supply. If AVDD1 is supplied externally, then LDO1
               should be disabled, and the LDO1 output left floating (LDO1DISCH = 0). Note that the LDO1VDD
               voltage must be greater than or equal to AVDD1; this ensures that there is no leakage path through
               the LDO for the external supply.
               Note that the WM8958 can operate with AVDD1 tied to 0V; power consumption may be reduced, but
               the analogue audio functions will not be supported.
               LDO2 is intended for generating the DCVDD power domain which supplies the digital core functions
               on the WM8958. LDO2 is powered by DBVDD1 and is enabled when a logic ‘1’ is applied to the
               LDO2ENA pin. The logic level is determined with respect to the DBVDD1 voltage domain. The LDO2
               start-up time is dependent on the external DCVDD and VREFC capacitors; the start-up time is noted
               in the “Electrical Characteristics” section for the recommended external component conditions.
               When LDO2 is enabled, the output voltage is controlled by the LDO2_VSEL register field.
               When LDO2 is disabled (by applying a logic ‘0’ to the LDO2ENA pin), the output can be left floating or
               can be actively discharged, depending on the LDO2_DISCH control bit.
               It is possible to supply DCVDD from an external supply. If DCVDD is supplied externally, the
               LDO2ENA and LDO2DISCH bits should be set to 0. Note that the DBVDD1 voltage must be greater
               than or equal to DCVDD; this ensures that there is no leakage path through the LDO for the external
               supply.
               An internal pull-down resistor is enabled by default on the LDO1ENA and LDO2ENA pins. These pull-
               down resistors can be configured using the register bits described in Table 142.
               Decoupling capacitors should be connected to the voltage reference pin, VREFC, and also to the LDO
               outputs, AVDD1 and DCVDD. See “Applications Information” for further details.
               The LDO Regulator connections and controls are illustrated in Figure 81. The register controls are
               defined in Table 142.
                                                                                            PP, March 2014, Rev 3.5
w
                                                                                                                 237


WM8958                                                                                          Pre-Production
                                AVDD2
                                 Voltage
         VREFC                 Reference
                                         Analogue Supply                   Digital Core Supply
                         LDO1_VSEL[2:0]                      LDO2_VSEL[1:0]
                         LDO1_DISCH                          LDO2_DISCH
                                  LDO1                               LDO2
                    LDO1VDD LDO1ENA          AVDD1       DBVDD1    LDO2ENA       DCVDD
       Figure 81 LDO Regulators
          REGISTER      BIT               LABEL             DEFAULT                   DESCRIPTION
          ADDRESS
         R59 (003Bh)    3:1     LDO1_VSEL [2:0]                110        LDO1 Output Voltage Select
         LDO 1                                                            2.4V to 3.1V in 100mV steps
                                                                          000 = 2.4V
                                                                          001 = 2.5V
                                                                          010 = 2.6V
                                                                          011 = 2.7V
                                                                          100 = 2.8V
                                                                          101 = 2.9V
                                                                          110 = 3.0V
                                                                          111 = 3.1V
                         0      LDO1_DISCH                       1        LDO1 Discharge Select
                                                                          0 = LDO1 floating when disabled
                                                                          1 = LDO1 discharged when
                                                                          disabled
         R60            2:1     LDO2_VSEL [1:0]                 10        LDO2 Output Voltage Select
         (003Ch)                                                          1.1V to 1.3V in 100mV steps
         LDO 2                                                            00 = Reserved
                                                                          01 = 1.1V
                                                                          10 = 1.2V
                                                                          11 = 1.3V
                         0      LDO2_DISCH                       1        LDO2 Discharge Select
                                                                          0 = LDO2 floating when disabled
                                                                          1 = LDO2 discharged when
                                                                          disabled
         R1825           6      LDO2ENA_PD                       1        LDO2ENA Pull-down enable
         (0721h)                                                          0 = Disabled
         Pull Control                                                     1 = Enabled
         (2)
                         4      LDO1ENA_PD                       1        LDO1ENA Pull-down enable
                                                                          0 = Disabled
                                                                          1 = Enabled
       Table 142 LDO Regulator Control
                                                                                       PP, March 2014, Rev 3.5
w
                                                                                                          238


Pre-Production                                                                                              WM8958
REFERENCE VOLTAGES AND MASTER BIAS
               This section describes the analogue reference voltage and bias current controls. It also describes the
               VMID soft-start circuit for pop suppressed start-up and shut-down.
               The analogue circuits in the WM8958 require a mid-rail analogue reference voltage, VMID. This
               reference is generated from AVDD1 via a programmable resistor chain. Together with the external
               VMID decoupling capacitor, the programmable resistor chain determines the charging characteristic
               on VMID. This is controlled by VMID_SEL[1:0], and can be used to optimise the reference for normal
               operation or low power standby as described in Table 143.
               A buffered mid-rail reference voltage is provided. This is required for the single-ended configuration of
               the Input PGAs, and also for direct signal paths from the input pins to the Input Mixers, Output Mixers
               or Speaker Mixers. These requirements are noted in the relevant “Analogue Input Signal Path” and
               “Analogue Output Signal Path” sections. The buffered mid-rail reference is enabled by setting the
               VMID_BUF_ENA register bit.
               The analogue circuits in the WM8958 require a bias current. The normal bias current is enabled by
               setting BIAS_ENA. Note that the normal bias current source requires VMID to be enabled also.
                   REGISTER          BIT       LABEL        DEFAULT                      DESCRIPTION
                   ADDRESS
                 R1 (0001h)          2:1    VMID_SEL            00      VMID Divider Enable and Select
                 Power                      [1:0]                       00 = VMID disabled (for OFF mode)
                 Management                                             01 = 2 x 40k divider (for normal operation)
                 (1)
                                                                        10 = 2 x 240k divider (for low power standby)
                                                                        11 = Reserved
                                      0     BIAS_ENA             0      Enables the Normal bias current generator (for
                                                                        all analogue functions)
                                                                        0 = Disabled
                                                                        1 = Enabled
                 R57 (0039h)          3     VMID_BUF_            0      VMID Buffer Enable
                 AntiPOP (2)                ENA                         0 = Disabled
                                                                        1 = Enabled (provided VMID_SEL > 00)
               Table 143 Reference Voltages and Master Bias Enable
               A pop-suppressed start-up requires VMID to be enabled smoothly, without the step change normally
               associated with the initial stage of the VMID capacitor charging. A pop-suppressed start-up also
               requires the analogue bias current to be enabled throughout the signal path prior to the VMID
               reference voltage being applied. The WM8958 incorporates pop-suppression circuits which address
               these requirements.
               An alternate bias current source (Start-Up Bias) is provided for pop-free start-up; this is enabled by the
               STARTUP_BIAS_ENA register bit. The start-up bias is selected (in place of the normal bias) using the
               BIAS_SRC bit. It is recommended that the start-up bias is used during start-up, before switching back
               to the higher quality, normal bias.
               A soft-start circuit is provided in order to control the switch-on of the VMID reference. The soft-start
               control circuit offers two slew rates for enabling the VMID reference; these are selected and enabled
               by VMID_RAMP. When the soft-start circuit is enabled prior to enabling VMID_SEL, the reference
               voltage rises smoothly, without the step change that would otherwise occur. It is recommended that
               the soft-start circuit and the output signal path be enabled before VMID is enabled by VMID_SEL.
               A soft shut-down is provided, using the soft-start control circuit and the start-up bias current generator.
               The soft shut-down of VMID is achieved by setting VMID_RAMP, STARTUP_BIAS_ENA and
               BIAS_SRC to select the start-up bias current and soft-start circuit prior to setting VMID_SEL=00.
               Note that, if the VMID_RAMP function is enabled for soft start-up or soft shut-down then, after setting
               VMID_SEL = 00 to disable VMID, the soft-start circuit must be reset before re-enabling VMID. The
               soft-start circuit is reset by setting VMID_RAMP = 00. After resetting the soft-start circuit, the
               VMID_RAMP register may be updated to the required setting for the next VMID transition.
               The VMID soft-start register controls are defined in Table 144.
                                                                                                PP, March 2014, Rev 3.5
w
                                                                                                                     239


WM8958                                                                            Pre-Production
         REGISTER       BIT         LABEL      DEFAULT               DESCRIPTION
         ADDRESS
        R57 (0039h)     6:5    VMID_RAMP [1:0]   10    VMID soft start enable / slew rate
        AntiPOP (2)                                    control
                                                       00 = Normal slow start
                                                       01 = Normal fast start
                                                       10 = Soft slow start
                                                       11 = Soft fast start
                                                       If VMID_RAMP = 1X is selected for
                                                       VMID start-up or shut-down, then the
                                                       soft-start circuit must be reset by
                                                       setting VMID_RAMP=00 after VMID is
                                                       disabled, before VMID is re-enabled.
                                                       VMID is disabled / enabled using the
                                                       VMID_SEL register.
                         2     STARTUP_BIAS_      0    Enables the Start-Up bias current
                               ENA                     generator
                                                       0 = Disabled
                                                       1 = Enabled
                         1     BIAS_SRC           1    Selects the bias current source
                                                       0 = Normal bias
                                                       1 = Start-Up bias
       Table 144 Soft Start Control
                                                                       PP, March 2014, Rev 3.5
w
                                                                                            240


Pre-Production                                                                                             WM8958
POWER MANAGEMENT
               The WM8958 has control registers that allow users to select which functions are active. For minimum
               power consumption, unused functions should be disabled. To minimise pop or click noise, it is
               important to enable or disable functions in the correct order. See “Control Write Sequencer” for details
               of recommended control sequences.
                   REGISTER        BIT           LABEL           DEFAULT                    DESCRIPTION
                   ADDRESS
                 R1 (0001h)        13      SPKOUTR_ENA               0        SPKMIXR Mixer, SPKRVOL PGA and
                 Power                                                        SPKOUTR Output Enable
                 Management                                                   0 = Disabled
                 (1)                                                          1 = Enabled
                                   12      SPKOUTL_ENA               0        SPKMIXL Mixer, SPKLVOL PGA and
                                                                              SPKOUTL Output Enable
                                                                              0 = Disabled
                                                                              1 = Enabled
                                   11      HPOUT2_ENA                0        HPOUT2 and HPOUT2MIX Enable
                                                                              0 = Disabled
                                                                              1 = Enabled
                                    9      HPOUT1L_ENA               0        Enables HPOUT1L input stage
                                                                              0 = Disabled
                                                                              1 = Enabled
                                    8      HPOUT1R_ENA               0        Enables HPOUT1R input stage
                                                                              0 = Disabled
                                                                              1 = Enabled
                                    5      MICB2_ENA                 0        Microphone Bias 2 Enable
                                                                              0 = Disabled
                                                                              1 = Enabled
                                    4      MICB1_ENA                 0        Microphone Bias 1 Enable
                                                                              0 = Disabled
                                                                              1 = Enabled
                                   2:1     VMID_SEL                 00        VMID Divider Enable and Select
                                           [1:0]                              00 = VMID disabled (for OFF mode)
                                                                              01 = 2 x 40k divider (Normal mode)
                                                                              10 = 2 x 240k divider (Standby mode)
                                                                              11 = Reserved
                                    0      BIAS_ENA                  0        Enables the Normal bias current
                                                                              generator (for all analogue functions)
                                                                              0 = Disabled
                                                                              1 = Enabled
                 R2 (0002h)        14      TSHUT_ENA                 1        Thermal Sensor Enable
                 Power                                                        0 = Disabled
                 Management                                                   1 = Enabled
                 (2)
                                   13      TSHUT_OPDIS               1        Thermal Shutdown Control
                                                                              (Causes audio outputs to be disabled if
                                                                              an over-temperature occurs. The thermal
                                                                              sensor must also be enabled.)
                                                                              0 = Disabled
                                                                              1 = Enabled
                                   11      OPCLK_ENA                 0        GPIO Clock Output (OPCLK) Enable
                                                                              0 = Disabled
                                                                              1 = Enabled
                                    9      MIXINL_ENA                0        Left Input Mixer Enable
                                                                              (Enables MIXINL and RXVOICE input to
                                                                              MIXINL)
                                                                              0 = Disabled
                                                                              1 = Enabled
                                                                                              PP, March 2014, Rev 3.5
w
                                                                                                                     241


WM8958                                                               Pre-Production
         REGISTER BIT      LABEL    DEFAULT              DESCRIPTION
         ADDRESS
                   8  MIXINR_ENA       0    Right Input Mixer Enable
                                            (Enables MIXINR and RXVOICE input to
                                            MIXINR)
                                            0 = Disabled
                                            1 = Enabled
                   7  IN2L_ENA         0    IN2L Input PGA Enable
                                            0 = Disabled
                                            1 = Enabled
                   6  IN1L_ENA         0    IN1L Input PGA Enable
                                            0 = Disabled
                                            1 = Enabled
                   5  IN2R_ENA         0    IN2R Input PGA Enable
                                            0 = Disabled
                                            1 = Enabled
                   4  IN1R_ENA         0    IN1R Input PGA Enable
                                            0 = Disabled
                                            1 = Enabled
       R3 (0003h) 13  LINEOUT1N_ENA    0    LINEOUT1N Line Out and
       Power                                LINEOUT1NMIX Enable
       Management                           0 = Disabled
       (3)                                  1 = Enabled
                  12  LINEOUT1P_ENA    0    LINEOUT1P Line Out and
                                            LINEOUT1PMIX Enable
                                            0 = Disabled
                                            1 = Enabled
                  11  LINEOUT2N_ENA    0    LINEOUT2N Line Out and
                                            LINEOUT2NMIX Enable
                                            0 = Disabled
                                            1 = Enabled
                  10  LINEOUT2P_ENA    0    LINEOUT2P Line Out and
                                            LINEOUT2PMIX Enable
                                            0 = Disabled
                                            1 = Enabled
                   9  SPKRVOL_ENA      0    SPKMIXR Mixer and SPKRVOL PGA
                                            Enable
                                            0 = Disabled
                                            1 = Enabled
                                            Note that SPKMIXR and SPKRVOL are
                                            also enabled when SPKOUTR_ENA is
                                            set.
                   8  SPKLVOL_ENA      0    SPKMIXL Mixer and SPKLVOL PGA
                                            Enable
                                            0 = Disabled
                                            1 = Enabled
                                            Note that SPKMIXL and SPKLVOL are
                                            also enabled when SPKOUTL_ENA is
                                            set.
                   7  MIXOUTLVOL_E     0    MIXOUTL Left Volume Control Enable
                      NA                    0 = Disabled
                                            1 = Enabled
                   6  MIXOUTRVOL_E     0    MIXOUTR Right Volume Control Enable
                      NA                    0 = Disabled
                                            1 = Enabled
                   5  MIXOUTL_ENA      0    MIXOUTL Left Output Mixer Enable
                                            0 = Disabled
                                                           PP, March 2014, Rev 3.5
w
                                                                               242


Pre-Production                                                                   WM8958
                 REGISTER BIT      LABEL    DEFAULT               DESCRIPTION
                 ADDRESS
                                                    1 = Enabled
                           4  MIXOUTR_ENA      0    MIXOUTR Right Output Mixer Enable
                                                    0 = Disabled
                                                    1 = Enabled
               R4 (0004h) 13  AIF2ADCL_ENA     0    Enable AIF2ADC (Left) output path
               Power                                0 = Disabled
               Management                           1 = Enabled
               (4)
                                                    This bit must be set for AIF2 or AIF3
                                                    output of the AIF2ADC (Left) signal.
                          12  AIF2ADCR_ENA     0    Enable AIF2ADC (Right) output path
                                                    0 = Disabled
                                                    1 = Enabled
                                                    This bit must be set for AIF2 or AIF3
                                                    output of the AIF2ADC (Left) signal.
                          11  AIF1ADC2L_ENA    0    Enable AIF1ADC2 (Left) output path
                                                    (AIF1, Timeslot 1)
                                                    0 = Disabled
                                                    1 = Enabled
                          10  AIF1ADC2R_ENA    0    Enable AIF1ADC2 (Right) output path
                                                    (AIF1, Timeslot 1)
                                                    0 = Disabled
                                                    1 = Enabled
                           9  AIF1ADC1L_ENA    0    Enable AIF1ADC1 (Left) output path
                                                    (AIF1, Timeslot 0)
                                                    0 = Disabled
                                                    1 = Enabled
                           8  AIF1ADC1L_ENA    0    Enable AIF1ADC1 (Right) output path
                                                    (AIF1, Timeslot 0)
                                                    0 = Disabled
                                                    1 = Enabled
                           5  DMIC2L_ENA       0    Digital microphone DMICDAT2 Left
                                                    channel enable
                                                    0 = Disabled
                                                    1 = Enabled
                           4  DMIC2R_ENA       0    Digital microphone DMICDAT2 Right
                                                    channel enable
                                                    0 = Disabled
                                                    1 = Enabled
                           3  DMIC1L_ENA       0    Digital microphone DMICDAT1 Left
                                                    channel enable
                                                    0 = Disabled
                                                    1 = Enabled
                           2  DMIC1R_ENA       0    Digital microphone DMICDAT1 Right
                                                    channel enable
                                                    0 = Disabled
                                                    1 = Enabled
                           1  ADCL_ENA         0    Left ADC Enable
                                                    0 = ADC disabled
                                                    1 = ADC enabled
                           0  ADCR_ENA         0    Right ADC Enable
                                                    0 = ADC disabled
                                                    1 = ADC enabled
               R5 (0005h) 13  AIF2DACL_ENA     0    Enable AIF2DAC (Left) input path
               Power                                0 = Disabled
               Management                           1 = Enabled
                                                                    PP, March 2014, Rev 3.5
w
                                                                                          243


WM8958                                                                      Pre-Production
         REGISTER     BIT      LABEL    DEFAULT               DESCRIPTION
         ADDRESS
       (5)            12  AIF2DACR_ENA     0    Enable AIF2DAC (Right) input path
                                                0 = Disabled
                                                1 = Enabled
                      11  AIF1DAC2L_ENA    0    Enable AIF1DAC2 (Left) input path (AIF1,
                                                Timeslot 1)
                                                0 = Disabled
                                                1 = Enabled
                      10  AIF1DAC2R_ENA    0    Enable AIF1DAC2 (Right) input path
                                                (AIF1, Timeslot 1)
                                                0 = Disabled
                                                1 = Enabled
                       9  AIF1DAC1L_ENA    0    Enable AIF1DAC1 (Left) input path (AIF1,
                                                Timeslot 0)
                                                0 = Disabled
                                                1 = Enabled
                       8  AIF1DAC1R_ENA    0    Enable AIF1DAC1 (Right) input path
                                                (AIF1, Timeslot 0)
                                                0 = Disabled
                                                1 = Enabled
                       3  DAC2L_ENA        0    Left DAC2 Enable
                                                0 = DAC disabled
                                                1 = DAC enabled
                       2  DAC2R_ENA        0    Right DAC2 Enable
                                                0 = DAC disabled
                                                1 = DAC enabled
                       1  DAC1L_ENA        0    Left DAC1 Enable
                                                0 = DAC disabled
                                                1 = DAC enabled
                       0  DAC1R_ENA        0    Right DAC1 Enable
                                                0 = DAC disabled
                                                1 = DAC enabled
       R76 (004Ch)    15  CP_ENA           0    Enable charge-pump digits
       Charge Pump                              0 = Disable
       (1)                                      1 = Enable
       R84 (0054h)     1  DCS_ENA_CHAN     0    DC Servo enable for HPOUT1R
       DC Servo (1)       _1                    0 = Disabled
                                                1 = Enabled
                       0  DCS_ENA_CHAN     0    DC Servo enable for HPOUT1L
                          _0                    0 = Disabled
                                                1 = Enabled
       R272 (0110h)    8  WSEQ_ENA         0    Write Sequencer Enable.
       Write                                    0 = Disabled
       Sequencer                                1 = Enabled
       Ctrl (1)
       R512 (0200h)    0  AIF1CLK_ENA      0    AIF1CLK Enable
       AIF 1 Clocking                           0 = Disabled
       (1)                                      1 = Enabled
       R516 (0204h)    0  AIF2CLK_ENA      0    AIF2CLK Enable
       AIF 2 Clocking                           0 = Disabled
       (1)                                      1 = Enabled
       R520 (0208h)    4  TOCLK_ENA        0    Slow Clock (TOCLK) Enable
       Clocking (1)                             0 = Disabled
                                                1 = Enabled
                                                This clock is required for zero-cross
                                                timeout.
                                                                 PP, March 2014, Rev 3.5
w
                                                                                      244


Pre-Production                                                                          WM8958
                  REGISTER      BIT       LABEL    DEFAULT               DESCRIPTION
                  ADDRESS
                                 3   AIF1DSPCLK_EN    0    AIF1 Processing Clock Enable
                                     A                     0 = Disabled
                                                           1 = Enabled
                                 2   AIF2DSPCLK_EN    0    AIF2 Processing Clock Enable
                                     A                     0 = Disabled
                                                           1 = Enabled
                                 1   SYSDSPCLK_EN     0    Digital Mixing Processor Clock Enable
                                     A                     0 = Disabled
                                                           1 = Enabled
                R544 (0220h)     0   FLL1_ENA         0    FLL1 Enable
                FLL1 Control                               0 = Disabled
                (1)                                        1 = Enabled
                                                           This should be set as the final step of the
                                                           FLL1 enable sequence, ie. after the other
                                                           FLL registers have been configured.
                R576 (0240h)     0   FLL2_ENA         0    FLL2 Enable
                FLL2 Control                               0 = Disabled
                (1)                                        1 = Enabled
                                                           This should be set as the final step of the
                                                           FLL2 enable sequence, ie. after the other
                                                           FLL registers have been configured.
               Table 145 Power Management
                                                                           PP, March 2014, Rev 3.5
w
                                                                                                  245


WM8958                                                                                                Pre-Production
THERMAL SHUTDOWN
              The WM8958 incorporates a temperature sensor which detects when the device temperature is within
              normal limits or if the device is approaching a hazardous temperature condition. The temperature
              sensor can be configured to automatically disable the audio outputs of the WM8958 in response to an
              overtemperature condition (approximately 150ºC).
              The temperature status can be output directly on a GPIO pin, as described in the “General Purpose
              Input/Output” section. The temperature sensor can also be used to generate Interrupt events, as
              described in the “Interrupts” section. The GPIO and Interrupt functions can be used to indicate either a
              Warning Temperature event or the Shutdown Temperature event.
              The temperature sensor is enabled by setting the TSHUT_ENA register bit. When the TSHUT_OPDIS
              is also set, then a device over-temperature condition will cause the speaker outputs (SPKOUTL and
              SPKOUTR) of the WM8958 to be disabled; this response is likely to prevent any damage to the device
              attributable to the large currents of the output drivers.
              Note that, to prevent pops and clicks, TSHUT_ENA and TSHUT_OPDIS should only be updated
              whilst the speaker and headphone outputs are disabled.
                  REGISTER          BIT          LABEL           DEFAULT                 DESCRIPTION
                   ADDRESS
                R2 (0002h)           14     TSHUT_ENA                 1      Thermal sensor enable
                Power                                                        0 = Disabled
                Management                                                   1 = Enabled
                (2)
                                     13     TSHUT_OPDIS               1      Thermal shutdown control
                                                                             (Causes audio outputs to be disabled
                                                                             if an overtemperature occurs. The
                                                                             thermal sensor must also be enabled.)
                                                                             0 = Disabled
                                                                             1 = Enabled
              Table 146 Thermal Shutdown
                                                                                            PP, March 2014, Rev 3.5
w
                                                                                                                  246


Pre-Production                                                                                            WM8958
POWER ON RESET
               The WM8958 includes a Power-On Reset (POR) circuit, which is used to reset the digital logic into a
               default state after power up. The POR circuit derives its output from AVDD2 and DCVDD. The internal
               POR
               ¯¯¯ signal is asserted low when AVDD2 and DCVDD are below minimum thresholds.
               The specific behaviour of the circuit will vary, depending on relative timing of the supply voltages.
               Typical scenarios are illustrated in Figure 82 and Figure 83.
               Figure 82 Power On Reset Timing – AVDD2 enabled/disabled first
               Figure 83 Power On Reset Timing - DCVDD enabled/disabled first
                    ¯¯¯ signal is undefined until AVDD2 has exceeded the minimum threshold, Vpora. Once this
               The POR
               threshold has been exceeded, POR ¯¯¯ is asserted low and the chip is held in reset. In this condition, all
               writes to the control interface are ignored. Once AVDD2 and DCVDD have reached their respective
               power on thresholds, POR¯¯¯ is released high, all registers are in their default state, and writes to the
               control interface may take place.
               Note that a power-on reset period, TPOR, applies after AVDD2 and DCVDD have reached their
               respective power on thresholds. This specification is guaranteed by design rather than test.
               On power down, POR  ¯¯¯ is asserted low when either AVDD2 or DCVDD falls below their respective
               power-down thresholds.
                                                                                             PP, March 2014, Rev 3.5
w
                                                                                                                    247


WM8958                                                                                         Pre-Production
       Typical Power-On Reset parameters for the WM8958 are defined in Table 147.
          SYMBOL                      DESCRIPTION                         TYP     UNIT
           Vpora_on    Power-On threshold (AVDD2)                        1.15      V
           Vpora_off   Power-Off threshold (AVDD2)                       1.14      V
           Vpord_on    Power-On threshold (DCVDD)                        0.56      V
           Vpord_off   Power-Off threshold (DCVDD)                       0.55      V
            TPOR       Minimum Power-On Reset period                      100      ns
       Table 147 Typical Power-On Reset Parameters
       Table 148 describes the status of the WM8958 digital I/O pins when the Power On Reset has
       completed, prior to any register writes. The same conditions apply on completion of a Software Reset
       (described in the “Software Reset and Device ID” section).
           PIN NO                NAME                           TYPE                   RESET STATUS
         DBVDD1 power domain
             A4               SPKMODE                       Digital Input             Pull-up to DBVDD1
             C3               LDO1ENA                       Digital Input             Pull-down to DGND
             D3                  ADDR                       Digital Input             Pull-down to DGND
             D5               LDO2ENA                       Digital Input             Pull-down to DGND
             E3                  SCLK                       Digital Input                 Digital input
             G2                   SDA                   Digital Input/Output              Digital input
             E1                 MCLK1                       Digital Input                 Digital input
             D2                 MCLK2                       Digital Input             Pull-down to DGND
             F2                 BCLK1                   Digital Input/Output              Digital input
             D4                LRCLK1                   Digital Input/Output              Digital input
             H1          GPIO1/ADCLRCLK1                Digital Input/Output              Digital input
             G1               DACDAT1                       Digital Input                 Digital input
             F1               ADCDAT1                      Digital Output                Digital output
         DBVDD2 power domain
             G3                 BCLK2                   Digital Input/Output              Digital input,
                                                                                      Pull-down to DGND
             H2                LRCLK2                   Digital Input/Output              Digital input,
                                                                                      Pull-down to DGND
             H3          GPIO6/ADCLRCLK2                Digital Input/Output              Digital input,
                                                                                      Pull-down to DGND
             E4               DACDAT2                       Digital Input             Pull-down to DGND
             F4               ADCDAT2                      Digital Output                Digital output
         DBVDD3 power domain
             E5             GPIO11/BCLK3                Digital Input/Output              Digital input,
                                                                                      Pull-down to DGND
             F5            GPIO10/LRCLK3                Digital Input/Output              Digital input,
                                                                                      Pull-down to DGND
             G4            GPIO8/DACDAT3                Digital Input/Output              Digital input,
                                                                                      Pull-down to DGND
             H4            GPIO9/ADCDAT3                Digital Input/Output              Digital input,
                                                                                      Pull-down to DGND
         MICBIAS1 power domain
             D6                DMICCLK                     Digital Output                Digital output
             A8           IN2RN/DMICDAT2             Analogue Input/Digital Input       Analogue input
             B9           IN2LN/DMICDAT1             Analogue Input/Digital Input       Analogue input
       Table 148 WM8958 Digital I/O Status in Reset
       Note that the dual function IN2LN/DMICDAT1 and IN2RN/DMICDAT2 pins default to IN2LN or IN2RN
       (analogue input) after Power On Reset is completed. The IN2LN and IN2RN functions are referenced
       to the AVDD1 power domain.
                                                                                    PP, March 2014, Rev 3.5
w
                                                                                                         248


Pre-Production                                                                                             WM8958
QUICK START-UP AND SHUTDOWN
                The default control sequences (see “Control Write Sequencer”) contain only the register writes
                necessary to enable or disable specific output drivers. It is therefore necessary to configure the signal
                path and gain settings before commanding any of the default start-up sequences.
                This section describes minimum control sequences to configure the WM8958 for DAC to Headphone
                playback. Note that these sequences are provided for guidance only; application software should be
                verified and tailored to ensure optimum performance.
                Table 149 describes an example control sequence to enable DAC playback to HPOUT1L and
                HPOUT1R path. This involves DAC enable, signal path configuration and mute control, together with
                the default “Headphone Cold Start-Up” sequence. Table 150 describes an example control sequence
                to disable the direct DAC to Headphone path.
                     REGISTER             VALUE                                 DESCRIPTION
                      R5 (0005h)           0003h      Enable DAC1L and DAC1R
                    R45 (002Dh)            0100h      Enable path from DAC1L to HPOUT1L
                    R46 (002Eh)            0100h      Enable path from DAC1R to HPOUT1R
                    R272 (0110h)           8100h      Initiate Control Write Sequencer at Index Address 0 (00h)
                                                      (Headphone Cold Start-Up sequence)
                                                      Delay 300ms
                                                      Note: Delay must be inserted in the sequence to allow the
                                                      Control Write Sequencer to finish. Any control interface writes
                                                      to the CODEC will be ignored while the Control Write
                                                      Sequencer is running.
                   R1056 (0420h)           0000h      Soft un-mute DAC1L and DAC1R
                Table 149 DAC to Headphone Direct Start-Up Sequence
                     REGISTER             VALUE                                 DESCRIPTION
                   R1056 (0420h)           0200h      Soft mute DAC1L and DAC1R
                    R272 (0110h)           812Ah      Initiate Control Write Sequencer at Index Address 42 (2Ah)
                                                      (Generic Shut-Down)
                                                      Delay 525ms
                                                      Note: Delay must be inserted in the sequence to allow the
                                                      Control Write Sequencer to finish. Any control interface writes
                                                      to the CODEC will be ignored while the Control Write
                                                      Sequencer is running.
                    R45 (002Dh)            0000h      Disable path from DAC1L to HPOUT1L
                    R46 (002Eh)            0000h      Disable path from DAC1R to HPOUT1R
                      R5 (0005h)           0000h      Disable DAC1L and DAC1R
                Table 150 DAC to Headphone Direct Shut-Down Sequence
                In both cases, the WSEQ_BUSY bit (in Register R272, see Table 129) will be set to 1 while the
                Control Write Sequence runs. When this bit returns to 0, the remaining steps of the sequence may be
                executed.
                                                                                              PP, March 2014, Rev 3.5
w
                                                                                                                     249


WM8958                                                                                                    Pre-Production
SOFTWARE RESET AND DEVICE ID
               The device ID can be read back from register R0. Writing to this register will reset the device.
               The software reset causes most control registers to be reset to their default state. Note that the
               Control Write Sequencer registers R12288 (3000h) through to R12799 (31FFh) are not affected by a
               software reset; the Control Sequences defined in these registers are retained unchanged.
               The status of the WM8958 digital I/O pins following a software reset is described in Table 148.
               The device revision can be read back from register R256.
                 REGISTER        BIT         LABEL           DEFAULT                     DESCRIPTION
                  ADDRESS
                 R0 (0000h)      15:0   SW_RESET             8958h         Writing to this register resets all registers
                 Software               [15:0]                             to their default state. (Note - Control
                 Reset                                                     Write Sequencer registers are not
                                                                           affected by Software Reset.)
                                                                           Reading from this register will indicate
                                                                           device ID 8958h.
                 R256            3:0    CHIP_REV [3:0]                     Chip revision
                 (0100h)
                 Chip
                 Revision
               Table 151 Chip Reset and ID
                                                                                              PP, March 2014, Rev 3.5
w
                                                                                                                      250


Pre-Production                                                                                                                    WM8958
REGISTER MAP
The WM8958 control registers are listed below. Note that only the register addresses described here should be accessed; writing to
other addresses may result in undefined behaviour. Register bits that are not documented should not be changed from the default
values.
    REG            NAME         15   14    13    12    11    10        9     8        7     6     5     4      3        2       1   0   DEFAULT
   R0 (0h)  Software Reset                                               SW_RESET [15:0]                                                 0000h
   R1 (1h)  Power               0    0   SPKO SPKO HPOU       0     HPOU HPOU         0     0  MICB2 MICB1     0       VMID_SEL   BIAS_  0000h
            Management (1)               UTR_ UTL_E T2_EN          T1L_E T1R_E                 _ENA _ENA                  [1:0]    ENA
                                          ENA    NA    A              NA    NA
   R2 (2h)  Power               0  TSHU TSHU      0  OPCL     0     MIXIN MIXIN IN2L_ IN1L_ IN2R_ IN1R_        0        0       0   0    6000h
            Management (2)         T_ENA T_OP        K_EN          L_ENA R_EN ENA ENA ENA ENA
                                          DIS          A                    A
   R3 (3h)  Power               0    0   LINEO LINEO LINEO LINEO SPKR SPKLV MIXO MIXO MIXO MIXO                0        0       0   0    0000h
            Management (3)               UT1N_ UT1P_ UT2N_ UT2P_ VOL_E OL_E UTLV UTRV UTL_E UTR_
                                          ENA ENA ENA ENA             NA    NA OL_E OL_E NA           ENA
                                                                                     NA    NA
   R4 (4h)  Power               0    0   AIF2A AIF2A AIF1A AIF1A AIF1A AIF1A          0     0  DMIC2 DMIC2 DMIC1 DMIC1 ADCL_ ADCR        0000h
            Management (4)               DCL_E DCR_ DC2L_ DC2R_ DC1L_ DC1R_                    L_ENA R_EN L_ENA R_EN ENA _ENA
                                           NA   ENA ENA ENA ENA ENA                                    A               A
   R5 (5h)  Power               0    0   AIF2D AIF2D AIF1D AIF1D AIF1D AIF1D          0     0     0     0   DAC2L DAC2 DAC1L DAC1        0000h
            Management (5)               ACL_E ACR_ AC2L_ AC2R_ AC1L_ AC1R_                                 _ENA R_EN _ENA R_EN
                                           NA   ENA ENA ENA ENA ENA                                                    A            A
   R6 (6h)  Power               0    0      0     0     0  AIF3ADC_SRC AIF2DAC_SRC          0  AIF3_ AIF3_ADCDAT AIF2_ AIF2_ AIF1_       0000h
            Management (6)                                      [1:0]          [1:0]             TRI   _SRC [1:0] ADCD DACD DACD
                                                                                                                     AT_SR AT_SR AT_SR
                                                                                                                       C        C   C
  R21 (15h) Input Mixer (1)     0    0      0     0     0     0        0  IN1RP    IN1LP INPUT    0     0      0        0       0   0    0000h
                                                                           _MIXI   _MIXI S_CLA
                                                                           NR_B     NL_B MP
                                                                          OOST     OOST
  R24 (18h) Left Line Input 1&2 0    0      0     0     0     0        0  IN1_V IN1L_ IN1L_       0              IN1L_VOL [4:0]          008Bh
            Volume                                                          U      MUTE ZC
  R25 (19h) Left Line Input 3&4 0    0      0     0     0     0        0  IN2_V IN2L_ IN2L_       0              IN2L_VOL [4:0]          008Bh
            Volume                                                          U      MUTE ZC
  R26 (1Ah) Right Line Input    0    0      0     0     0     0        0  IN1_V IN1R_ IN1R_       0             IN1R_VOL [4:0]           008Bh
            1&2 Volume                                                      U      MUTE ZC
  R27 (1Bh) Right Line Input    0    0      0     0     0     0        0  IN2_V IN2R_ IN2R_       0             IN2R_VOL [4:0]           008Bh
            3&4 Volume                                                      U      MUTE ZC
  R28 (1Ch) Left Output Volume  0    0      0     0     0     0        0  HPOU HPOU HPOU                  HPOUT1L_VOL [5:0]              006Dh
                                                                          T1_VU T1L_Z T1L_M
                                                                                     C    UTE_
                                                                                            N
  R29 (1Dh) Right Output        0    0      0     0     0     0        0  HPOU HPOU HPOU                  HPOUT1R_VOL [5:0]              006Dh
            Volume                                                        T1_VU T1R_Z T1R_
                                                                                     C   MUTE
                                                                                           _N
  R30 (1Eh) Line Outputs        0    0      0     0     0     0        0     0        0  LINEO LINEO LINEO     0     LINEO LINEO LINEO   0066h
            Volume                                                                       UT1N_ UT1P_ UT1_V           UT2N_ UT2P_ UT2_V
                                                                                         MUTE MUTE OL                MUTE MUTE OL
  R31 (1Fh) HPOUT2 Volume       0    0      0     0     0     0        0     0        0     0  HPOU HPOU       0        0       0   0    0020h
                                                                                                T2_M T2_VO
                                                                                                UTE     L
  R32 (20h) Left OPGA Volume    0    0      0     0     0     0        0   MIXO MIXO MIXO                 MIXOUTL_VOL [5:0]              0079h
                                                                           UT_V UTL_Z UTL_
                                                                            U        C   MUTE
                                                                                           _N
                                                                                                                      PP, March 2014, Rev 3.5
w
                                                                                                                                            251


WM8958                                                                                                                  Pre-Production
   REG           NAME       15 14 13 12    11     10    9       8      7      6      5      4       3      2       1         0 DEFAULT
 R33 (21h) Right OPGA       0  0  0  0     0       0    0   MIXO MIXO MIXO                     MIXOUTR_VOL [5:0]                0079h
           Volume                                           UT_V UTR_Z UTR_
                                                               U       C   MUTE
                                                                             _N
 R34 (22h) SPKMIXL          0  0  0  0     0       0    0   SPKA       0   DAC2L MIXIN  IN1LP     MIXO DAC1L SPKMIXL_VOL        0003h
           Attenuation                                     B_REF           _SPK  L_SPK   _SPK    UTL_S _SPK           [1:0]
                                                            _SEL           MIXL_ MIXL_  MIXL_    PKMIX MIXL_
                                                                            VOL    VOL   VOL     L_VOL   VOL
 R35 (23h) SPKMIXR          0  0  0  0     0       0    0  SPKO        0   DAC2  MIXIN  IN1RP     MIXO DAC1 SPKMIXR_VO          0003h
           Attenuation                                     UT_CL           R_SP   R_SP   _SPK     UTR_ R_SP          L [1:0]
                                                           ASSA            KMIXR KMIXR  MIXR_    SPKMI KMIXR
                                                               B           _VOL   _VOL   VOL      XR_V _VOL
                                                                                                   OL
 R36 (24h) SPKOUT Mixers    0  0  0  0     0       0    0       0      0      0  IN2LR  SPKMI    SPKMI IN2LR   SPKMI     SPKMI  0011h
                                                                                 P_TO_  XL_TO     XR_T P_TO_   XL_TO      XR_T
                                                                                 SPKO    _SPK     O_SP SPKO     _SPK      O_SP
                                                                                   UTL  OUTL     KOUT    UTR   OUTR       KOUT
                                                                                                    L                        R
 R37 (25h) ClassD           0  0  0  0     0       0    0       1      0      1     SPKOUTL_BOOST         SPKOUTR_BOOST         0140h
                                                                                          [2:0]                  [2:0]
 R38 (26h) Speaker Volume   0  0  0  0     0       0    0  SPKO SPKO SPKO                      SPKOUTL_VOL [5:0]                0079h
           Left                                             UT_V UTL_Z UTL_
                                                               U       C   MUTE
                                                                             _N
 R39 (27h) Speaker Volume   0  0  0  0     0       0    0  SPKO SPKO SPKO                     SPKOUTR_VOL [5:0]                 0079h
           Right                                            UT_V UTR_Z UTR_
                                                               U       C   MUTE
                                                                             _N
 R40 (28h) Input Mixer (2)  0  0  0  0     0       0    0       0   IN2LP IN2LN IN1LP IN1LN IN2RP IN2RN IN1RP IN1RN             0000h
                                                                    _TO_I _TO_I _TO_I _TO_I _TO_I _TO_I _TO_I _TO_I
                                                                     N2L    N2L    N1L    N1L     N2R N2R N1R N1R
 R41 (29h) Input Mixer (3)  0  0  0  0     0       0    0   IN2L_ IN2L_       0   IN1L_ IN1L_       0  MIXOUTL_MIXINL_VO        0000h
                                                           TO_MI MIXIN           TO_MI MIXIN                   L [2:0]
                                                             XINL L_VOL            XINL L_VOL
 R42 (2Ah) Input Mixer (4)  0  0  0  0     0       0    0  IN2R_ IN2R_        0  IN1R_ IN1R_        0  MIXOUTR_MIXINR_VO        0000h
                                                           TO_MI MIXIN           TO_MI MIXIN                   L [2:0]
                                                            XINR R_VO             XINR R_VO
                                                                       L                    L
 R43 (2Bh) Input Mixer (5)  0  0  0  0     0       0    0     IN1LP_MIXINL_VOL       0      0       0   IN2LRP_MIXINL_VOL       0000h
                                                                     [2:0]                                       [2:0]
R44 (2Ch)  Input Mixer (6)  0  0  0  0     0       0    0    IN1RP_MIXINR_VOL        0      0       0  IN2LRP_MIXINR_VOL        0000h
                                                                     [2:0]                                       [2:0]
R45 (2Dh)  Output Mixer (1) 0  0  0  0     0       0    0  DAC1L    MIXIN  MIXIN IN2RN IN2LN IN1R_ IN1L_ IN2LP DAC1L            0000h
                                                           _TO_H   R_TO_   L_TO_ _TO_ _TO_ TO_MI TO_MI _TO_ _TO_
                                                           POUT     MIXO   MIXO MIXO MIXO XOUT XOUT MIXO MIXO
                                                               1L    UTL    UTL    UTL    UTL       L      L     UTL       UTL
 R46 (2Eh) Output Mixer (2) 0  0  0  0     0       0    0   DAC1    MIXIN  MIXIN IN2LN IN2RN IN1L_ IN1R_       IN2RP DAC1       0000h
                                                           R_TO_    L_TO_  R_TO_  _TO_ _TO_ TO_MI TO_MI         _TO_ R_TO_
                                                           HPOU     MIXO   MIXO   MIXO MIXO XOUT XOUT           MIXO MIXO
                                                             T1R     UTR    UTR    UTR UTR         R       R    UTR UTR
 R47 (2Fh) Output Mixer (3) 0  0  0  0   IN2LP_MIXOUTL_VOL IN2LN_MIXOUTL_VOL IN1R_MIXOUTL_VOL            IN1L_MIXOUTL_VOL       0000h
                                                 [2:0]               [2:0]                [2:0]                  [2:0]
 R48 (30h) Output Mixer (4) 0  0  0  0  IN2RP_MIXOUTR_VOL IN2RN_MIXOUTR_VOL IN1L_MIXOUTR_VOL            IN1R_MIXOUTR_VOL        0000h
                                                 [2:0]               [2:0]                [2:0]                  [2:0]
 R49 (31h) Output Mixer (5) 0  0  0  0  DAC1L_MIXOUTL_VOL IN2RN_MIXOUTL_VOL MIXINR_MIXOUTL_VO MIXINL_MIXOUTL_VO                 0000h
                                                 [2:0]               [2:0]              L [2:0]                L [2:0]
 R50 (32h) Output Mixer (6) 0  0  0  0  DAC1R_MIXOUTR_VO IN2LN_MIXOUTR_VOL MIXINL_MIXOUTR_VO MIXINR_MIXOUTR_VO                  0000h
                                                L [2:0]              [2:0]              L [2:0]                L [2:0]
                                                                                                         PP, March 2014, Rev 3.5
w
                                                                                                                                  252


Pre-Production                                                                                                                       WM8958
   REG            NAME          15  14   13    12  11      10      9      8      7      6        5       4     3      2        1        0 DEFAULT
 R51 (33h) HPOUT2 Mixer          0  0    0     0    0      0      0       0      0      0     IN2LR    MIXO MIXO      0        0        0  0000h
                                                                                             P_TO_     UTLV UTRV
                                                                                              HPOU     OL_T  OL_T
                                                                                                T2     O_HP O_HP
                                                                                                       OUT2 OUT2
 R52 (34h) Line Mixer (1)        0  0    0     0    0      0      0       0      0    MIXO    MIXO LINEO       0   IN1R_ IN1L_ MIXO        0000h
                                                                                     UTL_T   UTR_T UT1_            TO_LI TO_LI UTL_T
                                                                                     O_LIN    O_LIN MODE           NEOU NEOU O_LIN
                                                                                     EOUT     EOUT                  T1P      T1P EOUT
                                                                                       1N       1N                                     1P
 R53 (35h) Line Mixer (2)        0  0    0     0    0      0      0       0      0    MIXO    MIXO LINEO       0   IN1L_ IN1R_ MIXO        0000h
                                                                                    UTR_T    UTL_T UT2_            TO_LI TO_LI UTR_T
                                                                                     O_LIN    O_LIN MODE           NEOU NEOU O_LIN
                                                                                     EOUT     EOUT                  T2P      T2P EOUT
                                                                                       2N       2N                                     2P
 R54 (36h) Speaker Mixer         0  0    0     0    0      0    DAC2L DAC2 MIXIN MIXIN IN1LP IN1RP MIXO MIXO DAC1L DAC1                    0000h
                                                                _TO_S R_TO_ L_TO_ R_TO_ _TO_S _TO_S UTL_T UTR_T _TO_S R_TO_
                                                                PKMIX SPKMI SPKMI SPKMI PKMIX PKMIX O_SP O_SP PKMIX SPKMI
                                                                  L      XR     XL     XR        L       R  KMIXL KMIXR        L       XR
 R55 (37h) Additional Control    0  0    0     0    0      0      0       0   LINEO LINEO        0       0     0      0        0     VROI  0000h
                                                                              UT1_F UT2_F
                                                                                B       B
 R56 (38h) AntiPOP (1)           0  0    0     0    0      0      0       0   LINEO HPOU LINEO LINEO           0      0        0        0  0000h
                                                                              UT_V T2_IN UT1_D UT2_D
                                                                              MID_B _ENA ISCH ISCH
                                                                              UF_E
                                                                                NA
 R57 (39h) AntiPOP (2)           0  0    0     0    0      0      0       1      1    VMID_RAMP          0  VMID_ STAR BIAS_ VMID_         0180h
                                                                                          [1:0]             BUF_E TUP_B SRC DISCH
                                                                                                              NA IAS_E
                                                                                                                     NA
 R59 (3Bh) LDO 1                 0  0    0     0    0      0      0       0      0      0        0       0     LDO1_VSEL [2:0]      LDO1_  000Dh
                                                                                                                                    DISCH
 R60 (3Ch) LDO 2                 0  0    0     0    0      0      0       0      0      0        0       0     0    LDO2_VSEL LDO2_        0005h
                                                                                                                        [1:0]       DISCH
 R61 (3Dh) MICBIAS1              0  0    0     0    0      0      0       0      0      0    MICB1 MICB1       MICB1_LVL [2:0]      MICB1  0039h
                                                                                             _RATE _MOD                             _DISC
                                                                                                         E                              H
 R62 (3Eh) MICBIAS2              0  0    0     0    0      0      0       0      0      0    MICB2 MICB2       MICB2_LVL [2:0]      MICB2  0039h
                                                                                             _RATE _MOD                             _DISC
                                                                                                         E                              H
 R76 (4Ch) Charge Pump (1)    CP_E  0    0     1    1      1      1       1      0      0        1       0     0      1        0        1  1F25h
                                NA
 R77 (4Dh) Charge Pump (2)    CP_DI 0    1     0    1      0      1       1      0      0        0       1     1      0        0        1  AB19h
                               SCH
 R81 (51h) Class W (1)           0  0    0     0    0      0    CP_DYN_SRC       0      0        0       0     0      1        0     CP_D  0004h
                                                                  _SEL [1:0]                                                         YN_P
                                                                                                                                       WR
 R84 (54h) DC Servo (1)          0  0  DCS_ DCS_    0      0    DCS_ DCS_        0      0     DCS_     DCS_ DCS_   DCS_ DCS_ DCS_          0000h
                                       TRIG_ TRIG_              TRIG_ TRIG_                  TRIG_    TRIG_ TRIG_  TRIG_ ENA_ ENA_
                                       SINGL SINGL              SERIE SERIE                   STAR     STAR DAC_   DAC_ CHAN CHAN
                                        E_1   E_0                S_1     S_0                 TUP_1    TUP_0 WR_1   WR_0 _1             _0
 R85 (55h) DC Servo (2)          0  0    0     0               DCS_SERIES_NO_01 [6:0]                    0  DCS_TIMER_PERIOD_01 [3:0]      054Ah
 R87 (57h) DC Servo (4)                 DCS_DAC_WR_VAL_1 [7:0]                                  DCS_DAC_WR_VAL_0 [7:0]                     0000h
 R88 (58h) DC Servo              0  0    0     0    0      0    DCS_CAL_CO       0      0    DCS_DAC_WR        0      0    DCS_STARTU      0000h
           Readback                                              MPLETE [1:0]                  _COMPLETE                   P_COMPLETE
                                                                                                   [1:0]                         [1:0]
 R96 (60h) Analogue HP (1)       0  0    0     0    0      0      0       0   HPOU HPOU HPOU             0  HPOU HPOU HPOU              0  0000h
                                                                              T1L_R T1L_O T1L_D             T1R_R T1R_O T1R_D
                                                                              MV_S UTP          LY          MV_S UTP          LY
                                                                              HORT                          HORT
                                                                                                                    PP, March 2014, Rev 3.5
w
                                                                                                                                              253


WM8958                                                                                                                                     Pre-Production
   REG              NAME        15    14    13     12      11     10      9       8     7        6       5      4        3       2      1      0  DEFAULT
R208 (D0h) Mic Detect 1       MICD_BIAS_STARTTIME [3:0]        MICD_RATE [3:0]          0        0      0       0       0       0    MICD_ MICD_   5600h
                                                                                                                                     DBTIM ENA
                                                                                                                                       E
R209 (D1h) Mic Detect 2         0     0     0      0       0      0       0       0                        MICD_LVL_SEL [7:0]                      007Fh
R210 (D2h) Mic Detect 3         0     0     0      0       0                              MICD_LVL [8:0]                             MICD_ MICD_   0000h
                                                                                                                                     VALID STS
R256 (100h) Chip Revision       0     0     0      0       0      0       0       0     0        0      0       0            CHIP_REV [3:0]        000Xh
R257 (101h) Control Interface   1     0     0      0       0      0       0       0     0        0      0       0       0     AUTO      0      0   8004h
                                                                                                                              _INC
R272 (110h) Write Sequencer   WSEQ    0     0      0       0      0    WSEQ WSEQ        0                  WSEQ_START_INDEX [6:0]                  0000h
            Ctrl (1)          _ENA                                      _ABO _STAR
                                                                         RT       T
R273 (111h) Write Sequencer     0     0     0      0       0      0       0     WSEQ    0                 WSEQ_CURRENT_INDEX [6:0]                 0000h
            Ctrl (2)                                                            _BUS
                                                                                  Y
R512 (200h) AIF1 Clocking (1)   0     0     0      0       0      0       0       0     0        0      0    AIF1CLK_SRC AIF1C AIF1C AIF1C         0000h
                                                                                                                  [1:0]       LK_IN LK_DI LK_EN
                                                                                                                                V      V       A
R513 (201h) AIF1 Clocking (2)   0     0     0      0       0      0       0       0     0        0     AIF1DAC_DIV [2:0]        AIF1ADC_DIV [2:0]  0000h
R516 (204h) AIF2 Clocking (1)   0     0     0      0       0      0       0       0     0        0      0    AIF2CLK_SRC AIF2C AIF2C AIF2C         0000h
                                                                                                                  [1:0]       LK_IN LK_DI LK_EN
                                                                                                                                V      V       A
R517 (205h) AIF2 Clocking (2)   0     0     0      0       0      0       0       0     0        0     AIF2DAC_DIV [2:0]        AIF2ADC_DIV [2:0]  0000h
R520 (208h) Clocking (1)        0   DSP2    0      0       0      0       0       0     0        0      0     TOCL AIF1D AIF2D SYSD SYSC           0000h
                                    CLK_E                                                                     K_EN SPCL SPCL SPCL LK_SR
                                     NA                                                                         A     K_EN K_EN K_EN           C
                                                                                                                        A       A      A
R521 (209h) Clocking (2)        0     0     0      0       0       TOCLK_DIV [2:0]      0        DBCLK_DIV [2:0]        0        OPCLK_DIV [2:0]   0000h
R528 (210h) AIF1 Rate           0     0     0      0       0      0       0       0            AIF1_SR [3:0]               AIF1CLK_RATE [3:0]      0083h
R529 (211h) AIF2 Rate           0     0     0      0       0      0       0       0            AIF2_SR [3:0]               AIF2CLK_RATE [3:0]      0083h
R530 (212h) Rate Status         0     0     0      0       0      0       0       0     0        0      0       0            SR_ERROR [3:0]        0000h
R544 (220h) FLL1 Control (1)    0     0     0      0       0      0       0       0     0        0      0       0       0       0    FLL1_ FLL1_   0000h
                                                                                                                                     OSC_ ENA
                                                                                                                                      ENA
R545 (221h) FLL1 Control (2)    0     0                FLL1_OUTDIV [5:0]                0        0      0       0       0      FLL1_FRATIO [2:0]   0000h
R546 (222h) FLL1 Control (3)                                                  FLL1_THETA [15:0]                                                    0000h
R547 (223h) FLL1 Control (4)    0                                FLL1_N [9:0]                                   0       0       0       0      0   0000h
R548 (224h) FLL1 Control (5)  FLL1_   0     0              FLL1_FRC_NCO_VAL [5:0]             FLL1_     0    FLL1_REFCLK        0    FLL1_REFCLK   0C80h
                               BYP                                                             FRC_             _DIV [1:0]             _SRC [1:0]
                                                                                                NCO
R550 (226h) FLL1 EFS1                                                       FLL2_LAMBDA [15:0]                                                     0000h
R551 (227h) FLL1 EFS2           0     0     0      0       0      0       0       0     0        0      0       0       0       1       1   FLL1_  0006h
                                                                                                                                            EFS_E
                                                                                                                                              NA
R576 (240h) FLL2 Control (1)    0     0     0      0       0      0       0       0     0        0      0       0       0       0    FLL2_ FLL2_   0000h
                                                                                                                                     OSC_ ENA
                                                                                                                                      ENA
R577 (241h) FLL2 Control (2)    0     0                FLL2_OUTDIV [5:0]                0        0      0       0       0      FLL2_FRATIO [2:0]   0000h
R578 (242h) FLL2 Control (3)                                                  FLL2_THETA [15:0]                                                    0000h
R579 (243h) FLL2 Control (4)    0                                FLL2_N [9:0]                                   0       0       0       0      0   0000h
R580 (244h) FLL2 Control (5)  FLL2_   0     0              FLL2_FRC_NCO_VAL [5:0]             FLL2_     0    FLL2_REFCLK        0    FLL2_REFCLK   0C80h
                               BYP                                                             FRC_             _DIV [1:0]             _SRC [1:0]
                                                                                                NCO
R582 (246h) FLL2 EFS1                                                       FLL2_LAMBDA [15:0]                                                     0000h
R583 (247h) FLL2 EFS2           0     0     0      0       0      0       0       0     0        0      0       0       0       1       1   FLL2_  0006h
                                                                                                                                            EFS_E
                                                                                                                                              NA
                                                                                                                               PP, March 2014, Rev 3.5
w
                                                                                                                                                      254


Pre-Production                                                                                                               WM8958
    REG            NAME          15    14    13    12     11       10 9    8     7     6       5      4      3     2      1     0  DEFAULT
 R768 (300h) AIF1 Control (1)  AIF1A AIF1A AIF1A    0      0       0  0 AIF1_    0   AIF1_WL [1:0] AIF1_FMT [1:0]  0     0     0    4050h
                               DCL_S DCR_ DC_T                          BCLK_
                                RC    SRC   DM                           INV
 R769 (301h) AIF1 Control (2)  AIF1D AIF1D   0      0   AIF1DAC_BOO   0 AIF1_    0     0       0   AIF1D AIF1D AIF1A AIF1A AIF1_L   4000h
                               ACL_S ACR_                   ST [1:0]    MONO                       AC_C AC_C DC_C DC_C OOPB
                                RC    SRC                                                           OMP OMPM OMP OMPM ACK
                                                                                                          ODE           ODE
 R770 (302h) AIF1 Master/Slave AIF1_ AIF1_ AIF1_ AIF1_L    0       0  0   0      0     0       0      0     0      0     0     0    0000h
                                TRI MSTR CLK_F RCLK_
                                            RC    FRC
 R771 (303h) AIF1 BCLK           0     0     0      0      0       0  0        AIF1_BCLK_DIV [4:0]          0      0     0     0    0040h
 R772 (304h) AIF1ADC LRCLK       0     0     0   AIF1A AIF1A                         AIF1ADC_RATE [10:0]                            0040h
                                                 DC_LR DC_LR
                                                 CLK_I CLK_D
                                                   NV     IR
 R773 (305h) AIF1DAC LRCLK       0     0     0   AIF1D AIF1D                         AIF1DAC_RATE [10:0]                            0040h
                                                 AC_LR AC_LR
                                                 CLK_I CLK_D
                                                   NV     IR
 R774 (306h) AIF1DAC Data        0     0     0      0      0       0  0   0      0     0       0      0     0      0   AIF1D AIF1D  0000h
                                                                                                                       ACL_D ACR_
                                                                                                                       AT_IN DAT_I
                                                                                                                         V    NV
 R775 (307h) AIF1ADC Data        0     0     0      0      0       0  0   0      0     0       0      0     0      0   AIF1A AIF1A  0000h
                                                                                                                      DCL_D DCR_
                                                                                                                       AT_IN DAT_I
                                                                                                                         V    NV
 R784 (310h) AIF2 Control (1)  AIF2A AIF2A AIF2A AIF2A     0       0  0 AIF2_    0   AIF2_WL [1:0] AIF2_FMT [1:0]  0   AIF2T AIF2T  4053h
                               DCL_S DCR_ DC_T DC_T                     BCLK_                                          XL_EN XR_E
                                RC    SRC   DM DM_C                      INV                                             A    NA
                                                  HAN
 R785 (311h) AIF2 Control (2)  AIF2D AIF2D AIF2D AIF2D AIF2DAC_BOO    0 AIF2_    0     0       0   AIF2D AIF2D AIF2A AIF2A AIF2_L   4000h
                               ACL_S ACR_ AC_T AC_T         ST [1:0]    MONO                       AC_C AC_C DC_C DC_C OOPB
                                RC    SRC   DM DM_C                                                 OMP OMPM OMP OMPM ACK
                                                  HAN                                                     ODE           ODE
 R786 (312h) AIF2 Master/Slave AIF2_ AIF2_ AIF2_ AIF2_L    0       0  0   0      0     0       0      0     0      0     0     0    0000h
                                TRI MSTR CLK_F RCLK_
                                            RC    FRC
 R787 (313h) AIF2 BCLK           0     0     0      0      0       0  0        AIF2_BCLK_DIV [4:0]          0      0     0     0    0040h
 R788 (314h) AIF2ADC LRCLK       0     0     0   AIF2A AIF2A                         AIF2ADC_RATE [10:0]                            0040h
                                                 DC_LR DC_LR
                                                 CLK_I CLK_D
                                                   NV     IR
 R789 (315h) AIF2DAC LRCLK       0     0     0   AIF2D AIF2D                         AIF2DAC_RATE [10:0]                            0040h
                                                 AC_LR AC_LR
                                                 CLK_I CLK_D
                                                   NV     IR
 R790 (316h) AIF2DAC Data        0     0     0      0      0       0  0   0      0     0       0      0     0      0   AIF2D AIF2D  0000h
                                                                                                                       ACL_D ACR_
                                                                                                                       AT_IN DAT_I
                                                                                                                         V    NV
 R791 (317h) AIF2ADC Data        0     0     0      0      0       0  0   0      0     0       0      0     0      0   AIF2A AIF2A  0000h
                                                                                                                      DCL_D DCR_
                                                                                                                       AT_IN DAT_I
                                                                                                                         V    NV
 R800 (320h) AIF3 Control (1)    0     0     0      0      0       0  0   0   AIF3_L AIF3_WL [1:0]    0     0      0     0     0    0040h
                                                                              RCLK_
                                                                               INV
                                                                                                                  PP, March 2014, Rev 3.5
w
                                                                                                                                      255


WM8958                                                                                                                       Pre-Production
   REG             NAME          15    14     13     12    11       10      9     8     7  6    5        4     3      2   1      0   DEFAULT
R801 (321h) AIF3 Control (2)     0     0      0       0  AIF3DAC_BOO       0     0     0   0   0      AIF3D AIF3D AIF3A AIF3A AIF3_L  0000h
                                                             ST [1:0]                                 AC_C AC_C DC_C DC_C OOPB
                                                                                                      OMP OMPM OMP OMPM ACK
                                                                                                             ODE         ODE
R802 (322h) AIF3DAC Data         0     0      0       0     0       0      0     0     0   0   0        0     0       0   0   AIF3D   0000h
                                                                                                                              AC_D
                                                                                                                              AT_IN
                                                                                                                                 V
R803 (323h) AIF3ADC Data         0     0      0       0     0       0      0     0     0   0   0        0     0       0   0   AIF3A   0000h
                                                                                                                              DC_D
                                                                                                                              AT_IN
                                                                                                                                 V
R1024 (400h) AIF1 ADC1 Left      0     0      0       0     0       0      0   AIF1A              AIF1ADC1L_VOL [7:0]                 00C0h
             Volume                                                            DC1_V
                                                                                 U
R1025 (401h) AIF1 ADC1 Right     0     0      0       0     0       0      0   AIF1A              AIF1ADC1R_VOL [7:0]                 00C0h
             Volume                                                            DC1_V
                                                                                 U
R1026 (402h) AIF1 DAC1 Left      0     0      0       0     0       0      0   AIF1D              AIF1DAC1L_VOL [7:0]                 00C0h
             Volume                                                            AC1_V
                                                                                 U
R1027 (403h) AIF1 DAC1 Right     0     0      0       0     0       0      0   AIF1D              AIF1DAC1R_VOL [7:0]                 00C0h
             Volume                                                            AC1_V
                                                                                 U
R1028 (404h) AIF1 ADC2 Left      0     0      0       0     0       0      0   AIF1A              AIF1ADC2L_VOL [7:0]                 00C0h
             Volume                                                            DC2_V
                                                                                 U
R1029 (405h) AIF1 ADC2 Right     0     0      0       0     0       0      0   AIF1A              AIF1ADC2R_VOL [7:0]                 00C0h
             Volume                                                            DC2_V
                                                                                 U
R1030 (406h) AIF1 DAC2 Left      0     0      0       0     0       0      0   AIF1D              AIF1DAC2L_VOL [7:0]                 00C0h
             Volume                                                            AC2_V
                                                                                 U
R1031 (407h) AIF1 DAC2 Right     0     0      0       0     0       0      0   AIF1D              AIF1DAC2R_VOL [7:0]                 00C0h
             Volume                                                            AC2_V
                                                                                 U
R1040 (410h) AIF1 ADC1 Filters AIF1A AIF1ADC1_HP AIF1A AIF1A        0      0     0     0   0   0        0     0       0   0      0    0000h
                               DC_4F F_CUT [1:0] DC1L_ DC1R_
                                 S                  HPF HPF
R1041 (411h) AIF1 ADC2 Filters   0   AIF1ADC2_HP AIF1A AIF1A        0      0     0     0   0   0        0     0       0   0      0    0000h
                                      F_CUT [1:0] DC2L_ DC2R_
                                                    HPF HPF
R1056 (420h) AIF1 DAC1 Filters   0     0      0       0     0       0    AIF1D   0   AIF1D 0 AIF1D    AIF1D   0       0   0      0    0200h
             (1)                                                         AC1_        AC1_    AC1_    AC1_U
                                                                         MUTE        MONO    MUTE    NMUT
                                                                                             RATE     E_RA
                                                                                                       MP
R1057 (421h) AIF1 DAC1 Filters   0     0          AIF1DAC1_3D_GAIN [4:0]       AIF1D   0   0   0        1     0       0   0      0    0010h
             (2)                                                               AC1_3
                                                                               D_EN
                                                                                 A
R1058 (422h) AIF1 DAC2 Filters   0     0      0       0     0       0    AIF1D   0   AIF1D 0 AIF1D    AIF1D   0       0   0      0    0200h
             (1)                                                         AC2_        AC2_    AC2_    AC2_U
                                                                         MUTE        MONO    MUTE    NMUT
                                                                                             RATE     E_RA
                                                                                                       MP
R1059 (423h) AIF1 DAC2 Filters   0     0          AIF1DAC2_3D_GAIN [4:0]       AIF1D   0   0   0        1     0       0   0      0    0010h
             (2)                                                               AC2_3
                                                                               D_EN
                                                                                 A
                                                                                                                    PP, March 2014, Rev 3.5
w
                                                                                                                                        256


Pre-Production                                                                                                                                WM8958
   REG             NAME        15     14    13    12       11      10        9      8       7      6       5       4        3     2      1       0  DEFAULT
R1072 (430h) AIF1 DAC1 Noise   0      0     0     0        0       0         0      0       0   AIF1DAC1_NG        0      AIF1DAC1_NG_THR AIF1D      0068h
             Gate                                                                                 _HLD [1:0]                    [2:0]        AC1_N
                                                                                                                                             G_EN
                                                                                                                                                A
R1073 (431h) AIF1 DAC2 Noise   0      0     0     0        0       0         0      0       0   AIF1DAC2_NG        0      AIF1DAC2_NG_THR AIF1D      0068h
             Gate                                                                                 _HLD [1:0]                    [2:0]        AC2_N
                                                                                                                                             G_EN
                                                                                                                                                A
R1088 (440h) AIF1 DRC1 (1)      AIF1DRC1_SIG_DET_RMS [4:0]       AIF1DRC1_SI AIF1D AIF1D AIF1D         AIF1D AIF1D AIF1D AIF1D        AIF1A  AIF1A   0098h
                                                                  G_DET_PK RC1_N RC1_S RC1_S           RC1_K RC1_ RC1_A AC1_D         DC1L_  DC1R_
                                                                      [1:0]       G_EN IG_DE IG_DE     NEE2_ QR NTICLI RC_E           DRC_   DRC_
                                                                                    A     T_MO     T   OP_E                 P    NA    ENA     ENA
                                                                                           DE             NA
R1089 (441h) AIF1 DRC1 (2)     0      0     0        AIF1DRC1_ATK [3:0]                AIF1DRC1_DCY [3:0]        AIF1DRC1_MINGAIN AIF1DRC1_MA        0845h
                                                                                                                          [2:0]         XGAIN [1:0]
R1090 (442h) AIF1 DRC1 (3)   AIF1DRC1_NG_MINGAIN [3:0] AIF1DRC1_NG AIF1DRC1_QR AIF1DRC1_QR AIF1DRC1_HI_COMP AIF1DRC1_LO_COMP                         0000h
                                                           _EXP [1:0]       _THR [1:0]     _DCY [1:0]            [2:0]                 [2:0]
R1091 (443h) AIF1 DRC1 (4)     0      0     0     0        0                 AIF1DRC1_KNEE_IP [5:0]                    AIF1DRC1_KNEE_OP [4:0]        0000h
R1092 (444h) AIF1 DRC1 (5)     0      0     0     0        0       0            AIF1DRC1_KNEE2_IP [4:0]                AIF1DRC1_KNEE2_OP [4:0]       0000h
R1104 (450h) AIF1 DRC2 (1)      AIF1DRC2_SIG_DET_RMS [4:0]       AIF1DRC2_SI AIF1D AIF1D AIF1D         AIF1D AIF1D AIF1D AIF1D        AIF1A  AIF1A   0098h
                                                                  G_DET_PK RC2_N RC2_S RC2_S           RC2_K RC2_ RC2_A AC2_D         DC2L_  DC2R_
                                                                      [1:0]       G_EN IG_DE IG_DE     NEE2_ QR NTICLI RC_E           DRC_   DRC_
                                                                                    A     T_MO     T   OP_E                 P    NA    ENA     ENA
                                                                                           DE             NA
R1105 (451h) AIF1 DRC2 (2)     0      0     0        AIF1DRC2_ATK [3:0]                AIF1DRC2_DCY [3:0]        AIF1DRC2_MINGAIN AIF1DRC2_MA        0845h
                                                                                                                          [2:0]         XGAIN [1:0]
R1106 (452h) AIF1 DRC2 (3)   AIF1DRC2_NG_MINGAIN [3:0] AIF1DRC2_NG AIF1DRC2_QR AIF1DRC2_QR AIF1DRC2_HI_COMP AIF1DRC2_LO_COMP                         0000h
                                                           _EXP [1:0]       _THR [1:0]     _DCY [1:0]            [2:0]                 [2:0]
R1107 (453h) AIF1 DRC2 (4)     0      0     0     0        0                 AIF1DRC2_KNEE_IP [5:0]                    AIF1DRC2_KNEE_OP [4:0]        0000h
R1108 (454h) AIF1 DRC2 (5)     0      0     0     0        0       0            AIF1DRC2_KNEE2_IP [4:0]                AIF1DRC2_KNEE2_OP [4:0]       0000h
R1152 (480h) AIF1 DAC1 EQ        AIF1DAC1_EQ_B1_GAIN [4:0]            AIF1DAC1_EQ_B2_GAIN [4:0]              AIF1DAC1_EQ_B3_GAIN [4:0]       AIF1D   6318h
             Gains (1)                                                                                                                       AC1_E
                                                                                                                                             Q_EN
                                                                                                                                                A
R1153 (481h) AIF1 DAC1 EQ        AIF1DAC1_EQ_B4_GAIN [4:0]            AIF1DAC1_EQ_B5_GAIN [4:0]            0       0        0     0      0   AIF1D   6300h
             Gains (2)                                                                                                                       AC1_E
                                                                                                                                             Q_MO
                                                                                                                                               DE
R1154 (482h) AIF1 DAC1 EQ                                                   AIF1DAC1_EQ_B1_A [15:0]                                                  0FCAh
             Band 1 A
R1155 (483h) AIF1 DAC1 EQ                                                   AIF1DAC1_EQ_B1_B [15:0]                                                  0400h
             Band 1 B
R1156 (484h) AIF1 DAC1 EQ                                                 AIF1DAC1_EQ_B1_PG [15:0]                                                   00D8h
             Band 1 PG
R1157 (485h) AIF1 DAC1 EQ                                                   AIF1DAC1_EQ_B2_A [15:0]                                                  1EB5h
             Band 2 A
R1158 (486h) AIF1 DAC1 EQ                                                   AIF1DAC1_EQ_B2_B [15:0]                                                  F145h
             Band 2 B
R1159 (487h) AIF1 DAC1 EQ                                                   AIF1DAC1_EQ_B2_C [15:0]                                                  0B75h
             Band 2 C
R1160 (488h) AIF1 DAC1 EQ                                                 AIF1DAC1_EQ_B2_PG [15:0]                                                   01C5h
             Band 2 PG
R1161 (489h) AIF1 DAC1 EQ                                                   AIF1DAC1_EQ_B3_A [15:0]                                                  1C58h
             Band 3 A
R1162 (48Ah) AIF1 DAC1 EQ                                                   AIF1DAC1_EQ_B3_B [15:0]                                                  F373h
             Band 3 B
R1163 (48Bh) AIF1 DAC1 EQ                                                   AIF1DAC1_EQ_B3_C [15:0]                                                  0A54h
             Band 3 C
R1164 (48Ch) AIF1 DAC1 EQ                                                 AIF1DAC1_EQ_B3_PG [15:0]                                                   0558h
             Band 3 PG
                                                                                                                                PP, March 2014, Rev 3.5
w
                                                                                                                                                        257


WM8958                                                                                                                Pre-Production
    REG            NAME   15     14    13    12       11 10      9     8     7       6  5      4     3     2        1     0  DEFAULT
R1165 (48Dh) AIF1 DAC1 EQ                                       AIF1DAC1_EQ_B4_A [15:0]                                       168Eh
             Band 4 A
R1166 (48Eh) AIF1 DAC1 EQ                                       AIF1DAC1_EQ_B4_B [15:0]                                       F829h
             Band 4 B
R1167 (48Fh) AIF1 DAC1 EQ                                       AIF1DAC1_EQ_B4_C [15:0]                                       07ADh
             Band 4 C
R1168 (490h) AIF1 DAC1 EQ                                      AIF1DAC1_EQ_B4_PG [15:0]                                       1103h
             Band 4 PG
R1169 (491h) AIF1 DAC1 EQ                                       AIF1DAC1_EQ_B5_A [15:0]                                       0564h
             Band 5 A
R1170 (492h) AIF1 DAC1 EQ                                       AIF1DAC1_EQ_B5_B [15:0]                                       0559h
             Band 5 B
R1171 (493h) AIF1 DAC1 EQ                                      AIF1DAC1_EQ_B5_PG [15:0]                                       4000h
             Band 5 PG
R1172 (494h) AIF1 DAC1 EQ                                       AIF1DAC1_EQ_B1_C [15:0]                                       0000h
             Band 1 C
R1184 (4A0h) AIF1 DAC2 EQ   AIF1DAC2_EQ_B1_GAIN [4:0]      AIF1DAC2_EQ_B2_GAIN [4:0]      AIF1DAC2_EQ_B3_GAIN [4:0]    AIF1D  6318h
             Gains (1)                                                                                                 AC2_E
                                                                                                                       Q_EN
                                                                                                                         A
R1185 (4A1h) AIF1 DAC2 EQ   AIF1DAC2_EQ_B4_GAIN [4:0]      AIF1DAC2_EQ_B5_GAIN [4:0]    0      0     0     0        0  AIF1D  6300h
             Gains (2)                                                                                                 AC2_E
                                                                                                                       Q_MO
                                                                                                                        DE
R1186 (4A2h) AIF1 DAC2 EQ                                       AIF1DAC2_EQ_B1_A [15:0]                                       0FCAh
             Band 1 A
R1187 (4A3h) AIF1 DAC2 EQ                                       AIF1DAC2_EQ_B1_B [15:0]                                       0400h
             Band 1 B
R1188 (4A4h) AIF1 DAC2 EQ                                      AIF1DAC2_EQ_B1_PG [15:0]                                       00D8h
             Band 1 PG
R1189 (4A5h) AIF1 DAC2 EQ                                       AIF1DAC2_EQ_B2_A [15:0]                                       1EB5h
             Band 2 A
R1190 (4A6h) AIF1 DAC2 EQ                                       AIF1DAC2_EQ_B2_B [15:0]                                       F145h
             Band 2 B
R1191 (4A7h) AIF1 DAC2 EQ                                       AIF1DAC2_EQ_B2_C [15:0]                                       0B75h
             Band 2 C
R1192 (4A8h) AIF1 DAC2 EQ                                      AIF1DAC2_EQ_B2_PG [15:0]                                       01C5h
             Band 2 PG
R1193 (4A9h) AIF1 DAC2 EQ                                       AIF1DAC2_EQ_B3_A [15:0]                                       1C58h
             Band 3 A
R1194 (4AAh) AIF1 DAC2 EQ                                       AIF1DAC2_EQ_B3_B [15:0]                                       F373h
             Band 3 B
R1195 (4ABh) AIF1 DAC2 EQ                                       AIF1DAC2_EQ_B3_C [15:0]                                       0A54h
             Band 3 C
R1196 (4ACh) AIF1 DAC2 EQ                                      AIF1DAC2_EQ_B3_PG [15:0]                                       0558h
             Band 3 PG
R1197 (4ADh) AIF1 DAC2 EQ                                       AIF1DAC2_EQ_B4_A [15:0]                                       168Eh
             Band 4 A
R1198 (4AEh) AIF1 DAC2 EQ                                       AIF1DAC2_EQ_B4_B [15:0]                                       F829h
             Band 4 B
R1199 (4AFh) AIF1 DAC2 EQ                                       AIF1DAC2_EQ_B4_C [15:0]                                       07ADh
             Band 4 C
R1200 (4B0h) AIF1 DAC2 EQ                                      AIF1DAC2_EQ_B4_PG [15:0]                                       1103h
             Band 4 PG
R1201 (4B1h) AIF1 DAC2 EQ                                       AIF1DAC2_EQ_B5_A [15:0]                                       0564h
             Band 5 A
R1202 (4B2h) AIF1 DAC2 EQ                                       AIF1DAC2_EQ_B5_B [15:0]                                       0559h
             Band 5 B
                                                                                                          PP, March 2014, Rev 3.5
w
                                                                                                                                 258


Pre-Production                                                                                                                                  WM8958
   REG             NAME         15      14      13    12     11     10       9       8       7      6       5       4        3      2      1      0  DEFAULT
R1203 (4B3h) AIF1 DAC2 EQ                                                  AIF1DAC2_EQ_B5_PG [15:0]                                                   4000h
             Band 5 PG
R1204 (4B4h) AIF1 DAC2 EQ                                                   AIF1DAC2_EQ_B1_C [15:0]                                                   0000h
             Band 1 C
R1280 (500h) AIF2 ADC Left      0       0       0     0      0       0       0    AIF2A                       AIF2ADCL_VOL [7:0]                      00C0h
             Volume                                                               DC_V
                                                                                    U
R1281 (501h) AIF2 ADC Right     0       0       0     0      0       0       0    AIF2A                       AIF2ADCR_VOL [7:0]                      00C0h
             Volume                                                               DC_V
                                                                                    U
R1282 (502h) AIF2 DAC Left      0       0       0     0      0       0       0    AIF2D                       AIF2DACL_VOL [7:0]                      00C0h
             Volume                                                               AC_V
                                                                                    U
R1283 (503h) AIF2 DAC Right     0       0       0     0      0       0       0    AIF2D                       AIF2DACR_VOL [7:0]                      00C0h
             Volume                                                               AC_V
                                                                                    U
R1296 (510h) AIF2 ADC Filters   0     AIF2ADC_HPF AIF2A AIF2A        0       0       0      0      0        0       0        0      0      0      0   0000h
                                        _CUT [1:0] DCL_H DCR_
                                                     PF     HPF
R1312 (520h) AIF2 DAC Filters   0       0       0     0      0       0    AIF2D      0    AIF2D    0     AIF2D   AIF2D       0      0      0      0   0200h
             (1)                                                          AC_M            AC_M           AC_M    AC_U
                                                                           UTE            ONO            UTER    NMUT
                                                                                                          ATE    E_RA
                                                                                                                   MP
R1313 (521h) AIF2 DAC Filters   0       0          AIF2DAC_3D_GAIN [4:0]          AIF2D     0      0        0       1        0      0      0      0   0010h
             (2)                                                                 AC_3D
                                                                                  _ENA
R1328 (531h) AIF2 DAC Noise     0       0       0     0      0       0       0       0      0   AIF2DAC_NG_         0       AIF2DAC_NG_THR     AIF2D  0068h
             Gate                                                                                   HLD [1:0]                     [2:0]         AC_N
                                                                                                                                               G_EN
                                                                                                                                                  A
R1344 (540h) AIF2 DRC (1)         AIF2DRC_SIG_DET_RMS [4:0]       AIF2DRC_SIG AIF2D AIF2D AIF2D AIF2D AIF2D AIF2D AIF2D AIF2A AIF2A                   0098h
                                                                  _DET_PK [1:0] RC_N RC_SI RC_SI RC_K RC_Q RC_A AC_D DCL_D DCR_
                                                                                  G_EN G_DE G_DE NEE2_ R NTICLI RC_E RC_E DRC_
                                                                                    A     T_MO     T     OP_E                P     NA     NA    ENA
                                                                                           DE              NA
R1345 (541h) AIF2 DRC (2)       0       0       0        AIF2DRC_ATK [3:0]             AIF2DRC_DCY [3:0]           AIF2DRC_MINGAIN      AIF2DRC_MAX   0845h
                                                                                                                           [2:0]          GAIN [1:0]
R1346 (542h) AIF2 DRC (3)      AIF2DRC_NG_MINGAIN [3:0] AIF2DRC_NG_ AIF2DRC_QR_ AIF2DRC_QR_               AIF2DRC_HI_COMP         AIF2DRC_LO_COMP     0000h
                                                             EXP [1:0]       THR [1:0]      DCY [1:0]             [2:0]                  [2:0]
R1347 (543h) AIF2 DRC (4)       0       0       0     0      0               AIF2DRC_KNEE_IP [5:0]                      AIF2DRC_KNEE_OP [4:0]         0000h
R1348 (544h) AIF2 DRC (5)       0       0       0     0      0       0          AIF2DRC_KNEE2_IP [4:0]                  AIF2DRC_KNEE2_OP [4:0]        0000h
R1408 (580h) AIF2 EQ Gains (1)     AIF2DAC_EQ_B1_GAIN [4:0]            AIF2DAC_EQ_B2_GAIN [4:0]               AIF2DAC_EQ_B3_GAIN [4:0]         AIF2D  6318h
                                                                                                                                                AC_E
                                                                                                                                               Q_EN
                                                                                                                                                  A
R1409 (581h) AIF2 EQ Gains (2)     AIF2DAC_EQ_B4_GAIN [4:0]            AIF2DAC_EQ_B5_GAIN [4:0]             0       0        0      0      0   AIF2D  6300h
                                                                                                                                                AC_E
                                                                                                                                               Q_MO
                                                                                                                                                 DE
R1410 (582h) AIF2 EQ Band 1 A                                               AIF2DAC_EQ_B1_A [15:0]                                                    0FCAh
R1411 (583h) AIF2 EQ Band 1 B                                               AIF2DAC_EQ_B1_B [15:0]                                                    0400h
R1412 (584h) AIF2 EQ Band 1                                                AIF2DAC_EQ_B1_PG [15:0]                                                    00D8h
             PG
R1413 (585h) AIF2 EQ Band 2 A                                               AIF2DAC_EQ_B2_A [15:0]                                                    1EB5h
R1414 (586h) AIF2 EQ Band 2 B                                               AIF2DAC_EQ_B2_B [15:0]                                                    F145h
R1415 (587h) AIF2 EQ Band 2 C                                               AIF2DAC_EQ_B2_C [15:0]                                                    0B75h
R1416 (588h) AIF2 EQ Band 2                                                AIF2DAC_EQ_B2_PG [15:0]                                                    01C5h
             PG
R1417 (589h) AIF2 EQ Band 3 A                                               AIF2DAC_EQ_B3_A [15:0]                                                    1C58h
                                                                                                                                  PP, March 2014, Rev 3.5
w
                                                                                                                                                         259


WM8958                                                                                                      Pre-Production
   REG             NAME       15 14 13 12 11 10   9      8     7       6      5    4     3         2     1      0  DEFAULT
R1418 (58Ah) AIF2 EQ Band 3 B                     AIF2DAC_EQ_B3_B [15:0]                                            F373h
R1419 (58Bh) AIF2 EQ Band 3 C                     AIF2DAC_EQ_B3_C [15:0]                                            0A54h
R1420 (58Ch) AIF2 EQ Band 3                      AIF2DAC_EQ_B3_PG [15:0]                                            0558h
             PG
R1421 (58Dh) AIF2 EQ Band 4 A                     AIF2DAC_EQ_B4_A [15:0]                                            168Eh
R1422 (58Eh) AIF2 EQ Band 4 B                     AIF2DAC_EQ_B4_B [15:0]                                            F829h
R1423 (58Fh) AIF2 EQ Band 4 C                     AIF2DAC_EQ_B4_C [15:0]                                            07ADh
R1424 (590h) AIF2 EQ Band 4                      AIF2DAC_EQ_B4_PG [15:0]                                            1103h
             PG
R1425 (591h) AIF2 EQ Band 5 A                     AIF2DAC_EQ_B5_A [15:0]                                            0564h
R1426 (592h) AIF2 EQ Band 5 B                     AIF2DAC_EQ_B5_B [15:0]                                            0559h
R1427 (593h) AIF2 EQ Band 5                      AIF2DAC_EQ_B5_PG [15:0]                                            4000h
             PG
R1428 (594h) AIF2 EQ Band 1 C                     AIF2DAC_EQ_B1_C [15:0]                                            0000h
R1536 (600h) DAC1 Mixer       0  0  0  0  0  0    0       ADCR_DAC1_VOL [3:0]      0      ADCL_DAC1_VOL [3:0]       0000h
             Volumes
R1537 (601h) DAC1 Left Mixer  0  0  0  0  0  0    0      0     0      0   ADCR ADCL_     0      AIF2D AIF1D  AIF1D  0000h
             Routing                                                      _TO_D TO_D            ACL_T AC2L_  AC1L_
                                                                           AC1L AC1L            O_DA  TO_D   TO_D
                                                                                                 C1L   AC1L   AC1L
R1538 (602h) DAC1 Right Mixer 0  0  0  0  0  0    0      0     0      0   ADCR ADCL_     0      AIF2D AIF1D  AIF1D  0000h
             Routing                                                      _TO_D TO_D            ACR_  AC2R_  AC1R_
                                                                           AC1R AC1R            TO_D  TO_D   TO_D
                                                                                                AC1R  AC1R    AC1R
R1539 (603h) DAC2 Mixer       0  0  0  0  0  0    0       ADCR_DAC2_VOL [3:0]      0      ADCL_DAC2_VOL [3:0]       0000h
             Volumes
R1540 (604h) DAC2 Left Mixer  0  0  0  0  0  0    0      0     0      0   ADCR ADCL_     0      AIF2D AIF1D  AIF1D  0000h
             Routing                                                      _TO_D TO_D            ACL_T AC2L_  AC1L_
                                                                           AC2L AC2L            O_DA  TO_D   TO_D
                                                                                                 C2L   AC2L   AC2L
R1541 (605h) DAC2 Right Mixer 0  0  0  0  0  0    0      0     0      0   ADCR ADCL_     0      AIF2D AIF1D  AIF1D  0000h
             Routing                                                      _TO_D TO_D            ACR_  AC2R_  AC1R_
                                                                           AC2R AC2R            TO_D  TO_D   TO_D
                                                                                                AC2R  AC2R    AC2R
R1542 (606h) AIF1 ADC1 Left   0  0  0  0  0  0    0      0     0      0      0     0     0        0   ADC1L  AIF2D  0000h
             Mixer Routing                                                                            _TO_A  ACL_T
                                                                                                      IF1AD  O_AIF
                                                                                                        C1L  1ADC1
                                                                                                                L
R1543 (607h) AIF1 ADC1 Right  0  0  0  0  0  0    0      0     0      0      0     0     0        0   ADC1   AIF2D  0000h
             Mixer Routing                                                                            R_TO_   ACR_
                                                                                                      AIF1A  TO_AI
                                                                                                      DC1R    F1AD
                                                                                                               C1R
R1544 (608h) AIF1 ADC2 Left   0  0  0  0  0  0    0      0     0      0      0     0     0        0   ADC2L  AIF2D  0000h
             Mixer Routing                                                                            _TO_A  ACL_T
                                                                                                      IF1AD  O_AIF
                                                                                                        C2L  1ADC2
                                                                                                                L
R1545 (609h) AIF1 ADC2 Right  0  0  0  0  0  0    0      0     0      0      0     0     0        0   ADC2   AIF2D  0000h
             mixer Routing                                                                            R_TO_   ACR_
                                                                                                      AIF1A  TO_AI
                                                                                                      DC2R    F1AD
                                                                                                               C2R
R1552 (610h) DAC1 Left Volume 0  0  0  0  0  0  DAC1L DAC1_                     DAC1L_VOL [7:0]                     02C0h
                                                _MUT VU
                                                  E
R1553 (611h) DAC1 Right       0  0  0  0  0  0  DAC1 DAC1_                      DAC1R_VOL [7:0]                     02C0h
             Volume                             R_MU VU
                                                 TE
                                                                                                 PP, March 2014, Rev 3.5
w
                                                                                                                       260


Pre-Production                                                                                                                WM8958
   REG              NAME          15    14    13   12    11    10     9     8       7    6     5     4     3       2       1    0  DEFAULT
R1554 (612h) DAC2 Left Volume     0      0    0     0    0      0  DAC2L DAC2_                    DAC2L_VOL [7:0]                   02C0h
                                                                    _MUT VU
                                                                      E
R1555 (613h) DAC2 Right           0      0    0     0    0      0   DAC2 DAC2_                   DAC2R_VOL [7:0]                    02C0h
             Volume                                                R_MU VU
                                                                     TE
R1556 (614h) DAC Softmute         0      0    0     0    0      0     0     0      0     0    0      0     0       0    DAC_ DAC_   0000h
                                                                                                                        SOFT MUTE
                                                                                                                       MUTE RATE
                                                                                                                       MODE
R1568 (620h) Oversampling         0      0    0     0    0      0     0     0      0     0    0      0     0       0    ADC_ DAC_   0002h
                                                                                                                        OSR1 OSR1
                                                                                                                          28   28
R1569 (621h) Sidetone             0      0    0     0    0      0    ST_HPF_CUT [2:0] ST_HP   0      0     0       0   STR_S STL_S  0000h
                                                                                        F                                 EL   EL
R1792 (700h) GPIO 1             GP1_ GP1_P GP1_P    0    0   GP1_P GP1_ GP1_       0  GP1_L   0              GP1_FN [4:0]           8100h
                                 DIR     U    D                OL OP_C DB               VL
                                                                     FG
R1793 (701h) Pull Control         1   MCLK MCLK     0    0      0     0     1      0     0    0      0     0       0       0    1   A101h
             (MCLK2)                   2_PU 2_PD
R1794 (702h) Pull Control         1   BCLK2 BCLK2   0    0      0     0     1      0     0    0      0     0       0       0    1   A101h
             (BCLK2)                   _PU _PD
R1795 (703h) Pull Control         1   DACL DACL     0    0      0     0     1      0    0     0      0     0       0       0    1   A101h
             (DACLRCLK2)              RCLK2 RCLK2
                                       _PU _PD
R1796 (704h) Pull Control         1   DACD DACD     0    0      0     0     1      0    0     0      0     0       0       0    1   A101h
             (DACDAT2)                AT2_P AT2_P
                                         U    D
R1797 (705h) GPIO 6             GP6_ GP6_P GP6_P    0    0   GP6_P GP6_ GP6_       0  GP6_L   0              GP6_FN [4:0]           A101h
                                 DIR     U    D                OL OP_C DB               VL
                                                                     FG
R1799 (707h) GPIO 8             GP8_ GP8_P GP8_P    0    0   GP8_P GP8_ GP8_       0  GP8_L   0              GP8_FN [4:0]           A101h
                                 DIR     U    D                OL OP_C DB               VL
                                                                     FG
R1800 (708h) GPIO 9             GP9_ GP9_P GP9_P    0    0   GP9_P GP9_ GP9_       0  GP9_L   0              GP9_FN [4:0]           A101h
                                 DIR     U    D                OL OP_C DB               VL
                                                                     FG
R1801 (709h) GPIO 10            GP10_ GP10_ GP10_   0    0   GP10_ GP10_ GP10_     0  GP10_   0              GP10_FN [4:0]          A101h
                                 DIR    PU   PD               POL OP_C DB              LVL
                                                                     FG
R1802 (70Ah) GPIO 11            GP11_ GP11_ GP11_   0    0   GP11_ GP11_ GP11_     0  GP11_   0              GP11_FN [4:0]          A101h
                                 DIR    PU   PD               POL OP_C DB              LVL
                                                                     FG
R1824 (720h) Pull Control (1)     0      0    0     0  DMIC DMIC DMIC DMIC MCLK MCLK DACD DACD DACL DACL BCLK1 BCLK1                0000h
                                                       DAT2_ DAT2_ DAT1_ DAT1_ 1_PU 1_PD AT1_P AT1_P RCLK1 RCLK1 _PU _PD
                                                        PU     PD    PU    PD                 U      D    _PU _PD
R1825 (721h) Pull Control (2)     0      0    0     0    0      0     0   ADDR     0  LDO2    0    LDO1    0       1   SPKM     0   0156h
                                                                           _PD        ENA_         ENA_                 ODE_
                                                                                       PD           PD                    PU
R1840 (730h) Interrupt Status 1   0      0    0     0    0   GP11_ GP10_ GP9_E GP8_E     0  GP6_E    0     0       0       0 GP1_E  0000h
                                                              EINT EINT INT       INT        INT                              INT
R1841 (731h) Interrupt Status 2 TEMP DCS_ WSEQ FIFOS AIF2D AIF1D AIF1D SRC2_ SRC1_ FLL2_ FLL1_       0     0       0   MICD_ TEMP   0000h
                                _WAR DONE _DON _ERR_ RC_SI RC2_S RC1_S LOCK LOCK LOCK LOCK                              EINT _SHU
                                N_EIN _EINT E_EIN EINT G_DE IG_DE IG_DE _EINT _EINT _EINT _EINT                              T_EIN
                                  T           T        T_EIN T_EIN T_EIN                                                       T
                                                         T      T     T
R1842 (732h) Interrupt Raw      TEMP DCS_ WSEQ FIFOS AIF2D AIF1D   AIF1D SRC2_ SRC1_ FLL2_ FLL1_     0     0       0       0 TEMP   0000h
             Status 2           _WAR DONE _DON _ERR_ RC_SI RC2_S   RC1_S LOCK LOCK LOCK LOCK                                 _SHU
                                N_STS _STS E_STS STS G_DE IG_DE    IG_DE _STS _STS _STS _STS                                 T_STS
                                                       T_STS T_STS T_STS
                                                                                                                  PP, March 2014, Rev 3.5
w
                                                                                                                                      261


WM8958                                                                                                                                  Pre-Production
    REG             NAME          15    14    13   12     11      10         9       8     7       6      5     4      3       2      1      0  DEFAULT
R1848 (738h) Interrupt Status 1    0     0    0    0       0   IM_GP IM_GP IM_GP IM_GP             1   IM_GP    1      1       1      1  IM_GP   07FFh
             Mask                                               11_EI 10_EI 9_EIN 8_EIN                 6_EIN                             1_EIN
                                                                 NT        NT       T      T              T                                  T
R1849 (739h) Interrupt Status 2 IM_TE IM_DC IM_W IM_FIF IM_AIF IM_AIF   IM_AIF IM_SR IM_SR IM_FL IM_FL          1      1       1   IM_MI IM_TE   FFFFh
             Mask               MP_W S_DO SEQ_ OS_E 2DRC_      1DRC2    1DRC1 C2_LO C1_LO L2_LO L1_LO                              CD_EI MP_S
                                 ARN_ NE_EI DONE RR_EI SIG_D    _SIG_    _SIG_ CK_EI CK_EI CK_EI CK_EI                               NT HUT_
                                 EINT   NT _EINT NT ET_EI      DET_E    DET_E NT          NT      NT     NT                                EINT
                                                          NT     INT       INT
R1856 (740h) Interrupt Control     0     0    0    0       0      0         0        0     0       0      0     0      0       0      0   IM_IR  0000h
                                                                                                                                            Q
R1864 (748h) IRQ Debounce          0     0    0    0       0      0         0        0     0       0    TEMP    1      1       1      1   TEMP   003Fh
                                                                                                       _WAR                               _SHU
                                                                                                        N_DB                              T_DB
R2304 (900h) DSP2_Program          0     0    0    1       1      1         0        0     0       0      0     0      0       0      0  DSP2_   1C00h
                                                                                                                                           ENA
R2305 (901h) DSP2_Config           0     0    0    0       0      0         0        0     0       0   MBC_SEL [1:0]   0       0      0   MBC_   0000h
                                                                                                                                           ENA
R2573 (A0Dh) DSP2_ExecControl      0     0    0    0       0      0         0        0     0       0      0     0      0    DSP2_ DSP2_      0   0000h
                                                                                                                            STOP RUNR
  R12288     Write Sequencer 0     0     0                                             WSEQ_ADDR0 [13:0]                                         0039h
  (3000h)
  R12289     Write Sequencer 1     0     0    0    0       0      0         0        0                       WSEQ_DATA0 [7:0]                    001Bh
  (3001h)
  R12290     Write Sequencer 2     0     0    0    0       0   WSEQ_DATA_WIDTH0            0       0      0     0     WSEQ_DATA_START0 [3:0]     0402h
  (3002h)                                                                 [2:0]
  R12291     Write Sequencer 3     0     0    0    0       0      0         0     WSEQ     0       0      0     0        WSEQ_DELAY0 [3:0]       0000h
  (3003h)                                                                         _EOS0
  R12292     Write Sequencer 4     0     0                                             WSEQ_ADDR1 [13:0]                                         0001h
  (3004h)
  R12293     Write Sequencer 5     0     0    0    0       0      0         0        0                       WSEQ_DATA1 [7:0]                    0003h
  (3005h)
  R12294     Write Sequencer 6     0     0    0    0       0   WSEQ_DATA_WIDTH1            0       0      0     0     WSEQ_DATA_START1 [3:0]     0200h
  (3006h)                                                                 [2:0]
  R12295     Write Sequencer 7     0     0    0    0       0      0         0     WSEQ     0       0      0     0        WSEQ_DELAY1 [3:0]       0009h
  (3007h)                                                                         _EOS1
                                                                                                                                                 004Ch
                                                                      [similar for WSEQ address 2 … 126]                                         0001h
                                                                                                                                                 0006h
  R12796     Write Sequencer       0     0                                            WSEQ_ADDR127 [13:0]                                        0000h
  (31FCh)    508
  R12797     Write Sequencer       0     0    0    0       0      0         0        0                      WSEQ_DATA127 [7:0]                   0000h
  (31FDh)    509
  R12798     Write Sequencer       0     0    0    0       0   WSEQ_DATA_WIDTH1            0       0      0     0    WSEQ_DATA_START127 [3:0]    0000h
  (31FEh)    510                                                        27 [2:0]
  R12799     Write Sequencer       0     0    0    0       0      0         0     WSEQ     0       0      0     0       WSEQ_DELAY127 [3:0]      0000h
  (31FFh)    511                                                                  _EOS1
                                                                                    27
                                                                                                                              PP, March 2014, Rev 3.5
w
                                                                                                                                                    262


Pre-Production                                                                                                    WM8958
REGISTER BITS BY ADDRESS
 REGISTER        BIT        LABEL      DEFAULT                            DESCRIPTION                               REFER TO
 ADDRESS
  R0 (00h)      15:0     SW_RESET      0000_0000 Writing to this register resets all registers to their default
  Software                   [15:0]    _0000_000 state. (Note - Control Write Sequencer registers are not
    Reset                                  0     affected by Software Reset.)
                                                 Reading from this register will indicate device ID 8958h.
Register 00h Software Reset
 REGISTER        BIT        LABEL      DEFAULT                            DESCRIPTION                               REFER TO
 ADDRESS
  R1 (01h)       13    SPKOUTR_ENA         0     SPKMIXR Mixer, SPKRVOL PGA and SPKOUTR Output
   Power                                         Enable
Management                                       0 = Disabled
     (1)                                         1 = Enabled
                 12    SPKOUTL_ENA         0     SPKMIXL Mixer, SPKLVOL PGA and SPKOUTL Output
                                                 Enable
                                                 0 = Disabled
                                                 1 = Enabled
                 11     HPOUT2_ENA         0     HPOUT2 Output Stage Enable
                                                 0 = Disabled
                                                 1 = Enabled
                  9    HPOUT1L_ENA         0     Enables HPOUT1L input stage
                                                 0 = Disabled
                                                 1 = Enabled
                                                 For normal operation, this bit should be set as the first step
                                                 of the HPOUT1L Enable sequence.
                  8    HPOUT1R_ENA         0     Enables HPOUT1R input stage
                                                 0 = Disabled
                                                 1 = Enabled
                                                 For normal operation, this bit should be set as the first step
                                                 of the HPOUT1R Enable sequence.
                  5      MICB2_ENA         0     Microphone Bias 2 Enable
                                                 0 = Disabled
                                                 1 = Enabled
                  4      MICB1_ENA         0     Microphone Bias 1 Enable
                                                 0 = Disabled
                                                 1 = Enabled
                 2:1    VMID_SEL [1:0]    00     VMID Divider Enable and Select
                                                 00 = VMID disabled (for OFF mode)
                                                 01 = 2 x 40k divider (for normal operation)
                                                 10 = 2 x 240k divider (for low power standby)
                                                 11 = Reserved
                  0       BIAS_ENA         0     Enables the Normal bias current generator (for all analogue
                                                 functions)
                                                 0 = Disabled
                                                 1 = Enabled
Register 01h Power Management (1)
                                                                                                       PP, March 2014, Rev 3.5
w
                                                                                                                          263


WM8958                                                                                               Pre-Production
 REGISTER       BIT        LABEL   DEFAULT                       DESCRIPTION                             REFER TO
 ADDRESS
  R2 (02h)      14      TSHUT_ENA     1    Thermal sensor enable
   Power                                   0 = Disabled
Management                                 1 = Enabled
     (2)
                13     TSHUT_OPDIS    1    Thermal shutdown control
                                           (Causes audio outputs to be disabled if an overtemperature
                                           occurs. The thermal sensor must also be enabled.)
                                           0 = Disabled
                                           1 = Enabled
                11      OPCLK_ENA     0    GPIO Clock Output (OPCLK) Enable
                                           0 = Disabled
                                           1 = Enabled
                 9      MIXINL_ENA    0    Left Input Mixer Enable
                                           (Enables MIXINL and RXVOICE input to MIXINL)
                                           0 = Disabled
                                           1 = Enabled
                 8      MIXINR_ENA    0    Right Input Mixer Enable
                                           (Enables MIXINR and RXVOICE input to MIXINR)
                                           0 = Disabled
                                           1 = Enabled
                 7       IN2L_ENA     0    IN2L Input PGA Enable
                                           0 = Disabled
                                           1 = Enabled
                 6       IN1L_ENA     0    IN1L Input PGA Enable
                                           0 = Disabled
                                           1 = Enabled
                 5       IN2R_ENA     0    IN2R Input PGA Enable
                                           0 = Disabled
                                           1 = Enabled
                 4       IN1R_ENA     0    IN1R Input PGA Enable
                                           0 = Disabled
                                           1 = Enabled
Register 02h Power Management (2)
 REGISTER       BIT        LABEL   DEFAULT                       DESCRIPTION                             REFER TO
 ADDRESS
  R3 (03h)      13    LINEOUT1N_EN    0    LINEOUT1N Line Out and LINEOUT1NMIX Enable
   Power                     A             0 = Disabled
Management                                 1 = Enabled
     (3)
                12    LINEOUT1P_EN    0    LINEOUT1P Line Out and LINEOUT1PMIX Enable
                             A             0 = Disabled
                                           1 = Enabled
                11    LINEOUT2N_EN    0    LINEOUT2N Line Out and LINEOUT2NMIX Enable
                             A             0 = Disabled
                                           1 = Enabled
                10    LINEOUT2P_EN    0    LINEOUT2P Line Out and LINEOUT2PMIX Enable
                             A             0 = Disabled
                                           1 = Enabled
                 9    SPKRVOL_ENA     0    SPKMIXR Mixer and SPKRVOL PGA Enable
                                           0 = Disabled
                                           1 = Enabled
                                           Note that SPKMIXR and SPKRVOL are also enabled when
                                           SPKOUTR_ENA is set.
                                                                                            PP, March 2014, Rev 3.5
w
                                                                                                               264


Pre-Production                                                                                      WM8958
 REGISTER       BIT       LABEL    DEFAULT                      DESCRIPTION                           REFER TO
 ADDRESS
                 8    SPKLVOL_ENA     0    SPKMIXL Mixer and SPKLVOL PGA Enable
                                           0 = Disabled
                                           1 = Enabled
                                           Note that SPKMIXL and SPKLVOL are also enabled when
                                           SPKOUTL_ENA is set.
                 7    MIXOUTLVOL_     0    MIXOUTL Left Volume Control Enable
                           ENA             0 = Disabled
                                           1 = Enabled
                 6    MIXOUTRVOL_     0    MIXOUTR Right Volume Control Enable
                           ENA             0 = Disabled
                                           1 = Enabled
                 5    MIXOUTL_ENA     0    MIXOUTL Left Output Mixer Enable
                                           0 = Disabled
                                           1 = Enabled
                 4    MIXOUTR_ENA     0    MIXOUTR Right Output Mixer Enable
                                           0 = Disabled
                                           1 = Enabled
Register 03h Power Management (3)
 REGISTER       BIT       LABEL    DEFAULT                      DESCRIPTION                           REFER TO
 ADDRESS
  R4 (04h)      13    AIF2ADCL_ENA    0    Enable AIF2ADC (Left) output path
   Power                                   0 = Disabled
Management                                 1 = Enabled
     (4)
                12     AIF2ADCR_EN    0    Enable AIF2ADC (Right) output path
                            A              0 = Disabled
                                           1 = Enabled
                11    AIF1ADC2L_EN    0    Enable AIF1ADC2 (Left) output path (AIF1, Timeslot 1)
                            A              0 = Disabled
                                           1 = Enabled
                10    AIF1ADC2R_EN    0    Enable AIF1ADC2 (Right) output path (AIF1, Timeslot 1)
                            A              0 = Disabled
                                           1 = Enabled
                 9    AIF1ADC1L_EN    0    Enable AIF1ADC1 (Left) output path (AIF1, Timeslot 0)
                            A              0 = Disabled
                                           1 = Enabled
                 8    AIF1ADC1R_EN    0    Enable AIF1ADC1 (Right) output path (AIF1, Timeslot 0)
                            A              0 = Disabled
                                           1 = Enabled
                 5     DMIC2L_ENA     0    Digital microphone DMICDAT2 Left channel enable
                                           0 = Disabled
                                           1 = Enabled
                 4     DMIC2R_ENA     0    Digital microphone DMICDAT2 Right channel enable
                                           0 = Disabled
                                           1 = Enabled
                 3     DMIC1L_ENA     0    Digital microphone DMICDAT1 Left channel enable
                                           0 = Disabled
                                           1 = Enabled
                 2     DMIC1R_ENA     0    Digital microphone DMICDAT1 Right channel enable
                                           0 = Disabled
                                           1 = Enabled
                 1      ADCL_ENA      0    Left ADC Enable
                                                                                         PP, March 2014, Rev 3.5
w
                                                                                                            265


WM8958                                                                                            Pre-Production
 REGISTER       BIT       LABEL    DEFAULT                     DESCRIPTION                            REFER TO
 ADDRESS
                                           0 = Disabled
                                           1 = Enabled
                 0      ADCR_ENA      0    Right ADC Enable
                                           0 = Disabled
                                           1 = Enabled
Register 04h Power Management (4)
 REGISTER       BIT       LABEL    DEFAULT                     DESCRIPTION                            REFER TO
 ADDRESS
  R5 (05h)      13    AIF2DACL_ENA    0    Enable AIF2DAC (Left) input path
   Power                                   0 = Disabled
Management                                 1 = Enabled
     (5)
                12     AIF2DACR_EN    0    Enable AIF2DAC (Right) input path
                            A              0 = Disabled
                                           1 = Enabled
                11    AIF1DAC2L_EN    0    Enable AIF1DAC2 (Left) input path (AIF1, Timeslot 1)
                            A              0 = Disabled
                                           1 = Enabled
                10    AIF1DAC2R_EN    0    Enable AIF1DAC2 (Right) input path (AIF1, Timeslot 1)
                            A              0 = Disabled
                                           1 = Enabled
                 9    AIF1DAC1L_EN    0    Enable AIF1DAC1 (Left) input path (AIF1, Timeslot 0)
                            A              0 = Disabled
                                           1 = Enabled
                 8    AIF1DAC1R_EN    0    Enable AIF1DAC1 (Right) input path (AIF1, Timeslot 0)
                            A              0 = Disabled
                                           1 = Enabled
                 3      DAC2L_ENA     0    Left DAC2 Enable
                                           0 = Disabled
                                           1 = Enabled
                 2      DAC2R_ENA     0    Right DAC2 Enable
                                           0 = Disabled
                                           1 = Enabled
                 1      DAC1L_ENA     0    Left DAC1 Enable
                                           0 = Disabled
                                           1 = Enabled
                 0      DAC1R_ENA     0    Right DAC1 Enable
                                           0 = Disabled
                                           1 = Enabled
Register 05h Power Management (5)
                                                                                         PP, March 2014, Rev 3.5
w
                                                                                                            266


Pre-Production                                                                                           WM8958
 REGISTER       BIT        LABEL    DEFAULT                          DESCRIPTION                          REFER TO
 ADDRESS
  R6 (06h)     10:9    AIF3ADC_SRC     00   AIF3 Mono PCM output source select
   Power                    [1:0]           00 = None
Management                                  01 = AIF2ADC (Left) output path
     (6)
                                            10 = AIF2ADC (Right) output path
                                            11 = Reserved
                8:7    AIF2DAC_SRC     00   AIF2 input path select
                            [1:0]           00 = Left and Right inputs from AIF2
                                            01 = Left input from AIF2; Right input from AIF3
                                            10 = Left input from AIF3; Right input from AIF2
                                            11 = Reserved
                 5        AIF3_TRI      0   AIF3 Audio Interface tri-state
                                            0 = AIF3 pins operate normally
                                            1 = Tri-state all AIF3 interface pins
                                            Note that pins not configured as AIF3 functions are not
                                            affected by this register.
                4:3   AIF3_ADCDAT_     00   GPIO9/ADCDAT3 Source select
                          SRC [1:0]         00 = AIF1 ADCDAT1
                                            01 = AIF2 ADCDAT2
                                            10 = DACDAT2
                                            11 = AIF3 Mono PCM output
                                            Note that GPIO9 must be configured as ADCDAT3.
                 2    AIF2_ADCDAT_      0   ADCDAT2 Source select
                            SRC             0 = AIF2 ADCDAT2
                                            1 = GPIO8/DACDAT3
                                            For selection 1, the GPIO8 pin must also be configured as
                                            DACDAT3.
                 1    AIF2_DACDAT_      0   AIF2 DACDAT Source select
                            SRC             0 = DACDAT2
                                            1 = GPIO8/DACDAT3
                                            For selection 1, the GPIO8 pin must also be configured as
                                            DACDAT3.
                 0    AIF1_DACDAT_      0   AIF1 DACDAT Source select
                            SRC             0 = DACDAT1
                                            1 = GPIO8/DACDAT3
                                            Note that, for selection 1, the GPIO8 pin must be configured
                                            as DACDAT3.
Register 06h Power Management (6)
 REGISTER       BIT        LABEL    DEFAULT                          DESCRIPTION                          REFER TO
 ADDRESS
  R21 (15h)      8    IN1RP_MIXINR      0   IN1RP Pin (PGA Bypass) to MIXINR Gain Boost.
 Input Mixer              _BOOST            This bit selects the maximum gain setting of the
     (1)                                    IN1RP_MIXINR_VOL register.
                                            0 = Maximum gain is +6dB
                                            1 = Maximum gain is +15dB
                 7    IN1LP_MIXINL_     0   IN1LP Pin (PGA Bypass) to MIXINL Gain Boost.
                           BOOST            This bit selects the maximum gain setting of the
                                            IN1LP_MIXINL_VOL register.
                                            0 = Maximum gain is +6dB
                                            1 = Maximum gain is +15dB
                                                                                             PP, March 2014, Rev 3.5
w
                                                                                                                267


WM8958                                                                                                       Pre-Production
 REGISTER        BIT           LABEL     DEFAULT                          DESCRIPTION                            REFER TO
 ADDRESS
                  6       INPUTS_CLAM        0   Input pad VMID clamp
                                  P              0 = Clamp de-activated
                                                 1 = Clamp activated
Register 15h Input Mixer (1)
 REGISTER        BIT           LABEL     DEFAULT                          DESCRIPTION                            REFER TO
 ADDRESS
 R24 (18h)        8            IN1_VU       0    Input PGA Volume Update
   Left Line                                     Writing a 1 to this bit will cause IN1L and IN1R input PGA
  Input 1&2                                      volumes to be updated simultaneously
   Volume
                  7         IN1L_MUTE        1   IN1L PGA Mute
                                                 0 = Disable Mute
                                                 1 = Enable Mute
                  6           IN1L_ZC        0   IN1L PGA Zero Cross Detector
                                                 0 = Change gain immediately
                                                 1 = Change gain on zero cross only
                 4:0      IN1L_VOL [4:0]  0_1011 IN1L Volume
                                                 -16.5dB to +30dB in 1.5dB steps
Register 18h Left Line Input 1&2 Volume
 REGISTER        BIT           LABEL     DEFAULT                          DESCRIPTION                            REFER TO
 ADDRESS
 R25 (19h)        8            IN2_VU       0    Input PGA Volume Update
   Left Line                                     Writing a 1 to this bit will cause IN2L and IN2R input PGA
  Input 3&4                                      volumes to be updated simultaneously
   Volume
                  7         IN2L_MUTE        1   IN2L PGA Mute
                                                 0 = Disable Mute
                                                 1 = Enable Mute
                  6           IN2L_ZC        0   IN2L PGA Zero Cross Detector
                                                 0 = Change gain immediately
                                                 1 = Change gain on zero cross only
                 4:0      IN2L_VOL [4:0]  0_1011 IN2L Volume
                                                 -16.5dB to +30dB in 1.5dB steps
Register 19h Left Line Input 3&4 Volume
 REGISTER        BIT           LABEL     DEFAULT                          DESCRIPTION                            REFER TO
 ADDRESS
 R26 (1Ah)        8            IN1_VU       0    Input PGA Volume Update
 Right Line                                      Writing a 1 to this bit will cause IN1L and IN1R input PGA
  Input 1&2                                      volumes to be updated simultaneously
   Volume
                  7         IN1R_MUTE        1   IN1R PGA Mute
                                                 0 = Disable Mute
                                                 1 = Enable Mute
                  6           IN1R_ZC        0   IN1R PGA Zero Cross Detector
                                                 0 = Change gain immediately
                                                 1 = Change gain on zero cross only
                 4:0      IN1R_VOL [4:0]  0_1011 IN1R Volume
                                                 -16.5dB to +30dB in 1.5dB steps
Register 1Ah Right Line Input 1&2 Volume
                                                                                                    PP, March 2014, Rev 3.5
w
                                                                                                                       268


Pre-Production                                                                                                  WM8958
 REGISTER       BIT           LABEL      DEFAULT                           DESCRIPTION                            REFER TO
 ADDRESS
 R27 (1Bh)        8           IN2_VU         0    Input PGA Volume Update
 Right Line                                       Writing a 1 to this bit will cause IN2L and IN2R input PGA
  Input 3&4                                       volumes to be updated simultaneously
   Volume
                  7        IN2R_MUTE         1    IN2R PGA Mute
                                                  0 = Disable Mute
                                                  1 = Enable Mute
                  6          IN2R_ZC         0    IN2R PGA Zero Cross Detector
                                                  0 = Change gain immediately
                                                  1 = Change gain on zero cross only
                 4:0     IN2R_VOL [4:0]   0_1011  IN2R Volume
                                                  -16.5dB to +30dB in 1.5dB steps
Register 1Bh Right Line Input 3&4 Volume
 REGISTER       BIT           LABEL      DEFAULT                           DESCRIPTION                            REFER TO
 ADDRESS
 R28 (1Ch)        8       HPOUT1_VU          0    Headphone Output PGA Volume Update
 Left Output                                      Writing a 1 to this bit will update HPOUT1LVOL and
   Volume                                         HPOUT1RVOL volumes simultaneously.
                  7       HPOUT1L_ZC         0    HPOUT1LVOL (Left Headphone Output PGA) Zero Cross
                                                  Enable
                                                  0 = Zero cross disabled
                                                  1 = Zero cross enabled
                  6      HPOUT1L_MUT         1    HPOUT1LVOL (Left Headphone Output PGA) Mute
                                E_N               0 = Mute
                                                  1 = Un-mute
                 5:0     HPOUT1L_VOL      10_1101 HPOUT1LVOL (Left Headphone Output PGA) Volume
                                [5:0]             -57dB to +6dB in 1dB steps
                                                  00_0000 = -57dB
                                                  00_0001 = -56dB
                                                  … (1dB steps)
                                                  11_1111 = +6dB
Register 1Ch Left Output Volume
 REGISTER       BIT           LABEL      DEFAULT                           DESCRIPTION                            REFER TO
 ADDRESS
 R29 (1Dh)        8       HPOUT1_VU          0    Headphone Output PGA Volume Update
Right Output                                      Writing a 1 to this bit will update HPOUT1LVOL and
   Volume                                         HPOUT1RVOL volumes simultaneously.
                  7       HPOUT1R_ZC         0    HPOUT1RVOL (Right Headphone Output PGA) Zero Cross
                                                  Enable
                                                  0 = Zero cross disabled
                                                  1 = Zero cross enabled
                  6     HPOUT1R_MUT          1    HPOUT1RVOL (Right Headphone Output PGA) Mute
                                E_N               0 = Mute
                                                  1 = Un-mute
                 5:0     HPOUT1R_VOL      10_1101 HPOUT1RVOL (Right Headphone Output PGA) Volume
                                [5:0]             -57dB to +6dB in 1dB steps
                                                  00_0000 = -57dB
                                                  00_0001 = -56dB
                                                  … (1dB steps)
                                                  11_1111 = +6dB
Register 1Dh Right Output Volume
                                                                                                     PP, March 2014, Rev 3.5
w
                                                                                                                        269


WM8958                                                                                                Pre-Production
 REGISTER        BIT        LABEL   DEFAULT                           DESCRIPTION                         REFER TO
 ADDRESS
 R30 (1Eh)        6     LINEOUT1N_M     1    LINEOUT1N Line Output Mute
Line Outputs                  UTE            0 = Un-mute
   Volume                                    1 = Mute
                  5     LINEOUT1P_M     1    LINEOUT1P Line Output Mute
                              UTE            0 = Un-mute
                                             1 = Mute
                  4    LINEOUT1_VOL     0    LINEOUT1 Line Output Volume
                                             0 = 0dB
                                             1 = -6dB
                                             Applies to both LINEOUT1N and LINEOUT1P
                  2     LINEOUT2N_M     1    LINEOUT2N Line Output Mute
                              UTE            0 = Un-mute
                                             1 = Mute
                  1     LINEOUT2P_M     1    LINEOUT2P Line Output Mute
                              UTE            0 = Un-mute
                                             1 = Mute
                  0    LINEOUT2_VOL     0    LINEOUT2 Line Output Volume
                                             0 = 0dB
                                             1 = -6dB
                                             Applies to both LINEOUT2N and LINEOUT2P
Register 1Eh Line Outputs Volume
 REGISTER        BIT        LABEL   DEFAULT                           DESCRIPTION                         REFER TO
 ADDRESS
 R31 (1Fh)        5    HPOUT2_MUTE      1    HPOUT2 (Earpiece Driver) Mute
  HPOUT2                                     0 = Un-mute
   Volume                                    1 = Mute
                  4     HPOUT2_VOL      0    HPOUT2 (Earpiece Driver) Volume
                                             0 = 0dB
                                             1 = -6dB
Register 1Fh HPOUT2 Volume
 REGISTER        BIT        LABEL   DEFAULT                           DESCRIPTION                         REFER TO
 ADDRESS
 R32 (20h)        8      MIXOUT_VU      0    Mixer Output PGA Volume Update
 Left OPGA                                   Writing a 1 to this bit will update MIXOUTLVOL and
   Volume                                    MIXOUTRVOL volumes simultaneously.
                  7      MIXOUTL_ZC     0    MIXOUTLVOL (Left Mixer Output PGA) Zero Cross Enable
                                             0 = Zero cross disabled
                                             1 = Zero cross enabled
                  6     MIXOUTL_MUT     1    MIXOUTLVOL (Left Mixer Output PGA) Mute
                              E_N            0 = Mute
                                             1 = Un-mute
                 5:0    MIXOUTL_VOL  11_1001 MIXOUTLVOL (Left Mixer Output PGA) Volume
                              [5:0]          -57dB to +6dB in 1dB steps
                                             00_0000 = -57dB
                                             00_0001 = -56dB
                                             … (1dB steps)
                                             11_1111 = +6dB
Register 20h Left OPGA Volume
                                                                                             PP, March 2014, Rev 3.5
w
                                                                                                                270


Pre-Production                                                                                          WM8958
 REGISTER       BIT        LABEL    DEFAULT                           DESCRIPTION                         REFER TO
 ADDRESS
  R33 (21h)       8     MIXOUT_VU       0    Mixer Output PGA Volume Update
Right OPGA                                   Writing a 1 to this bit will update MIXOUTLVOL and
   Volume                                    MIXOUTRVOL volumes simultaneously.
                  7     MIXOUTR_ZC      0    MIXOUTRVOL (Right Mixer Output PGA) Zero Cross
                                             Enable
                                             0 = Zero cross disabled
                                             1 = Zero cross enabled
                  6   MIXOUTR_MUT       1    MIXOUTLVOL (Right Mixer Output PGA) Mute
                            E_N              0 = Mute
                                             1 = Un-mute
                5:0    MIXOUTR_VOL   11_1001 MIXOUTRVOL (Right Mixer Output PGA) Volume
                            [5:0]            -57dB to +6dB in 1dB steps
                                             00_0000 = -57dB
                                             00_0001 = -56dB
                                             … (1dB steps)
                                             11_1111 = +6dB
Register 21h Right OPGA Volume
 REGISTER       BIT        LABEL    DEFAULT                           DESCRIPTION                         REFER TO
 ADDRESS
  R34 (22h)       8    SPKAB_REF_S       0   Selects Reference for Speaker in Class AB mode
  SPKMIXL                    EL              0 = SPKVDD/2
 Attenuation                                 1 = VMID
                  6   DAC2L_SPKMIX      0    Left DAC2 to SPKMIXL Fine Volume Control
                           L_VOL             0 = 0dB
                                             1 = -3dB
                  5    MIXINL_SPKMI     0    MIXINL (Left ADC bypass) to SPKMIXL Fine Volume
                          XL_VOL             Control
                                             0 = 0dB
                                             1 = -3dB
                  4    IN1LP_SPKMIX     0    IN1LP to SPKMIXL Fine Volume Control
                           L_VOL             0 = 0dB
                                             1 = -3dB
                  3    MIXOUTL_SPK       0   Left Mixer Output to SPKMIXL Fine Volume Control
                         MIXL_VOL            0 = 0dB
                                             1 = -3dB
                  2   DAC1L_SPKMIX      0    Left DAC1 to SPKMIXL Fine Volume Control
                           L_VOL             0 = 0dB
                                             1 = -3dB
                 1:0   SPKMIXL_VOL      11   Left Speaker Mixer Volume Control
                            [1:0]            00 = 0dB
                                             01 = -6dB
                                             10 = -12dB
                                             11 = Mute
Register 22h SPKMIXL Attenuation
                                                                                             PP, March 2014, Rev 3.5
w
                                                                                                                271


WM8958                                                                                           Pre-Production
 REGISTER      BIT         LABEL   DEFAULT                       DESCRIPTION                         REFER TO
 ADDRESS
 R35 (23h)       8    SPKOUT_CLAS     0    Speaker Class AB Mode Enable
 SPKMIXR                    SAB            0 = Class D mode
 Attenuation                               1 = Class AB mode
                 6    DAC2R_SPKMI     0    Right DAC2 to SPKMIXR Fine Volume Control
                          XR_VOL           0 = 0dB
                                           1 = -3dB
                 5    MIXINR_SPKMI    0    MIXINR (Right ADC bypass) to SPKMIXR Fine Volume
                          XR_VOL           Control
                                           0 = 0dB
                                           1 = -3dB
                 4    IN1RP_SPKMIX    0    IN1RP to SPKMIXR Fine Volume Control
                           R_VOL           0 = 0dB
                                           1 = -3dB
                 3    MIXOUTR_SPK     0    Right Mixer Output to SPKMIXR Fine Volume Control
                         MIXR_VOL          0 = 0dB
                                           1 = -3dB
                 2    DAC1R_SPKMI     0    Right DAC1 to SPKMIXR Fine Volume Control
                          XR_VOL           0 = 0dB
                                           1 = -3dB
                1:0   SPKMIXR_VOL     11   Right Speaker Mixer Volume Control
                            [1:0]          00 = 0dB
                                           01 = -6dB
                                           10 = -12dB
                                           11 = Mute
Register 23h SPKMIXR Attenuation
 REGISTER      BIT         LABEL   DEFAULT                       DESCRIPTION                         REFER TO
 ADDRESS
 R36 (24h)       5    IN2LRP_TO_SP    0    Direct Voice (VRXN-VRXP) to Left Speaker Mute
  SPKOUT                   KOUTL           0 = Mute
   Mixers                                  1 = Un-mute
                 4   SPKMIXL_TO_S     1    SPKMIXL Left Speaker Mixer to Left Speaker Mute
                          PKOUTL           0 = Mute
                                           1 = Un-mute
                 3     SPKMIXR_TO_    0    SPKMIXR Right Speaker Mixer to Left Speaker Mute
                         SPKOUTL           0 = Mute
                                           1 = Un-mute
                 2    IN2LRP_TO_SP    0    Direct Voice (VRXN-VRXP) to Right Speaker Mute
                           KOUTR           0 = Mute
                                           1 = Un-mute
                 1   SPKMIXL_TO_S     0    SPKMIXL Left Speaker Mixer to Right Speaker Mute
                          PKOUTR           0 = Mute
                                           1 = Un-mute
                 0     SPKMIXR_TO_    1    SPKMIXR Right Speaker Mixer to Right Speaker Mute
                         SPKOUTR           0 = Mute
                                           1 = Un-mute
Register 24h SPKOUT Mixers
                                                                                        PP, March 2014, Rev 3.5
w
                                                                                                           272


Pre-Production                                                                                           WM8958
 REGISTER       BIT        LABEL    DEFAULT                           DESCRIPTION                          REFER TO
 ADDRESS
  R37 (25h)      5:3   SPKOUTL_BOO     000   Left Speaker Gain Boost
   ClassD                  ST [2:0]          000 = 1.00x boost (+0dB)
                                             001 = 1.19x boost (+1.5dB)
                                             010 = 1.41x boost (+3.0dB)
                                             011 = 1.68x boost (+4.5dB)
                                             100 = 2.00x boost (+6.0dB)
                                             101 = 2.37x boost (+7.5dB)
                                             110 = 2.81x boost (+9.0dB)
                                             111 = 3.98x boost (+12.0dB)
                 2:0    SPKOUTR_BO     000   Right Speaker Gain Boost
                          OST [2:0]          000 = 1.00x boost (+0dB)
                                             001 = 1.19x boost (+1.5dB)
                                             010 = 1.41x boost (+3.0dB)
                                             011 = 1.68x boost (+4.5dB)
                                             100 = 2.00x boost (+6.0dB)
                                             101 = 2.37x boost (+7.5dB)
                                             110 = 2.81x boost (+9.0dB)
                                             111 = 3.98x boost (+12.0dB)
Register 25h ClassD
 REGISTER       BIT        LABEL    DEFAULT                           DESCRIPTION                          REFER TO
 ADDRESS
  R38 (26h)       8      SPKOUT_VU      0    Speaker Output PGA Volume Update
  Speaker                                    Writing a 1 to this bit will update SPKLVOL and SPKRVOL
 Volume Left                                 volumes simultaneously.
                  7     SPKOUTL_ZC      0    SPKLVOL (Left Speaker Output PGA) Zero Cross Enable
                                             0 = Zero cross disabled
                                             1 = Zero cross enabled
                  6    SPKOUTL_MUT      1    SPKLVOL (Left Speaker Output PGA) Mute
                            E_N              0 = Mute
                                             1 = Un-mute
                 5:0   SPKOUTL_VOL   11_1001 SPKLVOL (Left Speaker Output PGA) Volume
                            [5:0]            -57dB to +6dB in 1dB steps
                                             00_0000 = -57dB
                                             00_0001 = -56dB
                                             … (1dB steps)
                                             11_1111 = +6dB
Register 26h Speaker Volume Left
 REGISTER       BIT        LABEL    DEFAULT                           DESCRIPTION                          REFER TO
 ADDRESS
  R39 (27h)       8      SPKOUT_VU      0    Speaker Output PGA Volume Update
  Speaker                                    Writing a 1 to this bit will update SPKLVOL and SPKRVOL
Volume Right                                 volumes simultaneously.
                  7     SPKOUTR_ZC      0    SPKRVOL (Right Speaker Output PGA) Zero Cross Enable
                                             0 = Zero cross disabled
                                             1 = Zero cross enabled
                  6    SPKOUTR_MUT      1    SPKRVOL (Right Speaker Output PGA) Mute
                            E_N              0 = Mute
                                             1 = Un-mute
                 5:0   SPKOUTR_VOL   11_1001 SPKRVOL (Right Speaker Output PGA) Volume
                                                                                              PP, March 2014, Rev 3.5
w
                                                                                                                 273


WM8958                                                                                            Pre-Production
 REGISTER       BIT          LABEL     DEFAULT                      DESCRIPTION                       REFER TO
 ADDRESS
                              [5:0]            -57dB to +6dB in 1dB steps
                                               00_0000 = -57dB
                                               00_0001 = -56dB
                                               … (1dB steps)
                                               11_1111 = +6dB
Register 27h Speaker Volume Right
 REGISTER       BIT          LABEL     DEFAULT                      DESCRIPTION                       REFER TO
 ADDRESS
  R40 (28h)       7      IN2LP_TO_IN2L    0    IN2L PGA Non-Inverting Input Select
 Input Mixer                                   0 = Connected to VMID
     (2)                                       1 = Connected to IN2LP
                                               Note that VMID_BUF_ENA must be set when using IN2L
                                               connected to VMID.
                  6      IN2LN_TO_IN2L    0    IN2L PGA Inverting Input Select
                                               0 = Not connected
                                               1 = Connected to IN2LN
                  5      IN1LP_TO_IN1L    0    IN1L PGA Non-Inverting Input Select
                                               0 = Connected to VMID
                                               1 = Connected to IN1LP
                                               Note that VMID_BUF_ENA must be set when using IN1L
                                               connected to VMID.
                  4      IN1LN_TO_IN1L    0    IN1L PGA Inverting Input Select
                                               0 = Not connected
                                               1 = Connected to IN1LN
                  3       IN2RP_TO_IN2    0    IN2R PGA Non-Inverting Input Select
                                R              0 = Connected to VMID
                                               1 = Connected to IN2RP
                                               Note that VMID_BUF_ENA must be set when using IN2R
                                               connected to VMID.
                  2       IN2RN_TO_IN2    0    IN2R PGA Inverting Input Select
                                R              0 = Not connected
                                               1 = Connected to IN2RN
                  1       IN1RP_TO_IN1    0    IN1R PGA Non-Inverting Input Select
                                R              0 = Connected to VMID
                                               1 = Connected to IN1RP
                                               Note that VMID_BUF_ENA must be set when using IN1R
                                               connected to VMID.
                  0       IN1RN_TO_IN1    0    IN1R PGA Inverting Input Select
                                R              0 = Not connected
                                               1 = Connected to IN1RN
Register 28h Input Mixer (2)
                                                                                         PP, March 2014, Rev 3.5
w
                                                                                                            274


Pre-Production                                                                                       WM8958
 REGISTER       BIT          LABEL      DEFAULT                     DESCRIPTION                        REFER TO
 ADDRESS
  R41 (29h)       8      IN2L_TO_MIXIN     0    IN2L PGA Output to MIXINL Mute
 Input Mixer                   L                0 = Mute
     (3)                                        1 = Un-Mute
                  7      IN2L_MIXINL_V     0    IN2L PGA Output to MIXINL Gain
                               OL               0 = 0dB
                                                1 = +30dB
                  5      IN1L_TO_MIXIN     0    IN1L PGA Output to MIXINL Mute
                               L                0 = Mute
                                                1 = Un-Mute
                  4      IN1L_MIXINL_V     0    IN1L PGA Output to MIXINL Gain
                               OL               0 = 0dB
                                                1 = +30dB
                 2:0      MIXOUTL_MIXI    000   Record Path MIXOUTL to MIXINL Gain and Mute
                           NL_VOL [2:0]         000 = Mute
                                                001 = -12dB
                                                010 = -9dB
                                                011 = -6dB
                                                100 = -3dB
                                                101 = 0dB
                                                110 = +3dB
                                                111 = +6dB
Register 29h Input Mixer (3)
 REGISTER       BIT          LABEL      DEFAULT                     DESCRIPTION                        REFER TO
 ADDRESS
  R42 (2Ah)       8     IN2R_TO_MIXIN      0    IN2R PGA Output to MIXINR Mute
 Input Mixer                   R                0 = Mute
     (4)                                        1 = Un-Mute
                  7       IN2R_MIXINR_     0    IN2R PGA Output to MIXINR Gain
                              VOL               0 = 0dB
                                                1 = +30dB
                  5     IN1R_TO_MIXIN      0    IN1R PGA Output to MIXINR Mute
                               R                0 = Mute
                                                1 = Un-Mute
                  4       IN1R_MIXINR_     0    IN1R PGA Output to MIXINR Gain
                              VOL               0 = 0dB
                                                1 = +30dB
                 2:0     MIXOUTR_MIXI     000   Record Path MIXOUTR to MIXINR Gain and Mute
                           NR_VOL [2:0]         000 = Mute
                                                001 = -12dB
                                                010 = -9dB
                                                011 = -6dB
                                                100 = -3dB
                                                101 = 0dB
                                                110 = +3dB
                                                111 = +6dB
Register 2Ah Input Mixer (4)
                                                                                          PP, March 2014, Rev 3.5
w
                                                                                                             275


WM8958                                                                                                   Pre-Production
 REGISTER       BIT           LABEL    DEFAULT                        DESCRIPTION                            REFER TO
 ADDRESS
  R43 (2Bh)     8:6     IN1LP_MIXINL_    000   IN1LP Pin (PGA Bypass) to MIXINL Gain and Mute
 Input Mixer                 VOL [2:0]         000 = Mute
     (5)                                       001 = -12dB
                                               010 = -9dB
                                               011 = -6dB
                                               100 = -3dB
                                               101 = 0dB
                                               110 = +3dB
                                               111 = +6dB (see note below).
                                               When IN1LP_MIXINL_BOOST is set, then the maximum
                                               gain setting is increased to +15dB, ie. 111 = +15dB.
                                               Note that VMID_BUF_ENA must be set when using the
                                               IN1LP (PGA Bypass) input to MIXINL.
                2:0     IN2LRP_MIXINL    000   RXVOICE Differential Input (VRXP-VRXN) to MIXINL Gain
                           _VOL [2:0]          and Mute
                                               000 = Mute
                                               001 = -12dB
                                               010 = -9dB
                                               011 = -6dB
                                               100 = -3dB
                                               101 = 0dB
                                               110 = +3dB
                                               111 = +6dB
Register 2Bh Input Mixer (5)
 REGISTER       BIT           LABEL    DEFAULT                        DESCRIPTION                            REFER TO
 ADDRESS
  R44 (2Ch)     8:6      IN1RP_MIXINR    000   IN1RP Pin (PGA Bypass) to MIXINR Gain and Mute
 Input Mixer                _VOL [2:0]         000 = Mute
     (6)                                       001 = -12dB
                                               010 = -9dB
                                               011 = -6dB
                                               100 = -3dB
                                               101 = 0dB
                                               110 = +3dB
                                               111 = +6dB (see note below).
                                               When IN1RP_MIXINR_BOOST is set, then the maximum
                                               gain setting is increased to +15dB, ie. 111 = +15dB.
                                               Note that VMID_BUF_ENA must be set when using the
                                               IN1RP (PGA Bypass) input to MIXINR.
                2:0      IN2LRP_MIXIN    000   RXVOICE Differential Input (VRXP-VRXN) to MIXINR Gain
                           R_VOL [2:0]         and Mute
                                               000 = Mute
                                               001 = -12dB
                                               010 = -9dB
                                               011 = -6dB
                                               100 = -3dB
                                               101 = 0dB
                                               110 = +3dB
                                               111 = +6dB
Register 2Ch Input Mixer (6)
                                                                                                PP, March 2014, Rev 3.5
w
                                                                                                                   276


Pre-Production                                                                                     WM8958
 REGISTER       BIT         LABEL    DEFAULT                      DESCRIPTION                        REFER TO
 ADDRESS
 R45 (2Dh)       8     DAC1L_TO_HP      0    HPOUT1LVOL (Left Headphone Output PGA) Input Select
Output Mixer                OUT1L            0 = MIXOUTL
     (1)                                     1 = DAC1L
                 7     MIXINR_TO_MI     0    MIXINR Output (Right ADC bypass) to MIXOUTL Mute
                            XOUTL            0 = Mute
                                             1 = Un-mute
                 6      MIXINL_TO_MI    0    MIXINL Output (Left ADC bypass) to MIXOUTL Mute
                            XOUTL            0 = Mute
                                             1 = Un-mute
                 5     IN2RN_TO_MIX     0    IN2RN to MIXOUTL Mute
                              OUTL           0 = Mute
                                             1 = Un-mute
                                             Note that VMID_BUF_ENA must be set when using the
                                             IN2RN input to MIXOUTL.
                 4     IN2LN_TO_MIX     0    IN2LN to MIXOUTL Mute
                              OUTL           0 = Mute
                                             1 = Un-mute
                                             Note that VMID_BUF_ENA must be set when using the
                                             IN2LN input to MIXOUTL.
                 3     IN1R_TO_MIXO     0    IN1R PGA Output to MIXOUTL Mute
                               UTL           0 = Mute
                                             1 = Un-mute
                 2     IN1L_TO_MIXO     0    IN1L PGA Output to MIXOUTL Mute
                               UTL           0 = Mute
                                             1 = Un-mute
                 1      IN2LP_TO_MIX    0    IN2LP to MIXOUTL Mute
                              OUTL           0 = Mute
                                             1 = Un-mute
                                             Note that VMID_BUF_ENA must be set when using the
                                             IN2LP input to MIXOUTL.
                 0     DAC1L_TO_MIX     0    Left DAC1 to MIXOUTL Mute
                              OUTL           0 = Mute
                                             1 = Un-mute
Register 2Dh Output Mixer (1)
 REGISTER       BIT         LABEL    DEFAULT                      DESCRIPTION                        REFER TO
 ADDRESS
 R46 (2Eh)       8     DAC1R_TO_HP      0    HPOUT1RVOL (Right Headphone Output PGA) Input
Output Mixer                OUT1R            Select
     (2)                                     0 = MIXOUTR
                                             1 = DAC1R
                 7      MIXINL_TO_MI    0    MIXINL Output (Left ADC bypass) to MIXOUTR Mute
                            XOUTR            0 = Mute
                                             1 = Un-mute
                 6     MIXINR_TO_MI     0    MIXINR Output (Right ADC bypass) to MIXOUTR Mute
                            XOUTR            0 = Mute
                                             1 = Un-mute
                 5     IN2LN_TO_MIX     0    IN2LN to MIXOUTR Mute
                              OUTR           0 = Mute
                                             1 = Un-mute
                                             Note that VMID_BUF_ENA must be set when using the
                                             IN2LN input to MIXOUTR.
                                                                                        PP, March 2014, Rev 3.5
w
                                                                                                           277


WM8958                                                                                           Pre-Production
 REGISTER       BIT          LABEL    DEFAULT                       DESCRIPTION                      REFER TO
 ADDRESS
                 4      IN2RN_TO_MIX     0    IN2RN to MIXOUTR Mute
                              OUTR            0 = Mute
                                              1 = Un-mute
                                              Note that VMID_BUF_ENA must be set when using the
                                              IN2RN input to MIXOUTR.
                 3      IN1L_TO_MIXO     0    IN1L PGA Output to MIXOUTR Mute
                               UTR            0 = Mute
                                              1 = Un-mute
                 2     IN1R_TO_MIXO      0    IN1R PGA Output to MIXOUTR Mute
                               UTR            0 = Mute
                                              1 = Un-mute
                 1      IN2RP_TO_MIX     0    IN2RP to MIXOUTR Mute
                              OUTR            0 = Mute
                                              1 = Un-mute
                                              Note that VMID_BUF_ENA must be set when using the
                                              IN2RP input to MIXOUTR.
                 0       DAC1R_TO_MI     0    Right DAC1 to MIXOUTR Mute
                            XOUTR             0 = Mute
                                              1 = Un-mute
Register 2Eh Output Mixer (2)
 REGISTER       BIT          LABEL    DEFAULT                       DESCRIPTION                      REFER TO
 ADDRESS
 R47 (2Fh)     11:9     IN2LP_MIXOUT    000   IN2LP to MIXOUTL Volume
Output Mixer              L_VOL [2:0]         0dB to -9dB in 3dB steps
     (3)                                      X00 = 0dB
                                              X01 = -3dB
                                              X10 = -6dB
                                              X11 = -9dB
                8:6     IN2LN_MIXOUT    000   IN2LN to MIXOUTL Volume
                          L_VOL [2:0]         0dB to -9dB in 3dB steps
                                              X00 = 0dB
                                              X01 = -3dB
                                              X10 = -6dB
                                              X11 = -9dB
                5:3     IN1R_MIXOUTL    000   IN1R PGA Output to MIXOUTL Volume
                           _VOL [2:0]         0dB to -9dB in 3dB steps
                                              X00 = 0dB
                                              X01 = -3dB
                                              X10 = -6dB
                                              X11 = -9dB
                2:0     IN1L_MIXOUTL    000   IN1L PGA Output to MIXOUTL Volume
                           _VOL [2:0]         0dB to -9dB in 3dB steps
                                              X00 = 0dB
                                              X01 = -3dB
                                              X10 = -6dB
                                              X11 = -9dB
Register 2Fh Output Mixer (3)
                                                                                        PP, March 2014, Rev 3.5
w
                                                                                                           278


Pre-Production                                                                                       WM8958
 REGISTER       BIT          LABEL     DEFAULT                       DESCRIPTION                       REFER TO
 ADDRESS
  R48 (30h)     11:9    IN2RP_MIXOUT     000   IN2RP to MIXOUTR Volume
Output Mixer              R_VOL [2:0]          0dB to -9dB in 3dB steps
     (4)                                       X00 = 0dB
                                               X01 = -3dB
                                               X10 = -6dB
                                               X11 = -9dB
                8:6    IN2RN_MIXOUT      000   IN2RN to MIXOUTR Volume
                          R_VOL [2:0]          0dB to -9dB in 3dB steps
                                               X00 = 0dB
                                               X01 = -3dB
                                               X10 = -6dB
                                               X11 = -9dB
                5:3     IN1L_MIXOUTR     000   IN1L PGA Output to MIXOUTR Volume
                           _VOL [2:0]          0dB to -9dB in 3dB steps
                                               X00 = 0dB
                                               X01 = -3dB
                                               X10 = -6dB
                                               X11 = -9dB
                2:0    IN1R_MIXOUTR      000   IN1R PGA Output to MIXOUTR Volume
                           _VOL [2:0]          0dB to -9dB in 3dB steps
                                               X00 = 0dB
                                               X01 = -3dB
                                               X10 = -6dB
                                               X11 = -9dB
Register 30h Output Mixer (4)
 REGISTER       BIT          LABEL     DEFAULT                       DESCRIPTION                       REFER TO
 ADDRESS
  R49 (31h)     11:9     DAC1L_MIXOU     000   Left DAC1 to MIXOUTL Volume
Output Mixer              TL_VOL [2:0]         0dB to -9dB in 3dB steps
     (5)                                       X00 = 0dB
                                               X01 = -3dB
                                               X10 = -6dB
                                               X11 = -9dB
                8:6    IN2RN_MIXOUT      000   IN2RN to MIXOUTL Volume
                          L_VOL [2:0]          0dB to -9dB in 3dB steps
                                               X00 = 0dB
                                               X01 = -3dB
                                               X10 = -6dB
                                               X11 = -9dB
                5:3     MIXINR_MIXOU     000   MIXINR Output (Right ADC bypass) to MIXOUTL Volume
                          TL_VOL [2:0]         0dB to -9dB in 3dB steps
                                               X00 = 0dB
                                               X01 = -3dB
                                               X10 = -6dB
                                               X11 = -9dB
                2:0     MIXINL_MIXOU     000   MIXINL Output (Left ADC bypass) to MIXOUTL Volume
                          TL_VOL [2:0]         0dB to -9dB in 3dB steps
                                               X00 = 0dB
                                               X01 = -3dB
                                               X10 = -6dB
                                               X11 = -9dB
Register 31h Output Mixer (5)
                                                                                          PP, March 2014, Rev 3.5
w
                                                                                                             279


WM8958                                                                                               Pre-Production
 REGISTER       BIT          LABEL     DEFAULT                       DESCRIPTION                        REFER TO
 ADDRESS
  R50 (32h)     11:9    DAC1R_MIXOU      000   Right DAC1 to MIXOUTR Volume
Output Mixer              TR_VOL [2:0]         0dB to -9dB in 3dB steps
     (6)                                       X00 = 0dB
                                               X01 = -3dB
                                               X10 = -6dB
                                               X11 = -9dB
                8:6     IN2LN_MIXOUT     000   IN2LN to MIXOUTR Volume
                          R_VOL [2:0]          0dB to -9dB in 3dB steps
                                               X00 = 0dB
                                               X01 = -3dB
                                               X10 = -6dB
                                               X11 = -9dB
                5:3     MIXINL_MIXOU     000   MIXINL Output (Left ADC bypass) to MIXOUTR Volume
                          TR_VOL [2:0]         0dB to -9dB in 3dB steps
                                               X00 = 0dB
                                               X01 = -3dB
                                               X10 = -6dB
                                               X11 = -9dB
                2:0     MIXINR_MIXOU     000   MIXINR Output (Right ADC bypass) to MIXOUTR Volume
                          TR_VOL [2:0]         0dB to -9dB in 3dB steps
                                               X00 = 0dB
                                               X01 = -3dB
                                               X10 = -6dB
                                               X11 = -9dB
Register 32h Output Mixer (6)
 REGISTER       BIT          LABEL     DEFAULT                       DESCRIPTION                        REFER TO
 ADDRESS
  R51 (33h)      5      IN2LRP_TO_HP      0    Direct Voice (VRXN-VRXP) to Earpiece Driver
  HPOUT2                      OUT2             0 = Mute
    Mixer                                      1 = Un-mute
                 4       MIXOUTLVOL_      0    MIXOUTLVOL (Left Output Mixer PGA) to Earpiece Driver
                          TO_HPOUT2            0 = Mute
                                               1 = Un-mute
                 3      MIXOUTRVOL_       0    MIXOUTRVOL (Right Output Mixer PGA) to Earpiece Driver
                          TO_HPOUT2            0 = Mute
                                               1 = Un-mute
Register 33h HPOUT2 Mixer
 REGISTER       BIT          LABEL     DEFAULT                       DESCRIPTION                        REFER TO
 ADDRESS
  R52 (34h)      6     MIXOUTL_TO_L       0    MIXOUTL to Single-Ended Line Output on LINEOUT1N
Line Mixer (1)             INEOUT1N            0 = Mute
                                               1 = Un-mute
                                               (LINEOUT1_MODE = 1)
                 5       MIXOUTR_TO_      0    MIXOUTR to Single-Ended Line Output on LINEOUT1N
                          LINEOUT1N            0 = Mute
                                               1 = Un-mute
                                               (LINEOUT1_MODE = 1)
                                                                                           PP, March 2014, Rev 3.5
w
                                                                                                               280


Pre-Production                                                                                            WM8958
 REGISTER        BIT          LABEL   DEFAULT                       DESCRIPTION                             REFER TO
 ADDRESS
                  4      LINEOUT1_MO     0    LINEOUT1 Mode Select
                               DE             0 = Differential
                                              1 = Single-Ended
                  2      IN1R_TO_LINE    0    IN1R Input PGA to Differential Line Output on LINEOUT1
                              OUT1P           0 = Mute
                                              1 = Un-mute
                                              (LINEOUT1_MODE = 0)
                  1      IN1L_TO_LINE    0    IN1L Input PGA to Differential Line Output on LINEOUT1
                              OUT1P           0 = Mute
                                              1 = Un-mute
                                              (LINEOUT1_MODE = 0)
                  0      MIXOUTL_TO_L    0    Differential Mode (LINEOUT1_MODE = 0):
                            INEOUT1P          MIXOUTL to Differential Output on LINEOUT1
                                              0 = Mute
                                              1 = Un-mute
                                              Single Ended Mode (LINEOUT1_MODE = 1):
                                              MIXOUTL to Single-Ended Line Output on LINEOUT1P
                                              0 = Mute
                                              1 = Un-mute
Register 34h Line Mixer (1)
 REGISTER        BIT          LABEL   DEFAULT                       DESCRIPTION                             REFER TO
 ADDRESS
  R53 (35h)       6      MIXOUTR_TO_     0    MIXOUTR to Single-Ended Line Output on LINEOUT2N
Line Mixer (2)             LINEOUT2N          0 = Mute
                                              1 = Un-mute
                                              (LINEOUT2_MODE = 1)
                  5      MIXOUTL_TO_L    0    MIXOUTL to Single-Ended Line Output on LINEOUT2N
                            INEOUT2N          0 = Mute
                                              1 = Un-mute
                                              (LINEOUT2_MODE = 1)
                  4      LINEOUT2_MO     0    LINEOUT2 Mode Select
                               DE             0 = Differential
                                              1 = Single-Ended
                  2      IN1L_TO_LINE    0    IN1L Input PGA to Differential Line Output on LINEOUT2
                              OUT2P           0 = Mute
                                              1 = Un-mute
                                              (LINEOUT2_MODE = 0)
                  1      IN1R_TO_LINE    0    IN1R Input PGA to Differential Line Output on LINEOUT2
                              OUT2P           0 = Mute
                                              1 = Un-mute
                                              (LINEOUT2_MODE = 0)
                  0      MIXOUTR_TO_     0    Differential Mode (LINEOUT2_MODE = 0):
                           LINEOUT2P          MIXOUTR to Differential Output on LINEOUT2
                                              0 = Mute
                                              1 = Un-mute
                                              Single-Ended Mode (LINEOUT2_MODE = 0):
                                              MIXOUTR to Single-Ended Line Output on LINEOUT2P
                                              0 = Mute
                                              1 = Un-mute
Register 35h Line Mixer (2)
                                                                                               PP, March 2014, Rev 3.5
w
                                                                                                                  281


WM8958                                                                                              Pre-Production
 REGISTER       BIT          LABEL    DEFAULT                       DESCRIPTION                         REFER TO
 ADDRESS
 R54 (36h)        9       DAC2L_TO_SP    0    Left DAC2 to SPKMIXL Mute
  Speaker                    KMIXL            0 = Mute
   Mixer                                      1 = Un-mute
                  8      DAC2R_TO_SP     0    Right DAC2 to SPKMIXR Mute
                             KMIXR            0 = Mute
                                              1 = Un-mute
                  7      MIXINL_TO_SP    0    MIXINL (Left ADC bypass) to SPKMIXL Mute
                             KMIXL            0 = Mute
                                              1 = Un-mute
                  6      MIXINR_TO_SP    0    MIXINR (Right ADC bypass) to SPKMIXR Mute
                             KMIXR            0 = Mute
                                              1 = Un-mute
                  5      IN1LP_TO_SPK    0    IN1LP to SPKMIXL Mute
                              MIXL            0 = Mute
                                              1 = Un-mute
                                              Note that VMID_BUF_ENA must be set when using the
                                              IN1LP input to SPKMIXL.
                  4      IN1RP_TO_SPK    0    IN1RP to SPKMIXR Mute
                              MIXR            0 = Mute
                                              1 = Un-mute
                                              Note that VMID_BUF_ENA must be set when using the
                                              IN1RP input to SPKMIXR.
                  3       MIXOUTL_TO_    0    Left Mixer Output to SPKMIXL Mute
                            SPKMIXL           0 = Mute
                                              1 = Un-mute
                  2       MIXOUTR_TO_    0    Right Mixer Output to SPKMIXR Mute
                            SPKMIXR           0 = Mute
                                              1 = Un-mute
                  1       DAC1L_TO_SP    0    Left DAC1 to SPKMIXL Mute
                             KMIXL            0 = Mute
                                              1 = Un-mute
                  0      DAC1R_TO_SP     0    Right DAC1 to SPKMIXR Mute
                             KMIXR            0 = Mute
                                              1 = Un-mute
Register 36h Speaker Mixer
 REGISTER       BIT          LABEL    DEFAULT                       DESCRIPTION                         REFER TO
 ADDRESS
 R55 (37h)        7       LINEOUT1_FB    0    Enable ground loop noise feedback on LINEOUT1
 Additional                                   0 = Disabled
  Control                                     1 = Enabled
                  6       LINEOUT2_FB    0    Enable ground loop noise feedback on LINEOUT2
                                              0 = Disabled
                                              1 = Enabled
                  0           VROI       0    Buffered VMID to Analogue Line Output Resistance
                                              (Disabled Outputs)
                                              0 = 20k from buffered VMID to output
                                              1 = 500 from buffered VMID to output
Register 37h Additional Control
                                                                                           PP, March 2014, Rev 3.5
w
                                                                                                              282


Pre-Production                                                                                             WM8958
 REGISTER        BIT        LABEL    DEFAULT                        DESCRIPTION                              REFER TO
 ADDRESS
  R56 (38h)       7    LINEOUT_VMID     0    Enables VMID reference for line outputs in single-ended
 AntiPOP (1)              _BUF_ENA           mode
                                             0 = Disabled
                                             1 = Enabled
                  6    HPOUT2_IN_EN     0    HPOUT2MIX Mixer and Input Stage Enable
                                A            0 = Disabled
                                             1 = Enabled
                  5     LINEOUT1_DIS    0    Discharges LINEOUT1P and LINEOUT1N outputs
                               CH            0 = Not active
                                             1 = Actively discharging LINEOUT1P and LINEOUT1N
                  4     LINEOUT2_DIS    0    Discharges LINEOUT2P and LINEOUT2N outputs
                               CH            0 = Not active
                                             1 = Actively discharging LINEOUT2P and LINEOUT2N
Register 38h AntiPOP (1)
 REGISTER        BIT        LABEL    DEFAULT                        DESCRIPTION                              REFER TO
 ADDRESS
  R57 (39h)      6:5     VMID_RAMP      00   VMID soft start enable / slew rate control
 AntiPOP (2)                  [1:0]          00 = Normal slow start
                                             01 = Normal fast start
                                             10 = Soft slow start
                                             11 = Soft fast start
                                             If VMID_RAMP = 1X is selected for VMID start-up or shut-
                                             down, then the soft-start circuit must be reset by setting
                                             VMID_RAMP=00 after VMID is disabled, before VMID is re-
                                             enabled. VMID is disabled / enabled using the VMID_SEL
                                             register.
                  3     VMID_BUF_EN     0    VMID Buffer Enable
                                A            0 = Disabled
                                             1 = Enabled (provided VMID_SEL > 00)
                  2    STARTUP_BIAS     0    Enables the Start-Up bias current generator
                             _ENA            0 = Disabled
                                             1 = Enabled
                  1       BIAS_SRC      0    Selects the bias current source
                                             0 = Normal bias
                                             1 = Start-Up bias
                  0      VMID_DISCH     0    Connects VMID to ground
                                             0 = Disabled
                                             1 = Enabled
Register 39h AntiPOP (2)
 REGISTER        BIT        LABEL    DEFAULT                        DESCRIPTION                              REFER TO
 ADDRESS
  R59 (3Bh)      3:1     LDO1_VSEL     110   LDO1 Output Voltage Select
   LDO 1                      [2:0]          2.4V to 3.1V in 100mV steps
                                             000 = 2.4V
                                             001 = 2.5V
                                             010 = 2.6V
                                             011 = 2.7V
                                             100 = 2.8V
                                             101 = 2.9V
                                             110 = 3.0V
                                                                                                PP, March 2014, Rev 3.5
w
                                                                                                                   283


WM8958                                                                                   Pre-Production
 REGISTER       BIT      LABEL    DEFAULT                        DESCRIPTION                 REFER TO
 ADDRESS
                                          111 = 3.1V
                 0    LDO1_DISCH      1   LDO1 Discharge Select
                                          0 = LDO1 floating when disabled
                                          1 = LDO1 discharged when disabled
Register 3Bh LDO 1
 REGISTER       BIT      LABEL    DEFAULT                        DESCRIPTION                 REFER TO
 ADDRESS
 R60 (3Ch)      2:1    LDO2_VSEL     10   LDO2 Output Voltage Select
   LDO 2                  [1:0]           1.1V to 1.3V in 100mV steps
                                          00 = Reserved
                                          01 = 1.1V
                                          10 = 1.2V
                                          11 = 1.3V
                 0    LDO2_DISCH      1   LDO2 Discharge Select
                                          0 = LDO2 floating when disabled
                                          1 = LDO2 discharged when disabled
Register 3Ch LDO 2
 REGISTER       BIT      LABEL    DEFAULT                        DESCRIPTION                 REFER TO
 ADDRESS
 R61 (3Dh)       5    MICB1_RATE     1    Microphone Bias 1 Rate
 MICBIAS1                                 0 = Fast start-up / shut-down
                                          1 = Pop-free start-up / shut-down
                 4    MICB1_MODE      1   Microphone Bias 1 Mode
                                          0 = Regulator mode
                                          1 = Bypass mode
                3:1    MICB1_LVL    100   Microphone Bias 1 Voltage Control
                          [2:0]           (when MICB1_MODE = 0)
                                          000 = 1.5V
                                          001 = 1.8V
                                          010 = 1.9V
                                          011 = 2.0V
                                          100 = 2.2V
                                          101 = 2.4V
                                          110 = 2.5V
                                          111 = 2.6V
                 0    MICB1_DISCH    1    Microphone Bias 1 Discharge
                                          0 = MICBIAS1 floating when disabled
                                          1 = MICBIAS1 discharged when disabled
Register 3Dh MICBIAS1
 REGISTER       BIT      LABEL    DEFAULT                        DESCRIPTION                 REFER TO
 ADDRESS
 R62 (3Eh)       5    MICB2_RATE      1   Microphone Bias 2 Rate
 MICBIAS2                                 0 = Fast start-up / shut-down
                                          1 = Pop-free start-up / shut-down
                 4    MICB2_MODE      1   Microphone Bias 2 Mode
                                          0 = Regulator mode
                                          1 = Bypass mode
                                                                                PP, March 2014, Rev 3.5
w
                                                                                                   284


Pre-Production                                                                                               WM8958
 REGISTER       BIT         LABEL    DEFAULT                          DESCRIPTION                             REFER TO
 ADDRESS
                 3:1      MICB2_LVL    100   Microphone Bias 2 Voltage Control
                             [2:0]           (when MICB2_MODE = 0)
                                             000 = 1.5V
                                             001 = 1.8V
                                             010 = 1.9V
                                             011 = 2.0V
                                             100 = 2.2V
                                             101 = 2.4V
                                             110 = 2.5V
                                             111 = 2.6V
                  0      MICB2_DISCH     1   Microphone Bias 2 Discharge
                                             0 = MICBIAS2 floating when disabled
                                             1 = MICBIAS2 discharged when disabled
Register 3Eh MICBIAS2
 REGISTER       BIT         LABEL    DEFAULT                          DESCRIPTION                             REFER TO
 ADDRESS
 R76 (4Ch)       15        CP_ENA        0   Enable charge-pump digits
Charge Pump                                  0 = Disable
     (1)                                     1 = Enable
Register 4Ch Charge Pump (1)
 REGISTER       BIT         LABEL    DEFAULT                          DESCRIPTION                             REFER TO
 ADDRESS
 R77 (4Dh)       15       CP_DISCH       1   Charge Pump Discharge Select
Charge Pump                                  0 = Charge Pump outputs floating when disabled
     (2)                                     1 = Charge Pump outputs discharged when disabled
Register 4Dh Charge Pump (2)
 REGISTER       BIT         LABEL    DEFAULT                          DESCRIPTION                             REFER TO
 ADDRESS
  R81 (51h)      9:8    CP_DYN_SRC_     00   Selects the digital audio source for envelope tracking
 Class W (1)               SEL [1:0]         00 = AIF1, DAC Timeslot 0
                                             01 = AIF1, DAC Timeslot 1
                                             10 = AIF2, DAC data
                                             11 = Reserved
                  0      CP_DYN_PWR      0   Enable dynamic charge pump power control
                                             0 = charge pump controlled by volume register settings
                                             (Class G)
                                             1 = charge pump controlled by real-time audio level (Class
                                             W)
Register 51h Class W (1)
 REGISTER       BIT         LABEL    DEFAULT                          DESCRIPTION                             REFER TO
 ADDRESS
R84 (54h) DC     13     DCS_TRIG_SIN     0   Writing 1 to this bit selects a single DC offset correction for
  Servo (1)                 GLE_1            HPOUT1R.
                                             In readback, a value of 1 indicates that the DC Servo single
                                             correction is in progress.
                                                                                                 PP, March 2014, Rev 3.5
w
                                                                                                                    285


WM8958                                                                                                          Pre-Production
 REGISTER       BIT         LABEL      DEFAULT                           DESCRIPTION                               REFER TO
 ADDRESS
                12     DCS_TRIG_SIN        0    Writing 1 to this bit selects a single DC offset correction for
                            GLE_0               HPOUT1L.
                                                In readback, a value of 1 indicates that the DC Servo single
                                                correction is in progress.
                 9      DCS_TRIG_SE        0    Writing 1 to this bit selects a series of DC offset corrections
                           RIES_1               for HPOUT1R.
                                                In readback, a value of 1 indicates that the DC Servo DAC
                                                Write correction is in progress.
                 8      DCS_TRIG_SE        0    Writing 1 to this bit selects a series of DC offset corrections
                           RIES_0               for HPOUT1L.
                                                In readback, a value of 1 indicates that the DC Servo DAC
                                                Write correction is in progress.
                 5     DCS_TRIG_STA        0    Writing 1 to this bit selects Start-Up DC Servo mode for
                           RTUP_1               HPOUT1R.
                                                In readback, a value of 1 indicates that the DC Servo Start-
                                                Up correction is in progress.
                 4     DCS_TRIG_STA        0    Writing 1 to this bit selects Start-Up DC Servo mode for
                           RTUP_0               HPOUT1L.
                                                In readback, a value of 1 indicates that the DC Servo Start-
                                                Up correction is in progress.
                 3      DCS_TRIG_DA       0     Writing 1 to this bit selects DAC Write DC Servo mode for
                           C_WR_1               HPOUT1R.
                                                In readback, a value of 1 indicates that the DC Servo DAC
                                                Write correction is in progress.
                 2      DCS_TRIG_DA       0     Writing 1 to this bit selects DAC Write DC Servo mode for
                           C_WR_0               HPOUT1L.
                                                In readback, a value of 1 indicates that the DC Servo DAC
                                                Write correction is in progress.
                 1     DCS_ENA_CHA         0    DC Servo enable for HPOUT1R
                             N_1                0 = Disabled
                                                1 = Enabled
                 0     DCS_ENA_CHA         0    DC Servo enable for HPOUT1L
                             N_0                0 = Disabled
                                                1 = Enabled
Register 54h DC Servo (1)
 REGISTER       BIT         LABEL      DEFAULT                           DESCRIPTION                               REFER TO
 ADDRESS
R85 (55h) DC   11:5     DCS_SERIES_    010_1010 Number of DC Servo updates to perform in a series event.
  Servo (2)               NO_01 [6:0]           0 = 1 update
                                                1 = 2 updates
                                                ...
                                                127 = 128 updates
                3:0     DCS_TIMER_P      1010   Time between periodic updates. Time is calculated as
                        ERIOD_01 [3:0]          0.251s x (2^PERIOD),
                                                where PERIOD = DCS_TIMER_PERIOD_01.
                                                0000 = Off
                                                0001 = 0.502s
                                                ….
                                                1010 = 257s (4min 17s)
                                                1111 = 8225s (2hr 17min)
Register 55h DC Servo (2)
                                                                                                    PP, March 2014, Rev 3.5
w
                                                                                                                          286


Pre-Production                                                                                                  WM8958
 REGISTER       BIT         LABEL      DEFAULT                            DESCRIPTION                             REFER TO
 ADDRESS
R87 (57h) DC   15:8     DCS_DAC_WR     0000_0000 Writing to this field sets the DC Offset value for HPOUT1R
  Servo (4)               _VAL_1 [7:0]           in DAC Write DC Servo mode.
                                                 Reading this field gives the current DC Offset value for
                                                 HPOUT1R.
                                                 Two’s complement format.
                                                 LSB is 0.25mV.
                                                 Range is -32mV to +31.75mV
                7:0     DCS_DAC_WR     0000_0000 Writing to this field sets the DC Offset value for HPOUT1L
                          _VAL_0 [7:0]           in DAC Write DC Servo mode.
                                                 Reading this field gives the current DC Offset value for
                                                 HPOUT1L.
                                                 Two’s complement format.
                                                 LSB is 0.25mV.
                                                 Range is -32mV to +31.75mV
Register 57h DC Servo (4)
 REGISTER       BIT         LABEL      DEFAULT                            DESCRIPTION                             REFER TO
 ADDRESS
R88 (58h) DC    9:8    DCS_CAL_COM         00    DC Servo Complete status
    Servo                 PLETE [1:0]            0 = DAC Write or Start-Up DC Servo mode not completed.
 Readback                                        1 = DAC Write or Start-Up DC Servo mode complete.
                                                 Bit [1] = HPOUT1R
                                                 Bit [0] = HPOUT1L
                5:4     DCS_DAC_WR         00    DC Servo DAC Write status
                         _COMPLETE               0 = DAC Write DC Servo mode not completed.
                             [1:0]               1 = DAC Write DC Servo mode complete.
                                                 Bit [1] = HPOUT1R
                                                 Bit [0] = HPOUT1L
                1:0    DCS_STARTUP         00    DC Servo Start-Up status
                         _COMPLETE               0 = Start-Up DC Servo mode not completed.
                             [1:0]               1 = Start-Up DC Servo mode complete.
                                                 Bit [1] = HPOUT1R
                                                 Bit [0] = HPOUT1L
Register 58h DC Servo Readback
 REGISTER       BIT         LABEL      DEFAULT                            DESCRIPTION                             REFER TO
 ADDRESS
  R96 (60h)      7     HPOUT1L_RMV          0    Removes HPOUT1L short
Analogue HP                _SHORT                0 = HPOUT1L short enabled
     (1)                                         1 = HPOUT1L short removed
                                                 For normal operation, this bit should be set as the final step
                                                 of the HPOUT1L Enable sequence.
                 6     HPOUT1L_OUT          0    Enables HPOUT1L output stage
                               P                 0 = Disabled
                                                 1 = Enabled
                                                 For normal operation, this bit should be set to 1 after the DC
                                                 offset cancellation has been scheduled.
                                                                                                     PP, March 2014, Rev 3.5
w
                                                                                                                        287


WM8958                                                                                                      Pre-Production
 REGISTER       BIT         LABEL     DEFAULT                         DESCRIPTION                              REFER TO
 ADDRESS
                 5     HPOUT1L_DLY        0   Enables HPOUT1L intermediate stage
                                              0 = Disabled
                                              1 = Enabled
                                              For normal operation, this bit should be set to 1 after the
                                              output signal path has been configured, and before DC
                                              offset cancellation is scheduled. This bit should be set with
                                              at least 20us delay after HPOUT1L_ENA.
                 3     HPOUT1R_RMV        0   Removes HPOUT1R short
                           _SHORT             0 = HPOUT1R short enabled
                                              1 = HPOUT1R short removed
                                              For normal operation, this bit should be set as the final step
                                              of the HPOUT1R Enable sequence.
                 2     HPOUT1R_OUT        0   Enables HPOUT1R output stage
                               P              0 = Disabled
                                              1 = Enabled
                                              For normal operation, this bit should be set to 1 after the DC
                                              offset cancellation has been scheduled.
                 1     HPOUT1R_DLY        0   Enables HPOUT1R intermediate stage
                                              0 = Disabled
                                              1 = Enabled
                                              For normal operation, this bit should be set to 1 after the
                                              output signal path has been configured, and before DC
                                              offset cancellation is scheduled. This bit should be set with
                                              at least 20us delay after HPOUT1R_ENA.
Register 60h Analogue HP (1)
 REGISTER       BIT         LABEL     DEFAULT                         DESCRIPTION                              REFER TO
 ADDRESS
 R208 (D0h)    15:12   MICD_BIAS_ST     0101  Mic Detect Bias Startup Delay
Mic Detect 1            ARTTIME [3:0]         (If MICBIAS2 is not enabled already, this field selects the
                                              delay time allowed for MICBIAS2 to startup prior to
                                              performing the MICDET function.)
                                              0000 = 0ms (continuous)
                                              0001 = 0.25ms
                                              0010 = 0.5ms
                                              0011 = 1ms
                                              0100 = 2ms
                                              0101 = 4ms
                                              0110 = 8ms
                                              0111 = 16ms
                                              1000 = 32ms
                                              1001 = 64ms
                                              1010 = 128ms
                                              1011 = 256ms
                                              1100 to 1111 = 512ms
                11:8     MICD_RATE      0110  Mic Detect Rate
                             [3:0]            (Selects the delay between successive Mic Detect
                                              measurements.)
                                              0000 = 0ms (continuous)
                                              0001 = 0.25ms
                                              0010 = 0.5ms
                                              0011 = 1ms
                                              0100 = 2ms
                                              0101 = 4ms
                                                                                                 PP, March 2014, Rev 3.5
w
                                                                                                                      288


Pre-Production                                                                                              WM8958
 REGISTER       BIT         LABEL      DEFAULT                          DESCRIPTION                           REFER TO
 ADDRESS
                                                 0110 = 8ms
                                                 0111 = 16ms
                                                 1000 = 32ms
                                                 1001 = 64ms
                                                 1010 = 128ms
                                                 1011 = 256ms
                                                 1100 to 1111 = 512ms
                 1      MICD_DBTIME        0     Mic Detect De-bounce
                                                 0 = 2 measurements
                                                 1 = 4 measurements
                 0        MICD_ENA         0     Mic Detect Enable
                                                 0 = Disabled
                                                 1 = Enabled
Register D0h Mic Detect 1
 REGISTER       BIT         LABEL      DEFAULT                          DESCRIPTION                           REFER TO
 ADDRESS
 R209 (D1h)     7:0     MICD_LVL_SEL   0111_1111 Mic Detect Level Select
Mic Detect 2                 [7:0]               (enables Mic Detection in specific impedance ranges)
                                                 [7] = Not used - must be set to 0
                                                 [6] = Enable >475 ohm detection
                                                 [5] = Enable 326 ohm detection
                                                 [4] = Enable 152 ohm detection
                                                 [3] = Enable 77 ohm detection
                                                 [2] = Enable 47.6 ohm detection
                                                 [1] = Enable 29.4 ohm detection
                                                 [0] = Enable 14 ohm detection
                                                 Note that the impedance values quoted assume that a
                                                 microphone (475ohm-30kohm) is also present on the
                                                 MICDET pin.
Register D1h Mic Detect 2
 REGISTER       BIT         LABEL      DEFAULT                          DESCRIPTION                           REFER TO
 ADDRESS
 R210 (D2h)     10:2    MICD_LVL [8:0] 0_0000_00 Mic Detect Level
Mic Detect 3                               00    (indicates the measured impedance)
                                                 [8] = Not used
                                                 [7] = >475 ohm, <30k ohm
                                                 [6] = 326 ohm
                                                 [5] = 152 ohm
                                                 [4] = 77 ohm
                                                 [3] = 47.6 ohm
                                                 [2] = 29.4 ohm
                                                 [1] = 14 ohm
                                                 [0] = <2 ohm
                                                 Note that the impedance values quoted assume that a
                                                 microphone (475ohm-30kohm) is also present on the
                                                 MICDET pin.
                 1        MICD_VALID       0     Mic Detect Data Valid
                                                 0 = Not Valid
                                                 1 = Valid
                                                                                                 PP, March 2014, Rev 3.5
w
                                                                                                                    289


WM8958                                                                                                          Pre-Production
 REGISTER       BIT          LABEL      DEFAULT                           DESCRIPTION                              REFER TO
 ADDRESS
                  0        MICD_STS         0    Mic Detect Status
                                                 0 = No Mic Accessory present (impedance is >30k ohm)
                                                 1 = Mic Accessory is present (impedance is <30k ohm)
Register D2h Mic Detect 3
 REGISTER       BIT          LABEL      DEFAULT                           DESCRIPTION                              REFER TO
 ADDRESS
R256 (0100h)    3:0      CHIP_REV [3:0]          Chip revision
    Chip
  Revision
Register 0100h Chip Revision
 REGISTER       BIT          LABEL      DEFAULT                           DESCRIPTION                              REFER TO
 ADDRESS
R257 (0101h)      2        AUTO_INC         1    Enables address auto-increment
   Control                                       0 = Disabled
  Interface                                      1 = Enabled
Register 0101h Control Interface
 REGISTER       BIT          LABEL      DEFAULT                           DESCRIPTION                              REFER TO
 ADDRESS
R272 (0110h)     15       WSEQ_ENA         0     Write Sequencer Enable.
    Write                                        0 = Disabled
 Sequencer                                       1 = Enabled
   Ctrl (1)
                  9      WSEQ_ABORT         0    Writing a 1 to this bit aborts the current sequence and
                                                 returns control of the device back to the serial control
                                                 interface.
                  8      WSEQ_START         0    Writing a 1 to this bit starts the write sequencer at the index
                                                 location selected by WSEQ_START_INDEX. The sequence
                                                 continues until it reaches an “End of sequence” flag. At the
                                                 end of the sequence, this bit will be reset by the Write
                                                 Sequencer.
                6:0     WSEQ_START_     000_0000 Sequence Start Index. This field determines the memory
                           INDEX [6:0]           location of the first command in the selected sequence.
                                                 There are 127 Write Sequencer RAM addresses:
                                                 00h = WSEQ_ADDR0 (R12288)
                                                 01h = WSEQ_ADDR1 (R12292)
                                                 02h = WSEQ_ADDR2 (R12296)
                                                 ….
                                                 7Fh = WSEQ_ADDR127 (R12796)
Register 0110h Write Sequencer Ctrl (1)
 REGISTER       BIT          LABEL      DEFAULT                           DESCRIPTION                              REFER TO
 ADDRESS
R273 (0111h)     8        WSEQ_BUSY        0     Sequencer Busy flag (Read Only).
    Write                                        0 = Sequencer idle
 Sequencer                                       1 = Sequencer busy
   Ctrl (2)
                                                 Note: it is not possible to write to control registers via the
                                                 control interface while the Sequencer is Busy.
                                                                                                      PP, March 2014, Rev 3.5
w
                                                                                                                          290


Pre-Production                                                                                                WM8958
 REGISTER       BIT         LABEL       DEFAULT                         DESCRIPTION                             REFER TO
 ADDRESS
                6:0     WSEQ_CURRE      000_0000 Sequence Current Index. This indicates the memory
                        NT_INDEX [6:0]           location of the most recently accessed command in the
                                                 write sequencer memory.
                                                 Coding is the same as WSEQ_START_INDEX.
Register 0111h Write Sequencer Ctrl (2)
 REGISTER       BIT         LABEL       DEFAULT                         DESCRIPTION                             REFER TO
 ADDRESS
R512 (0200h)    4:3     AIF1CLK_SRC         00   AIF1CLK Source Select
    AIF1                      [1:0]              00 = MCLK1
 Clocking (1)                                    01 = MCLK2
                                                 10 = FLL1
                                                 11 = FLL2
                 2       AIF1CLK_INV        0    AIF1CLK Invert
                                                 0 = AIF1CLK not inverted
                                                 1 = AIF1CLK inverted
                 1       AIF1CLK_DIV        0    AIF1CLK Divider
                                                 0 = AIF1CLK
                                                 1 = AIF1CLK / 2
                 0      AIF1CLK_ENA         0    AIF1CLK Enable
                                                 0 = Disabled
                                                 1 = Enabled
Register 0200h AIF1 Clocking (1)
 REGISTER       BIT         LABEL       DEFAULT                         DESCRIPTION                             REFER TO
 ADDRESS
R513 (0201h)    5:3      AIF1DAC_DIV       000   Selects the AIF1 input path sample rate relative to the AIF1
    AIF1                      [2:0]              output path sample rate.
 Clocking (2)                                    This field should only be changed from default in modes
                                                 where the AIF1 input path sample rate is slower than the
                                                 AIF1 output path sample rate.
                                                 000 = Divide by 1
                                                 001 = Divide by 1.5
                                                 010 = Divide by 2
                                                 011 = Divide by 3
                                                 100 = Divide by 4
                                                 101 = Divide by 5.5
                                                 110 = Divide by 6
                                                 111 = Reserved
                2:0      AIF1ADC_DIV       000   Selects the AIF1 output path sample rate relative to the
                              [2:0]              AIF1 input path sample rate.
                                                 This field should only be changed from default in modes
                                                 where the AIF1 output path sample rate is slower than the
                                                 AIF1 input path sample rate.
                                                 000 = Divide by 1
                                                 001 = Divide by 1.5
                                                 010 = Divide by 2
                                                 011 = Divide by 3
                                                 100 = Divide by 4
                                                 101 = Divide by 5.5
                                                 110 = Divide by 6
                                                 111 = Reserved
Register 0201h AIF1 Clocking (2)
                                                                                                   PP, March 2014, Rev 3.5
w
                                                                                                                      291


WM8958                                                                                                   Pre-Production
 REGISTER       BIT         LABEL    DEFAULT                        DESCRIPTION                             REFER TO
 ADDRESS
R516 (0204h)    4:3     AIF2CLK_SRC     00   AIF2CLK Source Select
    AIF2                      [1:0]          00 = MCLK1
 Clocking (1)                                01 = MCLK2
                                             10 = FLL1
                                             11 = FLL2
                 2       AIF2CLK_INV    0    AIF2CLK Invert
                                             0 = AIF2CLK not inverted
                                             1 = AIF2CLK inverted
                 1       AIF2CLK_DIV    0    AIF2CLK Divider
                                             0 = AIF2CLK
                                             1 = AIF2CLK / 2
                 0      AIF2CLK_ENA     0    AIF2CLK Enable
                                             0 = Disabled
                                             1 = Enabled
Register 0204h AIF2 Clocking (1)
 REGISTER       BIT         LABEL    DEFAULT                        DESCRIPTION                             REFER TO
 ADDRESS
R517 (0205h)    5:3     AIF2DAC_DIV    000   Selects the AIF2 input path sample rate relative to the AIF2
    AIF2                      [2:0]          output path sample rate.
 Clocking (2)                                This field should only be changed from default in modes
                                             where the AIF2 input path sample rate is slower than the
                                             AIF2 output path sample rate.
                                             000 = Divide by 1
                                             001 = Divide by 1.5
                                             010 = Divide by 2
                                             011 = Divide by 3
                                             100 = Divide by 4
                                             101 = Divide by 5.5
                                             110 = Divide by 6
                                             111 = Reserved
                2:0     AIF2ADC_DIV    000   Selects the AIF2 output path sample rate relative to the
                              [2:0]          AIF2 input path sample rate.
                                             This field should only be changed from default in modes
                                             where the AIF2 output path sample rate is slower than the
                                             AIF2 input path sample rate.
                                             000 = Divide by 1
                                             001 = Divide by 1.5
                                             010 = Divide by 2
                                             011 = Divide by 3
                                             100 = Divide by 4
                                             101 = Divide by 5.5
                                             110 = Divide by 6
                                             111 = Reserved
Register 0205h AIF2 Clocking (2)
 REGISTER       BIT         LABEL    DEFAULT                         DESCRIPTION                            REFER TO
 ADDRESS
R520 (0208h)     14     DSP2CLK_ENA      0   MBC Processor Clock Enable
 Clocking (1)                                0 = Disabled
                                             1 = Enabled
                  4      TOCLK_ENA       0   Slow Clock (TOCLK) Enable
                                                                                               PP, March 2014, Rev 3.5
w
                                                                                                                   292


Pre-Production                                                                                         WM8958
 REGISTER       BIT         LABEL    DEFAULT                         DESCRIPTION                         REFER TO
 ADDRESS
                                             0 = Disabled
                                             1 = Enabled
                                             This clock is required for zero-cross timeout.
                  3     AIF1DSPCLK_E    0    AIF1 Processing Clock Enable
                              NA             0 = Disabled
                                             1 = Enabled
                  2     AIF2DSPCLK_E    0    AIF2 Processing Clock Enable
                              NA             0 = Disabled
                                             1 = Enabled
                  1     SYSDSPCLK_E     0    Digital Mixing Processor Clock Enable
                              NA             0 = Disabled
                                             1 = Enabled
                  0      SYSCLK_SRC     0    SYSCLK Source Select
                                             0 = AIF1CLK
                                             1 = AIF2CLK
Register 0208h Clocking (1)
 REGISTER       BIT         LABEL    DEFAULT                        DESCRIPTION                          REFER TO
 ADDRESS
R521 (0209h)    10:8      TOCLK_DIV    000   Slow Clock (TOCLK ) Divider
 Clocking (2)                [2:0]           (Sets TOCLK rate relative to 256kHz.)
                                             000 = Divide by 256 (1kHz)
                                             001 = Divide by 512 (500Hz)
                                             010 = Divide by 1024 (250Hz)
                                             011 = Divide by 2048 (125Hz)
                                             100 = Divide by 4096 (62.5Hz)
                                             101 = Divide by 8192 (31.2Hz)
                                             110 = Divide by 16384 (15.6Hz)
                                             111 = Divide by 32768 (7.8Hz)
                 6:4      DBCLK_DIV    000   De-bounce Clock (DBCLK) Divider
                             [2:0]           (Sets DBCLK rate relative to 256kHz.)
                                             000 = Divide by 256 (1kHz)
                                             001 = Divide by 2048 (125Hz)
                                             010 = Divide by 4096 (62.5Hz)
                                             011 = Divide by 8192 (31.2Hz)
                                             100 = Divide by 16384 (15.6Hz)
                                             101 = Divide by 32768 (7.8Hz)
                                             110 = Divide by 65536 (3.9Hz)
                                             111 = Divide by 131072 (1.95Hz)
                 2:0      OPCLK_DIV    000   GPIO Output Clock (OPCLK) Divider
                             [2:0]           000 = SYSCLK
                                             001 = SYSCLK / 2
                                             010 = SYSCLK / 3
                                             011 = SYSCLK / 4
                                             100 = SYSCLK / 6
                                             101 = SYSCLK / 8
                                             110 = SYSCLK / 12
                                             111 = SYSCLK / 16
Register 0209h Clocking (2)
                                                                                            PP, March 2014, Rev 3.5
w
                                                                                                               293


WM8958                                                                                              Pre-Production
 REGISTER       BIT         LABEL      DEFAULT                       DESCRIPTION                        REFER TO
 ADDRESS
R528 (0210h)    7:4      AIF1_SR [3:0]   1000  Selects the AIF1 Sample Rate (fs)
 AIF1 Rate                                     0000 = 8kHz
                                               0001 = 11.025kHz
                                               0010 = 12kHz
                                               0011 = 16kHz
                                               0100 = 22.05kHz
                                               0101 = 24kHz
                                               0110 = 32kHz
                                               0111 = 44.1kHz
                                               1000 = 48kHz
                                               1001 = 88.2kHz
                                               1010 = 96kHz
                                               All other codes = Reserved
                                               Note that 88.2kHz and 96kHz modes are supported for
                                               AIF1 input (DAC playback) only.
                3:0    AIF1CLK_RATE      0011  Selects the AIF1CLK / fs ratio
                             [3:0]             0000 = Reserved
                                               0001 = 128
                                               0010 = 192
                                               0011 = 256
                                               0100 = 384
                                               0101 = 512
                                               0110 = 768
                                               0111 = 1024
                                               1000 = 1408
                                               1001 = 1536
                                               All other codes = Reserved
Register 0210h AIF1 Rate
 REGISTER       BIT         LABEL      DEFAULT                       DESCRIPTION                        REFER TO
 ADDRESS
R529 (0211h)    7:4      AIF2_SR [3:0]   1000  Selects the AIF2 Sample Rate (fs)
 AIF2 Rate                                     0000 = 8kHz
                                               0001 = 11.025kHz
                                               0010 = 12kHz
                                               0011 = 16kHz
                                               0100 = 22.05kHz
                                               0101 = 24kHz
                                               0110 = 32kHz
                                               0111 = 44.1kHz
                                               1000 = 48kHz
                                               1001 = 88.2kHz
                                               1010 = 96kHz
                                               All other codes = Reserved
                                               Note that 88.2kHz and 96kHz modes are supported for
                                               AIF2 input (DAC playback) only.
                3:0    AIF2CLK_RATE      0011  Selects the AIF2CLK / fs ratio
                             [3:0]             0000 = Reserved
                                               0001 = 128
                                               0010 = 192
                                               0011 = 256
                                               0100 = 384
                                               0101 = 512
                                                                                           PP, March 2014, Rev 3.5
w
                                                                                                              294


Pre-Production                                                                                              WM8958
 REGISTER       BIT         LABEL   DEFAULT                            DESCRIPTION                            REFER TO
 ADDRESS
                                             0110 = 768
                                             0111 = 1024
                                             1000 = 1408
                                             1001 = 1536
                                             All other codes = Reserved
Register 0211h AIF2 Rate
 REGISTER       BIT         LABEL   DEFAULT                            DESCRIPTION                            REFER TO
 ADDRESS
R530 (0212h)     3:0     SR_ERROR      0000  Sample Rate Configuration status
 Rate Status                  [3:0]          Indicates an error with the register settings related to
                                             sample rate configuration
                                             0000 = No errors
                                             0001 = Invalid sample rate
                                             0010 = Invalid AIF divide
                                             0011 = ADC and DAC divides both set in an interface
                                             0100 = Invalid combination of AIF divides and sample-rate
                                             0101 = Invalid set of enables for 96kHz mode
                                             0110 = Invalid SYSCLK rate (derived from AIF1CLK_RATE
                                             or AIF2CLK_RATE)
                                             0111 = Mixed ADC and DAC rates in SYSCLK AIF when
                                             AIFs are asynchronous
                                             1000 = Invalid combination of sample rates when both AIFs
                                             are from the same clock source
                                             1001 = Invalid combination of mixed ADC/DAC AIFs when
                                             both from the same clock source
                                             1010 = AIF1DAC2 (Timeslot 1) ports enabled when SRCs
                                             connected to AIF1
Register 0212h Rate Status
 REGISTER       BIT         LABEL   DEFAULT                            DESCRIPTION                            REFER TO
 ADDRESS
R544 (0220h)      1     FLL1_OSC_EN     0    FLL1 Oscillator enable
FLL1 Control                    A            0 = Disabled
     (1)                                     1 = Enabled
                                             (Note that this field is required for free-running FLL1 modes
                                             only)
                  0        FLL1_ENA     0    FLL1 Enable
                                             0 = Disabled
                                             1 = Enabled
                                             This should be set as the final step of the FLL1 enable
                                             sequence, ie. after the other FLL registers have been
                                             configured.
Register 0220h FLL1 Control (1)
 REGISTER       BIT         LABEL   DEFAULT                            DESCRIPTION                            REFER TO
 ADDRESS
R545 (0221h)    13:8    FLL1_OUTDIV  00_0000 FLL1 FOUT clock divider
FLL1 Control                  [5:0]          000000 = Reserved
     (2)                                     000001 = Reserved
                                             000010 = Reserved
                                             000011 = 4
                                             000100 = 5
                                             000101 = 6
                                                                                                 PP, March 2014, Rev 3.5
w
                                                                                                                    295


WM8958                                                                                                       Pre-Production
 REGISTER       BIT         LABEL     DEFAULT                             DESCRIPTION                            REFER TO
 ADDRESS
                                                …
                                                111110 = 63
                                                111111 = 64
                                                (FOUT = FVCO / FLL1_OUTDIV)
                 2:0   FLL1_FRATIO       000    FLL1 FVCO clock divider
                              [2:0]             000 = 1
                                                001 = 2
                                                010 = 4
                                                011 = 8
                                                1XX = 16
Register 0221h FLL1 Control (2)
 REGISTER       BIT         LABEL     DEFAULT                             DESCRIPTION                            REFER TO
 ADDRESS
R546 (0222h)    15:0    FLL1_K [15:0] 0000_0000 FLL1 Fractional multiply for FREF
FLL1 Control                          _0000_000 (MSB = 0.5)
     (3)                                   0
Register 0222h FLL1 Control (3)
 REGISTER       BIT         LABEL     DEFAULT                             DESCRIPTION                            REFER TO
 ADDRESS
R547 (0223h)    14:5    FLL1_N [9:0]  00_0000_0 FLL1 Integer multiply for FREF
FLL1 Control                             000    (LSB = 1)
     (4)
Register 0223h FLL1 Control (4)
 REGISTER       BIT         LABEL     DEFAULT                             DESCRIPTION                            REFER TO
 ADDRESS
R548 (0224h)     15       FLL1_BYP        0     FLL1 Bypass Select
FLL1 Control                                    0 = Disabled
     (5)                                        1 = Enabled
                                                When FLL1_BYP is set, the FLL1 output is derived directly
                                                from BCLK1. In this case, FLL1 can be disabled.
                12:7   FLL1_FRC_NC     01_1001  FLL1 Forced oscillator value
                         O_VAL [5:0]            Valid range is 000000 to 111111
                                                0x19h (011001) = 12MHz approx
                                                (Note that this field is required for free-running FLL modes
                                                only)
                  6    FLL1_FRC_NC        0     FLL1 Forced control select
                                O               0 = Normal
                                                1 = FLL1 oscillator controlled by FLL1_FRC_NCO_VAL
                                                (Note that this field is required for free-running FLL modes
                                                only)
                 4:3  FLL1_REFCLK_        00    FLL1 Clock Reference Divider
                           DIV [1:0]            00 = MCLK / 1
                                                01 = MCLK / 2
                                                10 = MCLK / 4
                                                11 = MCLK / 8
                                                MCLK (or other input reference) must be divided down to
                                                <=13.5MHz.
                                                                                                    PP, March 2014, Rev 3.5
w
                                                                                                                       296


Pre-Production                                                                                               WM8958
 REGISTER       BIT         LABEL   DEFAULT                             DESCRIPTION                            REFER TO
 ADDRESS
                                              For lower power operation, the reference clock can be
                                              divided down further if desired.
                1:0   FLL1_REFCLK_     00     FLL1 Clock source
                          SRC [1:0]           00 = MCLK1
                                              01 = MCLK2
                                              10 = LRCLK1
                                              11 = BCLK1
Register 0224h FLL1 Control (5)
 REGISTER       BIT         LABEL   DEFAULT                             DESCRIPTION                            REFER TO
 ADDRESS
R550 (0226h)    15:0   FLL1_LAMBDA  0000_0000 FLL Fractional multiply for FREF
 FLL1 EFS 1                  [15:0] _0000_000 This field sets the denominator (dividing) part of the
                                        0     FLL1_THETA / FLL1_LAMBDA ratio.
                                              Coded as LSB = 1.
Register 0226h FLL1 EFS 1
 REGISTER       BIT         LABEL   DEFAULT                             DESCRIPTION                            REFER TO
 ADDRESS
R550 (0226h)     2        Reserved      1     Reserved - do not change
 FLL1 EFS 1      1        Reserved      1     Reserved - do not change
                 0    FLL1_EFS_ENA      0     FLL Fractional Mode EFS enable
                                              0 = Integer Mode
                                              1 = Fractional Mode
                                              This bit should be set to 1 when FLL1_THETA > 0.
Register 0227h FLL1 EFS 2
 REGISTER       BIT         LABEL   DEFAULT                             DESCRIPTION                            REFER TO
 ADDRESS
R576 (0240h)     1     FLL2_OSC_EN      0     FLL2 Oscillator enable
FLL2 Control                    A             0 = Disabled
     (1)                                      1 = Enabled
                                              (Note that this field is required for free-running FLL2 modes
                                              only)
                 0       FLL2_ENA       0     FLL2 Enable
                                              0 = Disabled
                                              1 = Enabled
                                              This should be set as the final step of the FLL2 enable
                                              sequence, ie. after the other FLL registers have been
                                              configured.
Register 0240h FLL2 Control (1)
                                                                                                  PP, March 2014, Rev 3.5
w
                                                                                                                     297


WM8958                                                                                                       Pre-Production
 REGISTER       BIT         LABEL     DEFAULT                             DESCRIPTION                            REFER TO
 ADDRESS
R577 (0241h)    13:8   FLL2_OUTDIV     00_0000  FLL2 FOUT clock divider
FLL2 Control                  [5:0]             000000 = Reserved
     (2)                                        000001 = Reserved
                                                000010 = Reserved
                                                000011 = 4
                                                000100 = 5
                                                000101 = 6
                                                …
                                                111110 = 63
                                                111111 = 64
                                                (FOUT = FVCO / FLL2_OUTDIV)
                 2:0   FLL2_FRATIO       000    FLL2 FVCO clock divider
                              [2:0]             000 = 1
                                                001 = 2
                                                010 = 4
                                                011 = 8
                                                1XX = 16
Register 0241h FLL2 Control (2)
 REGISTER       BIT         LABEL     DEFAULT                             DESCRIPTION                            REFER TO
 ADDRESS
R578 (0242h)    15:0    FLL2_K [15:0] 0000_0000 FLL2 Fractional multiply for FREF
FLL2 Control                          _0000_000 (MSB = 0.5)
     (3)                                  0
Register 0242h FLL2 Control (3)
 REGISTER       BIT         LABEL     DEFAULT                             DESCRIPTION                            REFER TO
 ADDRESS
R579 (0243h)    14:5    FLL2_N [9:0]  00_0000_0 FLL2 Integer multiply for FREF
FLL2 Control                             000    (LSB = 1)
     (4)
Register 0243h FLL2 Control (4)
 REGISTER       BIT         LABEL     DEFAULT                             DESCRIPTION                            REFER TO
 ADDRESS
R580 (0244h)     15       FLL2_BYP        0     FLL2 Bypass Select
FLL2 Control                                    0 = Disabled
     (5)                                        1 = Enabled
                                                When FLL2_BYP is set, the FLL2 output is derived directly
                                                from BCLK2. In this case, FLL2 can be disabled.
                12:7   FLL2_FRC_NC     01_1001  FLL2 Forced oscillator value
                         O_VAL [5:0]            Valid range is 000000 to 111111
                                                0x19h (011001) = 12MHz approx
                                                (Note that this field is required for free-running FLL modes
                                                only)
                  6    FLL2_FRC_NC        0     FLL2 Forced control select
                                O               0 = Normal
                                                1 = FLL2 oscillator controlled by FLL2_FRC_NCO_VAL
                                                (Note that this field is required for free-running FLL modes
                                                only)
                                                                                                    PP, March 2014, Rev 3.5
w
                                                                                                                       298


Pre-Production                                                                                               WM8958
 REGISTER       BIT         LABEL    DEFAULT                          DESCRIPTION                              REFER TO
 ADDRESS
                4:3   FLL2_REFCLK_      00     FLL2 Clock Reference Divider
                           DIV [1:0]           00 = MCLK / 1
                                               01 = MCLK / 2
                                               10 = MCLK / 4
                                               11 = MCLK / 8
                                               MCLK (or other input reference) must be divided down to
                                               <=13.5MHz.
                                               For lower power operation, the reference clock can be
                                               divided down further if desired.
                1:0   FLL2_REFCLK_      00     FLL2 Clock source
                          SRC [1:0]            00 = MCLK1
                                               01 = MCLK2
                                               10 = LRCLK2
                                               11 = BCLK2
Register 0244h FLL2 Control (5)
 REGISTER       BIT         LABEL    DEFAULT                           DESCRIPTION                             REFER TO
 ADDRESS
R582 (0246h)    15:0   FLL2_LAMBDA   0000_0000 FLL Fractional multiply for FREF
 FLL2 EFS 1                  [15:0]  _0000_000 This field sets the denominator (dividing) part of the
                                         0     FLL2_THETA / FLL2_LAMBDA ratio.
                                               Coded as LSB = 1.
Register 0246h FLL2 EFS 1
 REGISTER       BIT         LABEL    DEFAULT                           DESCRIPTION                             REFER TO
 ADDRESS
R583 (0247h)      2       Reserved       1     Reserved - do not change
 FLL2 EFS 2       1       Reserved       1     Reserved - do not change
                  0   FLL2_EFS_ENA       0     FLL Fractional Mode EFS enable
                                               0 = Integer Mode
                                               1 = Fractional Mode
                                               This bit should be set to 1 when FLL2_THETA > 0.
Register 0247h FLL2 EFS 2
 REGISTER       BIT         LABEL    DEFAULT                          DESCRIPTION                              REFER TO
 ADDRESS
R768 (0300h)     15   AIF1ADCL_SRC       0     AIF1 Left Digital Audio interface source
AIF1 Control                                   0 = Left ADC data is output on left channel
     (1)                                       1 = Right ADC data is output on left channel
                 14    AIF1ADCR_SR       1     AIF1 Right Digital Audio interface source
                                C              0 = Left ADC data is output on right channel
                                               1 = Right ADC data is output on right channel
                 13    AIF1ADC_TDM       0     AIF1 transmit (ADC) TDM Control
                                               0 = ADCDAT1 drives logic ‘0’ when not transmitting data
                                               1 = ADCDAT1 is tri-stated when not transmitting data
                  8   AIF1_BCLK_INV      0     BCLK1 Invert
                                               0 = BCLK1 not inverted
                                               1 = BCLK1 inverted
                                               Note that AIF1_BCLK_INV selects the BCLK1 polarity in
                                                                                                  PP, March 2014, Rev 3.5
w
                                                                                                                     299


WM8958                                                                                                 Pre-Production
 REGISTER       BIT          LABEL    DEFAULT                        DESCRIPTION                           REFER TO
 ADDRESS
                                              Master mode and in Slave mode.
                6:5     AIF1_WL [1:0]    10   AIF1 Digital Audio Interface Word Length
                                              00 = 16 bits
                                              01 = 20 bits
                                              10 = 24 bits
                                              11 = 32 bits
                                              Note - 8-bit modes can be selected using the “Companding”
                                              control bits.
                4:3    AIF1_FMT [1:0]    10   AIF1 Digital Audio Interface Format
                                              00 = Right justified
                                              01 = Left justified
                                              10 = I2S Format
                                              11 = DSP Mode
Register 0300h AIF1 Control (1)
 REGISTER       BIT          LABEL    DEFAULT                        DESCRIPTION                           REFER TO
 ADDRESS
R769 (0301h)    15     AIF1DACL_SRC       0   AIF1 Left Receive Data Source Select
AIF1 Control                                  0 = Left DAC receives left interface data
     (2)                                      1 = Left DAC receives right interface data
                14     AIF1DACR_SR        1   AIF1 Right Receive Data Source Select
                                C             0 = Right DAC receives left interface data
                                              1 = Right DAC receives right interface data
               11:10   AIF1DAC_BOO       00   AIF1 Input Path Boost
                            ST [1:0]          00 = 0dB
                                              01 = +6dB (input must not exceed -6dBFS)
                                              10 = +12dB (input must not exceed -12dBFS)
                                              11 = +18dB (input must not exceed -18dBFS)
                 8       AIF1_MONO        0   AIF1 DSP Mono Mode
                                              0 = Disabled
                                              1 = Enabled
                                              Note that Mono Mode is only supported when AIF1_FMT =
                                              11.
                 4     AIF1DAC_COM        0   AIF1 Receive Companding Enable
                                P             0 = Disabled
                                              1 = Enabled
                 3     AIF1DAC_COM        0   AIF1 Receive Companding Type
                            PMODE             0 = µ-law
                                              1 = A-law
                 2     AIF1ADC_COM        0   AIF1 Transmit Companding Enable
                                P             0 = Disabled
                                              1 = Enabled
                 1     AIF1ADC_COM        0   AIF1 Transmit Companding Type
                            PMODE             0 = µ-law
                                              1 = A-law
                 0     AIF1_LOOPBAC       0   AIF1 Digital Loopback Function
                                K             0 = No loopback
                                              1 = Loopback enabled (ADCDAT1 data output is directly
                                              input to DACDAT1 data input).
Register 0301h AIF1 Control (2)
                                                                                              PP, March 2014, Rev 3.5
w
                                                                                                                 300


Pre-Production                                                                                           WM8958
 REGISTER       BIT        LABEL    DEFAULT                          DESCRIPTION                           REFER TO
 ADDRESS
R770 (0302h)    15        AIF1_TRI      0   AIF1 Audio Interface tri-state
    AIF1                                    0 = AIF1 pins operate normally
Master/Slave                                1 = Tri-state all AIF1 interface pins
                                            Note that the GPIO1 pin is controlled by this register only
                                            when configured as ADCLRCLK1.
                14       AIF1_MSTR     0    AIF1 Audio Interface Master Mode Select
                                            0 = Slave mode
                                            1 = Master mode
                13     AIF1_CLK_FRC    0    Forces BCLK1, LRCLK1 and ADCLRCLK1 to be enabled
                                            when all AIF1 audio channels are disabled.
                                            0 = Normal
                                            1 = BCLK1, LRCLK1 and ADCLRCLK1 always enabled in
                                            Master mode
                12     AIF1_LRCLK_F    0    Forces LRCLK1 and ADCLRCLK1 to be enabled when all
                              RC            AIF1 audio channels are disabled.
                                            0 = Normal
                                            1 = LRCLK1 and ADCLRCLK1 always enabled in Master
                                            mode
Register 0302h AIF1 Master/Slave
 REGISTER       BIT        LABEL    DEFAULT                          DESCRIPTION                           REFER TO
 ADDRESS
R771 (0303h)    8:4   AIF1_BCLK_DIV  0_0100 BCLK1 Rate
 AIF1 BCLK                   [4:0]          00000 = AIF1CLK
                                            00001 = AIF1CLK / 1.5
                                            00010 = AIF1CLK / 2
                                            00011 = AIF1CLK / 3
                                            00100 = AIF1CLK / 4
                                            00101 = AIF1CLK / 5
                                            00110 = AIF1CLK / 6
                                            00111 = AIF1CLK / 8
                                            01000 = AIF1CLK / 11
                                            01001 = AIF1CLK / 12
                                            01010 = AIF1CLK / 16
                                            01011 = AIF1CLK / 22
                                            01100 = AIF1CLK / 24
                                            01101 = AIF1CLK / 32
                                            01110 = AIF1CLK / 44
                                            01111 = AIF1CLK / 48
                                            10000 = AIF1CLK / 64
                                            10001 = AIF1CLK / 88
                                            10010 = AIF1CLK / 96
                                            10011 = AIF1CLK / 128
                                            10100 = AIF1CLK / 176
                                            10101 = AIF1CLK / 192
                                            10110 - 11111 = Reserved
Register 0303h AIF1 BCLK
                                                                                              PP, March 2014, Rev 3.5
w
                                                                                                                 301


WM8958                                                                                               Pre-Production
 REGISTER       BIT       LABEL    DEFAULT                         DESCRIPTION                           REFER TO
 ADDRESS
R772 (0304h)     12   AIF1ADC_LRCL      0    Right, left and I2S modes – ADCLRCLK1 polarity
  AIF1ADC                 K_INV              0 = normal ADCLRCLK1 polarity
   LRCLK                                     1 = invert ADCLRCLK1 polarity
                                             Note that AIF1ADC_LRCLK_INV selects the ADCLRCLK1
                                             polarity in Master mode and in Slave mode.
                                             DSP Mode – mode A/B select
                                             0 = MSB is available on 2nd BCLK1 rising edge after
                                             ADCLRCLK1 rising edge (mode A)
                                             1 = MSB is available on 1st BCLK1 rising edge after
                                             ADCLRCLK1 rising edge (mode B)
                 11   AIF1ADC_LRCL     0     Allows ADCLRCLK1 to be enabled in Slave mode
                          K_DIR              0 = Normal
                                             1 = ADCLRCLK1 enabled in Slave mode
                10:0  AIF1ADC_RATE 000_0100_ ADCLRCLK1 Rate
                           [10:0]     0000   ADCLRCLK1 clock output =
                                             BCLK1 / AIF1ADC_RATE
                                             Integer (LSB = 1)
                                             Valid from 8..2047
Register 0304h AIF1ADC LRCLK
 REGISTER       BIT       LABEL    DEFAULT                         DESCRIPTION                           REFER TO
 ADDRESS
R773 (0305h)     12   AIF1DAC_LRCL      0    Right, left and I2S modes – LRCLK1 polarity
  AIF1DAC                 K_INV              0 = normal LRCLK1 polarity
   LRCLK                                     1 = invert LRCLK1 polarity
                                             Note that AIF1DAC_LRCLK_INV selects the LRCLK1
                                             polarity in Master mode and in Slave mode.
                                             DSP Mode – mode A/B select
                                             0 = MSB is available on 2nd BCLK1 rising edge after
                                             LRCLK1 rising edge (mode A)
                                             1 = MSB is available on 1st BCLK1 rising edge after
                                             LRCLK1 rising edge (mode B)
                 11   AIF1DAC_LRCL     0     Allows LRCLK1 to be enabled in Slave mode
                          K_DIR              0 = Normal
                                             1 = LRCLK1 enabled in Slave mode
                10:0  AIF1DAC_RATE 000_0100_ LRCLK1 Rate
                           [10:0]     0000   LRCLK1 clock output =
                                             BCLK1 / AIF1DAC_RATE
                                             Integer (LSB = 1)
                                             Valid from 8..2047
Register 0305h AIF1DAC LRCLK
                                                                                            PP, March 2014, Rev 3.5
w
                                                                                                               302


Pre-Production                                                                                          WM8958
 REGISTER       BIT       LABEL      DEFAULT                        DESCRIPTION                           REFER TO
 ADDRESS
R774 (0306h)     1    AIF1DACL_DAT       0   AIF1 Left Receive Data Invert
  AIF1DAC                  _INV              0 = Not inverted
    Data                                     1 = Inverted
                 0    AIF1DACR_DAT       0   AIF1 Right Receive Data Invert
                           _INV              0 = Not inverted
                                             1 = Inverted
Register 0306h AIF1DAC Data
 REGISTER       BIT       LABEL      DEFAULT                        DESCRIPTION                           REFER TO
 ADDRESS
R775 (0307h)     1    AIF1ADCL_DAT       0   AIF1 Left Transmit Data Invert
  AIF1ADC                  _INV              0 = Not inverted
    Data                                     1 = Inverted
                 0    AIF1ADCR_DAT       0   AIF1 Right Transmit Data Invert
                           _INV              0 = Not inverted
                                             1 = Inverted
Register 0307h AIF1ADC Data
 REGISTER       BIT       LABEL      DEFAULT                        DESCRIPTION                           REFER TO
 ADDRESS
R784 (0310h)    15    AIF2ADCL_SRC       0   AIF2 Left Digital Audio interface source
AIF2 Control                                 0 = Left ADC data is output on left channel
     (1)                                     1 = Right ADC data is output on left channel
                14    AIF2ADCR_SR        1   AIF2 Right Digital Audio interface source
                             C               0 = Left ADC data is output on right channel
                                             1 = Right ADC data is output on right channel
                13    AIF2ADC_TDM        0   AIF2 transmit (ADC) TDM Enable
                                             0 = Normal ADCDAT2 operation
                                             1 = TDM enabled on ADCDAT2
                12    AIF2ADC_TDM_       0   AIF2 transmit (ADC) TDM Slot Select
                           CHAN              0 = Slot 0
                                             1 = Slot 1
                 8    AIF2_BCLK_INV      0   BCLK2 Invert
                                             0 = BCLK2 not inverted
                                             1 = BCLK2 inverted
                                             Note that AIF2_BCLK_INV selects the BCLK2 polarity in
                                             Master mode and in Slave mode.
                6:5    AIF2_WL [1:0]    10   AIF2 Digital Audio Interface Word Length
                                             00 = 16 bits
                                             01 = 20 bits
                                             10 = 24 bits
                                             11 = 32 bits
                                             Note - 8-bit modes can be selected using the “Companding”
                                             control bits.
                4:3   AIF2_FMT [1:0]    10   AIF2 Digital Audio Interface Format
                                             00 = Right justified
                                             01 = Left justified
                                             10 = I2S Format
                                             11 = DSP Mode
                 1     AIF2TXL_ENA       1   Enable AIF2DAC (Left) input path
                                             0 = Disabled
                                                                                             PP, March 2014, Rev 3.5
w
                                                                                                                303


WM8958                                                                                                    Pre-Production
 REGISTER       BIT          LABEL   DEFAULT                        DESCRIPTION                               REFER TO
 ADDRESS
                                             1 = Enabled
                                             This bit must be set for AIF2 output of the AIF2ADC (Left)
                                             signal. For AIF3 output only, this bit can be set to 0.
                 0      AIF2TXR_ENA      1   Enable AIF2DAC (Right) input path
                                             0 = Disabled
                                             1 = Enabled
                                             This bit must be set for AIF2 output of the AIF2ADC (Left)
                                             signal. For AIF3 output only, this bit can be set to 0.
Register 0310h AIF2 Control (1)
 REGISTER       BIT          LABEL   DEFAULT                        DESCRIPTION                               REFER TO
 ADDRESS
R785 (0311h)    15     AIF2DACL_SRC     0    AIF2 Left Receive Data Source Select
AIF2 Control                                 0 = Left DAC receives left interface data
     (2)                                     1 = Left DAC receives right interface data
                14     AIF2DACR_SR       1   AIF2 Right Receive Data Source Select
                                C            0 = Right DAC receives left interface data
                                             1 = Right DAC receives right interface data
                13     AIF2DAC_TDM       0   AIF2 receive (DAC) TDM Enable
                                             0 = Normal DACDAT2 operation
                                             1 = TDM enabled on DACDAT2
                12     AIF2DAC_TDM_      0   AIF2 receive (DAC) TDM Slot Select
                             CHAN            0 = Slot 0
                                             1 = Slot 1
               11:10   AIF2DAC_BOO      00   AIF2 Input Path Boost
                            ST [1:0]         00 = 0dB
                                             01 = +6dB (input must not exceed -6dBFS)
                                             10 = +12dB (input must not exceed -12dBFS)
                                             11 = +18dB (input must not exceed -18dBFS)
                 8       AIF2_MONO      0    AIF2 DSP Mono Mode
                                             0 = Disabled
                                             1 = Enabled
                                             Note that Mono Mode is only supported when AIF2_FMT =
                                             11.
                 4     AIF2DAC_COM       0   AIF2 Receive Companding Enable
                                P            0 = Disabled
                                             1 = Enabled
                 3     AIF2DAC_COM       0   AIF2 Receive Companding Type
                            PMODE            0 = µ-law
                                             1 = A-law
                 2     AIF2ADC_COM       0   AIF2 Transmit Companding Enable
                                P            0 = Disabled
                                             1 = Enabled
                 1     AIF2ADC_COM       0   AIF2 Transmit Companding Type
                            PMODE            0 = µ-law
                                             1 = A-law
                 0     AIF2_LOOPBAC      0   AIF2 Digital Loopback Function
                                K            0 = No loopback
                                             1 = Loopback enabled (ADCDAT2 data output is directly
                                             input to DACDAT2 data input).
Register 0311h AIF2 Control (2)
                                                                                                 PP, March 2014, Rev 3.5
w
                                                                                                                    304


Pre-Production                                                                                          WM8958
 REGISTER       BIT        LABEL    DEFAULT                          DESCRIPTION                          REFER TO
 ADDRESS
R786 (0312h)    15        AIF2_TRI      0   AIF2 Audio Interface tri-state
    AIF2                                    0 = AIF2 pins operate normally
Master/Slave                                1 = Tri-state all AIF2 interface pins
                                            Note that pins not configured as AIF2 functions are not
                                            affected by this register.
                14       AIF2_MSTR     0    AIF2 Audio Interface Master Mode Select
                                            0 = Slave mode
                                            1 = Master mode
                13     AIF2_CLK_FRC    0    Forces BCLK2, LRCLK2 and ADCLRCLK2 to be enabled
                                            when all AIF2 audio channels are disabled.
                                            0 = Normal
                                            1 = BCLK2, LRCLK2 and ADCLRCLK2 always enabled in
                                            Master mode
                12     AIF2_LRCLK_F    0    Forces LRCLK2 and ADCLRCLK2 to be enabled when all
                              RC            AIF2 audio channels are disabled.
                                            0 = Normal
                                            1 = LRCLK2 and ADCLRCLK2 always enabled in Master
                                            mode
Register 0312h AIF2 Master/Slave
 REGISTER       BIT        LABEL    DEFAULT                          DESCRIPTION                          REFER TO
 ADDRESS
R787 (0313h)    8:4   AIF2_BCLK_DIV  0_0100 BCLK2 Rate
 AIF2 BCLK                   [4:0]          00000 = AIF2CLK
                                            00001 = AIF2CLK / 1.5
                                            00010 = AIF2CLK / 2
                                            00011 = AIF2CLK / 3
                                            00100 = AIF2CLK / 4
                                            00101 = AIF2CLK / 5
                                            00110 = AIF2CLK / 6
                                            00111 = AIF2CLK / 8
                                            01000 = AIF2CLK / 11
                                            01001 = AIF2CLK / 12
                                            01010 = AIF2CLK / 16
                                            01011 = AIF2CLK / 22
                                            01100 = AIF2CLK / 24
                                            01101 = AIF2CLK / 32
                                            01110 = AIF2CLK / 44
                                            01111 = AIF2CLK / 48
                                            10000 = AIF2CLK / 64
                                            10001 = AIF2CLK / 88
                                            10010 = AIF2CLK / 96
                                            10011 = AIF2CLK / 128
                                            10100 = AIF2CLK / 176
                                            10101 = AIF2CLK / 192
                                            10110 - 11111 = Reserved
Register 0313h AIF2 BCLK
                                                                                             PP, March 2014, Rev 3.5
w
                                                                                                                305


WM8958                                                                                               Pre-Production
 REGISTER       BIT       LABEL    DEFAULT                         DESCRIPTION                           REFER TO
 ADDRESS
R788 (0314h)     12   AIF2ADC_LRCL      0    Right, left and I2S modes – ADCLRCLK2 polarity
  AIF2ADC                 K_INV              0 = normal ADCLRCLK2 polarity
   LRCLK                                     1 = invert ADCLRCLK2 polarity
                                             Note that AIF2ADC_LRCLK_INV selects the ADCLRCLK2
                                             polarity in Master mode and in Slave mode.
                                             DSP Mode – mode A/B select
                                             0 = MSB is available on 2nd BCLK2 rising edge after
                                             ADCLRCLK2 rising edge (mode A)
                                             1 = MSB is available on 1st BCLK2 rising edge after
                                             ADCLRCLK2 rising edge (mode B)
                 11   AIF2ADC_LRCL     0     Allows ADCLRCLK2 to be enabled in Slave mode
                          K_DIR              0 = Normal
                                             1 = ADCLRCLK2 enabled in Slave mode
                10:0  AIF2ADC_RATE 000_0100_ ADCLRCLK2 Rate
                           [10:0]     0000   ADCLRCLK2 clock output =
                                             BCLK2 / AIF2ADC_RATE
                                             Integer (LSB = 1)
                                             Valid from 8..2047
Register 0314h AIF2ADC LRCLK
 REGISTER       BIT       LABEL    DEFAULT                         DESCRIPTION                           REFER TO
 ADDRESS
R789 (0315h)     12   AIF2DAC_LRCL      0    Right, left and I2S modes – LRCLK2 polarity
  AIF2DAC                 K_INV              0 = normal LRCLK2 polarity
   LRCLK                                     1 = invert LRCLK2 polarity
                                             Note that AIF2DAC_LRCLK_INV selects the LRCLK2
                                             polarity in Master mode and in Slave mode.
                                             DSP Mode – mode A/B select
                                             0 = MSB is available on 2nd BCLK2 rising edge after
                                             LRCLK2 rising edge (mode A)
                                             1 = MSB is available on 1st BCLK2 rising edge after
                                             LRCLK2 rising edge (mode B)
                 11   AIF2DAC_LRCL     0     Allows LRCLK2 to be enabled in Slave mode
                          K_DIR              0 = Normal
                                             1 = LRCLK2 enabled in Slave mode
                10:0  AIF2DAC_RATE 000_0100_ LRCLK2 Rate
                           [10:0]     0000   LRCLK2 clock output =
                                             BCLK2 / AIF2DAC_RATE
                                             Integer (LSB = 1)
                                             Valid from 8..2047
Register 0315h AIF2DAC LRCLK
                                                                                            PP, March 2014, Rev 3.5
w
                                                                                                               306


Pre-Production                                                                                               WM8958
 REGISTER       BIT          LABEL    DEFAULT                          DESCRIPTION                            REFER TO
 ADDRESS
R790 (0316h)     1     AIF2DACL_DAT      0    AIF2 Left Receive Data Invert
  AIF2DAC                     _INV            0 = Not inverted
    Data                                      1 = Inverted
                 0     AIF2DACR_DAT      0    AIF2 Right Receive Data Invert
                              _INV            0 = Not inverted
                                              1 = Inverted
Register 0316h AIF2DAC Data
 REGISTER       BIT          LABEL    DEFAULT                          DESCRIPTION                            REFER TO
 ADDRESS
R791 (0317h)     1     AIF2ADCL_DAT      0    AIF2 Left Transmit Data Invert
  AIF2ADC                     _INV            0 = Not inverted
    Data                                      1 = Inverted
                 0     AIF2ADCR_DAT      0    AIF2 Right Transmit Data Invert
                              _INV            0 = Not inverted
                                              1 = Inverted
Register 0317h AIF2ADC Data
 REGISTER       BIT          LABEL    DEFAULT                          DESCRIPTION                            REFER TO
 ADDRESS
                                                               2
R800 (0320h)     7     AIF3_LRCLK_IN      0   Right, left and I S modes – LRCLK3 polarity
AIF3 Control                    V             0 = normal LRCLK3 polarity
     (1)                                      1 = invert LRCLK3 polarity
                                              DSP Mode – mode A/B select
                                              0 = MSB is available on 2nd BCLK3 rising edge after
                                              LRCLK3 rising edge (mode A)
                                              1 = MSB is available on 1st BCLK3 rising edge after
                                              LRCLK3 rising edge (mode B)
                6:5     AIF3_WL [1:0]    10   AIF3 Digital Audio Interface Word Length
                                              00 = 16 bits
                                              01 = 20 bits
                                              10 = 24 bits
                                              11 = 32 bits
                                              Note - 8-bit modes can be selected using the “Companding”
                                              control bits.
                                              Note that this controls the AIF3 Mono PCM interface path
                                              only; it does not affect AIF3 inputs/outputs routed to AIF1 or
                                              AIF2.
Register 0320h AIF3 Control (1)
 REGISTER       BIT          LABEL    DEFAULT                          DESCRIPTION                            REFER TO
 ADDRESS
R801 (0321h)   11:10   AIF3DAC_BOO       00   AIF3 Input Path Boost
AIF3 Control                ST [1:0]          00 = 0dB
     (2)                                      01 = +6dB (input must not exceed -6dBFS)
                                              10 = +12dB (input must not exceed -12dBFS)
                                              11 = +18dB (input must not exceed -18dBFS)
                                              Note that this controls the AIF3 Mono PCM interface path
                                              only; it does not affect DACDAT3 input to AIF1 or AIF2.
                                                                                                PP, March 2014, Rev 3.5
w
                                                                                                                   307


WM8958                                                                                                   Pre-Production
 REGISTER       BIT          LABEL   DEFAULT                            DESCRIPTION                          REFER TO
 ADDRESS
                 4     AIF3DAC_COM       0     AIF3 Receive Companding Enable
                                P              0 = Disabled
                                               1 = Enabled
                                               Note that this controls the AIF3 Mono PCM interface path
                                               only; it does not affect DACDAT3 input to AIF1 or AIF2.
                 3     AIF3DAC_COM       0     AIF3 Receive Companding Type
                            PMODE              0 = µ-law
                                               1 = A-law
                                               Note that this controls the AIF3 Mono PCM interface path
                                               only; it does not affect DACDAT3 input to AIF1 or AIF2.
                 2     AIF3ADC_COM       0     AIF3 Transmit Companding Enable
                                P              0 = Disabled
                                               1 = Enabled
                                               Note that this controls the AIF3 Mono PCM interface path
                                               only; it does not affect ADCDAT3 output from AIF1 or AIF2.
                 1     AIF3ADC_COM       0     AIF3 Transmit Companding Type
                            PMODE              0 = µ-law
                                               1 = A-law
                                               Note that this controls the AIF3 Mono PCM interface path
                                               only; it does not affect ADCDAT3 output from AIF1 or AIF2.
                 0     AIF3_LOOPBAC      0     AIF3 Digital Loopback Function
                                K              0 = No loopback
                                               1 = Loopback enabled (AIF3 Mono PCM data output is
                                               directly input to AIF3 Mono PCM data input).
Register 0321h AIF3 Control (2)
 REGISTER       BIT          LABEL   DEFAULT                            DESCRIPTION                          REFER TO
 ADDRESS
R802 (0322h)     0     AIF3DAC_DAT_      0     AIF3 Receive Data Invert
  AIF3DAC                     INV              0 = Not inverted
    Data                                       1 = Inverted
                                               Note that this controls the AIF3 Mono PCM interface path
                                               only; it does not affect DACDAT3 input to AIF1 or AIF2.
Register 0322h AIF3DAC Data
 REGISTER       BIT          LABEL   DEFAULT                            DESCRIPTION                          REFER TO
 ADDRESS
R803 (0323h)     0     AIF3ADC_DAT_      0     AIF3 Transmit Data Invert
  AIF3ADC                     INV              0 = Not inverted
    Data                                       1 = Inverted
                                               Note that this controls the AIF3 Mono PCM interface path
                                               only; it does not affect ADCDAT3 output from AIF1 or AIF2.
Register 0323h AIF3ADC Data
 REGISTER       BIT          LABEL   DEFAULT                            DESCRIPTION                          REFER TO
 ADDRESS
   R1024         8      AIF1ADC1_VU      0     AIF1ADC1 output path (AIF1, Timeslot 0) Volume Update
(0400h) AIF1                                   Writing a 1 to this bit will cause the AIF1ADC1L and
 ADC1 Left                                     AIF1ADC1R volume to be updated simultaneously
   Volume
                7:0    AIF1ADC1L_VO  1100_0000 AIF1ADC1 (Left) output path (AIF1, Timeslot 0) Digital
                             L [7:0]           Volume
                                                                                                PP, March 2014, Rev 3.5
w
                                                                                                                   308


Pre-Production                                                                                              WM8958
 REGISTER       BIT       LABEL       DEFAULT                            DESCRIPTION                          REFER TO
 ADDRESS
                                                00h = MUTE
                                                01h = -71.625dB
                                                … (0.375dB steps)
                                                EFh = +17.625dB
Register 0400h AIF1 ADC1 Left Volume
 REGISTER       BIT       LABEL       DEFAULT                            DESCRIPTION                          REFER TO
 ADDRESS
   R1025         8     AIF1ADC1_VU        0     AIF1ADC1 output path (AIF1, Timeslot 0) Volume Update
(0401h) AIF1                                    Writing a 1 to this bit will cause the AIF1ADC1L and
 ADC1 Right                                     AIF1ADC1R volume to be updated simultaneously
   Volume
                7:0   AIF1ADC1R_VO 1100_0000 AIF1ADC1 (Right) output path (AIF1, Timeslot 0) Digital
                           L [7:0]              Volume
                                                00h = MUTE
                                                01h = -71.625dB
                                                … (0.375dB steps)
                                                EFh = +17.625dB
Register 0401h AIF1 ADC1 Right Volume
 REGISTER       BIT       LABEL       DEFAULT                            DESCRIPTION                          REFER TO
 ADDRESS
   R1026         8     AIF1DAC1_VU        0     AIF1DAC1 input path (AIF1, Timeslot 0) Volume Update
(0402h) AIF1                                    Writing a 1 to this bit will cause the AIF1DAC1L and
 DAC1 Left                                      AIF1DAC1R volume to be updated simultaneously
   Volume
                7:0   AIF1DAC1L_VO    1100_0000 AIF1DAC1 (Left) input path (AIF1, Timeslot 0) Digital
                           L [7:0]              Volume
                                                00h = MUTE
                                                01h = -71.625dB
                                                … (0.375dB steps)
                                                C0h = 0dB
                                                FFh = 0dB
Register 0402h AIF1 DAC1 Left Volume
 REGISTER       BIT       LABEL       DEFAULT                            DESCRIPTION                          REFER TO
 ADDRESS
   R1027         8     AIF1DAC1_VU        0     AIF1DAC1 input path (AIF1, Timeslot 0) Volume Update
(0403h) AIF1                                    Writing a 1 to this bit will cause the AIF1DAC1L and
 DAC1 Right                                     AIF1DAC1R volume to be updated simultaneously
   Volume
                7:0   AIF1DAC1R_VO 1100_0000 AIF1DAC1 (Right) input path (AIF1, Timeslot 0) Digital
                           L [7:0]              Volume
                                                00h = MUTE
                                                01h = -71.625dB
                                                … (0.375dB steps)
                                                C0h = 0dB
                                                FFh = 0dB
Register 0403h AIF1 DAC1 Right Volume
                                                                                                 PP, March 2014, Rev 3.5
w
                                                                                                                    309


WM8958                                                                                                    Pre-Production
 REGISTER       BIT       LABEL       DEFAULT                            DESCRIPTION                          REFER TO
 ADDRESS
   R1028         8     AIF1ADC2_VU        0     AIF1ADC2 output path (AIF1, Timeslot 1) Volume Update
(0404h) AIF1                                    Writing a 1 to this bit will cause the AIF1ADC2L and
 ADC2 Left                                      AIF1ADC2R volume to be updated simultaneously
   Volume
                7:0   AIF1ADC2L_VO    1100_0000 AIF1ADC2 (Left) output path (AIF1, Timeslot 1) Digital
                           L [7:0]              Volume
                                                00h = MUTE
                                                01h = -71.625dB
                                                … (0.375dB steps)
                                                EFh = +17.625dB
Register 0404h AIF1 ADC2 Left Volume
 REGISTER       BIT       LABEL       DEFAULT                            DESCRIPTION                          REFER TO
 ADDRESS
   R1029         8     AIF1ADC2_VU        0     AIF1ADC2 output path (AIF1, Timeslot 1) Volume Update
(0405h) AIF1                                    Writing a 1 to this bit will cause the AIF1ADC2L and
 ADC2 Right                                     AIF1ADC2R volume to be updated simultaneously
   Volume
                7:0   AIF1ADC2R_VO 1100_0000 AIF1ADC2 (Right) output path (AIF1, Timeslot 1) Digital
                           L [7:0]              Volume
                                                00h = MUTE
                                                01h = -71.625dB
                                                … (0.375dB steps)
                                                EFh = +17.625dB
Register 0405h AIF1 ADC2 Right Volume
 REGISTER       BIT       LABEL       DEFAULT                            DESCRIPTION                          REFER TO
 ADDRESS
   R1030         8     AIF1DAC2_VU        0     AIF1DAC2 input path (AIF1, Timeslot 1) Volume Update
(0406h) AIF1                                    Writing a 1 to this bit will cause the AIF1DAC2L and
 DAC2 Left                                      AIF1DAC2R volume to be updated simultaneously
   Volume
                7:0   AIF1DAC2L_VO    1100_0000 AIF1DAC2 (Left) input path (AIF1, Timeslot 1) Digital
                           L [7:0]              Volume
                                                00h = MUTE
                                                01h = -71.625dB
                                                … (0.375dB steps)
                                                C0h = 0dB
                                                FFh = 0dB
Register 0406h AIF1 DAC2 Left Volume
 REGISTER       BIT       LABEL       DEFAULT                            DESCRIPTION                          REFER TO
 ADDRESS
   R1031         8     AIF1DAC2_VU        0     AIF1DAC2 input path (AIF1, Timeslot 1) Volume Update
(0407h) AIF1                                    Writing a 1 to this bit will cause the AIF1DAC2L and
 DAC2 Right                                     AIF1DAC2R volume to be updated simultaneously
   Volume
                7:0   AIF1DAC2R_VO 1100_0000 AIF1DAC2 (Right) input path (AIF1, Timeslot 1) Digital
                           L [7:0]              Volume
                                                00h = MUTE
                                                01h = -71.625dB
                                                … (0.375dB steps)
                                                C0h = 0dB
                                                FFh = 0dB
Register 0407h AIF1 DAC2 Right Volume
                                                                                                 PP, March 2014, Rev 3.5
w
                                                                                                                    310


Pre-Production                                                                                         WM8958
 REGISTER       BIT       LABEL     DEFAULT                        DESCRIPTION                           REFER TO
 ADDRESS
   R1040        15     AIF1ADC_4FS      0   Enable AIF1ADC ultrasonic mode (4FS) output, bypassing
(0410h) AIF1                                all AIF1 baseband output filtering
ADC1 Filters                                0 = Disabled
                                            1 = Enabled
               14:13  AIF1ADC1_HPF     00   AIF1ADC1 output path (AIF1, Timeslot 0) Digital HPF cut-
                         _CUT [1:0]         off frequency (fc)
                                            00 = Hi-fi mode (fc = 4Hz at fs = 48kHz)
                                            01 = Voice mode 1 (fc = 127Hz at fs = 8kHz)
                                            10 = Voice mode 2 (fc = 130Hz at fs = 8kHz)
                                            11 = Voice mode 3 (fc = 267Hz at fs = 8kHz)
                12    AIF1ADC1L_HP      0   AIF1ADC1 (Left) output path (AIF1, Timeslot 0) Digital HPF
                               F            Enable
                                            0 = Disabled
                                            1 = Enabled
                11    AIF1ADC1R_HP      0   AIF1ADC1 (Right) output path (AIF1, Timeslot 0) Digital
                               F            HPF Enable
                                            0 = Disabled
                                            1 = Enabled
Register 0410h AIF1 ADC1 Filters
 REGISTER       BIT       LABEL     DEFAULT                        DESCRIPTION                           REFER TO
 ADDRESS
   R1041       14:13  AIF1ADC2_HPF     00   AIF1ADC2 output path (AIF1, Timeslot 1) Digital HPF cut-
(0411h) AIF1             _CUT [1:0]         off frequency (fc)
ADC2 Filters                                00 = Hi-fi mode (fc = 4Hz at fs = 48kHz)
                                            01 = Voice mode 1 (fc = 127Hz at fs = 8kHz)
                                            10 = Voice mode 2 (fc = 130Hz at fs = 8kHz)
                                            11 = Voice mode 3 (fc = 267Hz at fs = 8kHz)
                12    AIF1ADC2L_HP      0   AIF1ADC2 (Left) output path (AIF1, Timeslot 1) Digital HPF
                               F            Enable
                                            0 = Disabled
                                            1 = Enabled
                11    AIF1ADC2R_HP      0   AIF1ADC2 (Right) output path (AIF1, Timeslot 1) Digital
                               F            HPF Enable
                                            0 = Disabled
                                            1 = Enabled
Register 0411h AIF1 ADC2 Filters
 REGISTER       BIT        LABEL    DEFAULT                        DESCRIPTION                           REFER TO
 ADDRESS
   R1056         9    AIF1DAC1_MUT      1   AIF1DAC1 input path (AIF1, Timeslot 0) Soft Mute Control
(0420h) AIF1                   E            0 = Un-mute
DAC1 Filters                                1 = Mute
     (1)
                 7     AIF1DAC1_MO      0   AIF1DAC1 input path (AIF1, Timeslot 0) Mono Mix Control
                              NO            0 = Disabled
                                            1 = Enabled
                 5    AIF1DAC1_MUT      0   AIF1DAC1 input path (AIF1, Timeslot 0) Soft Mute Ramp
                           ERATE            Rate
                                            0 = Fast ramp (fs/2, maximum ramp time is 10.7ms at
                                            fs=48k)
                                            1 = Slow ramp (fs/32, maximum ramp time is 171ms at
                                                                                            PP, March 2014, Rev 3.5
w
                                                                                                               311


WM8958                                                                                                Pre-Production
 REGISTER       BIT        LABEL     DEFAULT                       DESCRIPTION                           REFER TO
 ADDRESS
                                             fs=48k)
                                             (Note: ramp rate scales with sample rate.)
                 4     AIF1DAC1_UN       0   AIF1DAC1 input path (AIF1, Timeslot 0) Unmute Ramp
                       MUTE_RAMP             select
                                             0 = Disabling soft-mute (AIF1DAC1_MUTE=0) will cause
                                             the volume to change immediately to AIF1DAC1L_VOL and
                                             AIF1DAC1R_VOL settings
                                             1 = Disabling soft-mute (AIF1DAC1_MUTE=0) will cause
                                             the DAC volume to ramp up gradually to the
                                             AIF1DAC1L_VOL and AIF1DAC1R_VOL settings
Register 0420h AIF1 DAC1 Filters (1)
 REGISTER       BIT       LABEL      DEFAULT                       DESCRIPTION                           REFER TO
 ADDRESS
   R1057        13:9  AIF1DAC1_3D_    0_0000 AIF1DAC1 playback path (AIF1, Timeslot 0) 3D Stereo
(0421h) AIF1             GAIN [4:0]          depth
DAC1 Filters                                 00000 = Off
     (2)                                     00001 = Minimum (-16dB)
                                             …(0.915dB steps)
                                             11111 = Maximum (+11.45dB)
                 8    AIF1DAC1_3D_      0    Enable 3D Stereo in AIF1DAC1 playback path (AIF1,
                             ENA             Timeslot 0)
                                             0 = Disabled
                                             1 = Enabled
Register 0421h AIF1 DAC1 Filters (2)
 REGISTER       BIT        LABEL     DEFAULT                       DESCRIPTION                           REFER TO
 ADDRESS
   R1058         9    AIF1DAC2_MUT       1   AIF1DAC2 input path (AIF1, Timeslot 1) Soft Mute Control
(0422h) AIF1                   E             0 = Un-mute
DAC2 Filters                                 1 = Mute
     (1)
                 7     AIF1DAC2_MO       0   AIF1DAC2 input path (AIF1, Timeslot 1) Mono Mix Control
                              NO             0 = Disabled
                                             1 = Enabled
                 5    AIF1DAC2_MUT       0   AIF1DAC2 input path (AIF1, Timeslot 1) Soft Mute Ramp
                           ERATE             Rate
                                             0 = Fast ramp (fs/2, maximum ramp time is 10.7ms at
                                             fs=48k)
                                             1 = Slow ramp (fs/32, maximum ramp time is 171ms at
                                             fs=48k)
                                             (Note: ramp rate scales with sample rate.)
                 4     AIF1DAC2_UN       0   AIF1DAC2 input path (AIF1, Timeslot 1) Unmute Ramp
                       MUTE_RAMP             select
                                             0 = Disabling soft-mute (AIF1DAC2_MUTE=0) will cause
                                             the volume to change immediately to AIF1DAC2L_VOL and
                                             AIF1DAC2R_VOL settings
                                             1 = Disabling soft-mute (AIF1DAC2_MUTE=0) will cause
                                             the DAC volume to ramp up gradually to the
                                             AIF1DAC2L_VOL and AIF1DAC2R_VOL settings
Register 0422h AIF1 DAC2 Filters (1)
                                                                                           PP, March 2014, Rev 3.5
w
                                                                                                                312


Pre-Production                                                                                        WM8958
 REGISTER       BIT        LABEL     DEFAULT                       DESCRIPTION                          REFER TO
 ADDRESS
   R1059        13:9  AIF1DAC2_3D_    0_0000 AIF1DAC2 playback path (AIF1, Timeslot 1) 3D Stereo
(0423h) AIF1             GAIN [4:0]          depth
DAC2 Filters                                 00000 = Off
     (2)                                     00001 = Minimum (-16dB)
                                             …(0.915dB steps)
                                             11111 = Maximum (+11.45dB)
                  8   AIF1DAC2_3D_       0   Enable 3D Stereo in AIF1DAC2 playback path (AIF1,
                             ENA             Timeslot 1)
                                             0 = Disabled
                                             1 = Enabled
Register 0423h AIF1 DAC2 Filters (2)
 REGISTER       BIT        LABEL     DEFAULT                       DESCRIPTION                          REFER TO
 ADDRESS
   R1072         6:5  AIF1DAC1_NG_      11   AIF1DAC1 input path (AIF1, Timeslot 0) Noise Gate Hold
(0430h) AIF1              HLD [1:0]          Time
 DAC1 Noise                                  (delay before noise gate is activated)
    Gate                                     00 = 30ms
                                             01 = 125ms
                                             10 = 250ms
                                             11 = 500ms
                 3:1  AIF1DAC1_NG_      100  AIF1DAC1 input path (AIF1, Timeslot 0) Noise Gate
                         THR [2:0]           Threshold
                                             000 = -60dB
                                             001 = -66dB
                                             010 = -72dB
                                             011 = -78dB
                                             100 = -84dB
                                             101 = -90dB
                                             110 = -96dB
                                             111 = -102dB
                  0   AIF1DAC1_NG_       0   AIF1DAC1 input path (AIF1, Timeslot 0) Noise Gate Enable
                             ENA             0 = Disabled
                                             1 = Enabled
Register 0430h AIF1 DAC1 Noise Gate
 REGISTER       BIT        LABEL     DEFAULT                       DESCRIPTION                          REFER TO
 ADDRESS
   R1073         6:5  AIF1DAC2_NG_      11   AIF1DAC2 input path (AIF1, Timeslot 1) Noise Gate Hold
(0431h) AIF1              HLD [1:0]          Time
 DAC2 Noise                                  (delay before noise gate is activated)
    Gate                                     00 = 30ms
                                             01 = 125ms
                                             10 = 250ms
                                             11 = 500ms
                 3:1  AIF1DAC2_NG_      100  AIF1DAC2 input path (AIF1, Timeslot 1) Noise Gate
                         THR [2:0]           Threshold
                                             000 = -60dB
                                             001 = -66dB
                                             010 = -72dB
                                             011 = -78dB
                                             100 = -84dB
                                             101 = -90dB
                                                                                           PP, March 2014, Rev 3.5
w
                                                                                                              313


WM8958                                                                                                     Pre-Production
 REGISTER       BIT        LABEL     DEFAULT                        DESCRIPTION                               REFER TO
 ADDRESS
                                             110 = -96dB
                                             111 = -102dB
                 0    AIF1DAC2_NG_       0   AIF1DAC2 input path (AIF1, Timeslot 1) Noise Gate Enable
                             ENA             0 = Disabled
                                             1 = Enabled
Register 0431h AIF1 DAC2 Noise Gate
 REGISTER       BIT        LABEL     DEFAULT                        DESCRIPTION                               REFER TO
 ADDRESS
   R1088       15:11   AIF1DRC1_SIG   0_0000 AIF1 DRC1 Signal Detect RMS Threshold.
(0440h) AIF1             _DET_RMS            This is the RMS signal level for signal detect to be indicated
  DRC1 (1)                   [4:0]           when AIF1DRC1_SIG_DET_MODE=1.
                                             00000 = -30dB
                                             00001 = -31.5dB
                                             …. (1.5dB steps)
                                             11110 = -75dB
                                             11111 = -76.5dB
                10:9   AIF1DRC1_SIG     00   AIF1 DRC1 Signal Detect Peak Threshold.
                       _DET_PK [1:0]         This is the Peak/RMS ratio, or Crest Factor, level for signal
                                             detect to be indicated when
                                             AIF1DRC1_SIG_DET_MODE=0.
                                             00 = 12dB
                                             01 = 18dB
                                             10 = 24dB
                                             11 = 30dB
                 8    AIF1DRC1_NG_       0   AIF1 DRC1 Noise Gate Enable
                             ENA             0 = Disabled
                                             1 = Enabled
                 7     AIF1DRC1_SIG      1   AIF1 DRC1 Signal Detect Mode
                        _DET_MODE            0 = Peak threshold mode
                                             1 = RMS threshold mode
                 6     AIF1DRC1_SIG      0   AIF1 DRC1 Signal Detect Enable
                            _DET             0 = Disabled
                                             1 = Enabled
                 5    AIF1DRC1_KNE       0   AIF1 DRC1 KNEE2_OP Enable
                        E2_OP_ENA            0 = Disabled
                                             1 = Enabled
                 4     AIF1DRC1_QR       1   AIF1 DRC1 Quick-release Enable
                                             0 = Disabled
                                             1 = Enabled
                 3    AIF1DRC1_ANT       1   AIF1 DRC1 Anti-clip Enable
                            ICLIP            0 = Disabled
                                             1 = Enabled
                 2    AIF1DAC1_DRC       0   Enable DRC in AIF1DAC1 playback path (AIF1, Timeslot 0)
                            _ENA             0 = Disabled
                                             1 = Enabled
                 1    AIF1ADC1L_DR       0   Enable DRC in AIF1ADC1 (Left) record path (AIF1,
                           C_ENA             Timeslot 0)
                                             0 = Disabled
                                             1 = Enabled
                                                                                                PP, March 2014, Rev 3.5
w
                                                                                                                     314


Pre-Production                                                                                      WM8958
 REGISTER       BIT        LABEL    DEFAULT                       DESCRIPTION                         REFER TO
 ADDRESS
                  0   AIF1ADC1R_DR      0   Enable DRC in AIF1ADC1 (Right) record path (AIF1,
                           C_ENA            Timeslot 0)
                                            0 = Disabled
                                            1 = Enabled
Register 0440h AIF1 DRC1 (1)
 REGISTER       BIT        LABEL    DEFAULT                       DESCRIPTION                         REFER TO
 ADDRESS
   R1089        12:9  AIF1DRC1_ATK    0100  AIF1 DRC1 Gain attack rate (seconds/6dB)
(0441h) AIF1                 [3:0]          0000 = Reserved
  DRC1 (2)                                  0001 = 181us
                                            0010 = 363us
                                            0011 = 726us
                                            0100 = 1.45ms
                                            0101 = 2.9ms
                                            0110 = 5.8ms
                                            0111 = 11.6ms
                                            1000 = 23.2ms
                                            1001 = 46.4ms
                                            1010 = 92.8ms
                                            1011 = 185.6ms
                                            1100-1111 = Reserved
                 8:5  AIF1DRC1_DCY    0010  AIF1 DRC1 Gain decay rate (seconds/6dB)
                             [3:0]          0000 = 186ms
                                            0001 = 372ms
                                            0010 = 743ms
                                            0011 = 1.49s
                                            0100 = 2.97s
                                            0101 = 5.94s
                                            0110 = 11.89s
                                            0111 = 23.78s
                                            1000 = 47.56s
                                            1001-1111 = Reserved
                 4:2  AIF1DRC1_MIN     001  AIF1 DRC1 Minimum gain to attenuate audio signals
                         GAIN [2:0]         000 = 0dB
                                            001 = -12dB (default)
                                            010 = -18dB
                                            011 = -24dB
                                            100 = -36dB
                                            101 = Reserved
                                            11X = Reserved
                 1:0   AIF1DRC1_MA     01   AIF1 DRC1 Maximum gain to boost audio signals (dB)
                        XGAIN [1:0]         00 = 12dB
                                            01 = 18dB
                                            10 = 24dB
                                            11 = 36dB
Register 0441h AIF1 DRC1 (2)
                                                                                         PP, March 2014, Rev 3.5
w
                                                                                                            315


WM8958                                                                                               Pre-Production
 REGISTER       BIT        LABEL     DEFAULT                        DESCRIPTION                          REFER TO
 ADDRESS
   R1090       15:12  AIF1DRC1_NG_     0000  AIF1 DRC1 Minimum gain to attenuate audio signals when
(0442h) AIF1           MINGAIN [3:0]         the noise gate is active.
  DRC1 (3)                                   0000 = -36dB
                                             0001 = -30dB
                                             0010 = -24dB
                                             0011 = -18dB
                                             0100 = -12dB
                                             0101 = -6dB
                                             0110 = 0dB
                                             0111 = 6dB
                                             1000 = 12dB
                                             1001 = 18dB
                                             1010 = 24dB
                                             1011 = 30dB
                                             1100 = 36dB
                                             1101 to 1111 = Reserved
               11:10  AIF1DRC1_NG_      00   AIF1 DRC1 Noise Gate slope
                          EXP [1:0]          00 = 1 (no expansion)
                                             01 = 2
                                             10 = 4
                                             11 = 8
                9:8   AIF1DRC1_QR_      00   AIF1 DRC1 Quick-release threshold (crest factor in dB)
                          THR [1:0]          00 = 12dB
                                             01 = 18dB
                                             10 = 24dB
                                             11 = 30dB
                7:6   AIF1DRC1_QR_      00   AIF1 DRC1 Quick-release decay rate (seconds/6dB)
                          DCY [1:0]          00 = 0.725ms
                                             01 = 1.45ms
                                             10 = 5.8ms
                                             11 = Reserved
                5:3    AIF1DRC1_HI_     000  AIF1 DRC1 Compressor slope (upper region)
                         COMP [2:0]          000 = 1 (no compression)
                                             001 = 1/2
                                             010 = 1/4
                                             011 = 1/8
                                             100 = 1/16
                                             101 = 0
                                             110 = Reserved
                                             111 = Reserved
                2:0   AIF1DRC1_LO_      000  AIF1 DRC1 Compressor slope (lower region)
                         COMP [2:0]          000 = 1 (no compression)
                                             001 = 1/2
                                             010 = 1/4
                                             011 = 1/8
                                             100 = 0
                                             101 = Reserved
                                             11X = Reserved
Register 0442h AIF1 DRC1 (3)
                                                                                            PP, March 2014, Rev 3.5
w
                                                                                                               316


Pre-Production                                                                                              WM8958
 REGISTER       BIT        LABEL    DEFAULT                        DESCRIPTION                               REFER TO
 ADDRESS
   R1091        10:5  AIF1DRC1_KNE   00_0000 AIF1 DRC1 Input signal level at the Compressor ‘Knee’.
(0443h) AIF1             E_IP [5:0]          000000 = 0dB
  DRC1 (4)                                   000001 = -0.75dB
                                             000010 = -1.5dB
                                             … (-0.75dB steps)
                                             111100 = -45dB
                                             111101 = Reserved
                                             11111X = Reserved
                 4:0  AIF1DRC1_KNE    0_0000 AIF1 DRC1 Output signal at the Compressor ‘Knee’.
                         E_OP [4:0]          00000 = 0dB
                                             00001 = -0.75dB
                                             00010 = -1.5dB
                                             … (-0.75dB steps)
                                             11110 = -22.5dB
                                             11111 = Reserved
Register 0443h AIF1 DRC1 (4)
 REGISTER       BIT        LABEL    DEFAULT                        DESCRIPTION                               REFER TO
 ADDRESS
   R1092        9:5   AIF1DRC1_KNE   0_0000  AIF1 DRC1 Input signal level at the Noise Gate threshold
(0444h) AIF1            E2_IP [4:0]          ‘Knee2’.
  DRC1 (5)                                   00000 = -36dB
                                             00001 = -37.5dB
                                             00010 = -39dB
                                             … (-1.5dB steps)
                                             11110 = -81dB
                                             11111 = -82.5dB
                                             Only applicable when AIF1DRC1_NG_ENA = 1.
                 4:0  AIF1DRC1_KNE    0_0000 AIF1 DRC1 Output signal at the Noise Gate threshold
                        E2_OP [4:0]          ‘Knee2’.
                                             00000 = -30dB
                                             00001 = -31.5dB
                                             00010 = -33dB
                                             … (-1.5dB steps)
                                             11110 = -75dB
                                             11111 = -76.5dB
                                             Only applicable when AIF1DRC1_KNEE2_OP_ENA = 1.
Register 0444h AIF1 DRC1 (5)
 REGISTER       BIT        LABEL    DEFAULT                        DESCRIPTION                               REFER TO
 ADDRESS
   R1104       15:11  AIF1DRC2_SIG   0_0000  AIF1 DRC2 Signal Detect RMS Threshold.
(0450h) AIF1            _DET_RMS             This is the RMS signal level for signal detect to be indicated
  DRC2 (1)                   [4:0]           when AIF1DRC2_SIG_DET_MODE=1.
                                             00000 = -30dB
                                             00001 = -31.5dB
                                             …. (1.5dB steps)
                                             11110 = -75dB
                                             11111 = -76.5dB
                                                                                                PP, March 2014, Rev 3.5
w
                                                                                                                   317


WM8958                                                                                                     Pre-Production
 REGISTER       BIT        LABEL     DEFAULT                        DESCRIPTION                               REFER TO
 ADDRESS
                10:9  AIF1DRC2_SIG      00   AIF1 DRC2 Signal Detect Peak Threshold.
                       _DET_PK [1:0]         This is the Peak/RMS ratio, or Crest Factor, level for signal
                                             detect to be indicated when
                                             AIF1DRC2_SIG_DET_MODE=0.
                                             00 = 12dB
                                             01 = 18dB
                                             10 = 24dB
                                             11 = 30dB
                 8    AIF1DRC2_NG_      0    AIF1 DRC2 Noise Gate Enable
                             ENA             0 = Disabled
                                             1 = Enabled
                 7    AIF1DRC2_SIG      1    AIF1 DRC2 Signal Detect Mode
                        _DET_MODE            0 = Peak threshold mode
                                             1 = RMS threshold mode
                 6    AIF1DRC2_SIG      0    AIF1 DRC2 Signal Detect Enable
                            _DET             0 = Disabled
                                             1 = Enabled
                 5    AIF1DRC2_KNE      0    AIF1 DRC2 KNEE2_OP Enable
                        E2_OP_ENA            0 = Disabled
                                             1 = Enabled
                 4     AIF1DRC2_QR      1    AIF1 DRC2 Quick-release Enable
                                             0 = Disabled
                                             1 = Enabled
                 3    AIF1DRC2_ANT      1    AIF1 DRC2 Anti-clip Enable
                            ICLIP            0 = Disabled
                                             1 = Enabled
                 2    AIF1DAC2_DRC      0    Enable DRC in AIF1DAC2 playback path (AIF1, Timeslot 1)
                            _ENA             0 = Disabled
                                             1 = Enabled
                 1    AIF1ADC2L_DR      0    Enable DRC in AIF1ADC2 (Left) record path (AIF1,
                           C_ENA             Timeslot 1)
                                             0 = Disabled
                                             1 = Enabled
                 0    AIF1ADC2R_DR      0    Enable DRC in AIF1ADC2 (Right) record path (AIF1,
                           C_ENA             Timeslot 1)
                                             0 = Disabled
                                             1 = Enabled
Register 0450h AIF1 DRC2 (1)
                                                                                              PP, March 2014, Rev 3.5
w
                                                                                                                     318


Pre-Production                                                                                       WM8958
 REGISTER       BIT        LABEL     DEFAULT                        DESCRIPTION                        REFER TO
 ADDRESS
   R1105        12:9  AIF1DRC2_ATK     0100  AIF1 DRC2 Gain attack rate (seconds/6dB)
(0451h) AIF1                 [3:0]           0000 = Reserved
  DRC2 (2)                                   0001 = 181us
                                             0010 = 363us
                                             0011 = 726us
                                             0100 = 1.45ms
                                             0101 = 2.9ms
                                             0110 = 5.8ms
                                             0111 = 11.6ms
                                             1000 = 23.2ms
                                             1001 = 46.4ms
                                             1010 = 92.8ms
                                             1011 = 185.6ms
                                             1100-1111 = Reserved
                 8:5  AIF1DRC2_DCY     0010  AIF1 DRC2 Gain decay rate (seconds/6dB)
                             [3:0]           0000 = 186ms
                                             0001 = 372ms
                                             0010 = 743ms
                                             0011 = 1.49s
                                             0100 = 2.97s
                                             0101 = 5.94s
                                             0110 = 11.89s
                                             0111 = 23.78s
                                             1000 = 47.56s
                                             1001-1111 = Reserved
                 4:2  AIF1DRC2_MIN      001  AIF1 DRC2 Minimum gain to attenuate audio signals
                         GAIN [2:0]          000 = 0dB
                                             001 = -12dB (default)
                                             010 = -18dB
                                             011 = -24dB
                                             100 = -36dB
                                             101 = Reserved
                                             11X = Reserved
                 1:0   AIF1DRC2_MA      01   AIF1 DRC2 Maximum gain to boost audio signals (dB)
                        XGAIN [1:0]          00 = 12dB
                                             01 = 18dB
                                             10 = 24dB
                                             11 = 36dB
Register 0451h AIF1 DRC2 (2)
 REGISTER       BIT        LABEL     DEFAULT                        DESCRIPTION                        REFER TO
 ADDRESS
   R1106       15:12  AIF1DRC2_NG_     0000  AIF1 DRC2 Minimum gain to attenuate audio signals when
(0452h) AIF1           MINGAIN [3:0]         the noise gate is active.
  DRC2 (3)                                   0000 = -36dB
                                             0001 = -30dB
                                             0010 = -24dB
                                             0011 = -18dB
                                             0100 = -12dB
                                             0101 = -6dB
                                             0110 = 0dB
                                             0111 = 6dB
                                                                                          PP, March 2014, Rev 3.5
w
                                                                                                             319


WM8958                                                                                                Pre-Production
 REGISTER       BIT        LABEL     DEFAULT                        DESCRIPTION                           REFER TO
 ADDRESS
                                              1000 = 12dB
                                              1001 = 18dB
                                              1010 = 24dB
                                              1011 = 30dB
                                              1100 = 36dB
                                              1101 to 1111 = Reserved
               11:10  AIF1DRC2_NG_       00   AIF1 DRC2 Noise Gate slope
                          EXP [1:0]           00 = 1 (no expansion)
                                              01 = 2
                                              10 = 4
                                              11 = 8
                 9:8  AIF1DRC2_QR_       00   AIF1 DRC2 Quick-release threshold (crest factor in dB)
                          THR [1:0]           00 = 12dB
                                              01 = 18dB
                                              10 = 24dB
                                              11 = 30dB
                 7:6  AIF1DRC2_QR_       00   AIF1 DRC2 Quick-release decay rate (seconds/6dB)
                          DCY [1:0]           00 = 0.725ms
                                              01 = 1.45ms
                                              10 = 5.8ms
                                              11 = Reserved
                 5:3   AIF1DRC2_HI_      000  AIF1 DRC2 Compressor slope (upper region)
                         COMP [2:0]           000 = 1 (no compression)
                                              001 = 1/2
                                              010 = 1/4
                                              011 = 1/8
                                              100 = 1/16
                                              101 = 0
                                              110 = Reserved
                                              111 = Reserved
                 2:0  AIF1DRC2_LO_       000  AIF1 DRC2 Compressor slope (lower region)
                         COMP [2:0]           000 = 1 (no compression)
                                              001 = 1/2
                                              010 = 1/4
                                              011 = 1/8
                                              100 = 0
                                              101 = Reserved
                                              11X = Reserved
Register 0452h AIF1 DRC2 (3)
 REGISTER       BIT        LABEL     DEFAULT                        DESCRIPTION                           REFER TO
 ADDRESS
   R1107        10:5  AIF1DRC2_KNE    00_0000 AIF1 DRC2 Input signal level at the Compressor ‘Knee’.
(0453h) AIF1              E_IP [5:0]          000000 = 0dB
  DRC2 (4)                                    000001 = -0.75dB
                                              000010 = -1.5dB
                                              … (-0.75dB steps)
                                              111100 = -45dB
                                              111101 = Reserved
                                              11111X = Reserved
                 4:0  AIF1DRC2_KNE     0_0000 AIF1 DRC2 Output signal at the Compressor ‘Knee’.
                         E_OP [4:0]           00000 = 0dB
                                                                                             PP, March 2014, Rev 3.5
w
                                                                                                                320


Pre-Production                                                                                           WM8958
 REGISTER       BIT        LABEL      DEFAULT                      DESCRIPTION                             REFER TO
 ADDRESS
                                              00001 = -0.75dB
                                              00010 = -1.5dB
                                              … (-0.75dB steps)
                                              11110 = -22.5dB
                                              11111 = Reserved
Register 0453h AIF1 DRC2 (4)
 REGISTER       BIT        LABEL      DEFAULT                      DESCRIPTION                             REFER TO
 ADDRESS
   R1108        9:5   AIF1DRC2_KNE     0_0000 AIF1 DRC2 Input signal level at the Noise Gate threshold
(0454h) AIF1             E2_IP [4:0]          ‘Knee2’.
  DRC2 (5)                                    00000 = -36dB
                                              00001 = -37.5dB
                                              00010 = -39dB
                                              … (-1.5dB steps)
                                              11110 = -81dB
                                              11111 = -82.5dB
                                              Only applicable when AIF1DRC2_NG_ENA = 1.
                 4:0  AIF1DRC2_KNE     0_0000 AIF1 DRC2 Output signal at the Noise Gate threshold
                        E2_OP [4:0]           ‘Knee2’.
                                              00000 = -30dB
                                              00001 = -31.5dB
                                              00010 = -33dB
                                              … (-1.5dB steps)
                                              11110 = -75dB
                                              11111 = -76.5dB
                                              Only applicable when AIF1DRC2_KNEE2_OP_ENA = 1.
Register 0454h AIF1 DRC2 (5)
 REGISTER       BIT        LABEL      DEFAULT                      DESCRIPTION                             REFER TO
 ADDRESS
   R1152       15:11  AIF1DAC1_EQ_     0_1100 AIF1DAC1 (AIF1, Timeslot 0) EQ Band 1 Gain
(0480h) AIF1           B1_GAIN [4:0]          -12dB to +12dB in 1dB steps
  DAC1 EQ
                10:6  AIF1DAC1_EQ_     0_1100 AIF1DAC1 (AIF1, Timeslot 0) EQ Band 2 Gain
  Gains (1)
                       B2_GAIN [4:0]          -12dB to +12dB in 1dB steps
                 5:1  AIF1DAC1_EQ_     0_1100 AIF1DAC1 (AIF1, Timeslot 0) EQ Band 3 Gain
                       B3_GAIN [4:0]          -12dB to +12dB in 1dB steps
                  0   AIF1DAC1_EQ_        0   Enable EQ in AIF1DAC1 playback path (AIF1, Timeslot 0)
                             ENA              0 = Disabled
                                              1 = Enabled
Register 0480h AIF1 DAC1 EQ Gains (1)
 REGISTER       BIT        LABEL      DEFAULT                      DESCRIPTION                             REFER TO
 ADDRESS
   R1153       15:11  AIF1DAC1_EQ_     0_1100 AIF1DAC1 (AIF1, Timeslot 0) EQ Band 4 Gain
(0481h) AIF1           B4_GAIN [4:0]          -12dB to +12dB in 1dB steps
  DAC1 EQ
                10:6  AIF1DAC1_EQ_     0_1100 AIF1DAC1 (AIF1, Timeslot 0) EQ Band 5 Gain
  Gains (2)
                       B5_GAIN [4:0]          -12dB to +12dB in 1dB steps
                  0   AIF1DAC1_EQ_        0   AIF1DAC1 (AIF1, Timeslot 0) EQ Band 1 Mode
                           MODE               0 = Shelving filter
                                              1 = Peak filter
Register 0481h AIF1 DAC1 EQ Gains (2)
                                                                                              PP, March 2014, Rev 3.5
w
                                                                                                                 321


WM8958                                                                                    Pre-Production
 REGISTER       BIT       LABEL       DEFAULT                        DESCRIPTION              REFER TO
 ADDRESS
   R1154        15:0  AIF1DAC1_EQ_    0000_1111 EQ Band 1 Coefficient A
(0482h) AIF1            B1_A [15:0]   _1100_101
  DAC1 EQ                                 0
  Band 1 A
Register 0482h AIF1 DAC1 EQ Band 1 A
 REGISTER       BIT       LABEL       DEFAULT                        DESCRIPTION              REFER TO
 ADDRESS
   R1155        15:0  AIF1DAC1_EQ_    0000_0100 EQ Band 1 Coefficient B
(0483h) AIF1            B1_B [15:0]   _0000_000
  DAC1 EQ                                 0
  Band 1 B
Register 0483h AIF1 DAC1 EQ Band 1 B
 REGISTER       BIT       LABEL       DEFAULT                        DESCRIPTION              REFER TO
 ADDRESS
   R1156        15:0  AIF1DAC1_EQ_    0000_0000 EQ Band 1 Coefficient PG
(0484h) AIF1           B1_PG [15:0]   _1101_100
  DAC1 EQ                                 0
 Band 1 PG
Register 0484h AIF1 DAC1 EQ Band 1 PG
 REGISTER       BIT       LABEL       DEFAULT                        DESCRIPTION              REFER TO
 ADDRESS
   R1157        15:0  AIF1DAC1_EQ_    0001_1110 EQ Band 2 Coefficient A
(0485h) AIF1            B2_A [15:0]   _1011_010
  DAC1 EQ                                 1
  Band 2 A
Register 0485h AIF1 DAC1 EQ Band 2 A
 REGISTER       BIT       LABEL       DEFAULT                        DESCRIPTION              REFER TO
 ADDRESS
   R1158        15:0  AIF1DAC1_EQ_    1111_0001 EQ Band 2 Coefficient B
(0486h) AIF1            B2_B [15:0]   _0100_010
  DAC1 EQ                                 1
  Band 2 B
Register 0486h AIF1 DAC1 EQ Band 2 B
 REGISTER       BIT       LABEL       DEFAULT                        DESCRIPTION              REFER TO
 ADDRESS
   R1159        15:0  AIF1DAC1_EQ_    0000_1011 EQ Band 2 Coefficient C
(0487h) AIF1            B2_C [15:0]   _0111_010
  DAC1 EQ                                 1
  Band 2 C
Register 0487h AIF1 DAC1 EQ Band 2 C
                                                                                 PP, March 2014, Rev 3.5
w
                                                                                                    322


Pre-Production                                                                              WM8958
 REGISTER       BIT       LABEL       DEFAULT                        DESCRIPTION              REFER TO
 ADDRESS
   R1160        15:0  AIF1DAC1_EQ_    0000_0001 EQ Band 2 Coefficient PG
(0488h) AIF1           B2_PG [15:0]   _1100_010
  DAC1 EQ                                 1
 Band 2 PG
Register 0488h AIF1 DAC1 EQ Band 2 PG
 REGISTER       BIT       LABEL       DEFAULT                        DESCRIPTION              REFER TO
 ADDRESS
   R1161        15:0  AIF1DAC1_EQ_    0001_1100 EQ Band 3 Coefficient A
(0489h) AIF1            B3_A [15:0]   _0101_100
  DAC1 EQ                                 0
  Band 3 A
Register 0489h AIF1 DAC1 EQ Band 3 A
 REGISTER       BIT       LABEL       DEFAULT                        DESCRIPTION              REFER TO
 ADDRESS
   R1162        15:0  AIF1DAC1_EQ_    1111_0011 EQ Band 3 Coefficient B
(048Ah) AIF1            B3_B [15:0]   _0111_001
  DAC1 EQ                                 1
  Band 3 B
Register 048Ah AIF1 DAC1 EQ Band 3 B
 REGISTER       BIT       LABEL       DEFAULT                        DESCRIPTION              REFER TO
 ADDRESS
   R1163        15:0  AIF1DAC1_EQ_    0000_1010 EQ Band 3 Coefficient C
(048Bh) AIF1            B3_C [15:0]   _0101_010
  DAC1 EQ                                 0
  Band 3 C
Register 048Bh AIF1 DAC1 EQ Band 3 C
 REGISTER       BIT       LABEL       DEFAULT                        DESCRIPTION              REFER TO
 ADDRESS
   R1164        15:0  AIF1DAC1_EQ_    0000_0101 EQ Band 3 Coefficient PG
(048Ch) AIF1           B3_PG [15:0]   _0101_100
  DAC1 EQ                                 0
 Band 3 PG
Register 048Ch AIF1 DAC1 EQ Band 3 PG
 REGISTER       BIT       LABEL       DEFAULT                        DESCRIPTION              REFER TO
 ADDRESS
   R1165        15:0  AIF1DAC1_EQ_    0001_0110 EQ Band 4 Coefficient A
(048Dh) AIF1            B4_A [15:0]   _1000_111
  DAC1 EQ                                 0
  Band 4 A
Register 048Dh AIF1 DAC1 EQ Band 4 A
                                                                                 PP, March 2014, Rev 3.5
w
                                                                                                    323


WM8958                                                                                    Pre-Production
 REGISTER       BIT       LABEL       DEFAULT                        DESCRIPTION              REFER TO
 ADDRESS
   R1166        15:0  AIF1DAC1_EQ_    1111_1000 EQ Band 4 Coefficient B
(048Eh) AIF1            B4_B [15:0]   _0010_100
  DAC1 EQ                                 1
  Band 4 B
Register 048Eh AIF1 DAC1 EQ Band 4 B
 REGISTER       BIT       LABEL       DEFAULT                        DESCRIPTION              REFER TO
 ADDRESS
   R1167        15:0  AIF1DAC1_EQ_    0000_0111 EQ Band 4 Coefficient C
(048Fh) AIF1            B4_C [15:0]   _1010_110
  DAC1 EQ                                 1
  Band 4 C
Register 048Fh AIF1 DAC1 EQ Band 4 C
 REGISTER       BIT       LABEL       DEFAULT                        DESCRIPTION              REFER TO
 ADDRESS
   R1168        15:0  AIF1DAC1_EQ_    0001_0001 EQ Band 4 Coefficient PG
(0490h) AIF1           B4_PG [15:0]   _0000_001
  DAC1 EQ                                 1
 Band 4 PG
Register 0490h AIF1 DAC1 EQ Band 4 PG
 REGISTER       BIT       LABEL       DEFAULT                        DESCRIPTION              REFER TO
 ADDRESS
   R1169        15:0  AIF1DAC1_EQ_    0000_0101 EQ Band 5 Coefficient A
(0491h) AIF1            B5_A [15:0]   _0110_010
  DAC1 EQ                                 0
  Band 5 A
Register 0491h AIF1 DAC1 EQ Band 5 A
 REGISTER       BIT       LABEL       DEFAULT                        DESCRIPTION              REFER TO
 ADDRESS
   R1170        15:0  AIF1DAC1_EQ_    0000_0101 EQ Band 5 Coefficient B
(0492h) AIF1            B5_B [15:0]   _0101_100
  DAC1 EQ                                 1
  Band 5 B
Register 0492h AIF1 DAC1 EQ Band 5 B
 REGISTER       BIT       LABEL       DEFAULT                        DESCRIPTION              REFER TO
 ADDRESS
   R1171        15:0  AIF1DAC1_EQ_    0100_0000 EQ Band 5 Coefficient PG
(0493h) AIF1           B5_PG [15:0]   _0000_000
  DAC1 EQ                                 0
 Band 5 PG
Register 0493h AIF1 DAC1 EQ Band 5 PG
                                                                                 PP, March 2014, Rev 3.5
w
                                                                                                    324


Pre-Production                                                                                          WM8958
 REGISTER       BIT       LABEL       DEFAULT                        DESCRIPTION                          REFER TO
 ADDRESS
   R1184       15:11  AIF1DAC2_EQ_      0_1100  AIF1DAC2 (AIF1, Timeslot 1) EQ Band 1 Gain
(04A0h) AIF1           B1_GAIN [4:0]            -12dB to +12dB in 1dB steps
  DAC2 EQ
                10:6  AIF1DAC2_EQ_      0_1100  AIF1DAC2 (AIF1, Timeslot 1) EQ Band 2 Gain
  Gains (1)
                       B2_GAIN [4:0]            -12dB to +12dB in 1dB steps
                 5:1  AIF1DAC2_EQ_      0_1100  AIF1DAC2 (AIF1, Timeslot 1) EQ Band 3 Gain
                       B3_GAIN [4:0]            -12dB to +12dB in 1dB steps
                  0   AIF1DAC2_EQ_         0    Enable EQ in AIF1DAC2 playback path (AIF1, Timeslot 1)
                           ENA                  0 = Disabled
                                                1 = Enabled
Register 04A0h AIF1 DAC2 EQ Gains (1)
 REGISTER       BIT       LABEL       DEFAULT                        DESCRIPTION                          REFER TO
 ADDRESS
   R1185       15:11  AIF1DAC2_EQ_      0_1100  AIF1DAC2 (AIF1, Timeslot 1) EQ Band 4 Gain
(04A1h) AIF1           B4_GAIN [4:0]            -12dB to +12dB in 1dB steps
  DAC2 EQ
                10:6  AIF1DAC2_EQ_      0_1100  AIF1DAC2 (AIF1, Timeslot 1) EQ Band 5 Gain
  Gains (2)
                       B5_GAIN [4:0]            -12dB to +12dB in 1dB steps
                  0   AIF1DAC2_EQ_         0    AIF1DAC2 (AIF1, Timeslot 1) EQ Band 1 Mode
                          MODE                  0 = Shelving filter
                                                1 = Peak filter
Register 04A1h AIF1 DAC2 EQ Gains (2)
 REGISTER       BIT       LABEL       DEFAULT                        DESCRIPTION                          REFER TO
 ADDRESS
   R1186        15:0  AIF1DAC2_EQ_    0000_1111 EQ Band 1 Coefficient A
(04A2h) AIF1            B1_A [15:0]   _1100_101
  DAC2 EQ                                  0
  Band 1 A
Register 04A2h AIF1 DAC2 EQ Band 1 A
 REGISTER       BIT       LABEL       DEFAULT                        DESCRIPTION                          REFER TO
 ADDRESS
   R1187        15:0  AIF1DAC2_EQ_    0000_0100 EQ Band 1 Coefficient B
(04A3h) AIF1            B1_B [15:0]   _0000_000
  DAC2 EQ                                  0
  Band 1 B
Register 04A3h AIF1 DAC2 EQ Band 1 B
 REGISTER       BIT       LABEL       DEFAULT                        DESCRIPTION                          REFER TO
 ADDRESS
   R1188        15:0  AIF1DAC2_EQ_    0000_0000 EQ Band 1 Coefficient PG
(04A4h) AIF1           B1_PG [15:0]   _1101_100
  DAC2 EQ                                  0
 Band 1 PG
Register 04A4h AIF1 DAC2 EQ Band 1 PG
                                                                                             PP, March 2014, Rev 3.5
w
                                                                                                                325


WM8958                                                                                    Pre-Production
 REGISTER       BIT       LABEL       DEFAULT                        DESCRIPTION              REFER TO
 ADDRESS
   R1189       15:0   AIF1DAC2_EQ_    0001_1110 EQ Band 2 Coefficient A
(04A5h) AIF1            B2_A [15:0]   _1011_010
  DAC2 EQ                                 1
  Band 2 A
Register 04A5h AIF1 DAC2 EQ Band 2 A
 REGISTER       BIT       LABEL       DEFAULT                        DESCRIPTION              REFER TO
 ADDRESS
   R1190       15:0   AIF1DAC2_EQ_    1111_0001 EQ Band 2 Coefficient B
(04A6h) AIF1            B2_B [15:0]   _0100_010
  DAC2 EQ                                 1
  Band 2 B
Register 04A6h AIF1 DAC2 EQ Band 2 B
 REGISTER       BIT       LABEL       DEFAULT                        DESCRIPTION              REFER TO
 ADDRESS
   R1191       15:0   AIF1DAC2_EQ_    0000_1011 EQ Band 2 Coefficient C
(04A7h) AIF1            B2_C [15:0]   _0111_010
  DAC2 EQ                                 1
  Band 2 C
Register 04A7h AIF1 DAC2 EQ Band 2 C
 REGISTER       BIT       LABEL       DEFAULT                        DESCRIPTION              REFER TO
 ADDRESS
   R1192       15:0   AIF1DAC2_EQ_    0000_0001 EQ Band 2 Coefficient PG
(04A8h) AIF1           B2_PG [15:0]   _1100_010
  DAC2 EQ                                 1
 Band 2 PG
Register 04A8h AIF1 DAC2 EQ Band 2 PG
 REGISTER       BIT       LABEL       DEFAULT                        DESCRIPTION              REFER TO
 ADDRESS
   R1193       15:0   AIF1DAC2_EQ_    0001_1100 EQ Band 3 Coefficient A
(04A9h) AIF1            B3_A [15:0]   _0101_100
  DAC2 EQ                                 0
  Band 3 A
Register 04A9h AIF1 DAC2 EQ Band 3 A
 REGISTER       BIT       LABEL       DEFAULT                        DESCRIPTION              REFER TO
 ADDRESS
   R1194       15:0   AIF1DAC2_EQ_    1111_0011 EQ Band 3 Coefficient B
(04AAh) AIF1            B3_B [15:0]   _0111_001
  DAC2 EQ                                 1
  Band 3 B
Register 04AAh AIF1 DAC2 EQ Band 3 B
                                                                                 PP, March 2014, Rev 3.5
w
                                                                                                    326


Pre-Production                                                                              WM8958
 REGISTER       BIT       LABEL       DEFAULT                        DESCRIPTION              REFER TO
  ADDRESS
    R1195      15:0   AIF1DAC2_EQ_    0000_1010 EQ Band 3 Coefficient C
(04ABh) AIF1            B3_C [15:0]   _0101_010
  DAC2 EQ                                 0
   Band 3 C
Register 04ABh AIF1 DAC2 EQ Band 3 C
 REGISTER       BIT       LABEL       DEFAULT                        DESCRIPTION              REFER TO
  ADDRESS
    R1196      15:0   AIF1DAC2_EQ_    0000_0101 EQ Band 3 Coefficient PG
(04ACh) AIF1           B3_PG [15:0]   _0101_100
  DAC2 EQ                                 0
 Band 3 PG
Register 04ACh AIF1 DAC2 EQ Band 3 PG
 REGISTER       BIT       LABEL       DEFAULT                        DESCRIPTION              REFER TO
  ADDRESS
    R1197      15:0   AIF1DAC2_EQ_    0001_0110 EQ Band 4 Coefficient A
(04ADh) AIF1            B4_A [15:0]   _1000_111
  DAC2 EQ                                 0
   Band 4 A
Register 04ADh AIF1 DAC2 EQ Band 4 A
 REGISTER       BIT       LABEL       DEFAULT                        DESCRIPTION              REFER TO
  ADDRESS
    R1198      15:0   AIF1DAC2_EQ_    1111_1000 EQ Band 4 Coefficient B
(04AEh) AIF1            B4_B [15:0]   _0010_100
  DAC2 EQ                                 1
   Band 4 B
Register 04AEh AIF1 DAC2 EQ Band 4 B
 REGISTER       BIT       LABEL       DEFAULT                        DESCRIPTION              REFER TO
  ADDRESS
    R1199      15:0   AIF1DAC2_EQ_    0000_0111 EQ Band 4 Coefficient C
(04AFh) AIF1            B4_C [15:0]   _1010_110
  DAC2 EQ                                 1
   Band 4 C
Register 04AFh AIF1 DAC2 EQ Band 4 C
 REGISTER       BIT       LABEL       DEFAULT                        DESCRIPTION              REFER TO
  ADDRESS
    R1200      15:0   AIF1DAC2_EQ_    0001_0001 EQ Band 4 Coefficient PG
(04B0h) AIF1           B4_PG [15:0]   _0000_001
  DAC2 EQ                                 1
 Band 4 PG
Register 04B0h AIF1 DAC2 EQ Band 4 PG
                                                                                 PP, March 2014, Rev 3.5
w
                                                                                                    327


WM8958                                                                                                    Pre-Production
 REGISTER       BIT        LABEL      DEFAULT                            DESCRIPTION                          REFER TO
 ADDRESS
   R1201        15:0  AIF1DAC2_EQ_    0000_0101 EQ Band 5 Coefficient A
(04B1h) AIF1             B5_A [15:0]  _0110_010
  DAC2 EQ                                 0
  Band 5 A
Register 04B1h AIF1 DAC2 EQ Band 5 A
 REGISTER       BIT        LABEL      DEFAULT                            DESCRIPTION                          REFER TO
 ADDRESS
   R1202        15:0  AIF1DAC2_EQ_    0000_0101 EQ Band 5 Coefficient B
(04B2h) AIF1             B5_B [15:0]  _0101_100
  DAC2 EQ                                 1
  Band 5 B
Register 04B2h AIF1 DAC2 EQ Band 5 B
 REGISTER       BIT        LABEL      DEFAULT                            DESCRIPTION                          REFER TO
 ADDRESS
   R1203        15:0  AIF1DAC2_EQ_    0100_0000 EQ Band 5 Coefficient PG
(04B3h) AIF1            B5_PG [15:0]  _0000_000
  DAC2 EQ                                 0
 Band 5 PG
Register 04B3h AIF1 DAC2 EQ Band 5 PG
 REGISTER       BIT        LABEL      DEFAULT                            DESCRIPTION                          REFER TO
 ADDRESS
   R1280          8    AIF2ADC_VU         0     AIF2ADC output path Volume Update
(0500h) AIF2                                    Writing a 1 to this bit will cause the AIF2ADCL and
  ADC Left                                      AIF2ADCR volume to be updated simultaneously
   Volume
                 7:0  AIF2ADCL_VOL    1100_0000 AIF2ADC (Left) output path Digital Volume
                             [7:0]              00h = MUTE
                                                01h = -71.625dB
                                                … (0.375dB steps)
                                                EFh = +17.625dB
Register 0500h AIF2 ADC Left Volume
 REGISTER       BIT        LABEL      DEFAULT                            DESCRIPTION                          REFER TO
 ADDRESS
   R1281          8    AIF2ADC_VU         0     AIF2ADC output path Volume Update
(0501h) AIF2                                    Writing a 1 to this bit will cause the AIF2ADCL and
 ADC Right                                      AIF2ADCR volume to be updated simultaneously
   Volume
                 7:0  AIF2ADCR_VOL 1100_0000 AIF2ADC (Right) output path Digital Volume
                             [7:0]              00h = MUTE
                                                01h = -71.625dB
                                                … (0.375dB steps)
                                                EFh = +17.625dB
Register 0501h AIF2 ADC Right Volume
                                                                                                 PP, March 2014, Rev 3.5
w
                                                                                                                    328


Pre-Production                                                                                             WM8958
 REGISTER       BIT         LABEL    DEFAULT                            DESCRIPTION                          REFER TO
 ADDRESS
   R1282         8     AIF2DAC_VU        0     AIF2DAC input path Volume Update
(0502h) AIF2                                   Writing a 1 to this bit will cause the AIF2DACL and
  DAC Left                                     AIF2DACR volume to be updated simultaneously
   Volume
                7:0   AIF2DACL_VOL   1100_0000 AIF2DAC (Left) input path Digital Volume
                             [7:0]             00h = MUTE
                                               01h = -71.625dB
                                               … (0.375dB steps)
                                               C0h = 0dB
                                               FFh = 0dB
Register 0502h AIF2 DAC Left Volume
 REGISTER       BIT         LABEL    DEFAULT                            DESCRIPTION                          REFER TO
 ADDRESS
   R1283         8     AIF2DAC_VU        0     AIF2DAC input path Volume Update
(0503h) AIF2                                   Writing a 1 to this bit will cause the AIF2DACL and
 DAC Right                                     AIF2DACR volume to be updated simultaneously
   Volume
                7:0   AIF2DACR_VOL 1100_0000 AIF2DAC (Right) input path Digital Volume
                             [7:0]             00h = MUTE
                                               01h = -71.625dB
                                               … (0.375dB steps)
                                               C0h = 0dB
                                               FFh = 0dB
Register 0503h AIF2 DAC Right Volume
 REGISTER       BIT         LABEL    DEFAULT                            DESCRIPTION                          REFER TO
 ADDRESS
   R1296       14:13  AIF2ADC_HPF_       00    AIF2ADC output path Digital HPF Cut-Off Frequency (fc)
(0510h) AIF2              CUT [1:0]            00 = Hi-fi mode (fc = 4Hz at fs = 48kHz)
 ADC Filters                                   01 = Voice mode 1 (fc = 127Hz at fs = 8kHz)
                                               10 = Voice mode 2 (fc = 130Hz at fs = 8kHz)
                                               11 = Voice mode 3 (fc = 267Hz at fs = 8kHz)
                 12   AIF2ADCL_HPF       0     AIF2ADC (Left) output path Digital HPF Enable
                                               0 = Disabled
                                               1 = Enabled
                 11   AIF2ADCR_HPF       0     AIF2ADC (Right) output path Digital HPF Enable
                                               0 = Disabled
                                               1 = Enabled
Register 0510h AIF2 ADC Filters
                                                                                                PP, March 2014, Rev 3.5
w
                                                                                                                   329


WM8958                                                                                              Pre-Production
 REGISTER       BIT         LABEL    DEFAULT                       DESCRIPTION                          REFER TO
 ADDRESS
   R1312          9    AIF2DAC_MUT       1   AIF2DAC input path Soft Mute Control
(0520h) AIF2                   E             0 = Un-mute
 DAC Filters                                 1 = Mute
     (1)
                  7    AIF2DAC_MON       0   AIF2DAC input path Mono Mix Control
                               O             0 = Disabled
                                             1 = Enabled
                  5    AIF2DAC_MUT       0   AIF2DAC input path Soft Mute Ramp Rate
                            ERATE            0 = Fast ramp (fs/2, maximum ramp time is 10.7ms at
                                             fs=48k)
                                             1 = Slow ramp (fs/32, maximum ramp time is 171ms at
                                             fs=48k)
                                             (Note: ramp rate scales with sample rate.)
                  4    AIF2DAC_UNM       0   AIF2DAC input path Unmute Ramp select
                         UTE_RAMP            0 = Disabling soft-mute (AIF2DAC_MUTE=0) will cause the
                                             volume to change immediately to AIF2DACL_VOL and
                                             AIF2DACR_VOL settings
                                             1 = Disabling soft-mute (AIF2DAC_MUTE=0) will cause the
                                             DAC volume to ramp up gradually to the AIF2DACL_VOL
                                             and AIF2DACR_VOL settings
Register 0520h AIF2 DAC Filters (1)
 REGISTER       BIT         LABEL    DEFAULT                       DESCRIPTION                          REFER TO
 ADDRESS
   R1313        13:9  AIF2DAC_3D_G    0_0000 AIF2DAC playback path 3D Stereo depth
(0521h) AIF2               AIN [4:0]         00000 = Off
 DAC Filters                                 00001 = Minimum (-16dB)
     (2)
                                             …(0.915dB steps)
                                             11111 = Maximum (+11.45dB)
                  8   AIF2DAC_3D_E       0   Enable 3D Stereo in AIF2DAC playback path
                              NA             0 = Disabled
                                             1 = Enabled
Register 0521h AIF2 DAC Filters (2)
 REGISTER       BIT         LABEL    DEFAULT                       DESCRIPTION                          REFER TO
 ADDRESS
   R1328         6:5  AIF2DAC_NG_H      11   AIF2DAC input path Noise Gate Hold Time
(0430h) AIF2                LD [1:0]         (delay before noise gate is activated)
 DAC Noise                                   00 = 30ms
    Gate
                                             01 = 125ms
                                             10 = 250ms
                                             11 = 500ms
                 3:1  AIF2DAC_NG_T      100  AIF2DAC input path Noise Gate Threshold
                           HR [2:0]          000 = -60dB
                                             001 = -66dB
                                             010 = -72dB
                                             011 = -78dB
                                             100 = -84dB
                                             101 = -90dB
                                             110 = -96dB
                                             111 = -102dB
                                                                                           PP, March 2014, Rev 3.5
w
                                                                                                              330


Pre-Production                                                                                              WM8958
 REGISTER       BIT         LABEL    DEFAULT                        DESCRIPTION                              REFER TO
 ADDRESS
                 0    AIF2DAC_NG_E       0   AIF2DAC input path Noise Gate Enable
                               NA            0 = Disabled
                                             1 = Enabled
Register 0530h AIF2 DAC Noise Gate
 REGISTER       BIT         LABEL    DEFAULT                        DESCRIPTION                              REFER TO
 ADDRESS
   R1344       15:11   AIF2DRC_SIG_   0_0000 AIF2 DRC Signal Detect RMS Threshold.
(0540h) AIF2           DET_RMS [4:0]         This is the RMS signal level for signal detect to be indicated
  DRC (1)                                    when AIF2DRC_SIG_DET_MODE=1.
                                             00000 = -30dB
                                             00001 = -31.5dB
                                             …. (1.5dB steps)
                                             11110 = -75dB
                                             11111 = -76.5dB
                10:9   AIF2DRC_SIG_     00   AIF2 DRC Signal Detect Peak Threshold.
                        DET_PK [1:0]         This is the Peak/RMS ratio, or Crest Factor, level for signal
                                             detect to be indicated when AIF2DRC_SIG_DET_MODE=0.
                                             00 = 12dB
                                             01 = 18dB
                                             10 = 24dB
                                             11 = 30dB
                 8    AIF2DRC_NG_E       0   AIF2 DRC Noise Gate Enable
                              NA             0 = Disabled
                                             1 = Enabled
                 7     AIF2DRC_SIG_      1   AIF2 DRC Signal Detect Mode
                         DET_MODE            0 = Peak threshold mode
                                             1 = RMS threshold mode
                 6     AIF2DRC_SIG_      0   AIF2 DRC Signal Detect Enable
                              DET            0 = Disabled
                                             1 = Enabled
                 5     AIF2DRC_KNE       0   AIF2 DRC KNEE2_OP Enable
                        E2_OP_ENA            0 = Disabled
                                             1 = Enabled
                 4      AIF2DRC_QR       1   AIF2 DRC Quick-release Enable
                                             0 = Disabled
                                             1 = Enabled
                 3     AIF2DRC_ANTI      1   AIF2 DRC Anti-clip Enable
                             CLIP            0 = Disabled
                                             1 = Enabled
                 2    AIF2DAC_DRC_       0   Enable DRC in AIF2DAC playback path
                             ENA             0 = Disabled
                                             1 = Enabled
                 1    AIF2ADCL_DRC       0   Enable DRC in AIF2ADC (Left) record path
                             _ENA            0 = Disabled
                                             1 = Enabled
                 0     AIF2ADCR_DR       0   Enable DRC in AIF2ADC (Right) record path
                           C_ENA             0 = Disabled
                                             1 = Enabled
Register 0540h AIF2 DRC (1)
                                                                                                PP, March 2014, Rev 3.5
w
                                                                                                                   331


WM8958                                                                                            Pre-Production
 REGISTER       BIT         LABEL   DEFAULT                       DESCRIPTION                         REFER TO
 ADDRESS
   R1345        12:9   AIF2DRC_ATK    0100  AIF2 DRC Gain attack rate (seconds/6dB)
(0541h) AIF2                 [3:0]          0000 = Reserved
  DRC (2)                                   0001 = 181us
                                            0010 = 363us
                                            0011 = 726us
                                            0100 = 1.45ms
                                            0101 = 2.9ms
                                            0110 = 5.8ms
                                            0111 = 11.6ms
                                            1000 = 23.2ms
                                            1001 = 46.4ms
                                            1010 = 92.8ms
                                            1011 = 185.6ms
                                            1100-1111 = Reserved
                 8:5   AIF2DRC_DCY    0010  AIF2 DRC Gain decay rate (seconds/6dB)
                             [3:0]          0000 = 186ms
                                            0001 = 372ms
                                            0010 = 743ms
                                            0011 = 1.49s
                                            0100 = 2.97s
                                            0101 = 5.94s
                                            0110 = 11.89s
                                            0111 = 23.78s
                                            1000 = 47.56s
                                            1001-1111 = Reserved
                 4:2  AIF2DRC_MING    001   AIF2 DRC Minimum gain to attenuate audio signals
                          AIN [2:0]         000 = 0dB
                                            001 = -12dB (default)
                                            010 = -18dB
                                            011 = -24dB
                                            100 = -36dB
                                            101 = Reserved
                                            11X = Reserved
                 1:0   AIF2DRC_MAX     01   AIF2 DRC Maximum gain to boost audio signals (dB)
                         GAIN [1:0]         00 = 12dB
                                            01 = 18dB
                                            10 = 24dB
                                            11 = 36dB
Register 0541h AIF2 DRC (2)
                                                                                         PP, March 2014, Rev 3.5
w
                                                                                                            332


Pre-Production                                                                                          WM8958
 REGISTER       BIT         LABEL    DEFAULT                        DESCRIPTION                           REFER TO
 ADDRESS
   R1346       15:12   AIF2DRC_NG_     0000  AIF2 DRC Minimum gain to attenuate audio signals when
(0542h) AIF2           MINGAIN [3:0]         the noise gate is active.
  DRC (3)                                    0000 = -36dB
                                             0001 = -30dB
                                             0010 = -24dB
                                             0011 = -18dB
                                             0100 = -12dB
                                             0101 = -6dB
                                             0110 = 0dB
                                             0111 = 6dB
                                             1000 = 12dB
                                             1001 = 18dB
                                             1010 = 24dB
                                             1011 = 30dB
                                             1100 = 36dB
                                             1101 to 1111 = Reserved
               11:10  AIF2DRC_NG_E      00   AIF2 DRC Noise Gate slope
                           XP [1:0]          00 = 1 (no expansion)
                                             01 = 2
                                             10 = 4
                                             11 = 8
                9:8   AIF2DRC_QR_T      00   AIF2 DRC Quick-release threshold (crest factor in dB)
                           HR [1:0]          00 = 12dB
                                             01 = 18dB
                                             10 = 24dB
                                             11 = 30dB
                7:6    AIF2DRC_QR_      00   AIF2 DRC Quick-release decay rate (seconds/6dB)
                          DCY [1:0]          00 = 0.725ms
                                             01 = 1.45ms
                                             10 = 5.8ms
                                             11 = Reserved
                5:3   AIF2DRC_HI_C     000   AIF2 DRC Compressor slope (upper region)
                          OMP [2:0]          000 = 1 (no compression)
                                             001 = 1/2
                                             010 = 1/4
                                             011 = 1/8
                                             100 = 1/16
                                             101 = 0
                                             110 = Reserved
                                             111 = Reserved
                2:0   AIF2DRC_LO_C     000   AIF2 DRC Compressor slope (lower region)
                          OMP [2:0]          000 = 1 (no compression)
                                             001 = 1/2
                                             010 = 1/4
                                             011 = 1/8
                                             100 = 0
                                             101 = Reserved
                                             11X = Reserved
Register 0542h AIF2 DRC (3)
                                                                                             PP, March 2014, Rev 3.5
w
                                                                                                                333


WM8958                                                                                                  Pre-Production
 REGISTER       BIT         LABEL     DEFAULT                       DESCRIPTION                             REFER TO
 ADDRESS
   R1347        10:5   AIF2DRC_KNE     00_0000 AIF2 DRC Input signal level at the Compressor ‘Knee’.
(0543h) AIF2              E_IP [5:0]           000000 = 0dB
  DRC (4)                                      000001 = -0.75dB
                                               000010 = -1.5dB
                                               … (-0.75dB steps)
                                               111100 = -45dB
                                               111101 = Reserved
                                               11111X = Reserved
                 4:0   AIF2DRC_KNE      0_0000 AIF2 DRC Output signal at the Compressor ‘Knee’.
                          E_OP [4:0]           00000 = 0dB
                                               00001 = -0.75dB
                                               00010 = -1.5dB
                                               … (-0.75dB steps)
                                               11110 = -22.5dB
                                               11111 = Reserved
Register 0543h AIF2 DRC (4)
 REGISTER       BIT         LABEL     DEFAULT                       DESCRIPTION                             REFER TO
 ADDRESS
   R1348        9:5    AIF2DRC_KNE     0_0000  AIF2 DRC Input signal level at the Noise Gate threshold
(0544h) AIF2              E2_IP [4:0]          ‘Knee2’.
  DRC (5)                                      00000 = -36dB
                                               00001 = -37.5dB
                                               00010 = -39dB
                                               … (-1.5dB steps)
                                               11110 = -81dB
                                               11111 = -82.5dB
                                               Only applicable when AIF2DRC_NG_ENA = 1.
                 4:0   AIF2DRC_KNE      0_0000 AIF2 DRC Output signal at the Noise Gate threshold
                         E2_OP [4:0]           ‘Knee2’.
                                               00000 = -30dB
                                               00001 = -31.5dB
                                               00010 = -33dB
                                               … (-1.5dB steps)
                                               11110 = -75dB
                                               11111 = -76.5dB
                                               Only applicable when AIF2DRC_KNEE2_OP_ENA = 1.
Register 0544h AIF2 DRC (5)
 REGISTER       BIT         LABEL     DEFAULT                       DESCRIPTION                             REFER TO
 ADDRESS
   R1408       15:11   AIF2DAC_EQ_B     0_1100 AIF2 EQ Band 1 Gain
(0580h) AIF2             1_GAIN [4:0]          -12dB to +12dB in 1dB steps
EQ Gains (1)
                10:6   AIF2DAC_EQ_B     0_1100 AIF2 EQ Band 2 Gain
                         2_GAIN [4:0]          -12dB to +12dB in 1dB steps
                 5:1   AIF2DAC_EQ_B     0_1100 AIF2 EQ Band 3 Gain
                         3_GAIN [4:0]          -12dB to +12dB in 1dB steps
                  0    AIF2DAC_EQ_E        0   Enable EQ in AIF2DAC playback path
                             NA                0 = Disabled
                                               1 = Enabled
Register 0580h AIF2 EQ Gains (1)
                                                                                               PP, March 2014, Rev 3.5
w
                                                                                                                  334


Pre-Production                                                                              WM8958
 REGISTER       BIT        LABEL      DEFAULT                        DESCRIPTION              REFER TO
 ADDRESS
   R1409       15:11   AIF2DAC_EQ_B     0_1100  AIF2 EQ Band 4 Gain
(0581h) AIF2             4_GAIN [4:0]           -12dB to +12dB in 1dB steps
EQ Gains (2)
                10:6   AIF2DAC_EQ_B     0_1100  AIF2 EQ Band 5 Gain
                         5_GAIN [4:0]           -12dB to +12dB in 1dB steps
                 0      AIF2DAC_EQ_        0    AIF2 EQ Band 1 Mode
                            MODE                0 = Shelving filter
                                                1 = Peak filter
Register 0581h AIF2 EQ Gains (2)
 REGISTER       BIT        LABEL      DEFAULT                        DESCRIPTION              REFER TO
 ADDRESS
   R1410        15:0   AIF2DAC_EQ_B 0000_1111 EQ Band 1 Coefficient A
(0582h) AIF2              1_A [15:0]  _1100_101
EQ Band 1 A                               0
Register 0582h AIF2 EQ Band 1 A
 REGISTER       BIT        LABEL      DEFAULT                        DESCRIPTION              REFER TO
 ADDRESS
   R1411        15:0   AIF2DAC_EQ_B 0000_0100 EQ Band 1 Coefficient B
(0583h) AIF2              1_B [15:0]  _0000_000
EQ Band 1 B                               0
Register 0583h AIF2 EQ Band 1 B
 REGISTER       BIT        LABEL      DEFAULT                        DESCRIPTION              REFER TO
 ADDRESS
   R1412        15:0   AIF2DAC_EQ_B 0000_0000 EQ Band 1 Coefficient PG
(0584h) AIF2             1_PG [15:0]  _1101_100
 EQ Band 1                                0
     PG
Register 0584h AIF2 EQ Band 1 PG
 REGISTER       BIT        LABEL      DEFAULT                        DESCRIPTION              REFER TO
 ADDRESS
   R1413        15:0   AIF2DAC_EQ_B 0001_1110 EQ Band 2 Coefficient A
(0585h) AIF2              2_A [15:0]  _1011_010
EQ Band 2 A                               1
Register 0585h AIF2 EQ Band 2 A
 REGISTER       BIT        LABEL      DEFAULT                        DESCRIPTION              REFER TO
 ADDRESS
   R1414        15:0   AIF2DAC_EQ_B 1111_0001 EQ Band 2 Coefficient B
(0586h) AIF2              2_B [15:0]  _0100_010
EQ Band 2 B                               1
Register 0586h AIF2 EQ Band 2 B
 REGISTER       BIT        LABEL      DEFAULT                        DESCRIPTION              REFER TO
 ADDRESS
                                                                                 PP, March 2014, Rev 3.5
w
                                                                                                    335


WM8958                                                                                  Pre-Production
 REGISTER       BIT        LABEL     DEFAULT                       DESCRIPTION              REFER TO
 ADDRESS
   R1415        15:0   AIF2DAC_EQ_B 0000_1011 EQ Band 2 Coefficient C
(0587h) AIF2              2_C [15:0] _0111_010
EQ Band 2 C                              1
Register 0587h AIF2 EQ Band 2 C
 REGISTER       BIT        LABEL     DEFAULT                       DESCRIPTION              REFER TO
 ADDRESS
   R1416        15:0   AIF2DAC_EQ_B 0000_0001 EQ Band 2 Coefficient PG
(0588h) AIF2             2_PG [15:0] _1100_010
 EQ Band 2                               1
    PG
Register 0588h AIF2 EQ Band 2 PG
 REGISTER       BIT        LABEL     DEFAULT                       DESCRIPTION              REFER TO
 ADDRESS
   R1417        15:0   AIF2DAC_EQ_B 0001_1100 EQ Band 3 Coefficient A
(0589h) AIF2              3_A [15:0] _0101_100
EQ Band 3 A                              0
Register 0589h AIF2 EQ Band 3 A
 REGISTER       BIT        LABEL     DEFAULT                       DESCRIPTION              REFER TO
 ADDRESS
   R1418        15:0   AIF2DAC_EQ_B 1111_0011 EQ Band 3 Coefficient B
(058Ah) AIF2              3_B [15:0] _0111_001
EQ Band 3 B                              1
Register 058Ah AIF2 EQ Band 3 B
 REGISTER       BIT        LABEL     DEFAULT                       DESCRIPTION              REFER TO
 ADDRESS
   R1419        15:0   AIF2DAC_EQ_B 0000_1010 EQ Band 3 Coefficient C
(058Bh) AIF2              3_C [15:0] _0101_010
EQ Band 3 C                              0
Register 058Bh AIF2 EQ Band 3 C
 REGISTER       BIT        LABEL     DEFAULT                       DESCRIPTION              REFER TO
 ADDRESS
   R1420        15:0   AIF2DAC_EQ_B 0000_0101 EQ Band 3 Coefficient PG
(058Ch) AIF2             3_PG [15:0] _0101_100
 EQ Band 3                               0
    PG
Register 058Ch AIF2 EQ Band 3 PG
 REGISTER       BIT        LABEL     DEFAULT                       DESCRIPTION              REFER TO
 ADDRESS
   R1421        15:0   AIF2DAC_EQ_B 0001_0110 EQ Band 4 Coefficient A
(058Dh) AIF2              4_A [15:0] _1000_111
EQ Band 4 A                              0
Register 058Dh AIF2 EQ Band 4 A
                                                                               PP, March 2014, Rev 3.5
w
                                                                                                  336


Pre-Production                                                                            WM8958
 REGISTER       BIT        LABEL     DEFAULT                       DESCRIPTION              REFER TO
 ADDRESS
   R1422        15:0   AIF2DAC_EQ_B 1111_1000 EQ Band 4 Coefficient B
(058Eh) AIF2              4_B [15:0] _0010_100
EQ Band 4 B                              1
Register 058Eh AIF2 EQ Band 4 B
 REGISTER       BIT        LABEL     DEFAULT                       DESCRIPTION              REFER TO
 ADDRESS
   R1423        15:0   AIF2DAC_EQ_B 0000_0111 EQ Band 4 Coefficient C
(058Fh) AIF2              4_C [15:0] _1010_110
EQ Band 4 C                              1
Register 058Fh AIF2 EQ Band 4 C
 REGISTER       BIT        LABEL     DEFAULT                       DESCRIPTION              REFER TO
 ADDRESS
   R1424        15:0   AIF2DAC_EQ_B 0001_0001 EQ Band 4 Coefficient PG
(0590h) AIF2             4_PG [15:0] _0000_001
 EQ Band 4                               1
     PG
Register 0590h AIF2 EQ Band 4 PG
 REGISTER       BIT        LABEL     DEFAULT                       DESCRIPTION              REFER TO
 ADDRESS
   R1425        15:0   AIF2DAC_EQ_B 0000_0101 EQ Band 5 Coefficient A
(0591h) AIF2              5_A [15:0] _0110_010
EQ Band 5 A                              0
Register 0591h AIF2 EQ Band 5 A
 REGISTER       BIT        LABEL     DEFAULT                       DESCRIPTION              REFER TO
 ADDRESS
   R1426        15:0   AIF2DAC_EQ_B 0000_0101 EQ Band 5 Coefficient B
(0592h) AIF2              5_B [15:0] _0101_100
EQ Band 5 B                              1
Register 0592h AIF2 EQ Band 5 B
 REGISTER       BIT        LABEL     DEFAULT                       DESCRIPTION              REFER TO
 ADDRESS
   R1427        15:0   AIF2DAC_EQ_B 0100_0000 EQ Band 5 Coefficient PG
(0593h) AIF2             5_PG [15:0] _0000_000
 EQ Band 5                               0
     PG
Register 0593h AIF2 EQ Band 5 PG
                                                                               PP, March 2014, Rev 3.5
w
                                                                                                  337


WM8958                                                                                            Pre-Production
 REGISTER       BIT        LABEL        DEFAULT                        DESCRIPTION                    REFER TO
 ADDRESS
    R1536       8:5   ADCR_DAC1_V         0000  Sidetone STR to DAC1L and DAC1R Volume
   (0600h)                 OL [3:0]             0000 = -36dB
 DAC1 Mixer                                     0001 = -33dB
  Volumes
                                                …. (3dB steps)
                                                1011 = -3dB
                                                1100 = 0dB
                3:0   ADCL_DAC1_V         0000  Sidetone STL to DAC1L and DAC1R Volume
                           OL [3:0]             0000 = -36dB
                                                0001 = -33dB
                                                …. (3dB steps)
                                                1011 = -3dB
                                                1100 = 0dB
Register 0600h DAC1 Mixer Volumes
 REGISTER       BIT        LABEL        DEFAULT                        DESCRIPTION                    REFER TO
 ADDRESS
    R1537        5    ADCR_TO_DAC           0   Enable Sidetone STR to DAC1L
   (0601h)                   1L                 0 = Disabled
  DAC1 Left                                     1 = Enabled
Mixer Routing
                 4    ADCL_TO_DAC           0   Enable Sidetone STL to DAC1L
                             1L                 0 = Disabled
                                                1 = Enabled
                 2    AIF2DACL_TO_          0   Enable AIF2 (Left) to DAC1L
                           DAC1L                0 = Disabled
                                                1 = Enabled
                 1    AIF1DAC2L_TO          0   Enable AIF1 (Timeslot 1, Left) to DAC1L
                          _DAC1L                0 = Disabled
                                                1 = Enabled
                 0    AIF1DAC1L_TO          0   Enable AIF1 (Timeslot 0, Left) to DAC1L
                          _DAC1L                0 = Disabled
                                                1 = Enabled
Register 0601h DAC1 Left Mixer Routing
 REGISTER       BIT        LABEL        DEFAULT                        DESCRIPTION                    REFER TO
 ADDRESS
    R1538        5    ADCR_TO_DAC           0   Enable Sidetone STR to DAC1R
   (0602h)                   1R                 0 = Disabled
 DAC1 Right                                     1 = Enabled
Mixer Routing
                 4    ADCL_TO_DAC           0   Enable Sidetone STL to DAC1R
                             1R                 0 = Disabled
                                                1 = Enabled
                 2    AIF2DACR_TO_          0   Enable AIF2 (Right) to DAC1R
                           DAC1R                0 = Disabled
                                                1 = Enabled
                 1    AIF1DAC2R_TO          0   Enable AIF1 (Timeslot 1, Right) to DAC1R
                          _DAC1R                0 = Disabled
                                                1 = Enabled
                 0    AIF1DAC1R_TO          0   Enable AIF1 (Timeslot 0, Right) to DAC1R
                          _DAC1R                0 = Disabled
                                                1 = Enabled
Register 0602h DAC1 Right Mixer Routing
                                                                                         PP, March 2014, Rev 3.5
w
                                                                                                            338


Pre-Production                                                                                      WM8958
 REGISTER       BIT        LABEL        DEFAULT                        DESCRIPTION                    REFER TO
 ADDRESS
    R1539       8:5   ADCR_DAC2_V         0000  Sidetone STR to DAC2L and DAC2R Volume
   (0603h)                 OL [3:0]             0000 = -36dB
 DAC2 Mixer                                     0001 = -33dB
  Volumes
                                                …. (3dB steps)
                                                1011 = -3dB
                                                1100 = 0dB
                3:0   ADCL_DAC2_V         0000  Sidetone STL to DAC2L and DAC2R Volume
                           OL [3:0]             0000 = -36dB
                                                0001 = -33dB
                                                …. (3dB steps)
                                                1011 = -3dB
                                                1100 = 0dB
Register 0603h DAC2 Mixer Volumes
 REGISTER       BIT        LABEL        DEFAULT                        DESCRIPTION                    REFER TO
 ADDRESS
    R1540        5    ADCR_TO_DAC           0   Enable Sidetone STR to DAC2L
   (0604h)                   2L                 0 = Disabled
  DAC2 Left                                     1 = Enabled
Mixer Routing
                 4    ADCL_TO_DAC           0   Enable Sidetone STL to DAC2L
                             2L                 0 = Disabled
                                                1 = Enabled
                 2    AIF2DACL_TO_          0   Enable AIF2 (Left) to DAC2L
                           DAC2L                0 = Disabled
                                                1 = Enabled
                 1    AIF1DAC2L_TO          0   Enable AIF1 (Timeslot 1, Left) to DAC2L
                          _DAC2L                0 = Disabled
                                                1 = Enabled
                 0    AIF1DAC1L_TO          0   Enable AIF1 (Timeslot 0, Left) to DAC2L
                          _DAC2L                0 = Disabled
                                                1 = Enabled
Register 0604h DAC2 Left Mixer Routing
 REGISTER       BIT        LABEL        DEFAULT                        DESCRIPTION                    REFER TO
 ADDRESS
    R1541        5    ADCR_TO_DAC           0   Enable Sidetone STR to DAC2R
   (0605h)                   2R                 0 = Disabled
 DAC2 Right                                     1 = Enabled
Mixer Routing
                 4    ADCL_TO_DAC           0   Enable Sidetone STL to DAC2R
                             2R                 0 = Disabled
                                                1 = Enabled
                 2    AIF2DACR_TO_          0   Enable AIF2 (Right) to DAC2R
                           DAC2R                0 = Disabled
                                                1 = Enabled
                 1    AIF1DAC2R_TO          0   Enable AIF1 (Timeslot 1, Right) to DAC2R
                          _DAC2R                0 = Disabled
                                                1 = Enabled
                 0    AIF1DAC1R_TO          0   Enable AIF1 (Timeslot 0, Right) to DAC2R
                          _DAC2R                0 = Disabled
                                                1 = Enabled
Register 0605h DAC2 Right Mixer Routing
                                                                                         PP, March 2014, Rev 3.5
w
                                                                                                            339


WM8958                                                                                                      Pre-Production
 REGISTER       BIT        LABEL         DEFAULT                        DESCRIPTION                             REFER TO
 ADDRESS
   R1542         1    ADC1L_TO_AIF           0   Enable ADCL / DMIC1 (Left) to AIF1 (Timeslot 0, Left)
(0606h) AIF1              1ADC1L                 output
 ADC1 Left                                       0 = Disabled
Mixer Routing                                    1 = Enabled
                 0    AIF2DACL_TO_           0   Enable AIF2 (Left) to AIF1 (Timeslot 0, Left) output
                        AIF1ADC1L                0 = Disabled
                                                 1 = Enabled
Register 0606h AIF1 ADC1 Left Mixer Routing
 REGISTER       BIT        LABEL         DEFAULT                        DESCRIPTION                             REFER TO
 ADDRESS
   R1543         1    ADC1R_TO_AIF           0   Enable ADCR / DMIC1 (Right) to AIF1 (Timeslot 0, Right)
(0607h) AIF1              1ADC1R                 output
 ADC1 Right                                      0 = Disabled
Mixer Routing                                    1 = Enabled
                 0    AIF2DACR_TO_           0   Enable AIF2 (Right) to AIF1 (Timeslot 0, Right) output
                        AIF1ADC1R                0 = Disabled
                                                 1 = Enabled
Register 0607h AIF1 ADC1 Right Mixer Routing
 REGISTER       BIT        LABEL         DEFAULT                        DESCRIPTION                             REFER TO
 ADDRESS
   R1544         1    ADC2L_TO_AIF           0   Enable DMIC2 (Left) to AIF1 (Timeslot 1, Left) output
(0608h) AIF1              1ADC2L                 0 = Disabled
 ADC2 Left                                       1 = Enabled
Mixer Routing
                 0    AIF2DACL_TO_           0   Enable AIF2 (Left) to AIF1 (Timeslot 1, Left) output
                        AIF1ADC2L                0 = Disabled
                                                 1 = Enabled
Register 0608h AIF1 ADC2 Left Mixer Routing
 REGISTER       BIT        LABEL         DEFAULT                        DESCRIPTION                             REFER TO
 ADDRESS
   R1545         1    ADC2R_TO_AIF           0   Enable DMIC2 (Right) to AIF1 (Timeslot 1, Right) output
(0609h) AIF1              1ADC2R                 0 = Disabled
 ADC2 Right                                      1 = Enabled
mixer Routing
                 0    AIF2DACR_TO_           0   Enable AIF2 (Right) to AIF1 (Timeslot 1, Right) output
                        AIF1ADC2R                0 = Disabled
                                                 1 = Enabled
Register 0609h AIF1 ADC2 Right mixer Routing
                                                                                                   PP, March 2014, Rev 3.5
w
                                                                                                                      340


Pre-Production                                                                                            WM8958
 REGISTER       BIT        LABEL   DEFAULT                            DESCRIPTION                           REFER TO
 ADDRESS
    R1552        9     DAC1L_MUTE      1     DAC1L Soft Mute Control
   (0610h)                                   0 = DAC Un-mute
 DAC1 Left                                   1 = DAC Mute
   Volume
                 8        DAC1_VU      0     DAC1L and DAC1R Volume Update
                                             Writing a 1 to this bit will cause the DAC1L and DAC1R
                                             volume to be updated simultaneously
                7:0      DAC1L_VOL 1100_0000 DAC1L Digital Volume
                             [7:0]           00h = MUTE
                                             01h = -71.625dB
                                             … (0.375dB steps)
                                             C0h = 0dB
                                             … (0.375dB steps)
                                             E0h = 12dB
                                             FFh = 12dB
Register 0610h DAC1 Left Volume
 REGISTER       BIT        LABEL   DEFAULT                            DESCRIPTION                           REFER TO
 ADDRESS
    R1553        9     DAC1R_MUTE      1     DAC1R Soft Mute Control
   (0611h)                                   0 = DAC Un-mute
 DAC1 Right                                  1 = DAC Mute
   Volume
                 8        DAC1_VU      0     DAC1L and DAC1R Volume Update
                                             Writing a 1 to this bit will cause the DAC1L and DAC1R
                                             volume to be updated simultaneously
                7:0     DAC1R_VOL  1100_0000 DAC1R Digital Volume
                             [7:0]           00h = MUTE
                                             01h = -71.625dB
                                             … (0.375dB steps)
                                             C0h = 0dB
                                             … (0.375dB steps)
                                             E0h = 12dB
                                             FFh = 12dB
Register 0611h DAC1 Right Volume
 REGISTER       BIT        LABEL   DEFAULT                            DESCRIPTION                           REFER TO
 ADDRESS
    R1554        9     DAC2L_MUTE      1     DAC2L Soft Mute Control
   (0612h)                                   0 = DAC Un-mute
 DAC2 Left                                   1 = DAC Mute
   Volume
                 8        DAC2_VU      0     DAC2L and DAC2R Volume Update
                                             Writing a 1 to this bit will cause the DAC2L and DAC2R
                                             volume to be updated simultaneously
                7:0      DAC2L_VOL 1100_0000 DAC2L Digital Volume
                             [7:0]           00h = MUTE
                                             01h = -71.625dB
                                             … (0.375dB steps)
                                             C0h = 0dB
                                             … (0.375dB steps)
                                             E0h = 12dB
                                             FFh = 12dB
Register 0612h DAC2 Left Volume
                                                                                               PP, March 2014, Rev 3.5
w
                                                                                                                  341


WM8958                                                                                                 Pre-Production
 REGISTER       BIT        LABEL  DEFAULT                            DESCRIPTION                           REFER TO
 ADDRESS
    R1555        9     DAC2R_MUTE     1     DAC2R Soft Mute Control
   (0613h)                                  0 = DAC Un-mute
 DAC2 Right                                 1 = DAC Mute
   Volume
                 8        DAC2_VU     0     DAC2L and DAC2R Volume Update
                                            Writing a 1 to this bit will cause the DAC2L and DAC2R
                                            volume to be updated simultaneously
                7:0     DAC2R_VOL 1100_0000 DAC2R Digital Volume
                            [7:0]           00h = MUTE
                                            01h = -71.625dB
                                            … (0.375dB steps)
                                            C0h = 0dB
                                            … (0.375dB steps)
                                            E0h = 12dB
                                            FFh = 12dB
Register 0613h DAC2 Right Volume
 REGISTER       BIT        LABEL  DEFAULT                            DESCRIPTION                           REFER TO
 ADDRESS
    R1556        1    DAC_SOFTMUT     0     DAC Unmute Ramp select
(0614h) DAC                EMODE            0 = Disabling soft-mute (DAC [1/2] [L/R]_MUTE=0) will
  Softmute                                  cause the DAC volume to change immediately to DAC [1/2]
                                            [L/R]_VOL settings
                                            1 = Disabling soft-mute (DAC [1/2] [L/R]_MUTE=0) will
                                            cause the DAC volume to ramp up gradually to the DAC
                                            [1/2] [L/R]_VOL settings
                 0    DAC_MUTERAT     0     DAC Soft Mute Ramp Rate
                              E             0 = Fast ramp (fs/2, maximum ramp time is 10.7ms at
                                            fs=48k)
                                            1 = Slow ramp (fs/32, maximum ramp time is 171ms at
                                            fs=48k)
                                            (Note: ramp rate scales with sample rate.)
Register 0614h DAC Softmute
 REGISTER       BIT        LABEL  DEFAULT                            DESCRIPTION                           REFER TO
 ADDRESS
    R1568        1     ADC_OSR128     1     ADC / Digital Microphone Oversample Rate Select
   (0620h)                                  0 = Low Power
Oversamplin                                 1 = High Performance
      g
                 0     DAC_OSR128     0     DAC Oversample Rate Select
                                            0 = Low Power
                                            1 = High Performance
Register 0620h Oversampling
                                                                                              PP, March 2014, Rev 3.5
w
                                                                                                                 342


Pre-Production                                                                                             WM8958
 REGISTER       BIT        LABEL   DEFAULT                         DESCRIPTION                              REFER TO
 ADDRESS
    R1569       9:7     ST_HPF_CUT   000   Sidetone HPF cut-off frequency (relative to 44.1kHz sample
   (0621h)                  [2:0]          rate)
  Sidetone                                 000 = 2.7kHz
                                           001 = 1.35kHz
                                           010 = 675Hz
                                           011 = 370Hz
                                           100 = 180Hz
                                           101 = 90Hz
                                           110 = 45Hz
                                           111 = Reserved
                                           Note - the cut-off frequencies scale with the Digital Mixing
                                           (SYSCLK) clocking rate. The quoted figures apply to
                                           44.1kHz sample rate.
                  6       ST_HPF      0    Digital Sidetone HPF Select
                                           0 = Disabled
                                           1 = Enabled
                  1       STR_SEL     0    Select source for sidetone STR path
                                           0 = ADCR / DMICDAT1 (Right)
                                           1 = DMICDAT2 (Right)
                  0       STL_SEL     0    Select source for sidetone STL path
                                           0 = ADCL / DMICDAT1 (Left)
                                           1 = DMICDAT2 (Left)
Register 0621h Sidetone
 REGISTER       BIT        LABEL   DEFAULT                         DESCRIPTION                              REFER TO
 ADDRESS
    R1792        15       GP1_DIR     1    GPIO1 Pin Direction
   (0700h)                                 0 = Output
   GPIO 1                                  1 = Input
                 14       GP1_PU      0    GPIO1 Pull-Up Enable
                                           0 = Disabled
                                           1 = Enabled
                 13       GP1_PD      0    GPIO1 Pull-Down Enable
                                           0 = Disabled
                                           1 = Enabled
                 10      GP1_POL      0    GPIO1 Polarity Select
                                           0 = Non-inverted (Active High)
                                           1 = Inverted (Active Low)
                  9     GP1_OP_CFG    0    GPIO1 Output Configuration
                                           0 = CMOS
                                           1 = Open Drain
                  8       GP1_DB      1    GPIO1 Input De-bounce
                                           0 = Disabled
                                           1 = Enabled
                  6       GP1_LVL     0    GPIO1 level. Write to this bit to set a GPIO output. Read
                                           from this bit to read GPIO input level.
                                           For output functions only, when GP1_POL is set, the
                                           register contains the opposite logic level to the external pin.
                                                                                              PP, March 2014, Rev 3.5
w
                                                                                                                 343


WM8958                                                                                     Pre-Production
 REGISTER       BIT          LABEL    DEFAULT                      DESCRIPTION                 REFER TO
  ADDRESS
                4:0      GP1_FN [4:0]  0_0000 GPIO1 Pin Function
                                              00h = ADCLRCLK1
                                              01h = GPIO
                                              02h = Reserved
                                              03h = IRQ
                                              04h = Temperature (Shutdown) status
                                              05h = MICDET status
                                              06h = Reserved
                                              07h = Reserved
                                              08h = Reserved
                                              09h = FLL1 Lock
                                              0Ah = FLL2 Lock
                                              0Bh = SRC1 Lock
                                              0Ch = SRC2 Lock
                                              0Dh = AIF1 DRC1 Signal Detect
                                              0Eh = AIF1 DRC2 Signal Detect
                                              0Fh = AIF2 DRC Signal Detect
                                              10h = Write Sequencer Status
                                              11h = FIFO Error
                                              12h = OPCLK Clock output
                                              13h = Temperature (Warning) status
                                              14h = DC Servo Done
                                              15h = FLL1 Clock output
                                              16h = FLL2 Clock output
                                              17h to 1Fh = Reserved
Register 0700h GPIO 1
 REGISTER       BIT           LABEL   DEFAULT                      DESCRIPTION                 REFER TO
  ADDRESS
    R1793       14         MCLK2_PU      0    MCLK2 Pull-up enable
 (0701h) Pull                                 0 = Disabled
    Control                                   1 = Enabled
   (MCLK2)
                13         MCLK2_PD      1    MCLK2 Pull-down enable
                                              0 = Disabled
                                              1 = Enabled
Register 0701h Pull Control (MCLK2)
 REGISTER       BIT           LABEL   DEFAULT                      DESCRIPTION                 REFER TO
  ADDRESS
    R1794       14         BCLK2_PU      0    BCLK2 Pull-up enable
 (0702h) Pull                                 0 = Disabled
    Control                                   1 = Enabled
   (BCLK2)
                13         BCLK2_PD      1    BCLK2 Pull-down enable
                                              0 = Disabled
                                              1 = Enabled
Register 0702h Pull Control (BCLK2)
                                                                                  PP, March 2014, Rev 3.5
w
                                                                                                     344


Pre-Production                                                                                                  WM8958
 REGISTER       BIT           LABEL     DEFAULT                        DESCRIPTION                               REFER TO
  ADDRESS
    R1795       14      DACLRCLK2_P        0    DACLRCLK2 Pull-up enable
 (0703h) Pull                   U               0 = Disabled
   Control                                      1 = Enabled
(DACLRCLK
      2)        13      DACLRCLK2_P        1    DACLRCLK2 Pull-down enable
                                D               0 = Disabled
                                                1 = Enabled
Register 0703h Pull Control (DACLRCLK2)
 REGISTER       BIT           LABEL     DEFAULT                        DESCRIPTION                               REFER TO
  ADDRESS
    R1796       14       DACDAT2_PU        0    DACDAT2 Pull-up enable
 (0704h) Pull                                   0 = Disabled
   Control                                      1 = Enabled
 (DACDAT2)
                13       DACDAT2_PD        1    DACDAT2 Pull-down enable
                                                0 = Disabled
                                                1 = Enabled
Register 0704h Pull Control (DACDAT2)
 REGISTER       BIT          LABEL      DEFAULT                        DESCRIPTION                               REFER TO
  ADDRESS
    R1797       15          GP6_DIR         1   GPIO6 Pin Direction
   (0705h)                                      0 = Output
   GPIO 6                                       1 = Input
                14           GP6_PU        0    GPIO6 Pull-Up Enable
                                                0 = Disabled
                                                1 = Enabled
                13           GP6_PD        1    GPIO6 Pull-Down Enable
                                                0 = Disabled
                                                1 = Enabled
                10          GP6_POL         0   GPIO6 Polarity Select
                                                0 = Non-inverted (Active High)
                                                1 = Inverted (Active Low)
                 9       GP6_OP_CFG        0    GPIO6 Output Configuration
                                                0 = CMOS
                                                1 = Open Drain
                 8           GP6_DB         1   GPIO6 Input De-bounce
                                                0 = Disabled
                                                1 = Enabled
                 6          GP6_LVL        0    GPIO6 level. Write to this bit to set a GPIO output. Read
                                                from this bit to read GPIO input level.
                                                For output functions only, when GP6_POL is set, the
                                                register contains the opposite logic level to the external pin.
                4:0      GP6_FN [4:0]    0_0001 GPIO6 Pin Function
                                                00h = ADCLRCLK2
                                                01h = GPIO
                                                02h = Reserved
                                                03h = IRQ
                                                04h = Temperature (Shutdown) status
                                                05h = MICDET status
                                                06h = Reserved
                                                07h = Reserved
                                                                                                   PP, March 2014, Rev 3.5
w
                                                                                                                      345


WM8958                                                                                                    Pre-Production
 REGISTER       BIT      LABEL     DEFAULT                        DESCRIPTION                                REFER TO
 ADDRESS
                                           08h = Reserved
                                           09h = FLL1 Lock
                                           0Ah = FLL2 Lock
                                           0Bh = SRC1 Lock
                                           0Ch = SRC2 Lock
                                           0Dh = AIF1 DRC1 Signal Detect
                                           0Eh = AIF1 DRC2 Signal Detect
                                           0Fh = AIF2 DRC Signal Detect
                                           10h = Write Sequencer Status
                                           11h = FIFO Error
                                           12h = OPCLK Clock output
                                           13h = Temperature (Warning) status
                                           14h = DC Servo Done
                                           15h = FLL1 Clock output
                                           16h = FLL2 Clock output
                                           17h to 1Fh = Reserved
Register 0705h GPIO 6
 REGISTER       BIT      LABEL     DEFAULT                        DESCRIPTION                                REFER TO
 ADDRESS
   R1799        15      GP8_DIR        1   GPIO8 Pin Direction
  (0707h)                                  0 = Output
  GPIO 8                                   1 = Input
                14      GP8_PU        0    GPIO8 Pull-Up Enable
                                           0 = Disabled
                                           1 = Enabled
                13      GP8_PD        1    GPIO8 Pull-Down Enable
                                           0 = Disabled
                                           1 = Enabled
                10     GP8_POL         0   GPIO8 Polarity Select
                                           0 = Non-inverted (Active High)
                                           1 = Inverted (Active Low)
                 9    GP8_OP_CFG      0    GPIO8 Output Configuration
                                           0 = CMOS
                                           1 = Open Drain
                 8      GP8_DB         1   GPIO8 Input De-bounce
                                           0 = Disabled
                                           1 = Enabled
                 6      GP8_LVL       0    GPIO8 level. Write to this bit to set a GPIO output. Read
                                           from this bit to read GPIO input level.
                                           For output functions only, when GP8_POL is set, the
                                           register contains the opposite logic level to the external pin.
                4:0   GP8_FN [4:0]  0_0001 GPIO8 Pin Function
                                           00h = DACDAT3
                                           01h = GPIO
                                           02h = Reserved
                                           03h = IRQ
                                           04h = Temperature (Shutdown) status
                                           05h = MICDET status
                                           06h = Reserved
                                           07h = Reserved
                                           08h = Reserved
                                           09h = FLL1 Lock
                                                                                              PP, March 2014, Rev 3.5
w
                                                                                                                    346


Pre-Production                                                                                             WM8958
 REGISTER       BIT      LABEL     DEFAULT                        DESCRIPTION                               REFER TO
 ADDRESS
                                           0Ah = FLL2 Lock
                                           0Bh = SRC1 Lock
                                           0Ch = SRC2 Lock
                                           0Dh = AIF1 DRC1 Signal Detect
                                           0Eh = AIF1 DRC2 Signal Detect
                                           0Fh = AIF2 DRC Signal Detect
                                           10h = Write Sequencer Status
                                           11h = FIFO Error
                                           12h = OPCLK Clock output
                                           13h = Temperature (Warning) status
                                           14h = DC Servo Done
                                           15h = FLL1 Clock output
                                           16h = FLL2 Clock output
                                           17h to 1Fh = Reserved
Register 0707h GPIO 8
 REGISTER       BIT      LABEL     DEFAULT                        DESCRIPTION                               REFER TO
 ADDRESS
    R1800       15      GP9_DIR        1   GPIO9 Pin Direction
   (0708h)                                 0 = Output
   GPIO 9                                  1 = Input
                14      GP9_PU        0    GPIO9 Pull-Up Enable
                                           0 = Disabled
                                           1 = Enabled
                13      GP9_PD        1    GPIO9 Pull-Down Enable
                                           0 = Disabled
                                           1 = Enabled
                10     GP9_POL         0   GPIO9 Polarity Select
                                           0 = Non-inverted (Active High)
                                           1 = Inverted (Active Low)
                 9    GP9_OP_CFG      0    GPIO9 Output Configuration
                                           0 = CMOS
                                           1 = Open Drain
                 8      GP9_DB         1   GPIO9 Input De-bounce
                                           0 = Disabled
                                           1 = Enabled
                 6      GP9_LVL       0    GPIO9 level. Write to this bit to set a GPIO output. Read
                                           from this bit to read GPIO input level.
                                           For output functions only, when GP9_POL is set, the
                                           register contains the opposite logic level to the external pin.
                4:0   GP9_FN [4:0]  0_0001 GPIO9 Pin Function
                                           00h = ADCDAT3
                                           01h = GPIO
                                           02h = Reserved
                                           03h = IRQ
                                           04h = Temperature (Shutdown) status
                                           05h = MICDET status
                                           06h = Reserved
                                           07h = Reserved
                                           08h = Reserved
                                           09h = FLL1 Lock
                                           0Ah = FLL2 Lock
                                                                                              PP, March 2014, Rev 3.5
w
                                                                                                                 347


WM8958                                                                                                     Pre-Production
 REGISTER       BIT      LABEL      DEFAULT                        DESCRIPTION                                REFER TO
 ADDRESS
                                            0Bh = SRC1 Lock
                                            0Ch = SRC2 Lock
                                            0Dh = AIF1 DRC1 Signal Detect
                                            0Eh = AIF1 DRC2 Signal Detect
                                            0Fh = AIF2 DRC Signal Detect
                                            10h = Write Sequencer Status
                                            11h = FIFO Error
                                            12h = OPCLK Clock output
                                            13h = Temperature (Warning) status
                                            14h = DC Servo Done
                                            15h = FLL1 Clock output
                                            16h = FLL2 Clock output
                                            17h to 1Fh = Reserved
Register 0708h GPIO 9
 REGISTER       BIT      LABEL      DEFAULT                        DESCRIPTION                                REFER TO
 ADDRESS
   R1801        15      GP10_DIR        1   GPIO10 Pin Direction
  (0709h)                                   0 = Output
  GPIO 10                                   1 = Input
                14      GP10_PU        0    GPIO10 Pull-Up Enable
                                            0 = Disabled
                                            1 = Enabled
                13      GP10_PD        1    GPIO10 Pull-Down Enable
                                            0 = Disabled
                                            1 = Enabled
                10     GP10_POL         0   GPIO10 Polarity Select
                                            0 = Non-inverted (Active High)
                                            1 = Inverted (Active Low)
                 9    GP10_OP_CFG       0   GPIO10 Output Configuration
                                            0 = CMOS
                                            1 = Open Drain
                 8      GP10_DB         1   GPIO10 Input De-bounce
                                            0 = Disabled
                                            1 = Enabled
                 6      GP10_LVL        0   GPIO10 level. Write to this bit to set a GPIO output. Read
                                            from this bit to read GPIO input level.
                                            For output functions only, when GP10_POL is set, the
                                            register contains the opposite logic level to the external pin.
                4:0   GP10_FN [4:0]  0_0001 GPIO10 Pin Function
                                            00h = LRCLK3
                                            01h = GPIO
                                            02h = Reserved
                                            03h = IRQ
                                            04h = Temperature (Shutdown) status
                                            05h = MICDET status
                                            06h = Reserved
                                            07h = Reserved
                                            08h = Reserved
                                            09h = FLL1 Lock
                                            0Ah = FLL2 Lock
                                            0Bh = SRC1 Lock
                                            0Ch = SRC2 Lock
                                                                                               PP, March 2014, Rev 3.5
w
                                                                                                                     348


Pre-Production                                                                                               WM8958
 REGISTER       BIT       LABEL      DEFAULT                        DESCRIPTION                               REFER TO
 ADDRESS
                                             0Dh = AIF1 DRC1 Signal Detect
                                             0Eh = AIF1 DRC2 Signal Detect
                                             0Fh = AIF2 DRC Signal Detect
                                             10h = Write Sequencer Status
                                             11h = FIFO Error
                                             12h = OPCLK Clock output
                                             13h = Temperature (Warning) status
                                             14h = DC Servo Done
                                             15h = FLL1 Clock output
                                             16h = FLL2 Clock output
                                             17h to 1Fh = Reserved
Register 0709h GPIO 10
 REGISTER       BIT       LABEL      DEFAULT                        DESCRIPTION                               REFER TO
 ADDRESS
    R1802       15       GP11_DIR        1   GPIO11 Pin Direction
   (070Ah)                                   0 = Output
  GPIO 11                                    1 = Input
                14       GP11_PU        0    GPIO11 Pull-Up Enable
                                             0 = Disabled
                                             1 = Enabled
                13       GP11_PD        1    GPIO11 Pull-Down Enable
                                             0 = Disabled
                                             1 = Enabled
                10      GP11_POL         0   GPIO11 Polarity Select
                                             0 = Non-inverted (Active High)
                                             1 = Inverted (Active Low)
                 9     GP11_OP_CFG       0   GPIO11 Output Configuration
                                             0 = CMOS
                                             1 = Open Drain
                 8       GP11_DB         1   GPIO11 Input De-bounce
                                             0 = Disabled
                                             1 = Enabled
                 6       GP11_LVL        0   GPIO11 level. Write to this bit to set a GPIO output. Read
                                             from this bit to read GPIO input level.
                                             For output functions only, when GP11_POL is set, the
                                             register contains the opposite logic level to the external pin.
                4:0    GP11_FN [4:0]  0_0001 GPIO11 Pin Function
                                             00h = BCLK3
                                             01h = GPIO
                                             02h = Reserved
                                             03h = IRQ
                                             04h = Temperature (Shutdown) status
                                             05h = MICDET status
                                             06h = Reserved
                                             07h = Reserved
                                             08h = Reserved
                                             09h = FLL1 Lock
                                             0Ah = FLL2 Lock
                                             0Bh = SRC1 Lock
                                             0Ch = SRC2 Lock
                                             0Dh = AIF1 DRC1 Signal Detect
                                                                                                PP, March 2014, Rev 3.5
w
                                                                                                                   349


WM8958                                                                                  Pre-Production
 REGISTER       BIT          LABEL  DEFAULT                      DESCRIPTION                REFER TO
  ADDRESS
                                            0Eh = AIF1 DRC2 Signal Detect
                                            0Fh = AIF2 DRC Signal Detect
                                            10h = Write Sequencer Status
                                            11h = FIFO Error
                                            12h = OPCLK Clock output
                                            13h = Temperature (Warning) status
                                            14h = DC Servo Done
                                            15h = FLL1 Clock output
                                            16h = FLL2 Clock output
                                            17h to 1Fh = Reserved
Register 070Ah GPIO 11
 REGISTER       BIT          LABEL  DEFAULT                      DESCRIPTION                REFER TO
  ADDRESS
    R1824       11      DMICDAT2_PU    0    DMICDAT2 Pull-Up enable
 (0720h) Pull                               0 = Disabled
  Control (1)                               1 = Enabled
                10      DMICDAT2_PD    0    DMICDAT2 Pull-Down enable
                                            0 = Disabled
                                            1 = Enabled
                 9      DMICDAT1_PU    0    DMICDAT1 Pull-Up enable
                                            0 = Disabled
                                            1 = Enabled
                 8      DMICDAT1_PD    0    DMICDAT1 Pull-Down enable
                                            0 = Disabled
                                            1 = Enabled
                 7         MCLK1_PU    0    MCLK1 Pull-up enable
                                            0 = Disabled
                                            1 = Enabled
                 6         MCLK1_PD    0    MCLK1 Pull-down enable
                                            0 = Disabled
                                            1 = Enabled
                 5       DACDAT1_PU    0    DACDAT1 Pull-up enable
                                            0 = Disabled
                                            1 = Enabled
                 4       DACDAT1_PD    0    DACDAT1 Pull-down enable
                                            0 = Disabled
                                            1 = Enabled
                 3      DACLRCLK1_P    0    LRCLK1 Pull-up enable
                                U           0 = Disabled
                                            1 = Enabled
                 2      DACLRCLK1_P    0    LRCLK1 Pull-down enable
                                D           0 = Disabled
                                            1 = Enabled
                 1         BCLK1_PU    0    BCLK1 Pull-up enable
                                            0 = Disabled
                                            1 = Enabled
                 0         BCLK1_PD    0    BCLK1 Pull-down enable
                                            0 = Disabled
                                            1 = Enabled
Register 0720h Pull Control (1)
                                                                               PP, March 2014, Rev 3.5
w
                                                                                                  350


Pre-Production                                                                                WM8958
 REGISTER       BIT          LABEL    DEFAULT                        DESCRIPTION                REFER TO
  ADDRESS
    R1825         8         ADDR_PD      1    ADDR Pull-down enable
 (0721h) Pull                                 0 = Disabled
  Control (2)                                 1 = Enabled
                  6       LDO2ENA_PD     1    LDO2ENA Pull-down enable
                                              0 = Disabled
                                              1 = Enabled
                  4       LDO1ENA_PD     1    LDO1ENA Pull-down enable
                                              0 = Disabled
                                              1 = Enabled
                  1      SPKMODE_PU      1    SPKMODE Pull-up enable
                                              0 = Disabled
                                              1 = Enabled
Register 0721h Pull Control (2)
 REGISTER       BIT          LABEL    DEFAULT                        DESCRIPTION                REFER TO
  ADDRESS
    R1840        10        GP11_EINT     0    GPIO11 Interrupt
   (0730h)                                    (Rising and falling edge triggered)
   Interrupt                                  Note: Cleared when a ‘1’ is written.
   Status 1
                  9        GP10_EINT     0    GPIO10 Interrupt
                                              (Rising and falling edge triggered)
                                              Note: Cleared when a ‘1’ is written.
                  8         GP9_EINT     0    GPIO9 Interrupt
                                              (Rising and falling edge triggered)
                                              Note: Cleared when a ‘1’ is written.
                  7         GP8_EINT     0    GPIO8 Interrupt
                                              (Rising and falling edge triggered)
                                              Note: Cleared when a ‘1’ is written.
                  5         GP6_EINT     0    GPIO6 Interrupt
                                              (Rising and falling edge triggered)
                                              Note: Cleared when a ‘1’ is written.
                  0         GP1_EINT     0    GPIO1 Interrupt
                                              (Rising and falling edge triggered)
                                              Note: Cleared when a ‘1’ is written.
Register 0730h Interrupt Status 1
 REGISTER       BIT          LABEL    DEFAULT                        DESCRIPTION                REFER TO
  ADDRESS
    R1841        15      TEMP_WARN_      0    Temperature Warning Interrupt
   (0731h)                     EINT           (Rising and falling edge triggered)
   Interrupt                                  Note: Cleared when a ‘1’ is written.
   Status 2
                 14      DCS_DONE_EI     0    DC Servo Interrupt
                                NT            (Rising edge triggered)
                                              Note: Cleared when a ‘1’ is written.
                 13      WSEQ_DONE_      0    Write Sequencer Interrupt
                               EINT           (Rising edge triggered)
                                              Note: Cleared when a ‘1’ is written.
                 12      FIFOS_ERR_EI    0    Digital Core FIFO Error Interrupt
                                NT            (Rising edge triggered)
                                              Note: Cleared when a ‘1’ is written.
                                                                                   PP, March 2014, Rev 3.5
w
                                                                                                      351


WM8958                                                                                                  Pre-Production
 REGISTER       BIT          LABEL    DEFAULT                        DESCRIPTION                            REFER TO
  ADDRESS
                 11      AIF2DRC_SIG_    0    AIF2 DRC Activity Detect Interrupt
                            DET_EINT          (Rising edge triggered)
                                              Note: Cleared when a ‘1’ is written.
                 10      AIF1DRC2_SIG    0    AIF1 DRC2 (Timeslot 1) Activity Detect Interrupt
                           _DET_EINT          (Rising edge triggered)
                                              Note: Cleared when a ‘1’ is written.
                  9      AIF1DRC1_SIG    0    AIF1 DRC1 (Timeslot 0) Activity Detect Interrupt
                           _DET_EINT          (Rising edge triggered)
                                              Note: Cleared when a ‘1’ is written.
                  8      SRC2_LOCK_EI    0    SRC2 Lock Interrupt
                                NT            (Rising and falling edge triggered)
                                              Note: Cleared when a ‘1’ is written.
                  7      SRC1_LOCK_EI    0    SRC1 Lock Interrupt
                                NT            (Rising and falling edge triggered)
                                              Note: Cleared when a ‘1’ is written.
                  6      FLL2_LOCK_EI    0    FLL2 Lock Interrupt
                                NT            (Rising and falling edge triggered)
                                              Note: Cleared when a ‘1’ is written.
                  5      FLL1_LOCK_EI    0    FLL1 Lock Interrupt
                                NT            (Rising and falling edge triggered)
                                              Note: Cleared when a ‘1’ is written.
                  1        MICD_EINT     0    Microphone Detection Interrupt
                                              (Rising and falling edge triggered)
                                              Note: Cleared when a ‘1’ is written.
                  0      TEMP_SHUT_E     0    Temperature Shutdown Interrupt
                               INT            (Rising and falling edge triggered)
                                              Note: Cleared when a ‘1’ is written.
Register 0731h Interrupt Status 2
 REGISTER       BIT          LABEL    DEFAULT                        DESCRIPTION                            REFER TO
  ADDRESS
    R1842        15      TEMP_WARN_      0    Temperature Warning status
   (0732h)                     STS            0 = Temperature is below warning level
Interrupt Raw                                 1 = Temperature is above warning level
   Status 2
                 14      DCS_DONE_ST     0    DC Servo status
                                S             0 = DC Servo not complete
                                              1 = DC Servo complete
                 13      WSEQ_DONE_      0    Write Sequencer status
                               STS            0 = Sequencer Busy (sequence in progress)
                                              1 = Sequencer Idle
                 12      FIFOS_ERR_ST    0    Digital Core FIFO Error status
                                S             0 = Normal operation
                                              1 = FIFO Error
                 11      AIF2DRC_SIG_    0    AIF2 DRC Signal Detect status
                            DET_STS           0 = Signal threshold not exceeded
                                              1 = Signal threshold exceeded
                 10      AIF1DRC2_SIG    0    AIF1 DRC2 (Timeslot 1) Signal Detect status
                           _DET_STS           0 = Signal threshold not exceeded
                                              1 = Signal threshold exceeded
                  9      AIF1DRC1_SIG    0    AIF1 DRC1 (Timeslot 0) Signal Detect status
                           _DET_STS           0 = Signal threshold not exceeded
                                              1 = Signal threshold exceeded
                                                                                               PP, March 2014, Rev 3.5
w
                                                                                                                  352


Pre-Production                                                                                    WM8958
 REGISTER       BIT           LABEL    DEFAULT                       DESCRIPTION                    REFER TO
 ADDRESS
                  8      SRC2_LOCK_S      0    SRC2 Lock status
                                TS             0 = Not locked
                                               1 = Locked
                  7      SRC1_LOCK_S      0    SRC1 Lock status
                                TS             0 = Not locked
                                               1 = Locked
                  6      FLL2_LOCK_ST     0    FLL2 Lock status
                                 S             0 = Not locked
                                               1 = Locked
                  5      FLL1_LOCK_ST     0    FLL1 Lock status
                                 S             0 = Not locked
                                               1 = Locked
                  0      TEMP_SHUT_S      0    Temperature Shutdown status
                                TS             0 = Temperature is below shutdown level
                                               1 = Temperature is above shutdown level
Register 0732h Interrupt Raw Status 2
 REGISTER       BIT           LABEL    DEFAULT                       DESCRIPTION                    REFER TO
 ADDRESS
    R1848        10       IM_GP11_EINT    1    GPIO11 Interrupt mask.
   (0738h)                                     0 = Do not mask interrupt.
  Interrupt                                    1 = Mask interrupt.
  Status 1
    Mask          9       IM_GP10_EINT    1    GPIO10 Interrupt mask.
                                               0 = Do not mask interrupt.
                                               1 = Mask interrupt.
                  8        IM_GP9_EINT    1    GPIO9 Interrupt mask.
                                               0 = Do not mask interrupt.
                                               1 = Mask interrupt.
                  7        IM_GP8_EINT    1    GPIO8 Interrupt mask.
                                               0 = Do not mask interrupt.
                                               1 = Mask interrupt.
                  5        IM_GP6_EINT    1    GPIO6 Interrupt mask.
                                               0 = Do not mask interrupt.
                                               1 = Mask interrupt.
                  0        IM_GP1_EINT    1    GPIO1 Interrupt mask.
                                               0 = Do not mask interrupt.
                                               1 = Mask interrupt.
Register 0738h Interrupt Status 1 Mask
 REGISTER        BIT          LABEL    DEFAULT                       DESCRIPTION                    REFER TO
 ADDRESS
    R1849        15      IM_TEMP_WAR      1    Temperature Warning Interrupt mask.
   (0739h)                    N_EINT           0 = Do not mask interrupt.
  Interrupt                                    1 = Mask interrupt.
  Status 2
    Mask         14       IM_DCS_DONE     1    DC Servo Interrupt mask.
                               _EINT           0 = Do not mask interrupt.
                                               1 = Mask interrupt.
                 13      IM_WSEQ_DON      1    Write Sequencer Interrupt mask.
                              E_EINT           0 = Do not mask interrupt.
                                               1 = Mask interrupt.
                 12      IM_FIFOS_ERR     1    Digital Core FIFO Error Interrupt mask.
                                                                                       PP, March 2014, Rev 3.5
w
                                                                                                          353


WM8958                                                                                                  Pre-Production
 REGISTER        BIT          LABEL    DEFAULT                       DESCRIPTION                            REFER TO
 ADDRESS
                              _EINT            0 = Do not mask interrupt.
                                               1 = Mask interrupt.
                 11      IM_AIF2DRC_SI    1    AIF2 DRC Activity Detect Interrupt mask.
                           G_DET_EINT          0 = Do not mask interrupt.
                                               1 = Mask interrupt.
                 10       IM_AIF1DRC2_    1    AIF1 DRC2 (Timeslot 1) Activity Detect Interrupt mask.
                          SIG_DET_EINT         0 = Do not mask interrupt.
                                               1 = Mask interrupt.
                  9       IM_AIF1DRC1_    1    AIF1 DRC1 (Timeslot 0) Activity Detect Interrupt mask.
                          SIG_DET_EINT         0 = Do not mask interrupt.
                                               1 = Mask interrupt.
                  8       IM_SRC2_LOC     1    SRC2 Lock Interrupt mask.
                             K_EINT            0 = Do not mask interrupt.
                                               1 = Mask interrupt.
                  7       IM_SRC1_LOC     1    SRC1 Lock Interrupt mask.
                             K_EINT            0 = Do not mask interrupt.
                                               1 = Mask interrupt.
                  6      IM_FLL2_LOCK     1    FLL2 Lock Interrupt mask.
                              _EINT            0 = Do not mask interrupt.
                                               1 = Mask interrupt.
                  5      IM_FLL1_LOCK     1    FLL1 Lock Interrupt mask.
                              _EINT            0 = Do not mask interrupt.
                                               1 = Mask interrupt.
                  1       IM_MICD_EINT    1    Microphone Detection Interrupt mask.
                                               0 = Do not mask interrupt.
                                               1 = Mask interrupt.
                  0       IM_TEMP_SHU     1    Temperature Shutdown Interrupt mask.
                             T_EINT            0 = Do not mask interrupt.
                                               1 = Mask interrupt.
Register 0739h Interrupt Status 2 Mask
 REGISTER       BIT          LABEL     DEFAULT                       DESCRIPTION                            REFER TO
 ADDRESS
   R1856          0          IM_IRQ       0    IRQ Output Interrupt mask.
  (0740h)                                      0 = Do not mask interrupt.
  Interrupt                                    1 = Mask interrupt.
   Control
Register 0740h Interrupt Control
 REGISTER       BIT          LABEL     DEFAULT                       DESCRIPTION                            REFER TO
 ADDRESS
   R1864          5       TEMP_WARN_      1    Temperature Warning de-bounce
(0748h) IRQ                     DB             0 = Disabled
 Debounce                                      1 = Enabled
                  0      TEMP_SHUT_D      1    Thermal shutdown de-bounce
                                 B             0 = Disabled
                                               1 = Enabled
Register 0748h IRQ Debounce
                                                                                               PP, March 2014, Rev 3.5
w
                                                                                                                  354


Pre-Production                                                                                             WM8958
 REGISTER       BIT       LABEL     DEFAULT                          DESCRIPTION                            REFER TO
 ADDRESS
    R2304        0      DSP2_ENA       0    DSP2 Audio Processor Enable.
   (0900h)                                  0 = Disabled
DSP2_Progra                                 1 = Enabled
      m
                                            This bit must be set before the MBC is enabled. It must
                                            remain set whenever the MBC is enabled.
Register 0900h DSP2_Program
 REGISTER       BIT       LABEL     DEFAULT                          DESCRIPTION                            REFER TO
 ADDRESS
    R2305       5:4   MBC_SEL [1:0]    00   MBC Signal Path select
   (0901h)                                  00 = AIF1DAC1 input path (AIF1, Timeslot 0)
DSP2_Config                                 01 = AIF1DAC2 input path (AIF1, Timeslot 1)
                                            10 = AIF2DAC input path
                                            11 = Reserved
                 0      MBC_ENA        0    MBC Enable
                                            0 = Disabled
                                            1 = Enabled
Register 0901h DSP2_Config
 REGISTER       BIT        LABEL    DEFAULT                          DESCRIPTION                            REFER TO
 ADDRESS
    R2573        2   DSP2_STOP          0   Stop the DSP2 audio processor
  (0A0Dh)                                   Writing a 1 to this bit will cause the DSP2 processor to stop
DSP2_ExecC                                  processing audio data
    ontrol
                 1   DSP2_RUNR          0   Start the DSP2 audio processor
                                            Writing a 1 to this bit will cause the DSP2 processor to start
                                            processing audio data
Register 0A0Dh DSP2_ExecControl
                                                                                              PP, March 2014, Rev 3.5
w
                                                                                                                 355


WM8958                                                                                                    Pre-Production
APPLICATIONS INFORMATION
RECOMMENDED EXTERNAL COMPONENTS
              AUDIO INPUT PATHS
              The WM8958 provides 8 analogue audio inputs. Each of these inputs is referenced to the internal DC
              reference, VMID. A DC blocking capacitor is required for each input pin used in the target application.
              The choice of capacitor is determined by the filter that is formed between that capacitor and the input
              impedance of the input pin. The circuit is illustrated in Figure 84.
                       C
               Input
                                       R                                   1
                                                                 Fc =
                                               -
                                                                         2 RC
                                               PGA
                                               +
                                                                 Fc = high pass 3dB cut-off frequency
                               VMID
              Figure 84 Audio Input Path DC Blocking Capacitor
              If the input impedance is known, and the cut-off frequency is known, then the minimum capacitor
              value may be derived easily. However, it can be seen from the representation in Figure 84 that the
              input impedance is not fixed in all applications but can vary with gain and boost amplifier settings.
              The PGA input resistance for every gain setting is detailed in Table 152.
                 IN1L_VOL[4:0],            VOLUME                   INPUT RESISTANCE
                 IN2L_VOL[4:0],              (dB)                          (kΩ)
                 IN1R_VOL[4:0],                             SINGLE-ENDED         DIFFERENTIAL
                  IN2R_VOL[4:0]                                 MODE                 MODE
                       00000                 -16.5                 58                 52.5
                       00001                 -15.0                56.9                50.6
                       00010                 -13.5                55.6                48.6
                       00011                 -12.0                54.1                46.4
                       00100                 -10.5                52.5                44.1
                       00101                 -9.0                 50.7                    41.5
                       00110                 -7.5                 48.6                    38.9
                       00111                 -6.0                 46.5                    36.2
                       01000                 -4.5                 44.1                    33.4
                       01001                 -3.0                 41.6                    30.6
                       01010                 -1.5                 38.9                    27.8
                       01011                   0                  36.2                25.1
                       01100                 +1.5                 33.4                22.5
                       01101                 +3.0                 30.6                20.0
                       01110                 +4.5                 27.8                17.7
                       01111                 +6.0                 25.1                15.6
                       10000                 +7.5                 22.5                13.6
                       10001                 +9.0                 20.1                11.9
                       10010                +10.5                 17.8                10.3
                       10011                +12.0                 15.6                    8.9
                       10100                +13.5                 13.7                    7.6
                                                                                                 PP, March 2014, Rev 3.5
w
                                                                                                                    356


Pre-Production                                                                                             WM8958
                    IN1L_VOL[4:0],           VOLUME                    INPUT RESISTANCE
                    IN2L_VOL[4:0],              (dB)                           (kΩ)
                    IN1R_VOL[4:0],                             SINGLE-ENDED        DIFFERENTIAL
                     IN2R_VOL[4:0]                                   MODE                 MODE
                          10101                +15.0                 11.9                  6.5
                          10110                +16.5                 10.3                  5.6
                          10111                +18.0                  8.9                  4.8
                          11000                +19.5                  7.7                  4.1
                          11001                +21.0                  6.6                  3.5
                          11010                +22.5                  5.6                  2.9
                          11011                +24.0                  4.8                  2.5
                          11100                +25.5                  4.1                  2.1
                          11101                +27.0                  3.5                  1.8
                          11110                +28.5                  2.9                  1.5
                          11111                +30.0                  2.5                  1.3
               Table 152 PGA Input Pin Resistance
               The appropriate input capacitor may be selected using the PGA input resistance data provided in
               Table 152, depending on the required PGA gain setting(s).
               The choice of capacitor for a 20Hz cut-off frequency is shown in Table 153 for a selection of typical
               input impedance conditions.
                  INPUT IMPEDANCE             MINIMUM CAPACITANCE
                                               FOR 20HZ PASS BAND
                            2k                           4 F
                           15k                          0.5 F
                           30k                         0.27 F
                           60k                         0.13 F
               Table 153 Audio Input DC Blocking Capacitors
               Using the figures in Table 153, it follows that a 1F capacitance for all input connections will give good
               results in most cases. Tantalum electrolytic capacitors are particularly suitable as they offer high
               stability in a small package size.
               Ceramic equivalents are a cost effective alternative to the superior tantalum packages, but care must
               be taken to ensure the desired capacitance is maintained at the AVDD1 operating voltage. Also,
               ceramic capacitors may show microphonic effects, where vibrations and mechanical conditions give
               rise to electrical signals. This is particularly problematic for microphone input paths where a large
               signal gain is required.
               A single capacitor is required for a line input or single-ended microphone connection. In the case of a
               differential microphone connection, a DC blocking capacitor is required on both input pins.
                                                                                                PP, March 2014, Rev 3.5
w
                                                                                                                      357


WM8958                                                                                           Pre-Production
       HEADPHONE OUTPUT PATH
       The headphone output on WM8958 is ground referenced and therefore does not require the large,
       expensive capacitors necessary for VMID reference solutions. For best audio performance, it is
       recommended to connect a zobel network to the audio output pins. This network should comprise of a
       100nF capacitor and 20ohm resistor in series with each other (see “Analogue Outputs” section).
       These components have the effect of dampening high frequency oscillations or instabilities that can
       arise outside the audio band under certain conditions. Possible sources of these instabilities include
       the inductive load of a headphone coil or an active load in the form of an external line amplifier.
       EARPIECE DRIVER OUTPUT PATH
       The earpiece driver on HPOUT2P and HPOUT2N is designed as a 32ohm BTL speaker driver. The
       outputs are referenced to the internal DC reference VMID, but direct connection to the speaker is
       possible because of the BTL configuration. There is no requirement for DC blocking capacitors.
       LINE OUTPUT PATHS
       The WM8958 provides four line outputs (LINEOUT1P, LINEOUT1N, LINEOUT2P and LINEOUT2N).
       Each of these outputs is referenced to the internal DC reference, VMID. In any case where a line
       output is used in a single-ended configuration (i.e. referenced to AGND), a DC blocking capacitor will
       be required in order to remove the DC bias. In the case where a pair of line outputs is configured as a
       BTL differential pair, then the DC blocking capacitor should be omitted.
       The choice of capacitor is determined from the filter that is formed between the capacitor and the load
       impedance – see Figure 85.
       Figure 85 Line Output Path Components
           LOAD IMPEDANCE              MINIMUM CAPACITANCE
                                        FOR 20HZ PASS BAND
                  10k                           0.8 F
                  47k                          0.17 F
       Table 154 Line Output Frequency Cut-Off
       Using the figures in Table 154, it follows that that a 1F capacitance would be a suitable choice for a
       line load. Tantalum electrolytic capacitors are again particularly suitable but ceramic equivalents are a
       cost effective alternative. Care must be taken to ensure the desired capacitance is maintained at the
       appropriate operating voltage.
                                                                                       PP, March 2014, Rev 3.5
w
                                                                                                            358


Pre-Production                                                                                           WM8958
               POWER SUPPLY DECOUPLING
               Electrical coupling exists particularly in digital logic systems where switching in one sub-system
               causes fluctuations on the power supply. This effect occurs because the inductance of the power
               supply acts in opposition to the changes in current flow that are caused by the logic switching. The
               resultant variations (or ‘spikes’) in the power supply voltage can cause malfunctions and unintentional
               behavior in other components. A decoupling (or ‘bypass’) capacitor can be used as an energy storage
               component which will provide power to the decoupled circuit for the duration of these power supply
               variations, protecting it from malfunctions that could otherwise arise.
               Coupling also occurs in a lower frequency form when ripple is present on the power supply rail caused
               by changes in the load current or by limitations of the power supply regulation method. In audio
               components such as the WM8958, these variations can alter the performance of the signal path,
               leading to degradation in signal quality. A decoupling (or ‘bypass’) capacitor can be used to filter these
               effects, by presenting the ripple voltage with a low impedance path that does not affect the circuit to
               be decoupled.
               These coupling effects are addressed by placing a capacitor between the supply rail and the
               corresponding ground reference. In the case of systems comprising multiple power supply rails,
               decoupling should be provided on each rail.
               The recommended power supply decoupling capacitors for WM8958 are listed below in Table 155.
                                POWER SUPPLY                           DECOUPLING CAPACITOR
                 LDO1VDD, DBVDD1, DBVDD2, DBVDD3,                   0.1F ceramic (see Note)
                 AVDD2
                 SPKVDD1, SPKVDD2                                   4.7F ceramic
                 AVDD1                                              4.7F ceramic
                 DCVDD                                              2.2F ceramic
                 CPVDD                                              4.7F ceramic
                 VMIDC                                              4.7F ceramic
                 VREFC                                              1.0F ceramic
               Table 155 Power Supply Decoupling Capacitors
               Note: 0.1F is required with 4.7F a guide to the total required power rail capacitance, including that
               at the regulator output.
               All decoupling capacitors should be placed as close as possible to the WM8958 device. The
               connection between AGND, the AVDD1 decoupling capacitor and the main system ground should be
               made at a single point as close as possible to the AGND ball of the WM8958.
               The VMID capacitor is not, technically, a decoupling capacitor. However, it does serve a similar
               purpose in filtering noise on the VMID reference. The connection between AGND, the VMID
               decoupling capacitor and the main system ground should be made at a single point as close as
               possible to the AGND ball of the WM8958.
               Due to the wide tolerance of many types of ceramic capacitors, care must be taken to ensure that the
               selected components provide the required capacitance across the required temperature and voltage
               ranges in the intended application. For most applications, the use of ceramic capacitors with capacitor
               dielectric X5R is recommended.
                                                                                              PP, March 2014, Rev 3.5
w
                                                                                                                      359


WM8958                                                                                          Pre-Production
         CHARGE PUMP COMPONENTS
         A fly-back capacitor is required between the CPCA and CPCB pins. The required capacitance is
         2.2µF at 2V.
         A decoupling capacitor is required on CPVOUTP and CPVOUTN; the recommended value is 2.2µF at
         2V.
         The positioning of the Charge Pump capacitors is important, particularly the fly-back capacitor. These
         capacitors should be placed as close as possible to the WM8958.
         Due to the wide tolerance of many types of ceramic capacitors, care must be taken to ensure that the
         selected components provide the required capacitance across the required temperature and voltage
         ranges in the intended application. For most applications, the use of ceramic capacitors with capacitor
         dielectric X5R is recommended.
         MICROPHONE BIAS CIRCUIT
         The WM8958 is designed to interface easily with up to four analogue microphones. These may be
         connected in single-ended or differential configurations, as illustrated in Figure 86. The single-ended
         method allows greater capability for the connection of multiple audio sources simultaneously, whilst
         the differential method provides better performance due to its rejection of common-mode noise.
         In either configuration, the analogue microphone requires a bias current (electret condenser
         microphones) or voltage supply (silicon microphones), which can be provided by MICBIAS1 or
         MICBIAS2.
         A current-limiting resistor is required when using an electret condenser microphone (ECM). The
         resistance should be chosen according to the minimum operating impedance of the microphone and
         MICBIAS voltage so that the maximum bias current of the WM8958 is not exceeded. Wolfson
         recommends a 2.2k current limiting resistor as it provides compatibility with a wide range of
         microphone models.
                        AGND
            MIC         IN1LN,
                        IN2LN,
                   C    IN1RN,
                        IN2RN
                       IN1LP,                    -     To
                       IN2LP,                    PGA   input
                       IN1RP,                    +     mixers
                       IN2RP
            2k2
                           VMID
                                    Line Input
                       MICBIAS1/2
         Figure 86 Single-Ended and Differential Analogue Microphone Connections
         The WM8958 also supports up to four digital microphone inputs. The MICBIAS1 generator is suitable
         for use as a low noise supply for digital microphones, as shown in Figure 87.
                                                                                      PP, March 2014, Rev 3.5
w
                                                                                                           360


Pre-Production                                                                                          WM8958
               Figure 87 Digital Microphone Connection
               The MICBIAS generators can each operate as a voltage regulator or in bypass mode. See “Analogue
               Input Signal Path” for details of the MICBIAS generators.
               In Regulator mode, the MICBIAS regulators are designed to operate without external decoupling
               capacitors. It is important that parasitic capacitances on the MICBIAS1 or MICBIAS2 pins do not
               exceed the specified limit in Regulator mode (see “Electrical Characteristics”).
               If the capacitive load on MICBIAS1 or MICBIAS2 exceeds the specified limit (eg. due to a decoupling
               capacitor or long PCB trace), then the respective generator must be configured in Bypass mode.
               The maximum output current is noted in the “Electrical Characteristics”. This limit must be observed
               on each MICBIAS output, especially if more than one microphone is connected to a single MICBIAS
               pin. Note that the maximum output current differs between Regulator mode and Bypass mode. The
               MICBIAS output voltage can be adjusted using register control in Regulator mode.
                                                                                             PP, March 2014, Rev 3.5
w
                                                                                                                361


WM8958                                                                                                                                                                            Pre-Production
                                                            EXTERNAL ACCESSORY DETECTION COMPONENTS
                                                            The accessory detection circuit measures the impedance of an external load connected to the
                                                            MICDET pin.
                                                            This function uses the MICBIAS2 output as a reference, as shown in Figure 88. Note that the
                                                            WM8958 will automatically enable MICBIAS2 when required in order to perform the detection function.
                                                            The WM8958 can detect the presence of a typical microphone and up to 7 push-buttons, using the
                                                            components shown. When the microphone detection circuit is enabled, then each of the push-buttons
                                                            shown will cause a different bit within the MICD_LVL register to be set.
                                                            The microphone detect function is specifically designed to detect a video accessory (typical 75) load
                                                            if required. A measured external impedance of 75 will cause the MICD_LVL [4] bit to be set.
 MICD_LVL[6] - 326   MICD_LVL[5] - 152   MICD_LVL[4] - 77           MICD_LVL[3] – 47.6   MICD_LVL[2] – 29.4   MICD_LVL[1] - 14   MICD_LVL[0] - <3   MICD_LVL[7] - >475
Figure 88 External Accessory Detect Connection
                                                                                                                                                                         PP, March 2014, Rev 3.5
w
                                                                                                                                                                                            362


Pre-Production                                                                                          WM8958
               CLASS D SPEAKER CONNECTIONS
               The WM8958 incorporates two Class D/AB speaker drivers. By default, the speaker drivers operate in
               Class D mode, which offers high amplifier efficiency at large signal levels. As the Class D output is a
               pulse width modulated signal, the choice of speakers and tracking of signals is critical for ensuring
               good performance and reducing EMI in this mode.
               The efficiency of the speaker drivers is affected by the series resistance between the WM8958 and
               the speaker (e.g. PCB track loss and inductor ESR) as shown in Figure 89. This resistance should be
               as low as possible to maximise efficiency.
               Figure 89 Speaker Connection Losses
               The Class D output requires external filtering in order to recreate the audio signal. This may be
                                          nd               st
               implemented using a 2 order LC or 1 order RC filter, or else may be achieved by using a
               loudspeaker whose internal inductance provides the required filter response. An LC or RC filter should
               be used if the loudspeaker characteristics are unknown or unsuitable, or if the length of the
               loudspeaker connection is likely to lead to EMI problems.
                                                                                                nd
               In applications where it is necessary to provide Class D filter components, a 2 order LC filter is the
               recommended solution as it provides more attenuation at higher frequencies and minimises power
               dissipated in the filter when compared to a first order RC filter (lower ESR). This maximises both
               rejection of unwanted switching frequencies and overall speaker efficiency. A suitable implementation
               is illustrated in Figure 90.
               Figure 90 Class D Output Filter Components
                                                                                             PP, March 2014, Rev 3.5
w
                                                                                                                 363


WM8958                                                                                             Pre-Production
       A simple equivalent circuit of a loudspeaker consists of a serially connected resistor and inductor, as
       shown in Figure 91. This circuit provides a low pass filter for the speaker output. If the loudspeaker
       characteristics are suitable, then the loudspeaker itself can be used in place of the filter components
       described earlier. This is known as ‘filterless’ operation.
       Figure 91 Speaker Equivalent Circuit for Filterless Operation
       For filterless Class D operation, it is important to ensure that a speaker with suitable inductance is
       chosen. For example, if we know the speaker impedance is 8Ω and the desired cut-off frequency is
       20kHz, then the optimum speaker inductance may be calculated as:
       8 loudspeakers typically have an inductance in the range 20H to 100H, however, it should be
       noted that a loudspeaker inductance will not be constant across the relevant frequencies for Class D
       operation (up to and beyond the Class D switching frequency). Care should be taken to ensure that
       the cut-off frequency of the loudspeaker’s filtering is low enough to suppress the high frequency
       energy of the Class D switching and, in so doing, to prevent speaker damage. The Class D outputs of
       the WM8958 operate at much higher frequencies than is recommended for most speakers and it must
       be ensured that the cut-off frequency is low enough to protect the speaker.
       RECOMMENDED EXTERNAL COMPONENTS DIAGRAM
       Figure 92 provides a summary of recommended external components for WM8958. Note that this
       diagram does not include any components that are specific to the end application e.g. it does not
       include filtering on the speaker outputs (assume filterless Class D operation), RF decoupling, or RF
       filtering for pins which connect to the external world i.e. headphone or speaker outputs.
                                                                                        PP, March 2014, Rev 3.5
w
                                                                                                              364


Pre-Production                                               WM8958
Figure 92 Recommended External Components Diagram
                                                  PP, March 2014, Rev 3.5
w
                                                                     365


WM8958                                                                                                      Pre-Production
DIGITAL AUDIO INTERFACE CLOCKING CONFIGURATIONS
                 The WM8958 provides 3 digital audio interfaces and supports many different clocking configurations.
                 The asynchronous sample rate converter enables more than one digital audio interface to be
                 supported simultaneously, even when there is no synchronisation between these interfaces. In a
                 typical application, this enables audio mixing between a multimedia applications processor and a
                 baseband voice call processor, for example.
                 The AIF1 and AIF2 audio interfaces can be configured in Master or Slave modes, and can also
                 support defined combinations of mixed sample rates. In all applications, it is important that the system
                 clocking configuration is correctly designed. Incorrect clock configurations will lead to audible clicks
                 arising from dropped or repeated audio samples; this is caused by the inherent tolerances of multiple
                 asynchronous system clocks.
                 To ensure reliable clocking of the audio interface functions, it is a requirement that, for each audio
                 interface, the external interface clocks (eg. BCLK, LRCLK) are derived from the same clock source as
                 the respective AIF clock (AIFnCLK).
                 In AIF Master mode, the external BCLK and LRCLK signals are generated by the WM8958 and
                 synchronisation of these signals with AIFnCLK is guaranteed. In this case, clocking of the AIF is
                 derived from the MCLK1 or MCLK2 inputs, either directly or via one of the Frequency Locked Loop
                 (FLL) circuits.
                 In AIF Slave mode, the external BCLK and LRCLK signals are generated by another device, as inputs
                 to the WM8958. In this case, it must be ensured that the respective AIF clock is generated from a
                 source that is synchronised to the external BCLK and LRCLK inputs. In a typical Slave mode
                 application, the BCLK input is selected as the clock reference, using the FLL to perform frequency
                 shifting. It is also possible to use the MCLK1 or MCLK2 inputs, but only if the selected clock is
                 synchronised externally to the BCLK and LRCLK inputs.
                 The valid AIF clocking configurations are listed in Table 156 for AIF Master and AIF Slave modes.
                   AUDIO INTERFACE MODE                                 CLOCKING CONFIGURATION
                   AIF Master Mode                  AIFnCLK_SRC selects FLL1 or FLL2 as AIFnCLK source;
                                                    FLLn_REFCLK_SRC selects MCLK1 or MCLK2 as FLLn source.
                                                    AIFnCLK_SRC selects MCLK1 or MCLK2 as AIFnCLK source.
                   AIF Slave Mode                   AIFnCLK_SRC selects FLL1 or FLL2 as AIFnCLK source;
                                                    FLLn_REFCLK_SRC selects BCLKn as FLLn source.
                                                    AIFnCLK_SRC selects MCLK1 or MCLK2 as AIFnCLK source,
                                                    provided MCLK is externally synchronised to the BCLKn input.
                                                    AIFnCLK_SRC selects FLL1 or FLL2 as AIFnCLK source;
                                                    FLLn_REFCLK_SRC selects MCLK1 or MCLK2 as FLLn source,
                                                    provided MCLK is externally synchronised to the BCLKn input.
                 Table 156 Audio Interface Clocking Confgurations
                 In each case, the AIFnCLK frequency must be a valid ratio to the LRCLKn frequency; the supported
                 clocking ratios are defined by the AIFnCLK_RATE register.
                 The valid AIF clocking configurations are illustrated in Figure 93 to Figure 97 below. Note that, where
                 MCLK1 is illustrated as the clock source, it is equally possible to select MCLK2 as the clock source.
                 Similarly, in cases where FLL1 is illustrated, it is equally possible to select the FLL2.
                                                                                                   PP, March 2014, Rev 3.5
w
                                                                                                                      366


Pre-Production                                                                                             WM8958
Figure 93 AIF Master Mode, using MCLK as reference
    WM8958                                                                                  Processor
                             FLL1
                                                                                BCLKn
              FLL1_REFCLK_SRC                      AIFnCLK
                                                                                LRCLKn
                                                                  AIFn
                                                              (Master Mode)     DACDATn
                                                                                ADCDATn
                                        AIFnCLK_SRC
     Oscillator
Figure 94 AIF Master Mode, using MCLK and FLL as reference
    WM8958                                                                              Processor
                     FLL1
                                                                            BCLKn
   FLL1_REFCLK_SRC                         AIFnCLK
                                                                            LRCLKn
                                                         AIFn
                                                     (Slave Mode)           DACDATn
                                                                            ADCDATn
                                AIFnCLK_SRC
Figure 95 AIF Slave Mode, using BCLK and FLL as reference
                                                                                                PP, March 2014, Rev 3.5
w
                                                                                                                   367


WM8958                                                             Pre-Production
Figure 96 AIF Slave Mode, using MCLK as reference
Figure 97 AIF Slave Mode, using MCLK and FLL as reference
                                                          PP, March 2014, Rev 3.5
w
                                                                             368


Pre-Production                                                                                            WM8958
PCB LAYOUT CONSIDERATIONS
               Poor PCB layout will degrade the performance and be a contributory factor in EMI, ground bounce
               and resistive voltage losses. All external components should be placed as close to the WM8958
               device as possible, with current loop areas kept as small as possible. Specific factors relating to Class
               D loudspeaker connection are detailed below.
               CLASS D LOUDSPEAKER CONNECTION
               Long, exposed PCB tracks or connection wires will emit EMI. The distance between the WM8958 and
               the loudspeaker should therefore be kept as short as possible. Where speakers are connected to the
               PCB via a cable form, it is recommended that a shielded twisted pair cable is used. The shield should
               be connected to the main system, with care taken to ensure ground loops are avoided.
               Further reduction in EMI can be achieved using PCB ground (or VDD) planes and also by using
               passive LC components to filter the Class D switching waveform. When passive filtering is used, low
               ESR components should be chosen in order to minimise the series resistance between the WM8958
               and the speaker, maximising the power efficiency.
               LC passive filtering will usually be effective at reducing EMI at frequencies up to around 30MHz. To
               reduce emissions at higher frequencies, ferrite beads can also be used. These should be positioned
               as close to the device as possible.
               These techniques for EMI reduction are illustrated in Figure 98.
                           SPKP
                                               EMI
                           SPKN                                               Long, exposed tracks emit EMI
                           SPKP
                           SPKN             Short connection wires will reduce EMI emission
                           SPKP
                           SPKN                                             Shielding using PCB ground (or VDD)
                                                                            planes will reduce EMI emission
                           SPKP  LOW ESR
                           SPKN  LOW ESR                                 LC filtering will reduce EMI emission
                                                                         up to around 30MHz
                           SPKP
                                                                         Ferrite beads will reduce EMI emission
                           SPKN
                                                                         at frequencies above 30MHz.
               Figure 98 EMI Reduction Techniques
                                                                                               PP, March 2014, Rev 3.5
w
                                                                                                                    369


 WM8958                                                                                                                                     Pre-Production
 PACKAGE DIMENSIONS
    B: 72 BALL W-CSP PACKAGE 4.516 X 4.258 X 0.698 mm BODY, 0.50 mm BALL PITCH                                                       DM119.A
                                                                                     DETAIL 1
           2
                                                                                                                            D                 A
           A
                         9      8     7       6     5      4      3     2       1                                          6
   g    A2
                    A
                                                                                       4                      A1
                    B
                                                                                                              CORNER
                    C
                    D                                                                                                                         E
                                                                                       e E1
                                                                                         5
                    E
                    F
                    G
                    H
                                                                                    2X      aaa B
                                                  ddd    Z AB                                                                                 B
                                         e             M
                                                                                     2X        aaa A                 TOP VIEW
      DETAIL 2                                       D1
                                        BOTTOM VIEW                                                               f1
                                                                                                                       SOLDER BALL
                                  bbb Z                                                                                 f2
                                                                                                                       h
                             1
                                  Z
                                           A1
                                 ccc  Z
                                                              DETAIL 2
    Symbols                             Dimensions (mm)
                       MIN              NOM               MAX              NOTE
          A           0.658             0.698            0.738
         A1           0.206             0.242            0.278
         A2           0.418             0.434            0.450
          D           4.491             4.516            4.541
         D1                          4.00 BSC
          E           4.233             4.258            4.283
          E1                         3.50 BSC
           e                         0.50 BSC                                 5
          f1          0.246                                                   8
          f2          0.367                                                   9
          g                             0.022
          h           0.264             0.314            0.364
         aaa                            0.025
         bbb                            0.060
         ccc                            0.030
         ddd                            0.015
NOTES:
1. PRIMARY DATUM -Z- AND SEATING PLANE ARE DEFINED BY THE SPHERICAL CROWNS OF THE SOLDER BALLS.
2. THIS DIMENSION INCLUDES STAND-OFF HEIGHT ‘A1’ AND BACKSIDE COATING.
3. A1 CORNER IS IDENTIFIED BY INK/LASER MARK ON TOP PACKAGE.
4. BILATERAL TOLERANCE ZONE IS APPLIED TO EACH SIDE OF THE PACKAGE BODY.
5. ‘e’ REPRESENTS THE BASIC SOLDER BALL GRID PITCH.
6. THIS DRAWING IS SUBJECT TO CHANGE WITHOUT NOTICE.
7. FOLLOWS JEDEC DESIGN GUIDE MO-211-C.
8. f1 = NOMINAL DISTANCE OF BALL CENTRE TO DIE EDGE X AXIS (AS PER POD) – APPLICABLE TO ALL CORNERS OF DIE.
9. f2 = NOMINAL DISTANCE OF DIE CENTRE TO DIE EDGE IN Y AXIS (AS PER POD) – APPLICABLE TO ALL CORNERS OF DIE.
                                                                                                                                   PP, March 2014, Rev 3.5
w
                                                                                                                                                      370


Pre-Production                                                                                                            WM8958
IMPORTANT NOTICE
Wolfson Microelectronics plc (“Wolfson”) products and services are sold subject to Wolfson’s terms and conditions of sale, delivery
and payment supplied at the time of order acknowledgement.
Wolfson warrants performance of its products to the specifications in effect at the date of shipment. Wolfson reserves the right to
make changes to its products and specifications or to discontinue any product or service without notice. Customers should therefore
obtain the latest version of relevant information from Wolfson to verify that the information is current.
Testing and other quality control techniques are utilised to the extent Wolfson deems necessary to support its warranty. Specific
testing of all parameters of each device is not necessarily performed unless required by law or regulation.
In order to minimise risks associated with customer applications, the customer must use adequate design and operating safeguards
to minimise inherent or procedural hazards. Wolfson is not liable for applications assistance or customer product design. The
customer is solely responsible for its selection and use of Wolfson products. Wolfson is not liable for such selection or use nor for
use of any circuitry other than circuitry entirely embodied in a Wolfson product.
Wolfson’s products are not intended for use in life support systems, appliances, nuclear systems or systems where malfunction can
reasonably be expected to result in personal injury, death or severe property or environmental damage. Any use of products by the
customer for such purposes is at the customer’s own risk.
Wolfson does not grant any licence (express or implied) under any patent right, copyright, mask work right or other intellectual
property right of Wolfson covering or relating to any combination, machine, or process in which its products or services might be or
are used. Any provision or publication of any third party’s products or services does not constitute Wolfson’s approval, licence,
warranty or endorsement thereof. Any third party trade marks contained in this document belong to the respective third party owner.
Reproduction of information from Wolfson datasheets is permissible only if reproduction is without alteration and is accompanied by
all associated copyright, proprietary and other notices (including this notice) and conditions.           Wolfson is not liable for any
unauthorised alteration of such information or for any reliance placed thereon.
Any representations made, warranties given, and/or liabilities accepted by any person which differ from those contained in this
datasheet or in Wolfson’s standard terms and conditions of sale, delivery and payment are made, given and/or accepted at that
person’s own risk. Wolfson is not liable for any such representations, warranties or liabilities or for any reliance placed thereon by
any person.
ADDRESS:
Wolfson Microelectronics plc
26 Westfield Road
Edinburgh
EH11 2QB
United Kingdom
Tel :: +44 (0)131 272 7000
Fax :: +44 (0)131 272 7001
Email :: sales@wolfsonmicro.com
                                                                                                              PP, March 2014, Rev 3.5
w
                                                                                                                                    371


WM8958                                                                                                       Pre-Production
REVISION HISTORY
   DATE   REV                              DESCRIPTION OF CHANGES                                        CHANGED     PAGE
                                                                                                            BY
 16/11/10 2.2 DRC Signal Detect registers DRC_SIG_DET_RMS, DRC_SIG_DET_PK and                            PH
              DRC_SIG_DET_MODE updated.
              Additional details provided on pull-up / pull-down functions.
              Added notes that DRC and MBC must not be enabled simultaneously on the same
              playback path.
              Added notes that the Output Path HPF should be enabled when DRC is used on a
              record (ADC) path.
              Power domains and Ground references listed for each input/output.
              MICD_BIAS_STARTTIME and MICD_RATE descriptions updated, and associated
              text / recommended settings.
              Noted that DRC Anti-Clip and Quick Release features should not be used at the
              same time.
              VMID soft-start descriptions updated, including requirement to reset soft-start circuit
              before re-enabling VMID.
 4/1/11   2.2 Speaker driver performance graphs added.                                                   PH
              SPKAB_REF_SEL added to ‘Registers By Address’ section.
              Added note that LDOs are not suitable for external loads.
              Noted RF suppression on analogue inputs.
 24/1/11  2.2 Noise Gate function defined for AIF1 and AIF2 input paths.                                 PH
              DAC Volume registers updated to support values up to +12dB.
              EQ Band 1 now configurable as Shelf or Peak filter.
              DSP2CLK_SRC register deleted.
              MBC Control sequences updated.
              EFS modes described for FLL1 and FLL2.
              Decoupling capacitor removed from DMIC connection drawing.
              Additional register writes added to the MBC enable sequence.
              Pin description list re-sorted by Name, in order to draw attention to any multiple pins
              with a common name.
              Updates noting that Ultrasonic (4FS) mode uses ADCLRCLK (not LRCLK).
              GPIO1/GPIO6 must be configured for AIF1/AIF2 respectively.
              Input Path drawing updated, showing VMID as PGA reference.
              Accessory detection / impedance sensing added to Introduction section and on front
              page.
 28/1/11  2.2 Updated electrical characteristics to reflect 4 ohm mono mode THD performance.             KOL
 24/03/11 3.0 Restriction on MICBIAS capacitance clarified - 50pF limit is only applicable in Normal     KOL
              (regulator) mode.
              Applications Information (MICBIAS) enhanced to incorporate Digital Microphone
              connections.
              Interrupts section updated to improve clarity.
              Corrections to the FLL Example settings
              LDO2 output voltage updated (1.1V to 1.3V)
              Updated speaker inductive load conditions in electrical characteristics to 22uH.
              Updated LDO2 output voltage in electrical characteristics.
              Added max/min limits to electrical characteristics.
                                                                                                    PP, March 2014, Rev 3.5
w
                                                                                                                       372


Pre-Production                                                                                                 WM8958
     DATE      REV                              DESCRIPTION OF CHANGES                                   CHANGED     PAGE
                                                                                                            BY
   14/02/11    3.0 Updated speaker inductive load in electrical characteristics to 22uH.
                   Updated LDO2 output voltage in electrical characteristics.
   04/04/11    3.1 Notes added requiring VMID_BUF_ENA is enabled for direct signal paths from input      PH
                   pins to Input Mixers, Output Mixers or Speaker Mixers. Descriptions of affected
                   register bits updated.
                   Reel order quantity updated
   18/05/11    3.3 MICBIAS modes clarified as “Regulator” mode and “Bypass” mode.                        PH
                   Ultrasonic (4FS) mode deleted on AIF2.
                   External Accessory Detect description & characteristics updated; Recommended
                   External Components added in Applications Information section.
                   Block diagram updated (input digital mixing paths and MICBIAS references)
                   Updated ADC Path characteristics - input is -1dBV, not -1dBFS.
                   Clarification of DAC_OSR128 modes in DAC playback path Electrical Characteristics.
                   Input PGA Mute behaviour description updated.
                   Noted that HPF is required when using DRC Signal Activity Detect.
                   Updates to FLL Input Frequency range.
                   Minimum headphone load resistance updated.
                   Clarifications and formatting updates to Electrical Characteristics and Recommended
                   Operating Conditions.
                   Noted phase inversion in ‘Direct Voice’ paths.
                   Clarification to the usage of the INPUTS_CLAMP register.
                   PSRR specifications added for LDO1 and LDO2.
                   Drop-out voltage specification added for LDO1.
                   RMS Limiter function added within the MBC description.
                   TSHUT_ENA default corrected in Power Management section (default is 1).
   24/11/11    3.3 Absolute Maximum Ratings updated: (AVDD1 domain) added to Voltage range               PH
                   analogue inputs.
                   Maximum MICBIASn load capacitance noted in Electrical Characteristics.
                   Specifications added for LINEOUTFB and HPOUT1FB ground noise rejection.
   03/01/12    3.3 System clocking updated - DBCLK is derived independently of TOCLK_ENA.                PH
                   Additional details in Absolute Maximum Ratings.
                   Clarification of Line Output discharge functions and associated Electrical
                   Characteristics.
   25/05/12    3.4 Package diagram changed to DM119.A                                                    JMacD
   1/11/12     3.5 MSL standard updated                                                                  PH          12
   31/01/14    3.5 Updated control sequence for MBC Enable                                               PH          72
                                                                                                    PP, March 2014, Rev 3.5
w
                                                                                                                       373


Mouser Electronics
Authorized Distributor
Click to View Pricing, Inventory, Delivery & Lifecycle Information:
Cirrus Logic:
 WM8958ECS/R
