                                                                                                                     WM8778
w
                                         24-bit, 192kHz Stereo CODEC
DESCRIPTION                                                             FEATURES
The WM8778 is a high performance, stereo audio                          •    Audio Performance
CODEC. It is ideal for surround sound processing                             −    108dB SNR (‘A’ weighted @ 48kHz) DAC
applications for home hi-fi, DVD-RW and other audio                          −    102dB SNR (‘A’ weighted @ 48kHz) ADC
visual equipment.
                                                                        •    DAC Sampling Frequency: 32kHz – 192kHz
The stereo 24-bit multi-bit sigma delta ADC has                         •    ADC Sampling Frequency: 32kHz – 96kHz
programmable gain with automatic level control. Digital                 •    Stereo ADC input analogue gain adjust from +24dB to –21dB
audio output word lengths from 16-32 bits and sampling                       in 0.5dB steps
rates from 32kHz to 96kHz are supported.
                                                                        •    ADC digital gain from -21.5dB to -103dB in 0.5dB steps
A stereo multi-bit sigma delta DAC is used with digital                 •    Programmable Automatic Level Control (ALC) or Limiter on
audio input word lengths from 16-32 bits and sampling                        ADC input.
rates from 32kHz to 192kHz. A multiplexor after the DAC                 •    Stereo DAC with analogue line outputs.
allows the selection of either an external analogue input
                                                                        •    3-Wire SPI Compatible or 2-wire Serial Control Interface
or DAC playback into the line outputs.
                                                                        •    Hardware Control Mode
The WM8778 supports fully independent sample rates                      •    Master or Slave Clocking Mode
for the ADC and DAC. The audio data interface supports
                                                                        •    Programmable Audio Data Interface Modes
I2S, left justified, right justified and DSP formats.
                                                                             −    I2S, Left, Right Justified or DSP
The device is controlled in software via a 2 or 3 wire                       −    16/20/24/32 bit Word Lengths
serial interface which provides access to all features
                                                                        •    Analogue Bypass Path Feature
including volume controls, mutes, and de-emphasis
facilities. It can also be controlled in hardware which                 •    2.7V to 5.5V Analogue, 2.7V to 3.6V Digital supply Operation
gives access to the most commonly used features.
Control interface selection is done via the MODE pin (tri-
level). The device is available in a 28-lead SSOP                       APPLICATIONS
package.
                                                                        •    Surround Sound AV Processors and Hi-Fi systems
BLOCK DIAGRAM                                                           •    DVD-RW
WOLFSON MICROELECTRONICS plc                                                                              Production Data, July 2008, Rev 4.2
To receive regular email updates, sign up at http://www.wolfsonmicro.com/enews/              Copyright © 2008 Wolfson Microelectronics plc


WM8778                                                                                                                   Production Data
                                       TABLE OF CONTENTS
DESCRIPTION .......................................................................................................1
FEATURES.............................................................................................................1
APPLICATIONS .....................................................................................................1
BLOCK DIAGRAM .................................................................................................1
TABLE OF CONTENTS .........................................................................................2
PIN CONFIGURATION...........................................................................................3
ORDERING INFORMATION ..................................................................................3
ABSOLUTE MAXIMUM RATINGS.........................................................................5
ELECTRICAL CHARACTERISTICS ......................................................................6
  TERMINOLOGY ............................................................................................................ 7
MASTER CLOCK TIMING......................................................................................8
  DIGITAL AUDIO INTERFACE – MASTER MODE ......................................................... 8
  DIGITAL AUDIO INTERFACE – SLAVE MODE ............................................................ 9
  3-WIRE MPU INTERFACE TIMING ............................................................................ 11
  CONTROL INTERFACE TIMING – 2-WIRE MODE .................................................... 12
INTERNAL POWER ON RESET CIRCUIT ..........................................................13
DEVICE DESCRIPTION.......................................................................................15
  INTRODUCTION ......................................................................................................... 15
  AUDIO DATA SAMPLING RATES............................................................................... 15
  ZERO DETECT ........................................................................................................... 17
  POWERDOWN MODES ............................................................................................. 17
  DIGITAL AUDIO INTERFACE ..................................................................................... 17
  CONTROL INTERFACE OPERATION ........................................................................ 22
  CONTROL INTERFACE REGISTERS ........................................................................ 24
  LIMITER / AUTOMATIC LEVEL CONTROL (ALC) ...................................................... 32
  REGISTER MAP ......................................................................................................... 38
DIGITAL FILTER CHARACTERISTICS ...............................................................45
  DAC FILTER RESPONSES......................................................................................... 45
  ADC FILTER RESPONSES......................................................................................... 46
  ADC HIGH PASS FILTER ........................................................................................... 46
  DIGITAL DE-EMPHASIS CHARACTERISTICS........................................................... 47
APPLICATIONS INFORMATION .........................................................................48
  RECOMMENDED EXTERNAL COMPONENTS .......................................................... 48
PACKAGE DIMENSIONS ....................................................................................50
IMPORTANT NOTICE ..........................................................................................51
  ADDRESS: .................................................................................................................. 51
                                                                                                                PD, Rev 4.2, July 2008
w
                                                                                                                                      2


Production Data                                                                          WM8778
PIN CONFIGURATION
ORDERING INFORMATION
                                                                MOISTURE       PEAK SOLDERING
       DEVICE         TEMP. RANGE          PACKAGE           SENSITIVITY LEVEL       TEMP
                                        28-lead SSOP               MSL3
   WM8778SEDS/V        -25 to +85oC                                                 260°C
                                            (Pb-free)
                                        28-lead SSOP               MSL3
  WM8778SEDS/RV        -25 to +85oC                                                 260°C
                                    (Pb-free, tape and reel)
Note:
Reel quantity = 2,000
                                                                                PD, Rev 4.2, July 2008
w
                                                                                                     3


WM8778                                                                                                                 Production Data
PIN DESCRIPTION
     PIN               NAME                TYPE                                          DESCRIPTION
      1                AINL         Analogue Input        Left channel input
      2              ZFLAGR          Digital Output       Right channel zero flag output (external pull-up required)
      3              ZFLAGL          Digital Output       Left channel zero flag output (external pull-up required)
      4             DACBCLK       Digital Input/Output DAC audio interface bit clock
      5            DACMCLK            Digital Input       Master DAC clock; 256, 384, 512 or 768fs (fs = word clock frequency)
      6                 DIN           Digital Input       DAC data input
      7              DACLRC       Digital Input/Output DAC left/right word clock
      8             ADCBCLK       Digital Input/Output ADC audio interface bit clock
      9            ADCMCLK            Digital Input       Master ADC clock; 256, 384, 512 or 768fs (fs = word clock frequency)
     10               DOUT           Digital Output       ADC data output
     11              ADCLRC       Digital Input/Output ADC left/right word clock
     12               DGND                Supply          Digital negative supply
     13               DVDD                Supply          Digital positive supply
     14               MODE            Digital Input       Control interface mode select, tri-level
     15               CE\I2S          Digital Input       Serial interface Latch signal
     16            DI\DEEMPH      Digital Input/Output Serial interface data
     17               CL\IWL          Digital Input       Serial interface clock
     18               VOUTL        Analogue Output        DAC channel left output
     19              VOUTR         Analogue Output        DAC channel right output
     20             VMIDDAC        Analogue Output        DAC midrail decoupling pin ; 10uF external decoupling
     21            DACREFN          Analogue Input        DAC negative reference input
     22             DACREFP         Analogue Input        DAC positive reference input
     23             VMIDADC        Analogue Output        ADC midrail divider decoupling pin; 10uF external decoupling
     24           ADCREFGND        Analogue Output        ADC reference buffer decoupling pin; 10uF external decoupling
     25             ADCREFP        Analogue Output        ADC positive reference decoupling pin; 10uF external decoupling
     26               AVDD                Supply          Analogue positive supply
     27               AGND                Supply          Analogue negative supply and substrate connection
     28                AINR         Analogue Input        Right channel input
Note : Digital input pins have Schmitt trigger input buffers.
                                                                                                                 PD, Rev 4.2, July 2008
w
                                                                                                                                      4


Production Data                                                                                                     WM8778
ABSOLUTE MAXIMUM RATINGS
Absolute Maximum Ratings are stress ratings only. Permanent damage to the device may be caused by continuously operating at
or beyond these limits. Device functional operating limits and guaranteed performance specifications are given under Electrical
Characteristics at the test conditions specified.
                    ESD Sensitive Device. This device is manufactured on a CMOS process. It is therefore generically susceptible
                    to damage from excessive static voltages. Proper ESD precautions must be taken during handling and storage
                    of this device.
Wolfson tests its package types according to IPC/JEDEC J-STD-020B for Moisture Sensitivity to determine acceptable storage
conditions prior to surface mount assembly. These levels are:
MSL1 = unlimited floor life at <30°C / 85% Relative Humidity. Not normally stored in moisture barrier bag.
MSL2 = out of bag storage for 1 year at <30°C / 60% Relative Humidity. Supplied in moisture barrier bag.
MSL3 = out of bag storage for 168 hours at <30°C / 60% Relative Humidity. Supplied in moisture barrier bag.
The Moisture Sensitivity Level for each package type is specified in Ordering Information.
 CONDITION                                                                               MIN                     MAX
 Digital supply voltage                                                                 -0.3V                   +3.63V
 Analogue supply voltage                                                                -0.3V                    +7V
 Voltage range digital inputs (MCLK, DIN, ADCLRC, DACLRC,                           DGND -0.3V               DVDD + 0.3V
 ADCBCLK, DACBCLK, DI, CL, CE and MODE)
 Voltage range analogue inputs                                                      AGND -0.3V               AVDD +0.3V
 Master Clock Frequency                                                                                         37MHz
 Operating temperature range, TA                                                       -25°C                    +85°C
 Storage temperature                                                                   -65°C                    +150°C
Notes:
1.   Analogue and digital grounds must always be within 0.3V of each other.
                                                                                                           PD, Rev 4.2, July 2008
w
                                                                                                                                5


WM8778                                                                                                 Production Data
RECOMMENDED OPERATING CONDITIONS
 PARAMETER                          SYMBOL            TEST CONDITIONS         MIN        TYP      MAX         UNIT
 Digital supply range                DVDD                                     2.7                  3.6         V
 Analogue supply range           AVDD, DACREFP                                2.7                  5.5         V
 Ground                           AGND, DGND,                                              0                   V
                                   DACREFN,
                                  ADCREFGND
 Difference DGND to AGND                                                      -0.3         0      +0.3         V
Note: Digital supply DVDD must never be more than 0.3V greater than AVDD.
ELECTRICAL CHARACTERISTICS
 Test Conditions
 AVDD = 5V, DVDD = 3.3V, AGND = 0V, DGND = 0V, TA = +25oC, fs = 48kHz, MCLK = 256fs unless otherwise stated.
 PARAMETER                          SYMBOL        TEST CONDITIONS          MIN         TYP       MAX          UNIT
 Digital Logic Levels (TTL Levels)
 Input LOW level                        VIL                                                      0.8           V
 Input HIGH level                       VIH                                2.0                                 V
 Output LOW                             VOL              IOL=1mA                             0.1 x DVDD        V
 Output HIGH                           VOH               IOH=1mA       0.9 x DVDD                              V
 Analogue Reference Levels
 Reference voltage                     VVMID                                        AVDD/2                     V
 Potential divider resistance          RVMID                                           50k                     Ω
 DAC Performance (Load = 10k Ω, 50pF)
 0dBFs Full scale output voltage                                                     1.0 x                    Vrms
                                                                                   AVDD/5
 SNR (Note 1,2)                                       A-weighted,         102        108                       dB
                                                     @ fs = 48kHz
 SNR (Note 1,2)                                       A-weighted                     108                       dB
                                                     @ fs = 96kHz
 Dynamic Range (Note 2)                DNR        A-weighted, -60dB       102        108                       dB
                                                    full scale input
 Total Harmonic Distortion (THD)                     1kHz, 0dBFs                      -97       -90            dB
 DAC channel separation                                                              100                       dB
 Power Supply Rejection Ratio         PSRR           1kHz 100mVpp                       50                     dB
                                                     20Hz to 20kHz                      45                     dB
                                                        100mVpp
 ADC Performance
 Input Signal Level (0dB)                                                            1.0 x                    Vrms
                                                                                   AVDD/5
 SNR (Note 1,2)                                 A-weighted, 0dB gain       97        102                       dB
                                                     @ fs = 48kHz
 SNR (Note 1,2)                                 A-weighted, 0dB gain                   99                      dB
                                                     @ fs = 96kHz
                                                       64 x OSR
 Dynamic Range (note 2)                           A-weighted, -60dB                    102                     dB
                                                    full scale input
 Total Harmonic Distortion (THD)                     1kHz, 0dBFs                       -92                     dB
                                                     1kHz, -1dBFs                      -95       -85           dB
 ADC Channel Separation                                1kHz Input                       90                     dB
                                                                                                PD, Rev 4.2, July 2008
w
                                                                                                                     6


Production Data                                                                                                                 WM8778
   Test Conditions
   AVDD = 5V, DVDD = 3.3V, AGND = 0V, DGND = 0V, TA = +25oC, fs = 48kHz, MCLK = 256fs unless otherwise stated.
   Programmable Gain Step Size                                                          0.25            0.5           0.75          dB
   Programmable Gain Range                                      1kHz Input               -21                          +24           dB
   (Analogue)
   Programmable Gain Range                                      1kHz Input              -103                         -21.5          dB
   (Digital)
   Analogue Mute Attenuation                              1kHz Input, 0dB gain                          76                          dB
   (Note 6)
   Power Supply Rejection Ratio              PSRR            1kHz 100mVpp                               50                          dB
                                                              20Hz to 20kHz                             45                          dB
                                                                100mVpp
   Analogue input (AIN) to Analogue output (VOUT) (Load=10k Ω, 50pF, gain = 0dB) Bypass Mode
   0dB Full scale output voltage                                                                      1.0 x                       Vrms
                                                                                                    AVDD/5
   SNR (Note 1)                                                                          99            103                         dB
   THD                                                         1kHz, 0dB                               -93                         dB
                                                               1kHz, -3dB                              -95                         dB
   Power Supply Rejection Ratio              PSRR            1kHz 100mVpp                               50                         dB
                                                             20Hz to 20kHz                              45                         dB
                                                                100mVpp
   Mute Attenuation                                            1kHz, 0dB                               100                         dB
   Supply Current
   Analogue supply current                                     AVDD = 5V                                 48                        mA
   Digital supply current                                     DVDD = 3.3V                                8                         mA
Notes:
1.    Ratio of output level with 1kHz full scale input, to the output level with all zeros into the digital input, measured ‘A’
      weighted.
2.    All performance measurements done with 20kHz low pass filter, and where noted an A-weight filter. Failure to use
      such a filter will result in higher THD+N and lower SNR and Dynamic Range readings than are found in the Electrical
      Characteristics. The low pass filter removes out of band noise; although it is not audible it may affect dynamic
      specification values.
3.    VMID decoupled with 10uF and 0.1uF capacitors (smaller values may result in reduced performance).
4.    Harmonic distortion on the headphone output decreases with output power.
5.    All performance measurement done using certain timings conditions (Please refer to section ‘Digital Audio Interface’).
6.    A full digital MUTE can be achieved if the ADC gain (LAG/RAG) is set to minimum.
TERMINOLOGY
1.    Signal-to-noise ratio (dB) - SNR is a measure of the difference in level between the full scale output and the output
      with no signal applied. (No Auto-zero or Automute function is employed in achieving these results).
2.    Dynamic range (dB) - DNR is a measure of the difference between the highest and lowest portions of a signal.
      Normally a THD+N measurement at 60dB below full scale. The measured signal is then corrected by adding the 60dB
      to it. (e.g. THD+N @ -60dB= -32dB, DR= 92dB).
3.    THD+N (dB) - THD+N is a ratio, of the rms values, of (Noise + Distortion)/Signal.
4.    Stop band attenuation (dB) - Is the degree to which the frequency spectrum is attenuated (outside audio band).
5.    Channel Separation (dB) - Also known as Cross-Talk. This is a measure of the amount one channel is isolated from
      the other. Normally measured by sending a full scale signal down one channel and measuring the other.
6.    Pass-Band Ripple - Any variation of the frequency response in the pass-band region.
                                                                                                                     PD, Rev 4.2, July 2008
w
                                                                                                                                          7


WM8778                                                                                                                     Production Data
MASTER CLOCK TIMING
                                                     tMCLKL
       MCLK
                                                                 tMCLKH
                                                          tMCLKY
Figure 1 Master Clock Timing Requirements
   Test Conditions
                                                                        o
   AVDD = 5V, DVDD = 3.3V, AGND = 0V, DGND = 0V, TA = +25 C, fs = 48kHz, ADC/DACMCLK = 256fs unless otherwise
   stated.
   PARAMETER                              SYMBOL               TEST CONDITIONS                 MIN          TYP        MAX        UNIT
   System Clock Timing Information
   ADC/DACMCLK System clock                 tMCLKH                                              11                                 ns
   pulse width high
   ADC/DACMCLK System clock                  tMCLKL                                             11                                 ns
   pulse width low
   ADC/DACMCLK System clock                 tMCLKY                                              28                     1000        ns
   cycle time
   ADC/DACMCLK Duty cycle                                                                     40:60                   60:40
   Power-saving mode activated                                 After MCLK stopped                2                      10         µs
   Normal mode resumed                                        After MCLK re-started            0.5                       1       MCLK
                                                                                                                                  cycle
Table 1 Master Clock Timing Requirements
Note:
If MCLK period is longer than maximum specified above, power-saving mode is entered and DACs are powered down with
internal digital audio filters being reset. In this power-saving mode, all registers will retain their values and can be accessed
in the normal manner through the control interface. Once MCLK is restored, the DACs are automatically powered up, but a
write to the volume update register bit is required to restore the correct volume settings.
DIGITAL AUDIO INTERFACE – MASTER MODE
               DACBCLK
               ADCBCLK
                 ADCLRC                                         DVD
     WM8778
      CODEC DACLRC                                           Controller
                    DOUT
                       DIN
Figure 2 Audio Interface - Master Mode
                                                                                                                    PD, Rev 4.2, July 2008
w
                                                                                                                                         8


Production Data                                                                                       WM8778
         ADCBCLK/
         DACBCLK
           (Output)
                                                               tDL
          ADCLRC/
           DACLRC
          (Outputs)
                                                                tDDA
             DOUT
               DIN
                                        tDST        tDHT
Figure 3 Digital Audio Data Timing – Master Mode
  Test Conditions
  AVDD = 5V, DVDD = 3.3V, AGND = 0V, DGND = 0V, TA = +25oC, Master Mode, fs = 48kHz, ADC/DACMCLK = 256fs unless
  otherwise stated.
  PARAMETER                     SYMBOL              TEST CONDITIONS          MIN       TYP     MAX         UNIT
  Audio Data Input Timing Information
  ADC/DACLRC propagation           tDL                                         0                10          ns
  delay from ADC/DACBCLK
  falling edge
  DOUT propagation delay          tDDA                                         0                10          ns
  from ADCBCLK falling edge
  DIN setup time to               tDST                                        10                            ns
  DACBCLK rising edge
  DIN hold time from              tDHT                                        10                            ns
  DACBCLK rising edge
Table 2 Digital Audio Data Timing – Master Mode
DIGITAL AUDIO INTERFACE – SLAVE MODE
            DACBCLK
            ADCBCLK
    WM8776 ADCLRC                          DVD
    CODEC                                Controller
             DACLRC
               DOUT
                 DIN
Figure 4 Audio Interface – Slave Mode
                                                                                             PD, Rev 4.2, July 2008
w
                                                                                                                  9


WM8778                                                                                                   Production Data
                                 tBCH          tBCL
    ADCBCLK/
     DACBCLK
                                        tBCY
       DACLRC/
       ADCLRC
                                                tDS        tLRH     tLRSU
            DIN
                                           tDD                tDH
          DOUT
Figure 5 Digital Audio Data Timing – Slave Mode
  Test Conditions
  AVDD = 5V, DVDD = 3.3V, AGND = 0V, DGND = 0V, TA = +25oC, Slave Mode, fs = 48kHz, ADC/DACMCLK = 256fs unless
  otherwise stated.
  PARAMETER                     SYMBOL              TEST CONDITIONS           MIN        TYP         MAX         UNIT
  Audio Data Input Timing Information
  ADC/DACBCLK cycle time           tBCY                                       50                                  ns
  ADC/DACBCLK pulse width          tBCH                                       20                                  ns
  high
  ADC/DACBCLK pulse width          tBCL                                       20                                  ns
  low
  DACLRC/ADCLRC set-up            tLRSU                                       10                                  ns
  time to ADC/DACBCLK
  rising edge
  DACLRC/ADCLRC hold               tLRH                                       10                                  ns
  time from ADC/DACBCLK
  rising edge
  DIN set-up time to                tDS                                       10                                  ns
  DACBCLK rising edge
  DIN hold time from                tDH                                       10                                  ns
  DACBCLK rising edge
  DOUT propagation delay            tDD                                        0                      10          ns
  from ADCBCLK falling edge
Table 3 Digital Audio Data Timing – Slave Mode
Note:
ADCLRC and DACLRC should be synchronous with MCLK, although the WM8778 interface is tolerant of phase variations
or jitter on these signals.
                                                                                                  PD, Rev 4.2, July 2008
w
                                                                                                                      10


Production Data                                                                                            WM8778
3-WIRE MPU INTERFACE TIMING
                                                                                  tCSL       tCSH
            CE
                                                          tSCY                         tCSS
                                                     tSCH      tSCL              tSCS
            CL
            DI                                                               LSB
                                               tDSU    tDHO
Figure 6 SPI Compatible (3-wire) Control Interface Input Timing (MODE=1)
  Test Conditions
  AVDD = 5V, DVDD = 3.3V, AGND, DGND = 0V, TA = +25oC, fs = 48kHz, MCLK = 256fs unless otherwise stated
                   PARAMETER                         SYMBOL              MIN         TYP           MAX          UNIT
  CL rising edge to CE rising edge                      tSCS             60                                      ns
  CL pulse cycle time                                   tSCY             80                                      ns
  CL pulse width low                                    tSCL             30                                      ns
  CL pulse width high                                   tSCH             30                                      ns
  DI to CL set-up time                                  tDSU             20                                      ns
  CL to DI hold time                                    tDHO             20                                      ns
  CE pulse width low                                    tCSL             20                                      ns
  CE pulse width high                                   tCSH             20                                      ns
  CE rising to CL rising                                tCSS             20                                      ns
Table 4 3-wire SPI Compatible Control Interface Input Timing Information
                                                                                                  PD, Rev 4.2, July 2008
w
                                                                                                                      11


WM8778                                                                                                 Production Data
CONTROL INTERFACE TIMING – 2-WIRE MODE
                    t3
                                                        t5                 t3
  DI
                                t6             t2                       t4                                 t8
  CL
                          t1               t9       t7
Figure 7 Control Interface Timing – 2-Wire Serial Control Mode (MODE=0)
 Test Conditions
 AVDD = 5V, DVDD = 3.3V, AGND, DGND = 0V, TA = +25oC, fs = 48kHz, MCLK = 256fs unless otherwise stated
 PARAMETER                                                 SYMBOL           MIN        TYP         MAX        UNIT
 Program Register Input Information
 CL Frequency                                                                 0                    526        kHz
 CL Low Pulse-Width                                           t1             1.3                               us
 CL High Pulse-Width                                          t2            600                                ns
 Hold Time (Start Condition)                                  t3            600                                ns
 Setup Time (Start Condition)                                 t4            600                                ns
 Data Setup Time                                              t5            100                                ns
 DI, CL Rise Time                                             t6                                   300         ns
 DI, CL Fall Time                                             t7                                   300         ns
 Setup Time (Stop Condition)                                  t8            600                                ns
 Data Hold Time                                               t9                                   900         ns
 Pulse width of spikes that will be suppressed               tps              0                     5          ns
Table 5 2-wire Control Interface Timing Information
                                                                                               PD, Rev 4.2, July 2008
w
                                                                                                                   12


Production Data                                                                                                      WM8778
INTERNAL POWER ON RESET CIRCUIT
                          Figure 8 Internal Power on Reset Circuit Schematic
                          The WM8778 includes an internal Power on Reset Circuit which is used reset the digital logic into a
                          default state after power up.
                          Figure 8 shows a schematic of the internal POR circuit. The POR circuit is powered from AVDD. The
                          circuit monitors DVDD and VMID and asserts PORB low if DVDD or VMID are below the minimum
                          threshold Vpor_off.
                          On power up, the POR circuit requires AVDD to be present to operate. PORB is asserted low until
                          AVDD and DVDD and VMID are established. When AVDD, DVDD, and VMID have been established,
                          PORB is released high, all registers are in their default state and writes to the digital interface may
                          take place.
                          On power down, PORB is asserted low whenever DVDD or VMID drop below the minimum threshold
                          Vpor_off.
                          If AVDD is removed at any time, the internal Power on Reset circuit is powered down and PORB will
                          follow AVDD.
                          In most applications the time required for the device to release PORB high will be determined by the
                          charge time of the VMID node.
Figure 9 Typical Power up Sequence where DVDD is Powered before AVDD
                                                                                                          PD, Rev 4.2, July 2008
w
                                                                                                                               13


WM8778                                                                                                         Production Data
Figure 10 Typical Power up Sequence where AVDD is Powered before DVDD
                          Typical POR Operation (typical values, not tested)
                            SYMBOL             MIN                 TYP               MAX            UNIT
                              Vpora             0.5                0.7                1.0             V
                              Vporr             0.5                0.7                1.1             V
                             Vpora_off          1.0                1.4                2.0             V
                             Vpord_off          0.6                0.8                1.0             V
                          In a real application the designer is unlikely to have control of the relative power up sequence of
                          AVDD and DVDD. Using the POR circuit to monitor VMID ensures a reasonable delay between
                          applying power to the device and Device Ready.
                          Figure 9 and Figure 10 show typical power up scenarios in a real system. Both AVDD and DVDD
                          must be established and VMID must have reached the threshold Vporr before the device is ready
                          and can be written to. Any writes to the device before Device Ready will be ignored.
                          Figure 9 shows DVDD powering up before AVDD. Figure 10 shows AVDD powering up before
                          DVDD. In both cases, the time from applying power to Device Ready is dominated by the charge
                          time of VMID.
                          A 10uF cap is recommended for decoupling on VMID. The charge time for VMID will dominate the
                          time required for the device to become ready after power is applied. The time required for VMID to
                          reach the threshold is a function of the VMID resistor string and the decoupling capacitor. The
                          Resistor string has an typical equivalent resistance of 50kΩ (+/-20%). Assuming a 10uF capacitor,
                          the time required for VMID to reach threshold of 1V is approx 110ms.
                                                                                                         PD, Rev 4.2, July 2008
w
                                                                                                                             14


Production Data                                                                                            WM8778
DEVICE DESCRIPTION
INTRODUCTION
                WM8778 is a complete 2-channel DAC, 2-channel ADC audio CODEC, including digital interpolation
                and decimation filters, multi-bit sigma delta stereo ADC, and switched capacitor multi-bit sigma delta
                DACs with output smoothing filters. It is available in a single package and controlled by a 3 or 2-wire
                serial interface or in a hardware mode.
                An analogue bypass path option is available, to allow stereo analogue signals from the stereo inputs
                to be sent to the stereo outputs. This allows a purely analogue input to analogue output high quality
                signal path to be implemented if required.
                The DAC and ADC have separate left/right clocks, bit clocks, master clocks and data I/Os. The
                Audio Interface may be configured to operate in either master or slave mode. In Slave mode
                ADCLRC, DACLRC, ADCBCLK and DACBCLK are all inputs. In Master mode ADCLRC, DACLRC,
                ADCBCLK and DACBCLK are outputs.
                The ADC has an analogue input PGA and a digital gain control, accessed by one register write. The
                input PGA allows input signals to be gained up to +24dB and attenuated down to -21dB in 0.5dB
                steps. The digital gain control allows attenuation from -21.5dB to -103dB in 0.5dB steps. This allows
                the user maximum flexibility in the use of the ADC.
                The DAC has its own digital volume control, which is adjustable between 0dB and -127.5dB in 0.5dB
                steps. In addition a zero cross detect circuit is provided for digital volume controls. The digital
                volume control detects a transition through the zero point before updating the volume. This
                minimises audible clicks and ‘zipper’ noise as the gain values change.
                The DAC output incorporates an input selector and mixer allowing a signal to be either switched into
                the signal path in place of the DAC signal or mixed with the DAC signal before the analogue outputs.
                Control of internal functionality of the device can be by 3-wire SPI compatible or 2-wire serial control
                interface, or hardware mode, selected by the MODE pin. Both interfaces may be asynchronous to the
                audio data interface as control data will be re-synchronised to the audio processing internally.
                Operation using system clock of 128fs, 192fs, 256fs, 384fs, 512fs or 768fs is provided. In Slave
                mode selection between clock rates is automatically controlled. In master mode the master clock to
                sample rate ratio is set by control bits ADCRATE and DACRATE. ADC and DAC may run at different
                rates. Master clock sample rates (fs) from less than 32kHz up to 192kHz are allowed, provided the
                appropriate system clock is input.
                The audio data interface supports right, left and I2S interface formats along with a highly flexible DSP
                serial port interface.
AUDIO DATA SAMPLING RATES
                In a typical digital audio system there is only one central clock source producing a reference clock to
                which all audio data processing is synchronised. This clock is often referred to as the audio system’s
                Master Clock. The WM8778 uses separate master clocks for the ADC and DAC. The external master
                system clocks can be applied directly through the ADCMCLK and DACMCLK input pins with no
                software configuration necessary. In a system where there are a number of possible sources for the
                reference clock it is recommended that the clock source with the lowest jitter be used to optimise the
                performance of the ADC and DAC.
                The master clock for WM8778 supports DAC audio sampling rates from 128fs to 768fs and ADC
                sampling rates from 256fs to 512fs, where fs is the audio sampling frequency (DACLRC or ADCLRC)
                typically 32kHz, 44.1kHz, 48kHz or 96kHz. The master clock is used to operate the digital filters and
                the noise shaping circuits.
                In Slave mode the WM8778 has a master detection circuit that automatically determines the
                relationship between the master clock frequency and the sampling rate (to within +/- 32 system
                clocks). If there is a greater than 32 clocks error the interface is disabled and maintains the output
                level at the last sample. The master clock must be synchronised with ADCLRC/DACLRC, although
                the WM8778 is tolerant of phase variations or jitter on this clock. Table 6 shows the typical master
                clock frequency inputs for the WM8778.
                                                                                                PD, Rev 4.2, July 2008
w
                                                                                                                      15


WM8778                                                                                      Production Data
       The signal processing for the WM8778 typically operates at an oversampling rate of 128fs for both
       ADC and DAC. The exception to this for the DAC is for operation with a 128/192fs system clock, e.g.
       for 192kHz operation where the oversampling rate is 64fs. For ADC operation at 96kHz it is
       recommended that the user set the ADCOSR bit. This changes the ADC signal processing
       oversample rate to 64fs.
         SAMPLING                              System Clock Frequency (MHz)
            RATE
                          128fs        192fs         256fs       384fs        512fs         768fs
          (DACLRC/
          ADCLRC)             DAC ONLY
            32kHz         4.096       6.144         8.192       12.288       16.384       24.576
           44.1kHz       5.6448       8.467        11.2896     16.9340      22.5792       33.8688
            48kHz         6.144       9.216         12.288      18.432       24.576        36.864
            96kHz        12.288       18.432       24.576       36.864     Unavailable Unavailable
           192kHz        24.576       36.864     Unavailable Unavailable Unavailable Unavailable
       Table 6 System Clock Frequencies Versus Sampling Rate
       In Master mode DACBCLK, ADCBCLK, DACLRC and ADCLRC are generated by the WM8778. The
       frequencies of ADCLRC and DACLRC are set by setting the required ratio of DACMCLK to DACLRC
       and ADCMCLK to ADCLRC using the DACRATE and ADCRATE control bits (Table 7).
         ADCRATE[2:0]/        ADCMCLK/DACMCLK:
          DACRATE[2:0]           ADCLRC/DACLRC
                                      RATIO
               000               128fs (DAC Only)
               001               192fs (DAC Only)
               010                     256fs
               011                     384fs
               100                     512fs
               101                     768fs
       Table 7 Master Mode MCLK:ADCLRC/DACLRC Ratio Select
       Table 8 shows the settings for ADCRATE and DACRATE for common sample rates and
       ADCMCLK/DACMCLK frequencies.
         SAMPLING                               System Clock Frequency (MHz)
            RATE
                           128fs         192fs          256fs        384fs        512fs         768fs
          (DACLRC/
          ADCLRC)        DACRATE       DACRATE        ADCRATE/    ADCRATE/      ADCRATE/      ADCRATE/
                            =000          =001        DACRATE     DACRATE       DACRATE       DACRATE
                                                         =010         =011         =100          =101
            32kHz          4.096         6.144         8.192        12.288       16.384        24.576
           44.1kHz        5.6448         8.467        11.2896      16.9340      22.5792       33.8688
            48kHz          6.144         9.216         12.288       18.432       24.576        36.864
            96kHz         12.288        18.432         24.576      36.864      Unavailable Unavailable
           192kHz         24.576        36.864      Unavailable Unavailable Unavailable Unavailable
       Table 8 Master Mode ADC/DACLRC Frequency Selection
                                                                                    PD, Rev 4.2, July 2008
w
                                                                                                        16


Production Data                                                                                            WM8778
                 ADCBCLK and DACBCLK are also generated by the WM8778. The frequency of ADCBCLK and
                 DACBCLK depends on the mode of operation.
                 In 128/192fs modes (DACRATE=000 or 001) BCLK = MCLK/2. In 256/384/512fs modes
                 (ADCRATE/DACRATE=010 or 011 or 100) BCLK = MCLK/4. However if DSP mode is selected as
                 the audio interface mode then BCLK=MCLK. Note that DSP mode cannot be used in 128fs mode for
                 word lengths greater than 16 bits or in 192fs mode for word lengths greater than 24 bits.
ZERO DETECT
                 The WM8778 has a zero detect circuit for each DAC channel, which detects when 1024 consecutive
                 zero samples have been input. The two zero flag outputs (ZFLAGL and ZFLAGR) may be
                 programmed to output the zero detect signals (see Table 9) that may then be used to control external
                 muting circuits. A ‘1’ on ZFLAGL or ZFLAGR indicates a zero detect. The zero detect may also be
                 used to automatically enable the mute by setting IZD. The zero flag output may be disabled by
                 setting DZFM to 00.
                  DZFM[1:0]            ZFLAGL                  ZFLAGR
                      00        Zero flag disabled       Zero flag disabled
                      01        Left channel zero        Right channel zero
                      10        Both channel zero        Both channel zero
                      11        Either channels zero      Either channel zero
                 Table 9 Zero Flag Output Select
POWERDOWN MODES
                 The WM8778 has powerdown control bits allowing specific parts of the WM8778 to be powered off
                 when not being used. Control bit ADCPD powers off the ADC. The ADC input PGAs will be powered
                 down only if ADCPD and AINPD are set. When AINPD is set the bypass path is automatically
                 disabled. The stereo DAC has a separate powerdown control bit, DACPD allowing the DAC to be
                 powered off when not in use. This also switches the analogue outputs VOUTL/R to VMIDDAC to
                 maintain a dc level on the output. The output mixer will be disabled when PDWN is set.
                 Setting AINPD, ADCPD and DACPD will powerdown everything except the references VMIDADC,
                 ADCREF and VMIDDAC. ADCREF and VMIDDAC can be powered down by setting PDWN,
                 VMIDADC is always active. Setting PDWN will override all other powerdown control bits. It is
                 recommended that AINPD, ADCPD and DACPD are set before setting PDWN. The default is for all
                 blocks to be enabled.
DIGITAL AUDIO INTERFACE
                 MASTER AND SLAVE MODES
                 The audio interface operates in either Slave or Master mode, selectable using the MS control bit. In
                 both Master and Slave modes DIN is always an input to the WM8778 and DOUT is always an output.
                 The default is Slave mode.
                 In Slave mode (MS=0) ADCLRC, DACLRC, ADCBCLK and DACBCLK are inputs to the WM8778
                 (Figure 11). DIN and DACLRC are sampled by the WM8778 on the rising edge of DACBCLK,
                 ADCLRC is sampled on the rising edge of ADCBCLK. ADC data is output on DOUT and changes on
                 the falling edge of ADCBCLK. By setting control bit BCLKINV the polarity of ADCBCLK and
                 DACBCLK may be reversed so that DIN and DACLRC are sampled on the falling edge of DACBCLK,
                 ADCLRC is sampled on the falling edge of ADCBCLK and DOUT changes on the rising edge of
                 ADCBCLK.
                                                                                                PD, Rev 4.2, July 2008
w
                                                                                                                    17


WM8778                                                                                            Production Data
                        DACBCLK
                        ADCBCLK
            WM8778 ADCLRC                                             DVD
            CODEC                                                 Controller
                          DACLRC
                             DOUT
                                 DIN
       Figure 11 Slave Mode
       In Master mode (MS=1) ADCLRC, DACLRC, ADCBCLK and DACBCLK are outputs from the
       WM8778 (Figure 12). ADCLRC, DACLRC, ADCBCLK and DACBCLK are generated by the WM8778.
       DIN is sampled by the WM8778 on the rising edge of DACBCLK so the controller must output DAC
       data that changes on the falling edge of DACBCLK. ADC data is output on DOUT and changes on
       the falling edge of ADCBCLK. By setting control bit BCLKINV, the polarity of ADCBCLK and
       DACBCLK may be reversed so that DIN is sampled on the falling edge of DACBCLK and DOUT
       changes on the rising edge of ADCBCLK.
                       DACBCLK
                       ADCBCLK
                         ADCLRC                                       DVD
           WM8778
            CODEC DACLRC                                           Controller
                             DOUT
                                DIN
       Figure 12 Master Mode
       AUDIO INTERFACE FORMATS
       Audio data is applied to the internal DAC filters or output from the ADC filters, via the Digital Audio
       Interface. 5 popular interface formats are supported:
       •     Left Justified mode
       •     Right Justified mode
       •     I2S mode
       •     DSP mode A
       •     DSP mode B
       All 5 formats send the MSB first and support word lengths of 16, 20, 24 and 32 bits, with the
       exception of 32 bit right justified mode, which is not supported.
       In left justified, right justified and I2S modes, the digital audio interface receives DAC data on the DIN
       input and outputs ADC data on DOUT. Audio Data for each stereo channel is time multiplexed with
       ADCLRC/DACLRC indicating whether the left or right channel is present. ADCLRC/DACLRC is also
       used as a timing reference to indicate the beginning or end of the data words.
                                                                                            PD, Rev 4.2, July 2008
w
                                                                                                                18


Production Data                                                                                                       WM8778
                                                         2
                In left justified, right justified and I S modes; the minimum number of BCLKs per DACLRC/ADCLRC
                period is 2 times the selected word length. ADCLRC/DACLRC must be high for a minimum of word
                length BCLKs and low for a minimum of word length BCLKs. Any mark to space ratio on
                ADCLRC/DACLRC is acceptable provided the above requirements are met.
                In DSP mode A or B, DACLRC is used as a frame sync signal to identify the MSB of the first word.
                The minimum number of DACBCLKs per DACLRC period is 2 times the selected word length. Any
                mark to space ratio is acceptable on DACLRC provided the rising edge is correctly positioned. The
                ADC data may also be output in DSP mode A or B, with ADCLRC used as a frame sync to identify
                the MSB of the first word. The minimum number of ADCBCLKs per ADCLRC period is 2 times the
                selected word length.
                LEFT JUSTIFIED MODE
                In left justified mode, the MSB of DIN is sampled by the WM8778 on the first rising edge of
                DACBCLK following a DACLRC transition. The MSB of the ADC data is output on DOUT and
                changes on the same falling edge of ADCBCLK as ADCLRC and may be sampled on the rising edge
                of ADCBCLK. ADCLRC and DACLRC are high during the left samples and low during the right
                samples (Figure 13).
                                                                              1/fs
                                                   LEFT CHANNEL                            RIGHT CHANNEL
                   DACLRC/
                    ADCLRC
                  DACBCLK/
                  ADCBCLK
                      DIN/
                                     1   2  3              n-2 n-1 n               1 2 3           n-2 n-1 n
                     DOUT
                                 MSB                               LSB        MSB                          LSB
                Figure 13 Left Justified Mode Timing Diagram
                RIGHT JUSTIFIED MODE
                In right justified mode, the LSB of DIN is sampled by the WM8778 on the rising edge of DACBCLK
                preceding a DACLRC transition. The LSB of the ADC data is output on DOUT and changes on the
                falling edge of ADCBCLK preceding a ADCLRC transition and may be sampled on the rising edge of
                ADCBCLK. ADCLRC and DACLRC are high during the left samples and low during the right samples
                (Figure 14).
                                                                              1/fs
                                                   LEFT CHANNEL                            RIGHT CHANNEL
                   DACLRC/
                   ADCLRC
                 DACBCLK/
                  ADCBCLK
                      DIN/
                                                 1  2  3             n-2 n-1 n           1  2  3              n-2 n-1 n
                     DOUT
                                            MSB                              LSB       MSB                             LSB
                Figure 14 Right Justified Mode Timing Diagram
                                                                                                          PD, Rev 4.2, July 2008
w
                                                                                                                              19


WM8778                                                                                           Production Data
        2
       I S MODE
       In I2S mode, the MSB of DIN is sampled by the WM8778 on the second rising edge of DACBCLK
       following a DACLRC transition. The MSB of the ADC data is output on DOUT and changes on the
       first falling edge of ADCBCLK following an ADCLRC transition and may be sampled on the rising
       edge of ADCBCLK. ADCLRC and DACLRC are low during the left samples and high during the right
       samples.
                                                            1/fs
                                      LEFT CHANNEL                          RIGHT CHANNEL
          DACLRC/
          ADCLRC
         DACBCLK/
          ADCBCLK
                             1 BCLK                                1 BCLK
              DIN/
                             1   2  3           n-2 n-1 n          1    2 3            n-2 n-1 n
             DOUT
                          MSB                           LSB      MSB                           LSB
       Figure 15 I2S Mode Timing Diagram
       DSP MODES
       In DSP/PCM mode, the left channel MSB is available on either the 1st (mode B) or 2nd (mode A)
       rising edge of BCLK (selectable by LRP) following a rising edge of LRC. Right channel data
       immediately follows left channel data. Depending on word length, BCLK frequency and sample rate,
       there may be unused BCLK cycles between the LSB of the right channel data and the next sample.
       In device master mode, the LRC output will resemble the frame pulse shown in Figure 16 and Figure
       17. In device slave mode, Figure 18 and Figure 19, it is possible to use any length of frame pulse
       less than 1/fs, providing the falling edge of the frame pulse occurs greater than one BCLK period
       before the rising edge of the next frame pulse.
       Figure 16 DSP/PCM Mode Audio Interface (mode A, LRP=0, Master)
                                                                                          PD, Rev 4.2, July 2008
w
                                                                                                              20


Production Data                                                                         WM8778
                Figure 17 DSP/PCM Mode Audio Interface (mode B, LRP=1, Master)
                Figure 18 DSP/PCM Mode Audio Interface (mode A, LRP=0, Slave)
                Figure 19 DSP/PCM Mode Audio Interface (mode B, LRP=0, Slave)
                                                                               PD, Rev 4.2, July 2008
w
                                                                                                   21


WM8778                                                                                                               Production Data
CONTROL INTERFACE OPERATION
               The WM8778 is controlled by writing to registers through a serial control interface. A control word
               consists of 16 bits. The first 7 bits (B15 to B9) are address bits that select which control register is
               accessed. The remaining 9 bits (B8 to B0) are data bits, corresponding to the 9 bits in each control
               register. The control interface can operate as either a 3-wire or 2-wire MPU interface. The MODE pin
               selects the interface format, as shown in Table 10.
                    MODE            CONTROL MODE
                        0            2 wire software
                 Z / midrail             Hardware
                        1            3 wire software
               Table 10 Control Interface Selection via MODE Pin
               3-WIRE (SPI COMPATIBLE) SERIAL CONTROL MODE
               In 3-wire mode, every rising edge of CL clocks in one data bit from the DI pin. A rising edge on CE
               latches in a complete control word consisting of the last 16 bits. The 3-wire interface protocol is
               shown in Figure 20.
                                                                                                                          latch
                     CE
                     CL
                     DI         B15  B14    B13     B12      B11   B10 B9 B8 B7 B6   B5       B4       B3     B2  B1   B0
                                          control register address                 control register data bits
               Figure 20 3-wire SPI Compatible Interface
                1.    B[15:9] are Control Address Bits
                2.    B[8:0] are Control Data Bits
                3.    CE is edge sensitive – the data is latched on the rising edge of CE.
               2-WIRE SERIAL CONTROL MODE
               The WM8778 supports software control via a 2-wire serial bus. Many devices can be controlled by
               the same bus, and each device has a unique 7-bit address (this is not the same as the 7-bit address
               of each register in the WM8778).
               The WM8778 operates as a slave device only. The controller indicates the start of data transfer with
               a high to low transition on DI while CL remains high. This indicates that a device address and data
               will follow. All devices on the 2-wire bus respond to the start condition and shift in the next eight bits
               on DI (7-bit address + Read/Write bit, MSB first). If the device address received matches the address
               of the WM8778 and the R/W bit is ‘0’, indicating a write, then the WM8778 responds by pulling DI low
               on the next clock pulse (ACK). If the address is not recognised or the R/W bit is ‘1’, the WM8778
               returns to the idle condition and wait for a new start condition and valid address.
               Once the WM8778 has acknowledged a correct address, the controller sends the first byte of control
               data (B15 to B8, i.e. the WM8778 register address plus the first bit of register data). The WM8778
               then acknowledges the first data byte by pulling DI low for one clock pulse. The controller then sends
               the second byte of control data (B7 to B0, i.e. the remaining 8 bits of register data), and the WM8778
               acknowledges again by pulling DI low.
                                                                                                               PD, Rev 4.2, July 2008
w
                                                                                                                                   22


Production Data                                                                                              WM8778
                The transfer of data is complete when there is a low to high transition on DI while CL is high. After
                receiving a complete address and data sequence the WM8778 returns to the idle state and waits for
                another start condition. If a start or stop condition is detected out of sequence at any point during
                data transfer (i.e. DI changes while CL is high), the device jumps to the idle condition.
                Figure 21 2-wire Serial Interface
                 1. B[15:9] are Control Address Bits
                 2.   B[8:0] are Control Data Bits
                The WM8778 has two possible device addresses, which can be selected using the CE pin.
                       CE STATE                 DEVICE ADDRESS
                           Low                   0011010 (0 x 34h)
                           High                  0011011 (0 x 36h)
                Table 11 2-Wire MPU Interface Address Selection
                HARDWARE MODE
                Hardware mode is selected by applying a midrail voltage to the MODE pin, or by leaving it floating.
                The circuit detects this condition and enables hardware mode. This allows limited control of the
                internal functions using the three inputs CE, CL and DI. The table below gives a summary of the use
                of each pin in hardware mode.
                      PIN NAME                    FUNCTION                            DESCRIPTION
                                                                          0 : Right Justified
                        CE\I2S           Interface Mode select                 2
                                                                          1:I S
                                                                          0 : 20 bit (RJ), 16 bit (I2S)
                        CL\IWL           Interface Wordlength select
                                                                          1 : 24 bit
                                                                          0 : De-emphasis disabled
                     DI\DEEMPH           De-emphasis on/off
                                                                          1 : De-emphasis enabled
                Table 12 Hardware Mode Functions
                                                                                                    PD, Rev 4.2, July 2008
w
                                                                                                                        23


WM8778                                                                                                    Production Data
CONTROL INTERFACE REGISTERS
               DIGITAL AUDIO INTERFACE CONTROL REGISTER
               Interface format is selected via the FMT[1:0] register bits:
                  REGISTER ADDRESS            BIT     LABEL        DEFAULT                   DESCRIPTION
                        R10 (0Ah)             1:0   DACFMT            10        Interface format Select
                         0001010                       [1:0]                         00 : right justified mode
                  DAC Interface Control                                              01: left justified mode
                        R11 (0Bh)             1:0   ADCFMT            10             10: I2S mode
                         0001011                       [1:0]                         11: DSP mode A or B
                  ADC Interface Control
                In left justified, right justified or I2S modes, the LRP register bit controls the polarity of
                ADCLRC/DACLRC. If this bit is set high, the expected polarity of ADCLRC/DACLRC will be the
                opposite of that shown Figure 13, Figure 14, etc. Note that if this feature is used as a means of
                swapping the left and right channels, a 1 sample phase difference will be introduced. In DSP modes,
                the LRP register bit is used to select between modes A and B.
                  REGISTER ADDRESS            BIT     LABEL       DEFAULT                   DESCRIPTION
                        R10 (0Ah)               2   DACLRP            0       In left/right/ I2S modes:
                         0001010                                              ADCLRC/DACLRC Polarity (normal)
                  DAC Interface Control                                            0 : normal ADCLRC/DACLRC
                                                                                   polarity
                                                                                   1: inverted ADCLRC/DACLRC
                        R11 (0Bh)               2   ADCLRP            0            polarity
                         0001011                                              In DSP mode:
                  ADC Interface Control                                            0 : DSP mode A
                                                                                   1: DSP mode B
                By default, ADCLRC, DACLRC and DIN are sampled on the rising edge of ADCBCLK and
                DACBCLK and should ideally change on the falling edge. Data sources that change
                ADCLRC/DACLRC and DIN on the rising edge of ADCBCLK/DACBCLK can be supported by setting
                the BCP register bit. Setting BCP to 1 inverts the polarity of BCLK to the inverse of that shown in
                Figure 13, Figure 14, etc.
                  REGISTER ADDRESS            BIT     LABEL        DEFAULT                   DESCRIPTION
                        R10 (0Ah)               3   DACBCP             0        BCLK Polarity (DSP modes)
                         0001010                                                     0 : normal BCLK polarity
                  DAC Interface Control                                              1: inverted BCLK polarity
                        R11 (0Bh)               3   ADCBCP             0
                         0001011
                  ADC Interface Control
               The WL[1:0] bits are used to control the input word length.
                  REGISTER ADDRESS            BIT     LABEL        DEFAULT                   DESCRIPTION
                        R10 (0Ah)             5:4    DACWL            10        Word Length
                         0001010                       [1:0]                         00 : 16 bit data
                  DAC Interface Control                                              01: 20 bit data
                        R11 (0Bh)             5:4    ADCWL            10             10: 24 bit data
                         0001011                       [1:0]                         11: 32 bit data
                  ADC Interface Control
               Note: If 32-bit mode is selected in right justified mode, the WM8778 defaults to 24 bits.
               In all modes, the data is signed 2's complement. The digital filters always input 24-bit data. If the
               DAC is programmed to receive 16 or 20 bit data, the WM8778 pads the unused LSBs with zeros. If
               the DAC is programmed into 32 bit mode, the 8 LSBs are ignored.
               Note: In 24 bit I2S mode, any width of 24 bits or less is supported provided that ADCLRC/DACLRC is
               high for a minimum of 24 BCLKs and low for a minimum of 24 BCLKs.
                                                                                                  PD, Rev 4.2, July 2008
w
                                                                                                                      24


Production Data                                                                                        WM8778
                When operating the ADC digital interface in slave mode, to optimise the performance of the ADC it is
                recommended that the ADCMCLK and ADCBCLK input signals do not have coinciding rising edges.
                The ADCMCLK bit provides the option to internally invert the ADCMCLK input signal when the input
                signals have coinciding rising edges.
                  REGISTER ADDRESS            BIT    LABEL      DEFAULT                  DESCRIPTION
                          R11(0Bh)             6   ADCMCLK         0              ADCMCLK Polarity
                           0001011                                                0 : non-inverted
                      Interface Control                                           1: inverted
                A number of options are available to control how data from the Digital Audio Interface is applied to
                the DAC.
                MASTER MODES
                Control bit ADCMS selects between audio interface Master and Slave Modes for ADC. In ADC
                Master mode ADCLRC and ADCBCLK are outputs and are generated by the WM8778. In Slave
                mode ADCLRC and ADCBCLK are inputs to WM8778.
                  REGISTER ADDRESS            BIT    LABEL      DEFAULT                  DESCRIPTION
                          R12 (0Ch)            8    ADCMS          0          Audio Interface Master/Slave Mode
                           0001100                                            select for ADC:
                      Interface Control                                           0 : Slave Mode
                                                                                  1: Master Mode
                Control bit DACMS selects between audio interface Master and Slave Modes for the DAC. In DAC
                Master mode DACLRC and DACBCLK are outputs and are generated by the WM8778. In Slave
                mode DACLRC and DACBCLK are inputs to WM8778.
                  REGISTER ADDRESS            BIT    LABEL      DEFAULT                  DESCRIPTION
                          R12 (0Ch)            7    DACMS          0          Audio Interface Master/Slave Mode
                           0001100                                            select for DAC:
                      Interface Control                                           0 : Slave Mode
                                                                                  1: Master Mode
                MASTER MODE ADCLRC/DACLRC FREQUENCY SELECT
                In ADC Master mode the WM8778 generates ADCLRC and ADCBCLK, in DAC master mode the
                WM8778 generates DACLRC and DACBCLK. These clocks are derived from the master clock
                (ADCMCLK or DACMCLK). The ratios of ADCMCLK to ADCLRC and DACMCLK to DACLRC are
                set by ADCRATE and DACRATE respectively.
                  REGISTER ADDRESS            BIT      LABEL        DEFAULT                DESCRIPTION
                          R12 (0Ch)           2:0   ADCRATE[2:0]       010        Master Mode MCLK:ADCLRC
                           0001100                                                Ratio Select:
                  ADCLRC and DACLRC                                                     010: 256fs
                     Frequency Select                                                   011: 384fs
                                                                                        100: 512fs
                                                                                        101: 768fs
                                              6:4   DACRATE[2:0]       010        Master Mode MCLK:DACLRC
                                                                                  Ratio Select:
                                                                                        000: 128fs
                                                                                        001: 192fs
                                                                                        010: 256fs
                                                                                        011: 384fs
                                                                                        100: 512fs
                                                                                        101: 768fs
                                                                                              PD, Rev 4.2, July 2008
w
                                                                                                                  25


WM8778                                                                                        Production Data
       ADC OVERSAMPLING RATE SELECT
       For ADC operation at 96kHz it is recommended that the user set the ADCOSR bit. This changes the
       ADC signal processing oversample rate to 64fs.
         REGISTER ADDRESS             BIT      LABEL      DEFAULT                  DESCRIPTION
                R12 (0Ch)              3     ADCOSR            0         ADC Oversampling Rate Select
                 0001100                                                      0: 128x oversampling
        ADC Oversampling Rate                                                 1: 64x oversampling
       MUTE MODES
       Setting MUTE for the DAC will apply a ‘soft’ mute to the input of the digital filters of the channel
       muted.
         REGISTER ADDRESS             BIT      LABEL      DEFAULT                  DESCRIPTION
                 R8 (08h)              0      DMUTE            0         DAC Soft Mute Select
                 0001000                                                     0 : Normal Operation
                DAC Mute                                                     1: Soft mute enabled
           1.5
              1
           0.5
              0
          -0.5
             -1
          -1.5
             -2
          -2.5
                0            0.001          0.002         0.003           0.004         0.005         0.006
                                                         Time(s)
       Figure 22 Application and Release of Soft Mute
       Figure 22 shows the application and release of DMUTE whilst a full amplitude sinusoid is being
       played at 48kHz sampling rate. When DMUTE (lower trace) is asserted, the output (upper trace)
       begins to decay exponentially from the DC level of the last input sample. The output will decay
       towards VMID with a time constant of approximately 64 input samples. If DMUTE is applied to both
       channels for 1024 or more input samples the DAC will be muted if IZD is set. When DMUTE is de-
       asserted, the output will restart immediately from the current input sample.
       Note that all other means of muting the DAC: setting the PL[3:0] bits to 0, setting the PDWN bit or
       setting attenuation to 0 will cause much more abrupt muting of the output.
                                                                                        PD, Rev 4.2, July 2008
w
                                                                                                            26


Production Data                                                                                           WM8778
                ADC MUTE
                Each ADC channel also has an individual mute control bit, which mutes the input to the ADC PGA.
                By setting the LRBOTH bit (reg22, bit 8) both channels can be muted simultaneously.
                    REGISTER ADDRESS           BIT     LABEL        DEFAULT                   DESCRIPTION
                          R21 (15h)             7     MUTELA            0         ADC Mute Select
                           0010101                                                    0 : Normal Operation
                        ADC Mute Left                                                 1: mute ADC left
                          R21 (15h)             6    MUTERA             0         ADC Mute Select
                           0001111                                                    0 : Normal Operation
                       ADC Mute Right                                                 1: mute ADC right
                DE-EMPHASIS MODE
                The De-emphasis filter for the DAC is enabled under the control of DEEMP.
                    REGISTER ADDRESS           BIT      LABEL         DEFAULT                  DESCRIPTION
                           R9 (09h)             0     DEEMPH               0        De-emphasis Mode Select:
                           0001001                                                       0 : Normal Mode
                      DAC De-emphasis                                                    1: De-emphasis Mode
                            Control
                Refer to Figure 33, Figure 34, Figure 35, Figure 36, Figure 37 and Figure 38 for details of the De-
                Emphasis modes at different sample rates.
                POWERDOWN MODE AND ADC/DAC DISABLE
                Setting the PDWN register bit immediately powers down the WM8778, including the references,
                overriding all other powerdown control bits. All trace of the previous input samples is removed, but all
                control register settings are preserved. When PDWN is cleared, the digital filters will be re-initialised.
                It is recommended that the buffer, ADC and DAC are powered down before setting PDWN.
                    REGISTER ADDRESS           BIT    LABEL        DEFAULT                   DESCRIPTION
                          R13 (0Dh)             0     PDWN             0         Power Down Mode Select:
                           0001101                                                   0 : Normal Mode
                     Powerdown Control                                               1: Power Down Mode
                The ADC and DAC may also be powered down by setting the ADCPD and DACPD disable bits.
                Setting ADCPD will disable the ADC and select a low power mode. The ADC digital filters will be
                reset and will reinitialise when ADCPD is reset. The DAC has a separate disable DACPD. Setting
                DACPD will disable the DAC, mixer and output PGAs. Resetting DACPD will reinitialise the digital
                filters.
                    REGISTER ADDRESS           BIT     LABEL        DEFAULT                   DESCRIPTION
                          R13 (0Dh)             1     ADCPD             0         ADC Powerdown:
                           0001101                                                    0 : Normal Mode
                     Powerdown Control                                                1: Power Down Mode
                                                2     DACPD             0         DAC Powerdown:
                                                                                      0 : Normal Mode
                                                                                      1: Power Down Mode
                The analogue audio inputs and outputs can also be individually powered down by setting the relevant
                bits in the powerdown register.
                                                                                                 PD, Rev 4.2, July 2008
w
                                                                                                                        27


WM8778                                                                                               Production Data
          REGISTER ADDRESS            BIT      LABEL         DEFAULT                    DESCRIPTION
                R13 (0Dh)               6      AINPD              0         Analogue Input PGA Disable:
                 0001101                                                          0 : Normal Mode
           Powerdown Control                                                      1: Power Down Mode
       DIGITAL ATTENUATOR CONTROL MODE
       Setting the ATC register bit causes the left channel attenuation settings to be applied to both left and
       right channel DACs from the next audio input sample. No update to the attenuation registers is
       required for ATC to take effect.
          REGISTER ADDRESS            BIT     LABEL        DEFAULT                      DESCRIPTION
                 R7 (07h)               1       ATC              0         Attenuator Control Mode:
                 0000111                                                        0 : Right channel use Right
          DAC Channel Control                                                         attenuation
                                                                                1: Right Channel use Left
                                                                                      Attenuation
       INFINITE ZERO DETECT ENABLE
       Setting the IZD register bit will enable the internal infinite zero detect function:
          REGISTER ADDRESS            BIT     LABEL        DEFAULT                      DESCRIPTION
                 R7 (07h)               2       IZD              0         Infinite Zero Mute Enable
                 0000111                                                        0 : disable infinite zero mute
          DAC Channel Control                                                   1: enable infinite zero Mute
       With IZD enabled, applying 1024 consecutive zero input samples to the DAC will cause both DAC
       outputs to be muted. Mute will be removed as soon as any channel receives a non-zero input.
       DAC OUTPUT CONTROL
       The DAC output control word determines how the left and right inputs to the audio Interface are
       applied to the left and right DACs:
          REGISTER ADDRESS            BIT     LABEL        DEFAULT                      DESCRIPTION
                 R7 (07h)             7:4     PL[3:0]          1001        PL[3:0]        Left          Right
                 0000111                                                                  Output        Output
              DAC Control                                                  0000           Mute          Mute
                                                                           0001           Left          Mute
                                                                           0010           Right         Mute
                                                                           0011           (L+R)/2       Mute
                                                                           0100           Mute          Left
                                                                           0101           Left          Left
                                                                           0110           Right         Left
                                                                           0111           (L+R)/2       Left
                                                                           1000           Mute          Right
                                                                           1001           Left          Right
                                                                           1010           Right         Right
                                                                           1011           (L+R)/2       Right
                                                                           1100           Mute          (L+R)/2
                                                                           1101           Left          (L+R)/2
                                                                           1110           Right         (L+R)/2
                                                                           1111           (L+R)/2       (L+R)/2
                                                                                             PD, Rev 4.2, July 2008
w
                                                                                                                 28


Production Data                                                                                                 WM8778
                       DAC DIGITAL VOLUME CONTROL
                       The DAC volume may also be adjusted in the digital domain using independent digital attenuation
                       control registers
   REGISTER      BIT    LABEL          DEFAULT                                   DESCRIPTION
    ADDRESS
     R3 (03h)    7:0   LDA[7:0]        11111111     Digital Attenuation data for Left channel DACL in 0.5dB steps. See
     0000011                             (0dB)      Table 13
      Digital     8   UPDATED         Not latched   Controls simultaneous update of Attenuation Latches
   Attenuation                                              0: Store LDA in intermediate latch (no change to output)
      DACL                                                  1: Store LDA and update attenuation on both channels
     R4 (04h)    7:0  RDA[6:0]         11111111     Digital Attenuation data for Right channel DACR in 0.5dB steps. See
     0000100                             (0dB)      Table 13
      Digital     8   UPDATED         Not latched   Controls simultaneous update of Attenuation Latches
   Attenuation
                                                            0: Store RDA in intermediate latch (no change to output)
      DACR
                                                            1: Store RDA and update attenuation on both channels.
     R5 (05h)    7:0 MASTDA[7:0]       11111111     Digital Attenuation data for DAC channels in 0.5dB steps. See Table
     0000101                             (0dB)      13
      Master      8   UPDATED         Not latched   Controls simultaneous update of Attenuation Latches
      Digital
                                                            0: Store gain in intermediate latch (no change to output)
   Attenuation
                                                            1: Store gain and update attenuation on channels.
 (both channels)
                                L/RDA[7:0]             ATTENUATION LEVEL
                                  00(hex)                    -∞ dB (mute)
                                  01(hex)                       -127dB
                                     :                              :
                                     :                              :
                                     :                              :
                                  FE(hex)                       -0.5dB
                                  FF(hex)                         0dB
                     Table 13 Digital Volume Control Attenuation Levels
                       The digital volume control also incorporates a zero cross detect circuit which detects a transition
                       through the zero point before updating the digital volume control with the new volume. This is
                       enabled by control bit DZCEN.
                         REGISTER ADDRESS          BIT      LABEL       DEFAULT                   DESCRIPTION
                                 R7 (07h)           0      DZCEN             0         DAC Digital Volume Zero Cross
                                 0000111                                               Enable:
                               DAC Control                                                 0: Zero cross detect disabled
                                                                                           1: Zero cross detect enabled
                       DAC OUTPUT PHASE
                       The DAC Phase control word determines whether the output of the DAC is non-inverted or inverted
                         REGISTER ADDRESS          BIT      LABEL       DEFAULT                   DESCRIPTION
                                 R6 (06h)          1:0      PHASE           00         Bit          DAC         Phase
                                 0000110                     [1:0]                     0            DACL        1 = invert
                               DAC Phase
                                                                                       1            DACR        1 = invert
                                                                                                       PD, Rev 4.2, July 2008
w
                                                                                                                           29


WM8778                                                                                          Production Data
        ADC GAIN CONTROL
        The ADC has an analogue input PGA and digital gain control for each stereo channel. Both the
        analogue and digital gains are adjusted by the same register, LAG for the left and RAG for the right.
        The analogue PGA has a range of +24dB to -21dB in 0.5dB steps. The digital gain control allows
        further attenuation (after the ADC) from -21.5dB to -103dB in 0.5dB steps. Table 14 shows how the
        register maps the analogue and digital gains.
            LAG/RAG[7:0]             ATTENUATION             ANALOGUE PGA                 DIGITAL
                                       LEVEL (AT                                       ATTENUATION
                                        OUTPUT)
               00(hex)                -∞ dB (mute)                  -21dB               Digital mute
               01(hex)                   -103dB                     -21dB                  -82dB
                   :                         :                         :                      :
               A4(hex)                  -21.5dB                     -21dB                  -0.5dB
               A5(hex)                    -21dB                     -21dB                   0dB
                   :                         :                         :                      :
               CF(hex)                     0dB                       0dB                    0dB
                   :                         :                         :                      :
               FE(hex)                  +23.5dB                   +23.5dB                   0dB
               FF(hex)                   +24dB                     +24dB                    0dB
       Table 14 Analogue and Digital Gain Mapping for ADC
        In addition a zero cross detect circuit is provided for the input PGA. When ZCLA/ZCRA is set with a
        write, the gain will update only when the input signal approaches zero (midrail). This minimises
        audible clicks and ‘zipper’ noise as the gain values change. A timeout clock is also provided which
        will generate an update after a minimum of 131072 master clocks (= ~10.5ms with a master clock of
        12.288MHz). The timeout clock may be disabled by setting TOD.
          REGISTER ADDRESS             BIT     LABEL       DEFAULT                 DESCRIPTION
                  R7 (07h)            3          TOD              0       Analogue PGA Zero Cross Detect
                  0000111                                                 Timeout Disable
          Timeout Clock Disable                                           0 : Timeout enabled
                                                                          1: Timeout disabled
        Left and right inputs may also be independently muted. The LRBOTH control bit allows the user to
        write the same attenuation value to both left and right volume control registers, saving on software
        writes. The ADC volume and mute also applies to the bypass signal path.
                                                                                        PD, Rev 4.2, July 2008
w
                                                                                                            30


Production Data                                                                                                     WM8778
 REGISTER       BIT  LABEL        DEFAULT                                        DESCRIPTION
  ADDRESS
  R14 (0Eh)     7:0 LAG[7:0]      11001111         Attenuation Data for Left Channel ADC Gain in 0.5dB steps. See
   0001110                           (0dB)         Table 14.
 Attenuation
    ADCL         8   ZCLA              0           Left Channel ADC Zero Cross Enable:
                                                              0: Zero cross disabled
                                                              1: Zero cross enabled
  R15 (0Fh)     7:0 RAG[7:0]      11001111         Attenuation data for right channel ADC gain in 0.5dB steps. See
   0001111                           (0dB)         Table 14.
 Attenuation
    ADCR         8   ZCRA              0           Right Channel ADC Zero Cross Enable:
                                                              0: Zero cross disabled
                                                              1: Zero cross enabled
  R21 (15h)      6  MUTERA             0           Mute for Right Channel ADC
   0010101                                                    0: Mute Off
ADC Input Mux                                                 1: Mute on
                 7  MUTELA             0           Mute for Left Channel ADC
                                                              0: Mute Off
                                                              1: Mute on
                 8  LRBOTH             0           Right Channel Input PGA Controlled by Left Channel Register
                                                              0 : Right channel uses RAG and MUTERA.
                                                              1 : Right channel uses LAG and MUTELA.
                      ADC HIGHPASS FILTER DISABLE
                      The ADC digital filters contain a digital high pass filter. This defaults to enabled and can be disabled
                      using software control bit ADCHPD.
                        REGISTER ADDRESS            BIT     LABEL        DEFAULT                    DESCRIPTION
                              R11 (0Bh)              8    ADCHPD              0         ADC High Pass Filter Disable:
                               0001011                                                       0: High pass filter enabled
                             ADC Control                                                     1: High pass filter disabled
                      ADC OUTPUT PHASE
                      In the ADC to DOUT data path, the digital output data DOUT, is a phase inverted representation of
                      the analogue input signal.
                                                                                                        PD, Rev 4.2, July 2008
w
                                                                                                                            31


WM8778                                                                                                   Production Data
LIMITER / AUTOMATIC LEVEL CONTROL (ALC)
                 The WM8778 has an automatic pga gain control circuit, which can function as a peak limiter or as an
                 automatic level control (ALC). In peak limiter mode, a digital peak detector detects when the input
                 signal goes above a predefined level and will ramp the pga gain down to prevent the signal becoming
                 too large for the input range of the ADC. When the signal returns to a level below the threshold, the
                 pga gain is slowly returned to its starting level. The peak limiter cannot increase the pga gain above
                 its static level.
                   input
                  signal
                    PGA
                    gain
                  signal
                                                                                                     Limiter
                    after
                                                                                                   threshold
                    PGA
                                          attack                   decay
                                            time                    time
                 Figure 23 Limiter Operation
                 In ALC mode, the circuit aims to keep a constant recording volume irrespective of the input signal
                 level. This is achieved by continuously adjusting the PGA gain so that the signal level at the ADC
                 input remains constant. A digital peak detector monitors the ADC output and changes the PGA gain
                 if necessary.
                   input
                  signal
                   PGA
                    gain
                  signal                                                                     ALC
                   after                                                                    target
                    ALC                                                                      level
                                          hold   decay                attack
                                          time    time                 time
                 Figure 24 ALC Operation
                                                                                                  PD, Rev 4.2, July 2008
w
                                                                                                                      32


Production Data                                                                                              WM8778
                The gain control circuit is enabled by setting the LCEN control bit. The user can select between
                Limiter mode and three different ALC modes using the LCSEL control bits.
                      REGISTER           BIT        LABEL          DEFAULT                     DESCRIPTION
                      ADDRESS
                       R17 (11h)           8         LCEN                0         Enable the PGA Gain Control Circuit.
                       0010001                                                     0 = Disabled
                     ALC Control 2                                                 1 = Enabled
                       R16 (10h)         8:7        LCSEL               00         LC Function Select
                       0010000                                                     00 = Limiter
                     ALC Control 1                                                 01 = ALC Right channel only
                                                                                   10 = ALC Left channel only
                                                                                   11 = ALC Stereo
                The limiter function only operates in stereo, which means that the peak detector takes the maximum
                of left and right channel peak values, and any new gain setting is applied to both left and right PGAs,
                so that the stereo image is preserved. However, the ALC function can also be enabled on one
                channel only. In this case, only one PGA is controlled by the ALC mechanism, while the other
                channel runs independently with its PGA gain set through the control register.
                When enabled, the threshold for the limiter or target level for the ALC is programmed using the LCT
                control bits. This allows the threshold/target level to be programmed between -1dB and -16dB in 1dB
                steps. Note that for the ALC, target levels of -1dB and -2dB give a threshold of -3dB. This is
                because the ALC can give erroneous operation if the target level is set too high.
                     REGISTER          BIT         LABEL          DEFAULT                    DESCRIPTION
                     ADDRESS
                      R16 (10h)        3:0        LCT[3:0]            1011      Limiter Threshold/ALC Target Level in
                      0010000                                        (-5dB)     1dB Steps:
                   ALC Control 1                                                0000: -16dB FS
                                                                                0001: -15dB FS
                                                                                …
                                                                                1101: -3dB FS
                                                                                1110: -2dB FS
                                                                                1111: -1dB FS
                ATTACK AND DECAY TIMES
                The limiter and ALC have different attack and decay times which determine their operation. However,
                the attack and decay times are defined slightly differently for the limiter and for the ALC. DCY and
                ATK control the decay and attack times, respectively.
                Decay time (Gain Ramp-Up). When in ALC mode, this is defined as the time that it takes for the
                PGA gain to ramp up across 90% of its range (e.g. from –21dB up to +20 dB). When in limiter mode,
                it is defined as the time it takes for the gain to ramp up by 6dB.
                The decay time can be programmed in power-of-two (2n) steps. For the ALC this gives times from
                33.6ms, 67.2ms, 134.4ms etc. to 34.41s. For the limiter this gives times from 1.2ms, 2.4ms etc., up
                to 1.2288s.
                Attack time (Gain Ramp-Down) When in ALC mode, this is defined as the time that it takes for the
                PGA gain to ramp down across 90% of its range (e.g. from +20dB down to -21dB gain). When in
                limiter mode, it is defined as the time it takes for the gain to ramp down by 6dB.
                The attack time can be programmed in power-of-two (2n) steps, from 8.4ms, 16.8ms, 33.6ms etc. to
                8.6s for the ALC and from 250us, 500us, etc. up to 256ms.
                The time it takes for the recording level to return to its target value or static gain value therefore
                depends on both the attack/decay time and on the gain adjustment required. If the gain adjustment is
                small, it will be shorter than the attack/decay time.
                                                                                                   PD, Rev 4.2, July 2008
w
                                                                                                                        33


WM8778                                                                                        Production Data
          REGISTER        BIT      LABEL        DEFAULT                      DESCRIPTION
           ADDRESS
           R18 (12h)      3:0     ATK[3:0]        0010             LC Attack (Gain Ramp-down) Time
            0010010                                           ALC mode              Limiter Mode
              ALC                                             0000: 8.4ms           0000: 250us
            Control 3                                         0001: 16.8ms          0001: 500us… 0010:
                                                              0010: 33.6ms…         1ms
                                                              (time doubles with    (time doubles with
                                                              every step)           every step)
                                                              1010 or higher:       1010 or higher: 256ms
                                                              8.6s
                          7:4     DCY [3:0]       0011              LC Decay (Gain Ramp-up) Time
                                                              ALC mode               Limiter mode
                                                              0000: 33.5ms           0000: 1.2ms
                                                              0001: 67.2ms           0001: 2.4ms
                                                              0010: 134.4ms          0010: 4.8ms ….(time
                                                              ….(time doubles for    doubles for every
                                                              every step)            step)
                                                              1010 or higher:        1010 or higher:
                                                              34.3 ms                1.2288s
       TRANSIENT WINDOW (LIMITER ONLY)
       To prevent the limiter responding to to short duration high ampitude signals (such as hand-claps in a
       live performance), the limiter has a programmable transient window preventing it responding to
       signals above the threshold until their duration exceeds the window period. The Transient window is
       set in register TRANWIN.
            REGISTER        BIT       LABEL           DEFAULT                    DESCRIPTION
            ADDRESS
            R20 (14h)       6:4      TRANWIN             010        Length of Transient Window:
             0010100                    [2:0]                       000: 0us (disabled)
          Limiter Control                                           001: 62.5us
                                                                    010: 125us
                                                                    …..
                                                                    111: 4ms
       ZERO CROSS
       The PGA has a zero cross detector to prevent gain changes introducing noise to the signal. In ALC
       mode the register bit ALCZC allows this to be turned off if desired.
            REGISTER        BIT       LABEL           DEFAULT                    DESCRIPTION
            ADDRESS
            R17 (11h)        7        ALCZC                0        PGA Zero Cross Enable:
             0010001                                  (disabled)    0 : disabled
          ALC Control 2                                             1: enabled
                                                                                        PD, Rev 4.2, July 2008
w
                                                                                                            34


Production Data                                                                                               WM8778
                MAXIMUM GAIN (ALC ONLY) AND MAXIMUM ATTENUATION
                To prevent low level signals being amplified too much by the ALC, the MAXGAIN register sets the
                upper limit for the gain. This prevents low level noise being over-amplified. The MAXGAIN register
                has no effect on the limiter operation.
                The
                register has different operation for the limiter and for the ALC. For the limiter it defines the maximum
                attenuation below the static (user programmed) gain. For the ALC, it defines the lower limit for the
                gain.
                    REGISTER         BIT         LABEL           DEFAULT                   DESCRIPTION
                    ADDRESS
                    R16 (10h)        6:4       MAXGAIN               111       Set Maximum Gain for the PGA (ALC
                     0010000                                      (+24dB)      only):
                  ALC Control 1                                                111 : +24dB
                                                                               110 : +20dB
                                                                               …..(-4dB steps)
                                                                               010 : +4dB
                                                                               001 : 0dB
                                                                               000 : 0dB
                    R20 (14h)        3:0      MAXATTEN              0110       Maximum Attenuation of PGA
                     0010100                                                   Limiter               ALC (lower PGA
                  Limiter Control                                              (attenuation          gain limit)
                                                                               below static)         1010 or lower
                                                                               0011 or lower         : -1dB
                                                                               : -3dB                1011 : -5dB
                                                                               0100: -4dB            ….. (-4dB steps)
                                                                               …. (-1dB steps)       1110 : -17dB
                                                                               1100 or higher        1111 : -21dB
                                                                               : -12dB
                HOLD TIME (ALC ONLY)
                The ALC also has a hold time, which is the time delay between the peak level detected being below
                target and the PGA gain beginning to ramp up. It can be programmed in power-of-two (2n) steps, e.g.
                2.67ms, 5.33ms, 10.67ms etc. up to 43.7ms. Alternatively, the hold time can also be set to zero. The
                hold time only applies to gain ramp-up, there is no delay before ramping the gain down when the
                signal level is above target.
                    REGISTER         BIT         LABEL           DEFAULT                   DESCRIPTION
                    ADDRESS
                    R17 (11h)        3:0        HLD[3:0]            0000       ALC Hold Time Before Gain is
                     0010001                                                   Increased:
                  ALC Control 2                                                0000: 0ms
                                                                               0001: 2.67ms
                                                                               0010: 5.33ms
                                                                               … (time doubles with every step)
                                                                               1111: 43.691s
                                                                                                   PD, Rev 4.2, July 2008
w
                                                                                                                       35


WM8778                                                                                         Production Data
       OVERLOAD DETECTOR (ALC ONLY)
       To prevent clipping when a large signal occurs just after a period of quiet, the ALC circuit includes an
       overload detector. If the ADC input signal exceeds 87.5% of full scale (–1.16dB), the PGA gain is
       ramped down at the maximum attack rate (as when ATK = 0000), until the signal level falls below
       87.5% of full scale. This function is automatically enabled whenever the ALC is enabled.
       (Note: If ATK = 0000, then the overload detector makes no difference to the operation of the ALC. It
       is designed to prevent clipping when long attack times are used).
       NOISE GATE (ALC ONLY)
       When the signal is very quiet and consists mainly of noise, the ALC function may cause “noise
       pumping”, i.e. loud hissing noise during silence periods. The WM8778 has a noise gate function that
       prevents noise pumping by comparing the signal level at the AINL1/2/3/4/5 and/or AINR1/2/3/4/5 pins
       against a noise gate threshold, NGTH. The noise gate cuts in when:
       •     Signal level at ADC [dB] < NGTH [dB] + PGA gain [dB] + Mic Boost gain [dB]
       This is equivalent to:
       •     Signal level at input pin [dB] < NGTH [dB]
       When the noise gate is triggered, the PGA gain is held constant (preventing it from ramping up as it
       would normally when the signal is quiet).
       The table below summarises the noise gate control register. The NGTH control bits set the noise
       gate threshold with respect to the ADC full-scale range. The threshold is adjusted in 6dB steps.
       Levels at the extremes of the range may cause inappropriate operation, so care should be taken with
       set–up of the function. Note that the noise gate only works in conjunction with the ALC function, and
       always operates on the same channel(s) as the ALC (left, right, both, or none).
            REGISTER           BIT       LABEL         DEFAULT                    DESCRIPTION
            ADDRESS
            R19 (13h)           0         NGAT              0        Noise Gate Function Enable:
             0010011                                                 1 = enable
            Noise Gate                                               0 = disable
              Control          4:2      NGTH[2:0]          000       Noise Gate Threshold (with respect to
                                                                     ADC output level):
                                                                     000: -78dBFS
                                                                     001: -72dBfs
                                                                     … 6 dB steps
                                                                     110: -42dBFS
                                                                     111: -36dBFS
                                                                                        PD, Rev 4.2, July 2008
w
                                                                                                             36


Production Data                                                                                         WM8778
                OUTPUT SELECT AND ENABLE CONTROL
                Register bits MXDAC and MXBYP controls the output selection. The output select block consists of a
                summing stage and an input select switch for each input allowing each signal to be output
                individually or summed with other signals and output on the analogue output. The default for the
                output is DAC playback only. VOUT may be selected to output DAC playback, analogue bypass or a
                sum of the two using the output select controls MXDAC and MXBYP.
                The output mixer is powered down when PDWN is set. The bypass path is automatically deselected
                when AINPD is set.
                  REGISTER         BIT       LABEL           DEFAULT                   DESCRIPTION
                   ADDRESS
                   R22 (16h)        0       MXDAC                1          VOUT Output Select DAC (see
                    0010110                              (DAC playback)     Figure 25)
                  Output Mux
                                    2       MXBYP                0          VOUT Output Select Bypass Path.
                                                           (not selected)
                Figure 25 MX[2:0] Output Select
                SOFTWARE REGISTER RESET
                Writing any value to register 0010111 will cause a register reset, resetting all register bits to their
                default values.
                                                                                             PD, Rev 4.2, July 2008
w
                                                                                                                    37


WM8778                                                                                                                   Production Data
REGISTER MAP
The complete register map is shown below. The detailed description can be found in the relevant text of the device description. The
WM8778 can be configured using the Control Interface. All unused bits should be set to ‘0’.
REGISTER B    B   B   B  B    B  B      B8         B7        B6          B5      B4          B3      B2          B1        B0   DEFAULT
           15 14 13 12 11 10     9                                                                                                (HEX)
 R3 (03h)  0  0   0   0  0    1  1 UPDATED                                         LDA[7:0]                                        0FF
 R4 (04h)  0  0   0   0  1    0  0 UPDATED                                        RDA[7:0]                                         0FF
 R5 (05h)  0  0   0   0  1    0  1 UPDATED                                      MASTDA[7:0]                                        0FF
 R6 (06h)  0  0   0   0  1    1  0      0           0        0            0       0          0       0            PHASE[1:0]       000
 R7 (07h)  0  0   0   0  1    1  1      0                       PL[3:0]                     TOD     IZD       ATC      DZCEN       090
 R8 (08h)  0  0   0   1  0    0  0      0           0        0            0       0          0       0          0      DMUTE       000
 R9 (09h)  0  0   0   1  0    0  1      0           0        0            0       0          0        DZFM [1:0]      DEEMPH       000
 R10 (0Ah) 0  0   0   1  0    1  0      0           0        0           DACWL[1:0]      DACBCP   DACLRP         DACFMT[1:0]       022
 R11 (0Bh) 0  0   0   1  0    1  1  ADCHPD          0   ADCMCLK          ADCWL[1:0]      ADCBCP   ADCLRP         ADCFMT[1:0]       022
 R12 (0Ch) 0  0   0   1  1    0  0   ADCMS      DACMS              DACRATE[2:0]          ADCOSR           ADCRATE[2:0]             022
 R13 (ODh) 0  0   0   1  1    0  1      0           0      AINPD          0       0          0    DACPD      ADCPD      PDWN       000
 R14 (0Eh) 0  0   0   1  1    1  0    ZCLA                                         LAG[7:0]                                        0CF
 R15 (0Fh) 0  0   0   1  1    1  1    ZCRA                                        RAG[7:0]                                         0CF
 R16 (10h) 0  0   1   0  0    0  0        LCSEL[1:0]              MAXGAIN[2:0]                          LCT[3:0]                   07B
 R17 (11h) 0  0   1   0  0    0  1    LCEN      ALCZC         0           0       0                     HLD[3:0]                   000
 R18 (12h) 0  0   1   0  0    1  0      0                      DCY[3:0]                                 ATK[3:0]                   032
 R19 (13h) 0  0   1   0  0    1  1      0           0        0            0             NGTH[2:0]                0      NGAT       000
 R20 (14h) 0  0   1   0  1    0  0      0           1            TRANWIN[2:0]                      MAXATTEN[3:0]                   0A6
 R21 (15h) 0  0   1   0  1    0  1  LRBOTH     MUTELA    MUTERA           0                           0                            000
 R22 (16h) 0  0   1   0  1    1  0      0           0                        0                      MXBYP         0     MXDAC      001
 R23 (17h) 0  0   1   0  1    1  1                                      SOFTWARE RESET                                          not reset
                                                                                                                  PD, Rev 4.2, July 2008
w
                                                                                                                                       38


Production Data                                                                                       WM8778
   REGISTER     BIT    LABEL     DEFAULT                                 DESCRIPTION
   ADDRESS
    R3 (03h)    7:0   LDA[7:0]  11111111    Digital Attenuation Data for Left Channel DACL in 0.5dB Steps.
    0000011                       (0dB)
      Digital
  Attenuation
                 8   UPDATED    Not latched Controls Simultaneous Update of all Attenuation Latches
      DACL
                                                     0: Store LDA1 in intermediate latch (no change to output)
                                                     1: Store LDA1 and update attenuation on all channels
    R4 (04h)    7:0  RDA[6:0]   11111111    Digital Attenuation Data for Right Channel DACR in 0.5dB Steps.
    0000100                       (0dB)
      Digital
  Attenuation
                 8   UPDATED    Not latched Controls Simultaneous Update of all Attenuation Latches
      DACR
                                                     0: Store RDA1 in intermediate latch (no change to output)
                                                     1: Store RDA1 and update attenuation on all channels.
    R5 (05h)    7:0 MASTDA[7:0] 11111111    Digital Attenuation Data for all DAC Channels in 0.5dB Steps.
    0000101                       (0dB)
      Master
      Digital
                 8   UPDATED    Not latched Controls Simultaneous Update of all Attenuation Latches
  Attenuation
                                                     0: Store gain in intermediate latch (no change to output)
 (All Channels)
                                                     1: Store gain and update attenuation on all channels.
    R6 (06h)    1:0   PHASE          00     Controls Phase of DAC Outputs (LEFT, RIGHT Channel)
    0000110                                          0: Sets non inverted output phase
 Phase Swaps                                         1: inverts phase of DAC output
    R7 (07h)     0    DZCEN          0      DAC Digital Volume Zero Cross Enable:
    0000111                                           0: Zero Cross detect disabled
  DAC Control                                         1: Zero Cross detect enabled
                 1      ATC           0     Attenuator Control:
                                                    0: All DACs use attenuations as programmed.
                                                    1: Right DAC uses left DAC attenuations
                 2      IZD           0     Infinite Zero Detection Circuit Control and Automute Control
                                                    0: Infinite zero detect automute disabled
                                                     1: Infinite zero detect automute enabled
                                            DAC and ADC Analogue Zero Cross Detect Timeout Disable
                 3      TOD           0               0 : Timeout enabled
                                                      1: Timeout disabled
                7:4    PL[3:0]     1001     DAC Output Control
                                            PL[3:0]       Left         Right      PL[3:0]     Left       Right
                                                          Output       Output                 Output     Output
                                            0000          Mute         Mute       1000        Mute       Right
                                            0001          Left         Mute       1001        Left       Right
                                            0010          Right        Mute       1010        Right      Right
                                            0011          (L+R)/2      Mute       1011        (L+R)/2    Right
                                            0100          Mute         Left       1100        Mute       (L+R)/2
                                            0101          Left         Left       1101        Left       (L+R)/2
                                            0110          Right        Left       1110        Right      (L+R)/2
                                            0111          (L+R)/2      Left       1111        (L+R)/2    (L+R)/2
    R8 (08h)     0    DMUTE          0      DAC Channel Soft Mute Enables:
    0001000                                           0: mute disabled
   DAC Mute                                           1: mute enabled
                                                                                            PD, Rev 4.2, July 2008
w
                                                                                                                39


WM8778                                                                                       Production Data
 REGISTER     BIT    LABEL    DEFAULT                             DESCRIPTION
  ADDRESS
   R9 (09h)    0    DEEMP        0    De-emphasis Mode Select:
   0001001                                     0 : Normal Mode
 DAC Control                                   1: De-emphasis Mode
              2:1    DZFM       00    DZFM                   ZFLAG1                      ZFLAG2
                                      00           disabled                 disabled
                                      01           left channels zero       right channels zero
                                      10           both channels zero       both channels zero
                                      11           either channel zero      either channel zero
  R10 (0Ah)   1:0 DACFMT[1:0]    10   DAC Interface Format Select:
   0001010                                   00: right justified mode
DAC Interface                                01: left justified mode
    Control                                  10: I2S mode
                                             11: DSP mode
               2    DACLRP       0    DACLRC Polarity or DSP Mode A or B Select
                                      Left Justified / Right Justified /  DSP Mode:
                                      I2S:                                0: Mode A
                                      0: Standard DACLRC Polarity         1: Mode B
                                      1: Inverted DACLRC Polarity
               3   DACBCP        0    DAC BITCLK Polarity:
                                              0: Normal – DIN and DACLRC sampled on rising edge of
                                              DACBCLK.
                                              1: Inverted - DIN and DACLRC sampled on falling edge of
                                              DACBCLK.
              5:4 DACWL[1:0]    10    DAC Input Word Length:
                                              00: 16-bit Mode
                                              01: 20-bit Mode
                                              10: 24-bit Mode
                                              11: 32-bit Mode (not supported in right justified mode)
  R11 (0Bh)   1:0 ADCFMT[1:0]    10   ADC Interface Format Select:
   0001011                                   00: right justified mode
ADC Interface                                01: left justified mode
    Control                                  10: I2S mode
                                             11: DSP mode
               2    ADCLRP       0    ADCLRC Polarity or DSP mode A or B select
                                      Left Justified / Right Justified / DSP Mode:
                                       2
                                      I S:                               0: Mode A
                                      0: Standard ADCLRC Polarity
                                                                         1: Mode B
                                      1: Inverted ADCLRC Polarity
               3   ADCBCP        0    ADC BITCLK Polarity:
                                              0: Normal - ADCLRC sampled on rising edge of
                                              ADCBCLK; DOUT changes on falling edge of ADCBCLK.
                                              1: Inverted - ADCLRC sampled on falling edge of
                                              ADCBCLK; DOUT changes on rising edge of ADCBCLK.
              5:4 ADCWL[1:0]    10    ADC Input Word Length:
                                              00: 16-bit Mode
                                              01: 20-bit Mode
                                              10: 24-bit Mode
                                              11: 32-bit Mode (not supported in right justified mode)
               6   ADCMCLK       0    ADCMCLK Polarity:
                                      0: non-inverted
                                      1: inverted
                                                                                    PD, Rev 4.2, July 2008
w
                                                                                                         40


Production Data                                                                                   WM8778
  REGISTER      BIT    LABEL     DEFAULT                              DESCRIPTION
   ADDRESS
                 8    ADCHPD         0    ADC Highpass Filter Disable:
                                                  0: Highpass Filter enabled
                                                  1: Highpass Filter disabled
   R12 (0Ch)    2:0 ADCRATE[2:0]    010   Master Mode ADCMCLK:ADCLRC Ratio Select:
    0001100                                       010: 256fs
  Master Mode                                     011: 384fs
     Control                                      100: 512fs
                                                  101: 768fs
                 3    ADCOSR         0    ADC Oversample Rate Select:
                                                  0: 128x oversampling
                                                  1: 64x oversapmling
                6:4 DACRATE[2:0]    010   Master Mode DACMCLK:DACLRC Ratio Select:
                                                  000: 128fs
                                                  001: 192fs
                                                  010: 256fs
                                                  011: 384fs
                                                  100: 512fs
                                                  101: 768fs
                 7     DACMS         0    DAC Maser/Slave Interface Mode Select:
                                          0: Slave Mode – DACLRC and DACBCLK are inputs
                                          1: Master Mode –DACLRC and DACBCLK are outputs
                 8     ADCMS         0    ADC Maser/Slave Interface Mode Select:
                                          0: Slave Mode – ADCLRC and ADCBCLK are inputs
                                          1: Master Mode – ADCLRC and ADCBCLK are outputs
   R13 (0Dh)     0     PDWN          0    Chip Powerdown Control (works in tandem with ADCPD and
    0001101                               DACPD):
  PWR Down                                          0: All circuits running, outputs are active
     Control                                        1: All circuits in power save mode, outputs muted
                 1     ADCPD         0    ADC Powerdown:
                                                    0: ADC enabled
                                                    1: ADC disabled
                 2     DACPD         0    DAC Powerdown:
                                                    0: DAC enabled
                                                    1: DAC disabled
                 6     AINPD         0    AINPD Powerdown:
                                                    0: ANALOGUE INPUT enabled
                                                     1: ANALOGUE INPUT disabled
   R14 (0Eh)    7:0   LAG[7:0]   11001111 Attenuation Data for Left Channel ADC Gain in 0.5dB Steps:
    0001110                        (0dB)  00000000 : digital mute
   Attenuation                            00000001 : -103dB
      ADCL                                ………..
                                          11001111 : 0dB
                                          …………
                                          11111110 : +23.5dB
                                          11111111 : +24dB
                 8      ZCLA         0    Left ADC Zero Cross Enable:
                                                    0: Zero cross disabled
                                                    1: Zero cross enabled
                                                                                         PD, Rev 4.2, July 2008
w
                                                                                                             41


WM8778                                                                                           Production Data
 REGISTER      BIT     LABEL       DEFAULT                               DESCRIPTION
 ADDRESS
 R15 (0Fh)     7:0    RAG[7:0]    11001111     Attenuation Data for Right Channel ADC Gain in 0.5dB Steps:
  0001111                             (0dB)    00000000 : digital mute
 Attenuation                                   00000001 : -103dB
    ADCR                                       ………..
                                               11001111 : 0dB
                                               …………
                                               11111110 : +23.5dB
                                               11111111 : +24dB
                 8     ZCRA             0      Right ADC Zero Cross Enable:
                                                         0: Zero cross disabled
                                                         1: Zero cross enabled
 R16 (10h)    3:0     LCT[3:0]        1011     Limiter Threshold/ALC Target Level in 1dB Steps:
  0010000                            (-5dB)    0000: -16dB FS
ALC Control 1                                  0001: -15dB FS
                                               …
                                               1101: -3dB FS
                                               1110: -2dB FS
                                               1111: -1dB FS
              6:4   MAXGAIN[2:0] 111 (+24dB)   Set Maximum Gain of PGA:
                                               111 : +24dB
                                               110 : +20dB
                                               ….(-4dB steps)
                                               010 : +4dB
                                               001 : 0dB
                                               000 : 0dB
                8:7  LCSEL[1:0]         00     ALC/Limiter Function Select:
                                    (Limiter)  00 = Limiter
                                               01 = ALC Right channel only
                                               10 = ALC Left channel only
                                               11 = ALC Stereo (PGA registers unused)
 R17 (11h)    3:0     HLD[3:0]        0000     ALC Hold Time Before Gain is Increased:
  0010001                            (OFF)     0000: OFF
ALC Control 2                                  0001: 2.67ms
                                               0010: 5.33ms
                                               … (time doubles with every step)
                                               1111: 43.691s
                 7     ALCZC     0 (zero cross ALC Uses Zero Cross Detection Circuit.
                                       off)
                 8     LCEN             0      Enable Gain Control Circuit.
                                               0 = Disable
                                               1 = Enable
                                                                                          PD, Rev 4.2, July 2008
w
                                                                                                              42


Production Data                                                                                         WM8778
  REGISTER      BIT    LABEL        DEFAULT                                 DESCRIPTION
   ADDRESS
   R18 (12h)    3:0   ATK[3:0]         0010      ALC/Limiter Attack (gain ramp-down) Time
    0011000                        (33ms/1ms)    ALC Mode                           Limiter Mode
 ALC Control 3                                   0000: 8.4ms                        0000: 250us
                                                 0001: 16.8ms                       0001: 500us…
                                                 0010: 33.6ms…                      0010: 1ms
                                                 (time doubles with every step)     (time doubles with every step)
                                                 1010 or higher: 8.6s               1010 or higher: 256ms
                7:4   DCY[3:0]         0011      ALC/Limiter Decay (gain ramp up) Time
                                     (268ms/     ALC Mode                           Limiter Mode
                                      9.6ms)     0000: 33.5ms                       0000: 1.2ms
                                                 0001: 67.2ms                       0001: 2.4ms
                                                 0010: 134.4ms ….(time              0010: 4.8ms ….(time doubles
                                                 doubles for every step)            for every step)
                                                 1010 or higher: 34.3ms             1010 or higher: 1.2288s
   R19 (13h)     0     NGAT              0       Noise Gate Enable (ALC only):
    0010011                                      0 : disabled
   Noise Gate                                    1 : enabled
     Control    4:2    NGTH            000       Noise Gate Threshold:
                                                 000: -78dBFS
                                                 001: -72dBfs
                                                 … 6 dB steps
                                                 110: -42dBFS
                                                 111: -36dBFS
   R20 (14h)    3:0  MAXATTEN          0110      Maximum Attenuation of PGA
    0010100             [3:0]                    Limiter                            ALC
     Limiter                                     (attenuation below static)         (lower PGA gain limit)
     Control                                     0011 or lower: -3dB                1010 or lower: -1dB
                                                 0100: -4dB                         1011 : -5dB
                                                 …. (-1dB steps)                    ….. (-4dB steps)
                                                 1100 or higher: -12dB              1110 : -17dB
                                                                                    1111 : -21dB
                6:4 TRANWIN [2:0]       010      Length of Transient Window:
                                                 000: 0us (disabled)
                                                 001: 62.5us
                                                 010: 125us
                                                 …..
                                                 111: 4ms
   R21 (15h)     6    MUTERA             0       Mute for Right Channel ADC:
    0010101                                                0: Mute off
    ADC Mux                                                1: Mute on
     Control     7    MUTELA             0       Mute for Left Channel ADC:
                                                           0: Mute off
                                                           1: Mute on
                 8    LRBOTH             0       Right Channel Input PGA Controlled by Left Channel Register:
                                                            0 : Right channel uses RAG and MUTERA.
                                                            1 : Right channel uses LAG and MUTELA.
   R22 (16h)     0    MXDAC              1       VOUT Output Select DAC (see Figure 22)
    0010110                           (DAC
  Output Mux                        playback)
                 2     MXBYP             0       VOUT Output Select Bypass Path.
                                  (not selected)
                                                                                              PD, Rev 4.2, July 2008
w
                                                                                                                   43


WM8778                                                                                   Production Data
 REGISTER   BIT  LABEL DEFAULT                                DESCRIPTION
 ADDRESS
 R23 (17h) [8:0] RESET Not reset Writing to this register will apply a reset to the device registers.
  0010111
  Software
   Reset
                                                                                  PD, Rev 4.2, July 2008
w
                                                                                                      44


Production Data                                                                                                                                                     WM8778
DIGITAL FILTER CHARACTERISTICS
        PARAMETER                                  TEST CONDITIONS               MIN                              TYP              MAX              UNIT
         ADC Filter
        Passband                                           ±0.01 dB               0                                             0.4535fs
                                                              -6dB                                                0.5fs
        Passband ripple                                                                                                           ±0.01               dB
        Stopband                                                               0.5465fs
        Stopband Attenuation                              f > 0.5465fs           -65                                                                  dB
        Group Delay                                                                                                22                                 fs
        DAC Filter
        Passband                                           ±0.05 dB                                                              0.454fs
                                                              -3dB                                            0.4892 fs
        Passband ripple                                                                                                           ±0.05               dB
        Stopband                                                               0.546fs
        Stopband Attenuation                              f > 0.546fs            -60                                                                  dB
        Group Delay                                                                                                19                                 fs
Table 15 Digital Filter Characteristics
DAC FILTER RESPONSES
                                                                                                       0.2
                  0
                                                                                                      0.15
                 -20
                                                                                                       0.1
                 -40                                                                                  0.05
Response (dB)                                                                         Response (dB)
                 -60                                                                                     0
                                                                                                      -0.05
                 -80
                                                                                                       -0.1
                -100
                                                                                                      -0.15
                -120                                                                                   -0.2
                       0   0.5     1         1.5          2          2.5   3                                  0    0.05   0.1   0.15   0.2   0.25   0.3    0.35   0.4   0.45   0.5
                                        Frequency (Fs)                                                                                  Frequency (Fs)
Figure 26 DAC Digital Filter Frequency Response – 44.1, 48                         Figure 27 DAC Digital Filter Ripple – 44.1, 48 and 96kHz
and 96kHz
                                                                                                       0.2
                  0
                                                                                                         0
                 -20
                                                                                                       -0.2
Response (dB)                                                                         Response (dB)
                 -40                                                                                   -0.4
                                                                                                       -0.6
                 -60
                                                                                                       -0.8
                 -80
                                                                                                         -1
                       0     0.2       0.4          0.6         0.8        1                                  0    0.05   0.1   0.15   0.2   0.25   0.3    0.35   0.4   0.45   0.5
                                        Frequency (Fs)                                                                                  Frequency (Fs)
Figure 28 DAC Digital Filter Frequency Response – 192kHz                           Figure 29 DAC Digital filter Ripple - 192kHz
                                                                                                                                                      PD, Rev 4.2, July 2008
w
                                                                                                                                                                                     45


WM8778                                                                                                                                                                               Production Data
ADC FILTER RESPONSES
                                                                                                                     0.02
                           0
                                                                                                                    0.015
                                                                                                                     0.01
                          -20
                                                                                                                    0.005
Response (dB)                                                                                       Response (dB)
                          -40                                                                                           0
                                                                                                                    -0.005
                          -60
                                                                                                                     -0.01
                                                                                                                    -0.015
                          -80
                                                                                                                     -0.02
                                0       0.5            1        1.5          2        2.5   3                                0   0.05   0.1   0.15   0.2   0.25   0.3   0.35   0.4   0.45   0.5
                                                           Frequency (Fs)                                                                             Frequency (Fs)
Figure 30 ADC Digital Filter Frequency Response                                                     Figure 31 ADC Digital Filter Ripple
ADC HIGH PASS FILTER
The WM8778 has a selectable digital highpass filter to remove DC offsets. The filter response is characterised by the
following polynomial.
                                                       H(z) =              1 - z-1
                                                                       1 - 0.9995z-1
                                0
                            -5
          Response (dB)
                           -10
                           -15
                                    0         0.0005            0.001            0.0015     0.002
                                                            Frequency (Fs)
Figure 32 ADC Highpass Filter Response
                                                                                                                                                                           PD, Rev 4.2, July 2008
w
                                                                                                                                                                                                  46


Production Data                                                                                                                                                             WM8778
DIGITAL DE-EMPHASIS CHARACTERISTICS
                 0                                                                                           1
                                                                                                           0.5
                 -2
                                                                                                             0
                                                                                                           -0.5
Response (dB)                                                                              Response (dB)
                 -4
                                                                                                            -1
                 -6
                                                                                                           -1.5
                                                                                                            -2
                 -8
                                                                                                           -2.5
                -10                                                                                         -3
                      0   2           4   6         8       10        12        14    16                          0   2           4   6         8       10        12        14    16
                                              Frequency (kHz)                                                                             Frequency (kHz)
Figure 33 De-Emphasis Frequency Response (32kHz)                                           Figure 34 De-Emphasis Error (32KHz)
                 0                                                                                         0.4
                                                                                                           0.3
                 -2
                                                                                                           0.2
                                                                                                           0.1
Response (dB)                                                                              Response (dB)
                 -4
                                                                                                             0
                 -6
                                                                                                           -0.1
                                                                                                           -0.2
                 -8
                                                                                                           -0.3
                -10                                                                                        -0.4
                      0           5              10              15              20                               0           5              10              15              20
                                              Frequency (kHz)                                                                             Frequency (kHz)
Figure 35 De-Emphasis Frequency Response (44.1KHz)                                         Figure 36 De-Emphasis Error (44.1KHz)
                 0                                                                                           1
                                                                                                           0.8
                 -2                                                                                        0.6
                                                                                                           0.4
Response (dB)                                                                              Response (dB)
                 -4                                                                                        0.2
                                                                                                             0
                 -6                                                                                        -0.2
                                                                                                           -0.4
                 -8                                                                                        -0.6
                                                                                                           -0.8
                -10                                                                                         -1
                      0       5                10           15             20                                     0       5                10           15             20
                                              Frequency (kHz)                                                                             Frequency (kHz)
Figure 37 De-Emphasis Frequency Response (48kHz)                                           Figure 38 De-Emphasis Error (48kHz)
                                                                                                                                                             PD, Rev 4.2, July 2008
w
                                                                                                                                                                                       47


WM8778                                     Production Data
APPLICATIONS INFORMATION
RECOMMENDED EXTERNAL COMPONENTS
Figure 39 External Component Diagram
                                     PD, Rev 4.2, July 2008
w
                                                         48


Production Data                                                                                           WM8778
                It is recommended that a low pass filter be applied to the output from the DAC for hi-fi applications.
                Typically a second order filter is suitable and provides sufficient attenuation of high frequency
                components (the unique low order, high bit count multi-bit sigma delta DAC structure used in
                WM8778 produces much less high frequency output noise). This filter is typically also used to
                provide the 2x gain needed to provide the standard 2Vrms output level from most consumer
                equipment. Figure 34 shows a suitable post DAC filter circuit, with 2x gain. Alternative inverting filter
                architectures might also be used with as good results.
                                                   4.7kΩ
                                                          4.7kΩ
                                                                      +VS
                                                                    _
                                                                                        51Ω
                            10uF
                                        1.8kΩ       7.5KΩ
                           +
                                                                    +
                                                                      -VS
                                                1.0nF           680pF
                                     10kΩ
                Figure 40 Recommended Post DAC Filter Circuit
                                                                                               PD, Rev 4.2, July 2008
w
                                                                                                                      49


WM8778                                                                                                           Production Data
PACKAGE DIMENSIONS
   DS: 28 PIN SSOP (10.2 x 5.3 x 1.75 mm)                                                                    DM007.E
                                 b                      e
                   28                                            15
                                                                        E1    E
                                                                                           GAUGE
                                                                                           PLANE   Θ
                    1                                            14
                                            D
                                                                                                        0.25
                                                                                                 c   L
   A A2     A1                                                                                       L1
                                                                         -C-
                                                                0.10 C
                                                                         SEATING PLANE
                                     Dimensions
   Symbols                                (mm)
                        MIN               NOM               MAX
     A                  -----              -----             2.0
     A1                 0.05               -----            0.25
     A2                 1.65               1.75             1.85
     b                  0.22               0.30             0.38
     c                  0.09               -----            0.25
     D                  9.90              10.20            10.50
     e                                 0.65 BSC
     E                  7.40               7.80             8.20
     E1                 5.00               5.30             5.60
     L                  0.55               0.75             0.95
     L1                                1.25 REF
                            o                 o                  o
     θ                    0                 4                  8
    REF:                        JEDEC.95, MO-150
NOTES:
A. ALL LINEAR DIMENSIONS ARE IN MILLIMETERS.
B. THIS DRAWING IS SUBJECT TO CHANGE WITHOUT NOTICE.
C. BODY DIMENSIONS DO NOT INCLUDE MOLD FLASH OR PROTRUSION, NOT TO EXCEED 0.20MM.
D. MEETS JEDEC.95 MO-150, VARIATION = AH. REFER TO THIS SPECIFICATION FOR FURTHER DETAILS.
                                                                                                           PD, Rev 4.2, July 2008
w
                                                                                                                               50


Production Data                                                                                                            WM8778
IMPORTANT NOTICE
Wolfson Microelectronics plc (“Wolfson”) products and services are sold subject to Wolfson’s terms and conditions of sale,
delivery and payment supplied at the time of order acknowledgement.
Wolfson warrants performance of its products to the specifications in effect at the date of shipment. Wolfson reserves the
right to make changes to its products and specifications or to discontinue any product or service without notice. Customers
should therefore obtain the latest version of relevant information from Wolfson to verify that the information is current.
Testing and other quality control techniques are utilised to the extent Wolfson deems necessary to support its warranty.
Specific testing of all parameters of each device is not necessarily performed unless required by law or regulation.
In order to minimise risks associated with customer applications, the customer must use adequate design and operating
safeguards to minimise inherent or procedural hazards. Wolfson is not liable for applications assistance or customer
product design. The customer is solely responsible for its selection and use of Wolfson products. Wolfson is not liable for
such selection or use nor for use of any circuitry other than circuitry entirely embodied in a Wolfson product.
Wolfson’s products are not intended for use in life support systems, appliances, nuclear systems or systems where
malfunction can reasonably be expected to result in personal injury, death or severe property or environmental damage.
Any use of products by the customer for such purposes is at the customer’s own risk.
Wolfson does not grant any licence (express or implied) under any patent right, copyright, mask work right or other
intellectual property right of Wolfson covering or relating to any combination, machine, or process in which its products or
services might be or are used. Any provision or publication of any third party’s products or services does not constitute
Wolfson’s approval, licence, warranty or endorsement thereof. Any third party trade marks contained in this document
belong to the respective third party owner.
Reproduction of information from Wolfson datasheets is permissible only if reproduction is without alteration and is
accompanied by all associated copyright, proprietary and other notices (including this notice) and conditions. Wolfson is
not liable for any unauthorised alteration of such information or for any reliance placed thereon.
Any representations made, warranties given, and/or liabilities accepted by any person which differ from those contained in
this datasheet or in Wolfson’s standard terms and conditions of sale, delivery and payment are made, given and/or
accepted at that person’s own risk. Wolfson is not liable for any such representations, warranties or liabilities or for any
reliance placed thereon by any person.
ADDRESS:
Wolfson Microelectronics plc
Westfield House
26 Westfield Road
Edinburgh
EH11 2QB
United Kingdom
Tel :: +44 (0)131 272 7000
Fax :: +44 (0)131 272 7001
Email :: sales@wolfsonmicro.com
                                                                                                                PD, Rev 4.2, July 2008
w
                                                                                                                                    51


Mouser Electronics
Authorized Distributor
Click to View Pricing, Inventory, Delivery & Lifecycle Information:
Cirrus Logic:
 WM8778SEDS/RV
