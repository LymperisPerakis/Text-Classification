                                                               USB3319
                                                    Hi-Speed USB Transceiver with
                                                    1.8V ULPI Interface - 13MHz
                                                    Reference Clock
PRODUCT FEATURES                                                                                           Datasheet
 USB-IF “Hi-Speed” compliant to the Universal Serial      Carkit UART mode for non-USB serial data transfers
  Bus Specification Rev 2.0                                Integrated USB Switch
 Interface compliant with the ULPI Specification           —   Allows single USB port of connection
  revision 1.1 as a Single Data Rate (SDR) PHY              —   High speed data
                                                            —   Battery charging
 1.8V IO Voltage (±10%)
                                                            —   Stereo and mono/mic audio
 flexPWR® Technology                                       —   USB1.1 data
  — Low current design ideal for battery powered
                                                           Industrial Operating Temperature -40°C to +85°C
      applications
  — “Sleep” mode tri-states all ULPI pins and places the   Packaging Options
      part in a low current state                           — 24 pin QFN lead-free RoHS compliant package
                                                                (4 x 4 x 0.90 mm height)
 Supports FS pre-amble for FS hubs with a LS device
                                                            — 25 ball VFBGA lead-free RoHS compliant package also
  attached (UTMI+ Level 3)                                      available; (3 x 3 x 0.88mm height)
 Supports HS SOF and LS keep-alive pulse
 Includes full support for the optional On-The-Go        Applications
  (OTG) protocol detailed in the On-The-Go
                                                          The USB3319 is targeted for any application where a Hi-
  Supplement Revision 2.0 specification
                                                          Speed USB connection is desired and when board
 Supports the OTG Host Negotiation Protocol (HNP)        space, power, and interface pins must be minimized.
  and Session Request Protocol (SRP)
 Allows host to turn VBUS off to conserve battery        The USB3319 is well suited for:
  power in OTG applications                                Cell Phones
 Support OTG monitoring of VBUS levels with internal      PDAs
  comparators                                              MP3 Players
 “Wrapper-less” design for optimal timing performance     GPS Personal Navigation
  and design ease
                                                           Scanners
  — Low Latency Hi-Speed Receiver (43 Hi-Speed clocks
      Max) allows use of legacy UTMI Links with a ULPI     External Hard Drives
      bridge                                               Digital Still and Video Cameras
 Internal 5V cable short-circuit protection of ID, DP     Portable Media Players
  and DM lines to VBUS or ground                           Entertainment Devices
 13MHz Reference Clock Operation                          Printers
  — 0 to 3.6V input drive tolerant
                                                           Set Top Boxes
  — Able to accept “noisy” clock sources
                                                           Video Record/Playback Systems
 Internal low jitter PLL for 480MHz Hi-Speed USB
  operation                                                IP and Video Phones
 Internal detection of the value of resistance to ground  Gaming Consoles
  on the ID pin                                            POS Terminals
 Integrated battery to 3.3V LDO regulator
  — 2.2uF bypass capacitor
  — 100mV dropout voltage
 Integrated ESD protection circuits
  — Up to ±15kV without any external devices
SMSC USB3319 REV C                                  DATASHEET                                  Revision 2.1 (06-10-10)


                                                                         Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
                                                                                                                                                                   Datasheet
                                                                         Order Number(s):
         USB3319C-CP-TR FOR 24 PIN, QFN LEAD-FREE ROHS COMPLIANT PACKAGE (TAPE AND REEL)
      USB3319C-GJ-TR FOR 25 PIN, VFBGA LEAD-FREE ROHS COMPLIANT PACKAGE (TAPE AND REEL)
                                                                     REEL SIZE IS 4000 PIECES.
                      This product meets the halogen maximum concentration values per IEC61249-2-21
                  For RoHS compliance and environmental information, please visit www.smsc.com/rohs
80 ARKAY DRIVE, HAUPPAUGE, NY 11788 (631) 435-6000, FAX (631) 273-3123
Copyright © 2010 SMSC or its subsidiaries. All rights reserved.
Circuit diagrams and other information relating to SMSC products are included as a means of illustrating typical applications. Consequently, complete information sufficient for
construction purposes is not necessarily given. Although the information has been checked and is believed to be accurate, no responsibility is assumed for inaccuracies. SMSC
reserves the right to make changes to specifications and product descriptions at any time without notice. Contact your local SMSC sales office to obtain the latest specifications
before placing your product order. The provision of this information does not convey to the purchaser of the described semiconductor devices any licenses under any patent
rights or other intellectual property rights of SMSC or others. All sales are expressly conditional on your agreement to the terms and conditions of the most recently dated
version of SMSC's standard Terms of Sale Agreement dated before the date of your order (the "Terms of Sale Agreement"). The product may contain design defects or errors
known as anomalies which may cause the product's functions to deviate from published specifications. Anomaly sheets are available upon request. SMSC products are not
designed, intended, authorized or warranted for use in any life support or other application where product failure could cause or contribute to personal injury or severe property
damage. Any and all such uses without prior written approval of an Officer of SMSC and further testing and/or modification will be fully at the risk of the customer. Copies of
this document or other SMSC literature, as well as the Terms of Sale Agreement, may be obtained by visiting SMSC’s website at http://www.smsc.com. SMSC is a registered
trademark of Standard Microsystems Corporation (“SMSC”). Product names and company names are the trademarks of their respective holders.
SMSC DISCLAIMS AND EXCLUDES ANY AND ALL WARRANTIES, INCLUDING WITHOUT LIMITATION ANY AND ALL IMPLIED WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE, TITLE, AND AGAINST INFRINGEMENT AND THE LIKE, AND ANY AND ALL WARRANTIES ARISING FROM ANY COURSE
OF DEALING OR USAGE OF TRADE. IN NO EVENT SHALL SMSC BE LIABLE FOR ANY DIRECT, INCIDENTAL, INDIRECT, SPECIAL, PUNITIVE, OR CONSEQUENTIAL
DAMAGES; OR FOR LOST DATA, PROFITS, SAVINGS OR REVENUES OF ANY KIND; REGARDLESS OF THE FORM OF ACTION, WHETHER BASED ON CONTRACT;
TORT; NEGLIGENCE OF SMSC OR OTHERS; STRICT LIABILITY; BREACH OF WARRANTY; OR OTHERWISE; WHETHER OR NOT ANY REMEDY OF BUYER IS HELD
TO HAVE FAILED OF ITS ESSENTIAL PURPOSE, AND WHETHER OR NOT SMSC HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.
Revision 2.1 (06-10-10)                                                                 2                                                        SMSC USB3319 REV C
                                                                           DATASHEET


Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
Datasheet
0.1           Reference Documents
                Universal Serial Bus Specification, Revision 2.0, April 27, 2000
                On-The-Go Supplement to the USB 2.0 Specification, Revision 2.0, May 8, 2009
                27% Resistor ECN
                USB 2.0 Transceiver Macrocell Interface (UTMI) Specification, Version 1.02, May 27, 2000
                UTMI+ Specification, Revision 1.0, February 2, 2004
                UTMI+ Low Pin Interface (ULPI) Specification, Revision 1.1, October 20, 2004
                Technical Requirements and Test Methods of Charger and Interface for Mobile Telecommunication
                 Terminal Equipment (Chinese Charger Specification Approval Draft 11/29/2006)
SMSC USB3319 REV C                                           3                               Revision 2.1 (06-10-10)
                                                      DATASHEET


                                                           Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
                                                                                                                                               Datasheet
Table of Contents
0.1     Reference Documents . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3
Chapter 1 General Description . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 8
Chapter 2 USB3319 Pin Locations and Definitions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10
2.1     USB3319 Pin Locations and Descriptions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10
        2.1.1       Package Diagram with Pin Locations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10
        2.1.2       Pin Definitions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11
Chapter 3 Limiting Values . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13
3.1     Absolute Maximum Ratings . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13
3.2     Recommended Operating Conditions. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14
Chapter 4 Electrical Characteristics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15
4.1     Operating Current . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .     15
4.2     CLKOUT Specifications . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .           16
4.3     ULPI Interface Timing . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .       16
4.4     Digital IO Pins . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 16
4.5     DC Characteristics: Analog I/O Pins. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                17
4.6     Dynamic Characteristics: Analog I/O Pins . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                    18
4.7     OTG Electrical Characteristics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .            19
4.8     USB Audio Switch Characteristics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                20
4.9     Regulator Output Voltages and Capacitor Requirement . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                               20
Chapter 5 Architecture Overview . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21
5.1     ULPI Digital Operation and Interface . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                21
5.2     Interface to DP/DM . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .      21
        5.2.1       USB Transceiver . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .         21
        5.2.2       Termination Resistors . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .           22
5.3     Bias Generator . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .    24
5.4     Integrated Low Jitter PLL . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .         24
        5.4.1       Reference Clock Requirements. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                   24
5.5     Internal Regulators and POR . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .             25
        5.5.1       Integrated Low Dropout Regulator . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                    25
        5.5.2       Power On Reset (POR) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .              26
        5.5.3       Recommended Power Supply Sequence . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                             27
        5.5.4       Start-Up . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .  27
5.6     USB On-The-Go (OTG) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .             28
        5.6.1       ID Resistor Detection. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .          29
        5.6.2       VBUS Monitor and Pulsing . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                31
        5.6.3       Driving External Vbus . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .           33
5.7     USB UART Support . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .          34
5.8     USB Charger Detection Support. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                34
5.9     USB Audio Support. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .        34
Chapter 6 ULPI Operation Overview . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 36
6.1     Overview. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 36
        6.1.1       ULPI Interface Signals . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .          37
        6.1.2       ULPI Interface Timing in Synchronous Mode . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                           38
6.2     ULPI Register Access. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .         38
        6.2.1       ULPI Register Write . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .         39
        6.2.2       ULPI Register Read. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .           41
Revision 2.1 (06-10-10)                                                  4                                                     SMSC USB3319 REV C
                                                             DATASHEET


Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
Datasheet
       6.2.3     ULPI RXCMD . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .          42
       6.2.4     USB3319 Transmitter . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .             43
       6.2.5     USB Receiver . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .        45
       6.2.6     Low Power Mode . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .          46
6.3    Full Speed/Low Speed Serial Modes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                 49
6.4    Carkit Mode . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 51
       6.4.1     USB UART Mode . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .             51
       6.4.2     USB Audio Mode . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .          52
6.5    RID Converter Operation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .         52
6.6    Headset Audio Mode . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .        52
Chapter 7 ULPI Register Map . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 54
7.1    ULPI Register Array . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .     54
       7.1.1     ULPI Register Set . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .         55
       7.1.2     Carkit Control Registers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .            60
       7.1.3     Extended Register Access . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                62
       7.1.4     Vendor Register Access . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .              62
Chapter 8 Application Notes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 65
8.1    Application Diagram . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .     65
8.2    USB Charger Detection . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .         69
       8.2.1     Detecting the ID Resistor in a Charger . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                    69
       8.2.2     Detecting DP Shorted to DM . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                70
8.3    Reference Designs . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .     70
8.4    ESD Performance. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .      70
       8.4.1      Human Body Model (HBM) Performance . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                           70
       8.4.2     EN/IEC 61000-4-2 Performance . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                    70
       8.4.3     Air Discharge . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .     71
       8.4.4     Contact Discharge . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .         71
Chapter 9 Package Outline, Tape & Reel Drawings, Package Markings . . . . . . . . . . . . . 72
Chapter 10 Datasheet Revision History . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 78
SMSC USB3319 REV C                                                    5                                                      Revision 2.1 (06-10-10)
                                                          DATASHEET


                                                    Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
                                                                                                                                        Datasheet
List of Figures
Figure 1.1     USB3319 Block Diagram . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 8
Figure 2.1     USB3319 QFN Pinout - Top View . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10
Figure 2.2     USB3319 VFBGA Pinout - Top View . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10
Figure 5.1     USB3319 System Diagram . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21
Figure 5.2     Example of circuit used to shift a reference clock common-mode voltage level. . . . . . . . . . . 24
Figure 5.3     Powering the USB3319 from a Battery . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25
Figure 5.4     Powering the USB3319 from a 3.3V Supply . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26
Figure 5.5     Powering the USB3319 from the USB Cable Vbus . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26
Figure 5.6     ULPI Start-up Timing . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28
Figure 5.7     USB3319 ID Resistor Detection Circuitry. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29
Figure 5.8     USB3319 OTG Vbus Block . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31
Figure 5.9     OTG Link Controller Drives External Vbus Supply or Switch. . . . . . . . . . . . . . . . . . . . . . . . . 33
Figure 6.1     ULPI Digital Block Diagram . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 36
Figure 6.2     ULPI Single Data Rate Timing Diagram in Synchronous Mode. . . . . . . . . . . . . . . . . . . . . . . 38
Figure 6.3     ULPI Register Write in Synchronous Mode . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 39
Figure 6.4     ULPI Extended Register Write in Synchronous Mode . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 40
Figure 6.5     ULPI Register Read in Synchronous Mode . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 41
Figure 6.6     ULPI Extended Register Read in Synchronous Mode . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 42
Figure 6.7     ULPI Transmit in Synchronous Mode . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 45
Figure 6.8     ULPI Receive in Synchronous Mode . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 46
Figure 6.9     Entering Low Power Mode from Synchronous Mode. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 47
Figure 6.10    Exiting Low Power Mode . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 48
Figure 8.1     USB3319 QFN Application Diagram (Device) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 66
Figure 8.2     USB3319 BGA Application Diagram (Device) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 67
Figure 8.3     USB3319 QFN Application Diagram (Host or OTG) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 68
Figure 8.4     USB3319 BGA Application Diagram (Host or OTG) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 69
Figure 9.1     24-pin QFN, 4x4mm Body, 0.5mm Pitch . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 72
Figure 9.2     QFN, 4x4 Tape & Reel. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 73
Figure 9.3     25-Pin VFBGA, 3x3mm Body, 0.5mm Pitch. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 74
Figure 9.4     VFBGA, 3x3 Tape & Reel . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 75
Figure 9.5     Reel Dimensions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 76
Figure 9.6     QFN, 4x4 Package Marking . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 77
Figure 9.7     VFBGA, 3x3 Package Marking . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 77
Revision 2.1 (06-10-10)                                           6                                                     SMSC USB3319 REV C
                                                      DATASHEET


Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
Datasheet
List of Tables
Table 2.1   USB3319 Pin Description . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11
Table 3.1   Absolute Maximum Ratings . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13
Table 3.2   Recommended Operating Conditions. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14
Table 4.1   Electrical Characteristics: Operating Current . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15
Table 4.2   Electrical Characteristics: CLKOUT Specifications. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 16
Table 4.3   ULPI Interface Timing . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 16
Table 4.4   Digital IO Characteristics: RESETB, CLKOUT, STP, DIR, NXT, DATA[7:0] & REFCLK Pins . . . . . . . . . 16
Table 4.5   DC Characteristics: Analog I/O Pins (DP/DM) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17
Table 4.6   Dynamic Characteristics: Analog I/O Pins (DP/DM) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18
Table 4.7   OTG Electrical Characteristics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19
Table 4.8   USB Audio Switch Characteristics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20
Table 4.9   Regulator Output Voltages and Capacitor Requirement . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20
Table 4.10  ESD and LATCH-UP Performance . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20
Table 5.1   DP/DM Termination vs. Signaling Mode . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 22
Table 5.2   Operating Mode vs. Power Supply Configuration . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 27
Table 5.3   Valid Values of ID Resistance to Ground . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30
Table 5.4   IdGnd and IdFloat vs. ID Resistance to Ground . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30
Table 5.5   External Vbus Indicator Logic . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 32
Table 5.6   USB Weak Pull-up Enable . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34
Table 5.7   USB Audio Switch Enable . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34
Table 6.1   ULPI Interface Signals . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 37
Table 6.2   ULPI TXD CMD Byte Encoding . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 39
Table 6.3   ULPI RX CMD Encoding. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 43
Table 6.4   Interface Signal Mapping During Low Power Mode . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 47
Table 6.5   Pin Definitions in 3 pin Serial Mode . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 50
Table 6.6   Pin Definitions in 6 pin Serial Mode . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 50
Table 6.7   Pin Definitions in Carkit Mode. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 51
Table 6.8   Pin Definitions in Headset Audio Mode . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 52
Table 7.1   ULPI Register Map . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 54
Table 8.1   Component Values in Application Diagrams . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 65
Table 8.2   Capacitance Values at VBUS of USB Connector . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 65
Table 10.1   Customer Revision History . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 78
SMSC USB3319 REV C                                                     7                                                             Revision 2.1 (06-10-10)
                                                          DATASHEET


                                                        Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
                                                                                                                     Datasheet
Chapter 1 General Description
               The USB3319 is a highly integrated Hi-Speed USB 2.0 Transceiver (PHY) that supports systems
               architectures based on a 13MHz reference clock. It is designed to be used in both commercial and
               industrial temperature applications.
               The USB3319 meets all of the electrical requirements to be used as a Hi-Speed USB Host, Device,
               or an On-the-Go (OTG) device. In addition to the supporting USB signaling the USB3319 also provides
               USB UART mode and USB Audio mode.
               USB3319 uses the industry standard UTMI+ Low Pin Interface (ULPI) to connect the USB PHY to the
               Link. The industry standard ULPI interface uses a method of in-band signaling and status byte transfers
               between the Link and PHY, to facilitate a USB session. By using in-band signaling and status byte
               transfers the ULPI interface requires only 12 pins.
               The USB3319 uses SMSC’s “wrapper-less” technology to implement the ULPI interface. This “wrapper-
               less” technology allows the PHY to achieve a low latency transmit and receive time. SMSC’s low
               latency transceiver allows an existing UTMI Link to be reused by adding a UTMI to ULPI bridge. By
               adding a bridge to the ASIC the existing and proven UTMI Link IP can be reused.
                                                                  REFCLK
 VBUS                                                             Low Jitter                     BIAS               RBIAS
                                    OTG                           Integrated
                ESD Protection
      ID
                                                                     PLL
                                                                                                                    RESETB
                                                                                             Integrated
                                                                                               Power                VBAT
     DP                           Hi-Speed
                                                                                                                    VDD33
                                    USB                                                     Management              VDD18
     DM                          Transceiver                        ULPI
                                                                  Registers
                                                                  and State                                         STP
                                                                  Machine                        ULPI               NXT
                                                                                               Interface            DIR
                                   Carkit                                                                           CLKOUT
                                            SPKR_R/M
                                   SPKR_L
                                                                                               DATA[7:0]
                                                  Figure 1.1 USB3319 Block Diagram
               The USB3319 is designed to run with a 13MHz reference clock. By using a reference clock from the
               Link the USB3319 is able to remove the cost of a crystal reference from the design.
Revision 2.1 (06-10-10)                                           8                                       SMSC USB3319 REV C
                                                          DATASHEET


Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
Datasheet
              The USB3319 includes a integrated 3.3V LDO regulator to generate its own supply from power applied
              at the VBAT pin. The voltage on the VBAT pin can range from 3.1 to 5.5V. The regulator dropout
              voltage is less than 100mV which allows the PHY to continue USB signaling when the voltage on
              VBAT drops to 3.1V. The USB transceiver will continue to operate at lower voltages, although some
              parameters may be outside the limits of the USB specifications. If the user would like to provide a 3.3V
              supply to the USB3319, the VBAT and VDD33 pins should be connected together as described in
              Section 5.5.1.
              The USB3319 also includes integrated pull-up resistors that can be used for detecting the attachment
              of a USB Charger. By sensing the attachment to a USB Charger, a product using the USB3319 can
              charge its battery at more than the 500mA allowed when charging from a USB Host as described in
              Section 8.2.
              The USB3319 also includes support for USB audio modes. The user can program the PHY into UART
              or audio mode while in synchronous mode.
              In USB UART mode, the USB3319 DP and DM pins are redefined to enable pass-through of
              asynchronous serial data. The USB3319 can only enter UART mode when the user programs the part
              into this mode, as described in Section 6.4.1.
              In USB audio mode, the DP pin is shorted to the SPKR_R/M pin with a switch. The DM pin is shorted
              to the SPKR_L pin. These switches are on when the RESETB pin of the USB3319 is asserted. Audio
              signals may be transferred over the USB cable as described in Section 6.4.2. In addition to audio
              signals, the switches can also be used to connect Full Speed USB from another PHY onto the USB
              cable.
SMSC USB3319 REV C                                           9                                   Revision 2.1 (06-10-10)
                                                      DATASHEET


                                                        Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
                                                                                                                               Datasheet
Chapter 2 USB3319 Pin Locations and Definitions
2.1             USB3319 Pin Locations and Descriptions
2.1.1          Package Diagram with Pin Locations
               The pinout below is viewed from the top of the package.
                                             RBIAS       REFCLK   RESETB   VDD1.8   STP     DIR
                                             24          23       22       21       20      19
                                  ID    1                                                           18       NXT
                               VBUS     2                                                           17       DATA0
                               VBAT     3                 24Pin QFN                                 16       DATA1
                             VDD3.3     4                  4x4mm                                    15       DATA2
                                 DM     5                                                           14       DATA3
                                 DP     6                                                           13       CLKOUT
                                             7           8        9        10       11      12
                                             SPKR_R/M
                                                         SPKR_L   DATA7    DATA6    DATA5   DATA4
                                  Figure 2.1 USB3319 QFN Pinout - Top View
                                         1                 2               3                4            5
                                   A
                                   B
                                   C
                                   D
                                   E
                                                                  TOP VIEW
                                 Figure 2.2 USB3319 VFBGA Pinout - Top View
Revision 2.1 (06-10-10)                                                    10                                         SMSC USB3319 REV C
                                                          DATASHEET


Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
Datasheet
2.1.2         Pin Definitions
              The following table details the pin definitions for the figure above.
                                          Table 2.1 USB3319 Pin Description
    PIN/                                          DIRECTION/      ACTIVE
   BALL                  NAME                         TYPE         LEVEL                   DESCRIPTION
      1                     ID                        Input,        N/A      ID pin of the USB cable. For non-OTG
     B1                                               Analog                 applications this pin can be floated. For
                                                                             an A-Device ID is grounded. For a B-
                                                                             Device ID is floated.
      2                   VBUS                         I/O,         N/A      VBUS pin of the USB cable. This pin is
     C1                                               Analog                 used for the Vbus comparator inputs and
                                                                             for Vbus pulsing during session request
                                                                             protocol.
      3                   VBAT                        Power         N/A      Regulator input. The regulator supply can
     C2                                                                      be from 5.5V to 3.1V.
      4                  VDD3.3                       Power         N/A      3.3V Regulator Output. A 2.2uF (<1 ohm
     D2                                                                      ESR) bypass capacitor to ground is
                                                                             required for regulator stability. The
                                                                             bypass capacitor should be placed as
                                                                             close as possible to the USB3319.
      5                     DM                         I/O,         N/A      D- pin of the USB cable.
     D1                                               Analog
      6                     DP                         I/O,         N/A      D+ pin of the USB cable.
     E1                                               Analog
      7               SPKR_R/M                         I/O,         N/A      USB switch in/out for DP signals
     E2                                               Analog
      8                 SPKR_L                         I/O,         N/A      USB switch in/out for DM signals
     E3                                               Analog
      9                 DATA[7]                        I/O,         N/A      ULPI bi-directional data bus. DATA[7] is
     D3                                               CMOS                   the MSB.
     10                 DATA[6]                        I/O,         N/A      ULPI bi-directional data bus.
     E4                                               CMOS
     11                 DATA[5]                        I/O,         N/A      ULPI bi-directional data bus.
     D4                                               CMOS
     12                 DATA[4]                        I/O,         N/A      ULPI bi-directional data bus.
     E5                                               CMOS
     13                 CLKOUT                        Output,       N/A      60MHz reference clock output. All ULPI
     D5                                               CMOS                   signals are driven synchronous to the
                                                                             rising edge of this clock.
                                                                             The system must not drive voltage on the
                                                                             CLKOUT pin following POR or hardware
                                                                             reset that exceeds the value of VIH_ED
                                                                             provided in Table 4.4.
     14                 DATA[3]                        I/O,         N/A      ULPI bi-directional data bus.
     C4                                               CMOS
SMSC USB3319 REV C                                            11                                    Revision 2.1 (06-10-10)
                                                      DATASHEET


                                             Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
                                                                                                           Datasheet
                                Table 2.1 USB3319 Pin Description (continued)
   PIN/                                     DIRECTION/      ACTIVE
  BALL                   NAME                   TYPE        LEVEL                       DESCRIPTION
     15                 DATA[2]                  I/O,         N/A        ULPI bi-directional data bus.
    C5                                         CMOS
     16                 DATA[1]                  I/O,         N/A        ULPI bi-directional data bus.
    B4                                         CMOS
     17                 DATA[0]                  I/O,         N/A        ULPI bi-directional data bus. DATA[0] is
    B5                                         CMOS                      the LSB.
     18                   NXT                  Output,        High       The PHY asserts NXT to throttle the data.
    A5                                         CMOS                      When the Link is sending data to the
                                                                         PHY, NXT indicates when the current
                                                                         byte has been accepted by the PHY. The
                                                                         Link places the next byte on the data bus
                                                                         in the following clock cycle.
     19                   DIR                  Output,        N/A        Controls the direction of the data bus.
    A4                                         CMOS                      When the PHY has data to transfer to the
                                                                         Link, it drives DIR high to take ownership
                                                                         of the bus. When the PHY has no data to
                                                                         transfer it drives DIR low and monitors
                                                                         the bus for commands from the Link.
     20                   STP                   Input,        High       The Link asserts STP for one clock cycle
    A3                                         CMOS                      to stop the data stream currently on the
                                                                         bus. If the Link is sending data to the
                                                                         PHY, STP indicates the last byte of data
                                                                         was on the bus in the previous cycle.
     21                 VDD1.8                  Power         N/A        External 1.8V Supply input pin. This pad
    B3                                                                   needs to be bypassed with a 0.1uF
                                                                         capacitor to ground, placed as close as
                                                                         possible to the USB3319.
     22                 RESETB                  Input,        Low        When low, the part is suspended with all
    B2                                         CMOS,                     of the I/O tri-stated. When high the
                                                                         USB3319 will operate as a normal ULPI
                                                                         device.
     23                 REFCLK                  Input,        N/A        13MHz Reference Clock input.
    A2                                         CMOS
     24                  RBIAS                Analog,         N/A        Bias Resistor pin. This pin requires an
    A1                                         CMOS                      8.06kΩ (±1%) resistor to ground, placed
                                                                         as close as possible to the USB3319.
  FLAG                    GND                  Ground         N/A        Ground.
    C3                                                                   QFN only: The flag should be connected
                                                                         to the ground plane with a via array
                                                                         under the exposed flag. This is the main
                                                                         ground for the IC.
Revision 2.1 (06-10-10)                                12                                        SMSC USB3319 REV C
                                               DATASHEET


Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
Datasheet
Chapter 3 Limiting Values
3.1           Absolute Maximum Ratings
                                         Table 3.1 Absolute Maximum Ratings
       PARAMETER                 SYMBOL                 CONDITIONS        MIN   TYP         MAX          UNITS
 Maximum VBUS, VBAT,           VMAX_5V                                    -0.5              +6.0        V
 ID, DP, DM, SPKR_L, and
 SPKR_R/M voltage to
 GND
 Maximum VDD18 voltage         VMAX_1.8V                                  -0.5               2.5        V
 to Ground
 Maximum VDD33 voltage         VMAX_3.3V                                  -0.5               4.0        V
 to Ground
 Maximum I/O voltage to        VMAX_IN                                    -0.5          VDD18 + 0.7     V
 Ground
 VFBGA Package                                                                  244                     °C/W
 Junction to Ambient (θJA)
 VFBGA Package                                                                  132                     °C/W
 Junction to Case (θJC)
 Operating Temperature         TMAX_OP                                    -40                85         C
 Storage Temperature           TMAX_STG                                   -55               150         C
              Note: Stresses beyond those listed under “Absolute Maximum Ratings” may cause permanent
                      damage to the device. Exposure to absolute maximum rating conditions for extended periods
                      may affect device reliability.
SMSC USB3319 REV C                                          13                             Revision 2.1 (06-10-10)
                                                      DATASHEET


                                            Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
                                                                                                          Datasheet
3.2             Recommended Operating Conditions
                               Table 3.2 Recommended Operating Conditions
       PARAMETER           SYMBOL               CONDITIONS               MIN         TYP          MAX       UNITS
 VBAT to GND              VVBAT                                       3.1                       5.5         V
 VDD33 to GND             VDD33                                       3.0        3.3            3.6         V
 VDD18 to GND             VDD18                                       1.6        1.8            2.0         V
 Input Voltage on Digital VI                                          0.0                       VDD18       V
 Pins (RESETB, STP,
 DIR, NXT, DATA[7:0])
 Voltage on Analog I/O    VI(I/O)                                     0.0                       VDD33       V
 Pins (DP, DM, ID,
 SPKR_L, SPKR_R/M)
 VBUS to GND              VVMAX                                       0.0                       5.5         V
 Ambient Temperature      TA                                          -40                       85          C
Revision 2.1 (06-10-10)                               14                                        SMSC USB3319 REV C
                                              DATASHEET


Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
Datasheet
Chapter 4 Electrical Characteristics
              The following conditions are assumed unless otherwise specified:
              VVBAT = 3.1 to 5.5V; VDD18 = 1.6 to 2.0V; VSS = 0V; TA = -40C to +85C
              The current for 3.3V circuits is sourced at the VBAT pin, except when using an external 3.3V supply
              as shown in Figure 5.4.
4.1           Operating Current
                               Table 4.1 Electrical Characteristics: Operating Current
         PARAMETER                   SYMBOL                  CONDITIONS         MIN     TYP      MAX       UNITS
 Synchronous Mode Current          I33AVG(SYNC)       Start-up sequence defined  5.0     5.5      8.0      mA
 (Default Configuration)                              in Section 5.5.4 has
                                   I18AVG(SYNC)       completed.                20.0    25.0     31.0      mA
 Synchronous Mode Current          I33AVG(HS)         Active USB Transfer        7.0    10.0     14.0      mA
 (HS USB operation)
                                   I18AVG(HS)                                   25.5    31.0     38.0      mA
 Synchronous Mode Current          I33AVG(FS)         Active USB Transfer        5.0     8.5     13.0      mA
 (FS/LS USB operation)
                                   I18AVG(FS)                                   21.5    25.0     31.0      mA
 Serial Mode Current               I33AVG(FS_S)                                  5.0     5.5      7.0      mA
 (FS/LS USB)
                                   I18AVG(FS_S)                                  1.5     2.2      3.5      mA
 Note 4.1
 USB UART Current                  I33AVG(UART)                                  5.0     5.5      7.0      mA
 Note 4.1                          I18AVG(UART)                                  1.4     2.1      3.5      mA
 USB Switched Mode                 I33AVG(AUDIO)                                14.0    20.0     35.0      uA
                                   I18AVG(AUDIO)                                         0.3      7.0      uA
 Low Power Mode                    IDD33(LPM)         VVBAT = 4.2V              14.0    20.0     25.0      uA
                                                      VDD18 = 1.8V
 Note 4.2Note 4.1                  IDD18(LPM)                                            0.3     11.5      uA
 Standby ModeNote 4.1              IDD33(RSTB)        RESETB = 0                14.0    20.0     25.0      uA
                                                      VVBAT = 4.2V
                                   IDD18(RSTB)        VDD18 = 1.8V                       0.3     11.5      uA
              Note 4.1     ClockSuspendM bit = 0.
              Note 4.2     SessEnd, VbusVld, and IdFloat comparators disabled. STP Interface protection disabled.
SMSC USB3319 REV C                                            15                             Revision 2.1 (06-10-10)
                                                      DATASHEET


                                                  Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
                                                                                                                 Datasheet
4.2             CLKOUT Specifications
                          Table 4.2 Electrical Characteristics: CLKOUT Specifications
           PARAMETER                  SYMBOL             CONDITIONS                MIN        TYP        MAX       UNITS
 Suspend Recovery Time                  TSTART                                                2.07        3.32       ms
 Note 4.3
 CLKOUT Duty Cycle                    DCCLKOUT                                      45                     55        %
 REFCLK Duty Cycle                    DCREFCLK                                      20                     80        %
 REFCLK Frequency Accuracy             FREFCLK                                     -500                  +500       PPM
                Note 4.3  The USB3319 uses the AutoResume feature, Section 5.4, to allow a host start-up time of
                          less than 1ms
4.3             ULPI Interface Timing
                                            Table 4.3 ULPI Interface Timing
                     PARAMETER                             SYMBOL                MIN                MAX           UNITS
 Setup time (STP, data in)                                  TSC, TSD              5.0                               nS
 Hold time (STP, data in)                                  THC, THD               0.0                               nS
 Output delay (control out, 8-bit data out)                TDC, TDD               1.5                3.5            nS
                Note: VDD18 = 1.6 to 2.0V; VSS = 0V; TA = -40C to 85C; CLoad = 10pF.
4.4             Digital IO Pins
       Table 4.4 Digital IO Characteristics: RESETB, CLKOUT, STP, DIR, NXT, DATA[7:0] & REFCLK Pins
         PARAMETER                 SYMBOL               CONDITIONS                  MIN       TYP        MAX       UNITS
 Low-Level Input Voltage          VIL                                                VSS                 0.4 *     V
                                                                                                         VDD18
 High-Level Input Voltage         VIH                                              0.68 *                VDD18     V
                                                                                   VDD18
 High-Level Input Voltage         VIH                                              0.68 *                VDD33     V
 REFCLK only                                                                       VDD18
 Clock High                       THIGH                                             0.3 *     0.5 *     0.7 * TP
 REFCLK only                                                                         TP         TP
 Clock Low                        TLOW                                              0.3 *     0.5 *     0.7 * TP
 REFCLK only                                                                         TP         TP
 Low-Level Output Voltage         VOL            IOL = 8mA                                                 0.4     V
 High-Level Output Voltage        VOH            IOH = -8mA                        VDD18                           V
                                                                                    - 0.4
 Input Leakage Current            ILI                                                                     ±10      uA
 Pin Capacitance                  Cpin                                                                      4      pF
Revision 2.1 (06-10-10)                                     16                                        SMSC USB3319 REV C
                                                    DATASHEET


Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
Datasheet
Table 4.4 Digital IO Characteristics: RESETB, CLKOUT, STP, DIR, NXT, DATA[7:0] & REFCLK Pins (continued)
         PARAMETER                 SYMBOL                  CONDITIONS               MIN  TYP   MAX          UNITS
 STP pull-up resistance            RSTP            InterfaceProtectDisable = 0       51   60     65        kΩ
 DATA[7:0] pull-dn                 RDATA_PD        ULPI Synchronous Mode             55   67     79        kΩ
 resistance
 CLKOUT External Drive             VIH_ED          At start-up or following reset               0.4 *      V
                                                                                               VDD18
4.5            DC Characteristics: Analog I/O Pins
                               Table 4.5 DC Characteristics: Analog I/O Pins (DP/DM)
         PARAMETER                   SYMBOL                 CONDITIONS              MIN TYP   MAX         UNITS
 LS/FS FUNCTIONALITY
 Input levels
 Differential Receiver Input        VDIFS            | V(DP) - V(DM) |            0.2                   V
 Sensitivity
 Differential Receiver              VCMFS                                         0.8        2.5        V
 Common-Mode Voltage
 Single-Ended Receiver Low          VILSE            Note 4.5                                0.8        V
 Level Input Voltage
 Single-Ended Receiver High         VIHSE            Note 4.5                     2.0                   V
 Level Input Voltage
 Single-Ended Receiver              VHYSSE                                        0.050      0.150      V
 Hysteresis
 Output Levels
 Low Level Output Voltage           VFSOL            Pull-up resistor on DP;                 0.3        V
                                                     RL = 1.5kΩ to VDD33
 High Level Output Voltage          VFSOH            Pull-down resistor on DP,    2.8        3.6        V
                                                     DM; Note 4.5
                                                     RL = 15kΩ to GND
 Termination
 Driver Output Impedance for        ZHSDRV           Steady state drive           40.5  45   49.5       Ω
 HS and FS
 Input Impedance                    ZINP             RX, RPU, RPD disabled        1.0                   MΩ
 Pull-up Resistor Impedance         RPU              Bus Idle, Note 4.4           0.900 1.24 1.575      kΩ
 Pull-up Resistor Impedance         RPU              Device Receiving,            1.425 2.26 3.09       kΩ
                                                     Note 4.4
 Pull-dn Resistor Impedance         RPD              Note 4.4                     14.25 16.9 20         kΩ
 Weak Pull-up Resistor              RCD              Configured by bits 4 and 5   128   170  212        kΩ
 Impedance                                           in USB IO & Power
                                                     Management register.
 HS FUNCTIONALITY
 Input levels
 HS Differential Input              VDIHS            | V(DP) - V(DM) |            100                   mV
 Sensitivity
SMSC USB3319 REV C                                             17                            Revision 2.1 (06-10-10)
                                                       DATASHEET


                                                  Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
                                                                                                                Datasheet
                        Table 4.5 DC Characteristics: Analog I/O Pins (DP/DM) (continued)
          PARAMETER                 SYMBOL                CONDITIONS                MIN       TYP       MAX      UNITS
 HS Data Signaling Common          VCMHS                                          -50                  500      mV
 Mode Voltage Range
 High-Speed Squelch                                Note 4.6                       100                  150      mV
 Detection Threshold               VHSSQ
 (Differential Signal Amplitude)
 Output Levels
 Hi-Speed Low Level                VHSOL           45Ω load                       -10                  10       mV
 Output Voltage (DP/DM
 referenced to GND)
 Hi-Speed High Level               VHSOH           45Ω load                       360                  440      mV
 Output Voltage (DP/DM
 referenced to GND)
 Hi-Speed IDLE Level               VOLHS           45Ω load                       -10                  10       mV
 Output Voltage (DP/DM
 referenced to GND)
 Chirp-J Output Voltage            VCHIRPJ         HS termination resistor        700                  1100     mV
 (Differential)                                    disabled, pull-up resistor
                                                   connected. 45Ω load.
 Chirp-K Output Voltage            VCHIRPK         HS termination resistor        -900                 -500     mV
 (Differential)                                    disabled, pull-up resistor
                                                   connected. 45Ω load.
 Leakage Current
 OFF-State Leakage Current         ILZ                                                                 ±10      uA
 Port Capacitance
 Transceiver Input                 CIN             Pin to GND                                5         10       pF
 Capacitance
                Note 4.4    The resistor value follows the 27% Resistor ECN published by the USB-IF.
                Note 4.5    The values shown are valid when the USB RegOutput bits in the USB IO & Power
                            Management register are set to the default value.
                Note 4.6    An automatic waiver up to 200mV is granted to accommodate system-level elements such
                            as measurement/test fixtures, captive cables, EMI components, and ESD suppression.
4.6             Dynamic Characteristics: Analog I/O Pins
                           Table 4.6 Dynamic Characteristics: Analog I/O Pins (DP/DM)
          PARAMETER                 SYMBOL                 CONDITIONS              MIN       TYP         MAX      UNITS
 FS Output Driver Timing
 FS Rise Time                     TFR               CL = 50pF; 10 to 90% of       4                     20        ns
                                                    |VOH - VOL|
 FS Fall Time                     TFF               CL = 50pF; 10 to 90% of       4                     20        ns
                                                    |VOH - VOL|
 Output Signal Crossover          VCRS              Excluding the first           1.3                   2.0       V
 Voltage                                            transition from IDLE state
 Differential Rise/Fall Time      TFRFM             Excluding the first           90                    111.1     %
 Matching                                           transition from IDLE state
Revision 2.1 (06-10-10)                                      18                                       SMSC USB3319 REV C
                                                     DATASHEET


Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
Datasheet
                     Table 4.6 Dynamic Characteristics: Analog I/O Pins (DP/DM) (continued)
         PARAMETER                  SYMBOL                  CONDITIONS           MIN  TYP    MAX        UNITS
 LS Output Driver Timing
 LS Rise Time                      TLR               CL = 50-600pF;             75          300         ns
                                                     10 to 90% of
                                                     |VOH - VOL|
 LS Fall Time                      TLF               CL = 50-600pF;             75          300         ns
                                                     10 to 90% of
                                                     |VOH - VOL|
 Differential Rise/Fall Time       TLRFM             Excluding the first        80          125         %
 Matching                                            transition from IDLE state
 HS Output Driver Timing
 Differential Rise Time            THSR                                         500                     ps
 Differential Fall Time            THSF                                         500                     ps
 Driver Waveform                                     Eye pattern of Template 1
 Requirements                                        in USB 2.0 specification
 Hi-Speed Mode Timing
 Receiver Waveform                                   Eye pattern of Template 4
 Requirements                                        in USB 2.0 specification
 Data Source Jitter and                              Eye pattern of Template 4
 Receiver Jitter Tolerance                           in USB 2.0 specification
4.7            OTG Electrical Characteristics
                                       Table 4.7 OTG Electrical Characteristics
        PARAMETER                 SYMBOL                 CONDITIONS             MIN  TYP     MAX        UNITS
 SessEnd trip point              VSessEnd                                       0.2   0.5     0.8       V
 SessVld trip point              VSessVld                                       0.8   1.4     2.0       V
 VbusVld trip point              VVbusVld                                       4.4  4.58    4.75       V
 A-Device Impedance              RIdGnd          Maximum A device                             100       kΩ
                                                 Impedance to ground on ID
                                                 pin
 ID Float trip point             VIdFloat                                       1.9   2.2     2.5       V
 Vbus Pull-Up                    RVPU            VBUS to VDD33                  281  340      450       Ω
                                                 (ChargeVbus = 1)
 Vbus Pull-down                  RVPD            VBUS to GND                    656  850     1100       Ω
                                                 (DisChargeVbus = 1)
 Vbus Impedance                  RVB             VBUS to GND                    40    75      100       kΩ
 ID pull-up resistance           RID             IdPullup = 1                   80   100      120       kΩ
 ID weak pull-up resistance      RIDW            IdPullup = 0                    1                      MΩ
 ID pull-dn resistance           RIDPD           IdGndDrv = 1                                1000       Ω
SMSC USB3319 REV C                                            19                          Revision 2.1 (06-10-10)
                                                      DATASHEET


                                               Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
                                                                                                             Datasheet
4.8             USB Audio Switch Characteristics
                                   Table 4.8 USB Audio Switch Characteristics
         PARAMETER               SYMBOL             CONDITIONS                MIN        TYP         MAX       UNITS
 Minimum “ON” Resistance        RON_Min      0 < Vswitch < VDD33               2.7        5           5.8      Ω
 Maximum “ON” Resistance        RON_Max      0 < Vswitch < VDD33               4.5        7           10       Ω
 Minimum “OFF”                  ROFF_Min     0 < Vswitch < VDD33                1                              MΩ
 Resistance
4.9             Regulator Output Voltages and Capacitor Requirement
                         Table 4.9 Regulator Output Voltages and Capacitor Requirement
          PARAMETER                SYMBOL              CONDITIONS                 MIN       TYP        MAX     UNITS
 Regulator Output Voltage         VDD33         6V > VBAT > 3.1V                  3.0        3.3        3.6    V
 Regulator Output Voltage         VDD33         USB UART Mode & UART               2.7       3.0        3.3    V
                                                RegOutput[1:0] = 01
                                                6V > VBAT > 3.1V
 Regulator Output Voltage         VDD33         USB UART Mode & UART              2.47      2.75       3.03    V
                                                RegOutput[1:0] = 10
                                                6V > VBAT > 3.1V
 Regulator Output Voltage         VDD33         USB UART Mode & UART              2.25       2.5       2.75    V
                                                RegOutput[1:0] = 11
                                                6V > VBAT > 3.1V
 Regulator Bypass Capacitor       CBYP                                             2.2                         uF
 Bypass Capacitor ESR             CESR                                                                   1     Ω
                                   Table 4.10 ESD and LATCH-UP Performance
 PARAMETER                    CONDITIONS                MIN      TYP        MAX        UNITS         COMMENTS
                                              ESD PERFORMANCE
 Note 4.7            Human Body Model                                      ±8         kV         Device
 System              EN/IEC 61000-4-2 Contact                              ±8         kV         3rd party system test
                     Discharge
 System              EN/IEC 61000-4-2 Air-gap                              ±15        kV         3rd party system test
                     Discharge
                                           LATCH-UP PERFORMANCE
 All Pins            EIA/JESD 78, Class II                     150                    mA
                Note 4.7   REFCLK pin ±5kV Human Body Model.
Revision 2.1 (06-10-10)                                  20                                        SMSC USB3319 REV C
                                                 DATASHEET


Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
Datasheet
Chapter 5 Architecture Overview
               The USB3319 consists of the blocks shown in Figure 5.1. All pull-up resistors shown in this diagram
               are connected to VDD33.
                                                                                 IdGnd                                                                      DATA7
                                                                  RIDW   RID                                                                                DATA6
                                                                                 IdFloat                                                                    DATA5
                                                                                                                                                            DATA4
                                                                                            OTG Module
                   ID                                                                                                                                       DATA3
                                                                                                                                             Digital IO
                                                                                Rid Value
                                                       IdGndDrv                                                                                             DATA2
                VBUS                                                                                            ULPI Digital                                DATA1
                                                                         RVPU   SessEnd                                                                     DATA0
                                                                                                                                                            STP
                VBAT                                                            SessValid                                                                   NXT
                                                                                                                                                            DIR
                                             LDO                  RVB    RVPD
                                                                                VbusValid                                                                   CLKOUT
                                                                                                                                                            RESETB
                          ESD Protection
               VDD33
                                                                                                                TX Data   RX Data                           VDD18
                                           RCD   RCD              RPU    RPU
                                                                                                                                    Integrated
                                                                                                          HS/FS/LS
                                                                                     TX                                             Low Jitter              REFCLK
                  DP                                                                                     TX Encoding
                                                                                                                                       PLL
                  DM
                                                                                                          HS/FS/LS
                                                                  RPD    RPD
                                                                                RX                                                    BIAS                  RBIAS
              SPKR_L                                                                                     RX Decoding
            SPKR_R/M
                                                  Figure 5.1 USB3319 System Diagram
5.1            ULPI Digital Operation and Interface
               This section of the USB3319 is covered in detail in Chapter 6, ULPI Operation Overview.
5.2            Interface to DP/DM
               The blocks in the lower left-hand corner of Figure 5.1 interface to the DP/DM pins.
5.2.1          USB Transceiver
               The USB3319 transceiver includes the receivers and transmitters required to be compliant to the
               Universal Serial Bus Specification Rev 2.0. The DP/DM signals in the USB cable connect directly to
               the receivers and transmitters.
               The RX block consists of separate differential receivers for HS and FS/LS mode. Depending on the
               mode, the selected receiver provides the serial data stream through the multiplexer to the RX Logic
               block. For HS mode support, the HS RX block contains a squelch circuit to insure that noise is not
               interpreted as data. The RX block also includes a single-ended receiver on each of the data lines to
               determine the correct FS linestate.
               Data from the TX Logic block is encoded, bit stuffed, serialized and transmitted onto the USB cable
               by the TX block. Separate differential FS/LS and HS transmitters are included to support all modes.
               The USB3319 TX block is designed to meet the HS signalling level requirements in the USB 2.0
               Specification when the PCB traces from the DP and DM pins to the USB connector have very little
SMSC USB3319 REV C                                                               21                                                                       Revision 2.1 (06-10-10)
                                                                            DATASHEET


                                                Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
                                                                                                                                                                 Datasheet
               loss. In some systems, it may be desirable to compensate for loss by adjusting the HS transmitter
               amplitude. The Boost bits in the HS TX Boost register may be configured to adjust the HS transmitter
               amplitude at the DP and DM pins.
5.2.2          Termination Resistors
               The USB3319 transceiver fully integrates all of the USB termination resistors on both DP and DM. This
               includes 1.5kΩ pull-up resistors, 15kΩ pull-down resistors and the 45Ω high speed termination
               resistors. These resistors require no tuning or trimming by the Link. The state of the resistors is
               determined by the operating mode of the PHY when operating in synchronous mode.
               The XcvrSelect[1:0], TermSelect and OpMode[1:0] bits in the Function Control register, and the
               DpPulldown and DmPulldown bits in the OTG Control register control the configuration. The possible
               valid resistor combinations are shown in Table 5.1, and operation is guaranteed in only the
               configurations shown. If a ULPI Register Setting is configured that does not match a setting in the
               table, the transceiver operation is not guaranteed and the settings in the last row of Table 5.1 will be
               used.
                    RPU_DP_EN activates the 1.5kΩ DP pull-up resistor
                    RPU_DM_EN activates the 1.5kΩ DM pull-up resistor
                    RPD_DP_EN activates the 15kΩ DP pull-down resistor
                    RPD_DM_EN activates the 15kΩ DM pull-down resistor
                    HSTERM_EN activates the 45Ω DP and DM high speed termination resistors
               The USB3319 also includes two 125kΩ DP and DM pull-up resistors described in Section 5.8.
                                  Table 5.1 DP/DM Termination vs. Signaling Mode
                                                                                                                               USB3319 TERMINATION
                                                  ULPI REGISTER SETTINGS                                                        RESISTOR SETTINGS
                                                  XCVRSELECT[1:0]                                            DMPULLDOWN
                                                                    TERMSELECT    OPMODE[1:0]   DPPULLDOWN                RPU_DP_EN   RPU_DM_EN     RPD_DP_EN   RPD_DM_EN   HSTERM_EN
 SIGNALING MODE
 General Settings
 Tri-State Drivers                              XXb                 Xb           01b            Xb           Xb           0b          0b            0b          0b          0b
 Power-up or Vbus < VSESSEND                    01b                 0b           00b            1b           1b           0b          0b            1b          1b          0b
 Host Settings
 Host Chirp                                     00b                 0b           10b            1b           1b           0b          0b            1b          1b          1b
 Host Hi-Speed                                  00b                 0b           00b            1b           1b           0b          0b            1b          1b          1b
 Host Full Speed                                X1b                 1b           00b            1b           1b           0b          0b            1b          1b          0b
 Host HS/FS Suspend                             01b                 1b           00b            1b           1b           0b          0b            1b          1b          0b
 Host HS/FS Resume                              01b                 1b           10b            1b           1b           0b          0b            1b          1b          0b
 Host low Speed                                 10b                 1b           00b            1b           1b           0b          0b            1b          1b          0b
 Host LS Suspend                                10b                 1b           00b            1b           1b           0b          0b            1b          1b          0b
Revision 2.1 (06-10-10)                                                 22                                                                        SMSC USB3319 REV C
                                                    DATASHEET


Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
Datasheet
                            Table 5.1 DP/DM Termination vs. Signaling Mode (continued)
                                                                                                                                USB3319 TERMINATION
                                                   ULPI REGISTER SETTINGS                                                        RESISTOR SETTINGS
                                                   XCVRSELECT[1:0]                                            DMPULLDOWN
                                                                     TERMSELECT    OPMODE[1:0]   DPPULLDOWN                RPU_DP_EN   RPU_DM_EN      RPD_DP_EN   RPD_DM_EN   HSTERM_EN
 SIGNALING MODE
 Host LS Resume                                  10b                 1b           10b            1b           1b           0b          0b            1b           1b          0b
 Host Test J/Test_K                              00b                 0b           10b            1b           1b           0b          0b            1b           1b          1b
 Peripheral Settings
 Peripheral Chirp                                00b                 1b           10b            0b           0b           1b          0b            0b           0b          0b
 Peripheral HS                                   00b                 0b           00b            0b           0b           0b          0b            0b           0b          1b
 Peripheral FS                                   01b                 1b           00b            0b           0b           1b          0b            0b           0b          0b
 Peripheral HS/FS Suspend                        01b                 1b           00b            0b           0b           1b          0b            0b           0b          0b
 Peripheral HS/FS Resume                         01b                 1b           10b            0b           0b           1b          0b            0b           0b          0b
 Peripheral LS                                   10b                 1b           00b            0b           0b           0b          1b            0b           0b          0b
 Peripheral LS Suspend                           10b                 1b           00b            0b           0b           0b          1b            0b           0b          0b
 Peripheral LS Resume                            10b                 1b           10b            0b           0b           0b          1b            0b           0b          0b
 Peripheral Test J/Test K                        00b                 0b           10b            0b           0b           0b          0b            0b           0b          1b
 OTG device, Peripheral Chirp                    00b                 1b           10b            0b           1b           1b          0b            0b           1b          0b
 OTG device, Peripheral HS                       00b                 0b           00b            0b           1b           0b          0b            0b           1b          1b
 OTG device, Peripheral FS                       01b                 1b           00b            0b           1b           1b          0b            0b           1b          0b
 OTG device, Peripheral HS/FS Suspend            01b                 1b           00b            0b           1b           1b          0b            0b           1b          0b
 OTG device, Peripheral HS/FS Resume             01b                 1b           10b            0b           1b           1b          0b            0b           1b          0b
 OTG device, Peripheral Test J/Test K            00b                 0b           10b            0b           1b           0b          0b            0b           1b          1b
 Any combination not defined above                                                                                         0b          0b            0b           0b          0b
 Note 5.1
               Note: This is the same as Table 40, Section 4.4 of the ULPI 1.1 specification.
               Note: USB3319 does not support operation as an upstream hub port. See Section 6.2.4.3.
               Note 5.1     The transceiver operation is not guaranteed in a combination that is not defined.
               The USB3319 uses the 27% resistor ECN resistor tolerances. The resistor values are shown in
               Table 4.5.
SMSC USB3319 REV C                                                       23                                                                        Revision 2.1 (06-10-10)
                                                     DATASHEET


                                                 Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
                                                                                                              Datasheet
5.3             Bias Generator
               This block consists of an internal bandgap reference circuit used for generating the driver current and
               the biasing of the analog circuits. This block requires an external 8.06KΩ, 1% tolerance, reference
               resistor connected from RBIAS to ground. This resistor should be placed as close as possible to the
               USB3319 to minimize the trace length. The nominal voltage at RBIAS is 0.8V and therefore the resistor
               will dissipate approximately 80μW of power.
5.4             Integrated Low Jitter PLL
               The USB3319 uses an integrated low jitter phase locked loop (PLL) to provide a clean 480MHz clock.
               This clock is used by the PHY during both transmit and receive. The USB3319 requires a 13MHz
               reference clock to be driven on the REFCLK pin.
               After the PLL has locked to the correct frequency, the USB3319 will de-assert DIR and the Link can
               begin using the ULPI interface. The USB3319 is guaranteed to start the clock within the time specified
               in Table 4.2.
               The system must not drive voltage on the CLKOUT pin following POR or hardware reset that exceeds
               the value of VIH_ED provided in Table 4.4.
               For Host applications the USB3319 implements the ULPI AutoResume bit in the Interface Control
               Register. The default AutoResume state is 0 and this bit should be enabled for Host applications. For
               more details please see sections 7.1.77 and 7.9 of the USB Specification.
5.4.1          Reference Clock Requirements
               The reference clock is connected to the REFCLK pins as shown in the application diagram, Figure 8.2.
               The REFCLK pin is designed to be driven with a square wave from 0V to VDD18, but can be driven
               with a square wave from 0V to as high as 3.6V.
               When using an external reference clock, the USB3319 only uses the positive edge of the clock. The
               signal must comply with the VIH and VIL parameters provided in Table 4.4. It may be possible to AC
               couple the reference clock to change the common-mode voltage level when it is sourced by a device
               that does not comply with the VIH and VIL parameters. A DC bias network must be provided at the
               REFCLK pin when the reference clock is AC coupled. The component values provided in Figure 5.2
               are for example only. The actual values should be selected to satisfy system requirements.
                                                        1.8V Supply
                                                         47k
                                                                      To REFCLK pin
                                      Clock
                                                0.1uF
                                                         47k
          Figure 5.2 Example of circuit used to shift a reference clock common-mode voltage level.
               The USB3319 is tolerant to jitter on the reference clock. The REFCLK jitter should be limited to a peak
               to peak jitter of less than 1nS over a 10uS time interval. If this level of jitter is exceeded the USB3319
               high speed eye diagram may be degraded.
Revision 2.1 (06-10-10)                                    24                                      SMSC USB3319 REV C
                                                   DATASHEET


Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
Datasheet
               The edges of the reference clock do not need to be aligned in any way to the ULPI interface signals.
               The reference clock is used by a PLL to generate the 60MHz CLKOUT for the ULPI digital. There is
               no need to align the phase of the REFCLK and the 60MHz CLKOUT.
               The REFCLK should be enabled when the RESETB pin is brought high. The ULPI interface will start
               running after the time specified in Table 4.2. If the REFCLK enable is delayed relative to the RESETB
               pin, the ULPI interface will start operation delayed by the same amount. The REFCLK can be run at
               anytime the RESETB pin is low without causing the USB3319 to start-up or draw current.
               When the USB3319 is placed in Low Power Mode or carkit mode the REFCLK can be stopped after
               the final ULPI register write is complete. The STP pin is asserted to bring the USB3319 out of Low
               Power Mode. The REFCLK should be started at the same time STP is asserted to minimize the
               USB3319 start-up time.
               If the REFCLK is stopped while CLKOUT is running the PLL will come out of lock and the frequency
               of the CLKOUT signal will decrease to the minimum allowed by the PLL design. If the REFCLK is
               stopped during a USB session the session may drop.
    5.5        Internal Regulators and POR
               The USB3319 includes integrated power management functions, including a Low-Dropout regulator
               that can be used to generate the 3.3V USB supply, and a POR generator.
    5.5.1      Integrated Low Dropout Regulator
               The USB3319 has an integrated linear regulator. Power sourced at the VBAT pin is regulated to 3.3V
               and the regulator output is on the VDD33 pin. To ensure stability, the regulator requires an external
               bypass capacitor as specified in Table 4.9 placed as close to the pin as possible.
               The USB3319 regulator is designed to generate a 3.3 volt supply for the USB3319 only. Using the
               regulator to provide current for other circuits is not recommended and SMSC does not guarantee USB
               performance or regulator stability.
               During USB UART mode the regulator output voltage can be changed to allow the USB3319 to work
               with UARTs operating at different operating voltages. The regulator output voltage is controlled by the
               UART RegOutput[1:0] bits described in Section 7.1.4.4 and Table 4.9.
               The USB3319 regulator can be powered in the three methods as shown below.
               For USB Peripheral, Host, and OTG operations the regulator can be connected as shown in Figure 5.3
               or Figure 5.4 below. For OTG operation, the VDD33 supply on the USB3319 must be powered to
               detect devices attaching to the USB connector and detect a SRP during an OTG session. When using
               a battery to supply the USB3319 the battery voltage must be within the range of 3.1V to 5.5V
.
                                                                    ~~
                                                           V BU S
                                      To USB C on.                           To O TG
                                                           VB AT
                                                          VD D 33             LD O
                                                 C BYP
                                                            GND
                                                                         S M S C PH Y
                                                                    ~~
                                 Figure 5.3 Powering the USB3319 from a Battery
SMSC USB3319 REV C                                           25                                  Revision 2.1 (06-10-10)
                                                         DATASHEET


                                                  Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
                                                                                                               Datasheet
               The USB3319 can be powered from an external 3.3V supply as shown in Figure 5.4. When using the
               external supply both the VBAT and VDD33 pins are connected together. The bypass capacitor should
               be included when using the external supply.
                                                                       ~~
                                                              V BU S
                                   To USB C on.                                 To O TG
                                                              VB AT
                                                             VD D 33            LDO
                                    Vdd
                                    3.3V
                                                     C BYP
                                                               GND
                                                                            SM SC PH Y
                                                                       ~~
                              Figure 5.4 Powering the USB3319 from a 3.3V Supply
               For peripheral only or host only operation the regulator can be connected as shown in Figure 5.5. This
               connection of the regulator requires the Vbus supply to be present any time the USB operation is
               desired. When a Vbus voltage is not present, the USB3319 cannot detect OTG or Carkit signaling.
                                                                       ~~
                                                              VBUS
                                   To USB Con.                                  To OTG
                                                              VBAT
                                                             VDD33              LDO
                                              CBYP
                                                               GND
                                                                       ~~   SMSC PHY
                          Figure 5.5 Powering the USB3319 from the USB Cable Vbus
               When using the USB3319 connected as shown in Figure 5.5, the ULPI interface will operate when
               Vbus is removed. When Vbus is removed the USB3319 should be placed into Low Power Mode until
               Vbus is detected through an interrupt. While the USB3319 is in Low Power Mode the status of VBUS,
               ID, DP, and DM can be monitored while drawing a minimum amount of current from the VDD18 supply
               as described in Section 6.2.6.4.
5.5.2          Power On Reset (POR)
               The USB3319 provides an internal POR circuit that generates a reset pulse after the VDD18 supply
               is stable. After the internal POR goes high and the RESETB pin is high, the USB3319 will release from
               reset and begin normal ULPI operation. Provided that REFCLK is present when the RESETB pin is
               brought high, the ULPI bus will be available in the time defined as TSTART as given in Table 4.2.
               The ULPI registers will power up in their default state summarized in Table 7.1 when the 1.8V supply
               is brought up. Cycling the 1.8 volt power supply will reset the ULPI registers to their default states.
               The RESETB pin can also be used to reset the ULPI registers to their default state (and reset all
               internal state machines) by bringing the pin low for a minimum of 1 microsecond and then high.
Revision 2.1 (06-10-10)                                          26                                 SMSC USB3319 REV C
                                                      DATASHEET


Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
Datasheet
              The Link is not required to assert the RESETB pin. A pull-down resistor is not present on the RESETB
              pin and therefore the Link must drive the RESETB pin to the desired state at all times (including
              system start-up) or connect the RESETB pin to VDD18.
5.5.3         Recommended Power Supply Sequence
              The power supplies can be applied to the USB3319 in any order. The order in which the supplies are
              brought up is not important. For USB operation the USB3319 requires the VBAT, VDD33, and VDD18
              supples.
              When the VBAT supply is applied the integrated regulator will automatically start-up and regulate
              VBAT to VDD33. If the VDD33 supply is powered and the VDD18 supply is not powered, the 3.3V
              circuits are powered off and the VDD33 current will be limited to 20uA.
              The ULPI interface will start operating after the VDD18 supply is applied and the RESETB pin is
              brought high. The RESETB pin must be held low until the VDD18 supply is stable. If the Link is not
              ready to interface the USB3319 the Link may choose to hold the RESETB pin low until it is ready to
              control the ULPI interface.
                             Table 5.2 Operating Mode vs. Power Supply Configuration
        VDD33*                   VDD18                RESETB                 OPERATING MODES AVAILABLE
           0                        0                    0           Powered Off
           0                        1                    0           Standby Mode. VDD18 Current <1uA
           0                        1                    1           All operating modes described in Chapter 6. Note:
                                                                     The USB3319 will only allow ULPI register access
                                                                     in this configuration.
           1                        1                    1           Full USB operation as described in Chapter 6.
           1                        0                    X           In this mode the ULPI interface is not active and
                                                                     the circuits powered from the VDD33 are turned
                                                                     off and the current will be limited to 20uA
              Note: Anytime VBAT is powered the VDD33 pin will be powered up. This column assumes the VBAT
                       pin is powered as described above.
5.5.4         Start-Up
              The power on default state of the USB3319 is ULPI Synchronous mode. The USB3319 requires the
              following conditions to begin operation: the power supplies must be stable, the REFCLK must be
              present and the RESETB pin must be high. After these conditions are met, the USB3319 will begin
              ULPI operation that is described in Section 6.1.
              Figure 5.6 below shows a timing diagram to illustrate the start-up of the USB3319. At T0, the supplies
              are stable and the USB3319 is held in reset mode. At T1, the Link drives RESETB high after the
              REFCLK has started. The RESETB pin may be brought high asynchronously to REFCLK. At this point
              the USB3319 will drive idle on the data bus and assert DIR until the internal PLL has locked. After the
              PLL has locked, the USB3319 will check that the Link has de-asserted STP and at T2 it will de-assert
              DIR and begin ULPI operation.
              The ULPI bus will be available as shown in Figure 5.6 in the time defined as TSTART given in Table 4.2.
              If the REFCLK signal starts after the RESETB pin is brought high, then time T0 will begin when
              REFCLK starts. TSTART also assumes that the Link has de-asserted STP. If the Link has held STP
              high the USB3319 will hold DIR high until STP is de-asserted. When the LINK de-asserts STP, it must
              drive a ULPI IDLE one cycle after DIR de-asserts.
SMSC USB3319 REV C                                          27                                        Revision 2.1 (06-10-10)
                                                      DATASHEET


                                                       Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
                                                                                                                                   Datasheet
                      T0                           T1                                             T2
                      S U P P L IE S
                      STABLE
    REFCLK                                                          R E F C L K v a lid
    RESETB
  D A T A [7 :0 ]           P H Y T r i-S ta te s                  P H Y D r iv e s Id le           ID L E        RXCM D           ID L E
           D IR             P H Y T r i-S ta te s                 P H Y D riv e s H ig h
          STP                                                                                              L IN K D r iv e s L o w
                                                                     T START
                                                  Figure 5.6 ULPI Start-up Timing
5.6               USB On-The-Go (OTG)
                  The USB3319 provides full support for USB OTG protocol. OTG allows the USB3319 to be dynamically
                  configured as a host or device depending on the type of cable inserted into the Micro-AB receptacle.
                  When the Micro-A plug of a cable is inserted into the Micro-AB receptacle, the USB device becomes
                  the A-device. When a Micro-B plug is inserted, the device becomes the B-device. The OTG A-device
                  behaves similar to a Host while the B-device behaves similar to a peripheral. The differences are
                  covered in the OTG the “On-The-Go Supplement to the USB 2.0 Specification”. In applications where
                  only Host or Device is required, the OTG Module is unused.
Revision 2.1 (06-10-10)                                          28                                             SMSC USB3319 REV C
                                                         DATASHEET


Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
Datasheet
5.6.1          ID Resistor Detection
               The ID pin of the USB connector is monitored by the ID pin of the USB3319 to detect the attachment
               of different types of USB devices and cables. The block diagram of the ID detection circuitry is shown
               in Figure 5.7 and the related parameters are given in Table 4.7.
                                   ~~
                      VDD33
                                                             IdPullup
                                            RIDW>1M   RID=100K
                             ID
                     To USB Con.                                                             IdGnd
                                                                  Vref IdGnd
                                                                                en   IdGnd Rise or
                                                                                        IdGnd Fall
                                          IdGndDrv
                                                                                            IdFloat
                                                                 Vref IdFloat
                                                                                en   IdFloatRise or
                                                                                         IdFloatFall
                                                                                          RidValue
                                                                        Rid ADC
                                                                  OTG Module
                                   ~~
                                    Figure 5.7 USB3319 ID Resistor Detection Circuitry
5.6.1.1        USB OTG Operation
               The USB3319 can detect ID grounded and ID floating to determine if an A or B cable has been
               inserted. The A plug will ground the ID pin while the B plug will float the ID pin. These are the only
               two valid states allowed in the OTG Protocol.
               To monitor the status of the ID pin, the Link activates the idPullup bit in the OTG Control register, waits
               50mS and then reads the status of the IdGnd bit in the USB Interrupt Status register. If an A cable has
               been inserted the IdGnd bit will read 0. If a B cable is inserted, the ID pin is floating and the IdGnd bit
               will read 1.
               The USB3319 provides an integrated weak pull-up resistor on the ID pin, RIDW. This resistor is present
               to keep the ID pin in a known state when the IdPullup bit is disabled and the ID pin is floated. In
               addition to keeping the ID pin in a known state, it enables the USB3319 to generate an interrupt to
               inform the link when a cable with a resistor to ground has been attached to the ID pin. The weak pull-
               up is small enough that the largest valid Rid resistor pulls the ID pin low and causes the IdGnd
               comparator to go low.
               After the link has detected an ID pin state change, the RID converter can be used to determine the
               resistor value as described in Section 5.6.1.2.
SMSC USB3319 REV C                                                 29                                  Revision 2.1 (06-10-10)
                                                      DATASHEET


                                                    Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
                                                                                                                  Datasheet
5.6.1.2         Measuring ID Resistance to Ground
                The Link can used the integrated resistance measurement capabilities to determine the value of an ID
                resistance to ground. The following table details the valid values of resistance to ground that the
                USB3319 can detect.
                                   Table 5.3 Valid Values of ID Resistance to Ground
               ID RESISTANCE TO GROUND                                                  RID VALUE
                            Ground                                                          000
                           75Ω +/-1%                                                        001
                          102kΩ +/-1%                                                       010
                          200kΩ+/-1%                                                        011
                          440kΩ +/-1%                                                       100
                            Floating                                                        101
                Note: IdPullUp = 0
                The Rid resistance can be read while the USB3319 is in Synchronous Mode. When a resistor to
                ground is attached to the ID pin, the state of the IdGnd comparator will change. After the Link has
                detected ID transition to ground, it can use the methods described in Section 6.5 to operate the Rid
                converter.
5.6.1.3         Using IdFloat Comparator (not recommended)
                Note: The ULPI specification details a method to detect a 102kΩ resistance to ground using the
                         IdFloat comparator. This method can only detect 0ohms, 102kΩ, and floating terminations of
                         the ID pin. Due to this limitation it is recommended to use the RID Converter as described in
                         Section 5.6.1.2.
                The ID pin can be either grounded, floated, or connected to ground with a 102kΩ external resistor. To
                detect the 102K resistor, set the idPullup bit in the OTG Control register, causing the USB3319 to apply
                the 100K internal pull-up connected between the ID pin and VDD33. Set the idFloatRise and idFloatFall
                bits in both the USB Interrupt Enable Rising and USB Interrupt Enable Falling registers to enable the
                IdFloat comparator to generate an RXCMD to the Link when the state of the IdFloat changes. As
                described in Figure 6.3, the alt_int bit of the RXCMD will be set. The values of IdGnd and IdFloat are
                shown for the three types cables that can attach to the USB Connector in Table 5.4.
                               Table 5.4 IdGnd and IdFloat vs. ID Resistance to Ground
            ID RESISTANCE                                  IDGND                                    IDFLOAT
                   Float                                        1                                        1
                   102K                                         1                                        0
                   GND                                          0                                        0
                Note: The ULPI register bits IdPullUp, IdFloatRise, and IdFloatFall should be enabled.
                To save current when an A Plug is inserted, the internal 102kΩ pull-up resistor can be disabled by
                clearing the IdPullUp bit in the OTG Control register and the IdFloatRise and IdFloatFall bits in both
                the USB Interrupt Enable Rising and USB Interrupt Enable Falling registers. If the cable is removed
                the weak RIDW will pull the ID pin high.
Revision 2.1 (06-10-10)                                        30                                       SMSC USB3319 REV C
                                                      DATASHEET


Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
Datasheet
               The IdGnd value can be read using the ULPI USB Interrupt Status register, bit 4. In host mode, it can
               be set to generate an interrupt when IdGnd changes by setting the appropriate bits in the USB Interrupt
               Enable Rising and USB Interrupt Enable Falling registers. The IdFloat value can be read by reading
               the ULPI Carkit Interrupt Status register bit 0.
               Note: The IdGnd switch has been provided to ground the ID pin for future applications.
5.6.2          VBUS Monitor and Pulsing
               The USB3319 includes all of the Vbus comparators required for OTG. The VbusVld, SessVld, and
               SessEnd comparators shown in Figure 5.8 are fully integrated into the USB3319. These comparators
               are used to monitor changes in the Vbus voltage, and the state of each comparator can be read from
               the USB Interrupt Status register.
               The VbusVld comparator is used by the Link, when configured as an A device, to ensure that the Vbus
               voltage on the cable is valid. The SessVld comparator is used by the Link when configured as both
               an A or B device to indicate a session is requested or valid. Finally the SessEnd comparator is used
               by the B-device to indicate a USB session has ended.
               Also included in the VBUS Monitor and Pulsing block are the resistors used for Vbus pulsing in SRP.
               The resistors used for VBUS pulsing include a pull-down to ground and a pull-up to VDD33 as shown
               in Figure 5.8.
                             ~~
                   VDD33                                                                0.5V
                                                                                                                SessEnd
                                                              ChrgVbus
                                                                                                         SessEnd Rise or
                                                       RVPU=340
                                                                                                            SessEnd Fall
                                                                                                               SessValid
                    VBUS                                                                1.4V
               To USB Con.
                                    RVPD=850                       RVB=75K                                     VbusValid
                                                                                       4.575V
                                           DischrgVbus
                                                                                                        VbusValid Rise or
                                                                                                           VbusValid Fall
                                                                                             [0, X]
                                                                                               [1, 0]      RXCMD VbusValid
                                                EXTVBUS (logic 1)
                                                                                               [1, 1]
                                               IndicatorComplement
                                               [UseExternalVbusindicator, IndicatorPassThru]
                                                                                  SMSC PHY
                             ~~
                                               Figure 5.8 USB3319 OTG Vbus Block
5.6.2.1        SessEnd Comparator
               The SessEnd comparator is designed to trip when Vbus is less than 0.5 volts. When Vbus goes below
               0.5 volts the USB session is considered to be ended, and SessEnd will transition from 0 to 1. The
               SessEnd comparator can be disabled by clearing this bit in both the USB Interrupt Enable Rising and
               USB Interrupt Enable Falling registers. When disabled, the SessEnd bit in the USB Interrupt Status
               register will read 0. The SessEnd comparator trip points are detailed in Table 4.7.
SMSC USB3319 REV C                                                           31                                       Revision 2.1 (06-10-10)
                                                                  DATASHEET


                                                   Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
                                                                                                                 Datasheet
5.6.2.2         SessVld Comparator
                The SessVld comparator is used when the PHY is configured as both an A and B device. When
                configured as an A device, the SessVld is used to detect Session Request protocol (SRP). When
                configured as a B device, SessVld is used to detect the presence of Vbus. The SessVld interrupts can
                be disabled by clearing this bit in both the USB Interrupt Enable Rising and USB Interrupt Enable
                Falling registers. When the interrupts are disabled, the SessVld comparator is not disabled and its state
                can be read in the USB Interrupt Status register. The SessVld comparator trip point is detailed in
                Table 4.7.
                Note: The OTG Supplement specifies a voltage range for A-Device Session Valid and B-Device
                         Session Valid comparator. The USB3319 PHY combines the two comparators into one and
                         uses the narrower threshold range.
5.6.2.3         VbusVld Comparator
                The final Vbus comparator is the VbusVld comparator. This comparator is only used when the
                USB3319 is configured as an A-device. In the USB protocol the A-device supplies the VBUS voltage
                and is responsible to ensure it remains within a specified voltage range. The VbusVld comparator can
                be disabled by clearing this bit in both the USB Interrupt Enable Rising and USB Interrupt Enable
                Falling registers. When disabled, bit 1 of the USB Interrupt Status register will return a 0. The VbusVld
                comparator trip points are detailed in Table 4.7.
                The internal VbusValid comparator is designed to ensure the Vbus voltage remains above 4.4V.
                The USB3319 includes the external vbus valid indicator logic as detail in the ULPI Specification. The
                external vbus valid indicator is tied to a logic one. The decoding of this logic is shown in Table 5.5
                below. By default this logic is disabled.
                                        Table 5.5 External Vbus Indicator Logic
                            USE
                        EXTERNAL
     TYPICAL               VBUS          INDICATOR          INDICATOR                   RXCMD VBUS VALID
 APPLICATION            INDICATOR        PASS THRU        COMPLEMENT                    ENCODING SOURCE
   OTG Device                 0                X                  X           Internal VbusVld comparator (Default)
                              1                 1                 0           Fixed 1
                              1                 1                 1           Fixed 0
                              1                 0                 0           Internal VbusVld comparator.
                              1                 0                 1           Fixed 0
  Standard Host               1                 1                 0           Fixed 1
                              1                 1                 1           Fixed 0
     Standard                 0                X                  X           Internal VbusVld comparator. This
    Peripheral                                                                information should not be used by the
                                                                              Link. (Note 5.2)
                Note 5.2     A peripheral should not use VbusVld to begin operation. The peripheral should use
                             SessVld because the internal VbusVld threshold can be above the Vbus voltage required
                             for USB peripheral operation.
Revision 2.1 (06-10-10)                                      32                                        SMSC USB3319 REV C
                                                     DATASHEET


Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
Datasheet
5.6.2.4       Vbus Pulsing with Pull-up and Pull-down Resistors
              In addition to the internal Vbus comparators, the USB3319 also includes the integrated Vbus pull-up
              and pull-down resistors used for Vbus Pulsing. To discharge the Vbus voltage so that a Session
              Request can begin, the USB3319 provides a pull-down resistor from Vbus to Ground. This resistor is
              controlled by the DischargeVbus bit 3 of the OTG Control register. The pull-up resistor is connected
              between Vbus and VDD33. This resistor is used to pull Vbus above 2.1 volts so that the A-Device
              knows that a USB session has been requested. The state of the pull-up resistor is controlled by the
              bit 4 ChargeVbus of the OTG Control register. The Pull-Up and Pull-Down resistor values are detailed
              in Table 4.7.
5.6.2.5       Vbus Input Impedance
              The OTG Supplement requires an A-Device that supports Session Request Protocol to have a VBUS
              input impedance less than 100kΩ and greater the 40kΩ to ground. The USB3319 provides a 75kΩ
              resistance to ground, RVB. The RVB resistor tolerance is detailed in Table 4.7.
5.6.3         Driving External Vbus
              The USB3319 monitors VBUS as described in VBUS Monitor and Pulsing. However, no pins are
              available on the package to allow controlling an external VBUS supply or power switch. The Link
              typically controls the external VBUS supply or power switch as shown in Figure 5.9.
        SOC/FPGA/ASIC
                                                                VBUS
                     CPEN                              EN      Supply       Out
                                                              or Switch
                                                                                                     USB
                                                            PHY                                   Connector
                   REFCLK                        REFCLK                VBUS                      VBUS
                                                                          DM                     D-
                  ULPI Bus                       ULPI Bus                 DP                     D+
                                    12                                     ID                    ID
                                                                    SPKR_L
                                                                  SPKR_R/M
                     Figure 5.9 OTG Link Controller Drives External Vbus Supply or Switch
SMSC USB3319 REV C                                          33                                Revision 2.1 (06-10-10)
                                                      DATASHEET


                                                  Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
                                                                                                                Datasheet
5.7             USB UART Support
                The USB3319 provides support for the USB UART interface as detailed in the ULPI specification and
                the CEA-936A specification. The USB3319 can be placed in UART Mode using the method described
                in Section 6.4, and the regulator output will automatically switch to the value configured by the UART
                RegOutput bits in the USB IO & Power Management register. While in UART mode, the Linestate
                signals cannot be monitored on the DATA[0] and DATA[1] pins.
5.8             USB Charger Detection Support
                To support the detection and identification of different types of USB chargers the USB3319 provides
                integrated pull-up resistors, RCD, on both DP and DM. These pull-up resistors along with the single
                ended receivers can be used to help determine the type of USB charger attached. Reference
                information on implementing charger detection is provided in Section 8.2.
                                          Table 5.6 USB Weak Pull-up Enable
             RESETB                         DP PULLUP ENABLE                           DM PULLUP ENABLE
                  0                                   0                                              0
                  1                        ChargerPullupEnableDP                       ChargerPullupEnableDM
                Note: ChargerPullupEnableDP and ChargerPullupEnableDM are enabled in the USB IO & Power
                         Management register.
5.9             USB Audio Support
                The USB3319 provides two low resistance analog switches that allow audio to be multiplexed over the
                DP and DM terminals of the USB connector. The audio switches are shown in Figure 5.1. The electrical
                characteristics of the USB Audio Switches are provided in Table 4.8.
                During normal USB operation the switches are off. When USB Audio is desired the switches can be
                turned “on” by enabling the SpkLeftEn, SpkRightEn, or MicEn bits in the Carkit Control register as
                described in Section 6.4.2. These bits are disabled by default. The USB Audio Switches can also be
                enabled by asserting the RESETB pin or removing the voltage at VDD18 as shown in Table 5.7. While
                using the USB switches, VDD18 is not required, but 3.3V must be present at VDD33. The integrated
                3.3V LDO regulator may be used to generate VDD33 from power applied at the VBAT pin.
                                          Table 5.7 USB Audio Switch Enable
           RESETB                          VDD18                 DP SWITCH ENABLE               DM SWITCH ENABLE
               X                              0                             1                              1
                0                             1                             1                              1
                1                             1                        SpkLeftEn                 SpkRightEn or MicEn
                Note: SpkLeftEn, SpkRightEn, and MicEn are enabled in the Carkit Control register.
                In addition to USB Audio support the switches can also be used to mux a second FS USB PHY to the
                USB connector. The signal quality will be degraded slightly due to the “on” resistance of the switches.
                The USB3319 single-ended receivers described in Section 5.2.1 are disabled when either USB Audio
                switch is enabled.
Revision 2.1 (06-10-10)                                     34                                        SMSC USB3319 REV C
                                                    DATASHEET


Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
Datasheet
              The USB3319 does not provide the DC bias for the audio signals. The SPK_R and SPK_L pins should
              be biased to 1.65V when audio signals are routed through the USB3319. This DC bias is necessary
              to prevent the audio signal from swinging below ground and being clipped by ESD Diodes.
SMSC USB3319 REV C                                          35                              Revision 2.1 (06-10-10)
                                                      DATASHEET


                                                                                                     Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
                                                                                                                                                                                                                                                                                                                    Datasheet
Chapter 6 ULPI Operation Overview
                 The USB3319 uses the industry standard ULPI digital interface to facilitate communication between
                 the PHY and Link (device controller). The ULPI interface is designed to reduce the number of pins
                 required to connect a discrete USB PHY to an ASIC or digital controller. For example, a full UTMI+
                 Level 3 OTG interface requires 54 signals while a ULPI interface requires only 12 signals.
                 The ULPI interface is documented completely in the “UTMI+ Low Pin Interface (ULPI)
                 Specification Revision 1.1” (www.ulpi.org). The following sections highlight the key operating modes
                 of the USB3319 digital interface.
6.1              Overview
                 Figure 6.1 illustrates the block diagram of the ULPI digital functions. It should be noted that this
                 USB3319 does not use a “ULPI wrapper” around a UTMI+ PHY core as the ULPI specification implies.
                                                                                     USB Transmit and Receive Logic
                                                           Tx Data
                                                                                                   High Speed TX                                             HS Tx Data
    Data[7:0]                                                                                                                                                                                                                To TX
                                                                                                   Full Speed TX
                                                                                                                                                             FS/LS Tx Data                                                   Analog
           DIR                                                                                     Low Speed TX
                                                                                                                                                                                                                                                                                          NOTE:
           NXT
                 ULPI Protocol                                                                                                                                                                                                                                                            The ULPI interface
                    Block                                                                                                                                                                                                                                                                 is a wrapperless
  STP                                                                                                                                                                                                                                                                                     design.
                                                          Rx Data                                 High Speed Data                                                HS RX Data
                                                                                                      Recovery                                                                                                               To RX
                                                                                                  Full / Low Speed                                                   FS/LS Data                                              Analog
                                                                                                   Data Recovery
                                                                                                          Transceiver Control
                                                                                                                                                                                                                                                                  To OTG                        To Carkit
                                                                                                                                                                                                                                                                  Analog                         Analog
                 ULPI Register Access
                                                                                                                                                                                         Rid State
                                                                                                                                                                                         Machine
                                                                                                                                  Linestates[1:0]                    IdFloat
                                                                                                                                                                                                             RidValue[2:0]
                                                                                                                                                        VbusValid
                                                                                                                                                                               RidCon...Done
                                                                                                                                                                                                                                                         UseExternal Vbus Indicator
                                                                                                                                                                                                                             Interface Protect Disable
                                                                                                                                                      SessionValid
                                                                                                                                                                                                                                                                                                         ChargerPullupEnDP
                                                                                                                                                       SessionEnd
                                                                                                                                                                                                                                                         Indicator Complement         ChrgVbus
                                                                                                                                 HostDisconnect
                                                                                              6pinSerial Mode                                               IdGnd
                                         ULPI Interupt    Reset                                                                                                                                                                                                                       IdGndDrv
                                                                                              3pinSerial Mode
                                                                                                                                                                                                                                                         Indicator Pass Thru
                                                          DpPulldown
                                                                                                                                                                                               RidCon...Start
                                        XcvrSelect[1:0]                                                                                                                                                                                                                               IdPullUp
                                                                                   SuspendM
                                                          DmPulldown                          ClockSuspendM
                                                                                                                                                                                                                                                                                                         ChargerPullupEnDM
                                        TermSelect        SwapDP/DM        TxdEn              AutoResume                                                                                                                                                                              SpkLeftEn
                                        OpMode[1:0]       RegOutput[1:0]   RxdEn              CarkitMode                                                                                                                                                 DischrgVbus                  SpkRightEn/MicEn
                                                                                                                                                    Interrupt Control
  RESETB                                                                                                                        ULPI Register Array
  POR
                                                                               Figure 6.1 ULPI Digital Block Diagram
                 The advantage of a “wrapper less” architecture is that the USB3319 has a lower USB latency than a
                 design which must first register signals into the PHY’s wrapper before the transfer to the PHY core. A
                 low latency PHY allows a Link to use a wrapper around a UTMI Link and still make the required USB
                 turn-around timing given in the USB 2.0 specification.
Revision 2.1 (06-10-10)                                                                                                                      36                                                                                                                                         SMSC USB3319 REV C
                                                                                                        DATASHEET


Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
Datasheet
              RxEndDelay maximum allowed by the UTMI+/ULPI for 8-bit data is 63 high speed clocks. USB3319
              uses a low latency high speed receiver path to lower the RxEndDelay to 43 high speed clocks. This
              low latency design gives the Link more cycles to make decisions and reduces the Link complexity. This
              is the result of the “wrapper less” architecture of the USB3319. This low RxEndDelay should allow
              legacy UTMI Links to use a “wrapper” to convert the UTMI+ interface to a ULPI interface.
              In Figure 6.1, a single ULPI Protocol Block decodes the ULPI 8-bit bi-directional bus when the Link
              addresses the PHY. The Link must use the DIR output to determine direction of the ULPI data bus.
              The USB3319 is the “bus arbitrator”. The ULPI Protocol Block will route data/commands to the
              transmitter or the ULPI register array.
6.1.1         ULPI Interface Signals
              The UTIM+ Low Pin Interface (ULPI) uses 12-pins to connect a full OTG Host / Device PHY to an
              SOC. A reduction of external pins on the PHY is accomplished by realizing that many of the relatively
              static configuration pins (xcvrselect[1:0], termselect, opmode[1:0], and DpPullDown DmPulldown to list
              a few,) can be implemented by having an internal static register array.
              An 8-bit bi-directional data bus clocked at 60MHz allows the Link to access this internal register array
              and transfer USB packets to and from the PHY. The remaining 3 pins function to control the data flow
              and arbitrate the data bus.
              Direction of the 8-bit data bus is controlled by the DIR output from the PHY. Another output, NXT, is
              used to control data flow into and out of the device. Finally, STP, which is in input to the PHY,
              terminates transfers and is used to start up and resume from Low Power Mode.
              The 12 signals are described below in Table 6.1.
                                            Table 6.1 ULPI Interface Signals
    SIGNAL        DIRECTION                                           DESCRIPTION
 CLKOUT          OUT              60MHz reference clock output. All ULPI signals are driven synchronous to the
                                  rising edge of this clock.
 DATA[7:0]       I/O              8-bit bi-directional data bus. Bus ownership is determined by DIR. The Link and
                                  PHY initiate data transfers by driving a non-zero pattern onto the data bus. ULPI
                                  defines interface timing for a single-edge data transfers with respect to rising edge
                                  of CLKOUT.
 DIR             OUT              Controls the direction of the data bus. When the PHY has data to transfer to the
                                  Link, it drives DIR high to take ownership of the bus. When the PHY has no data
                                  to transfer it drives DIR low and monitors the bus for commands from the Link. The
                                  PHY will pull DIR high whenever the interface cannot accept data from the Link,
                                  such as during PLL start-up.
 STP             IN               The Link asserts STP for one clock cycle to stop the data stream currently on the
                                  bus. If the Link is sending data to the PHY, STP indicates the last byte of data was
                                  on the bus in the previous cycle.
 NXT             OUT              The PHY asserts NXT to throttle the data. When the Link is sending data to the
                                  PHY, NXT indicates when the current byte has been accepted by the PHY. The
                                  Link places the next byte on the data bus in the following clock cycle.
              USB3319 implements a Single Data Rate (SDR) ULPI interface with all data transfers happening on
              the rising edge of the CLKOUT signal supplied by the PHY.
              The ULPI interface supports the two basic modes of operation: Synchronous Mode and Low Power
              Mode. In Synchronous Mode, all signals change synchronously with the 60MHz CLKOUT. In Low
              Power Mode the clock is off and the lower two bits of the data bus contain the linestate[1:0] signals.
              Interrupt outputs are generated while in Low Power Mode to enable the Link to receive an
              asynchronous interrupt when the Linestate, Vbus state, or ID state changes.
SMSC USB3319 REV C                                           37                                     Revision 2.1 (06-10-10)
                                                      DATASHEET


                                                   Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
                                                                                                                 Datasheet
                Data is transferred on the rising edge of CLKOUT while operating in Synchronous Mode. The direction
                of the data bus is determined by the state of DIR. When DIR is high, the PHY is driving DATA[7:0].
                When DIR is low, the Link is driving DATA[7:0].
                Each time DIR changes, a “turn-around” cycle occurs where neither the Link nor PHY drive the data
                bus for one clock cycle. During the “turn–around“cycle, the state of DATA[7:0] is unknown and the
                PHY will not read the data bus.
                Because USB uses a bit-stuffing encoding, some means of allowing the PHY to throttle the USB
                transmit data is needed. The ULPI signal NXT is used to request the next byte to be placed on the
                data bus by the Link layer.
6.1.2           ULPI Interface Timing in Synchronous Mode
                The control and data timing relationships are given in Figure 6.2 and Table 4.3. The USB3319 provides
                CLKOUT and all timing is relative to the rising clock edge.
  Clock Out -
     CLKOUT
                           TSC           THC
  Control In -
          STP
                          TSD             THD
      Data In -
  DATA[7:0]
                                                                       TDC                                TDC
 Control Out -
    DIR, NXT
                                                                      TDD
   Data Out -
  DATA[7:0]
                       Figure 6.2 ULPI Single Data Rate Timing Diagram in Synchronous Mode
6.2             ULPI Register Access
                A command from the Link begins a ULPI transfer from the Link to the USB3319. Before reading a
                ULPI register, the Link must wait until DIR is low, and then send a Transmit Command Byte (TXD
                CMD) byte. The TXD CMD byte informs the USB3319 of the type of data being sent. The TXD CMD
                is followed by a data transfer to or from the USB3319. Table 6.2 gives the TXD command byte (TXD
                CMD) encoding for the USB3319. The upper two bits of the TX CMD instruct the PHY as to what type
Revision 2.1 (06-10-10)                                      38                                        SMSC USB3319 REV C
                                                     DATASHEET


Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
Datasheet
               of packet the Link is transmitting. The ULPI registers retain their contents when the PHY is in Low
               Power Mode, Full Speed/Low Speed Serial Mode, or Carkit Mode.
                                       Table 6.2 ULPI TXD CMD Byte Encoding
                              CMD
 COMMAND NAME               BITS[7:6]        CMD BITS[5:0]             COMMAND DESCRIPTION
         Idle                  00b               000000b               ULPI Idle
       Transmit                01b               000000b               USB Transmit Packet with No Packet Identifier
                                                                       (NOPID)
                                                 00XXXXb               USB Transmit Packet Identifier (PID) where DATA[3:0]
                                                                       is equal to the 4-bit PID. P3P2P1P0 where P3 is the
                                                                       MSB.
    Register Write             10b              XXXXXXb                Immediate Register Write Command where:
                                                                       DATA[5:0] = 6-bit register address
                                                  101111b              Extended Register Write Command where the 8-bit
                                                                       register address is available on the next cycle.
    Register Read              11b              XXXXXXb                Immediate Register Read Command where:
                                                                       DATA[5:0] = 6-bit register address
                                                  101111b              Extended Register Read Command where the 8-bit
                                                                       register address is available on the next cycle.
6.2.1          ULPI Register Write
               A ULPI register write operation is given in Figure 6.3. The TXD command with a register write
               DATA[7:6] = 10b is driven by the Link at T0. The register address is encoded into DATA[5:0] of the
               TXD CMD byte.
                                    T0           T1             T2            T3            T4       T5            T6
                    CLK
                                                    TXD CMD
              DATA[7:0]      Idle
                                                    (reg write)
                                                                                Reg Data[n]    Idle
                    DIR
                    STP
                    NXT
           ULPI Register                                  Reg Data [n-1]                                Reg Data [n]
                                Figure 6.3 ULPI Register Write in Synchronous Mode
SMSC USB3319 REV C                                               39                                        Revision 2.1 (06-10-10)
                                                       DATASHEET


                                                                   Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
                                                                                                                                                         Datasheet
                    To write a register, the Link will wait until DIR is low, and at T0, drive the TXD CMD on the data bus.
                    At T2 the PHY will drive NXT high. On the next rising clock edge, T3, the Link will write the register
                    data. At T4, the PHY will accept the register data and the Link will drive an Idle on the bus and drive
                    STP high to signal the end of the data packet. Finally, at T5, the PHY will latch the data into the register
                    and drive NXT low. The Link will pull STP low.
                    NXT is used to control when the Link drives the register data on the bus. DIR is low throughout this
                    transaction since the PHY is receiving data from the Link. STP is used to end the transaction and data
                    is registered after the de-assertion of STP. After the write operation completes, the Link must drive a
                    ULPI Idle (00h) on the data bus or the USB3319 may decode the bus value as a ULPI command.
                    A ULPI extended register write operation is shown in Figure 6.4. To write an extended register, the Link
                    will wait until DIR is low, and at T0, drive the TXD CMD on the data bus. At T2 the PHY will drive NXT
                    high. On the next clock T3 the Link will drive the extended address. On the next rising clock edge, T4,
                    the Link will write the register data. At T5, the PHY will accept the register data and drive NXT low.
                    The Link will drive an Idle on the bus and drive STP high to signal the end of the data packet. Finally,
                    at T5, the PHY will latch the data into the register. The Link will pull STP low.
                                   T0            T1                       T2                  T3                T4                 T5         T6                T7
               CLK
                                                      TXD CM D                                   E x te n d e d
    D A T A [7 :0 ]        Id le
                                              (e x te n d e d r e g w r it e )                    a d d re s s
                                                                                                                 R e g D a ta [n ]    Id le
                D IR
               STP
               NXT
  U L P I R e g is te r                                                  R e g D a ta [n -1 ]                                                    R e g D a ta [n ]
                                 Figure 6.4 ULPI Extended Register Write in Synchronous Mode
Revision 2.1 (06-10-10)                                                               40                                                    SMSC USB3319 REV C
                                                                      DATASHEET


Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
Datasheet
6.2.2         ULPI Register Read
              A ULPI register read operation is given in Figure 6.5. The Link drives a TXD CMD byte with DATA[7:6]
              = 11h for a register read. DATA[5:0] of the ULPI TXD command bye contain the register address.
                                    T0           T1        T2          T3            T4         T5           T6
            CLK
      DATA[7:0]           Idle                 Txd Cmd Reg
                                                   Read
                                                                         Turn around   Reg Data  Turn around     Idle
             DIR
            STP
            NXT
                                Figure 6.5 ULPI Register Read in Synchronous Mode
              At T0, the Link will place the TXD CMD on the data bus. At T2, the PHY will bring NXT high, signaling
              that the Link it is ready to accept the data transfer. At T3, the PHY reads the TXD CMD, determines
              it is a register read, and asserts DIR to gain control of the bus. The PHY will also de-assert NXT. At
              T4, the bus ownership has transferred back to the PHY and the PHY drives the requested register
              onto the data bus. At T5, the Link will read the data bus and the PHY will drop DIR low returning control
              of the bus back to the Link. After the turn around cycle, the Link must drive a ULPI Idle command at T6.
              A ULPI extended register read operation is shown in Figure 6.6.To read an extended register, the Link
              writes the TX CMD with the address set to 2Fh. At T2, the PHY will assert NXT, signaling the Link it
              is ready to accept the extended address. At T3, the Link places the extended register address on the
              bus. At T4, the PHY reads the extended address, and asserts DIR to gain control of the bus. The PHY
              will also de-assert NXT. At T5, the bus ownership has transferred back to the PHY and the PHY drives
              the requested register onto the data bus. At T6, the Link will read the data bus and the PHY will de-
              assert DIR returning control of the bus back to the Link. After the turn around cycle, the Link must
              drive a ULPI Idle command at T6.
SMSC USB3319 REV C                                          41                                         Revision 2.1 (06-10-10)
                                                      DATASHEET


                                                               Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
                                                                                                                                                      Datasheet
                               T0          T1                    T2         T3                T4                 T5             T6                 T7
             C LK
                                                 TXD CM D                      E x te n d e d
     D A T A [7 :0 ]   Id le
                                          e x te n d e d re g re a d            a d d re s s
                                                                                               T u rn a ro u n d   R e g D a ta  T u rn a ro u n d     Id le
              D IR
             STP
             NXT
                             Figure 6.6 ULPI Extended Register Read in Synchronous Mode
6.2.3            ULPI RXCMD
                 The ULPI Link needs information which was provided by the following pins in a UTMI implementation:
                 linestate[1:0], rxactive, rxvalid and rxerror. When implementing the OTG functions the VBUS and ID
                 pin states must also be transferred to the Link.
                 ULPI defines a Receive Command Byte (RXCMD) that contains this information. The Encoding of the
                 RXCMD byte is given in the Table 6.3.
                 Transfer of the RXCMD byte occurs in Synchronous Mode when the PHY has control of the bus. The
                 ULPI Protocol Block shown in Figure 6.1 determines when to send an RXCMD. When a linestate
                 change occurs, the RXCMD is sent immediately if the DIR output is low.
                 When a USB Receive is occurring, RXCMD’s are sent whenever NXT = 0 and DIR = 1. During a USB
                 Transmit, the RXCMD’s are returned to the Link after STP is asserted.
                 To summarize a RXCMD transfer occurs:
                    When DIR is low and a linestate change occurs.
                    When Vbus and/or ID comparators change state.
                    During a USB receive when NXT is low.
                    After STP is asserted during a USB transmit command.
                    After the USB3319 deasserts DIR and STP is low during start-up
                    After the USB3319 exits Low Power Mode, Serial Modes, or Carkit Modes after detecting that the
                     Link has asserted STP.
Revision 2.1 (06-10-10)                                                  42                                                        SMSC USB3319 REV C
                                                                   DATASHEET


Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
Datasheet
                                           Table 6.3 ULPI RX CMD Encoding
 DATA[7:0]      NAME            DESCRIPTION AND VALUE
     [1:0]       Linestate      UTMI Linestate Signals Note 6.1
     [3:2]       Encoded        ENCODED VBUS VOLTAGE STATES
                    Vbus
                    State
                                 VALUE              VBUS VOLTAGE              SESSEND        SESSVLD        VBUSVLD2
                                    00        VVBUS < VSESS_END                    1              0               0
                                    01        VSESS_END < VVBUS <                  0              0               0
                                              VSESS_VLD
                                    10        VSESS_VLD < VVBUS <                  X              1               0
                                              VVBUS_VLD
                                    11        VVBUS_VLD < VVBUS                    X              X               1
     [5:4]       Rx Event       ENCODED UTMI EVENT SIGNALS
                 Encoding
                                 VALUE                 RXACTIVE               RXERROR           HOSTDISCONNECT
                                    00                     0                       0                     0
                                    01                     1                       0                     0
                                    11                     1                       1                     0
                                    10                     X                       X                     1
      [6]         State of      Set to the logic state of the ID pin. A logic low indicates an A device. A logic high
                   ID pin       indicates a B device.
      [7]          alt_int      Asserted when a non-USB interrupt occurs. This bit is set when an unmasked event
                                occurs on any bit in the Carkit Interrupt Latch register. The Link must read the Carkit
                                Interrupt Latch register to determine the source of the interrupt. Section 5.6.1.3
                                describes how a change on the ID pin can generate an interrupt. Section 6.5
                                describes how an interrupt can be generated when the RidConversionDone bit is set.
              Notes:
              1. An ‘X’ is a do not care and can be either a logic 0 or 1.
              2. The value of VbusValid is defined in Table 5.5.
              Note 6.1     LineState: These bits in the RXCMD byte reflect the current state of the Full-Speed single
                           ended receivers. LineState[0] directly reflects the current state of DP. LineState[1] directly
                           reflects the current state of DM. When DP=DM=0 this is called "Single Ended Zero" (SE0).
                           When DP=DM=1, this is called "Single Ended One" (SE1).
6.2.4         USB3319 Transmitter
              The USB3319 ULPI transmitter fully supports HS, FS, and LS transmit operations. Figure 6.1 shows
              the high speed, full speed, and low speed transmitter block controlled by ULPI Protocol Block.
              Encoding of the USB packet follows the bit-stuffing and NRZI outlined in the USB 2.0 specification.
              Many of these functions are re-used between the HS and FS/LS transmitters. When using the
              USB3319, Table 5.1 should always be used as a guideline on how to configure for various modes of
              operation. The transmitter decodes the inputs of XcvrSelect[1:0], TermSelect, OpMode[1:0],
              DpPulldown, and DmPulldown to determine what operation is expected. Users must strictly adhere to
              the modes of operation given in Table 5.1.
SMSC USB3319 REV C                                           43                                     Revision 2.1 (06-10-10)
                                                      DATASHEET


                                                  Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
                                                                                                                Datasheet
                Several important functions for a device and host are designed into the transmitter blocks.
                The USB3319 transmitter will transmit a 32-bit long high speed sync before every high speed packet.
                In full and low speed modes a 8-bit sync is transmitted.
                When the device or host needs to chirp for high speed port negotiation, the OpMode = 10 setting will
                turn off the bit-stuffing and NRZI encoding in the transmitter. At the end of a chirp, the USB3319
                OpMode register bits should be changed only after the RXCMD linestate encoding indicates that the
                transmitter has completed transmitting. Should the opmode be switched to normal bit-stuffing and NRZI
                encoding before the transmit pipeline is empty, the remaining data in the pipeline may be transmitted
                in an bit-stuff encoding format.
                Please refer to the ULPI specification for a detailed discussion of USB reset and HS chirp.
6.2.4.1         High Speed Long EOP
                When operating as a Hi-Speed host, the USB3319 will automatically generate a 40 bit long End of
                Packet (EOP) after a SOF PID (A5h). The USB3319 determines when to send the 40-bit long EOP by
                decoding the ULPI TXD CMD bits [3:0] for the SOF. The 40-bit long EOP is only transmitted when the
                DpPulldown and DmPulldown bits in the OTG Control register are asserted. The Hi-Speed 40-bit long
                EOP is used to detect a disconnect in high speed mode.
                In device mode, the USB3319 will not send a long EOP after a SOF PID.
6.2.4.2         Low Speed Keep-Alive
                Low speed keep alive is supported by the USB3319. When in Low speed (10b), the USB3319 will send
                out two Low speed bit times of SE0 when a SOF PID is received.
6.2.4.3         UTMI+ Level 3
                Pre-amble is supported for UTMI+ Level 3 compatibility. When XcvrSelect is set to (11b) in host mode,
                (DpPulldown and DmPulldown both asserted) the USB3319 will pre-pend a full speed pre-amble before
                the low speed packet. Full speed rise and fall times are used in this mode. The pre-amble consists of
                the following: Full speed sync, the encoded pre-PID (C3h) and then full speed idle (DP=1 and DM =
                0). A low speed packet follows with a sync, data and a LS EOP.
                The USB3319 will only support UTMI+ Level 3 as a host. The USB3319 does not support UTMI+ Level
                3 as a peripheral. A UTMI+ Level 3 peripheral is an upstream hub port. The USB3319 will not decode
                a pre-amble packet intended for a LS device when the USB3319 is configured as the upstream port
                of a FS hub, XcvrSelect = 11b, DpPulldown = 0b, DmPulldown =0b.
6.2.4.4         Host Resume K
                Resume K generation is supported by the USB3319. When the USB3319 exits the suspended (Low
                Power Mode), the USB3319, when operating as a host, will transmit a K on DP/DM. The transmitters
                will end the K with SE0 for two Low Speed bit times. If the USB3319 was operating in high speed
                mode before the suspend, the host must change to high speed mode before the SE0 ends. SE0 is
                two low speed bit times which is about 1.2 us. For more details please see sections 7.1.77 and 7.9 of
                the USB Specification.
                In device mode, the resume K will not append an SE0, but release the bus to the correct idle state,
                depending upon the operational mode as shown in Table 5.1.
                The ULPI specification includes a detailed discussion of the resume sequence and the order of
                operations required. To support Host start-up of less than 1mS the USB3319 implements the ULPI
                AutoResume bit in the Interface Control register. The default AutoResume state is 0 and this bit should
                be enabled for Host applications.
Revision 2.1 (06-10-10)                                     44                                        SMSC USB3319 REV C
                                                    DATASHEET


Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
Datasheet
6.2.4.5         No SYNC and EOP Generation (OpMode = 11)
                UTMI+ defines OpMode = 11 where no sync and EOP generation occurs in Hi-Speed operation. This
                is an option to the ULPI specification and not implemented in the USB3319.
6.2.4.6         Typical USB Transmit with ULPI
                Figure 6.7 shows a typical USB transmit sequence. A transmit sequence starts by the Link sending a
                TXD CMD where DATA[7:6] = 01b, DATA[5:4] = 00b, and Data[3:0] = PID. The TX CMD with the PID
                is followed by transmit data.
      CLK
                           TXD CMD                                                                       Turn   RXD    Turn
 DATA[7:0] Idle
                           (USB tx)
                                             D0    D1        D2          D3           IDLE
                                                                                                        Around  CMD   Around
      DIR
      NXT
      STP
    DP/DM                    SE0                                     !SQUELCH                           SE0
                                    Figure 6.7 ULPI Transmit in Synchronous Mode
                During transmit the PHY will use NXT to control the rate of data flow into the PHY. If the USB3319
                pipeline is full or bit-stuffing causes the data pipeline to overfill NXT is de-asserted and the Link will
                hold the value on Data until NXT is asserted. The USB Transmit ends when the Link asserts STP while
                NXT is asserted.
                Note: The Link cannot assert STP with NXT de-asserted since the USB3319 is expecting to fetch
                         another byte from the Link.
                After the USB3319 completes transmitting, the DP/DM lines return to idle and a RXCMD is returned
                to the Link so the inter-packet timers may be updated by linestate.
                While operating in Full Speed or Low Speed, an End-of-Packet (EOP) is defined as SE0 for
                approximately two bit times, followed by J for one bit time. The transceiver drives a J state for one bit
                time following the SE0 to complete the EOP. The Link must wait for one bit time following line state
                indication of the SE0 to J transition to allow the transceiver to complete the one bit time J state. All bit
                times are relative to the speed of transmission.
                In the case of Full Speed or Low Speed, after STP is asserted each FS/LS bit transition will generate
                a RXCMD since the bit times are relatively slow.
6.2.5           USB Receiver
                The USB3319 ULPI receiver fully supports HS, FS, and LS transmit operations. In all three modes the
                receiver detects the start of packet and synchronizes to the incoming data packet. In the ULPI protocol,
                a received packet has the priority and will immediately follow register reads and RXCMD transfers.
                Figure 6.8 shows a basic USB packet received by the USB3319 over the ULPI interface.
SMSC USB3319 REV C                                             45                                    Revision 2.1 (06-10-10)
                                                      DATASHEET


                                                    Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
                                                                                                                  Datasheet
         CLK
                                   Turn         Rxd                              Rxd                      Turn
 DATA[7:0]             Idle
                                  around        Cmd
                                                          PID        D1
                                                                                Cmd
                                                                                            D2
                                                                                                         around
         DIR
         STP
         NXT
                                     Figure 6.8 ULPI Receive in Synchronous Mode
                In Figure 6.8 the PHY asserts DIR to take control of the data bus from the Link. The assertion of DIR
                and NXT in the same cycle contains additional information that Rxactive has been asserted. When
                NXT is de-asserted and DIR is asserted, the RXCMD data is transferred to the Link. After the last byte
                of the USB receive packet is transferred to the PHY, the linestate will return to idle.
                The ULPI full speed receiver operates according to the UTMI / ULPI specification. In the full speed
                case, the NXT signal will assert only when the Data bus has a valid received data byte. When NXT is
                low with DIR high, the RXCMD is driven on the data bus.
                In full speed, the USB3319 will not issue a Rxactive de-assertion in the RXCMD until the DP/DM
                linestate transitions to idle. This prevents the Link from violating the two full speed bit times minimum
                turn around time.
6.2.5.1         Disconnect Detection
                A High Speed host must detect a disconnect by sampling the transmitter outputs during the long EOP
                transmitted during a SOF packet. The USB3319 only looks for a high speed disconnect during the long
                EOP where the period is long enough for the disconnect reflection to return to the host PHY. When a
                high speed disconnect occurs, the USB3319 will return a RXCMD and set the host disconnect bit in
                the USB Interrupt Status register.
                When in FS or LS modes, the Link is expected to handle all disconnect detection.
6.2.6           Low Power Mode
                Low Power Mode is a power down state to save current when the USB session is suspended. The
                Link controls when the PHY is placed into or out of Low Power Mode. In Low Power Mode all of the
                circuits are powered down except the interface pins, full speed receiver, VBUS comparators, and IdGnd
                comparator.
                Before entering Low Power Mode, the USB3319 must be configured to set the desired state of the
                USB transceiver. The XcvrSelect[1:0], TermSelect and OpMode[1:0] bits in the Function Control
                register, and the DpPulldown and DmPulldown bits in the OTG Control register control the
                configuration as shown in Table 5.1. The DP and DM pins are configured to a high impedance state
                by configuring OpMode[1:0] = 01. Pull-down resistors with a value of approximately 2MΩ are present
Revision 2.1 (06-10-10)                                       46                                        SMSC USB3319 REV C
                                                      DATASHEET


Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
Datasheet
                on the DP and DM pins to avoid false linestate indications that could result if the pins were allowed to
                float.
6.2.6.1         Entering Low Power/Suspend Mode
                To enter Low Power Mode, the Link will write a 0 or clear the SuspendM bit in the Function Control
                register. After this write is complete, the PHY will assert DIR high and after a minimum of five rising
                edges of CLKOUT, drive the clock low. After the clock is stopped, the PHY will enter a low power state
                to conserve current. Placing the PHY in Suspend Mode is not related to USB Suspend. To clarify this
                point, USB Suspend is initiated when a USB host stops data transmissions and enters Full-Speed
                mode with 15KΩ pull-down resistors on DP and DM. The suspended device goes to Full-Speed mode
                with a pull-up on DP. Both the host and device remain in this state until one of them drives DM high
                (this is called a resume).
                             T0        T1             T2       T3            T4       T5        T6                T10
             CLK                                                                                       ...
                                          TXD CMD                                         Turn
       DATA[7:0]       Idle
                                          (reg write)
                                                                 Reg Data[n]    Idle
                                                                                         Around
                                                                                                        Low Power Mode
              DIR
             STP
             NXT
    SUSPENDM
 (ULPI Register Bit)
                            Figure 6.9 Entering Low Power Mode from Synchronous Mode
                While in Low Power Mode, the Data interface is redefined so that the Link can monitor Linestate and
                the Vbus voltage. In Low Power Mode DATA[3:0] are redefined as shown in Table 6.4. Linestate[1:0]
                is the combinational output of the Single-Ended Receivers. The “int” or interrupt signal indicates an
                unmasked interrupt has occurred. When an unmasked interrupt or linestate change has occurred, the
                Link is notified and can determine if it should wake-up the PHY.
                              Table 6.4 Interface Signal Mapping During Low Power Mode
     SIGNAL            MAPS TO        DIRECTION                                      DESCRIPTION
 linestate[0]        DATA[0]          OUT                Combinatorial linestate[0] driven directly by FS analog receiver.
 linestate[1]        DATA[1]          OUT                Combinatorial linestate[1] driven directly by FS analog receiver.
 reserved            DATA[2]          OUT                Driven Low
 int                 DATA[3]          OUT                Active high interrupt indication. Must be asserted whenever any
                                                         unmasked interrupt occurs.
 reserved            DATA[7:4]        OUT                Driven Low
                An unmasked interrupt can be caused by the following comparators changing state: VbusVld, SessVld,
                SessEnd, and IdGnd. If any of these signals change state during Low Power Mode and the bits are
                enabled in either the USB Interrupt Enable Rising or USB Interrupt Enable Falling registers, DATA[3]
SMSC USB3319 REV C                                              47                                      Revision 2.1 (06-10-10)
                                                         DATASHEET


                                                      Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
                                                                                                                          Datasheet
                will assert. During Low Power Mode, the VbusVld and SessEnd comparators can have their interrupts
                masked to lower the suspend current as described in Section 6.2.6.4.
                While in Low Power Mode, the Data bus is driven asynchronously because all of the PHY clocks are
                stopped during Low Power Mode.
6.2.6.2         Exiting Low Power Mode
                To exit Low Power Mode, the Link will assert STP. Upon the assertion of STP, the USB3319 will begin
                its start-up procedure. After the PHY start-up is complete, the PHY will start the clock on CLKOUT and
                de-assert DIR. After DIR has been de-asserted, the Link can de-assert STP when ready and start
                operating in Synchronous Mode. The PHY will automatically set the SuspendM bit to a 1 in the
                Function Control register.
                        T0                             T1         T2            T3            T4          T5
          CLK                                  ...
                                   LOW                     TURN        DATA BUS IGNORED (SLOW LINK)
  DATA[7:0]                    POWER MODE                 AROUND                IDLE (FAST LINK)
                                                                                                               IDLE
                                                                                                     Slow Link Drives Bus
                                                                      Fast Link Drives Bus           Idle and STP low
           DIR                                                        Idle and STP low
          STP
                                Note: Not to Scale
                                 TSTART
                                              Figure 6.10 Exiting Low Power Mode
                The value for TSTART is given in Table 4.2.
                Should the Link de-assert STP before DIR is de-asserted, the USB3319 will detect this as a false
                resume request and return to Low Power Mode. This is detailed in section 3.9.4 of the ULPI 1.1
                specification.
6.2.6.3         Interface Protection
                ULPI protocol assumes that both the Link and PHY will keep the ULPI data bus driven by either the
                Link when DIR is low or the PHY when DIR is high. The only exception is when DIR has changed
                state and a turn around cycle occurs for 1 clock period.
                In the design of a USB system, there can be cases where the Link may not be driving the ULPI bus
                to a known state while DIR is low. Two examples where this can happen is because of a slow Link
                start-up or a hardware reset.
                START UP PROTECTION
                Upon start-up, when the PHY de-asserts DIR, the Link must be ready to receive commands and drive
                Idle on the data bus. If the Link is not ready to receive commands or drive Idle, it must assert STP
                before DIR is de-asserted. The Link can then de-assert STP when it has completed its start-up. If the
                Link doesn’t assert STP before it can receive commands, the PHY may interpret the data bus state as
                a TX CMD and transmit invalid data onto the USB bus, or make invalid register writes.
Revision 2.1 (06-10-10)                                         48                                          SMSC USB3319 REV C
                                                        DATASHEET


Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
Datasheet
              When the USB3319 sends a RXCMD the Link is required to drive the data bus back to idle at the end
              of the turn around cycle. If the Link does not drive the databus to idle the USB3319 may take the
              information on the data bus as a TXCMD and transmit data on DP and DM until the Link asserts stop.
              If the ID pin is floated the last RXCMD from the USB3319 will remain on the bus after DIR is de-
              asserted and the USB3319 will take this in as a TXCMD.
              A Link should be designed to have the default POR state of the STP output high and the data bus tri-
              stated. The USB3319 has weak pull-downs on the data bus to prevent these inputs from floating when
              not driven. These resistors are only used to prevent the ULPI interface from floating during events
              when the link ULPI pins may be tri-stated. The strength of the pull down resistors can be found in
              Table 4.4. The pull downs are not strong enough to pull the data bus low after a ULPI RXCMD, the
              Link must drive the data bus to idle after DIR is de-asserted.
              In some cases, a Link may be software configured and not have control of its STP pin until after the
              PHY has started. In this case, the USB3319 has in internal pull-up on the STP input pad which will
              pull STP high while the Link’s STP output is tri-stated. The STP pull-up resistor is enabled on POR
              and can be disabled by setting the InterfaceProtectDisable bit 7 of the Interface Control register.
              The STP pull-up resistor will pull-up the Link’s STP input high until the Link configures and drives STP
              high. After the Link completes its start-up, STP can be synchronously driven low.
              A Link design which drives STP high during POR can disable the pull-up resistor on STP by setting
              InterfaceProtectDisable bit to 1. A motivation for this is to reduce the suspend current. In Low Power
              Mode, STP is held low, which would draw current through the pull-up resistor on STP.
              WARM RESET
              Designers should also consider the case of a warm restart of a Link with a PHY in Low Power Mode.
              After the PHY enters Low Power Mode, DIR is asserted and the clock is stopped. The USB3319 looks
              for STP to be asserted to re-start the clock and then resume normal synchronous operation.
              Should the USB3319 be suspended in Low Power Mode, and the Link receives a hardware reset, the
              PHY must be able to recover from Low Power Mode and start its clock. If the Link asserts STP on
              reset, the PHY will exit Low Power Mode and start its clock.
              If the Link does not assert STP on reset, the interface protection pull-up can be used. When the Link
              is reset, its STP output will tri-state and the pull-up resistor will pull STP high, signaling the PHY to
              restart its clock.
6.2.6.4       Minimizing Current in Low Power Mode
              In order to minimize the suspend current in Low Power Mode, the OTG comparators can be disabled
              to reduce suspend current. In Low Power Mode, the VbusVld and SessEnd comparators are not
              needed and can be disabled by clearing the associated bits in both the USB Interrupt Enable Rising
              and USB Interrupt Enable Falling registers. By disabling the interrupt in BOTH the rise and fall
              registers, the SessEnd and VbusVld comparators are turned off. The IdFloatRise and IdFloatFall bits
              in Carkit Interrupt Enable register should also be disabled if they were set. When exiting Low Power
              Mode, the Link should immediately re-enable the VbusVld and SessEnd comparators if host or OTG
              functionality is required.
              In addition to disabling the OTG comparators in Low Power Mode, the Link may choose to disable the
              Interface Protect Circuit. By setting the InterfaceProtectDisable bit high in the Interface Control register,
              the Link can disable the pull-up resistor on STP. When RESETB is low the Interface Protect Circuit
              will be disabled.
6.3           Full Speed/Low Speed Serial Modes
              The USB3319 includes two serial modes to support legacy Links which use either the 3pin or 6pin
              serial format. To enter either serial mode, the Link will need to write a 1 to the 6-pin FsLsSerialMode
              or the 3-pin FsLsSerialMode bits in the Interface control register. Serial Mode may be used to conserve
              power when attached to a device that is not capable of operating in Hi-Speed.
SMSC USB3319 REV C                                          49                                       Revision 2.1 (06-10-10)
                                                      DATASHEET


                                                    Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
                                                                                                                  Datasheet
                The serial modes are entered in the same manner as the entry into Low Power Mode. The Link writes
                the Interface Control register bit for the specific serial mode. The USB3319 will assert DIR and shut
                off the clock after at least five clock cycles. Then the data bus goes to the format of the serial mode
                selected. Before entering either serial mode, the Link must set the ULPI transceiver to the appropriate
                mode as defined in Table 5.1.
                By default, the PHY will shut off the 60MHz clock to conserve power. Should the Link need the 60MHz
                clock to continue during the serial mode of operation, the ClockSuspendM bit[3] of the Interface Control
                Register should be set before entering a serial mode. If set, the 60 MHz clock will be present during
                serial modes.
                In serial mode, interrupts are possible from unmasked sources. The state of each interrupt source is
                sampled prior to the assertion of DIR and this is compared against the asynchronous level from
                interrupt source.
                Exiting the serial modes is the same as exiting Low Power Mode. The Link must assert STP to signal
                the PHY to exit serial mode. When the PHY can accept a command, DIR is de-asserted and the PHY
                will wait until the Link de-asserts STP to resume synchronous ULPI operation. The RESETB pin can
                also be pulsed low to reset the USB3319 and return it to Synchronous Mode.
6.3.0.5         3pin FS/LS Serial Mode
                Three pin serial mode utilizes the data bus pins for the serial functions shown in Table 6.5.
                                      Table 6.5 Pin Definitions in 3 pin Serial Mode
                     CONNECTED
    SIGNAL                 TO              DIRECTION        DESCRIPTION
   tx_enable            DATA[0]                  IN         Active High transmit enable.
        data            DATA[1]                 I/O         TX differential data on DP/DM when tx_enable is high.
                                                            RX differential data from DP/DM when tx_enable is low.
        SE0             DATA[2]                 I/O         TX SE0 on DP/DM when tx_enable is high.
                                                            RX SE0_b from DP/DM when tx_enable is low.
    interrupt           DATA[3]                OUT          Asserted when any unmasked interrupt occurs. Active high.
   Reserved            DATA[7:4]               OUT          Driven Low.
6.3.0.6         6pin FS/LS Serial Mode
                Six pin serial mode utilizes the data bus pins for the serial functions shown in Table 6.6.
                                      Table 6.6 Pin Definitions in 6 pin Serial Mode
                     CONNECTED
    SIGNAL                 TO              DIRECTION        DESCRIPTION
   tx_enable            DATA[0]                  IN         Active High transmit enable.
     tx_data            DATA[1]                  IN         Tx differential data on DP/DM when tx_enable is high.
      tx_se0            DATA[2]                  IN         Tx SE0 on DP/DM when tx_enable is high.
    interrupt           DATA[3]                OUT          Asserted when any unmasked interrupt occurs. Active high.
       rx_dp            DATA[4]                OUT          Single ended receive data on DP.
      rx_dm             DATA[5]                OUT          Single ended receive data on DM.
Revision 2.1 (06-10-10)                                       50                                        SMSC USB3319 REV C
                                                      DATASHEET


Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
Datasheet
                             Table 6.6 Pin Definitions in 6 pin Serial Mode (continued)
                   CONNECTED
    SIGNAL               TO              DIRECTION         DESCRIPTION
     rx_rcv           DATA[6]                 OUT          Differential receive data from DP and DM.
    Reserved          DATA[7]                 OUT          Driven Low.
6.4           Carkit Mode
              The USB3319 includes Carkit Mode to support a USB UART and USB Audio Mode.
              By entering Carkit Mode, the USB3319 current drain is minimized and the 60MHz clock is stopped to
              conserve power by default. The Link may configure the 60MHz clock to continue by setting the
              ClockSuspendM bit of the Interface Control register before entering Carkit Mode. If set, the 60 MHz
              clock will continue during the Carkit Mode of operation.
              In Carkit Mode, interrupts are possible from unmasked sources. The state of each interrupt source is
              sampled prior to the assertion of DIR and this is compared against the asynchronous level from
              interrupt source. In Carkit Mode, the Linestate signals are not available per the ULPI specification.
              Exiting Carkit Mode is the same as exiting Low Power Mode as described in Section 6.2.6.2. The Link
              must assert STP to signal the PHY to exit serial mode. When the PHY can accept a command, DIR
              is de-asserted and the PHY will wait until the Link de-asserts STP to resume synchronous ULPI
              operation. The RESETB pin can also be pulsed low to reset the USB3319 and return it to Synchronous
              Mode.
6.4.1         USB UART Mode
              The USB3319 can be placed into UART Mode by first setting the TxdEn and RxdEn bits in the Carkit
              Control register. Then the Link can set the CarkitMode bit in the Interface Control register. The TxdEn
              and RxdEn bits must be written before the CarkitMode bit. After the CarkitMode bit is set, the ULPI
              interface will become redefined as described in Table 6.7, and the USB3319 will transmit data through
              the DATA[0] to DM of the USB connector and receive data on DP and pass the information the Link
              on DATA[1].
              When entering UART mode, the regulator output will automatically switch to the value configured by
              the UART RegOutput bits in the USB IO & Power Management register and a 125K RCD pull-up will
              be applied internally to DP and DM. This will hold the UART in its default operating state.
              While in UART mode, the transmit edge rates can be set to either the Full Speed USB or Low Speed
              USB edge rates by using the XcvrSelect[1:0] bits in the Function Control register.
                                      Table 6.7 Pin Definitions in Carkit Mode
                   CONNECTED
    SIGNAL               TO              DIRECTION         DESCRIPTION
 txd              DATA[0]             IN                   UART TXD signal that is routed to the DM pin if the TxdEn
                                                           is set in the Carkit Control register.
 rxd              DATA[1]             OUT                  UART RXD signal that is routed to the DP pin if the RxdEn
                                                           bit is set in the Carkit Control register.
 reserved         DATA[2]             OUT                  Driven Low.
 int              DATA[3]             OUT                  Asserted when any unmasked interrupt occurs. Active high.
 reserved         DATA[4:7]           OUT                  Driven Low.
SMSC USB3319 REV C                                           51                                       Revision 2.1 (06-10-10)
                                                      DATASHEET


                                                  Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
                                                                                                                Datasheet
6.4.2           USB Audio Mode
                When the USB3319 is powered in Synchronous Mode, the Audio switches can be enabled by asserting
                the SpkLeftEn, or SpkRightEn bits in the Carkit Control register. After the register write is complete,
                the USB3319 will immediately enable or disable the audio switch. Then the Link can set the
                CarkitMode bit in the Interface Control register. After the CarkitMode bit is set, the ULPI interface will
                become redefined as described in Table 6.7. The SpkLeftEn, or SpkRightEn bits must be written before
                the CarkitMode bit.
6.5             RID Converter Operation
                The RID converter is designed to read the value of the ID resistance to ground and report back its
                value through the ULPI interface.
                When a resistor to ground is applied to the ID pin the state of the IdGnd comparator will change from
                a 1 to a 0 as described in Section 5.6.1. If the USB3319 is in ULPI mode, an RXCMD will be generated
                with bit 6 low. If the USB3319 is in Low Power Mode (or one of the other non-ULPI modes), the
                DATA[3] interrupt signal will go high.
                After the USB3319 has detected the change of state on the ID pin, the RID converter can be used to
                determine the value of ID resistance. To start a ID resistance measurement, the RidConversionStart
                bit is set in the Vendor Rid Conversion register.
                The Link can use one of two methods to determine when the RID Conversion is complete. One method
                is polling the RidConversionStart bit as described in Section 7.1.4.3. The preferred method is to set
                the RidIntEn bit in the Vendor Rid Conversion register. When RidIntEn is set, an RXCMD will be
                generated after the RID conversion is complete. As described in Table 6.3, the alt_int bit of the RXCMD
                will be set.
                After the RID Conversion is complete, the Link can read RidValue from the Vendor Rid Conversion
                register.
6.6             Headset Audio Mode
                This mode is designed to allow a user to view the status of several signals while using an analog audio
                headset with a USB connector. This feature, exclusive to SMSC, is provided as an alternate mode to
                the CarKit Mode defined in Section 6.4. In the CarKit Mode, the Link is unable to view the source of
                the interrupt on ID, except by returning to synchronous mode to read the ULPI registers. This forces
                the audio switches to be deactivated, and may glitch the audio signals. In addition, the Link cannot
                change the resistance on the ID pin without starting up the PHY to access the ULPI registers.
                The Headset Audio Mode is entered by writing to the Headset Audio Mode register, and allows the
                Link access to the state of the VBUS and ID pins during audio without glitching the audio connection.
                The Headset Audio mode also enables the Link to change the resistance on the ID pin and to change
                the audio headset attached from mono to stereo.
                The ULPI interface is redefined as shown in Table 6.8 when Headset Audio Mode is entered.
                                    Table 6.8 Pin Definitions in Headset Audio Mode
                      CONNECTED
    SIGNAL                  TO            DIRECTION         DESCRIPTION
 SessVld                 DATA[0]        OUT                 Output of SessVld comparator
 VbusVld                 DATA[1]        OUT                 Output of VbusVld Comparator (interrupt must be enabled)
 IdGndDrv                DATA[2]        IN                  Drives ID pin to ground when asserted
                                                            0b: Not connected
                                                            1b: Connects ID to ground.
Revision 2.1 (06-10-10)                                       52                                      SMSC USB3319 REV C
                                                    DATASHEET


Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
Datasheet
                                  Table 6.8 Pin Definitions in Headset Audio Mode
                   CONNECTED
    SIGNAL               TO              DIRECTION         DESCRIPTION
                      DATA[3]         OUT                  Driven low
 IdGround             DATA[4]         OUT                  Asserted when the ID pin is grounded.
                                                           0b: ID pin is grounded
                                                           1b: ID pin is floating
 IdFloat              DATA[5]         OUT                  Asserted when the ID pin is floating. IdPullup or
                                                           d_pullup330 must be enabled as shown below.
 IdPullup330          DATA[6]         IN                   When enabled a 330kΩpullup is applied to the ID pin.
                                                           0b: Disables the pull-up resistor
                                                           1b: Enables the pull-up resistor
 IdPullup             DATA[7]         IN                   Connects the 100kΩ pull-up resistor from the ID pin to
                                                           VDD3.3
                                                           0b: Disables the pull-up resistor
                                                           1b: Enables the pull-up resistor
              Exiting Headset Audio Mode is the same as exiting Low Power Mode as described in Section 6.2.6.2.
              The Link must assert STP to signal the PHY to exit. When the PHY can accept a command, DIR is
              de-asserted and the PHY will wait until the Link de-asserts STP to resume synchronous ULPI
              operation. The RESETB pin can also be pulsed low to reset the USB3319 and return it to Synchronous
              Mode.
SMSC USB3319 REV C                                          53                                     Revision 2.1 (06-10-10)
                                                      DATASHEET


                                                  Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
                                                                                                                Datasheet
Chapter 7 ULPI Register Map
7.1             ULPI Register Array
                The USB3319 PHY implements all of the ULPI registers detailed in the ULPI revision 1.1 specification.
                The complete USB3319 ULPI register set is shown in Table 7.1. All registers are 8 bits. This table also
                includes the default states of the register upon POR, as described in Section 5.5.2. The RESET bit in
                the Function Control Register does not reset the bits of the ULPI register array. The Link should not
                read or write to any registers not listed in this table.
                The USB3319 supports extended register access. The immediate register set (00-3Fh) can be
                accessed through either a immediate address or an extended register address..
                                              Table 7.1 ULPI Register Map
                                                                                     ADDRESS (6BIT)
                                                       DEFAULT
 REGISTER NAME                                          STATE           READ        WRITE            SET        CLEAR
 Vendor ID Low                                            24h            00h           -               -            -
 Vendor ID High                                           04h            01h           -               -            -
 Product ID Low                                           06h            02h           -               -            -
 Product ID High                                          00h            03h           -               -            -
 Function Control                                         41h          04-06h        04h             05h          06h
 Interface Control                                        00h          07-09h        07h             08h          09h
 OTG Control                                              06h          0A-0Ch        0Ah             0Bh          0Ch
 USB Interrupt Enable Rising                              1Fh          0D-0Fh        0Dh             0Eh          0Fh
 USB Interrupt Enable Falling                             1Fh          10-12h        10h             11h          12h
 USB Interrupt Status                                     00h            13h           -               -            -
 USB Interrupt Latch                                      00h            14h           -               -            -
 Debug                                                    00h            15h           -               -            -
 Scratch Register                                         00h          16-18h        16h             17h          18h
 Carkit Control                                           00h          19-1Bh        19h             1Ah          1Bh
 Reserved                                                 00h                                1Ch
 Carkit Interrupt Enable                                  00h          1D-1Fh        1Dh             1Eh          1Fh
 Carkit Interrupt Status                                  00h            20h           -               -            -
 Carkit Interrupt Latch                                   00h            21h           -               -            -
 Reserved                                                 00h                              22-30h
 HS TX Boost                                              00h            31h         31h               -            -
 Reserved                                                 00h            32h         32h               -            -
 Headset Audio Mode                                       00h            33h         33h               -            -
Revision 2.1 (06-10-10)                                      54                                       SMSC USB3319 REV C
                                                     DATASHEET


Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
Datasheet
                                      Table 7.1 ULPI Register Map (continued)
                                                                                  ADDRESS (6BIT)
                                                       DEFAULT
 REGISTER NAME                                          STATE         READ       WRITE       SET         CLEAR
 Reserved                                                 00h                         34-35h
 Vendor Rid Conversion                                    00h         36-38h      36h        37h            38h
 USB IO & Power Management                                04h         39-3Bh      39h        3Ah            3Bh
 Reserved                                                 00h                         3C-3Fh
7.1.1         ULPI Register Set
              The following registers are used for the ULPI interface.
7.1.1.1       Vendor ID Low
              Address = 00h (read only)
 FIELD NAME                   BIT    ACCESS          DEFAULT      DESCRIPTION
 Vendor ID Low                7:0         rd            24h       SMSC Vendor ID
7.1.1.2       Vendor ID High
              Address = 01h (read only)
 FIELD NAME                   BIT    ACCESS          DEFAULT      DESCRIPTION
 Vendor ID High               7:0         rd            04h       SMSC Vendor ID
7.1.1.3       Product ID Low
              Address = 02h (read only)
 FIELD NAME                   BIT    ACCESS          DEFAULT      DESCRIPTION
 Product ID Low               7:0         rd            06h       SMSC Product ID
7.1.1.4       Product ID High
              Address = 03h (read only)
 FIELD NAME                   BIT    ACCESS          DEFAULT      DESCRIPTION
 Product ID High              7:0         rd            00h       SMSC Product ID
SMSC USB3319 REV C                                          55                                Revision 2.1 (06-10-10)
                                                      DATASHEET


                                               Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
                                                                                                             Datasheet
7.1.1.5         Function Control
                Address = 04-06h (read), 04h (write), 05h (set), 06h (clear)
 FIELD NAME                  BIT    ACCESS       DEFAULT       DESCRIPTION
 XcvrSelect[1:0]             1:0    rd/w/s/c         01b       Selects the required transceiver speed.
                                                               00b: Enables HS transceiver
                                                               01b: Enables FS transceiver
                                                               10b: Enables LS transceiver
                                                               11b: Enables FS transceiver for LS packets (FS
                                                               preamble automatically pre-pended)
 TermSelect                   2     rd/w/s/c          0b       Controls the DP and DM termination depending on
                                                               XcvrSelect, OpMode, DpPulldown, and DmPulldown.
                                                               The DP and DM termination is detailed in Table 5.1.
 OpMode                      4:3    rd/w/s/c         00b       Selects the required bit encoding style during
                                                               transmit.
                                                               00b: Normal Operation
                                                               01b: Non-Driving
                                                               10b: Disable bit-stuff and NRZI encoding
                                                               11b: Reserved
 Reset                        5     rd/w/s/c          0b       Active high transceiver reset. This reset does not
                                                               reset the ULPI interface or register set. Automatically
                                                               clears after reset is complete.
 SuspendM                     6     rd/w/s/c          1b       Active low PHY suspend. When cleared the PHY will
                                                               enter Low Power Mode as detailed in 6.2.6.
                                                               Automatically set when exiting Low Power Mode.
 Reserved                     7        rd             0b       Read only, 0.
7.1.1.6         Interface Control
                Address = 07-09h (read), 07h (write), 08h (set), 09h (clear)
 FIELD NAME                  BIT    ACCESS       DEFAULT       DESCRIPTION
 6-pin FsLsSerialMode         0     rd/w/s/c          0b       When asserted the ULPI interface is redefined to the
                                                               6-pin Serial Mode. The PHY will automatically clear
                                                               this bit when exiting serial mode.
 3-pin FsLsSerialMode         1     rd/w/s/c          0b       When asserted the ULPI interface is redefined to the
                                                               3-pin Serial Mode. The PHY will automatically clear
                                                               this bit when exiting serial mode.
 CarkitMode                   2     rd/w/s/c          0b       When asserted the ULPI interface is redefined to the
                                                               Carkit interface. The PHY will automatically clear this
                                                               bit when exiting carkit mode.
 ClockSuspendM                3     rd/w/s/c          0b       Enables Link to turn on 60MHz CLKOUT in serial or
                                                               carkit mode.
                                                               0b: Disable clock in serial or carkit mode.
                                                               1b: Enable clock in serial or carkit mode.
 AutoResume                   4     rd/w/s/c          0b       Only applicable in Host mode. Enables the PHY to
                                                               automatically transmit resume signaling. This
                                                               function is detailed in Section 6.2.4.4.
Revision 2.1 (06-10-10)                                   56                                       SMSC USB3319 REV C
                                                  DATASHEET


Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
Datasheet
 FIELD NAME                   BIT    ACCESS          DEFAULT      DESCRIPTION
 IndicatorComplement           5      rd/w/s/c          0b        Inverts the EXTVBUS signal. This function is detailed
                                                                  in Section 5.6.2.
                                                                  Note:      The EXTVBUS input is always high on the
                                                                             USB3319.
 IndicatorPassThru             6      rd/w/s/c          0b        Disables and’ing the internal VBUS comparator with
                                                                  the EXTVBUS input when asserted. This function is
                                                                  detailed in Section 5.6.2.
                                                                  Note:      The EXTVBUS input is always high on the
                                                                             USB3319.
 InterfaceProtectDisable       7      rd/w/s/c          0b        Used to disable the integrated STP pull-up resistor
                                                                  used for interface protection. This function is detailed
                                                                  in Section 6.2.6.3.
7.1.1.7       OTG Control
              Address = 0A-0Ch (read), 0Ah (write), 0Bh (set), 0Ch (clear)
 FIELD NAME                   BIT    ACCESS          DEFAULT      DESCRIPTION
 IdPullup                      0      rd/w/s/c          0b        Connects a 100kΩ pull-up resistor from the ID pin to
                                                                  VDD33
                                                                  0b: Disables the pull-up resistor
                                                                  1b: Enables the pull-up resistor
 DpPulldown                    1      rd/w/s/c          1b        Enables the 15k Ohm pull-down resistor on DP.
                                                                  0b: Pull-down resistor not connected
                                                                  1b: Pull-down resistor connected
 DmPulldown                    2      rd/w/s/c          1b        Enables the 15k Ohm pull-down resistor on DM.
                                                                  0b: Pull-down resistor not connected
                                                                  1b: Pull-down resistor connected
 DischrgVbus                   3      rd/w/s/c          0b        This bit is only used during SRP. Connects a resistor
                                                                  from VBUS to ground to discharge VBUS.
                                                                  0b: disconnect resistor from VBUS to ground
                                                                  1b: connect resistor from VBUS to ground
 ChrgVbus                      4      rd/w/s/c          0b        This bit is only used during SRP. Connects a resistor
                                                                  from VBUS to VDD33 to charge VBUS above the
                                                                  SessValid threshold.
                                                                  0b: disconnect resistor from VBUS to VDD33
                                                                  1b: connect resistor from VBUS to VDD33
 DrvVbus                       5      rd/w/s/c          0b        Not Implemented.
 DrvVbusExternal               6      rd/w/s/c          0b        Not Implemented.
 UseExternalVbus               7      rd/w/s/c          0b        Tells the PHY to use an external VBUS over-current
 Indicator                                                        or voltage indicator. This function is detailed in
                                                                  Section 5.6.2.
                                                                  0b: Use the internal VbusValid comparator
                                                                  1b: Use the EXTVBUS input as for VbusValid signal.
                                                                  Note:      The EXTVBUS input is always high on the
                                                                             USB3319.
SMSC USB3319 REV C                                          57                                        Revision 2.1 (06-10-10)
                                                      DATASHEET


                                               Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
                                                                                                             Datasheet
7.1.1.8         USB Interrupt Enable Rising
                Address = 0D-0Fh (read), 0Dh (write), 0Eh (set), 0Fh (clear)
 FIELD NAME                  BIT    ACCESS       DEFAULT        DESCRIPTION
 HostDisconnect Rise          0     rd/w/s/c          1b       Generate an interrupt event notification when
                                                                Hostdisconnect changes from low to high. Applicable
                                                                only in host mode.
 VbusValid Rise               1     rd/w/s/c          1b       Generate an interrupt event notification when
                                                                Vbusvalid changes from low to high.
 SessValid Rise               2     rd/w/s/c          1b       Generate an interrupt event notification when
                                                                SessValid changes from low to high.
 SessEnd Rise                 3     rd/w/s/c          1b       Generate an interrupt event notification when
                                                                SessEnd changes from low to high.
 IdGnd Rise                   4     rd/w/s/c          1b       Generate an interrupt event notification when IdGnd
                                                                changes from low to high.
 Reserved                    7:5       rd             0h       Read only, 0.
7.1.1.9         USB Interrupt Enable Falling
                Address = 10-12h (read), 10h (write), 11h (set), 12h (clear)
 FIELD NAME                  BIT    ACCESS       DEFAULT        DESCRIPTION
 HostDisconnect Fall          0     rd/w/s/c          1b       Generate an interrupt event notification when
                                                                Hostdisconnect changes from high to low. Applicable
                                                                only in host mode.
 VbusValid Fall               1     rd/w/s/c          1b       Generate an interrupt event notification when
                                                                Vbusvalid changes from high to low.
 SessValid Fall               2     rd/w/s/c          1b       Generate an interrupt event notification when
                                                                SessValid changes from high to low.
 SessEnd Fall                 3     rd/w/s/c          1b       Generate an interrupt event notification when
                                                                SessEnd changes from high to low.
 IdGnd Fall                   4     rd/w/s/c          1b       Generate an interrupt event notification when IdGnd
                                                                changes from high to low.
 Reserved                    7:5       rd             0h       Read only, 0.
7.1.1.10        USB Interrupt Status
                Address = 13h (read only)
 FIELD NAME                  BIT    ACCESS       DEFAULT        DESCRIPTION
 HostDisconnect               0        rd             0b        Current value of the UTMI+ Hi-Speed Hostdisconnect
                                                  Note 7.1      output. Applicable only in host mode.
 VbusValid                    1        rd             0b        Current value of the UTMI+ Vbusvalid output.
                                                  Note 7.1
 SessValid                    2        rd             0b        Current value of the UTMI+ SessValid output.
                                                  Note 7.1
Revision 2.1 (06-10-10)                                   58                                       SMSC USB3319 REV C
                                                  DATASHEET


Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
Datasheet
 FIELD NAME                   BIT    ACCESS          DEFAULT      DESCRIPTION
 SessEnd                       3          rd             0b       Current value of the UTMI+ SessEnd output.
                                                      Note 7.1
 IdGnd                         4          rd             0b       Current value of the UTMI+ IdGnd output.
                                                      Note 7.1
 Reserved                     7:5         rd             0h       Read only, 0.
              Note 7.1     The default conditions will match the current status of the comparators. The values shown
                           are for an unattached OTG device.
7.1.1.11      USB Interrupt Latch
              Address = 14h (read only with auto clear)
 FIELD NAME                   BIT    ACCESS          DEFAULT      DESCRIPTION
 HostDisconnect Latch          0     Note 7.2            0b       Set to 1b by the PHY when an unmasked event
                                                                  occurs on Hostdisconnect. Cleared when this register
                                                                  is read. Applicable only in host mode.
 VbusValid Latch               1                         0b       Set to 1b by the PHY when an unmasked event
                                                                  occurs on VbusValid. Cleared when this register is
                                                                  read.
 SessValid Latch               2                         0b       Set to 1b by the PHY when an unmasked event
                                                                  occurs on SessValid. Cleared when this register is
                                                                  read.
 SessEnd Latch                 3                         0b       Set to 1b by the PHY when an unmasked event
                                                                  occurs on SessEnd. Cleared when this register is
                                                                  read.
 IdGnd Latch                   4                         0b       Set to 1b by the PHY when an unmasked event
                                                                  occurs on IdGnd. Cleared when this register is read.
 Reserved                     7:5                        0h       Read only, 0.
              Note 7.2     Read Only with auto clear.
7.1.1.12      Debug
              Address = 15h (read only)
 FIELD NAME                   BIT    ACCESS          DEFAULT      DESCRIPTION
 Linestate0                    0          rd             0b       Contains the current value of Linestate[0].
 Linestate1                    1          rd             0b       Contains the current value of Linestate[1].
 Reserved                     7:2         rd          000000b     Read only, 0.
SMSC USB3319 REV C                                           59                                     Revision 2.1 (06-10-10)
                                                      DATASHEET


                                                 Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
                                                                                                               Datasheet
7.1.1.13        Scratch Register
                Address = 16-18h (read), 16h (write), 17h (set), 18h (clear)
 FIELD NAME                    BIT     ACCESS     DEFAULT      DESCRIPTION
 Scratch                       7:0     rd/w/s/c       00h      Empty register byte for testing purposes. Software
                                                               can read, write, set, and clear this register and the
                                                               PHY functionality will not be affected.
7.1.2           Carkit Control Registers
                The following registers are used to set-up and enable the USB UART and USB Audio functions.
7.1.2.1         Carkit Control
                Address = 19-1Bh (read), 19h (write), 1Ah (set), 1Bh (clear)
                This register is used to program the USB3319 into and out of the carkit modes. When entering the
                carkit UART mode the Link must first set the desired TxdEn and the RxdEn bits and then transition to
                Carkit Mode by setting the CarkitMode bit in the Interface Control Register. When RxdEn is not set
                then the DATA[1] pin is held to a logic high.
 FIELD NAME                    BIT     ACCESS     DEFAULT      DESCRIPTION
 CarkitPwr                      0         rd           0b      Read only, 0.
 IdGndDrv                       1      rd/w/s/c        0b      Drives ID pin to ground
 TxdEn                          2      rd/w/s/c        0b      Connects UART TXD (DATA[0]) to DM
 RxdEn                          3      rd/w/s/c        0b      Connects UART RXD (DATA[1]) to DP
 SpkLeftEn                      4      rd/w/s/c        0b      Connects DM pin to SPKR_L pin
 SpkRightEn                     5      rd/w/s/c        0b      Connects DP pin to SPKR_R/M pin. See Note below.
 MicEn                          6      rd/w/s/c        0b      Connects DP pin to SPKR_R/M pin. See Note below.
 Reserved                       7         rd           0b      Read only, 0.
                Note: If SpkRightEn or MicEn are asserted the DP pin will be connected to SPKR_R. To disconnect
                         the DP pin from the SPKR_R/M pin both SpkrRightEn and MicEn must be set to de-asserted.
                If using USB UART mode the UART data will appear at the SPKR_L and SPKR_R/M pins if the
                corresponding SpkLeftEn, SpkRightEn, or MicEn switches are enabled.
                If using USB Audio the TxdEn and RxdEn bits should not be set when the SpkLeftEn, SpkRightEn, or
                MicEn switches are enabled. The USB single-ended receivers described in Section 5.2.1 are disabled
                when either are SpkLeftEn, SpkRightEn, or MicEn are set.
Revision 2.1 (06-10-10)                                    60                                        SMSC USB3319 REV C
                                                   DATASHEET


Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
Datasheet
7.1.2.2       Carkit Interrupt Enable
              Address = 1D-1Fh (read), 1Dh (write), 1Eh (set), 1Fh (clear)
 FIELD NAME                   BIT    ACCESS          DEFAULT      DESCRIPTION
 IdFloatRise                   0      rd/w/s/c          0b        When enabled an interrupt will be generated on the
                                                                  alt_int of the RXCMD byte when the ID pin transitions
                                                                  from non-floating to floating. The IdPullup bit in the
                                                                  OTG Control register should be set.
 IdFloatFall                   1      rd/w/s/c          0b        When enabled an interrupt will be generated on the
                                                                  alt_int of the RXCMD byte when the ID pin transitions
                                                                  from floating to non-floating. The IdPullup bit in the
                                                                  OTG Control register should be set.
 CarIntDet                     2          rd            0b        Not Implemented. Reads as 0b.
 CarDpRise                     3          rd            0b        Not Implemented. Reads as 0b.
 CarDpFall                     4          rd            0b        Not Implemented. Reads as 0b.
 RidIntEn                      5      rd/w/s/c          0b        When enabled an interrupt will be generated on the
                                                                  alt_int of the RXCMD byte when RidConversionDone
                                                                  bit is asserted.
                                                                  Note:      This register bit is or’ed with the RidIntEn bit
                                                                             of the Vendor Rid Conversion register
                                                                             described in Section 7.1.4.3.
 Reserved                     7:6         rd            0b        Read only, 0.
7.1.2.3       Carkit Interrupt Status
              Address = 20h (read only)
 FIELD NAME                   BIT    ACCESS          DEFAULT      DESCRIPTION
 IdFloat                       0          rd            0b        Asserted when the ID pin is floating. IdPullup must be
                                                                  enabled.
 CarIntDet                     1          rd            0b        Not Implemented. Reads as 0b.
 CarDp                         2          rd            0b        Not Implemented. Reads as 0b.
 RidValue                     5:3         rd           000b       Conversion value of Rid resistor
                                                                  000: 0 ohms
                                                                  001: 75 ohms
                                                                  010: 102K ohms
                                                                  011: 200K ohms
                                                                  100: 440K ohms
                                                                  101: ID floating
                                                                  111: Error
                                                                  Note:      RidValue can also be read from the Vendor
                                                                             Rid Conversion register described in
                                                                             Section 7.1.4.3.
SMSC USB3319 REV C                                          61                                           Revision 2.1 (06-10-10)
                                                      DATASHEET


                                                  Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
                                                                                                                 Datasheet
 FIELD NAME                  BIT     ACCESS        DEFAULT      DESCRIPTION
 RidConversionDone            6          rd            0b       Automatically asserted by the USB3319 when the
                                                                Rid Conversion is finished. The conversion will take
                                                                282uS. This bit will auto clear when the RidValue is
                                                                read from the Rid Conversion Register. Reading the
                                                                RidValue from the Carkit interrupt Status register will
                                                                not clear either RidConversionDone status bit.
                                                                Note:      RidConversionDone can also be read from
                                                                           the Vendor Rid Conversion register
                                                                           described in Section 7.1.4.3.
 Reserved                     7          rd            0b       Read only, 0.
7.1.2.4         Carkit Interrupt Latch
                Address = 21h (read only with auto-clear)
 FIELD NAME                  BIT     ACCESS        DEFAULT      DESCRIPTION
 IdFloat Latch                0         rd*            0b       Asserted if the state of the ID pin changes from non-
                                                                floating to floating while the IdFloatRise bit is enabled
                                                                or if the state of the ID pin changes from floating to
                                                                non-floating while the IdFloatFall bit is enabled.
 CarIntDet Latch              1          rd            0b       Not Implemented. Reads as 0b.
 CarDp Latch                  2          rd            0b       Not Implemented. Reads as 0b.
 RidConversionLatch           3         rd*            0b       If RidIntEn is set and the state of the
                                                                RidConversionDone bit changes from a 0 to 1 this bit
                                                                will be asserted.
 Reserved                                rd          00000b     Read only, 0.
                Note: rd*: Read Only with auto clear.
7.1.3           Extended Register Access
                The USB3319 supports extended register access. The immediate register set (00-3Fh) can be
                accessed through either a immediate address or an extended register address.
7.1.4           Vendor Register Access
                The vendor specific registers include the range from 30h to 3Fh. These can be accessed by the ULPI
                immediate register read / write.
Revision 2.1 (06-10-10)                                     62                                        SMSC USB3319 REV C
                                                    DATASHEET


Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
Datasheet
7.1.4.1       HS TX Boost
              Address = 31h (read / write)
 FIELD NAME                   BIT    ACCESS          DEFAULT      DESCRIPTION
 Reserved                     4:0         rd             0b       Read only, 0.
 Boost                        6:5       rd/w            00b       Sets the HS transmitter amplitude as described in
                                                                  Section 5.2.1.
                                                                  01b: Reserved
                                                                  10b: Enables 7.4% increased drive strength
                                                                  11b: Enables 3.7% increased drive strength
 Reserved                      7          rd             0b       Read only, 0.
7.1.4.2       Headset Audio Mode
              Address = 33h (read / write)
 FIELD NAME                   BIT    ACCESS          DEFAULT      DESCRIPTION
 HeadsetAudioEn               3:0       rd/w           0000b      When this field is set to a value of 1010, the Headset
                                                                  Audio Mode is enabled as described in Section 6.6.
 Reserved                     7:4         rd             0h       Read only, 0.
7.1.4.3       Vendor Rid Conversion
              Address = 36-38h (read), 36h (write), 37h (set), 38h (clear)
 FIELD NAME                   BIT    ACCESS          DEFAULT      DESCRIPTION
 RidValue                     2:0       rd/w           000b       Conversion value of Rid resistor
                                                                  000: 0 ohms
                                                                  001: 75 ohms
                                                                  010: 100K ohms
                                                                  011: 200K ohms
                                                                  100: 440K ohms
                                                                  101: ID floating
                                                                  111: Error
                                                                  Note:      RidValue can also be read from the Carkit
                                                                             Interrupt Status register described in
                                                                             Section 7.1.2.3.
 RidConversionDone             3         rd*             0b       Automatically asserted by the USB3319 when the
                                                                  Rid Conversion is finished. The conversion will take
                                                                  282uS. This bit will auto clear when the RidValue is
                                                                  read from the Rid Conversion Register. Reading the
                                                                  RidValue from the Carkit interrupt Status register will
                                                                  not clear either RidConversionDone status bit.
                                                                  Note:      RidConversionDone can also be read from
                                                                             the Carkit Interrupt Status register described
                                                                             in Section 7.1.2.3.
 RidConversionStart            4      rd/w/s/c           0b       When this bit is asserted either through a register
                                                                  write or set, the Rid converter will read the value of
                                                                  the ID resistor. When the conversion is complete this
                                                                  bit will auto clear.
SMSC USB3319 REV C                                           63                                         Revision 2.1 (06-10-10)
                                                      DATASHEET


                                               Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
                                                                                                                 Datasheet
 FIELD NAME                  BIT    ACCESS      DEFAULT        DESCRIPTION
 Reserved                     5     rd/w/s/c         0b        This bit must remain at 0.
 RidIntEn                     6     rd/w/s/c         0b        When enabled an interrupt will be generated on the
                                                               alt_int of the RXCMD byte when RidConversionDone
                                                               bit is asserted.
                                                               Note:      This register bit is or’ed with the RidIntEn bit
                                                                          of the Carkit Interrupt Status register.
 Reserved                     7        rd            0b        Read only, 0.
                Note: rd*: Read Only with auto clear.
7.1.4.4         USB IO & Power Management
                Address = 39-3Bh (read), 39h (write), 3Ah (set), 3Bh (clear)
 FIELD NAME                  BIT    ACCESS      DEFAULT        DESCRIPTION
 Reserved                     0     rd/w/s/c         0b        Read only, 0.
 SwapDP/DM                    1     rd/w/s/c         0b        When asserted, the DP and DM pins of the USB PHY
                                                               are swapped. This bit can be used to prevent
                                                               crossing the DP/DM traces on the board. In UART
                                                               mode, it swaps the routing to the DP and DM pins.
                                                               In USB Audio Mode, it does not affect the SPKR_L
                                                               and SPKR_R/M pins.
 UART RegOutput              3:2    rd/w/s/c        01b        Controls the output voltage of the VBAT to VDD33
                                                               regulator in UART mode. When the PHY is switched
                                                               from USB mode to UART mode regulator output will
                                                               automatically change to the value specified in this
                                                               register when TxdEn is asserted.
                                                               00: 3.3V
                                                               01: 3.0V (default)
                                                               10: 2.75V
                                                               11: 2.5V
                                                               Note:      When in USB Audio Mode the regulator will
                                                                          remain at 3.3V. When using this register it is
                                                                          recommended that the Link exit UART
                                                                          mode by using the RESETB pin.
 ChargerPullupEnDP            4     rd/w/s/c         0b        Enables a 125K Pull-up for USB Charger Detection
                                                               when set on the DP pin. (The pull-up is automatically
                                                               enabled in UART mode)
 ChargerPullupEnDM            5     rd/w/s/c         0b        Enables a 125K Pull-up for USB Charger Detection
                                                               when set on the DM pin. (The pull-up is automatically
                                                               enabled in UART mode)
 USB RegOutput               7:6    rd/w/s/c        00b        Controls the output voltage of the VBAT to VDD33
                                                               regulator in USB mode. When the PHY is in
                                                               Synchronous Mode, Serial Mode, or Low Power
                                                               Mode the regulator output will be the value specified
                                                               in this register.
                                                               00: 3.3V (default)
                                                               01: 3.0V
                                                               10: 2.75V
                                                               11: 2.5V
Revision 2.1 (06-10-10)                                  64                                          SMSC USB3319 REV C
                                                  DATASHEET


Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
Datasheet
Chapter 8 Application Notes
8.1           Application Diagram
              The USB3319 requires few external components as shown in the application diagrams. In some
              applications, the power supplied on the VBUS pin of the USB connector is used as the source of
              system power. The USB 2.0 Specification restricts the voltage at the VBUS pin to a maximum value
              of 5.25V. In some applications, it may be required to provide protection to the USB331x VBUS pin and
              VBAT pin if the VBUS voltage exceeds USB 2.0 specifications.
              One method of protecting the VBUS pin from excessive voltage transients is to place a resistor
              (RVBUS) in series as shown in the application diagrams. The resistor provides some protection against
              transients that exceed the value of VVMAX provided in Table 3.2. This resistor can be used when the
              USB3319 is powered from a Battery as shown in Figure 5.3 or from a 3.3V Supply as shown in
              Figure 5.4. When RVBUS is installed, the transient must not be allowed to exceed the value of VVBUS
              for longer than 500 μs.
              To protect the VBUS pin against a steady state voltage on the USB connector that exceed the value
              of VVMAX provided in Table 3.2, an Over Voltage Protection (OVP) component could be used in the
              place of RVBUS.
              Note: Following POR or hardware reset, the voltage at CLKOUT must not exceed VIH-ED.
                                Table 8.1 Component Values in Application Diagrams
  REFERENCE
 DESIGNATOR             VALUE                          DESCRIPTION                NOTES
 COUT               2.2μF               Bypass capacitor to ground (<1Ω ESR)      Place as close as possible to the
                                        for regulator stability.                  PHY.
 CVBUS              See Table 8.2       Capacitor to ground required by the USB   Place near the USB connector.
                                        Specification. SMSC recommends <1Ω
                                        ESR.
 CBYP               System              Bypass capacitor to ground. Typical       Place as close as possible to the
                    dependent.          values used are 0.1 or 0.01 μF.           PHY.
 CDC_LOAD           System              The USB connector housing may be AC-      Industry convention is to ground
                    dependent.          coupled to the device ground.             only the host side of the cable
                                                                                  shield.
 RVBUS              820Ω or 10kΩ        Series resistor to reduce transient       Cannot be used when the
                                        voltage on VBUS.                          USB3319 is powered from the
                                        820Ω in Host or OTG applications.         VBUS at the USB connector. This
                                        10kΩ may be used only in device mode      method of powering is shown in
                                        applications.                             Figure 5.5.
                             Table 8.2 Capacitance Values at VBUS of USB Connector
          MODE                                MIN VALUE                                  MAX VALUE
           Host                                   120μF
          Device                                    1μF                                      10μF
           OTG                                      1μF                                     6.5μF
SMSC USB3319 REV C                                            65                                 Revision 2.1 (06-10-10)
                                                      DATASHEET


                                                                Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
                                                                                                                                   Datasheet
        Steady state voltage at the VBUS pin must not be
        allowed to exceed VVMAX.
                                                                                                                      Link Controller
                                                                              USB331X
        RVBUS may be installed in this configuration to
                                                                                                    9
        assist in protecting the VBUS pin. 820 Ohms                                     DATA7       10
                                                                                                                      DATA7
        will protect against VBUS transients up to                                      DATA6       11                DATA6
        8.5V. 10K Ohms will protect against transients                                  DATA5       12
                                                                                                                      DATA5
        up to 10V.                                     RVBUS                            DATA4       14                DATA4
                                                                 2                      DATA3                         DATA3
                                                                      VBUS              DATA2       15
                                                                                                                      DATA2
                                                                                                    16
                                                                                        DATA1       17
                                                                                                                      DATA1
                                                                                        DATA0       20                DATA0
                                               3.1-5.5V                                    STP      18
                                                                                                                      STP
                                                Supply                                    NXT       19                NXT
                                                                                           DIR      13
                                                                                                                      DIR
        The capacitor CVBUS must be                               3                    CLKOUT                         CLKOUT
                                                                      VBAT             RESETB       22
                                                                                                                      RESETB
        installed on this side of RVBUS.                                                            23
                                                          CBYP                         REFCLK                         Reference
                                                                 4                                 Signal at REFCLK
                     USB
                                                                      VDD3.3
                                                                                                   must comply with
                 Receptacle                        CVBUS       COUT
                                                                                                   VIH and VIL
                                     1
                     VBUS                                                                                            1.8V Supply
                                     2                            5
                        DM                                            DM                VDD18       21
                                     3                           6                                       CBYP
                         DP                                           DP
                                                           NC     1
                  SHIELD                                              ID
                                                                                                    24
                      GND                                         8
                                                                                         RBIAS
                                              CDC_BLOCK               SPKR_L
                                                                                                           8.06k
                                                                 7
                                                                      SPKR_R/M
                                                                                    GND FLAG
                                                                          Optional
                                                                       Switched Signal
                                                                         to DP/DM
                                         Figure 8.1 USB3319 QFN Application Diagram (Device)
Revision 2.1 (06-10-10)                                                    66                                       SMSC USB3319 REV C
                                                                   DATASHEET


Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
Datasheet
        Steady state voltage at the VBUS pin must not be
        allowed to exceed VVMAX.
                                                                                                                Link Controller
                                                                            USB331X
        RVBUS may be installed in this configuration to
                                                                                               D3
        assist in protecting the VBUS pin. 820 Ohms                                    DATA7   E4
                                                                                                                DATA7
        will protect against VBUS transients up to                                     DATA6   D4               DATA6
        8.5V. 10K Ohms will protect against                                            DATA5   E5
                                                                                                                DATA5
        transients up to 10V.                         RVBUS                            DATA4   C4               DATA4
                                                               C1                      DATA3                    DATA3
                                                                     VBUS              DATA2   C5
                                                                                                                DATA2
                                                                                               B4
                                                                                       DATA1   B5
                                                                                                                DATA1
                                                                                       DATA0   A3               DATA0
                                              3.1-5.5V                                    STP  A5
                                                                                                                STP
                                               Supply                                     NXT  A4               NXT
                                                                                          DIR  D5
                                                                                                                DIR
        The capacitor CVBUS must be                            C2                     CLKOUT                    CLKOUT
        installed on this side of RVBUS.                             VBAT             RESETB   B2
                                                                                                                RESETB
                                                                                               A2
                                                         CBYP                         REFCLK                    Reference
                                                               D2                             Signal at REFCLK
                   USB
                                                                     VDD3.3                   must comply with
                Receptacle                        CVBUS       COUT                            VIH and VIL
                                    1
                   VBUS                                                                                        1.8V Supply
                                    2                          D1
                       DM                                            DM                VDD18   B3
                                    3                          E1                                   CBYP
                       DP                                            DP
                                                          NC   B1
                 SHIELD                                              ID
                                                                                               A1
                     GND                                       E3
                                                                                        RBIAS
                                             CDC_BLOCK               SPKR_L
                                                                                                      8.06k
                                                               E2
                                                                     SPKR_R/M
                                                                                      GND
                                                                                         C3
                                                                         Optional
                                                                      Switched Signal
                                                                        to DP/DM
                                         Figure 8.2 USB3319 BGA Application Diagram (Device)
SMSC USB3319 REV C                                                        67                                   Revision 2.1 (06-10-10)
                                                                   DATASHEET


                                                                  Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
                                                                                                                                            Datasheet
                                                                         Voltage at the VBUS pin must not be allowed
                                                                         to exceed VVMAX.                                     Link Controller
                                                                                                                              CPEN
                    RVBUS may be installed in this
                    configuration to assist in protecting
                    the VBUS pin. 820 Ohms will                                 USB331X
                    protect against VBUS transients up
                    to 8.5V.                                                                                   9
                                                                                               DATA7           10
                                                                                                                              DATA7
                                                                                               DATA6           11             DATA6
                        VBUS Switch                                                            DATA5           12
                                                                                                                              DATA5
                                                           RVBUS                               DATA4           14             DATA4
                                                                   2                           DATA3                          DATA3
                         EN OUT                                        VBUS                    DATA2           15
                                                                                                                              DATA2
                                                                                                               16
                         IN                                                                    DATA1           17
                                                                                                                              DATA1
             5V                                                                                DATA0           20             DATA0
                                                 3.1 - 5.5V                                       STP                         STP
                                                                                                               18
                                                   Supply                                         NXT          19             NXT
                                                                   3
                                                                                                  DIR          13
                                                                                                                              DIR
                                                                       VBAT                 CLKOUT                            CLKOUT
                                                                                            RESETB             22
         The capacitor CVBUS must be                      CBYP                                                                RESETB
                                                                                                               23
         installed on this side of RVBUS.
                                                                   4                        REFCLK                            Reference
                                                                       VDD3.3                               Signal at REFCLK
                   USB                                           COUT                                       must comply with
                Receptacle                         CVBUS
                                                                                                            VIH and VIL
                                    1
                   VBUS                                                                                                      1.8V Supply
                                    2                              5
                       DM                                              DM                      VDD18           21
                                    3                              6                                                CBYP
                       DP                                              DP
                                    4                              1
                        ID                                             ID
                                                                                                               24
                     GND                                           8
                                                                                               RBIAS
                                                                       SPKR_L
                 SHIELD                                                                                              8.06k
                                                                   7
                                                                       SPKR_R/M
                                                                                          GND FLAG
                                                                             Optional
                                                                        Switched Signal
                                                                            to DP/DM
                                    Figure 8.3 USB3319 QFN Application Diagram (Host or OTG)
Revision 2.1 (06-10-10)                                                       68                                             SMSC USB3319 REV C
                                                                     DATASHEET


Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
Datasheet
                                                                          Voltage at the VBUS pin must not be allowed
                                                                          to exceed VVMAX.                                     Link Controller
                                                                                                                               CPEN
                     RVBUS may be installed in this
                     configuration to assist in protecting
                     the VBUS pin. 820 Ohms will                                 USB331X
                     protect against VBUS transients up
                     to 8.5V.                                                                                   D3
                                                                                                DATA7                          DATA7
                                                                                                DATA6           E4
                                                                                                                D4
                                                                                                                               DATA6
                         VBUS Switch                                                            DATA5                          DATA5
                                                                                                DATA4           E5
                                                            RVBUS                                               C4
                                                                                                                               DATA4
                                                                  C1                            DATA3                          DATA3
                          EN OUT                                        VBUS                    DATA2           C5
                                                                                                                               DATA2
                                                                                                                B4
                          IN                                                                    DATA1                          DATA1
                                                                                                DATA0           B5
               5V                                                                                               A3
                                                                                                                               DATA0
                                                  3.1 - 5.5V                                       STP                         STP
                                                                                                                A5
                                                    Supply                                         NXT          A4
                                                                                                                               NXT
                                                                   C2
                                                                                                   DIR                         DIR
                                                                        VBAT                 CLKOUT             D5
                                                                                                                               CLKOUT
          The capacitor CVBUS must be                                                        RESETB             B2             RESETB
                                                           CBYP                                                 A2
          installed on this side of RVBUS.
                                                                  D2                         REFCLK                            Reference
                                                                        VDD3.3                               Signal at REFCLK
                    USB                                           COUT                                       must comply with
                 Receptacle                         CVBUS
                                                                                                             VIH and VIL
                                     1
                    VBUS                                                                                                      1.8V Supply
                                     2                            D1
                        DM                                              DM                      VDD18           B3
                                     3                            E1                                                 CBYP
                        DP                                              DP
                                     4                             B1
                         ID                                             ID
                                                                                                                A1
                      GND                                                                       RBIAS
                                                                   E3   SPKR_L
                  SHIELD                                                                                              8.06k
                                                                  E2    SPKR_R/M
                                                                                             GND
                                                                                                  C3
                                                                              Optional
                                                                         Switched Signal
                                                                             to DP/DM
                                   Figure 8.4 USB3319 BGA Application Diagram (Host or OTG)
8.2              USB Charger Detection
                Note: SMSC does not build, specify, design, or sell USB chargers. The following section is provided
                              as a reference to the end user so that they may implement a USB Charger detection method
                              that will work with the chargers selected to work with their end product.
                The examples below are illustrated for reference only and are not intended to dictate a standard for a
                USB Charger. The charger and detection method must be chosen to work together.
                When attached to a USB Host the device is only allowed to draw 100mA until the completion of USB
                enumeration. The USB3319 includes features that can be used to differentiate between a USB Host
                and a Charger.
8.2.1            Detecting the ID Resistor in a Charger
                The ID Resistor Detection feature of the USB3319 described in Section 5.6.1.2 may be used to detect
                a resistor to ground. Some charger manufacturers use 100kΩ to ground at the ID pin of the USB
                connector.
SMSC USB3319 REV C                                                               69                                                  Revision 2.1 (06-10-10)
                                                                       DATASHEET


                                                   Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
                                                                                                                 Datasheet
                Pseudo Algorithm for detecting resistor to ground and reading value
                                 Wait for IdGnd
                                 Enable IdPullup
                                 Set RidConversionStart
                                 Wait for RidConversionDone
                                 Read RidValue
8.2.2           Detecting DP Shorted to DM
                USB Chargers and USB Hosts will present 5V nominal onto the Vbus terminal of the USB connector
                at all times. While in synchronous mode, the Link can detect SessVld in the RXCMD byte as shown
                in Table 6.3. In any of the non-synchronous modes, the Link must monitor the interrupt signal on
                DATA[3] as described in Table 6.4. When an interrupt occurs, the Link commands the USB3319 to exit
                Low Power Mode and reads registers to discover what caused the interrupt.
                In preparation for testing if a charger has connected the DP and DM pins in the USB connector, the
                DP and DM pins of the USB3319 must be placed into Non-Driving, FS mode using the Full Speed
                transceivers. This is done by writing 49h to the Function Control register at address 04h. Next, pull-up
                resistors can be enabled on the DP and DM pins. As described in Section 5.8, the pull-up resistors
                may be enabled individually. For example, setting bit 4 in the USB IO & Power Management register
                at address 3Ah will connect the ChargerPullupEnableDP resistor.
                The linestate signals are monitored to determine whether the DP and DM pins are shorted. While in
                synchronous mode, the Link can monitor Linestate0 and Linestate1 in the RXCMD byte as shown in
                Table 6.3, or by reading the Debug register. In any of the non-synchronous modes, the Link can
                monitor linestate on DATA[0] and DATA[1] as described in Table 6.4. The DC Electrical Characteristics
                of the Single-Ended Receivers used to generate the linestate signals are provided in Table 4.5.
                Pseudo Algorithm for detecting voltage at Vbus and detecting DP shorted to DM
                                 Wait for SessVld
                                 Tri-State DP/DM and select FS transceivers
                                 Enable ChargerPullupEnableDP resistor
                                 Enable ChargerPullupEnableDM resistor
                                 If the linestates show a SE1 the charger has been detected.
                                 If the linestates show an SE0 you are connected to a host.
8.3             Reference Designs
                SMSC has generated reference designs for connecting the USB3319 to SOCs with a ULPI port. Please
                contact the SMSC sales office for more details.
8.4             ESD Performance
                The USB3319 is protected from ESD strikes. By eliminating the requirement for external ESD
                protection devices, board space is conserved, and the board manufacturer is enabled to reduce cost.
                The advanced ESD structures integrated into the USB3319 protect the device whether or not it is
                powered up.
8.4.1           Human Body Model (HBM) Performance
                HBM testing verifies the ability to withstand the ESD strikes like those that occur during handling and
                manufacturing, and is done without power applied to the IC. To pass the test, the device must have
                no change in operation or performance due to the event. All pins on the USB3319 except the REFCLK
                pin provide ±8kV HBM protection, as shown in Table 4.10.
8.4.2           EN/IEC 61000-4-2 Performance
                The EN/IEC 61000-4-2 ESD specification is an international standard that addresses system-level
                immunity to ESD strikes while the end equipment is operational. In contrast, the HBM ESD tests are
                performed at the device level with the device powered down.
Revision 2.1 (06-10-10)                                      70                                        SMSC USB3319 REV C
                                                     DATASHEET


Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
Datasheet
              SMSC contracts with Independent laboratories to test the USB3319 to EN/IEC 61000-4-2 in a working
              system. Reports are available upon request. Please contact your SMSC representative, and request
              information on 3rd party ESD test results. The reports show that systems designed with the USB3319
              can safely provide the ESD performance shown in Table 4.10 without additional board level protection.
              In addition to defining the ESD tests, EN/IEC 61000-4-2 also categorizes the impact to equipment
              operation when the strike occurs (ESD Result Classification). The USB3319 maintains an ESD Result
              Classification 1 or 2 when subjected to an EN/IEC 61000-4-2 (level 4) ESD strike.
              Both air discharge and contact discharge test techniques for applying stress conditions are defined by
              the EN/IEC 61000-4-2 ESD document.
8.4.3         Air Discharge
              To perform this test, a charged electrode is moved close to the system being tested until a spark is
              generated. This test is difficult to reproduce because the discharge is influenced by such factors as
              humidity, the speed of approach of the electrode, and construction of the test equipment.
8.4.4         Contact Discharge
              The uncharged electrode first contacts the USB connector to prepare this test, and then the probe tip
              is energized. This yields more repeatable results, and is the preferred test method. The independent
              test laboratories contracted by SMSC provide test results for both types of discharge methods.
SMSC USB3319 REV C                                          71                                 Revision 2.1 (06-10-10)
                                                      DATASHEET


                                                     Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
                                                                                                                  Datasheet
    Figure 9.1 24-pin QFN, 4x4mm Body, 0.5mm Pitch
                                                                                                                         Chapter 9 Package Outline, Tape & Reel Drawings, Package Markings
SMSC USB3319 REV C                                           72                                        Revision 2.1 (06-10-10)
                                                         DATASHEET


Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
Datasheet
                                                                            Figure 9.2 QFN, 4x4 Tape & Reel
Revision 2.1 (06-10-10)                                    73               SMSC USB3319 REV C
                                                       DATASHEET


                                                                Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
                                                                                                                             Datasheet
             Figure 9.3 25-Pin VFBGA, 3x3mm Body, 0.5mm Pitch
SMSC USB3319 REV C                                                      74                                        Revision 2.1 (06-10-10)
                                                                    DATASHEET


Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
Datasheet
                                                                                          Figure 9.4 VFBGA, 3x3 Tape & Reel
Revision 2.1 (06-10-10)                                    75               SMSC USB3319 REV C
                                                       DATASHEET


                                               Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
                                                                                                             Datasheet
                                            Figure 9.5 Reel Dimensions
                Note: Standard reel size is 4000 pieces per reel.
Revision 2.1 (06-10-10)                                  76                                        SMSC USB3319 REV C
                                                 DATASHEET


Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
Datasheet
                                        Figure 9.6 QFN, 4x4 Package Marking
                                      Figure 9.7 VFBGA, 3x3 Package Marking
SMSC USB3319 REV C                                          77              Revision 2.1 (06-10-10)
                                                      DATASHEET


                                            Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
                                                                                                          Datasheet
Chapter 10 Datasheet Revision History
                                  Table 10.1 Customer Revision History
 REVISION LEVEL AND
            DATE            SECTION/FIGURE/ENTRY                                CORRECTION
          Rev. 2.1       Cover Section: Changed references to OTG Specification Revision 1.3 to Revision
         (06-10-10)       2.0.
                         Section 7.1.4.1: Removed -3.7% TX Boost.
                         Section 6.6, Section 7.1: Added Headset Audio Mode definition
          Rev. 2.0       Table 4.3: Changed Tdc,Tdd MIN to 1.5ns.
         (06-11-09)      Table 4.5: Vhssq redefined. Note 4.6 added.
                         Modified definition of ID bit in Table 6.3.
                         Corrections made to column “IDGND” in Table 5.4
                         Corrected IdGnd Comparator in Figure 5.7.
                         Added Figure 9.6, "QFN, 4x4 Package Marking" and Figure 9.7, "VFBGA, 3x3
                          Package Marking" in Chapter 9.
                         Added QFN package information
          Rev. 1.12     Table 4.4                             Max column for CLKOUT External Drive changed
         (11-05-08)                                           from “0.68 * VDDIO” to “0.4 * VDD18”
          Rev. 1.12     Table 4.4                             Changed table title from: “Electrical
         (10-31-08)                                           Characteristics - Digital IO Pins: RESETB, STP,
                                                              DIR, NXT, DATA[7:0] & REFCLK Pins”
                                                              To: "Digital IO Characteristics: RESETB, STP,
                                                              DIR, NXT, DATA[7:0] and REFCLK Pins"
                                                              Added row for “CLKOUT External Drive”
          Rev. 1.12     Section 5.4, "Integrated Low          Added the following sentence: The system must
         (10-31-08)     Jitter PLL"                           not drive voltage on the CLKOUT pin following
                                                              POR or hardware reset that exceeds the value of
                                                              VIH_ED provided in Table 4.4.
          Rev. 1.12     Section 8.1, "Application             Added the following note: “Following POR or
         (10-31-08)     Diagram"                              hardware reset, the voltage at CLKOUT must not
                                                              exceed VIH-ED.”
          Rev. 1.12     Section 2.1.2, "Pin Definitions"      Added to description for “CLKOUT”: “The system
         (10-31-08)                                           must not drive voltage on the CLKOUT pin
                                                              following POR or hardware reset that exceeds the
                                                              value of VIH_ED provided in Table 4.4.”
          Rev. 1.12     Figure 9.4, "VFBGA, 3x3 Tape &        Updated diagram
         (10-27-08)     Reel"
          Rev. 1.12     Figure 4.1 - External Reference       Removed figure
         (08-26-08)     Clock
          Rev. 1.12     Section 5.4, "Integrated Low          Paragraph added
         (08-26-08)     Jitter PLL"
          Rev. 1.12     Section 5.6, "USB On-The-Go           Removed: “The OTG Module is described in the
         (08-26-08)     (OTG)"                                following sections.”
          Rev. 1.12     Table 7.1, "ULPI Register Map"        Address for Reserved register changed from “22-
         (08-26-08)                                           35h” to “22-30h”
Revision 2.1 (06-10-10)                               78                                        SMSC USB3319 REV C
                                              DATASHEET


Hi-Speed USB Transceiver with 1.8V ULPI Interface - 13MHz Reference Clock
Datasheet
                                 Table 10.1 Customer Revision History (continued)
 REVISION LEVEL AND
           DATE                   SECTION/FIGURE/ENTRY                                CORRECTION
         Rev. 1.12            Section 7.1.1.10, "USB Interrupt       Access column: “rd” added for each field name
        (08-26-08)            Status"
         Rev. 1.11            Section 8.2.2                          “Enable ChargerPullupEnableDM resistor” added
        (08-05-08)
         Rev. 1.11                                        QFN Package removed for Rev D.
        (08-18-08)
         Rev. 1.11            HS TX Boost                            Added information regarding the HS TX Boost
        (08-12-08)                                                   feature.
         Rev. 1.10            Section 7.1.1.3, "Product ID           Default column changed from “01h” to “06h”
        (07-25-08)            Low"
         Rev. 1.10            Section 7.1.1.10, "USB Interrupt       Changed from : “Address = 13h (read only with
        (07-09-08)            Status"                                auto clear)”
                                                                     to: “Address = 13h (read only)”;
                                                                     Note removed
          Rev. 1.9            Chapter 4, Electrical                  Changed conditions at beginning of chapter to
        (06-19-08)            Characteristics                        include VVBAT.
          Rev. 1.9            Table 3.2, "Recommended                Made separate entry for VVBAT and VBUS. For
        (06-19-08)            Operating Conditions"                  normal operation, VVBAT cannot be zero.
          Rev. 1.8            Section 5.6, "USB On-The-Go            Changed Mini-AB connector to Micro-AB
        (05-02-08)            (OTG)"                                 receptacle.
SMSC USB3319 REV C                                          79                                     Revision 2.1 (06-10-10)
                                                      DATASHEET


Mouser Electronics
Authorized Distributor
Click to View Pricing, Inventory, Delivery & Lifecycle Information:
Microchip:
 USB3319C-GJ-TR
