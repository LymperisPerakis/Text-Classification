                                                                                                                STUSB1700
              USB Type-C™ source controller with high voltage protections
                                                                                                            Datasheet - preliminary data
                                                                            Applications
                                                                            • Automotive: USB car chargers (single and dual
                                                                                port), 12 V car chargers accessories,
                                                                                infotainment systems
                                                                            • Smart plugs, wall adapters and chargers
Features                                                                    • Power hubs and docking stations
• Single power role support: source mode                                    • Notebook host port
• Type-C attach and cable orientation detection                             • LCD monitors & TV
• Configurable current advertising through                                  • Power bank
    external control pins                                                   • Any Type-C source device
• Configurable start-up profiles through NVM
• Integrated VBUS voltage monitoring and                                    Description
    discharge path
• Short-to-VBUS protections on CC pins (22 V)                               The STUSB1700 is an IC controller, fully
    and VBUS pins (28 V)                                                    compliant with the USB Type-C cable and
                                                                            connector specification (rev. 1.2), which
• High and/or low voltage power supply:
                                                                            addresses 5 V USB Type-C port management on
    – VSYS = [3.0 V; 5.5 V]
                                                                            the host side. It is fully autonomous and allows
    – VDD = [4.1 V; 22 V]
                                                                            the advertising of the current capability to be
• Integrated power switch for VCONN supply:                                 managed by external pins. It is suited to
    – programmable current limit up to 600 mA                               implement power sharing capabilities, or external
    – overcurrent, overvoltage and thermal                                  temperature protection mechanism with current
          protection                                                        capability adjustment.
    – undervoltage lockout                                                  The STUSB1700 is designed for a broad range of
• Integrated VCONN discharge path                                           applications and can handle the following USB
• Accessory mode support                                                    Type-C functions: attach detection, plug
                                                                            orientation detection, host to device connection,
• I2C interface and interrupt (optional connection                          VCONN support, and VBUS configuration. Thanks
    to MCU)                                                                 to its 20 V technology, it implements high voltage
• Temperature range: -40 °C up to 105 °C                                    protection features against short-circuits to VBUS
• ESD: 4 kV HBM - 1.5 kV CDM                                                up to 28 V. The device is fully customizable
                                                                            thanks to an integrated non-volatile memory.
• AEC-Q100 qualified
• Certification test ID 1100100
                                                         Table 1. Device summary
          Order code                     AEC-Q100                  USB Type-C                        Package               Marking
                                                                                           QFN24 EP 4x4 mm
 STUSB1700YQTR                               Yes              Rev 1.2 +ECR                                                  1700Y
                                                                                           wettable flanks
December 2017                                                DocID030977 Rev 1                                                      1/56
This is preliminary information on a new product now in development or undergoing evaluation. Details are subject to           www.st.com
change without notice.


Contents                                                                                                              STUSB1700
Contents
1        Functional description . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5
         1.1   Block overview . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5
2        Inputs / Outputs . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6
         2.1   Pinout . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6
         2.2   Pin list . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7
         2.3   Pin description . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9
               2.3.1      CC1 / CC2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9
               2.3.2      CC1GND / CC2GND . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9
               2.3.3      VCONN . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9
               2.3.4      RESET . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9
               2.3.5      I²C interface pins . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9
               2.3.6      GND . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9
               2.3.7      VBUS_VALID . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9
               2.3.8      ATTACH . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10
               2.3.9      RP_HIGH / RP_DEF . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10
               2.3.10     ACC_DETECT . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10
               2.3.11     A_B_SIDE . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10
               2.3.12     VBUS_SENSE . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10
               2.3.13     VBUS_EN_SRC . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10
               2.3.14     VREG_1V2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11
               2.3.15     VSYS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11
               2.3.16     VREG_2V7 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11
               2.3.17     VDD . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11
3        Features description . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12
         3.1   CC interface . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12
         3.2   VBUS power path control . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12
               3.2.1      VBUS monitoring . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12
               3.2.2      VBUS discharge . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13
               3.2.3      VBUS power path assertion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13
         3.3   VCONN supply . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15
               3.3.1      VCONN input voltage . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15
               3.3.2      VCONN application conditions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15
2/56                                        DocID030977 Rev 1


STUSB1700                                                                                                        Contents
                 3.3.3    VCONN monitoring . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15
                 3.3.4    VCONN discharge . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15
                 3.3.5    VCONN control and status . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15
                 3.3.6    VCONN power switches . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15
          3.4    Low power standby mode . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17
          3.5    High voltage protection . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17
          3.6    Hardware fault management . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18
          3.7    Accessory modes detection . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18
                 3.7.1    Audio accessory mode detection . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18
                 3.7.2    Debug accessory mode detection . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18
4         I²C interface . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20
          4.1    Read and write operations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20
          4.2    Timing specifications . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21
5         I²C register map . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 23
          5.1    Register description . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25
                 5.1.1    ALERT_STATUS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25
                 5.1.2    ALERT_STATUS_MASK_CTRL . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26
                 5.1.3    CC_CONNECTION_STATUS_TRANS . . . . . . . . . . . . . . . . . . . . . . . . . 26
                 5.1.4    CC_CONNECTION_STATUS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 27
                 5.1.5    MONITORING_STATUS_TRANS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28
                 5.1.6    MONITORING_STATUS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28
                 5.1.7    CC_OPERATION_STATUS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30
                 5.1.8    HW_FAULT_STATUS_TRANS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 32
                 5.1.9    HW_FAULT_STATUS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 33
                 5.1.10   CC_CAPABILITY_STATUS_CTRL . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34
                 5.1.11   CC_VCONN_SWITCH_CTRL . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 35
                 5.1.12   VCONN_MONITORING_CTRL . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 35
                 5.1.13   VBUS_MONITORING_RANGE_CTRL . . . . . . . . . . . . . . . . . . . . . . . . . 36
                 5.1.14   RESET_CTRL . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 36
                 5.1.15   VBUS_DISCHARGE_TIME_CTRL . . . . . . . . . . . . . . . . . . . . . . . . . . . . 37
                 5.1.16   VBUS_DISCHARGE_STATUS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 37
                 5.1.17   VBUS_ENABLE_STATUS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 37
                 5.1.18   VBUS_MONITORING_CTRL . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38
6         Start-up configuration . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 40
                                         DocID030977 Rev 1                                                                 3/56
                                                                                                                                56


Contents                                                                                                      STUSB1700
         6.1    User-defined parameters . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 40
         6.2    Default start-up configuration . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 40
7        Application . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 42
         7.1    General information . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 42
                7.1.1    Power supplies . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 42
                7.1.2    Connection to MCU or application processor . . . . . . . . . . . . . . . . . . . . 42
         7.2    USB Type-C typical applications . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 43
                7.2.1    Source type application with Rp = 3A . . . . . . . . . . . . . . . . . . . . . . . . . . 43
                7.2.2    VBUS power path assertion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 44
                7.2.3    Device state according to connection state . . . . . . . . . . . . . . . . . . . . . . 44
8        Electrical characteristics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 46
         8.1    Absolute maximum rating . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 46
         8.2    Operating conditions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 47
         8.3    Electrical and timing characteristics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 48
9        Package information . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 51
         9.1    QFN-24 EP (4 x 4 mm) Wet Flk package information . . . . . . . . . . . . . . . 51
         9.2    Thermal information . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 53
10       Terms and abbreviations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 54
11       Revision history . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 55
4/56                                    DocID030977 Rev 1


STUSB1700                                                                     Functional description
1         Functional description
          The STUSB1700 is a USB Type-C controller IC. It is designed to interface with the Type-C
          receptacle on the host side. It is used to establish and manage the source-to-sink
          connection between two USB Type-C host and device ports.
          The STUSB1700 major role is to:
          1.  Detect the connection between two USB Type-C ports (attach detection).
          2.  Establish a valid source-to-sink connection.
          3.  Determine the attached device mode: sink or accessory.
          4.  Resolve cable orientation and twist connections to establish USB data routing (mux
              control).
          5.  Configure and monitor VBUS power path.
          6.  Manage VBUS power capability: USB default, Type-C medium or Type-C high current
              mode.
          7.  Configure VCONN when required.
          The STUSB1700 also provides:
          •   Low power standby mode
          •   I2C interface and interrupt (optional connection to the MCU)
          •   Start-up configuration customization: static through NVM and/or dynamic through I2C
          •   High voltage protection
          •   Accessory mode detection
1.1       Block overview
                                     Figure 1. Functional block diagram
                                          DocID030977 Rev 1                                     5/56
                                                                                                     56


Inputs / Outputs                                               STUSB1700
2           Inputs / Outputs
2.1         Pinout
                           Figure 2. STUSB1700 pin connections
6/56                           DocID030977 Rev 1


STUSB1700                                                                          Inputs / Outputs
2.2       Pin list
                                     Table 2. Pin function list
           Pin      Name    Type                   Description                 Typical connection
            1     CC1GND    GND    Ground reference channel 1                Ground
            2       CC1    HV AIO Type-C configuration channel 1             Type-C receptacle A5
            3      VCONN    PWR    Power input for active plug               5 V power source
            4       CC2    HV AIO Type-C configuration channel 2             Type-C receptacle B5
            5     CC2GND    GND    Ground reference channel 2                Ground
            6      RESET     DI    Reset input (active high)
                                                                             To I²C master, ext. pull-
            7        SCL     DI    I2C clock input
                                                                             up
                                   I2C data input/output, active low open    To I²C master, ext. pull-
            8       SDA    DI/OD
                                   drain                                     up
                                                                             To I²C master, ext. pull-
            9     ALERT#     OD    I2C interrupt, active low open drain
                                                                             up
           10       GND     GND    Ground                                    Ground
                                                                             To MCU if any, ext.
           11   VBUS_VALID   OD    VBUS detection, active low open drain
                                                                             pull-up
                                   Attachment detection, active low open     To MCU if any, ext.
           12     ATTACH     OD
                                   drain                                     pull-up
                                   I²C device address setting
           13      ADDR0     DI                                              Static
                                   (see Section 4: I²C interface)
                                   Logic level input to select between 1.5 A
           14     RP_HIGH    DI    and 3.0 A USB Type-C current              Static or to MCU if any
                                   advertising
                                   Logic level input to select between USB
           15     RP_DEF     DI    default current (500 mA or 900mA) or      Static or to MCU if any
                                   USB Type-C current advertising
                                   Accessory device detection, active low    To MCU if any, ext.
           16   ACC_DETECT   OD
                                   open drain                                pull-up
                                                                             USB super speed mux
           17    A_B_SIDE    OD    Cable orientation, active low open drain
                                                                             select, ext. pull-up
                                   VBUS voltage monitoring and discharge
           18   VBUS_SENSE  HV AI                                            From VBUS
                                   path
           19        NC       -    -                                         Floating
                                   VBUS source power path enable, active     To switch or power
           20  VBUS_EN_SRC HV OD
                                   low open drain                            system, ext. pull-up
                                                                             1 µF typ. decoupling
           21    VREG_1V2   PWR    1.2 V internal regulator output
                                                                             capacitor
                                                                             From power system,
           22       VSYS    PWR    Power supply from system                  connect to ground if not
                                                                             used
                                  DocID030977 Rev 1                                               7/56
                                                                                                       56


Inputs / Outputs                                                                           STUSB1700
                                              Table 2. Pin function list
             Pin     Name            Type                   Description           Typical connection
                                                                                1 µF typ. decoupling
             23    VREG_2V7          PWR     2.7 V internal regulator output
                                                                                capacitor
                                      HV
             24       VDD                    Power supply from USB power line   From VBUS
                                     PWR
              -        EP            GND     Exposed pad is connected to ground To ground
                                        Table 3. Pin function descriptions
              Type                  Description
                 D   Digital
                 A   Analog
                 O   Output pad
                 I   Input pad
                IO   Bidirectional pad
                OD   Open drain output
                PD   Pull-down
                PU   Pull-up
                HV   High voltage
              PWR    Power
              GND    Ground
8/56                                       DocID030977 Rev 1


STUSB1700                                                                                  Inputs / Outputs
2.3       Pin description
2.3.1     CC1 / CC2
          CC1 and CC2 are the configuration channel pins used for connection and attachment
          detection, plug orientation determination and system configuration management across
          USB Type-C cable.
2.3.2     CC1GND / CC2GND
          CC1GND and CC2GND are used as a reference to ground and must be connected to
          ground.
2.3.3     VCONN
          This power input is connected to a power source that can be a 5 V power supply, or a lithium
          battery. It is used to provide power supply to the local plug. It is internally connected to
          power switches that are protected against short circuit and overvoltage. This does not
          require any protection on the input side. When a valid source-to-sink connection is
          determined and VCONN power switches enabled, VCONN is provided by the source to the
          unused CC pin (see Section 3.3: VCONN supply).
2.3.4     RESET
          Active high reset.
2.3.5     I²C interface pins
                                             Table 4. I2C interface pins list
               Name                                              Description
                SCL          I²C clock – need external pull-up
                SDA          I²C data – need external pull-up
              ALERT#         I²C interrupt – need external pull-up
              ADDR0          I²C device address bit (see Section 4: I²C interface)
2.3.6     GND
          Ground.
2.3.7     VBUS_VALID
          This pin is asserted during attachment when VBUS is detected on VBUS_SENSE pin and
          VBUS voltage is within the valid operating range. The VBUS valid state is also advertised in
          a dedicated I2C register bit (see Section 5.1: Register description).
                                              DocID030977 Rev 1                                         9/56
                                                                                                             56


Inputs / Outputs                                                                                 STUSB1700
2.3.8       ATTACH
            This pin is asserted when a valid source-to-sink connection is established. It is also asserted
            when a connection to an accessory device is detected. The attachment state is also
            advertised in a dedicated I2C register bit (see Section 5.1: Register description).
2.3.9       RP_HIGH / RP_DEF
            These input pins are used to adjust externally the Rp value on the CC pins to advertise the
            current capability the source can supply as defined in the USB Type-C standard
            specification. These pins can be used dynamically to implement systems with power-
            sharing capabilities or with external temperature protection mechanism to adapt the current
            capability to the system temperature.
                           Table 5. USB Type-C current advertising with RP control pins
                 USB Type-C           RP_DEF        RP_HIGH
                                                                           Source current capability
                   Rp value         Logic level    Logic level
               Rp = Default USB           0             X           Default USB current (500 mA or 900 mA)
                  Rp = 1.5 A              1             0                  1.5 A USB Type-C current
                   Rp = 3 A               1             1                  3.0 A USB Type-C current
2.3.10      ACC_DETECT
            This pin is asserted when an audio accessory device or a debug accessory device is
            detected (see Section 3.7: Accessory modes detection).
2.3.11      A_B_SIDE
            This output pin provides cable orientation. It is used to establish USB SuperSpeed signals
            routing. The cable orientation is also provided by an internal I2C register (see Section 5.1:
            Register description. This signal is not required in case of USB 2.0 support.
                                              Table 6. USB data mux select
                    Value                                      CC pin position
                     HiZ                                 CC1 pin is attached to CC line
                      0                                  CC2 pin is attached to CC line
2.3.12      VBUS_SENSE
            This input pin is used to sense VBUS presence, monitor VBUS voltage and discharge VBUS
            on USB Type-C receptacle side.
2.3.13      VBUS_EN_SRC
            This pin allows the outgoing VBUS power to be enabled when the connection to a sink is
            established and VBUS is in the valid operating range. The open drain output allows a PMOS
            transistor to be directly driven. The logic value of the pin is also advertised in a dedicated
            I2C register bit (see Section 5.1: Register description).
10/56                                        DocID030977 Rev 1


STUSB1700                                                                                Inputs / Outputs
2.3.14    VREG_1V2
          This pin is used only for external decoupling of 1.2 V internal regulator. The recommended
          decoupling capacitor is: 1 µF typ. (0.5 µF min; 10 µF max).
2.3.15    VSYS
          This is the low power supply from the system, if any. It can be connected directly to a single
          cell Lithium battery or to the system power supply delivering 3.3 V or 5 V. It is recommended
          to connect the pin to ground when it is not used.
2.3.16    VREG_2V7
          This pin is used only for external decoupling of 2.7 V internal regulator. The recommended
          decoupling capacitor: 1 µF typ. (0.5 µF min; 10 µF max).
2.3.17    VDD
          This is the power supply from the USB power line for applications powered by VBUS.
          This pin can be used to sense the voltage level of the main power supply providing the
          VBUS. It allows UVLO and OVLO thresholds to be considered independently on the VDD pin
          as additional conditions to enable the VBUS power path through VBUS_EN_SRC pin (see
          Section 3.2.3: VBUS power path assertion). When the UVLO threshold detection is enabled,
          the VDD pin must be connected to the main power supply to establish the connection and to
          assert the VBUS power path.
                                           DocID030977 Rev 1                                         11/56
                                                                                                           56


Features description                                                                           STUSB1700
3          Features description
3.1        CC interface
           The STUSB1700 controls the connection to the configuration channel (CC) pins, CC1 and
           CC2, through two main blocks, the CC line interface block and the CC control logic block.
           The CC lines interface block is used to:
           •      Configure the pull-up termination mode on the CC pins
           •      Monitor the CC pin voltage values relative to the attachment detection thresholds
           •      Configure VCONN on the unconnected CC pin when required
           •      Protect the CC pins against over voltage
           The CC control logic block is used to:
           •      Execute the Type-C FSM relative to the Type-C source power mode
           •      Determine the electrical state for each CC pin relative to the detected thresholds
           •      Evaluate the conditions relative to the CC pin states and the VBUS voltage value to
                  transition from one state to another in the Type-C FSM
           •      Detect and establish a valid source-to-sink connection
           •      Determine the attached device mode: sink or accessory
           •      Determine cable orientation to allow external routing of the USB data
           •      Manage VBUS power capability: USB default, Type-C medium or Type-C high current
                  mode
           •      Handle hardware faults.
           The CC control logic block implements the Type-C FSM corresponding to the source power
           role with accessory support.
3.2        VBUS power path control
3.2.1      VBUS monitoring
           The VBUS monitoring block supervises from the VBUS_SENSE pin the VBUS voltage on the
           USB Type-C receptacle side.
           It is used to check that VBUS is within a valid voltage range:
           •      to establish a valid source-to-sink connection according to USB Type-C standard
                  specification,
           •      to enable safely the VBUS power path through VBUS_EN_SRC pin.
           It allows to detect unexpected VBUS voltage conditions such as under voltage or over
           voltage relative to the valid VBUS voltage range. When such conditions occur, the
           STUSB1700 reacts as follows:
           •      at attachment, it prevents the source-to-sink connection and the VBUS power path
                  assertion,
           •      after attachment, it deactivates the source-to-sink connection, disables the VBUS power
                  path and goes into error recovery state.
12/56                                        DocID030977 Rev 1


STUSB1700                                                                          Features description
          The valid VBUS voltage range is defined from the VBUS nominal voltage by a high threshold
          voltage and a low threshold voltage whose nominal values are respectively VBUS+5% and
          VBUS-5%. The nominal threshold limits can be shifted by fraction of VBUS from +1% to +15%
          for the high threshold voltage and from -1% to -15% for the low threshold voltage. It means
          the threshold limits can vary from VBUS+5% to VBUS+20% for the high limit and from VBUS-
          5% to VBUS-20% for the low limit.
          The threshold limits are preset by default in the NVM with different shift coefficients (see
          Section 8.3: Electrical and timing characteristics). The threshold limits can be changed
          independently through NVM programming (see Section 6: Start-up configuration) and also
          by software during attachment through the I2C interface (see Section 5.1: Register
          description).
3.2.2     VBUS discharge
          The monitoring block also handles the internal VBUS discharge path connected to the
          VBUS_SENSE pin. The discharge path is activated at detachment, or when the device goes
          into the error recovery state (see Section 3.6: Hardware fault management).
          The VBUS discharge path is enabled by default in the NVM and can be disabled through
          NVM programming only (see Section 6: Start-up configuration). The discharge time duration
          is also preset by default in the NVM (see Section 8.3: Electrical and timing characteristics).
          The discharge time duration can be changed through NVM programming (see Section 6:
          Start-up configuration) and also by software through the I2C interface (see Section 5.1:
          Register description).
3.2.3     VBUS power path assertion
          The STUSB1700 can control the assertion of the VBUS power path on the USB Type-C port,
          directly or indirectly, through the VBUS_EN_SRC pin.
          The tables below summarize the configurations of the STUSB1700 and the operation
          conditions that determine the electrical value of the VBUS_EN_SRC pin during system
          operation.
                                            DocID030977 Rev 1                                        13/56
                                                                                                           56


Features description                                                                             STUSB1700
            Table 7. Conditions for VBUS power path assertion in source power role
                                                          Operation conditions
                 Electrical
      Pin
                    value      Type-C attached           VDD pin        VBUS_SENSE pin
                                                                                                 Comment
                                     state            monitoring            monitoring
                                                                       VBUS < VMONUSBH and
                            Attached.SRC          VDD > VDDUVLO if
                                                                       VBUS > VMONUSBL if    The signal is
                            or                    UVLO threshold
                                                                       VBUS voltage range    asserted only if
                            UnorientedDebug       detection enabled
                                                                       detection enabled     all the valid
                      0     Accessory.SRC         and/or
                                                                       or                    operation
                            or                    VDD < VDDOVLO if
                                                                       VBUS > VTHUSB if VBUS conditions are
                            OrientedDebug         OVLO threshold
                                                                       voltage range         met.
                            Accessory.SRC         detection enabled
                                                                       detection disabled
 VBUS_EN_SRC
                                                                       VBUS > VMONUSBH or
                                                  VDD < VDDUVLO if
                                                                       VBUS < VMONUSBL if
                                                  UVLO threshold                             The signal is de-
                                                                       VBUS voltage range
                                                  detection enabled                          asserted when at
                                                                       detection enabled
                     HiZ    Any other state       or                                         least one non
                                                                       or
                                                  VDD > VDDOVLO if                           valid operation
                                                                       VBUS < VTHUSB if VBUS
                                                  OVLO threshold                             condition is met.
                                                                       voltage range
                                                  detection enabled
                                                                       detection disabled
           As specified in the USB Type-C standard specification, the attached state “Attached.SRC” is
           reached only if the voltage on the VBUS receptacle side is at vSafe0V condition when a
           connection is detected.
           "Type-C attached state” refers to the Type-C FSM states as defined in the USB Type-C
           standard specification and as described in the I2C register CC_OPERATION_STATUS (see
           Section 5.1: Register description).
           “VDD pin monitoring” refers to the UVLO and OVLO thresholds detection on VDD pin that
           can be activated through NVM programming (see Section 6: Start-up configuration) and
           also by software through the I2C interface (see Section 5.1: Register description). When the
           UVLO and/or OVLO threshold detection is activated, the VBUS_EN_SRC pin is asserted
           only if the device is attached and the valid threshold conditions on VDD are met. Once the
           VBUS_EN_SRC pin is asserted, the VBUS monitoring is done on VBUS_SENSE pin instead
           of the VDD pin.
           “VBUS_SENSE pin monitoring” relies, by default, on a valid VBUS voltage range defined by
           a high limit VMONUSBH and a low limit VMONUSBL. The voltage range condition can be
           disabled to consider UVLO threshold detection instead. The monitoring condition of the
           VBUS voltage can be changed through NVM programming (see Section 6: Start-up
           configuration) and also by software through the I2C interface (see Section 5.1: Register
           description). The VBUS_EN_SRC pin is maintained asserted as long as the device is
           attached and a valid voltage condition on the VBUS is met.
           See Section 8.3: Electrical and timing characteristics for the threshold voltages description
           and value on VDD and VBUS_SENSE pins.
14/56                                       DocID030977 Rev 1


STUSB1700                                                                            Features description
3.3       VCONN supply
3.3.1     VCONN input voltage
          VCONN is a regulated supply used to power circuits in the plug of USB3.1 full-featured
          cables and other accessories. VCONN nominal operating voltage is 5.0 V +/- 5%.
3.3.2     VCONN application conditions
          The VCONN pin of the STUSB1700 is connected to each CC pin (CC1 and CC2) across
          independent power switches.
          The STUSB1700 applies VCONN only to the CC pin not connected to the CC wire when all
          below conditions are met:
          •     VCONN power switches are enabled
          •     A valid connection to a sink is achieved
          •     Ra presence is detected on the unwired CC pin
          •     A valid power source is applied to the VCONN pin with respect to a predefined UVLO
                threshold.
3.3.3     VCONN monitoring
          The VCONN monitoring block detects whether VCONN power supply is available on the
          VCONN pin. It is used to check that VCONN voltage is above a pre-defined under-voltage
          lockout (UVLO) threshold to allow the enabling of the VCONN power switches.
          The default value of the UVLO threshold is 4.65 V typical for powered cables operating at 5
          V. It can be changed by software to 2.65 V typical to support VCONN-powered accessories
          that are operating down to 2.7 V (see Section 5.1: Register description).
3.3.4     VCONN discharge
          The behavior of Type-C FSMs is extended with an internal VCONN discharge path capability
          on CC pins in Source power role. The discharge path is activated during 250 ms from Sink
          detachment detection. This feature is disabled by default. It can be activated through NVM
          programming (see Section 6: Start-up configuration) and also by software through the I2C
          interface (see Section 5.1: Register description).
3.3.5     VCONN control and status
          The supplying conditions of VCONN across STUSB1700 are managed through the I2C
          interface. Different I2C registers and bits are used specifically for this purpose (see
          Section 5.1: Register description).
3.3.6     VCONN power switches
          The STUSB1700 integrates two current limited high-side power switches with protections
          that tolerate high voltage up to 22 V on the CC pins.
                                          DocID030977 Rev 1                                         15/56
                                                                                                          56


Features description                                                                          STUSB1700
           Each VCONN power switch is presenting the following features:
           •    Soft-start to limit inrush current
           •    Constant current mode over-current protection
           •    Adjustable current limit
           •    Thermal protection
           •    Under-voltage and over-voltage protections
           •    Reverse current and reverse voltage protections
                         Figure 3. VCONN to CC1 and CC2 power switches protections
           Current limit programming
           The current limit can be set within the range 100 mA to 600 mA by step of 50 mA. The
           default current limit is programmed through NVM programming (see Section 6: Start-up
           configuration) and can be changed by software through I2C interface (see Section 5.1:
           Register description). At power-on or after a reset, the current limit takes the default value
           preset in the NVM.
           Fault management
           The table below summarizes the different fault conditions that could occur during operation
           of the switch and the associated responses. An I2C alert is generated when a fault condition
           happens (see Section 5.1: Register description).
16/56                                       DocID030977 Rev 1


STUSB1700                                                                               Features description
                                       Table 8. Fault management conditions
              Fault types             Fault conditions                       Expected actions
                               CC output pin shorted to
                                                             Power switch limits the current and reduces the
                               ground via very low resistive
           Short-circuit                                     output voltage. I2C alert is asserted immediately
                               path causing rapid current
                                                             thanks to VCONN_SW_OCP_FAULT bits.
                               surge.
                               CC output pin connected to a Power switch limits the current and reduces the
           Over-current        load that sinks current above output voltage. I2C alert is asserted immediately
                               programmed limit.             thanks to VCONN_SW_OCP_FAULT bits.
                                                             Power switch is disabled immediately until the
                               Junction temperature          temperature falls below 145 ° minus hysteresis
           Over-heating        exceeding 145 °C due to any of 15 °C. I2C alert is asserted immediately
                               reason.                       thanks to THERMAL_FAULT bit. STUSB1700
                                                             goes into transient error recovery state.
                                                             Power switch is disabled immediately until the
                               VCONN input voltage drops
                                                             input voltage rises above the UVLO threshold.
           Under-voltage       below UVLO threshold minus 2
                                                             I C alert is asserted immediately thanks to
                               hysteresis.
                                                             VCONN_PRESENCE bit.
                                                             Power switch is opened immediately until the
                               CC output pin voltage
                                                             voltage falls below the voltage limit. I2C alert is
           Over-voltage        exceeds maximum operating
                                                             asserted immediately thanks to
                               limit of 6.0 V.
                                                             VCONN_SW_OVP_FAULT bits.
                               CC output pin voltage         The reverse biased body diode of the back-to-
                               exceeds VCONN input voltage   back MOS switches is naturally disabled
           Reverse current
                               when the power switch is      preventing current to flow from the CC output pin
                               turned-off.                   to the input.
                               CC output pin voltage
                                                             Power switch is opened immediately until the
                               exceeds VCONN input voltage
                                                             voltage difference falls below the voltage limit.
           Reverse voltage     of more than 0.35 V for 5 V
                                                             I2C alert is asserted immediately thanks to
                               when the power switch is
                                                             VCONN_SW_RVP_FAULT bits.
                               turned-on.
3.4       Low power standby mode
          The STUSB1700 proposes a standby mode to reduce the device power consumption when
          no device is connected to the USB Type-C port. It is disabled by default and can be
          activated through NVM programming (see Section 6: Start-up configuration).
          When activated, the STUSB1700 enters in standby mode at power up, or after a reset, or
          after a disconnection. In this mode, the CC interface and the voltages monitoring blocks are
          turned off. Only a monitoring circuitry is maintained active on the CC pins to detect a
          connection. When the connection is detected, all the internal circuits are turned on to allow
          normal operation.
3.5       High voltage protection
          The STUSB1700 can be safely used in systems or connected to systems that handle high
          voltage on the VBUS power path. The device integrates an internal circuitry on the CC pins
          that tolerate high voltage and ensures protection up to 22 V in case of unexpected short
                                             DocID030977 Rev 1                                              17/56
                                                                                                                  56


Features description                                                                          STUSB1700
           circuits with the VBUS or in case of a connection to a device supplying high voltage on the
           VBUS.
3.6        Hardware fault management
           The STUSB1700 handles hardware fault conditions related to the device itself and to the
           VBUS power path during system operation.
           When such conditions happen, the circuit goes into a transient error recovery state named
           ErrorRecovery in the Type-C FSM. The error recovery state is equivalent to force a detach
           event.
           When entering in this state, the device de-asserts the VBUS power path by disabling
           VBUS_EN_SRC pin, and it removes the terminations from the CC pins during several tens
           of milliseconds. Then, it transitions to the unattached state.
           The STUSB1700 goes into error recovery state when at least one condition listed below is
           met:
           •     If an over-temperature is detected, the “THERMAL_FAULT” bit set to 1b
           •     If an internal pull-up voltage on CC pins is below UVLO threshold, the “VPU_VALID” bit
                 set to 0b
           •     If an over-voltage is detected on the CC pins, the “VPU_OVP_FAULT” bit set to 1b
           •     If the VBUS voltage is out of the valid voltage range during attachment, the
                 “VBUS_VALID” bit set to 0b
           •     If an under-voltage is detected on the VDD pin during attachment when UVLO
                 detection is enabled, the “VDD_UVLO_DISABLE” bit set to 0b
           •     If an over-voltage is detected on the VDD pin during attachment when OVLO detection
                 is enabled, the “VDD_OVLO_DISABLE” bit set to 0b
           The I2C register bits mentioned into brackets give either the state of the hardware fault when
           it occurs, or the setting condition to detect the hardware fault (see Section 5.1: Register
           description).
3.7        Accessory modes detection
           The STUSB1700 supports the detection of audio accessory mode and debug accessory
           mode as defined in the USB Type-C standard specification.
3.7.1      Audio accessory mode detection
           The STUSB1700 detects an audio accessory device when both CC1 and CC2 pins are
           pulled down to the ground by a Ra resistor from connected device. The audio accessory
           detection is advertised by the ACC_DETECT pin as well as through the
           CC_ATTACHED_MODE bits of I2C register CC_CONNECTION_STATUS (see Section 5.1:
           Register description).
3.7.2      Debug accessory mode detection
           The STUSB1700 detects a connection to a debug and test system (DTS). The debug
           accessory detection is advertised by the ACC_DETECT pin as well as through the
           CC_ATTACHED_MODE bits of the I2C register CC_CONNECTION_STATUS (see
18/56                                        DocID030977 Rev 1


STUSB1700                                                                          Features description
           Section 5.1: Register description). The VBUS_EN_SRC pin is also asserted to allow
           enabling the VBUS power path as defined in the USB Type-C standard specification.
           A debug accessory device is detected when both the CC1 and CC2 pins are pulled down to
           ground by a Rd resistor from the connected device. The orientation detection is performed
           in two steps as described in the table below. The A_B_SIDE pin indicates the orientation of
           the connection. The orientation detection is advertised through TYPEC_FSM_STATE bits of
           the I2C register CC_OPERATION_STATUS (see Section 5.1: Register description).
                                    Table 9. Orientation detection
                                                        A_B_SIDE
     CC1 pin       CC2 pin                                  pin           Orientation detection state
 #                               Detection process
    (CC2 pin)     (CC1 pin)                              CC1/CC2        TYPEC_FSM_STATE bits value
                                                        (CC2/CC1)
                              1st step: debug
 1     Rd            Rd       accessory mode             HiZ (HiZ)    UnorientedDebugAccessory.SRC
                              detected
                              2nd step: orientation
                              detected (DTS presents
 2     Rd           ≤ Ra      a resistance to GND with    HiZ (0)     OrientedDebugAccessory.SRC
                              a value ≤ Ra on its CC2
                              pin)
                                            DocID030977 Rev 1                                        19/56
                                                                                                           56


I²C interface                                                                                                                                      STUSB1700
4            I²C interface
4.1          Read and write operations
             The I²C interface is used to configure, control and read the operation status of the device. It
             is compatible with the Philips I²C Bus® (version 2.1). The I²C is a slave serial interface
             based on two signals:
             •      SCL - Serial clock line: input clock used to shift data
             •      SDA - Serial data line: input/output bidirectional data transfers
             A filter rejects the potential spikes on the bus data line to preserve data integrity.
             The bidirectional data line supports transfers up to 400 Kbit/s (fast mode). The data are
             shifted to and from the chip on the SDA line, MSB first.
             The first bit must be high (START) followed by the 7-bit device address and the read/write
             control bit.
             Two 7-bit device addresses are available for STUSB1700 thanks to external programming
             of DevADDR0 through ADDR0 pin setting, i.e. 0x28 or 0x29. It allows to connect two
             STUSB1700 devices on the same I2C bus.
                                                                   Table 10. Device address format
                   Bit7                Bit6                     Bit5                Bit4                Bit3              Bit2             Bit1         Bit0
               DevADDR6          DevADDR5                   DevADDR4          DevADDR3              DevADDR2          DevADDR1        DevADDR0          R/W
                    0                    1                         0                  1                   0                 0            ADDR0          0/1
                                                                  Table 11. Register address format
                   Bit7                Bit6                     Bit5                Bit4                Bit3              Bit2             Bit1         Bit0
               RegADDR7         RegADDR6                    RegADDR5          RegADDR4              RegADDR3          RegADDR2        RegADDR1       RegADDR0
                                                                       Table 12. Register data format
                   Bit7                Bit6                     Bit5                Bit4                Bit3              Bit2             Bit1         Bit0
                 DATA7              DATA6                      DATA5              DATA4                DATA3            DATA2            DATA1         DATA0
                                                                           Figure 4. Read operation
                          Master                         Slave
                           Start     Device addr       W A     Reg address  A Restart   Device addr  R  A   Reg data A Reg data A Reg data   A  Stop
                                        7 bits                    8 bits                 7 bits              8 bits     8 bits    8 bits
                                                                                                                        Address   Address
                          Start bit = SDA falling when S CL = 1                                                           n+1       n+2
                          Stop bit = SDA rising when SCL = 1
                          Restart bit = start after a start
                          Acknowledg e = SDA forced low during a SCL clock
20/56                                                                   DocID030977 Rev 1


STUSB1700                                                                                                      I²C interface
                                                              Figure 5. Write operation
                     St art     Device addr          W A     Reg a ddress A Reg dat a A Reg dat a  A Reg dat a A    St op
                                   7 bit s                      8 bit s       8 bit s    8 bit s      8 bit s
                                                                                        Address       Address
                    St art bit = SD A fa lling when S CL = 1                               n+1          n+2
                    St op bit = SD A r ising when SCL = 1
                    Resta rt bit = star t aft er a sta rt
4.2       Timing specifications
          The device uses a standard slave I²C channel at speed up to 400 kHz.
                                                 Table 13. I²C timing parameters - VDD = 5 V
           Symbol                                         Parameter                          Min.      Typ.    Max.       Unit
             Fscl        SCL clock frequency                                                     0        -     400       kHz
            thd,sta      Hold time (repeated) START condition                                  0.6        -       -        μs
              tlow       LOW period of the SCL clock                                          1.3         -       -        μs
             thigh       HIGH period of the SCL clock                                          0.6        -       -        μs
            tsu,dat      Setup time for repeated START condition                               0.6        -       -        μs
            thd,dat      Data hold time                                                      0.04         -      0.9       μs
            tsu,dat      Data setup time                                                      100         -       -        μs
                tr       Rise time of both SDA and SCL signals                          20 + 0.1 Cb       -     300        ns
                tf       Fall time of both SDA and SCL signals                          20 + 0.1 Cb       -     300        ns
            tsu,sto      Setup time for STOP condition                                         0.6        -       -        μs
                         Bus free time between a STOP and START
              tbuf                                                                             1.3        -       -        μs
                         condition
               Cb        Capacitive load for each bus line                                       -        -     400        pF
                                                           DocID030977 Rev 1                                              21/56
                                                                                                                                56


I²C interface                                                                      STUSB1700
                                       Figure 6. I²C timing diagram
                   s ŝŚ ƚĨ
              ^ 
                   s ŝů
                           ƚŚĚ͕Ɛ ƚĂ
                                              ƚƌ       ƚƐ Ƶ͕ĚĂƚ ƚŚŝŐ Ś
              ^ >
                                    ƚůŽǁ           ƚŚĚ͕ĚĂƚ                ƚƐ Ƶ͕ƐƚĂ
22/56                                 DocID030977 Rev 1


STUSB1700                                                                               I²C register map
5         I²C register map
                                     Table 14. Register access legend
            Access code       Expanded name                           Description
                 RO              Read only       Register can be read only
                 R/W             Read/write      Register can be read or written
                 RC            Read and clear    Register can be read and is cleared after read
                               Table 15. STUSB1700 register map overview
           Address             Register name             Access                  Description
            00h to
                     Reserved                              RO      Do not use
             0Ah
                                                                   Alerts register linked to transition
             0Bh     ALERT_STATUS                          RC
                                                                   registers
                                                                   Allows the interrupt mask on the
             0Ch     ALERT_STATUS_MASK_CTRL                R/W     ALERT_STATUS register to be
                                                                   changed
                                                                   Alerts about transition in
             0Dh     CC_CONNECTION_STATUS_TRANS            RC      CC_CONNECTION_STATUS
                                                                   register
             0Eh     CC_CONNECTION_STATUS                  RO      Gives status on CC connection
                                                                   Alerts about transition in
             0Fh     MONITORING_STATUS_TRANS               RC
                                                                   MONITORING_STATUS register
                                                                   Gives status on VBUS and VCONN
             10h     MONITORING_STATUS                     RO
                                                                   voltage monitoring
             11h     CC_OPERATION_STATUS                   RO      Gives status on CC operation modes
                                                                   Alerts about transition in
             12h     HW_FAULT_STATUS_TRANS                 RC
                                                                   HW_FAULT_STATUS register
             13h     HW_FAULT_STATUS                       RO      Gives status on hardware faults
            14h to
                     Reserved                              RO      Do not use
             17h
                                                                   Gives status on the advertised
                                                                   current capability, and allows the
             18h     CC_CAPABILITY_STATUS_CTRL             R/W
                                                                   VCONN supply capabilities to be
                                                                   changed
            19h to
                     Reserved                              RO      Do not use
             1Dh
                                                                   Allows the current limit of VCONN
             1Eh     CC_VCONN_SWITCH_CTRL                  R/W
                                                                   power switches to be changed
             1Fh     Reserved                              RO      Do not use
                                        DocID030977 Rev 1                                              23/56
                                                                                                             56


I²C register map                                                                        STUSB1700
                         Table 15. STUSB1700 register map overview (continued)
              Address          Register name             Access              Description
                                                                Allows the monitoring conditions of
                20h   VCONN_MONITORING_CTRL               R/W
                                                                VCONN voltage to be changed
                21h   Reserved                            RO    Do not use
                                                                Allows the voltage range for VBUS
                22h   VBUS_MONITORING_RANGE_CTRL          R/W
                                                                monitoring to be changed
                23h   RESET_CTRL                          R/W   Controls the device reset by software
                24h   Reserved                            RO    Do not use
                                                                Allows the VBUS discharge time to be
                25h   VBUS_DISCHARGE_TIME_CTRL            R/W
                                                                changed
                                                                Gives status on VBUS discharge path
                26h   VBUS_DISCHARGE_STATUS               RO
                                                                activation
                                                                Gives status on VBUS power path
                27h   VBUS_ENABLE_STATUS                  RO
                                                                activation
               28h to
                      Reserved                            RO    Do not use
                2Dh
                                                                Allows the monitoring conditions of
                2Eh   VBUS_MONITORING_CTRL                R/W
                                                                VBUS voltage to be changed
                2Fh   Reserved                            RO    Do not use
24/56                                   DocID030977 Rev 1


STUSB1700                                                                              I²C register map
5.1       Register description
          The reset column specified in the registers description below defines the default value of the
          registers at power-up or after a reset. The reset values with (NVM) index correspond to the
          user-defined parameters that can be customized by NVM re-programming if needed (see
          Section 6: Start-up configuration).
5.1.1     ALERT_STATUS
          Address: 0Bh
          Access: RC
Note:     This register indicates an Alert has occurred.
                                      Table 16. ALERT_STATUS register
            Bit              Field name               Reset                  Description
             7     Reserved                            0b      Do not use
                                                               0b: cleared
                                                               1b: change occurred on
             6     CC_CONNECTION_STATUS_AL             0b
                                                               CC_CONNECTION_STATUS_TRANS
                                                               register
                                                               0b: cleared
             5     MONITORING_STATUS_AL                1b      1b: change occurred on
                                                               MONITORING_STATUS_TRANS register
                                                               0b: cleared
             4     HW_FAULT_STATUS_AL                  0b      1b: change occurred on
                                                               HW_FAULT_STATUS_TRANS register
            3:0    Reserved                          0000b     Do not use
          When a bit value change occurs on one of the mentioned transition register, it automatically
          sets the corresponding alert bit in ALERT_STATUS register.
                                          DocID030977 Rev 1                                        25/56
                                                                                                         56


I²C register map                                                                                   STUSB1700
5.1.2        ALERT_STATUS_MASK_CTRL
             Address: 0Ch
             Access: R/W
Note:        This register is used to mask event interrupt and prevent the assertion of the alert bit in the
             ALERT_STATUS register when the corresponding bit defined below is set to 1.
                                  Table 17. ALERT_STATUS_MASK_CTRL register
               Bit                     Field name                        Reset             Description
                7    Reserved                                              1b      Do not use
                                                                                   0b: interrupt unmasked
                6    CC_CONNECTION_STATUS_AL_MASK                       1b (NVM)
                                                                                   1b: interrupt masked
                                                                                   0b: interrupt unmasked
                5    MONITORING_STATUS_AL_MASK                          1b (NVM)
                                                                                   1b: interrupt masked
                                                                                   0b: interrupt unmasked
                4    HW_FAULT_STATUS_AL_MASK                            1b (NVM)
                                                                                   1b: interrupt masked
               3:0   Reserved                                            1111b     Do not use
             The condition for generating an active-low ALERT signal is:
             [ALERT_STATUS bitwise AND (NOT ALERT_STATUS_MASK)] <> 0
5.1.3        CC_CONNECTION_STATUS_TRANS
             Address: 0Dh
             Access: RC
Note:        This register indicates a bit value change has occurred in CC_CONNECTION_STATUS
             register.
                               Table 18. CC_CONNECTION_STATUS_TRANS register
               Bit          Field name             Reset                         Description
               7:1  Reserved                     0000000b   Do not use
                                                            0b: cleared
                0   CC_ATTACH_TRANS                 0b
                                                            1b: transition occurred on CC_ATTACH bit
26/56                                        DocID030977 Rev 1


STUSB1700                                                                                  I²C register map
5.1.4     CC_CONNECTION_STATUS
          Address: 0Eh
          Access: RO
Note:     This register gives the connection state of the CC pins and on associated operating modes
          of the device.
                                 Table 19. CC_CONNECTION_STATUS register
            Bit             Field name               Reset                       Description
                                                               000b: no device attached
                                                               001b: sink attached
                                                               010b: do not use
                                                               011b: debug accessory attached
            7:5    CC_ATTACHED_MODE                   000b
                                                               100b: audio accessory attached
                                                               101b: do not use
                                                               110b: do not use
                                                               111b: do not use
                                                       0b      0b: operating in normal power mode
             4     DEVICE_POWER_MODE
                                                     (NVM)     1b: operating in standby power mode
                                                               0b: not operating
             3     CC_POWER_ROLE                       0b
                                                               1b: operating as a source
             2     Reserved                            0b      Do not use
                                                               0b: VCONN is not supplied on CC pin
             1     CC_VCONN_SUPPLY                     0b
                                                               1b: VCONN is supplied on CC pin
                                                               0b: not attached
             0     CC_ATTACH                           0b
                                                               1b: attached
          The DEVICE_POWER_MODE bit indicates the power consumption mode of the device at
          start-up and during operation:
          •     In normal mode, all the internal circuits are turned on
          •     In standby mode, the CC interface and the voltage monitoring blocks remain off until a
                connection is detected.
          The standby power mode is disabled by default and can be activated through NVM
          programming (see Section 6: Start-up configuration).
          The CC_POWER_ROLE bit is relevant only when a connection is established and the
          device is attached.
                                          DocID030977 Rev 1                                            27/56
                                                                                                             56


I²C register map                                                                                  STUSB1700
5.1.5        MONITORING_STATUS_TRANS
             Address: 0Fh
             Access: RC
Note:        This register indicates a bit value change has occurred in MONITORING_STATUS register.
                                  Table 20. MONITORING_STATUS_TRANS register
              Bit            Field name             Reset                       Description
              7:4   Reserved                        0000b   Do not use
                                                            0b: cleared
               3    VBUS_VALID_TRANS                 0b
                                                            1b: transition occured on VBUS_VALID bit
                                                            0b: cleared
               2    VBUS_VSAFE0V_TRANS                0b
                                                            1b: transition occured on VBUS_VSAFE0V bit
                                                            0b: cleared
               1    VBUS_PRESENCE_TRANS              0b
                                                            1b: transition occured on VBUS_PRESENCE bit
                                                            0b: cleared
               0    VCONN_PRESENCE_TRANS             0b
                                                            1b: transition occured on VCONN_PRESENCE bit
5.1.6        MONITORING_STATUS
             Address: 10h
             Access: RO
Note:        This register informs on the current status of VBUS and VCONN voltages monitoring done
             respectively on VBUS_SENSE pin and VCONN pin.
                                      Table 21. MONITORING_STATUS register
               Bit           Field name             Reset                        Description
               7:4   Reserved                       0000b     Do not use
                                                              0b: VBUS is outside valid voltage range
                3    VBUS_VALID                       0b
                                                              1b: VBUS is within valid voltage range
                                                              0b: VBUS is above vSafe0V threshold
                2    VBUS_VSAFE0V                     1b
                                                              1b: VBUS is below VSafe0V threshold
                                                              0b: VBUS is below UVLO threshold
                1    VBUS_PRESENCE                    0b
                                                              1b: VBUS is above UVLO threshold
                                                              0b: VCONN is below UVLO threshold
                0    VCONN_PRESENCE                0b or 1b
                                                              1b: VCONN is above UVLO threshold
             The default value of the valid VBUS voltage range can be changed in the
             VBUS_MONITORING_RANGE_CTRL register during operation.
28/56                                        DocID030977 Rev 1


STUSB1700                                                                              I²C register map
          The VBUS vSafe0V threshold is set in the VBUS_MONITORING_CTRL register. It is used in
          source power role as a Type-C FSM condition to establish a valid device attachment.
          The VBUS UVLO threshold is set by hardware.
          The VCONN UVLO threshold is set in the VCONN_MONITORING_CTRL register.
          The reset value of the VCONN_PRESENCE bit is:
          •   0b when VCONN is not supplied on the VCONN pin, or when VCONN is supplied and the
              voltage level is below the UVLO threshold, or when the VCONN threshold detection
              circuit is disabled.
          •   1b when VCONN is supplied on the VCONN pin and the voltage level is above UVLO
              threshold.
          See Section 8.3: Electrical and timing characteristics for the threshold voltages description
          and value on VBUS_SENSE and VCONN pins.
                                        DocID030977 Rev 1                                          29/56
                                                                                                         56


I²C register map                                                                                  STUSB1700
5.1.7        CC_OPERATION_STATUS
             Address: 11h
             Access: RO
Note:        This register informs on the current status of the device operating modes with respect to the
             Type-C FSM states as defined in the USB Type-C standard specification. This status is
             informative only and is not used to trigger any alert.
                                    Table 22. CC_OPERATION_STATUS register
                   Bit               Field name               Reset                  Description
                                                                      0b: CC1 is attached
                    7             CC_PIN_ATTACHED               0b
                                                                      1b: CC2 is attached
                   6:5                 Reserved                00b    Do not use
                                                                      00h: reserved
                                                                      01h: reserved
                                                                      02h: reserved
                                                                      03h: reserved
                                                                      04h: reserved
                                                                      05h: reserved
                                                                      06h: reserved
                                                                      07h: reserved
                                                                      08h: Unattached.SRC
                                                                      09h: AttachWait.SRC
                                                                      0Ah: Attached.SRC
                                                                      0Bh: reserved
                                                                      0Ch: reserved
                   4:0            TYPEC_FSM_STATE              08h    0Dh: Unattached.Accessory
                                                                      0Eh: AttachWait.Accessory
                                                                      0Fh: AudioAccessory
                                                                      10h: UnorientedDebugAccessory.SRC
                                                                      11h: reserved
                                                                      12h: reserved
                                                                      13h: ErrorRecovery
                                                                      14h: reserved
                                                                      15h: reserved
                                                                      16h: reserved
                                                                      17h: reserved
                                                                      18h: UnattachedWait.SRC
                                                                      (VCONN intermediate discharge state)
                                                                      19h: OrientedDebugAccessory.SRC
30/56                                       DocID030977 Rev 1


STUSB1700                                                                             I²C register map
                           Table 22. CC_OPERATION_STATUS register (continued)
               Bit                 Field name            Reset                 Description
                                                                 1Ah: reserved
                                                                 1Bh: reserved
                                                                 1Ch: reserved
               4:0             TYPEC_FSM_STATE            08h
                                                                 1Dh: reserved
                                                                 1Eh: reserved
                                                                 1Fh: reserved
          The CC_PIN_ATTACHED bit indicates which CC pin is connected to the CC line. Its value is
          consistent with the logic level of the A_B_SIDE output pin providing cable orientation. The
          TYPEC_FSM_STATE bits indicate the current state of the Type-C FSM corresponding to the
          power mode defined in the CC_POWER_MODE_CTRL register.
                                          DocID030977 Rev 1                                       31/56
                                                                                                        56


I²C register map                                                                               STUSB1700
5.1.8        HW_FAULT_STATUS_TRANS
             Address: 12h
             Access: RC
Note:        This register indicates a bit value change has occurred in HW_FAULT_STATUS register. It
             alerts also when the over-temperature condition is met.
                                   Table 23. HW_FAULT_STATUS_TRANS register
              Bit               Field name               Reset                   Description
                                                                0b: cleared
               7    THERMAL_FAULT                         0b    1b: junction temperature is above
                                                                temperature threshold of 145° C
               6    Reserved                              0b    Do not use
                                                                0b: cleared
               5    VPU_OVP_FAULT_TRANS                   0b    1b: transition occured on
                                                                VPU_OVP_FAULT bit
                                                                0b: cleared
               4    VPU_VALID_TRANS                       0b
                                                                1b: transition occured on VPU_VALID bit
               3    Reserved                              0b    Do not use
                                                                0b: cleared
               2    VCONN_SW_RVP_FAULT_TRANS              0b    1b: transition occured on
                                                                VCONN_SW_RVP_FAULT bits
                                                                0b: cleared
               1    VCONN_SW_OCP_FAULT_TRANS              0b    1b: transition occured on
                                                                VCONN_SW_OCP_FAULT bits
                                                                0b: cleared
               0    VCONN_SW_OVP_FAULT_TRANS              0b    1b: transition occured on
                                                                VCONN_SW_OVP_FAULT bits
32/56                                        DocID030977 Rev 1


STUSB1700                                                                                 I²C register map
5.1.9     HW_FAULT_STATUS
          Address: 13h
          Access: RO
Note:     This register provides information on hardware fault conditions related to the internal pull-up
          voltage in Source power role and to the VCONN power switches.
                                     Table 24. HW_FAULT_STATUS register
            Bit              Field name             Reset                     Description
                                                           0b: voltage on CC pins is below OVP
                                                           threshold of 6.0 V
             7    VPU_OVP_FAULT                      0b
                                                           1b: voltage on CC pins is above OVP
                                                           threshold of 6.0 V
                                                           0b: pull-up voltage on CC pins is below UVLO
                                                           threshold of 2.8 V
             6    VPU_VALID                          0b
                                                           1b: pull-up voltage on CC pins is above UVLO
                                                           threshold of 2.8 V (safe condition)
                                                           0b: no reverse voltage on VCONN power
                                                           switch connected to CC1
             5    VCONN_SW_RVP_FAULT_CC1             0b
                                                           1b: reverse voltage detected on VCONN power
                                                           switch connected to CC1
                                                           0b: no reverse voltage on VCONN power
                                                           switch connected to CC2
             4    VCONN_SW_RVP_FAULT_CC2             0b
                                                           1b: reverse voltage detected on VCONN power
                                                           switch connected to CC2
                                                           0b: no short circuit or over current on VCONN
                                                           power switch connected to CC1
             3    VCONN_SW_OCP_FAULT_CC1             0b
                                                           1b: short circuit or over current detected on
                                                           VCONN power switch connected to CC1
                                                           0b: no short circuit or over current on VCONN
                                                           power switch connected to CC2
             2    VCONN_SW_OCP_FAULT_CC2             0b
                                                           1b: short circuit or over current detected on
                                                           VCONN power switch connected to CC2
                                                           0b: no over voltage on VCONN power switch
                                                           connected to CC1
             1    VCONN_SW_OVP_FAULT_CC1             0b
                                                           1b: over voltage detected on VCONN power
                                                           switch connected to CC1
                                                           0b: no over voltage on VCONN power switch
                                                           connected to CC2
             0    VCONN_SW_OVP_FAULT_CC2             0b
                                                           1b: over voltage detected on VCONN power
                                                           switch connected to CC2
                                         DocID030977 Rev 1                                             33/56
                                                                                                             56


I²C register map                                                                                  STUSB1700
             The VPU_VALID and VPU_OVP_FAULT bits are related to the internal pull-up voltage
             applied on the CC pins when the device is operating in source power role. They give
             information on an internal supply issue that could prevent the device to detect a valid
             connection to a distant device.
5.1.10       CC_CAPABILITY_STATUS_CTRL
             Address: 18h
             Access: R/W
Note:        This register gives the current capability that is advertised through the RP pins and allows
             the default VCONN supply capability to be changed.
                                Table 25. CC_CAPABILITY_STATUS_CTRL register
               Bit            Field name              Reset                      Description
                                                                00b: default USB current (500 mA or 900 mA)
                                                                01b: 1.5 A USB Type-C current
               7:6  CC_CURRENT_ADVERTISED               00b
                                                                10b: 3.0 A USB Type-C current
                                                                11b: do not use
                5   Reserved                             1b     Do not use
                                                                0b: VCONN discharge disabled on CC pin
                                                         0b
                4   CC_VCONN_DISCHARGE_EN                       1b: VCONN discharge enabled for 250 ms on CC
                                                       (NVM)
                                                                pin
               3:1  Reserved                           000b     Do not use
                                                         1b     0b: VCONN supply capability disabled on CC pin
                0   CC_VCONN_SUPPLY_EN
                                                       (NVM)    1b: VCONN supply capability enabled on CC pin
34/56                                        DocID030977 Rev 1


STUSB1700                                                                                 I²C register map
5.1.11    CC_VCONN_SWITCH_CTRL
          Address: 1Eh
          Access: R/W
Note:     This register allows the default current limit of the power switches supplying VCONN on the
          CC pins to be changed.
                                Table 26. CC_VCONN_SWITCH_CTRL register
            Bit                Field name                      Reset                 Description
            7:4   Reserved                                     0000b       Do not use
                                                                           0000b: 350 mA (default)
                                                                           0001b: 300 mA
                                                                           0010b: 250 mA
                                                                           0011b: 200 mA
                                                                           0100b: 150 mA
            3:0   CC_VCONN_SWITCH_ILIM                      0000b (NVM)    0101b: 100 mA
                                                                           0110b: 400 mA
                                                                           0111b: 450 mA
                                                                           1000b: 500 mA
                                                                           1001b: 550 mA
                                                                           1010b: 600 mA
5.1.12    VCONN_MONITORING_CTRL
          Address: 20h
          Access: R/W
Note:     This register allows the default voltage monitoring conditions for VCONN to be modified.
                               Table 27. VCONN_MONITORING_CCTRL register
           Bit           Field name             Reset                       Description
                                                        0b: disables UVLO threshold detection on VCONN pin
            7   VCONN_MONITORING_EN               1b
                                                        1b: enables UVLO threshold detection on VCONN pin
                                                        0b: selects high UVLO threshold (default)
            6   VCONN_UVLO_THRESHOLD              0b    1b: selects low UVLO threshold (case where VCONN-
                                                        powered accessories are operating down to 2.7 V)
            5   Reserved                          1b    Do not use
            4   Reserved                          0b    Do not use
           3:0 Reserved                         0000b Do not use
          Disabling the UVLO threshold detection on the VCONN pin deactivates the VCONN power
          path and sets the VCONN_PRESENCE bit to 0b in the MONITORING_STATUS register.
          See Section 8.3: Electrical and timing characteristics for the threshold voltages description
          and value on VCONN pin.
                                         DocID030977 Rev 1                                            35/56
                                                                                                            56


I²C register map                                                                                    STUSB1700
5.1.13       VBUS_MONITORING_RANGE_CTRL
             Address: 22h
             Access: R/W
Note:        This register allows the low and high limits of the VBUS monitoring voltage range to be
             changed during attachment.
                                 Table 28. VBUS_MONITORING_RANGE_CTRL register
              Bit          Field name            Reset                         Description
                                                          Binary coded VSHUSBH coefficient to shift up the
                                                 0000b
              7:4 SHIFT_HIGH_VBUS_LIMIT                   nominal high voltage limit from 1% (0001b) to 15%
                                                 (NVM)    (1111b) of VBUS voltage by step of 1%
                                                          Binary coded VSHUSBL coefficient to shift down the
                                                 0000b
              3:0 SHIFT_LOW_VBUS_LIMIT                    nominal low voltage limit from 1% (0001b) to 15%
                                                 (NVM)    (1111b) of VBUS voltage by step of 1%
             The VBUS voltage is fixed at 5.0 V. The nominal values of the high and low limits of the VBUS
             monitoring voltage range are respectively VBUS+5% and VBUS-5%. Each coefficient
             VSHUSBH and VSHUSBL represents the fraction of VBUS voltage that is either added or
             subtracted to the nominal value of the corresponding limit to determine the VBUS monitoring
             voltage limits (see Section 8.3: Electrical and timing characteristics).
             When the STUSB1700 is in the unattached state, the register takes the reset values. When
             a device is attached, the register takes the values set in the NVM (see Section 6: Start-up
             configuration) or the new ones set by software during attachment.
5.1.14       RESET_CTRL
             Address: 23h
             Access: R/W
Note:        This register allows the device to be reset by software.
                                             Table 29. RESET_CTRL register
               Bit      Field name          Reset                            Description
               7:1  Reserved              0000000b     Do not use
                                                       0b: device reset is performed from hardware RESET
                                                       pin
               0    SW_RESET_EN              0b
                                                       1b: forces the device reset as long as this bit value is
                                                       set
             The SW_RESET_EN bit acts as the hardware RESET pin except that I2C control registers
             are not reset to default value. They keep the last value change. The SW_RESET_EN bit
             does not command the RESET pin.
36/56                                        DocID030977 Rev 1


STUSB1700                                                                                 I²C register map
5.1.15    VBUS_DISCHARGE_TIME_CTRL
          Address: 25h
          Access: R/W
Note:     This register contains the parameter used to define the VBUS discharge time when the
          internal VBUS discharge path is activated on VBUS_SENSE pin.
                               Table 30. VBUS_DISCHARGE_TIME_CTRL register
             Bit               Field name                Reset                  Description
                                                                  Binary coded TDISPARAM coefficient used
                                                        0110b
            7:4   VBUS_DISCHARGE_TIME_TO_0V                       to compute the VBUS discharge time to 0
                                                        (NVM)
                                                                  V: TDISUSB = 84 ms (typical) * TDISPARAM
            3:0   Reserved                              1111b    Do not use
5.1.16    VBUS_DISCHARGE_STATUS
          Address: 26h
          Access: RO
Note:     This register gives information, during operation, on the activation state of the internal VBUS
          discharge path on the VBUS_SENSE pin.
                                 Table 31. VBUS_DISCHARGE_STATUS register
            Bit            Field name               Reset                      Description
                                                               0b: VBUS discharge path is deactivated
            7     VBUS_DISCHARGE_EN              0b
                                                               1b: VBUS discharge path is activated
            6:1   Reserved                       0000000b      Do not use
5.1.17    VBUS_ENABLE_STATUS
          Address: 27h
          Access: R0
Note:     This register gives information, during operation, on the activation state of the VBUS power
          path through VBUS_EN_SRC pin.
                                   Table 32. VBUS_ENABLE_STATUS register
             Bit           Field name            Reset                      Description
            7:1    Reserved                     0b        Do not use
                                                          0b: VBUS source power path is disabled
            0      VBUS_SOURCE_EN               0b
                                                          1b: VBUS source power path is enabled
                                          DocID030977 Rev 1                                            37/56
                                                                                                             56


I²C register map                                                                                STUSB1700
5.1.18       VBUS_MONITORING_CTRL
             Address: 2Eh
             Access: R/W
Note:        This register allows to modify the default monitoring conditions of VBUS voltage over the
             power path from VDD and VBUS_SENSE pins.
                                    Table 33. VBUS_MONITORING_CTRL register
                Bit             Field name               Reset                   Description
               7     Reserved                              0b     Do not use
                                                                  0b: enables OVLO threshold detection on
                                                           0b     VDD pin
               6     VDD_OVLO_DISABLE
                                                         (NVM)    1b: disables OVLO threshold detection on
                                                                  VDD pin
               5     Reserved                              0b     Do not use
                                                                  0b: enables valid VBUS voltage range
                                                                  detection
                                                           0b     1b: disables valid VBUS voltage range
               4     VBUS_VALID_RANGE_DISABLE
                                                         (NVM)    detection
                                                                  (VBUS UVLO threshold detection used
                                                                  instead)
               3     Reserved                              0b     Do not use
                                                                  00b: VBUS vSafe0V threshold = 0.6 V
                                                          00b     01b: VBUS vSafe0V threshold = 0.9 V
               2:1   VBUS_VSAFE0V_THRESHOLD
                                                         (NVM)    10b: VBUS vSafe0V threshold = 1.2 V
                                                                  11b: VBUS vSafe0V threshold = 1.8 V
                                                                  0b: enables UVLO threshold detection on
                                                           1b     VDD pin
               0     VDD_UVLO_DISABLE
                                                         (NVM)    1b: disables UVLO threshold detection on
                                                                  VDD pin
             The VBUS_VALID_RANGE_DISABLE and VBUS_VSAFE0V_THRESHOLD bits are
             defining monitoring conditions applicable to the VBUS_SENSE pin connected to the USB
             Type-C receptacle side.
             The VBUS_VALID_RANGE_DISABLE bit allows the valid VBUS voltage range condition to
             be substituted by the VBUS UVLO threshold condition to establish a valid device attachment
             and to assert the VBUS power path.
             The VBUS_VSAFE0V_THRESHOLD bit indicates the voltage value of the VBUS vSafe0V
             threshold used as a Type-C FSM condition to establish a valid device attachment.
38/56                                        DocID030977 Rev 1


STUSB1700                                                                              I²C register map
          The VDD_UVLO_DISABLE and VDD_OVLO_DISABLE bits are defining monitoring
          conditions applicable to the VDD supply pin when it is connected to the main power supply:
          •   When UVLO detection is enabled, the VBUS_EN_SRC pin is asserted only if the
              voltage on the VDD pin is above VDDUVLO threshold.
          •   When OVLO detection is enabled, the VBUS_EN_SRC pin is asserted only if the
              voltage on the VDD pin is below VDDOVLO threshold.
          See Section 8.3: Electrical and timing characteristics for the threshold voltages description
          and value on VDD and VBUS_SENSE pins.
                                        DocID030977 Rev 1                                          39/56
                                                                                                         56


Start-up configuration                                                                       STUSB1700
6           Start-up configuration
6.1         User-defined parameters
            The STUSB1700 has a set of user-defined parameters that can be customized by NVM re-
            programming and/or by software through I2C interface. It allows the customer to change the
            preset configuration of USB Type-C interface and to define a new configuration to meet
            specific customer requirements addressing various applications, use cases or specific
            implementations.
            The NVM re-programming overrides the initial default setting to define a new default setting
            that will be used at power-up or after a reset. The default value is copied at power-up, or
            after a reset, from the embedded NVM into dedicated I2C register bits (see Section 5.1:
            Register description). The NVM re-programming is possible with a customer password.
            When a default value is changed during functioning by software, the new setting remains in
            effect as long as the STUSB1700 is operating or when it is changed again. But after power-
            off and power-up, or after a reset, STUSB1700 takes back default values defined in the
            NVM.
            Please refer to the NVM access and programming application note in order to read and
            change the default values of the parameters customizable by NVM if needed.
6.2         Default start-up configuration
            The following table lists the user-defined parameters and indicates the default start-up
            configuration of the STUSB1700.
            Three types of user-defined parameters are specified in the table with respect to the
            “Customization type” column:
            •     SW: indicates parameters that can be customized only by software through the I2C
                  interface during system operation,
            •     NVM: indicates parameters that can be customized only by NVM re-programming,
            •     NVM/SW: indicates parameters that can be customized by NVM re-programming
                  and/or by software through the I2C interface during system operation.
                        Table 34. STUSB1700 user-defined parameters and default setting
                                                                                                   I2C
              Customization                                               Default value and
                                             Parameter                                           register
                    type                                                      description
                                                                                                 address
                 NVM/SW        CC_CONNECTION_STATUS_AL_MASK           1b: interrupt masked         0Ch
                 NVM/SW        MONITORING_STATUS_AL_MASK              1b: interrupt masked         0Ch
                 NVM/SW        HW_FAULT_STATUS_AL_MASK                1b: interrupt masked         0Ch
                                                                      1b: disables standby
                   NVM         STANDBY_POWER_MODE_DISABLE                                          N/A
                                                                      power mode
                                                                      0b: VCONN discharge
                 NVM/SW        CC_VCONN_DISCHARGE_EN                                               18h
                                                                      disabled on CC pin
40/56                                       DocID030977 Rev 1


STUSB1700                                                             Start-up configuration
            Table 34. STUSB1700 user-defined parameters and default setting (continued)
                                                                                      I2C
          Customization                                      Default value and
                                    Parameter                                       register
              type                                              description
                                                                                    address
                                                         1b: VCONN supply
            NVM/SW      CC_VCONN_SUPPLY_EN               capability enabled on CC     18h
                                                         pin
            NVM/SW      CC_VCONN_SWITCH_ILIM             0000b: 350 mA                1Eh
                                                         1b: enables UVLO
               SW       VCONN_MONITORING_EN              threshold detection on       20h
                                                         VCONN pin
                                                         0b: high UVLO threshold
               SW       VCONN_UVLO_THRESHOLD                                          20h
                                                         of 4.65 V
                                                         0101b: VSHUSBH = 5% of
                                                         VBUS, high voltage limit
            NVM/SW      SHIFT_HIGH_VBUS_LIMIT                                         22h
                                                         VMONUSBH Source =
                                                         VBUS+10%
                                                         0101b: VSHUSBL = 5% of
                                                         VBUS, low voltage limit
            NVM/SW      SHIFT_LOW_VBUS_LIMIT                                          22h
                                                         VMONUSBL Source =
                                                         VBUS-10%
                                                         0b: device reset is
               SW       SW_RESET_EN                      performed from hardware      23h
                                                         RESET pin
                                                         0110b: TDISPARAM = 6,
            NVM/SW      VBUS_DISCHARGE_TIME_TO_0V        discharge time TDISUSB =     25h
                                                         504 ms
                                                         0b: enables VBUS
              NVM       VBUS_DISCHARGE_DISABLE                                        N/A
                                                         discharge path
                                                         0b: enables OVLO
            NVM/SW      VDD_OVLO_DISABLE                 threshold detection on       2Eh
                                                         VDD pin
                                                         0b: enables valid VBUS
            NVM/SW      VBUS_VALID_RANGE_DISABLE                                      2Eh
                                                         voltage range detection
                                                         00b: VBUS vSafe0V
            NVM/SW      VBUS_VSAFE0V_THRESHOLD                                        2Eh
                                                         threshold = 0.6 V
                                                         1b: disables UVLO
            NVM/SW      VDD_UVLO_DISABLE                 threshold detection on       2Eh
                                                         VDD pin
                                   DocID030977 Rev 1                                    41/56
                                                                                              56


Application                                                                                   STUSB1700
7           Application
            The following sections are not part of ST product specification. This part is intended to give
            a generic application overview to be used by the customer as a starting point for further
            implementation and customization. ST does not warrant compliancy with customer
            specification. Full system implementation and validation are under customer responsibility.
7.1         General information
7.1.1       Power supplies
            The STUSB1700 can be supplied in three different ways depending on the targeted
            application:
            •    Through the VDD pin only for applications powered by VBUS,
            •    Through the VSYS pin only for AC applications with a system power supply delivering
                 3.3 V or 5 V,
            •    Through VDD and VSYS pins for applications powered by VBUS with a system power
                 supply delivering 3.3 V or 5 V. When both VDD and VSYS power supplies are present,
                 the low power supply VSYS is selected when VSYS voltage is above 3.1 V otherwise
                 VDD is selected.
7.1.2       Connection to MCU or application processor
            The connection to an MCU or an application processor is optional.
            When a connection through I²C interface is implemented, it provides extensive functionality
            during system operation. For instance, it may be used to:
            1.   Define the port configuration during system boot (in case the NVM parameters are not
                 customized during manufacturing),
            2.   Change the default configuration at any time during operation
            3.   Adjust the port power capability according to contextual power availability and/or the
                 power partitioning with other ports,
            4.   Save system power by shutting down the DC-DC converter according to the
                 attachment detection state,
            5.   Provide a diagnostic of the Type-C connection and the VBUS power path in real time.
            At power-up or after a reset, the first software access to the I2C registers of STUSB1700
            can be done only after TLOAD as shown in the figure below. TLOAD corresponds to the time
            required to initialize the I2C registers with the default values from the embedded NVM. At
            power-up, the loading phase starts when the voltage level on the VREG_2V7 output pin of
            the 2.7 V internal regulator reaches 2.5 V to release the internal POR signal. After a reset,
            the loading phase starts when the signal on the RESET pin is released.
42/56                                        DocID030977 Rev 1


STUSB1700                                                                              Application
               Figure 7. I2C registers initialization sequence at power-up or after a reset
7.2       USB Type-C typical applications
7.2.1     Source type application with Rp = 3A
          Figure 8. Typical STUSB1700 implementation in source type application with Rp=3A
Note:     Dashed lines correspond to optional connections (depends on application requirements).
                                       DocID030977 Rev 1                                     43/56
                                                                                                   56


Application                                                                                                 STUSB1700
7.2.2          VBUS power path assertion
                     Table 35. Conditions for VBUS power path assertion with STUSB1700 default
                                                              configuration
                                                                  Operation conditions
                                    Electrical
                       Pin                                                                                   Comment
                                      value         Type-C attached      VDD pin       VBUS_SENSE
                                                          state         monitoring     pin monitoring
                                                  Attached.SRC or                                          The signal is
                                                  UnorientedDebug      VDD <                               asserted only if
                                                  Accessory.SRC                       VBUS is within
                                                                       VDDOVLO if                          all the valid
                                         0                                            valid voltage
                                                  or                   VDD pin is                          operation
                                                                                      range
                                                  OrientedDebug        supplied                            conditions are
                                                  Accessory.SRC                                            met
                  VBUS_EN_SRC                                                                              The signal is
                                                                                                           de-asserted
                                                                       VDD >
                                                                                      VBUS is out of       when at least
                                                                       VDDOVLO if
                                        HiZ       Any other state                     valid voltage        one non valid
                                                                       VDD pin is
                                                                                      range                operation
                                                                       supplied
                                                                                                           condition is
                                                                                                           met.
7.2.3          Device state according to connection state
                              Table 36. Source power role with accessory support
                                Type-C device state
  Connection   CC1    CC2                                A_B_SIDE   VCONN     VBUS_EN_SRC       CC_CONNECTION_STATUS
                            CC_OPERATION_STATUS
      state     pin    pin                                   pin    supply        pin                register @0Eh
                                  register @11h
 Nothing
               Open   Open Unattached.SRC                    HiZ     OFF          HiZ                     00h
 attached
                Rd    Open                                   HiZ     OFF           0                      2Dh
 Sink attached             Attached.SRC
               Open    Rd                                     0      OFF           0                      2Dh
 Powered       Open    Ra                                    HiZ     OFF          HiZ                     00h
 cable without             Unattached.SRC
 sink attached  Ra    Open                                   HiZ     OFF          HiZ                     00h
 Powered        Rd     Ra                                    HiZ     CC2           0                      2Fh
 cable with
 sink attached
 or Vconn-                 Attached.SRC
 powered        Ra     Rd                                     0      CC1           0                      2Fh
 accessory
 attached
 Debug
 accessory
 mode           Rp     Rp  Unattached.SRC                    HiZ     OFF          HiZ                     00h
 attached
 source role
 Debug
 accessory
                           UnorientedDebug
 mode           Rd     Rd                                    HiZ     OFF           0                      6Dh
 attached                  Accessory.SRC
 sink role
44/56                                               DocID030977 Rev 1


STUSB1700                                                                                           Application
                       Table 36. Source power role with accessory support (continued)
                               Type-C device state
 Connection   CC1   CC2                                 A_B_SIDE VCONN     VBUS_EN_SRC  CC_CONNECTION_STATUS
                            CC_OPERATION_STATUS
     state     pin   pin                                   pin   supply        pin           register @0Eh
                                  register @11h
Debug          Rd   ≤ Ra                                   HiZ    OFF           0                 6Dh
accessory
                          OrientedDebug
mode
                          Accessory.SRC
attached      ≤ Ra   Rd                                     0     OFF           0                 6Dh
sink role
Audio adapter
accessory
               Ra    Ra   AudioAccessory                   HiZ    OFF          HiZ                81h
mode
attached
              The value of the CC1 and CC2 pins is defined from a termination perspective and
              corresponds to the termination presented by the connected device. The
              CC_CONNECTION_STATUS register can report other values than the one presented in
              Table 36. In this table, it reflects the state transitions in Type-C FSM that can be ignored
              from the application stand point.
                                                   DocID030977 Rev 1                                       45/56
                                                                                                                 56


Electrical characteristics                                                            STUSB1700
8            Electrical characteristics
8.1          Absolute maximum rating
             All voltages are referenced to GND.
                                         Table 37. Absolute maximum rating
                     Symbol                          Parameter               Value        Unit
             VDD                   Supply voltage on VDD pin                   28
             VSYS                  Supply voltage on VSYS pin                   6
             VCC1, VCC2            High voltage on CC pins                     22
             VVBUS_EN_SRC
                                   High voltage on VBUS pins                   28
             VVBUS_SENSE
             VSCL, VSDA
             VALERT#
                                                                                            V
             VRESET
             VATTACH
             VA_B_SIDE             Operating voltage on I/O pins            -0.3 to 6
             VVBUS_VALID
             VACC_DETECT
             VRP_DEF
             VRP_HIGH
             VCONN                 VCONN voltage                                6
             TSTG                  Storage temperature                     -55 to 150
                                                                                           °C
             TJ                    Maximum junction temperature               145
                                   HBM                                          4
             ESD                                                                           kV
                                   CDM                                         1.5
46/56                                        DocID030977 Rev 1


STUSB1700                                                       Electrical characteristics
8.2       Operating conditions
                                 Table 38. Operating conditions
               Symbol                     Parameter                     Value      Unit
          VDD          Supply voltage on VDD pin                      4.1 to 22
          VSYS         Supply voltage on VSYS pin                     3.0 to 5.5
          VCC1, VCC2   CC pins                                         0 to 5.5
          VVBUS_EN_SRC
                       High voltage pins                               0 to 22
          VVBUS_SENSE
          VSCL, VSDA
          VALERT#
          VRESET                                                                      V
          VATTACH
          VA_B_SIDE    Operating voltage on I/O pins                   0 to 4.5
          VVBUS_VALID
          VACC_DETECT
          VRP_DEF
          VRP_HIGH
          VCONN        VCONN voltage                                  2.7 to 5.5
          ICONN        VCONN rated current (default = 0.35 A)         0.1 to 0.6      A
          TA           Operating temperature                         -40 to 105      °C
                                  DocID030977 Rev 1                                  47/56
                                                                                           56


Electrical characteristics                                                                   STUSB1700
8.3          Electrical and timing characteristics
             Unless otherwise specified: VDD = 5 V, TA = +25 °C, all voltages are referenced to GND.
                              Table 39. Electrical and timing characteristics
    Symbol        Parameter                    Conditions              Min.      Typ.      Max.   Unit
                                 Device idle as a SOURCE
              Current            (not connected, no communication)
 IDD (SRC)
              consumption        VSYS @ 3.3 V
                                 VDD @ 5.0 V                                     158               µA
                                                                                 188               µA
                                 Device in standby
              Standby current    (not connected, low power)
 ISTDBY
              consumption        VSYS @ 3.3 V                                     33               µA
                                 VDD @ 5.0 V
                                                                                  53               µA
              I2C registers
 TLOAD        loading time from At power-up or after a reset                                 30    ms
              NVM
 CC1 and CC2 pins
 IP-USB                          CC pin voltage,                       -20%       80       20%     µA
              CC current
 IP-1.5                          VCC = 0 to 2.6 V,                      -8%      180        8%     µA
              sources
 IP-3.0                          -40 °C < TA < +105 °C                  -8%      330        8%     µA
              CC open pin        CC unconnected,
 VCCO                                                                   2.75                        V
              voltage            VDD = 3.0 to 5.5 V
              CC input
 RINCC                           Terminations off                       200                        kΩ
              impedance
              Detection          Max Ra detection by source at
 VTH0.2                                                                 0.15      0.2       0.25    V
              threshold 1        IP = IP–USB
              Detection          Max Ra detection by source at
 VTH0.4                                                                 0.35      0.4       0.45    V
              threshold 2        IP = IP-1.5
              Detection          Max Ra detection by source at
 VTH0.8                                                                 0.75      0.8       0.85    V
              threshold 3        IP = IP-3.0
              Detection          Max Rd detection by source at
 VTH1.6                                                                  1.5      1.6       1.65    V
              threshold 4        IP = IP-USB and IP = IP-1.5
              Detection          Max Rd detection by source at IP-3.0,
 VTH2.6                                                                 2.45      2.6       2.75    V
              threshold 5        max CC voltage for connected sink
 VCONN pin and power switches
              VCONN power        IVCONN = 0.2 A
 RVCONN                                                                 0.25      0.5      0.975   Ω
              path resistance    -40 °C < TA < 105 °C
48/56                                          DocID030977 Rev 1


STUSB1700                                                                         Electrical characteristics
                        Table 39. Electrical and timing characteristics (continued)
   Symbol          Parameter                    Conditions               Min.       Typ.       Max.     Unit
                                                                           85        100        125
                                  Programmable current limit threshold
               Overcurrent
IOCP                              (from 100 mA to 600 mA by step of 50    300        350        400     mA
               protection
                                  mA)
                                                                          550        600        650
               Overvoltage
VOVP           protection on CC                                           5.9          6        6.1      V
               output pins
               Undervoltage       Low UVLO threshold                      2.6        2.65        2.7
VUVP           protection on                                                                             V
               VCONN input pin High UVLO threshold (default)              4.6        4.65       4.8
VDD pin monitoring
               Overvoltage        OVLO threshold detection enabled,
VDDOVLO                                                                   5.8          6        6.2      V
               lockout            VDD pin supplied
               Undervoltage       UVLO threshold detection enabled,
VDDUVLO                                                                   3.8        3.9          4      V
               lockout            VDD pin supplied
VBUS_SENSE pin monitoring and driving
               VBUS presence
VTHUSB                            V     = 3.0 to 5.5 V                    3.8        3.9          4      V
               threshold (UVLO) SYS
                                                                          0.5        0.6        0.7      V
               VBUS safe 0V       VSYS = 3.0 to 5.5 V, threshold          0.8        0.9          1      V
VTH0V          threshold          programmable from 0.6 V to 1.8 V,
               (vSafe0V)          default VTHOV = 0.6 V                   1.1        1.2        1.3      V
                                                                          1.7        1.8        1.9      V
               VBUS discharge
RDISUSB                                                                   600        700        800      Ω
               resistor
                                   Coefficient TDISPARAM programmable
                VBUS discharge                                             70         84        100
 TDISUSB                           by NVM, default TDISPARAM = 6,                                        ms
                time to 0V                                             *TDISPARAM *TDISPARAM *TDISPARAM
                                   TDISUSB = 504 ms
                                   Coefficient VSHUSBH programmable
                VBUS monitoring    by NVM from 1% to 15% of VBUS by               VBUS+5%+
 VMONUSBH       high voltage                                                                             V
                                   step of 1%, default                             VSHUSBH
                limit
                                   VMONUSBH = VBUS+10%
                                   Coefficient VSHUSBL programmable
                VBUS monitoring    by NVM from 1% to 15% of VBUS by               VBUS-5%
 VMONUSBL                                                                                                V
                low voltage limit  step of 1%, default                            -VSHUSBL
                                   VMONUSBL = VBUS-10%
 Digital input/output (SCL, SDA, ALERT#, RESET, ATTACH, A_B_SIDE, VBUS_VALID, ACC_DETECT,
 RP_DEF, RP_HIGH)
                High level input                                          1.2                            V
 VIH
                voltage
                Low level input                                                                 0.35     V
 VIL
                voltage
                                                DocID030977 Rev 1                                       49/56
                                                                                                              56


Electrical characteristics                                                           STUSB1700
                       Table 39. Electrical and timing characteristics (continued)
   Symbol         Parameter                  Conditions               Min.     Typ. Max.  Unit
               Low level output                                                      0.4   V
 VOL                             Ioh = 3 mA
               voltage
 20 V open drain output (VBUS_EN_SRC)
               Low level output                                                      0.4   V
 VOL                             Ioh = 3 mA
               voltage
50/56                                        DocID030977 Rev 1


STUSB1700                                                                         Package information
9         Package information
          In order to meet environmental requirements, ST offers these devices in different grades of
          ECOPACK® packages, depending on their level of environmental compliance. ECOPACK®
          specifications, grade definitions and product status are available at: www.st.com.
          ECOPACK® is an ST trademark.
9.1       QFN-24 EP (4 x 4 mm) Wet Flk package information
                            Figure 9. QFN-24 EP 4x4 mm Wet Flk package outline
                                          DocID030977 Rev 1                                     51/56
                                                                                                      56


Package information                                                            STUSB1700
                           Table 40. QFN24 EP 4x4 Wet Flk mm mechanical data
                                                        Dimensions (mm)
                 Symbol
                                        Min                  Typ              Max
                    A                   0.90                 0.95             1.00
                    A1                                       0.10
                    A2                  0.00                 0.02             0.05
                    A3                                       0.20
                     b                  0.20                 0.25             0.30
                    D                   3.85                 4.00             4.15
                    D2                  2.40                 2.50             2.60
                    E                   3.85                 4.00             4.15
                    E2                  2.40                 2.50             2.60
                     e                                       0.50
                     J                                       0.35
                     L                  0.30                 0.40             0.50
                    L1                                       0.20
                    L2                                       0.05
                    L3                                       0.10
                       Figure 10. QFN24 EP 4x4 mm Wet Flk recommended footprint
52/56                                  DocID030977 Rev 1


STUSB1700                                                         Package information
9.2       Thermal information
                                    Table 41. Thermal information
            Symbol                          Parameter               Value       Unit
             RθJA   Junction to ambient thermal resistance            37       °C/W
             RθJC   Junction to case thermal resistance               5        °C/W
                                     DocID030977 Rev 1                            53/56
                                                                                        56


Terms and abbreviations                                                                         STUSB1700
10         Terms and abbreviations
                                    Table 42. List of terms and abbreviations
                Term                                           Description
                        Audio adapter accessory mode. It is defined by the presence of Ra/Ra on
            Accessory   CC1/CC2 pins.
            modes
                        Debug accessory mode. It is defined by the presence of Rd/Rd on CC1/CC2 pins.
                        Downstream Facing Port, specifically associated with the flow of data in a USB
                        connection. Typically the ports on a HOST or the ports on a hub to which devices
            DFP
                        are connected. In its initial state, the DFP sources VBUS and VCONN, and supports
                        data.
                        Dual-role port. A port that can operate as either a Source or a Sink. The port's role
            DRP
                        may be changed dynamically.
                        Port asserting Rd on CC pins and consuming power from VBUS; most commonly a
            Sink
                        Device.
                        Port asserting Rp on CC pins and providing power over VBUS; most commonly a
            Source
                        Host or Hub DFP.
                        Upstream Facing Port, specifically associated with the flow of data in a USB
            UFP         connection. The port on a device or a hub that connects to a host or the DFP of a
                        hub. In its initial state, the UFP sinks VBUS and supports data.
54/56                                      DocID030977 Rev 1


STUSB1700                                                         Revision history
11        Revision history
                          Table 43. Document revision history
                Date     Revision                         Changes
            13-Dec-2017     1        Initial release.
                             DocID030977 Rev 1                               55/56
                                                                                   56


                                                                                                                             STUSB1700
                                           IMPORTANT NOTICE – PLEASE READ CAREFULLY
STMicroelectronics NV and its subsidiaries (“ST”) reserve the right to make changes, corrections, enhancements, modifications, and
improvements to ST products and/or to this document at any time without notice. Purchasers should obtain the latest relevant information on
ST products before placing orders. ST products are sold pursuant to ST’s terms and conditions of sale in place at the time of order
acknowledgement.
Purchasers are solely responsible for the choice, selection, and use of ST products and ST assumes no liability for application assistance or
the design of Purchasers’ products.
No license, express or implied, to any intellectual property right is granted by ST herein.
Resale of ST products with provisions different from the information set forth herein shall void any warranty granted by ST for such product.
ST and the ST logo are trademarks of ST. All other product or service names are the property of their respective owners.
Information in this document supersedes and replaces information previously supplied in any prior versions of this document.
                                                © 2017 STMicroelectronics – All rights reserved
56/56                                                       DocID030977 Rev 1


Mouser Electronics
Authorized Distributor
Click to View Pricing, Inventory, Delivery & Lifecycle Information:
STMicroelectronics:
 STUSB1700YQTR
