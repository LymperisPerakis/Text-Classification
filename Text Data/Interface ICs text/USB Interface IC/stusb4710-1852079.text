                                                                                    STUSB4710
    Autonomous USB PD controller with integrated discharge path
                                                                                     Datasheet - production data
                                                              Temperature range: -40 °C up to 105 °C
                                                              Fully compatible with:
                                                                    USB Type-C™ rev 1.2
                                                                    USB PD rev 2.0
                                                              Certification test ID: 1000125 (QFN24)
                                                          Applications
                                                              AC adapters and power supplies for:
                                                               computer, consumer or portable consumer
                                                               applications
                                                              Smart plugs and wall adapters
                                                              Power hubs and docking stations
                                                              Displays
                                                              Any Type-C source device
Features                                                  Description
    USB power delivery (PD) controller                   The STUSB4710 is a new family of USB power
    Type-C attach and cable orientation                  delivery controllers communicating over Type-
     detection                                            C™ configuration channel pins (CC) to negotiate
    Single role: provider - DFP                          a given amount of power to be sourced to an
    Full hardware solution - no software                 inquiring consumer device.
    I2C interface (optional connection to MCU)
                                                          The STUSB4710 addresses provider/DFP
    Support all USB PD profiles: up to 5 power
                                                          devices such as notebooks, tablets and AC
     data objects (PDO)
                                                          adapters. The device can handle any
    Configurable start-up profiles                       connections to a UFP or DRP without any MCU
    Integrated VBUS voltage monitoring                   attachment support, from device attachment to
    Internal and/or external VBUS discharge path         power negotiation, including VBUS discharge and
    Short -to-VBUS protections on CC pins (22 V)         protections.
     and VBUS pins (28 V)
    Wide power supply input:
          VDD = [4.1 V; 22 V]
                                        Table 1: Device summary table
         Order code                          Description                           Package            Marking
    STUSB4710AQTR                                                           QFN24 EP (4x4 mm)
    STUSB4710AQ1TR             Autonomous USB PD controller (provider)        QFN16 (3x3 mm)           4710A
    STUSB4710ADTR                                                                   SO-16
November 2017                                DocID030499 Rev 4                                             1/34
This is information on a product in full production.                                                 www.st.com


Contents                                                                                                            STUSB4710
Contents
1     Functional description .................................................................... 4
2     Inputs/outputs ................................................................................. 5
         2.1    Pinout ................................................................................................ 5
         2.2    Pin list ............................................................................................... 7
         2.3    Pin description................................................................................... 8
                   2.3.1       CC1 / CC2 .......................................................................................... 8
                   2.3.2       I2C interface pins ................................................................................ 8
                   2.3.3       VBUS_SENSE .................................................................................... 8
                   2.3.4       VBUS_EN_SRC ................................................................................. 9
                   2.3.5       VDD .................................................................................................... 9
                   2.3.6       GND .................................................................................................... 9
                   2.3.7       ADDR0................................................................................................ 9
                   2.3.8       VREG2V7 ........................................................................................... 9
                   2.3.9       VBUS_DISCH ..................................................................................... 9
                   2.3.10      SEL_PDO [5:2] ................................................................................... 9
3     Block descriptions ........................................................................ 10
         3.1    CC interface .................................................................................... 10
         3.2    BMC ................................................................................................ 10
         3.3    Protocol layer .................................................................................. 10
         3.4    Policy engine ................................................................................... 10
         3.5    Device policy manager .................................................................... 11
         3.6    VBUS power path control ................................................................ 11
                   3.6.1       VBUS monitoring .............................................................................. 11
                   3.6.2       VBUS discharge ............................................................................... 11
                   3.6.3       VBUS power path assertion ............................................................. 12
         3.7    High voltage protection ................................................................... 12
         3.8    Hardware fault management ........................................................... 12
         3.9    Accessory mode detection .............................................................. 13
                   3.9.1       Audio accessory mode detection ..................................................... 13
                   3.9.2       Debug accessory mode detection .................................................... 13
4     User-defined startup configuration .............................................. 14
         4.1    Parameter overview ........................................................................ 14
         4.2    PDO – voltage configuration in NVM............................................... 14
         4.3    PDO – current configuration in NVM ............................................... 15
2/34                                   DocID030499 Rev 4


STUSB4710                                                                                          Contents
         4.4    Monitoring configuration in NVM ..................................................... 15
         4.5    Discharge configuration in NVM ...................................................... 15
5    I²C interface.................................................................................... 16
         5.1    Read and write operations .............................................................. 16
         5.2    Timing specifications ....................................................................... 17
6    I²C register map ............................................................................. 19
7    Typical use cases .......................................................................... 20
         7.1    Power supply – buck topology......................................................... 20
         7.3    Power supply – flyback topology ..................................................... 21
8    Electrical characteristics .............................................................. 22
         8.1    Absolute maximum ratings .............................................................. 22
         8.2    Operating conditions ....................................................................... 22
         8.3    Electrical and timing characteristics ................................................ 23
9    Package information ..................................................................... 25
         9.1    QFN24 EP 4x4 mm package information ........................................ 25
         9.2    QFN16 (3x3x0.55) package information ......................................... 27
         9.3    SO-16 package information ............................................................ 29
         9.4    Thermal information ........................................................................ 30
         9.5    Packing information ......................................................................... 31
10   Terms and abbreviations .............................................................. 32
11   Revision history ............................................................................ 33
                                    DocID030499 Rev 4                                                     3/34


Functional description                                                                          STUSB4710
1           Functional description
            The STUSB4710 is an autonomous USB power delivery controller optimized as a provider.
            It offers an open-drain GPIO interface to make direct interconnection with a power
            regulation stage.
            The STUSB4710 offers the benefits of a full hardware USB PD stack allowing robust and
            safe USB PD negotiation in line with USB PD standard. The STUSB4710 is ideal for
            provider applications in which digital or software intelligence is limited or missing.
            The STUSB4710 main functions are:
                 Detect the connection between two USB ports (attach detection)
                 Establish a valid host to device connection
                 Discover and configure VBUS: Type-C low, medium or high current mode
                 Resolve cable orientation
                 Negotiate a USB power delivery contract with a PD capable device
                 Configure the power source accordingly
                 Monitor VBUS, manage transitions, handle protections and ensure user and device
                  safety
            Additionally, the STUSB4710 offers 5 customizable power data objects (PDOs), 5 general
            purpose I/Os, an integrated discharge path, and is natively robust to high voltage peaks.
                                           Figure 1: Functional block diagram
4/34                                        DocID030499 Rev 4


STUSB4710                                                              Inputs/outputs
2         Inputs/outputs
2.1       Pinout
                     Figure 2: STUSB4710QTR pin connections (top view)
                               DocID030499 Rev 4                                 5/34


Inputs/outputs                                                    STUSB4710
               Figure 3: STUSB4710Q1TR pin connections (top view)
6/34                     DocID030499 Rev 4


STUSB4710                                                                     Inputs/outputs
                       Figure 4: STUSB4710DTR pin connections (top view)
2.2       Pin list
                                     Table 2: Pin function list
              Name        Type                  Description                 Connection
              CC1    20 V analog IO   Configuration channel 1        Type-C receptacle A5
              CC2    20 V analog IO   Configuration channel 2        Type-C receptacle B5
               SCL         DI         I²C clock                      To I²C master – ext. pull-up
                                      I2C data input/output – active
              SDA        DI/OD                                       To I²C master – ext. pull-up
                                      low open-drain
              GND        Power        Ground
           SEL_PDO3        OD         PD03 select flag
           SEL_PDO2        OD         PD02 select flag
             ADDR0       Analog       I2C address 0 bit
           SEL_PDO4        OD         PD04 select flag
           SEL_PDO5        OD         PD05 select flag
                                      VBUS voltage monitoring and
          VBUS_SENSE    20 V AI                                      From VBUS
                                      discharge path
                                 DocID030499 Rev 4                                          7/34


Inputs/outputs                                                                                   STUSB4710
                Name                Type                    Description                   Connection
                                                 External discharge control
            VBUS_DISCH             Output
                                                 signal
                                                 VBUS source power path enable    To switch or power system
           VBUS_EN_SRC            20 V OD
                                                 – active low open-drain          – ext. pull-up
                                                                                  1 µF typ. decoupling
             VREG_1V2              Analog        1.2 V regulator output
                                                                                  capacitor
                                                                                  1 µF typ. decoupling
             VREG_2V7              Analog        2.7 V regulator output
                                                                                  capacitor
                                                 Main power supply (USB power
                 VDD             20 V power                                       From VBUS (system side)
                                                 line)
                                                 Exposed pad is connected to
                  EP            Exposed pad                                       To ground
                                                 ground
                                                     Table 3: Legend
                   Type                                           Description
                     D                                                Digital
                     A                                               Analog
                     O                                             Output pad
                     I                                              Input pad
                    IO                                          Bidirectional pad
                    OD                                          Open drain output
                    PD                                             Pull-down
                    PU                                               Pull-up
                   PWR                                            Power supply
                   GND                                               Ground
2.3        Pin description
2.3.1      CC1 / CC2
           CC1 and CC2 are the configuration channel pins used for connection and attachment
           detection, plug orientation determination and system configuration management across
           USB Type-C cable. CC1/CC2 are HiZ during reset.
2.3.2      I2C interface pins
                                              Table 4: I²C interface pin list
                 Name                                             Description
                  SCL          I²C clock – needs external pull-up
                 SDA           I²C data – needs external pull-up
2.3.3      VBUS_SENSE
           This input pin is used to sense VBUS presence, monitor VBUS voltage and discharge VBUS on
           USB Type-C receptacle side.
8/34                                       DocID030499 Rev 4


STUSB4710                                                                               Inputs/outputs
2.3.4     VBUS_EN_SRC
          In source power role, this pin allows the outgoing VBUS power to be enabled when the
          connection to a sink is established and VBUS is in the valid operating range. The open-drain
          output allows a PMOS transistor to be driven directly. The logic value of the pin is also
          advertised in a dedicated I2C register bit.
2.3.5     VDD
          VDD is the main power supply for applications powered by VBUS.
          This pin can be used to sense the voltage level of the main power supply providing V BUS. It
          allows UVLO and OVLO voltage thresholds to be considered independently on VDD pin as
          additional conditions to enable the VBUS power path through VBUS_EN_SRC pin.
2.3.6     GND
          Ground.
2.3.7     ADDR0
          At start-up, this pin is latched to set I²C device address 0 bit.
2.3.8     VREG2V7
          This pin is used for external decoupling of 2.7 V internal regulator only .
          Recommended decoupling capacitor: 1 µF typ. (0.5 µF min.; 10 µF max.).
          This pin must not be used to supply any external component.
2.3.9     VBUS_DISCH
          Control signal for external VBUS_DISCH path.
2.3.10    SEL_PDO [5:2]
          These 4 output signals are asserted (active low) respectively when PDO2, PDO3, PDO4
          and PDO5 are selected by the attached sink. These signals are used to pilot the power
          management unit.
                                          DocID030499 Rev 4                                         9/34


Block descriptions                                                                            STUSB4710
3          Block descriptions
3.1        CC interface
           The STUSB4710 controls the connection to the configuration channel (CC) pins, CC1 and
           CC2, through two main blocks, the CC line interface block and the CC control logic block.
           The CC lines interface block is used to:
                Configure the termination mode on the CC pins relative to the power mode supported,
                 i.e. pull-up for source power role
                Monitor the CC pin voltage values relative to the attachment detection thresholds
                Protect the CC pins against over voltage
           The CC control logic block is used to:
                Execute the Type-C FSM relative to the Type-C power mode supported
                Determine the electrical state for each CC pins relative to the detected thresholds
                Evaluate the conditions relative to the CC pin states and V BUS voltage value to
                 transition from one state to another in the Type-C FSM
                Detect and establish a valid source-to-sink connection
                Determine the attached mode: source, accessory
                Determine cable orientation to allow external routing of the USB super speed data
                Manage VBUS power capability: USB default, Type-C medium or Type-C high current
                 mode
                Handle hardware faults
           The CC control logic block implements the Type-C FSM’s corresponding to source power
           role with accessory support.
3.2        BMC
           This block is the physical link between USB PD protocol layer and CC pin. In TX mode, it
           converts the data into biphase mark coding (BMC), and drives the CC line to correct
           voltages. In RX mode, it recovers BMC data from the CC line, and converts to baseband
           signaling for the protocol layer.
3.3        Protocol layer
           The protocol layer has the responsibility to manage the messages from/to the physical
           layer. It automatically manages the protocol receive timeouts, the message counter, the
           retry counter and the GoodCRC messages.
           It communicates with the internal policy engine.
3.4        Policy engine
           The policy engine implements the power negotiation with the connected device according
           to its source role, it implements the state machine that controls protocol layer forming and
           scheduling the messages.
           The policy engine uses the protocol layer to send/receive messages.
           The policy engine interprets the device policy manager’s input in order to implement policy
           for port and directs the protocol layer to send appropriate messages.
10/34                                      DocID030499 Rev 4


STUSB4710                                                                            Block descriptions
3.5       Device policy manager
          The device policy manager manages the power resources.
3.6       VBUS power path control
3.6.1     VBUS monitoring
          The VBUS monitoring block supervises (from the VBUS_SENSE input pin) the VBUS voltage
          on the USB Type-C receptacle side.
          This block is used to check that VBUS is within a valid voltage range:
                To establish a valid source-to-sink connection according to USB Type-C standard
                 specification
                To enable safely the VBUS power path through VBUS_EN_SRC pin
          It allows detection of unexpected VBUS voltage conditions such as undervoltage or
          overvoltage relative to the valid VBUS voltage range. When such conditions occur, the
          STUSB4710 reacts as follows:
                At attachment, it prevents the source-to-sink connection and the VBUS power path
                 assertion
                After attachment, it deactivates the source-to-sink connection and disables the VBUS
                 power path. The device goes into error recovery state.
          The VBUS voltage value is automatically adjusted at attachment and at each PDO transition.
          The monitoring is then disabled during T_PDO_transition (default 280 ms changed through
          NVM programming). Additionally, if a transition occurs to a lower voltage, the discharge
          path is activated during this time.
          The valid VBUS voltage range is defined from the VBUS nominal voltage by a high threshold
          voltage and a low threshold voltage whose minimal values are respectively VBUS+5% and
          VBUS-5%. The nominal threshold limits can be shifted by a fraction of V BUS from +1% to
          +15% for the high threshold voltage and from -1% to -15% for the low threshold voltage.
          This means the threshold limits can vary from VBUS+5% to VBUS+20% for the high limit and
          from VBUS-5% to VBUS-20% for the low limit.
          The threshold limits are preset by default in the NVM with different shift coefficients (see
          Section 8.3: "Electrical and timing characteristics"). The threshold limits can be changed
          independently through NVM programming (see Section 8.3: "Electrical and timing
          characteristics") and also by software during attachment through the I2C interface (see
          Section 6: "I²C register map").
3.6.2     VBUS discharge
          The monitoring block handles also the internal VBUS discharge path connected to the
          VBUS_SENSE input pin. The discharge path is activated at detachment, or when the
          device goes into the error recovery state (see Section 3.8: "Hardware fault management").
          The VBUS discharge path is enabled by default in the NVM and can be disabled through
          NVM programming only (see Section 4: "User-defined startup configuration"). Discharge
          time duration (T_PDO_transition and T_Transition to 0 V) are also preset by default in the
          NVM (see Section 8.3: "Electrical and timing characteristics"). The discharge time duration
          can be changed through NVM programming (see Section 4: "User-defined startup
          configuration") and also by software through the I2C interface (see Section 6: "I²C register
          map").
                                          DocID030499 Rev 4                                         11/34


Block descriptions                                                                            STUSB4710
3.6.3      VBUS power path assertion
           The STUSB4710 can control the assertion of the VBUS power path on USB Type-C port,
           directly or indirectly, through VBUS_EN_SRC pin.
           The following table summarizes the configurations and the conditions that determine the
           logic value of VBUS_EN_SRC pin during system operation.
                                    Table 5: Conditions for VBUS power path assertion
                 Electrical                      Operation conditions
      Pin                                                                                     Comment
                   value      Attached state        VDD monitoring     VBUS monitoring
                              Attached.SRC                             VBUS within valid
                                                    VDD > UVLO if       voltage range
                              UnorientedDebug
                                                      VDD_UVLO             if VBUS       The signal is
                               Accessory.SRC            enabled        _VALID_RANGE      asserted only if all
VBUS_EN_SRC          0                               and/or VDD <          enabled       the valid operation
                                                        OVLO if     or VBUS > UVLO if    conditions are
                              OrientedDebug                                              met.
                                                      VDD_OVLO      VBUS
                              Accessory.SRC
                                                        enabled     _VALID_RANGE
                                                                    disabled
                                                                    VBUS is out of valid
                                                    VDD < UVLO if   voltage range
                                                      VDD_UVLO      if VBUS              The signal is de-
                                                        enabled     _VALID_RANGE         asserted when at
          HiZ                 Any other state        and/or VDD >   enabled              least one non-
                                                        OVLO if     or VBUS < UVLO if    valid operation
                                                      VDD_OVLO      VBUS                 condition is met.
                                                        enabled     _VALID_RANGE
                                                                    disabled
                      Activation of the UVLO and OVLO threshold detections can be done through NVM
                      programming (see Section 4: "User-defined startup configuration") and also by
                      software through the I2C interface (see Section 6: "I²C register map"). When the
                      UVLO and/or OVLO threshold detection is activated, the VBUS_EN_SRC pin is
                      asserted only if the device is attached and the valid threshold conditions on V DD
                      are met. Once the VBUS_EN_SRC pin is asserted, the VBUS monitoring is done
                      on VBUS_SENSE pin instead of the VDD pin.
3.7        High voltage protection
           The STUSB4710 can be safely used in systems or connected to systems that handle high
           voltage on the VBUS power path. The device integrates an internal circuitry on the CC pins
           that tolerates high voltage and ensures a protection up to 22 V in case of unexpected short
           circuit with VBUS or in case of connection to a device supplying high voltage on V BUS.
3.8        Hardware fault management
           The STUSB4710 handles hardware fault conditions related to the device itself and the VBUS
           power path during system operation.
           When such conditions occur, the circuit goes into a transient error recovery state named
           ErrorRecovery in the Type-C FSM. When entering in this state, the device de-asserts the
           VBUS power path by disabling the VBUS_EN_SRC pin, and it removes the terminations
12/34                                        DocID030499 Rev 4


STUSB4710                                                                            Block descriptions
          from the CC pins during several tens of milliseconds. Then, it transitions to the unattached
          source state.
          The STUSB4710 goes into error recovery state when at least one condition listed below is
          met:
               If an overtemperature is detected, the “THERMAL_FAULT” flag is asserted.
               If an internal pull-up voltage on CC pins is below UVLO threshold, the “VPU_VALID”
                flag is asserted.
               If an overvoltage is detected on the CC pins, the “VPU_OVP_FAULT” flag is asserted.
               If the VBUS voltage is out of the valid voltage range during attachment, the
                “VBUS_VALID” flag is asserted.
               If an undervoltage is detected on the VDD pin during attachment when UVLO detection
                is enabled, the “VDD_UVLO_DISABLE” flag is asserted.
               If an overvoltage is detected on the VDD pin during attachment when OVLO detection
                is enabled, the “VDD_OVLO_DISABLE” flag is asserted.
          The I2C register bits mentioned above in quotes give either the state of the hardware fault
          when it occurs or the setting condition to detect the hardware fault.
3.9       Accessory mode detection
          The STUSB4710 supports the detection of audio accessory mode and debug accessory
          mode as defined in the USB Type-C standard specification source power role with
          accessory support.
3.9.1     Audio accessory mode detection
          The STUSB4710 detects an audio accessory device when both the CC1 and CC2 pins are
          pulled down to ground by a Ra resistor from the connected device. The audio accessory
          detection is advertised through the CC_ATTACHED_MODE bits of the I2C register
          CC_CONNECTION_STATUS.
3.9.2     Debug accessory mode detection
          The STUSB4710 detects a connection to a debug and test system (DTS) when it operates
          either in sink power role or source power role. The debug accessory detection is advertised
          by the DEBUG1 and DEBUG2 pins as well as through the CC_ATTACHED_MODE bits of
          the I2C register CC_CONNECTION_STATUS.
          In source power role, a debug accessory device is detected when both the CC1 and CC2
          pins are pulled down to ground by a Rd resistor from the connected device. The orientation
          detection is performed in two steps as described in the table below. The DEBUG2 pin is
          asserted to advertise the DTS detection and the A_B_SIDE pin indicates the orientation of
          the connection. The orientation detection is advertised through the TYPEC_FSM_STATE
          bits of the I2C register CC_OPERATION_STATUS.
                                           DocID030499 Rev 4                                       13/34


User-defined startup configuration                                                          STUSB4710
4          User-defined startup configuration
4.1        Parameter overview
           The STUSB4710 has a set of user-defined parameters that can be customized by NVM re-
           programming and/or by software through I2C interface. It allows changing the preset
           configuration of USB Type-C and PD interface and to define a new configuration to meet
           specific customer requirements addressing various applications, use cases or specific
           implementations.
           The NVM re-programming overrides the initial default setting to define a new default setting
           that is used at power-up or after a reset. The default value is copied at power-up, or after a
           reset, from the embedded NVM into dedicated I2C register bits. The NVM re-programming
           is possible few times with a customer password.
                                        Table 6: PDO configurations in NVM
             Feature       Parameter                              Value                         Default
                             Voltage      5V                                                       5V
              PDO1
                             Current      Configurable – defined by PDO1_I [3:0]                   3A
                             Voltage      Configurable – defined by PDO2_V [1:0]                   9V
              PDO2
                             Current      Configurable – defined by PDO2_I [3:0]                   3A
                             Voltage      Configurable – defined by PDO3_V [1:0]                  12 V
              PDO3
                             Current      Configurable – defined by PDO3_I [3:0]                   3A
                             Voltage      Configurable – defined by PDO4_V [1:0]                  15 V
              PDO4
                             Current      Configurable – defined by PDO4_I [3:0]                   3A
                             Voltage      Configurable – defined by PDO5_V [1:0]                  20 V
              PDO5
                             Current      Configurable – defined by PDO5_I [3:0]                 2.25 A
           When a default value is changed during system boot by software, the new settings apply as
           long as the STUSB4710is being run and until it is changed again. But after power-off and
           power-up, or after a hardware reset, the STUSB4710 takes back default values defined in
           the NVM.
4.2        PDO – voltage configuration in NVM
           PDO2_V [1:0], PDO3_V [1:0], PDO4_V [1:0] and PDO5_V [1:0] can be configured with the
           following values:
                                      Table 7: PDO NVM voltage configuration
                       Value                                        Configuration
                        2b00                                             9V
                        2b01                                            15 V
                        2b10                                        PDO_FLEX_V1
                        2b11                                        PDO_FLEX_V2
           PDO_FLEX_V1 and PDO_FLEX_V2 are defined in a specific 10-bit register, value is being
           expressed in 50 mV units.
14/34                                    DocID030499 Rev 4


STUSB4710                                                          User-defined startup configuration
          For instance:
               PDO_FLEX_V1 = 10b0100100010 → 14.5 V
               PDO_FLEX_V2 = 10b0110000110 → 19.5 V
4.3       PDO – current configuration in NVM
          PDO1_I [3:0], PDO2_I [3:0], PDO3_I [3:0], PDO4_I [3:0] and PDO5_I [3:0] can be
          configured with the following fixed values:
                                      Table 8: PDO NVM current configuration
                          Value                                    Configuration
                         4b0000                                      PDO_FLEX_I
                         4b0001                                        1.50 A
                         4b0010                                        1.75 A
                         4b0011                                        2.00 A
                         4b0100                                        2.25 A
                         4b0101                                        2.50 A
                         4b0110                                        2.75 A
                         4b0111                                        3.00 A
                         4b1000                                        3.25 A
                         4b1001                                        3.50 A
                         4b1010                                        3.75 A
                         4b1011                                        4.00 A
                         4b1100                                        4.25 A
                         4b1101                                        4.50 A
                         4b1110                                        4.75 A
                         4b1111                                        5.00 A
          PDO_FLEX_I is defined in a specific 10-bit register, value is being expressed in 10 mA
          units. For instance:
               PDO_FLEX_I = 10b0011100001 → 2.25 A
4.4       Monitoring configuration in NVM
               T_PDO_Transition can be configured from 20 to 300 ms by increments of 20 ms (0 is
                not recommended). Default value is 240 ms.
               T_Transition_to_0V can be configured from 84 to 1260 ms by increments of 84 ms (0
                is not recommended). Default value is 168 ms.
               Vshift_High can be configured from (5 to 20%). Default value ranges from 8% to 12%.
               Vshift _Low can be configured from (5 to 20%). Default value is 10% for all PDO.
4.5       Discharge configuration in NVM
          Both internal and external discharge paths are enabled by default. VBUS_DISCH control
          pin is configured to drive a PMOS by default (active low).
                                        DocID030499 Rev 4                                        15/34


I²C interface                                                                                     STUSB4710
5             I²C interface
5.1           Read and write operations
              The I²C interface is used to configure, control and read the status of the device. It is
              compatible with the Philips I²C Bus® (version 2.1). The I²C is a slave serial interface based
              on two signals:
                    SCL - serial clock line: input clock used to shift data
                    SDA - serial data line: input/output bidirectional data transfers
              A filter rejects the potential spikes on the bus data line to preserve data integrity.
              The bidirectional data line support transfers up to 400 Kbit/s (fast mode). The data are
              shifted to and from the chip on the SDA line, MSB first.
              The first bit must be high (START) followed by the 7-bit device address and the read/write
              control bit.
              Two 7-bit device addresses are available for the STUSB4710 thanks to external
              programming of DevADDR0, through ADDR0, pin setting. It allows two STUSB4710
              devices to be connected on the same I2C bus.
              ADDR is not available for all configurations.
              The device address format:
     Bit7            Bit6            Bit5           Bit4            Bit3          Bit2          Bit1       Bit0
 DevADDR6       DevADDR5         DevADDR4        DevADDR3       DevADDR2       DevADDR1      DevADDR0      R/W
      0                1              0               1              0             0           ADDR0        0/1
              The register address format:
    Bit7            Bit6          Bit5           Bit4          Bit3          Bit2         Bit1          Bit0
RegADDR7       RegADDR6        RegADDR5      RegADDR4      RegADDR3       RegADDR2     RegADDR1      RegADDR0
              The register data format:
    Bit7            Bit6          Bit5           Bit4          Bit3          Bit2         Bit1          Bit0
  DATA7          DATA6           DATA5          DATA4        DATA3          DATA2        DATA1         DATA0
16/34                                           DocID030499 Rev 4


STUSB4710                                                                                 I²C interface
                                              Figure 5: Read operation
                                              Figure 6: Write operation
5.2       Timing specifications
          The device uses a standard slave I²C channel at speed up to 400 kHz.
                                     Table 9: I2C timing parameters - VDD = 5 V
          Symbol                         Parameter                           Min.    Typ.   Max.   Unit
            Fscl   SCL clock frequency                                         0      -     400     kHz
           thd,sta Hold time (repeated) START condition                       0.6     -       -      µs
            tlow   LOW period of the SCL clock                                1.3     -       -      µs
            thigh  HIGH period of the SCL clock                               0.6     -       -      µs
           tsu,dat Setup time for repeated START condition                    0.6     -       -      µs
           thd,dat Data hold time                                            0.04     -      0.9     µs
           tsu,dat Data setup time                                           100      -       -      µs
              tr   Rise time of both SDA and SCL signals                 20 + 0.1 Cb  -     300      ns
              tf   Fall time of both SDA and SCL signals                 20 + 0.1 Cb  -     300      ns
           tsu,sto Setup time for STOP condition                              0.6     -       -      µs
             tbuf  Bus free time between a STOP and START condition           1.3     -       -      µs
             Cb    Capacitive load for each bus line                           -      -     400      pF
                                         DocID030499 Rev 4                                       17/34


I²C interface                                STUSB4710
                Figure 7: I²C timing diagram
18/34         DocID030499 Rev 4


STUSB4710                                                                                       I²C register map
6           I²C register map
                                     Table 10: STUSB4710 register map overview
  Address     Register name                       Access                          Description
 00h to 0Ah   Reserved                               RO       Do not use
    0Bh       ALERT_STATUS                           RC       Alert register linked to transition registers
    0Ch       ALERT_STATUS_MASK_CTRL                R/W       Interrupt mask on ALERT_STATUS register
              CC_CONNECTION_STATUS_TR                         Alerts on transition in
    0Dh                                              RC
              ANS                                             CC_CONNECTION_STATUS register
    0Eh       CC_CONNECTION_STATUS                   RO       CC connection status
                                                              Alerts on transition in MONITORING_STATUS
    0Fh       MONITORING_STATUS_TRANS                RC
                                                              register
    10h       MONITORING_STATUS                      RO       Gives status on VBUS voltage monitoring
    11h       Reserved                               RO       Do not use
                                                              Alerts on transition in HW_FAULT_STATUS
    12h       HW_FAULT_STATUS_TRANS                  RC
                                                              register
    13h       HW_FAULT_STATUS                        RO       Hardware faults status
 14h to 17h   Reserved                               RO       Do not use
    18h       CC_CAPABILITY_CTRL                    R/W       Allows the CC capabilities to be changed
 19h to 22h   Reserved                               RO       Do not use
    23h       RESET_CTRL                            R/W       Controls the device reset by software
    24h       Reserved                               RO       Do not use
    25h       VBUS_DISCHARGE_TIME_CTRL              R/W       Parameters defining VBUS discharge time
    26h       VBUS_DISCHARGE_CTRL                   R/W       Controls the VBUS discharge path
    27h       VBUS_ENABLE_STATUS                     RO       VBUS power path activation status
                                                              Allows the monitoring conditions of VBUS voltage
    2Eh       VBUS_MONITORING_CTRL                  R/W
                                                              to be changed
 19h to 1Eh   Reserved                               RO       Do not use
    71h       SRC_PDO1                              R/W       PDO1 capabilities configuration
    75h       SRC_PDO2                              R/W       PDO2 capabilities configuration
    79h       SRC_PDO3                              R/W       PDO3 capabilities configuration
    7Dh       SRC_PDO4                              R/W       PDO4 capabilities configuration
    81h       SRC_PDO5                              R/W       PDO5 capabilities configuration
    91h       SRC_RDO                                RO       PDO request status
                                          Table 11: Register access legend
  Access code          Expanded name                                     Description
       RO                 Read only           Register can be read only
       R/W               Read / write         Register can be read or written
        RC              Read and clear        Register can be read and is cleared after read
                                          DocID030499 Rev 4                                                 19/34


Typical use cases                                                                       STUSB4710
7           Typical use cases
7.1         Power supply – buck topology
                                    Figure 8: Power supply - buck topology
            The STUSB4710 offers the possibility to have up to 5 PDOs using (GPIO0 to GPIO3).
            For example PDO1:5V 3A (no GPIO grounded), PDO2:9V 3A (GPIO0 to GND), PDO3:12V
            3A (GPIO1 to GND), PDO4:15 V (GPIO2 to GND), PDO5: 20 V (GPIO3 to GND).
                                             Table 12: Resistor value
             PDO     VOUT                      Computation                     Resistor value (Ω)
               -       -                             R1                              200 k
                                                     𝑅1 ∙ 1.22
              5       20                     𝑅2 =                                     13 k
                                                   𝑉𝑂𝑈𝑇 − 1.22
                                                  𝑅1 ∙ 1.22
              4       15                 𝑅3 =                 − 𝑅2                     4k7
                                                𝑉𝑂𝑈𝑇 − 1.22
                                               𝑅1 ∙ 1.22
              3       12               𝑅4 =                − 𝑅2 − 𝑅3                  4k87
                                             𝑉𝑂𝑈𝑇 − 1.22
                                           𝑅1 ∙ 1.22
              2        9            𝑅5 =                − 𝑅2 − 𝑅3 − 𝑅4                8k66
                                          𝑉𝑂𝑈𝑇 − 1.22
                                         𝑅1 ∙ 1.22
              1        5          𝑅6 =               − 𝑅2 − 𝑅3 − 𝑅4 − 𝑅5              33 k
                                       𝑉𝑂𝑈𝑇 − 1.22
20/34                                  DocID030499 Rev 4


STUSB4710                                                                      Typical use cases
7.3       Power supply – flyback topology
          The STUSB4710 offers the possibility to have up to 5 PDOs using GPIO0 to GPIO3.
          For example PDO1 ( 5 V; 3 A) (no Sel_PDO grounded), PDO2 (9 V; 3 A) (GPIO0 to GND),
          PDO3 (15 V; 3 A) (GPIO1 to GND).
                                         Figure 9: Flyback topology
                                           Table 13: Resistor value
           PDO     VOUT                      Computation                     Resistor value (Ω)
             -       -                             R1                              100 k
                                                     𝑅1 ∙1.24
            4       15                       𝑅3 =                                  8k87
                                                   𝑉𝑂𝑈𝑇 −1.24
                                                𝑅1 ∙ 1.24
            3       12                  𝑅4 =                  − 𝑅3                 2k49
                                              𝑉𝑂𝑈𝑇 − 1.24
                                             𝑅1 ∙ 1.24
            2        9               𝑅5 =                  − 𝑅3 − 𝑅4               4k42
                                           𝑉𝑂𝑈𝑇 − 1.24
                                       𝑅1 ∙ 1.22
            1        5          𝑅6 =               − 𝑅2 − 𝑅3 − 𝑅4 − 𝑅5             16k2
                                     𝑉𝑂𝑈𝑇 − 1.22
                                     DocID030499 Rev 4                                       21/34


Electrical characteristics                                                                                  STUSB4710
8            Electrical characteristics
8.1          Absolute maximum ratings
             All voltages are referenced to GND.
                                               Table 14: Absolute maximum ratings
                    Symbol                                Parameter                                Value           Unit
             VDD                       Supply voltage                                                 28             V
             VCC1, VCC2                High voltage on CC pins                                        22             V
             VVBUS_EN_SRC
             VVBUS_SENSE               High voltage on VBUS pins                                      28             V
             VVBUS_DISCH
             VSCL, VSDA                Operating voltage on I/O pins                              -0.3 to 6          V
             TSTG                      Storage temperature                                       -55 to 150         °C
             TJ                        Maximum junction temperature                                  145            °C
                                       HBM                                                             4
             ESD                                                                                                    kV
                                       CDM                                                           1.5
8.2          Operating conditions
                                                  Table 15: Operating conditions
                    Symbol                                Parameter                                Value           Unit
             VDD                       Supply voltage                                            4.1 to 22           V
             VCC1, VCC2                CC pins (1)                                              -0.3 to 5.5          V
             VVBUS_EN_SRC
             VVBUS_SENSE               High voltage pins                                          0 to 22            V
             VVBUS_DISCH
             VSCL, VSDA                Operating voltage on I/O pins                              0 to 4.5           V
             TA                        Operating temperature                                    -40 to 105          °C
             Notes:
             (1)Transient voltage on CC1 and CC2 pins are allowed to go down to -0.3 during BMC communication from
             connected devices.
22/34                                           DocID030499 Rev 4


STUSB4710                                                                          Electrical characteristics
8.3          Electrical and timing characteristics
             Unless otherwise specified: VDD = 5 V, TA = +25 °C, all voltages are referenced to GND.
                                            Table 16: Electrical characteristics
 Symbol       Parameter               Test conditions              Min.          Typ.          Max.      Unit
          Current            Device idle as SOURCE (not connected, no communication)
IDD(SRC)
          consumption        VDD @ 5.0 V                             –           188              –       µA
          Standby            Device standby (not connected, low power)
ISTDBY    current
          consumption        VDD @ 5.0 V                             –            53              –       µA
CC1 and CC2 pins
IP-USB                       CC pin voltage                       -20%            80           +20%       µA
          CC current         VCC = -0.3 to 2.6 V
IP-1.5                                                             -8%           180           +8%        µA
          sources
IP-3.0                       -40° < TA < +105°                     -8%           330           +8%        µA
          CC open pin        CC unconnected,
VCCO                                                               2.75            –              –        V
          voltage            VDD=3.0 to 5.5 V
          CC pull-down
Rd                           -40° < TA < +105°                    -10%            5.1          +10%       kΩ
          resistors
                             External IP=180 µA applied
                                                                     –             –             1.2       V
                             into CC
VCCDB-1.5 CC pin voltage in  External IP=330 µA
          dead battery       applied into CC
VCCDB-3.0 condition                                                  –             –              2        V
                             (VDD = 0, dead battery
                             function enabled)
          CC input           Pull-up and pull-down
RINCC                                                              200             –              –       kΩ
          impedance          resistors off
                             Max. Ra detection by DFP
                             at IP = IP -USB,
          Detection          min. IP_USB detection by
VTH0.2                       UFP on Rd,                            0.15           0.2           0.25       V
          threshold 1
                             min. CC voltage for
                             connected UFP
          Detection          Max Ra detection by DFP at
VTH0.4                                                             0.35           0.4           0.45       V
          threshold 2        IP = IP-1.5
          Detection          Min IP_1.5 detection by UFP
VTH0.66                                                            0.61          0.66            0.7       V
          threshold 3        on Rd
          Detection          Max. Ra detection by DFP at
VTH0.8                                                             0.75           0.8           0.85       V
          threshold 4        IP = IP-3.0
          Detection          Min. IP_3.0 detection by UFP
VTH1.23                                                            1.16          1.23           1.31       V
          threshold 5        on Rd
          Detection          Max Rd detection by DFP at
VTH1.6                                                              1.5           1.6           1.65       V
          threshold 6        IP = IP-USB and IP = IP-1.5
                             Max. Rd detection by DFP
          Detection          at IP-3.0, max. CC voltage
VTH2.6                                                             2.45           2.6           2.75       V
          threshold 7        for connected UFP
                                            DocID030499 Rev 4                                          23/34


Electrical characteristics                                                              STUSB4710
Symbol          Parameter             Test conditions           Min.       Typ.      Max.     Unit
VBUS monitoring and driving
            VBUS presence
VTHUSB                                                           3.8        3.9         4      V
            threshold
                                                                 0.5        0.6        0.7
                               Programmable threshold
            VBUS safe 0 V                                        0.8        0.9         1
                               (from 0.6 to 1.8 V)
VTH0V       threshold                                                                          V
            (vSafe0V)          Default VTHOV = 0.6 V             1.1        1.2        1.3
                                                                 1.7        1.8        1.9
            VBUS discharge
RDISUSB                                                         600        700        800      Ω
            resistor
                               Default TDISUSB= 840 ms. The
            VBUS discharge                                       70         84        100
TDISUSB                        coefficient TDISPARAM is                                       ms
            time to 0 V                                     *TDISPARAM *TDISPARAM *TDISPARAM
                               programmable by NVM
                               Default TDISUSB= 200 ms
            VBUS discharge                                       20         24         28
TDISUSB
            time to PDO
                               The coefficient TDISPARAM is                                   ms
                                                            *TDISPARAM *TDISPARAM *TDISPARAM
                               programmable by NVM
                               VBUS = nominal target
                               value
                               Default VMONUSBH = VBUS
            VBUS monitoring    +10%
VMONUSBH    high voltage                                          –     VBUS +10%       –      V
            threshold          The threshold limit is
                               programmable by NVM
                               from VBUS +5% to VBUS
                               +20%
                               VBUS = nominal target
                               value
                               Default VMONUSBL= VBUS -
            VBUS monitoring    10%
VMONUSBL    low voltage                                           –     VBUS -10%       –      V
            threshold          The threshold limit is
                               programmable by NVM
                               from VBUS -20% to VBUS -
                               5%
Digital input/output (SCL, SDA)
            High level input
VIH                                                              1.2         –          –      V
            voltage
            Low level input
VIL                                                               –          –        0.35     V
            voltage
            Low level output
VOL                            Ioh = 3 mA                         –          –         0.4     V
            voltage
20 V open-drain outputs (VBUS_EN_SRC)
            Low level output
VOL                            Ioh = 3 mA                         –          –         0.4     V
            voltage
24/34                                         DocID030499 Rev 4


STUSB4710                                                                         Package information
9         Package information
          In order to meet environmental requirements, ST offers these devices in different grades of
          ECOPACK® packages, depending on their level of environmental compliance. ECOPACK ®
          specifications, grade definitions and product status are available at: www.st.com.
          ECOPACK® is an ST trademark.
9.1       QFN24 EP 4x4 mm package information
                                  Figure 10: QFN24 EP 4x4 mm package outline
                                         DocID030499 Rev 4                                      25/34


Package information                                                         STUSB4710
                               Table 17: QFN24 EP 4x4 mm mechanical data
                                                            Millimeters
                    Symbol
                                            Min.              Typ.          Max.
                      A                     0.80               0.90          1.00
                      A1                    0.00               0.02          0.05
                       b                    0.18               0.25          0.30
                      D                     3.95               4.00          4.05
                      D2                    2.55               2.70          2.80
                      E                     3.95               4.00          4.05
                      E2                    2.55               2.70          2.80
                       e                    0.45               0.50          0.55
                      K                     0.15                —             —
                       L                    0.30               0.40          0.50
                           Figure 11: QFN24 EP 4x4 mm recommended footprint
26/34                               DocID030499 Rev 4


STUSB4710                                                           Package information
9.2       QFN16 (3x3x0.55) package information
                        Figure 12: QFN16 (3x3x0.55) package outline
                             DocID030499 Rev 4                                    27/34


Package information                                                        STUSB4710
                            Table 18: QFN16 (3x3x0.55) mechanical data
                                                          Millimetres
                   Symbol
                                       Min.                  Typ.          Max.
                      A                 0.5                                0.65
                     A1                  0                                 0.05
                      b                0.18                  0.25          0.30
                      D                             Align="center"3.00 BSC
                      E                                    3.00 BSC
                      e                                      0.50
                      L                                  See variations
                     aaa                                                   0.15
                     bbb                                                   0.10
                     ccc                                                   0.10
                     ddd                                                   0.05
                     eee                                                   0.08
                      n                                       16
                     nD                                        4
                     nE                                        4
                                                                L
                   Option 1            0.30                                0.50
                   Option 2            0.40                                0.60
28/34                            DocID030499 Rev 4


STUSB4710                                                    Package information
9.3       SO-16 package information
                            Figure 13: SO-16 package outline
                            DocID030499 Rev 4                              29/34


Package information                                                              STUSB4710
                                       Table 19: SO-16 mechanical data
                                                                  Milimeters
                    Symbol
                                               Min.                Typ.          Max.
                       A                                                          1.75
                       A1                      0.10                               0.25
                       A2                      1.25
                        b                      0.31                               0.51
                        c                      0.17                               0.25
                       D                       9.80                9.90          10.00
                       E                                           6.00           6.20
                       E1                                          3.90           4.00
                        e                                          1.27
                        h                                                         0.50
                        L                                                         1.27
                        k                                                          8
                      ccc                                                         0.10
9.4        Thermal information
                                         Table 20: Thermal information
   Package       Symbol                           Parameter                  Value      Unit
                  RθJA     Junction-to-ambient thermal resistance             37
  QFN24 EP
                  RθJC     Junction-to-case thermal resistance                 5
                  RθJA     Junction-to-ambient thermal resistance             78       °C/W
    QFN16
                  RθJC     Junction-to-case thermal resistance                30
    SO-16         RθJA     Junction-to-ambient thermal resistance             95
30/34                                  DocID030499 Rev 4


STUSB4710                                                            Package information
9.5       Packing information
                               Figure 14: Reel information
                                Table 21: Tape dimensions
                 Package            Pitch               Carrier width            Reel
               QFN 4x4 - 24L        8 mm                   12 mm                  13"
                             DocID030499 Rev 4                                     31/34


Terms and abbreviations                                                                           STUSB4710
10         Terms and abbreviations
                                         Table 22: List of terms and abbreviations
              Term                                               Description
                        Audio adapter accessory mode. It is defined by the presence of Ra/Ra on the
            Accessory   CC1/CC2 pins.
             modes      Debug accessory mode. It is defined by the presence of Rd/Rd on CC1/CC2 pins in
                        Source power role or Rp/Rp on CC1/CC2 pins in sink power role.
                        Downstream facing port, associated with the flow of data in a USB connection.
              DFP       Typically, the ports on a HOST or the ports on a hub to which devices are connected.
                        In its initial state, the DFP sources VBUS and VCONN and supports data.
                        Dual-role port. A port that can operate as either a source or a sink. The port role may
              DRP
                        be changed dynamically.
                        Port asserting Rd on the CC pins and consuming power from the V BUS; most
              Sink
                        commonly a device.
                        Port asserting Rp on the CC pins and providing power over the V BUS; usually a host or
             Source
                        hub DFP.
                        Upstream facing port, specifically associated with the flow of data in a USB
              UFP       connection. The port on a device or a hub that connects to a host or the DFP of a
                        hub. In its initial state, the UFP sinks the VBUS and supports data.
32/34                                        DocID030499 Rev 4


STUSB4710                                                                          Revision history
11        Revision history
                               Table 23: Document revision history
               Date    Version                                 Changes
           05-Apr-2017    1       Initial release.
                                  Updated Features, Table 2: "Pin functions list", Section 2.3.10:
                                  "SEL_PDO [5:2]", Section 4.4: "Monitoring configuration in NVM",
                                  Section 4.5: "Discharge configuration in NVM", Section 5.1: "Read
           12-Jul-2017    2
                                  and write operations", Table 15: "Operating conditions ", Table 20:
                                  "Thermal information", and Section 7.2: "Power supply – flyback
                                  topology".
           23-Aug-2017    3       Updated Table 1: "Device summary table"
                                  Updated the features and the device summary table in cover page.
           13-Nov-2017    4
                                  Minor text changes throughout the document.
                                DocID030499 Rev 4                                               33/34


                                                                                                                                  STUSB4710
                                           IMPORTANT NOTICE – PLEASE READ CAREFULLY
STMicroelectronics NV and its subsidiaries (“ST”) reserve the right to make changes, corrections, enhancements, modifications, and
improvements to ST products and/or to this document at any time without notice. Purchasers should obtain the latest relevant information on ST
products before placing orders. ST products are sold pursuant to ST’s terms and conditions of sale in place at the time of order
acknowledgement.
Purchasers are solely responsible for the choice, selection, and use of ST products and ST assumes no liability for application assistance or the
design of Purchasers’ products.
No license, express or implied, to any intellectual property right is granted by ST herein.
Resale of ST products with provisions different from the information set forth herein shall void any warranty granted by ST for such product.
ST and the ST logo are trademarks of ST. All other product or service names are the property of their respective owners.
Information in this document supersedes and replaces information previously supplied in any prior versions of this document.
                                                  © 2017 STMicroelectronics – All rights reserved
34/34                                                        DocID030499 Rev 4


Mouser Electronics
Authorized Distributor
Click to View Pricing, Inventory, Delivery & Lifecycle Information:
STMicroelectronics:
 STUSB4710AQTR STUSB4710ADTR STUSB4710AQ1TR
