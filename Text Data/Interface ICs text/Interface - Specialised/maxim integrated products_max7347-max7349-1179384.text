19-3556; Rev 5; 5/07
                      KIT
                ATION
           EVALU   BL E
             AVAILA
                                 2-Wire Interfaced Low-EMI Key Switch
                                                and Sounder Controllers
                                  General Description                                                              Features
                                                                                                                                      MAX7347/MAX7348/MAX7349
The MAX7347/MAX7348/MAX7349                     I2C
                                       interfaced periph-               ♦ 400kbps, 5.5V-Tolerant 2-Wire Serial Interface
erals provide microprocessors with management of up to
64 key switches. Key inputs are monitored statically, not               ♦ 2.4V to 3.6V Operation
dynamically scanned, to ensure low-EMI operation. The                   ♦ Monitor Up to 64 Keys (MAX7349),
MAX7347 can monitor up to 24 switches, the MAX7348                        40 Keys (MAX7348), or 24 Keys (MAX7347)
can monitor up to 40 switches, and the MAX7349 can
monitor up to 64 switches. The switches can be metallic                 ♦ FIFO Queues Up to 8 Debounced Key Events
or resistive (carbon) up to 1kΩ.                                        ♦ Key Debounce Time User Configurable from 9ms
The key controller debounces and maintains a FIFO of                      to 40ms
key-press events (including autorepeat, if enabled). An
interrupt (INT) output can be configured to alert key                   ♦ Key Autorepeat Rate and Delay User Configurable
presses either as they occur, or at maximum rate.                       ♦ Low-EMI Design Uses Static Matrix Monitoring
The MAX7348/MAX7349 feature a tone generator to                         ♦ Hardware Interrupt on Each Debounced Event or
generate automatic key-click sounds or alarm tones
                                                                          FIFO Level, or at End of Definable Time Period
under processor control.
The sounder frequencies cover the 5th musical octave                    ♦ Up to Six Open-Drain Logic Outputs Available
(523.25Hz to 987.77Hz), plus seven other musical                          Capable of Driving LEDs
notes up to 2637Hz. The output can also be pro-                         ♦ Sounder Output Generates Automatic Key Clicks
grammed to be high or low for the sound duration to
operate an electronic sounder, relay, or lamp.                          ♦ 14 Programmable Musical Sounder Frequencies
The MAX7347 is offered in 16-pin QSOP and TQFN                          ♦ Continuous or Programmable Sounder Duration
packages. The MAX7348 is offered in a 20-pin QSOP                       ♦ Easy Automatic Single-Tone and Dual-Tone Alarm
package. The MAX7349 is available in 24-pin QSOP and
TQFN packages. The MAX7347/MAX7348/MAX7349                                Sound Generation
operate over the -40°C to +125°C temperature range.                     ♦ Four I2C Address Choices
                                                 Applications           ♦ Selectable 2-Wire Serial Bus Timeout
         Medical Instruments                                            ♦ Under 10µA Shutdown Current
         Instrumentation Panels
         Security and Access
                                                                                                Ordering Information
         Industrial Controls
                                                                                                            PIN-          PKG
Pin Configurations appear at end of data sheet.                              PART          TEMP RANGE                     CODE
                                                                                                            PACKAGE
                                                                        MAX7347AEE+       -40°C to +125°C   16 QSOP       E16-4
                  Typical Application Circuit
                                                                        MAX7347ATE+       -40°C to +125°C   16 TQFN-EP*   T1644-4
                                                                        MAX7348AEP+       -40°C to +125°C   20 QSOP       E20-1
      INPUT
   2.4V TO 3.6V
                               MAX7349           8                      MAX7349AEG+       -40°C to +125°C   24 QSOP       E24-1
                       V+                COL_                SWITCH                                                       T2444-4
                                                                        MAX7349ATG+       -40°C to +125°C   24 TQFN-EP*
                                                            ARRAY, UP
                                                 8            TO 64     +Denotes lead-free package.
                                         ROW_               SWITCHES
                                                                        *EP = Exposed paddle.
                       SCL
                       SDA
                       ALERT                          PIEZO
                                                      TRANSDUCER
                       INT
                       AD0          SOUNDER
                       GND
                            ________________________________________________________________ Maxim Integrated Products            1
For pricing, delivery, and ordering information, please contact Maxim/Dallas Direct! at
1-888-629-4642, or visit Maxim’s website at www.maxim-ic.com.


                          2-Wire Interfaced Low-EMI Key Switch
                          and Sounder Controllers
                          ABSOLUTE MAXIMUM RATINGS
MAX7347/MAX7348/MAX7349
                          (All voltages referenced to GND.)                                                                Continuous Power Dissipation (TA = +70°C)
                          V+ ............................................................................-0.3V to +4V        16-Pin QSOP (derate 8.3mW/°C above +70°C)...........666mW
                          COL2/PORT2–COL7/PORT7 ....................................-0.3V to +4V                             16-Pin TQFN (derate 16.9mW/°C above +70°C).......1349.1mW
                          SDA, SCL, AD0, ALERT, INT ....................................-0.3V to +6V                         20-Pin QSOP (derate 9.1mW/°C above +70°C)...........727mW
                          All Other Pins................................................-0.3V to (V+ + 0.3V)                 24-Pin QSOP (derate 9.5mW/°C above +70°C)...........761mW
                          DC Current on COL2/PORT2–COL7/PORT7 ......................25mA                                     24-Pin TQFN (derate 20.8mW/°C above +70°C).......1666.7mW
                          DC Current on SOUNDER ................................................±25mA                      Operating Temperature Range (TMIN to TMAX) ...-40°C to +125°C
                          GND Current .......................................................................80mA          Junction Temperature ......................................................+150°C
                                                                                                                           Storage Temperature Range .............................-65°C to +150°C
                                                                                                                           Lead Temperature (soldering, 10s) .................................+300°C
                          Stresses beyond those listed under “Absolute Maximum Ratings” may cause permanent damage to the device. These are stress ratings only, and functional
                          operation of the device at these or any other conditions beyond those indicated in the operational sections of the specifications is not implied. Exposure to
                          absolute maximum rating conditions for extended periods may affect device reliability.
                          ELECTRICAL CHARACTERISTICS
                          (V+ = 2.4V to 3.6V, TA = TMIN to TMAX, unless otherwise noted. Typical values are at V+ = 3.3V, TA = +25°C.) (Notes 1, 2)
                                         PARAMETER                             SYMBOL                                   CONDITIONS                            MIN         TYP         MAX        UNITS
                           Operating Supply Voltage                                 V+                                                                         2.4                     3.6           V
                           Operating Supply Current                                  I+          All key switches open                                                      75         100          µA
                           Shutdown Supply Current                                  ISH                                                                                   6.44          10          µA
                                                                                                                                                              V+ -
                           SOUNDER Output High Voltage                          VOHBUZ           ISOURCE = 10mA                                                                                      V
                                                                                                                                                              0.45
                           SOUNDER Output Low Voltage                            VOLBUZ          ISINK = 10mA                                                                         0.15           V
                           SOUNDER Frequency Accuracy                                            TA = +25°C, V+ = 3.3V                                                     1.2                      %
                           Key-Switch Source Current                               IKEY                                                                                     28          40          µA
                           Key-Switch Source Voltage                               VKEY                                                                                   0.35        0.65           V
                           Key-Switch Resistance                                   RKEY           (Note 3)                                                                              1           kΩ
                           Startup Time from Shutdown                             tSTART                                                                                    57         200          µs
                           Output Low Voltage
                           COL2/PORT2 to COL7/PORT7,                            VOLPORT          ISINK = 10mA                                                                         0.15           V
                           INT Output
                                                                                                 Input voltage ≤ V+                                             -1                     +1
                           Input Leakage Current Alert                                                                                                                                              µA
                                                                                                 Input voltage > V+                                             -5                     +5
                           Input High Voltage ALERT                                 VIH                                                                        2.2                                   V
                           Input Low Voltage ALERT                                  VIL                                                                                                0.8           V
                           SERIAL-INTERFACE SPECIFICATIONS
                           Serial Bus Timeout                                      tOUT          With bus timeout enabled                                      20                       68          ms
                           Input High Voltage
                                                                                    VIH                                                                        2.2                                   V
                           SDA, SCL, AD0
                           Input Low Voltage
                                                                                    VIL                                                                                                0.6           V
                           SDA, SCL, AD0
                           Input Leakage Current                                                 Input voltage ≤ V+                                             -1                     +1
                                                                                                                                                                                                    µA
                           SDA, SCL, AD0                                                         Input voltage > V+                                             -5                     +5
                          2     _______________________________________________________________________________________


                          2-Wire Interfaced Low-EMI Key Switch
                                         and Sounder Controllers
I2C TIMING CHARACTERISTICS
                                                                                                                                          MAX7347/MAX7348/MAX7349
(V+ = 2.4V to 3.6V, TA = TMIN to TMAX, unless otherwise noted. Typical values are at V+ = 3.3V, TA = +25°C.) (Notes 1, 2)
          PARAMETER                  SYMBOL                      CONDITIONS                       MIN       TYP      MAX      UNITS
 Input Capacitance
                                        CIN       (Notes 3, 4)                                                        10        pF
 (SCL, SDA, AD0)
                                                  With bus timeout enabled                        0.05               400
 SCL Serial Clock Frequency             fSCL                                                                                   kHz
                                                  With bus timeout disabled                         0                400
 Bus Free Time Between a STOP
                                        tBUF                                                       1.3                          µs
 and a START Condition
 Hold Time (Repeated) START
                                      tHD, STA                                                     0.6                          µs
 Condition
 Repeated START Condition
                                      tSU, STA                                                     0.6                          µs
 Setup Time
 STOP Condition Setup Time            tSU, STO                                                     0.6                          µs
 Data Hold Time                       tHD, DAT    (Note 5)                                                            0.9       µs
 Data Setup Time                      tSU, DAT                                                    100                           ns
 SCL Clock Low Period                   tLOW                                                       1.3                          µs
 SCL Clock High Period                 tHIGH                                                       0.7                          µs
 Rise Time of Both SDA and SCL                                                                             20 +
                                         tR       (Notes 3, 4)                                                       300        ns
 Signals, Receiving                                                                                        0.1Cb
 Fall Time of Both SDA and SCL                                                                             20 +
                                         tF       (Notes 3, 4)                                                       300        ns
 Signals, Receiving                                                                                        0.1Cb
                                                                                                           20 +
 Fall Time of SDA Transmitting          tF.TX     (Notes 3, 6)                                                       250        ns
                                                                                                           0.1Cb
 Pulse Width of Spike Suppressed         tSP      (Notes 3, 7)                                                        50        ns
 Capacitive Load for Each Bus
                                         Cb       (Note 3)                                                           400        pF
 Line
Note 1: All parameters are tested at TA = +25°C. Specifications over temperature are guaranteed by design.
Note 2: All digital inputs at V+ or GND.
Note 3: Guaranteed by design.
Note 4: Cb = total capacitance of one bus line in pF. tR and tF measured between 0.8V and 2.1V.
Note 5: A master device must provide a hold time of at least 300ns for the SDA signal (referred to VIL of the SCL signal) to bridge
        the undefined region of SCL’s falling edge.
Note 6: ISINK ≤ 6mA. Cb = total capacitance of one bus line in pF. tR and tF measured between 0.8V and 2.1V.
Note 7: Input filters on the SDA, SCL, and AD0 inputs suppress noise spikes less than 50ns.
                     _______________________________________________________________________________________                          3


                           2-Wire Interfaced Low-EMI Key Switch
                           and Sounder Controllers
                                                                                                                                                                                                                          Typical Operating Characteristics
MAX7347/MAX7348/MAX7349
                           (V+ = 3.3V, TA = +25°C, unless otherwise noted. Supply range for V+ is 2.4V to 3.6V. Temperature range is -40°C to +125°C.)
                                                                  GPO OUTPUT LOW VOLTAGE                                                                                                 GPO OUTPUT LOW VOLTAGE                                                                                                   GPO OUTPUT LOW VOLTAGE
                                                                      vs. SINK CURRENT                                                                                                       vs. SINK CURRENT                                                                                                         vs. SINK CURRENT
                                                 300                                                                                                                     300                                                                                                                     300
                                                                                                                        MAX7347 toc01                                                                                                               MAX7347 toc02                                                                                                 MAX7347 toc03
                                                             V+ = 2.4V                                                                                                               V+ = 3V                                                                                                                 V+ = 3.6V
                                                 250                                                                                                                     250                                                                                                                     250
                                                 200                      TA = +125°C                                                                                    200                                                                                                                     200
                                                                                                                                                                                                         TA = +125°C
                           VOL (mV)                                                                                                     VOL (mV)                                                                                                                    VOL (V)
                                                                                                                                                                                                                                                                                                                              TA = +125°C
                                                 150                                                                                                                     150                                                                                                                     150
                                                 100                                                  TA = -40°C                                                         100                                                                                                                     100
                                                                                                                                                                                                                                     TA = -40°C                                                                                                   TA = -40°C
                                                 50                                   TA = +25°C                                                                         50                                                                                                                      50
                                                                                                                                                                                                                    TA = +25°C                                                                                                          TA = +25°C
                                                  0                                                                                                                       0                                                                                                                       0
                                                       0            5           10         15          20          25                                                          0               5               10         15           20         25                                                   0            5            10         15       20         25
                                                                                ISINK (mA)                                                                                                                     ISINK (mA)                                                                                                        ISINK (mA)
                                                                          SUPPLY CURRENT                                                                                              KEY-SWITCH SOURCE CURRENT                                                                                                      SOUNDER FREQUENCY
                                                                        vs. SUPPLY VOLTAGE                                                                                                 vs. SUPPLY VOLTAGE                                                                                                        vs. SUPPLY VOLTAGE
                                                 90                                                                                                                      30                                                                                                                      886
                                                                                                                        MAX7347 toc04                                                                                                               MAX7347 toc05                                                                                                 MAX7347 toc06
                                                                                                                                                                                   COL0 = GND                                                                                                              SOUNDER FREQUENCY
                                                 85                                                                                                                                                                                                                                                        CONFIGURED FOR 880Hz
                                                                                                                                        KEY-SWITCH SOURCE CURRENT (μA)
                                                                                                                                                                         29                                                                                                                      884
                                                 80
                                                                                                                                                                                                                                                                    SOUNDER FREQUENCY (Hz)
                                                                                             TA = +25°C                                                                               TA = -40°C
                           SUPPLY CURRENT (μA)
                                                 75                 TA = +125°C                                                                                          28                                                                                                                      882                                        TA = -40°C
                                                 70
                                                 65                                                                                                                      27                                                                                                                      880
                                                 60                                                                                                                                                                 TA = +25°C
                                                                                                                                                                                                                                                                                                                                             TA = +25°C
                                                                                                                                                                         26                                                                                                                      878
                                                 55
                                                                                                                                                                                                                                                                                                                                            TA = +125°C
                                                 50                                  TA = -40°C                                                                                                                     TA = +125°C
                                                                                                                                                                         25                                                                                                                      876
                                                 45
                                                 40                                                                                                                      24                                                                                                                      874
                                                       2.4       2.6      2.8        3.0        3.2     3.4        3.6                                                         2.4       2.6             2.8        3.0        3.2         3.4    3.6                                                  2.4              2.7           3.0          3.3          3.6
                                                                         SUPPLY VOLTAGE (V)                                                                                                          SUPPLY VOLTAGE (V)                                                                                                   SUPPLY VOLTAGE (V)
                                                                                                                                                                                          OSCILLATOR FREQUENCY                                                                                                    OSCILLATOR FREQUENCY
                                                                         SOUNDER OUTPUT                                                                                                     vs. SUPPLY VOLTAGE                                                                                                       vs. TEMPERATURE
                                                                                                        MAX7347 toc07
                                                                                                                                                                         65                                                                                                                      65
                                                                                                                                                                                                                                                    MAX7347 toc08                                                                                                 MAX7347 toc09
                                                                                                                                        OSCILLATOR FREQUENCY (kHz)                                                                                                  OSCILLATOR FREQUENCY (kHz)
                                                                                                                                                                         64                                                                                                                      64
                                                  3V                                                                                                                     63                                                                                                                      63
                          VSOUNDER
                             1V/div                                                                                                                                      62                                                                                                                      62
                                                  0V
                                                                                                                                                                         61                                                                                                                      61
                                                                                                                                                                         60                                                                                                                      60
                                                                                200μs/div                                                                                      2.4                 2.7              3.0              3.3          3.6                                                  -40                10                 60           110
                                                                                                                                                                                                     SUPPLY VOLTAGE (V)                                                                                                       TEMPERATURE (°C)
                           4                      _______________________________________________________________________________________


                       2-Wire Interfaced Low-EMI Key Switch
                                      and Sounder Controllers
                                                                                                   Pin Description
                                                                                                                                    MAX7347/MAX7348/MAX7349
                        PIN
MAX7347 MAX7347         MAX7349 MAX7349                   NAME                             FUNCTION
                MAX7348
 (QSOP)  (TQFN)          (QSOP)  (TQFN)
    1         15         1         2        23            ROW0       Row Input from Key Matrix. Leave open circuit if unused.
    2         16         2         3        24            ROW1       Row Input from Key Matrix. Leave open circuit if unused.
    3         1          3         4         1            ROW2       Row Input from Key Matrix. Leave open circuit if unused.
    4         2          4         5         2            ROW3       Row Input from Key Matrix. Leave open circuit if unused.
    5         3          7         8         5            ROW4       Row Input from Key Matrix. Leave open circuit if unused.
    6         4          8         9         6            ROW5       Row Input from Key Matrix. Leave open circuit if unused.
    7         5          9        10         7            ROW6       Row Input from Key Matrix. Leave open circuit if unused.
    8         6         10        11         8            ROW7       Row Input from Key Matrix. Leave open circuit if unused.
    9         7         11        14        11      COL2/PORT2 Column Output to Key Matrix or GPO
   10         8         12        15        12            COL1       Column Output to Key Matrix
   11         9         13        16        13            COL0       Column Output to Key Matrix
   12         10        15        18        15            GND        Ground
   13         11        17        20        17            SDA        I2C-Compatible Serial Data I/O
   14         12        18        21        18            SCL        I2C-Compatible Serial Clock Input
   15         13        19        22        19            INT        Active-Low Interrupt Output. Output is open drain.
                                                                     Positive Supply Voltage. Bypass V+ to GND with a
   16         14        20        23        20             V+
                                                                     0.047µF or higher ceramic capacitor.
    —         —          5         6         3      COL3/PORT3 Column Output to Key Matrix or GPO
    —         —          6         7         4      COL4/PORT4 Column Output to Key Matrix or GPO
                                                                     Sounder Driver Output. Typically connect a piezo-ceramic
    —         —         14        17        14       SOUNDER         sounder or other transducer from this output to ground.
                                                                     Output is push-pull.
                                                                     Address Input 0. Sets device slave address. Connect to
    —         —         16        19        16            AD0        GND, V+, SDA, or SCL to give four logic combinations.
                                                                     See Table 3.
    —         —          —         1        22      COL7/PORT7 Column Output to Key Matrix or GPO
    —         —          —        12         9      COL6/PORT6 Column Output to Key Matrix or GPO
    —         —          —        13        10      COL5/PORT5 Column Output to Key Matrix or GPO
    —         —          —        24        21        ALERT          Alert Input. Connect to GND or V+ if unused.
                                                                     Exposed Paddle. Internally connected to GND. Connect to
    —         EP         —        —         EP             EP
                                                                     a large ground plane to maximize thermal performance.
                      Detailed Description                      The piezo sounder controller generates a variety of
                                                                audio tones. Tones are programmable for frequency
The MAX7347/MAX7348/MAX7349 are microprocessor
                                                                and duration, and may be intermittent, two tone, or con-
peripherals that combine a low-noise key-switch inter-
                                                                tinuous. The piezo sounder controller can be config-
face with a piezo sounder controller. Up to 64 key
                                                                ured to deliver an automatic, customizable sound on
switches can be monitored and debounced with optional
                                                                every key press to provide a udible key-click feedback.
autorepeat, and the key events are presented in an
eight-deep FIFO. Key-switch functionality can be traded         Interrupt requests can be configured to be issued on
to provide up to one (MAX7347), three (MAX7348), or six         every key-press event, or can be limited to a maximum
(MAX7349) open-drain logic outputs. (Table 1).                  rate to prevent overloading the microprocessor with
                   _______________________________________________________________________________________                      5


                          2-Wire Interfaced Low-EMI Key Switch
                          and Sounder Controllers
MAX7347/MAX7348/MAX7349
                          Table 1. Product Features Table
                                                                                   KEY-
                                                      MAXIMUM
                                        PACKAGE-                       INT        SCAN         SOUNDER        SOUNDER                        ALERT
                               PART                     KEY                                                                    GPOs
                                          PINS                       OUTPUT       SLAVE        SLAVE IDs       OUTPUT                        INPUT
                                                      SWITCHES
                                                                                    IDs
                              MAX7349       24             64          Yes          4               4            Yes         6 + 1 (INT)       Yes
                              MAX7348       20             40          Yes          4               4            Yes         3 + 1 (INT)        —
                              MAX7347       16             24          Yes        1 fixed          —              —          1 + 1 (INT)        —
                          too many interrupts. The key-switch status can be                                                 Key-Scan Controller
                          checked at any time by reading the key-switch FIFO. A             Key inputs are scanned statically, not dynamically, to
                          1-byte read access returns both the first key-press               ensure low-EMI operation. As inputs only toggle in
                          event in the FIFO (if there is one) and the FIFO status,          response to switch changes, the key matrix can be
                          so it is easy to operate the MAX7347/MAX7348/                     routed closer to sensitive circuit nodes.
                          MAX7349 by polling. If the INT pin is not required, it            The key controller debounces and maintains a FIFO of
                          can be configured as an open-drain general-purpose                key-press events (including autorepeated key presses,
                          output (GPO) capable of driving an LED.                           if autorepeat is enabled). Figure 1 shows keys order.
                          The MAX7349 monitors up to 64 keys. The MAX7348
                          monitors up to 40 keys. The MAX7347 monitors up to                                                Serial Interface
                          24 keys (Table 1).                                                Figure 2 shows the 2-wire serial interface timing details.
                          If the application requires fewer keys to be scanned, up                                             Serial Addressing
                          to six of the key-switch outputs can be configured as             The MAX7347/MAX7348/MAX7349 operate as slaves
                          open-drain GPOs capable of driving LEDs. For each                 that send and receive data through an I2C-compatible
                          key-switch output used as a GPO, the number of key                2-wire interface. The interface uses a serial data line
                          switches that can be scanned is reduced by eight.                 (SDA) and a serial clock line (SCL) to achieve bidirec-
                          An alert logic input (MAX7349 only) can be configured             tional communication between master(s) and slave(s).
                          to deliver an automatic, customizable sound and/or an             A master (typically a microcontroller) initiates all data
                          interrupt on every falling edge of the logic input. The           transfers to and from the MAX7347/MAX7348/MAX7349
                          logic state of the alert input can be read at any time.           and generates the SCL clock that synchronizes the
                                                                                            data transfer.
                                                                Tone Generator
                          The piezo sounder controller generates a square wave              The MAX7347/MAX7348/MAX7349s’ SDA line operates
                          with the frequency of a musical tone under processor con-         as both an input and an open-drain output. A pullup
                          trol. The selection of tones covers the 5th musical octave        resistor, typically 4.7kΩ, is required on SDA. The
                          (523.25Hz to 987.77Hz), plus seven other notes up to              MAX7347/MAX7348/MAX7349s’ SCL line operates only
                          2637Hz. The sounder output is also programmable to be             as an input. A pullup resistor, typically 4.7kΩ, is required
                          either high or low for the entire sound duration to operate       on SCL if there are multiple masters on the 2-wire inter-
                          an electronic sounder, relay, or lamp instead of a piezo          face, or if the master in a single-master system has an
                          transducer. The sound duration is programmable from               open-drain SCL output.
                          15.625ms in seven binary steps up to a maximum of 1s.             Each transmission consists of a START condition
                          The piezo sounder controller interface uses a single 1-           (Figure 3) sent by a master, followed by the MAX7347/
                          byte access to its own separate slave address.                    MAX7348/MAX7349 7-bit slave address plus R/W bit, a
                          Commands are double-buffered to allow two commands                register address byte, 1 or more data bytes, and finally
                          (2 bytes) to be stored and executed in succession. The            a STOP condition.
                          sounder controller performs the transition between                                        Start and Stop Conditions
                          queued sound commands without click artifacts. The                Both SCL and SDA remain high when the interface is
                          controller can also autoloop between the two most                 not busy. A master signals the beginning of a transmis-
                          recent commands. Autolooping allows a wide range of               sion with a START (S) condition by transitioning SDA
                          intermittent and two-tone sounds to be initiated, and             from high to low while SCL is high. When the master
                          then run automatically without further intervention.              has finished communicating with the slave, it issues a
                          6    _______________________________________________________________________________________


                              2-Wire Interfaced Low-EMI Key Switch
                                             and Sounder Controllers
                                                                                                                          MAX7347/MAX7348/MAX7349
            *MAX7348 AND
             MAX7349 ONLY.
            **MAX7349 ONLY.
                                         KEY     KEY       KEY       KEY     KEY     KEY     KEY     KEY
                                          0       8         16        24      32      40      48      56
            COL7/PORT7**
            COL6/PORT6**
            COL5/PORT5**
                                         KEY     KEY       KEY       KEY     KEY     KEY     KEY     KEY
             COL4/PORT4*                  1       9         17        25      33      41      49      57
             COL3/PORT3*
             COL2/PORT2
                   COL1
                                         KEY     KEY       KEY       KEY     KEY     KEY     KEY     KEY
                   COL0                   2       10        18        26      34      42      50      58
                   ROW0
                   ROW1
                   ROW2                  KEY     KEY       KEY       KEY     KEY     KEY     KEY     KEY
                   ROW3                   3       11        19        27      35      43      51      59
                   ROW4
                   ROW5
                   ROW6                  KEY     KEY       KEY       KEY     KEY     KEY     KEY     KEY
                   ROW7                   4       12        20        28      36      44      52      60
                                         KEY     KEY       KEY       KEY     KEY     KEY     KEY     KEY
                                          5       13        21        29      37      45      53      61
                                         KEY     KEY       KEY       KEY     KEY     KEY     KEY     KEY
                                          6       14        22        30      38      46      54      62
                                         KEY     KEY       KEY       KEY     KEY     KEY     KEY     KEY
                                          7       15        23        31      39      47      55      63
Figure 1. Keys Order
STOP (P) condition by transitioning SDA from low to              byte of data. Thus, each byte transferred effectively
high while SCL is high. The bus is then free for another         requires 9 bits. The master generates the 9th clock
transmission.                                                    pulse, and the recipient pulls down SDA during the
                                                                 acknowledge clock pulse, so the SDA line is stable low
                                         Bit Transfer            during the high period of the clock pulse. When the
One data bit is transferred during each clock pulse              master is transmitting to the MAX7347/MAX7348/
(Figure 4). The data on SDA must remain stable while             MAX7349, the MAX7347/MAX7348/MAX7349 generate
SCL is high.                                                     the acknowledge bit because the MAX7347/MAX7348/
                                       Acknowledge               MAX7349 are the recipients. When the MAX7347/
The acknowledge bit is a clocked 9th bit (Figure 5),             MAX7348/MAX7349 are transmitting to the master, the
which the recipient uses to handshake receipt of each            master generates the acknowledge bit because the
                                                                 master is the recipient.
                     _______________________________________________________________________________________         7


                          2-Wire Interfaced Low-EMI Key Switch
                          and Sounder Controllers
MAX7347/MAX7348/MAX7349
                                 SDA
                                                                                                                                                         tBUF
                                                                          tSU, DAT                     tSU, STA            tHD, STA
                                                             tLOW                                                                     tSU, STO
                                                                                        tHD, DAT
                                 SCL                                     tHIGH
                                       tHD, STA
                                                                    tR           tF
                                               START                                                             REPEATED                          STOP           START
                                             CONDITION                                                        START CONDITION                    CONDITION      CONDITION
                          Figure 2. 2-Wire Serial Interface Timing Details
                                           SDA
                                            SCL
                                                         S                                                                                               P
                                                     START                                                                                             STOP
                                                   CONDITION                                                                                         CONDITION
                          Figure 3. Start and Stop Conditions
                                                  SDA
                                                  SCL
                                                                           DATA LINE STABLE;       CHANGE OF DATA
                                                                             DATA VALID              ALLOWED
                          Figure 4. Bit Transfer
                          8   _______________________________________________________________________________________


                        2-Wire Interfaced Low-EMI Key Switch
                                       and Sounder Controllers
                                                                                                                              MAX7347/MAX7348/MAX7349
Table 2. Key-Switch Mapping
   PIN         COL0           COL1      COL2/PORT2 COL3/PORT3 COL4/PORT4 COL5/PORT5 COL6/PORT6 COL7/PORT7
  ROW0         KEY 0          KEY 8       KEY 16        KEY 24         KEY 32       KEY 40        KEY 48         KEY 56
  ROW1         KEY 1          KEY 9       KEY 17        KEY 25         KEY 33       KEY 41        KEY 49         KEY 57
  ROW2         KEY 2          KEY 10      KEY 18        KEY 26         KEY 34       KEY 42        KEY 50         KEY 58
  ROW3         KEY 3          KEY 11      KEY 19        KEY 27         KEY 35       KEY 43        KEY 51         KEY 59
  ROW4         KEY 4          KEY 12      KEY 20        KEY 28         KEY 36       KEY 44        KEY 52         KEY 60
  ROW5         KEY 5          KEY 13      KEY 21        KEY 29         KEY 37       KEY 45        KEY 53         KEY 61
  ROW6         KEY 6          KEY 14      KEY 22        KEY 30         KEY 38       KEY 46        KEY 54         KEY 62
  ROW7         KEY 7          KEY 15      KEY 23        KEY 31         KEY 39       KEY 47        KEY 55         KEY 63
Table 3. 2-Wire Interface Address Map
                                          DEVICE ADDRESS
  PIN AD0                                                                                            FUNCTION
               A7        A6       A5       A4      A3       A2          A1       A0 R/W
                                                                                    0     Key-scan controller write
                                                                         0
                                                                                    1     Key-scan controller read
    GND         0         1        1       1       0        0
                                                                                    0     Sounder controller write
                                                                         1
                                                                                    1     Sounder controller read
                                                                                    0     Key-scan controller write
                                                                         0
                                                                                    1     Key-scan controller read
    V+          0         1        1       1       0        1
                                                                                    0     Sounder controller write
                                                                         1
                                                                                    1     Sounder controller read
                                                                                    0     Key-scan controller write
                                                                         0
                                                                                    1     Key-scan controller read
    SDA         0         1        1       1       1        0
                                                                                    0     Sounder controller write
                                                                         1
                                                                                    1     Sounder controller read
                                                                                    0     Key-scan controller write
                                                                         0
                                                                                    1     Key-scan controller read
    SCL         0         1        1       1       1        1
                                                                                    0     Sounder controller write
                                                                         1
                                                                                    1     Sounder controller read
                                      Slave Addresses            controller. The AD0 input can be connected to any of
The MAX7347/MAX7348/MAX7349 have two 7-bit long                  four signals: GND, V+, SDA, or SCL, giving four possible
slave addresses (Figure 6). The bit following a 7-bit            slave address pairs, allowing up to four MAX7348/
slave address is the R/W bit, which is low for a write           MAX7349 devices to share the bus. Only one MAX7347
command and high for a read command.                             can share the bus. The MAX7347 AD0 input is internally
The first 4 bits (MSBs) of the MAX7347/MAX7348/                  connected to GND.
MAX7349 slave addresses are always 0111. Slave                   The MAX7347/MAX7348/MAX7349 monitor the bus
address bits A3, A2, and A1 correspond, by the matrix            continuously, waiting for a START condition followed by
in Table 3, to the states of the device address input            its slave address. When MAX7347/MAX7348/MAX7349
AD0, and A0 corresponds to the R/W bit. MAX7347/                 recognize their slave address, they acknowledge and
MAX7348/MAX7349 use two slave addresses, one for                 are then ready for continued communication.
the main key-scan controller, and one for the sounder
                    _______________________________________________________________________________________               9


                          2-Wire Interfaced Low-EMI Key Switch
                          and Sounder Controllers
MAX7347/MAX7348/MAX7349
                                                      START                                                          CLOCK PULSE FOR
                                                    CONDITION                                                          ACKNOWLEDGE
                                             SCL                     1                2                          8                      9
                                              SDA
                                               BY
                                      TRANSMITTER
                                             SDA
                                               BY
                                         RECEIVER
                                                        S
                          Figure 5. Acknowledge
                                           SDA          0       1        1       1        A3      A2       A1              R/W         ACK
                                                      MSB                                                  LSB
                                           SCL
                          Figure 6. Slave Address
                                                                     Bus Timeout           Any bytes received after the command byte are data
                          The MAX7347/MAX7348/MAX7349 feature a 20ms mini-                 bytes. The first data byte goes into the internal register
                          mum bus timeout on the 2-wire serial interface, largely to       of the MAX7347/MAX7348/MAX7349 selected by the
                          prevent the MAX7347/MAX7348/MAX7349 from holding                 command byte (Figure 8).
                          the SDA I/O low during a read transaction if the SCL             If multiple data bytes are transmitted before a STOP
                          hangs for any reason before a serial transaction has             condition is detected, these bytes are generally stored
                          been completed. Bus timeout operates by causing the              in subsequent MAX7347/MAX7348/MAX7349 internal
                          MAX7347/MAX7348/MAX7349 to internally terminate a                registers (Table 7) because the command byte address
                          serial transaction, either read or write, if the time between    generally autoincrements (Table 4).
                          adjacent edges on SCL exceeds 20ms. After a bus time-
                          out, the MAX7347/MAX7348/MAX7349 wait for a valid                              Message Format for Reading the
                          START condition before responding to a consecutive                                        Key-Scan Controller
                          transmission. The bus timeout feature requires the serial        The MAX7347/MAX7348/MAX7349 are read using the
                          interface to operate above 50Hz bus speed. This feature          MAX7347/MAX7348/MAX7349s’ internally stored com-
                          can be enabled or disabled under user control by writing         mand byte as an address pointer, the same way the
                          to the configuration register (Table 12).                        stored command byte is used as an address pointer for
                                                                                           a write. The pointer generally autoincrements after each
                                          Message Format for Writing the                   data byte is read using the same rules as for a write
                                                    Key-Scan Controller                    (Table 4). Thus, a read is initiated by first configuring
                          A write to the MAX7347/MAX7348/MAX7349s’ key-scan                the MAX7347/MAX7348/MAX7349s’ command byte by
                          controller comprises the transmission of the                     performing a write (Figure 7). The master can now read
                          MAX7347/MAX7348/MAX7349s’ key-scan slave address                 n consecutive bytes from the MAX7347/MAX7348/
                          with the R/W bit set to zero, followed by at least 1 byte of     MAX7349, with the first data byte being read from the
                          information. The first byte of information is the command        register addressed by the initialized command byte.
                          byte. The command byte determines which register of the          When performing read-after-write verification, remem-
                          MAX7347/MAX7348/MAX7349 is to be written by the next             ber to reset the command byte’s address because the
                          byte, if received. If a STOP condition is detected after the     stored command byte address is generally autoincre-
                          command byte is received, then the MAX7347/MAX7348               mented after the write (Figure 9, Table 4).
                          /MAX7349 take no further action (Figure 7) beyond stor-
                          ing the command byte.
                          10   ______________________________________________________________________________________


                           2-Wire Interfaced Low-EMI Key Switch
                                          and Sounder Controllers
                                                                                                                                                                              MAX7347/MAX7348/MAX7349
                              COMMAND BYTE IS STORED ON RECEIPT OF
                                           ACKNOWLEDGE CONDITION                      D7     D6    D5     D4     D3    D2    D1    D0
                    ACKNOWLEDGE FROM MAX7347/MAX7348/MAX7349
                      S                 SLAVE ADDRESS               0        A                          COMMAND BYTE                     A      P
                                                        R/W              ACKNOWLEDGE FROM MAX7347/MAX7348/MAX7349
Figure 7. Command Byte Received
                                                ACKNOWLEDGE FROM MAX7347/MAX7348/MAX7349                       ACKNOWLEDGE FROM MAX7347/MAX7348/MAX7349
                                                   D7     D6   D5       D4       D3    D2     D1    D0            D7   D6     D5   D4   D3      D2    D1   D0
   ACKNOWLEDGE FROM MAX7347/MAX7348/MAX7349
   S            SLAVE ADDRESS             0    A                    COMMAND BYTE                            A                       DATA BYTE                   A    P
                                  R/W                                                                                               1 BYTE
                                                                                                                                                        AUTOINCREMENT
                                                                                                                                                     COMMAND BYTE ADDRESS
Figure 8. Command and Single Data Byte Received
   Message Format for Writing the Sounder                                              Table 4. Key-Scan Command Address
                                Controller                                             Autoincrement Rules
A write to the MAX7347/MAX7348/MAX7349s’ sounder
controller comprises the transmission of the                                                  REGISTER                      ADDRESS                  AUTOINCREMENT
MAX7347/MAX7348/MAX7349s’ sounder slave address                                               FUNCTION                      CODE (hex)                ADDRESS (hex)
with the R/W bit set to zero, followed by at least 1 com-
mand byte of information. The sounder controller ana-                                      Keys FIFO                           0x00                         0x00
lyzes each incoming data byte, and depending on the                                        Debounce                            0x01                         0x02
state of the sounder controller’s 2-deep FIFO and the                                      Autorepeat                          0x02                         0x03
contents of the command byte, the command byte is                                          Interrupt                           0x03                         0x04
added to the FIFO or it overwrites the last FIFO data
item (Table 16).                                                                           Configuration                       0x04                         0x05
                                                                                           Port                                0x05                         0x06
  Message Format for Reading the Sounder                                                   Key Sound                           0x06                         0x07
                               Controller
                                                                                           Alert Sound                         0x07                         0x00
A read from the MAX7347/MAX7348/MAX7349s’ sounder
controller comprises the transmission of the
MAX7347/MAX7348/MAX7349s’ sounder slave address                                                                 Operation with Multiple Masters
with the R/W bit set to 1. The master can now read n con-                              If the MAX7347/MAX7348/MAX7349 are operated on a 2-
secutive bytes from the MAX7347/MAX7348/MAX7349,                                       wire interface with multiple masters, a master reading the
each byte being a snapshot of the FIFO status of the                                   MAX7347/MAX7348/MAX7349 should use a repeated
sounder controller (Table 16). If the master wishes to poll                            start between the write that sets the MAX7347/MAX7348/
the sounder controller until there is room for another com-                            MAX7349s’ address pointer, and the read(s) that takes
mand to be sent, the master can read bytes continuously                                the data from the location(s). This is because it is possi-
from the sounder controller until the information is satis-                            ble for master 2 to take over the bus after master 1 has
factory and then issue a STOP condition.                                               set up the MAX7347/MAX7348/MAX7349s’ address
                                                                                       pointer but before master 1 has read the data. If master 2
                                                                                       subsequently resets the MAX7347/MAX7348/MAX7349s’
                                                                                       address pointer, then master 1’s read may be from an
                                                                                       unexpected location.
                     ______________________________________________________________________________________                                                              11


                          2-Wire Interfaced Low-EMI Key Switch
                          and Sounder Controllers
MAX7347/MAX7348/MAX7349
                          Table 5. Key-Scan Power-Up Configuration
                               REGISTER                                                                               ADDRESS                                       REGISTER DATA
                                                                  POWER-UP CONDITION
                               FUNCTION                                                                               CODE (hex)               D7           D6     D5       D4         D3       D2       D1   D0
                          Keys FIFO              Empty                                                                      0x00                   0        0         0      0         0        0         0    0
                          Debounce               Ports 2–7 are enabled; debounce time is 39ms                               0x01                   1        1         1      1         1        1         1    1
                          Autorepeat             Autorepeat is disabled                                                     0x02                   0        0         0      0         0        0         0    0
                          Interrupt              INT is a port, not an interrupt output                                     0x03                   0        0         0      0         0        0         0    0
                                                 Shutdown mode: key sound is disabled; alert sound is
                          Configuration          disabled; alert INT is disabled; timeout enabled; no                       0x04                   0        0         0      0         0        0         0    1
                                                 sound output
                          Ports                  Ports 2–7 and INT are logic-high (high impedance)                          0x05                   1        1         1      1         1        1         1    X
                          Key Sound              Key-sound default is 31.25ms of 987.77Hz                                   0x06                   0        1         0      1         0        0         0    1
                          Alert Sound            Key-sound default is 250ms of 2093Hz                                       0x07                   1        0         1      1         1        0         1    1
                          X = Don’t care.
                          Table 6. Sounder Power-Up Configuration
                                                                                                                                                            REGISTER DATA
                                                         POWER-UP CONDITION
                                                                                                                            D7         D6              D5         D4         D3         D2           D1       D0
                          Sounder output is a general-purpose output, logic 0; queue is empty                               0             0            0          0          0             0         0        0
                                                                                 ACKNOWLEDGE FROM MAX7347/MAX7348/MAX7349           ACKNOWLEDGE FROM MAX7347/MAX7348/MAX7349
                                                                                  D7    D6   D5   D4   D3   D2   D1   D0             D7       D6       D5    D4     D3      D2    D1       D0
                                  ACKNOWLEDGE FROM MAX7347/MAX7348/MAX7349
                                S              SLAVE ADDRESS             0   A               COMMAND BYTE                       A                               DATA BYTE                        A       P
                                                                 R/W                                                                                         N BYTES
                                                                                                                                                                                    AUTOINCREMENT
                                                                                                                                                                                 COMMAND BYTE ADDRESS
                          Figure 9. N Data Bytes Received
                          12    ______________________________________________________________________________________


                          2-Wire Interfaced Low-EMI Key Switch
                                         and Sounder Controllers
                                                                                                                                        MAX7347/MAX7348/MAX7349
Table 7. Key-Scan Register Address Map
                                                                                                                           ADDRESS
     REGISTER                                                 COMMAND ADDRESS
                                                                                                                            CODE
     FUNCTION
                           D15         D14        D13           D12        D11         D10         D9            D8          (hex)
Keys FIFO                    0           0         0             0          0           0           0            0          0x00
Debounce                     0           0         0             0          0           0           0            1          0x01
Autorepeat                   0           0         0             0          0           0           1            0          0x02
Interrupt                    0           0         0             0          0           0           1            1          0x03
Configuration                0           0         0             0          0           1           0            0          0x04
Ports                        0           0         0             0          0           1           0            1          0x05
Key Sound                    0           0         0             0          0           1           1            0          0x06
Alert Sound                  0           0         0             0          0           1           1            1          0x07
Table 8. Keys FIFO Register Format
                                                  ADDRESS                               REGISTER DATA
                   REGISTER                        CODE
                                                    (hex)             D7          D6         D5     D4      D3        D2   D1   D0
                                                                 OVERFLOW        MORE            KEY SWITCH THAT HAS BEEN
             KEYS FIFO REGISTER*                    0X00
                                                                   FLAG          FLAG                   DEBOUNCED
FIFO has not overflowed                                0x00           0           X          X          X    X        X     X      X
FIFO overflowed; FIFO contains the first eight
                                                       0x00           1           X          X          X    X        X     X      X
key events
This key is the last FIFO item (key-switch data
                                                       0x00           X            0         X          X    X        X     X      X
not zero)
Key 0 was EITHER the last FIFO item OR the
                                                       0x00           0            0         0          0    0        0     0      0
FIFO is empty and no key has been pressed
This key is not the last FIFO item                     0x00           X            1         X          X    X        X     X      X
Power-up default setting                               0x00           0            0         0          0    0        0     0      0
*Reading the key-scan FIFO clears the INT. INT is only reasserted by a key event after the FIFO has been emptied by read(s).
        Command Address Autoincrementing                                                     Registers Description
Address autoincrementing allows the MAX7347/
MAX7348/MAX7349 to be configured with fewer trans-                                                           Initial Power-Up
missions by minimizing the number of times the com-                   On power-up, all control registers are reset and the
mand address needs to be sent. The command                            MAX7347/MAX7348/MAX7349 enter shutdown mode
address stored in the MAX7347/MAX7348/MAX7349                         (Tables 5, 6). Table 7 shows the register address map
generally increments after each data byte is written or               for the key-scan section.
read (Table 4). Autoincrementing applies only to the
key-scan command addresses and not to the sounder
command addresses.
                     ______________________________________________________________________________________                        13


                          2-Wire Interfaced Low-EMI Key Switch
                          and Sounder Controllers
MAX7347/MAX7348/MAX7349
                          Table 9. Debounce Register Format
                                                                             ADDRESS CODE
                                               REGISTER                                                           REGISTER DATA
                                                                                 (hex)
                                                                                                    D7    D6    D5    D4    D3    D2    D1    D0
                                        DEBOUNCE REGISTER                            0x01
                                                                                                   PORTS ENABLE            DEBOUNCE TIME
                          Debounce time is 9ms                                       0x01            X     X     X     0     0    0     0      0
                          Debounce time is 10ms                                      0x01            X     X     X     0     0    0     0      1
                          Debounce time is 11ms                                      0x01            X     X     X     0     0    0     1      0
                          Debounce time is 12ms                                      0x01            X     X     X     0     0    0     1      1
                          All the way through to                                     0x01            X     X     X    —     —     —     —     —
                          Debounce time is 37ms                                      0x01            X     X     X     1     1    1     0      0
                          Debounce time is 38ms                                      0x01            X     X     X     1     1    1     0      1
                          Debounce time is 39ms                                      0x01            X     X     X     1     1    1     1      0
                          Debounce time is 40ms                                      0x01            X     X     X     1     1    1     1      1
                          GPO ports disabled (full key-scan functionality)           0x01            0     0     0     X     X    X     X      X
                          GPO port 7 enabled                                         0x01            0     0     1     X     X    X     X      X
                          GPO ports 7 and 6 enabled                                  0x01            0     1     0     X     X    X     X      X
                          GPO ports 7, 6, and 5 enabled                              0x01            0     1     1     X     X    X     X      X
                          GPO ports 7, 6, 5, and 4 enabled                           0x01            1     0     0     X     X    X     X      X
                          GPO ports 7, 6, 5, 4, and 3 enabled                        0x01            1     0     1     X     X    X     X      X
                          GPO ports 7, 6, 5, 4, 3, and 2 enabled                     0x01            1     1     X     X     X    X     X      X
                          Power-up default setting                                   0x01            1     1     1     1     1    1     1      1
                                                             Key-Scan Registers                                             Debounce Register
                          Eight key-scan registers are described in the following       The debounce register sets the time for each debounce
                          sections.                                                     cycle, as well as setting whether the GPO ports are
                                                             Keys FIFO Register         enabled or disabled. Bits D0 through D4 set the
                                                                                        debounce time in increments of 1ms starting at 9ms
                          The keys FIFO register contains the information pertain-      and ending at 40ms (Table 9). Bits D5 through D7 set
                          ing to the status of the keys FIFO, as well as the key-       which one of the GPO ports is to be enabled. Note that
                          press events that have been debounced (Table 8). Bits         not any port can be enabled at a particular time. The
                          D0 to D5 denote which of the 64 keys have been                GPO ports can be enabled only in the combinations
                          debounced and the keys are numbered as in Table 2             shown in Table 9, from all disabled to all enabled.
                          and Figure 1. D6 indicates whether the present
                          debounced key is the last one in the FIFO, with 1                                                  Autorepeat Register
                          denoting that there are more keys after the present one,      The autorepeat register sets the autorepeat frequency
                          and 0 denoting that the present debounced key is the          (repeat rate) and its delay. The autorepeat function allows
                          last one stored in the FIFO. D7 is the overflow flag,         a key to be consecutively asserted when the key itself is
                          which denotes whether the keys FIFO has overflowed.           pressed down without being released. The autorepeat
                          Reading the key-scan FIFO clears the interrupt INT. INT       delay specifies the delay between the first press and the
                          is only reasserted after the FIFO has been emptied by         beginning of the autorepeating, provided that the key has
                          performing enough read operations.                            not been released. The autorepeat frequency specifies
                                                                                        how fast the continuously pressed-down key to be assert-
                                                                                        ed once autorepeating has started is. Bits D0 through D3
                                                                                        specify the autorepeat delay in terms of debounce cycles
                          14   ______________________________________________________________________________________


                        2-Wire Interfaced Low-EMI Key Switch
                                       and Sounder Controllers
ranging from 8 debounce cycles to 128 debounce cycles          sounder output has been enabled to be set by a key
                                                                                                                                MAX7347/MAX7348/MAX7349
(Table 10). Bits D4 through D6 specify the autorepeat          debounce event in the configuration register. When this
rate or frequency ranging from 4 to 32 debounce cycles.        happens, the information of bits D7 through D1 is passed
Bit D7 specifies whether the auto-repeat function is           on to the sounder register and the appropriate sound is
enabled with 0 denoting autorepeat disabled and 1              executed (Tables 14, 16). Least significant bit D0 is
denoting autorepeat enabled.                                   ignored and always set to 1 when transferred to the
                                                               sounder register. See Table 16 for the format of setting
                                       Interrupt Register      the frequency and duration of the sound to be executed.
The interrupt register contains information related to the     If a key-sound register command is sent as 000xxxx
settings of the interrupt request function, as well as the     (continuous), then the command is stored as 111xxxx
status of the INT output, which can also be configured         (1000ms) in the sounder register.
as a GPO. Bits D0 through D4 set the key-scan interrupt
frequency. By setting bits D0 through D4 to an appropri-                                             Alert Sound Register
ate value, the interrupt can be asserted at the end of the     The alert sound register specifies the duration and fre-
selected number of debounce cycles (Table 11). This            quency of the sound to be executed by the sounder con-
number ranges from 1 to 31 debounce cycles. If bits D0         troller at the falling edge of the alert input if the sounder
through D4 are set to 00000, the INT output is config-         output has been enabled to be set by the alert input in
ured as a GPO that is controlled by bit D6 in the ports        the configuration register. If this is the case, the informa-
register and the INT output is not asserted. However, the      tion of bits D7 through D1 is passed on to the sounder
INT status bits D5, D6, and D7 are still set and cleared in    register and the appropriate sound is executed (Tables
the normal way at the end of each debounce cycle as if         15, 16). Least significant bit D0 is always set to 1 and
bits D0 through D4 were set to 00001.                          this value is ignored when transferred to the sounder
Bits D5 and D6 denote whether an interrupt was set             register. See Table 16 for the proper format of setting the
due to a key-scan event (bit D5) or to an alert event (bit     frequency and duration of the sound to be executed.
D6). Bit D7 represents whether an interrupt request has        Note that if an alert sound register command is sent as
been asserted with 0 denoting no INT asserted and 1            000xxxx (continuous), then the command is actually
denoting that INT has been asserted.                           stored as 111xxxx (1000ms) in the sounder register.
The interrupt register is a read-only register and writes                                                Sounder Register
to it are ignored. Reading the interrupt register does         The sounder register stores the frequencies and duration
clear an alert event INT, but does not clear a key-scan        of the sounds to be executed by the sounder, as well as
event INT. An interrupt request caused by a key-scan           the state of its two-deep FIFO (Table 16). D0 denotes
event(s) is cleared when the FIFO is emptied.                  whether another command is lined in the queue at any
                                                               given moment. A 0 in D0 denotes that the queue is empty
                                Configuration Register         while a 1 denotes that there is another command. By writ-
The configuration register reflects the sounder status,        ing 0 to D0, the present command is executed and the
controls the I2C bus timeout feature, enables the alert        queue is cleared. When sending a command that has a
input interrupt feature, enables the sounder to respond        D0 set to 1, the queue is checked and, if empty, the sent
to both alert input and key debounce events, and con-          command is added to it while, if full, the sent command
trols the shutdown of the device (Table 12).                   replaces the queued command.
                                            Ports Register     Bits D0 and D1, when taken in conjunction, set the level
The ports register sets the values of ports 2 through 7 and    of the sounder output when configured as a GPO and
the INT port when configured as GPOs. The settings in          also control the autoloop function provided that the rest of
this register are ignored for ports not configured as          the bits (D7 through D2) are set to 0. When the sounder is
GPOs, and a read from this register returns the values         configured as a GPO, the levels of the output are set by
stored in the register and not the actual port conditions      D1, a 0 denoting a low and a 1 denoting a high. When D0
(Table 13). The ports register also serves to read the alert   is set to 1 and the rest of the bits are set to 0, D1 controls
input and this is done through bit D0 with a 0 denoting a      the autoloop function as defined in Table 16.
low on the alert input and a 1 denoting a high.                Bits D7 through D1 control the frequency and duration of
                                   Key-Sound Register          the sounds to be executed by the sounder. These sounds
The key-sound register specifies the duration and fre-         include the musical notes of the 5th octave plus some
quency of the sound to be executed by the sounder con-         notes from the 6th and 7th octaves as well. See Table 16.
troller when a key or a set of keys are debounced if the
                   ______________________________________________________________________________________                 15


                          2-Wire Interfaced Low-EMI Key Switch
                          and Sounder Controllers
MAX7347/MAX7348/MAX7349
                          Table 10. Autorepeat Register Format
                                                                                  ADDRESS                     REGISTER DATA
                                                   REGISTER                        CODE
                                                                                    (hex)     D7     D6   D5     D4    D3     D2   D1   D0
                                                                                                     AUTOREPEAT
                                        AUTOREPEAT REGISTER                        0x02     ENABLE                     AUTOREPEAT DELAY
                                                                                                        RATE
                          Autorepeat is disabled                                   0x02       0      X    X       X    X      X    X    X
                                                                                                     AUTOREPEAT
                          Autorepeat is enabled                                    0x02       1                        AUTOREPEAT DELAY
                                                                                                        RATE
                          Key-switch autorepeat delay is 8 debounce cycles         0x02       1      X    X       X    0      0    0    0
                          Key-switch autorepeat delay is 16 debounce cycles        0x02       1      X    X       X    0      0    0    1
                          Key-switch autorepeat delay is 24 debounce cycles        0x02       1      X    X       X    0      0    1    0
                          Key-switch autorepeat delay is 32 debounce cycles        0x02       1      X    X       X    0      0    1    1
                          Key-switch autorepeat delay is 40 debounce cycles        0x02       1      X    X       X    0      1    0    0
                          Key-switch autorepeat delay is 48 debounce cycles        0x02       1      X    X       X    0      1    0    1
                          Key-switch autorepeat delay is 56 debounce cycles        0x02       1      X    X       X    0      1    1    0
                          Key-switch autorepeat delay is 64 debounce cycles        0x02       1      X    X       X    0      1    1    1
                          Key-switch autorepeat delay is 72 debounce cycles        0x02       1      X    X       X    1      0    0    0
                          Key-switch autorepeat delay is 80 debounce cycles        0x02       1      X    X       X    1      0    0    1
                          Key-switch autorepeat delay is 88 debounce cycles        0x02       1      X    X       X    1      0    1    0
                          Key-switch autorepeat delay is 96 debounce cycles        0x02       1      X    X       X    1      0    1    1
                          Key-switch autorepeat delay is 104 debounce cycles       0x02       1      X    X       X    1      1    0    0
                          Key-switch autorepeat delay is 112 debounce cycles       0x02       1      X    X       X    1      1    0    1
                          Key-switch autorepeat delay is 120 debounce cycles       0x02       1      X    X       X    1      1    1    0
                          Key-switch autorepeat delay is 128 debounce cycles       0x02       1      X    X       X    1      1    1    1
                          Key-switch autorepeat frequency is 4 debounce cycles     0x02       1      0    0       0    X      X    X    X
                          Key-switch autorepeat frequency is 8 debounce cycles     0x02       1      0    0       1    X      X    X    X
                          Key-switch autorepeat frequency is 12 debounce cycles    0x02       1      0    1       0    X      X    X    X
                          Key-switch autorepeat frequency is 16 debounce cycles    0x02       1      0    1       1    X      X    X    X
                          Key-switch autorepeat frequency is 20 debounce cycles    0x02       1      1    0       0    X      X    X    X
                          Key-switch autorepeat frequency is 24 debounce cycles    0x02       1      1    0       1    X      X    X    X
                          Key-switch autorepeat frequency is 28 debounce cycles    0x02       1      1    1       0    X      X    X    X
                          Key switch autorepeat frequency is 32 debounce cycles    0x02       1      1    1       1    X      X    X    X
                          Power-up default setting                                 0x02       0      0    0       0    0      0    0    0
                          16   ______________________________________________________________________________________


                           2-Wire Interfaced Low-EMI Key Switch
                                          and Sounder Controllers
                                                                                                                                           MAX7347/MAX7348/MAX7349
Table 11. Interrupt Register Format
                                                   ADDRESS                                  REGISTER DATA
                  REGISTER
                                                   CODE (hex)
                                                                       D7          D6           D5        D4     D3    D2     D1     D0
                                                                                              KEY-
                                                                     INT         ALERT                      KEY-SCAN INTERRUPT
           INTERRUPT REGISTER                         0x03                                    SCAN
                                                                   STATUS*       EVENT*                         FREQUENCY
                                                                                             EVENT*
Current INT is due to key-scan event(s)               0x03              1           0            1          X      X      X     X     X
Current INT is due to alert event                     0x03              1           1            0          X      X      X     X     X
Current INT is due to both key-scan event(s)
                                                      0x03              1           1            1          X      X      X     X     X
and alert event
INT has not been asserted                             0x03              0           0            0          X      X      X     X     X
                                                                                               KEY-
                                                                                 ALERT
INT has been asserted                                 0x03              1                     SCAN          X      X      X     X     X
                                                                                 EVENT
                                                                                              EVENT
INT output pin is NOT asserted; INT output
pin is used as a general-purpose output
called INT port under control of bit D6 in
ports register; INT status bits D5, D6, D7 are        0x03             X            X            X          0      0      0     0     0
still set and cleared in the normal way at the
end of every debounce cycle as if bits D4–D0
were set to 00001
Key-scan INT is asserted at the end of every
                                                      0x03             X            X            X          0      0      0     0     1
debounce cycle, if new key(s) is debounced
Key-scan INT is asserted at the end of every
2 debounce cycles, if new key(s) is                   0x03             X            X            X          0      0      0     1     0
debounced
                      -—                                               —            —           —          —      —      —      —     —
Key-scan INT is asserted at the end of every
29 debounce cycles, if new key(s) is                  0x03             X            X            X          1      1      1     0     1
debounced
Key-scan INT is asserted at the end of every
30 debounce cycles, if new key(s) is                  0x03             X            X            X          1      1      1     1     0
debounced
Key-scan INT is asserted at the end of every
31 debounce cycles, if new key(s) is                  0x03             X            X            X          1      1      1     1     1
debounced
Power-up default setting                              0x03              0           0            0          0      0      0     0     0
*Read-only register bits; write data is ignored. Reading the interrupt register does clear an alert event INT, but does not clear a key-
scan event INT. INT caused by key-scan event(s) is cleared when FIFO is emptied.
                     ______________________________________________________________________________________                           17


                          2-Wire Interfaced Low-EMI Key Switch
                          and Sounder Controllers
MAX7347/MAX7348/MAX7349
                          Table 12. Configuration Register Format
                                                                   ADDRESS                           REGISTER DATA
                                        REGISTER
                                                                   CODE (hex)      D7        D6     D5     D4        D3   D2   D1   D0
                                                                                             KEY   ALERT  ALERT ALERT
                                                                                                                      SOUNDER TIMEOUT
                               CONFIGURATION REGISTER                0x04       SHUTDOWN   SOUND SOUND     INT   INT
                                                                                                                       STATUS ENABLE
                                                                                           ENABLE ENABLE ENABLE EVENT
                          Serial interface bus timeout enabled       0x04          X         X      X       X        X    X    X    0
                          Serial interface bus timeout disabled      0x04          X         X      X       X        X    X    X    1
                          No active sounder output                   0x04          X         X      X       X        X    0    0    X
                          Active sounder output set by serial
                                                                     0x04          X         X      X       X        X    0    1    X
                          interface
                          Active sounder output set by key
                                                                     0x04          X         X      X       X        X    1    0    X
                          debounce event
                          Active sounder output set by an alert
                                                                     0x04          X         X      X       X        X    1    1    X
                          event
                          Alert input interrupt (if enabled) is
                          asserted according to key-scan             0x04          X         X      X       X        0    X    X    X
                          interrupt rules
                          Alert input interrupt (if enabled) is
                                                                     0x04          X         X      X       X        1    X    X    X
                          asserted immediately
                          Alert input does not cause an
                                                                     0x04          X         X      X       0        X    X    X    X
                          interrupt
                          Falling edge of alert input causes
                                                                     0x04          X         X      X       1        X    X    X    X
                          interrupt
                          Alert input does not cause an
                                                                     0x04          X         X      0       X        X    X    X    X
                          automatic sound
                          Falling edge of alert input causes the
                          8-bit contents of the alert sound
                                                                     0x04          X         X      1       X        X    X    X    X
                          register 0x07 to be sent to the
                          sounder
                          Debounce key(s) do not cause an
                                                                     0x04          X         0      X       X        X    X    X    X
                          automatic sound
                          Debounced key(s), including
                          autorepeated keys, cause the 8-bit
                                                                     0x04          X         1      X       X        X    X    X    X
                          contents of the key-sound register
                          0x06 to be sent to the sounder
                          18    ______________________________________________________________________________________


                           2-Wire Interfaced Low-EMI Key Switch
                                          and Sounder Controllers
                                                                                                                                     MAX7347/MAX7348/MAX7349
Table 12. Configuration Register Format (continued)
                                        ADDRESS                                 REGISTER DATA
             REGISTER
                                        CODE (hex)      D7           D6        D5         D4        D3        D2    D1    D0
                                                                  KEY   ALERT  ALERT ALERT
                                                                                           SOUNDER TIMEOUT
   CONFIGURATION REGISTER                 0x04       SHUTDOWN   SOUND SOUND     INT   INT
                                                                                            STATUS ENABLE
                                                                ENABLE ENABLE ENABLE EVENT
Shutdown mode; key-scan and
sounder timing are disabled,
interrupts disabled, but alert input      0x04          0            X         X          X         X         X     X      X
can be read and port outputs (as
selected) can be changed
Operating mode; key scan is started,
and commands in sounder queue             0x04          1            X         X          X         X         X     X      X
are actioned
Power-up default setting                  0x04          0            0         0          0         0         0     0      1
Table 13. Ports Register Format
                             ADDRESS       READ                                     REGISTER DATA
       REGISTER
                             CODE (hex)    WRITE       D7       D6        D5         D4        D3        D2         D1     D0
                                                                                                                    INT   ALERT
                                            READ      PORT 7 PORT 6 PORT 5 PORT 4 PORT 3 PORT 2
                                                                                                                   PORT   INPUT
   PORTS REGISTER                0x05
                                                                                                                    INT
                                           WRITE      PORT 7 PORT 6 PORT 5 PORT 4 PORT 3 PORT 2                             X
                                                                                                                   PORT
Clear port 2 low                 0x05       Write       X       X         X           X        X         0          X       X
Set port 2 high (high
                                 0x05       Write       X       X         X           X        X         1          X       X
impedance)
Clear port 3 low                 0x05       Write       X       X         X           X        0         X          X       X
Set port 3 high (high
                                 0x05       Write       X       X         X           X        1         X          X       X
impedance)
Clear port 4 low                 0x05       Write       X       X         X           0        X         X          X       X
Set port 4 high (high
                                 0x05       Write       X       X         X           1        X         X          X       X
impedance)
Clear port 5 low                 0x05       Write       X       X         0           X        X         X          X       X
Set port 5 high (high
                                 0x05       Write       X       X         1           X        X         X          X       X
impedance)
Clear port 6 low                 0x05       Write       X       0         X           X        X         X          X       X
Set port 6 high (high
                                 0x05       Write       X       1         X           X        X         X          X       X
impedance)
                     ______________________________________________________________________________________                     19


                          2-Wire Interfaced Low-EMI Key Switch
                          and Sounder Controllers
MAX7347/MAX7348/MAX7349
                          Table 13. Ports Register Format (continued)
                                                       ADDRESS         READ                                       REGISTER DATA
                                 REGISTER
                                                       CODE (hex)      WRITE        D7       D6         D5         D4          D3        D2           D1         D0
                                                                                                                                                  INT           ALERT
                                                                       READ       PORT 7 PORT 6 PORT 5 PORT 4 PORT 3 PORT 2
                                                                                                                                                 PORT           INPUT
                               PORTS REGISTER             0x05
                                                                                                                                                  INT
                                                                       WRITE      PORT 7 PORT 6 PORT 5 PORT 4 PORT 3 PORT 2                                       X
                                                                                                                                                 PORT
                          Clear port 7 low                0x05          Write        0       X          X           X           X        X            X           X
                          Set port 7 high (high
                                                          0x05          Write        1       X          X           X           X        X            X           X
                          impedance)
                          Clear INT port low;
                          this setting is ignored
                          unless the key-scan INT
                          functionality is disabled       0x05          Write        X       X          X           X           X        X            0           X
                          by setting interrupt
                          register bits D4 to D0 to
                          00000
                          Set INT port high (high
                          impedance); this setting
                          is ignored unless the
                          key-scan INT
                                                          0x05          Write        X       X          X           X           X        X            1           X
                          functionality is disabled
                          by setting interrupt
                          register bits D4 to D0 to
                          00000
                          Alert input level is low        0x05          Read         X       X          X           X           X        X            X           0
                          Alert input level is high       0x05          Read         X       X          X           X           X        X            X           1
                          Power-up default
                                                          0x05           —           1       1          1           1           1        1            1           X
                          setting
                          Table 14. Key-Sound Register Format
                                                                                           ADDRESS                             REGISTER DATA
                                                      REGISTER
                                                                                           CODE (hex)        D7     D6     D5       D4   D3      D2        D1     D0
                          This-8 bit value is passed to sounder controller when key(s)
                          debounced, if enabled in the configuration register; these 7
                          bits define duration and frequency only; sounder command
                                                                                              0x06            7-bit value (see Table 16 for functionality)            1
                          bit D0 is ignored and fixed internally at 1; if a key sound is
                          sent as 000xxxxx (continuous), then the command is stored
                          as 111xxxxx (1000 ms)
                          Power-up default setting                                            0x06           0      1      0        1     0       0        0          1
                          20   ______________________________________________________________________________________


                          2-Wire Interfaced Low-EMI Key Switch
                                         and Sounder Controllers
                                                                                                                                                MAX7347/MAX7348/MAX7349
Table 15. Alert Sound Register Format
                                                                  ADDRESS                                  REGISTER DATA
                          REGISTER
                                                                  CODE (hex)        D7        D6       D5      D4   D3   D2      D1       D0
This 8-bit value is passed to sounder controller on the falling
edge of the alert input; these 7 bits define duration and
frequency only; sounder command bit D0 is ignored and
                                                                     0x07            7-bit value (see Table 16 for functionality)          1
fixed internally at 1; if an alert sound is sent as 000xxxxx
(continuous), then the command is stored as 111xxxxx
(1000 ms)
Power-up default setting                                             0x07           1         0        1       1    1      0     1         1
Table 16. Sounder Register Format
                                                                                                       REGISTER DATA
                           REGISTER                                READ
                                                                               D7        D6       D5    D4     D3   D2     D1         D0
                                                                   WRITE
                    SOUNDER REGISTER                                            DURATION                   FREQUENCY     LEVEL BUFFER
No commands are active; OR output is GPO logic 0                    Read       0         0         0       0    0   0      0          0
This current command is active, none are queued (so another
                                                                    Read        DURATION                   FREQUENCY     LEVEL        0
command may be sent)
This current command is active, and another command is in
                                                                    Read        DURATION                   FREQUENCY     LEVEL        1
the queue
Perform this command, terminating and clearing any previous
active command, command queue, and autoloop; new                    Write      X         X         X       X    X   X      X          0
command is now active, and queue is now empty
Add command to queue if not full; command replaces queued
                                                                    Write      X         X         X       X    X   X      X          1
command if queue is full
Configure sounder output as general-purpose output, logic 0
(clear queue; sounder output active low with continuous             Write      0         0         0       0    0   0      0          0
duration, ie, until a buffer = 0 command)
Configure sounder output as general-purpose output, logic 1
(clear queue; sounder output active high with continuous            Write      0         0         0       0    0   0      1          0
duration, ie, until a buffer = 0 command)
Autoloop using the current two commands; the active
command is command 1, and the inactive command is
command 2; if no command is active, the oldest command is           Write      0         0         0       0    0   0      0          1
reactivated as command 1, and the other command is re-
activated as command 2
Autoloop is halted at the end of command 2, and output idles
                                                                    Write      0         0         0       0    0   0      1          1
as defined by command 2
                     ______________________________________________________________________________________                                21


                          2-Wire Interfaced Low-EMI Key Switch
                          and Sounder Controllers
MAX7347/MAX7348/MAX7349
                          Table 16. Sounder Register Format (continued)
                                                                                                                        REGISTER DATA
                                                     REGISTER                                 READ
                                                                                                      D7    D6    D5    D4    D3    D2      D1         D0
                                                                                              WRITE
                                              SOUNDER REGISTER                                          DURATION         FREQUENCY        LEVEL BUFFER
                          Sounder output active low for sound duration;
                                                                                  —           Write                      0     0     0       0         0
                          queue cleared
                          Sounder output active high for sound duration;
                                                                                  —           Write                      0     0     0       1         0
                          queue cleared
                          Sound frequency is 523.25Hz, idles low               Note C5        Write                      0     0     1       0
                          Sound frequency is 587.33Hz, idles low               Note D5        Write                      0     0     1       1
                          Sound frequency is 659.26, idles low                 Note E5        Write                      0     1     0       0
                          Sound frequency is 698.46Hz, idles low               Note F5        Write                      0     1     0       1
                          Sound frequency is 783.99Hz, idles low               Note G5        Write     DURATION         0     1     1       0
                          Sound frequency is 880Hz, idles low                  Note A5        Write                      0     1     1       1
                          Sound frequency is 987.77Hz, idles low               Note B5        Write                      1     0     0       0     BUFFER
                          Sound frequency is 1046.5Hz, idles low               Note C6        Write                      1     0     0       1
                          Sound frequency is 1318.5Hz, idles low               Note E6        Write                      1     0     1       0
                          Sound frequency is 1568Hz, idles low                 Note G6        Write                      1     0     1       1
                          Sound frequency is 1760Hz, idles low                 Note A6        Write                      1     1     0       0
                          Sound frequency is 2093Hz, idles low                 Note C7        Write                      1     1     0       1
                          Sound frequency is 2349.3Hz, idles low               Note D7        Write                      1     1     1       0
                          Sound frequency is 2637Hz, idles low                 Note E7        Write                      1     1     1       1
                          Sound duration is continuous; if an alert sound or
                          a key sound is programmed as 000xxxxx
                                                                                      Write            0     0     0
                          (continuous), then the command is treated as
                          111xxxxx (1000 ms)
                          Sound duration is 15625ms*                                  Write            0     0     1
                          Sound duration is 3125ms*                                   Write            0     1     0
                                                                                                                         FREQUENCY        LEVEL BUFFER
                          Sound duration is 625ms*                                    Write            0     1     1
                          Sound duration is 125ms*                                    Write            1     0     0
                          Sound duration is 250ms*                                    Write            1     0     1
                          Sound duration is 500ms*                                    Write            1     1     0
                          Sound duration is 1000ms*                                   Write            1     1     1
                          Power-up default setting                                       —             0     0     0     0     0     0       0         0
                          *Sound duration will be slightly longer than these times because each sound always completes a full cycle before stopping.
                          22   ______________________________________________________________________________________


                         2-Wire Interfaced Low-EMI Key Switch
                                        and Sounder Controllers
                                  Sounder Operation                              Applications Information
                                                                                                                               MAX7347/MAX7348/MAX7349
When an alert sound or key sound is happening, the user
cannot write to the sounder. The MAX7347/MAX7348/                                            Ghost-Key Elimination
MAX7349 do not acknowledge a write to the sounder I2C            Ghost keys are a phenomenon inherent with key-switch
address. However, a read from the sounder will work cor-         matrices. When three switches located at the corners of
rectly. An alert sound or key sound event terminates a           a matrix rectangle are pressed simultaneously, the
current user-programmed event and clears the queue. If           switch that is located at the last corner of the rectangle
an alert sound or key sound event is currently being             (the ghost key) also appears to be pressed. This occurs
processed, then a new alert sound or key sound event             because the potentials at the two sides of the ghost-key
will be put into the queue, replacing an existing queued         switch are identical due to the other three connections—
alert sound or key sound event, if one exists. User access       the switch is electrically shorted by the combination of
to the sounder is restored when the last alert sound or key      the other three switches (Figure 10). Because the key
sound event is completed. Note this means that the buffer        appears to be pressed electrically, it is impossible for
bit (D0) for an alert sound or key sound command is              software to detect which of the four keys is the ghost key.
effectively ignored.                                             The MAX7347/MAX7348/MAX7349 employ a proprietary
                                                                 scheme that detects any three-key combination that
                                               Shutdown
                                                                 generates a fourth ghost key, and does not report any of
The MAX7347/MAX7348/MAX7349 are put into shut-
                                                                 these four keys as being pressed. This means that
down mode by clearing bit D7 in the configuration reg-
                                                                 although ghost keys are never reported, many combina-
ister (Table 12). In shutdown, the key-scan controller
                                                                 tions of three keys are effectively ignored when pressed
and sounder controller are both disabled, and the
                                                                 at the same time. Applications requiring three key com-
MAX7347/MAX7348/MAX7349 draw minimal current.
                                                                 binations (such as <Ctrl><Alt><Del>) must ensure that
No additional supply current is drawn if any keys are
                                                                 the 3 keys are not wired in positions that define the ver-
pressed. All switch matrix current sources are turned
                                                                 tices of a rectangle (Figure 11).
off, and row outputs ROW0 to ROW7 and column out-
puts COL0 to COL7 become high impedance.                                                           Low-EMI Operation
The alert input status may still be read in shutdown,            The MAX7347/MAX7348/MAX7349 use two techniques
and an alert event can still cause an interrupt request if       to minimize EMI radiating from the key-switch wiring.
this feature is enabled (Table 12). This means that alert        First, the voltage across the switch matrix never
can be used for µC wakeup while the system sleeps                exceeds 0.65V, irrespective of supply voltage V+. This
drawing minimum current.                                         reduces the voltage swing at any node when a switch
                                                                 is pressed to 0.65V maximum. Second, the keys are not
Outputs configured as GPOs (COL2/PORT2 to
                                                                 dynamically scanned, which would cause the key-
COL2/PORT7 and INT) may still be controlled in shut-
                                                                 switch wiring to continuously radiate interference.
down and their output states can be changed under
                                                                 Instead, the keys are monitored for current draw (only
software control at any time.
                                                                 occurs when pressed), and debounce circuitry only
The sounder output may not be changed in shutdown,               operates when one or more keys are actually pressed.
even if it is effectively being used as a logic output. Writes
to the sounder during shutdown are ignored, and the                                Power-Supply Considerations
sounder FIFO is cleared on entering shutdown. However,           The MAX7347/MAX7348/MAX7349 operate with a 2.4V
the sounder retains its output logic state for the duration      to 3.6V power-supply voltage. Bypass the power supply
of shutdown, and so can be set low or high as desired by         to GND with a 0.047µF or higher ceramic capacitor as
writing 0x00 or 0x02, respectively, to the sounder register      close to the device as possible.
(Table 12) before entering shutdown.
                                                                                             Switch On-Resistance
The MAX7347/MAX7348/MAX7349 may be taken out of                  The MAX7347/MAX7348/MAX7349 are designed to be
shutdown mode and put into operating mode by setting             insensitive to resistance either in the key switches or
bit D7 in the configuration register (Table 12). The key-        the switch routing to and from the appropriate COLx
scan and sounder controller FIFOs are cleared, and key           and ROWx up to 1kΩ. These controllers are therefore
monitoring starts. Note that rewriting the configuration         compatible with low-cost membrane and conductive
register with bit D7 high when bit D7 was already high           carbon switches.
does not clear the FIFOs; the FIFOs are only cleared
when the MAX7347/MAX7348/MAX7349 are actually
coming out of shutdown.
                    ______________________________________________________________________________________               23


                          2-Wire Interfaced Low-EMI Key Switch
                          and Sounder Controllers
MAX7347/MAX7348/MAX7349
                                                 REGULAR KEY-PRESS
                                                                                                                   EXAMPLES OF VALID THREE-KEY COMBINATIONS
                                                      EVENT
                                                                        GHOST-KEY
                                                                        EVENT
                                                                                                             KEY-SWITCH MATRIX                KEY-SWITCH MATRIX
                                               KEY-SWITCH MATRIX
                          Figure 10. Ghost-Key Phenomenon                                          Figure 11. Valid Three-Key Combinations
                                                                                                                 VCC
                                                                                                          50kΩ
                                                                                        BIAS                                                 OUT-
                                                                                        SHDN              50kΩ
                                                                                               SHUTDOWN                            10kΩ
                                                                                                                                                    16Ω
                                                                                         IN+                              10kΩ
                                                                                                                                             OUT+
                                                 0.22μF   2.61kΩ     21.5kΩ    32.4kΩ
                                     SOUNDER
                                      OUTPUT                                             IN-                                     MAX4366
                                                            68nF       22nF
                                                                                                                       220pF
                                                                                                          21.5kΩ
                          Figure 12. Third-Order Chebyshev Lowpass Filter and Output Stage
                                                                   Audio Transducers               The sounder output can also drive a power amplifier for
                          The sounder output is designed to drive a standard, low-                 higher sound levels. In this case, it is usually desirable
                          cost piezo transducer directly without further buffering.                to include a lowpass filter before the speaker to convert
                          Piezo transducers appear as a capacitive load of typical-                the square-wave tones to something closer to a sinu-
                          ly 10nF. If a resistive or inductive sounder is used, such               soid. The recommended cutoff frequency of this filter is
                          as a small loudspeaker, fit a coupling capacitor between                 around 3kHz. An example circuit is shown in Figure 12,
                          the sounder output and the transducer. For example, if a                 which uses the uncommitted op amp of the MAX4366
                          32Ω speaker is used, connect the positive side of a 22µF                 bridge power amplifier to implement a third-order
                          electrolytic capacitor to the sounder output, the negative               Chebyshev lowpass filter.
                          side of the capacitor to one end of the speaker, and the
                          other end of the speaker to GND.                                                                                 Chip Information
                                                                                                   PROCESS: BiCMOS
                          24   ______________________________________________________________________________________


                 2-Wire Interfaced Low-EMI Key Switch
                                and Sounder Controllers
                                                                         Typical Application Circuit
                                                                                                             MAX7347/MAX7348/MAX7349
                                                                              KEY 0   KEY 8    KEY 16
3.3V          3.3V            3.3V
                                     V+                     COL2/PORT2        KEY 1   KEY 9    KEY 17
                                                                 COL1
                                                  MAX7348
                                                                 COL0         KEY 2   KEY 10   KEY 18
                                     COL3/PORT3
                                                                 ROW0
                                     COL4/PORT4
                                                                 ROW1
                                                                              KEY 3   KEY 11   KEY 19
       5V                            AD0
                                                                 ROW2
                                                                 ROW3
       V+
                                                                              KEY 4   KEY 12   KEY 20
              SCL                    SCL                         ROW4
              SDA                    SDA                         ROW5
                                                                              KEY 5   KEY 13   KEY 21
               INT                   INT                         ROW6
                                     SOUNDER                     ROW7
       GND                                                                    KEY 6   KEY 14   KEY 22
                                                    GND
                     PIEZOELECTRIC                                            KEY 7   KEY 15   KEY 23
                      TRANSDUCER
             ______________________________________________________________________________________     25


                          2-Wire Interfaced Low-EMI Key Switch
                          and Sounder Controllers
                                                                                                                                                             Pin Configurations
MAX7347/MAX7348/MAX7349
                                 TOP VIEW
                                                       +
                                            ROW0 1                               16 V+
                                            ROW1 2                               15 INT
                                            ROW2 3                               14 SCL                        TOP VIEW                   +
                                                                                                                      COL7/PORT7 1                                                        24 ALERT
                                            ROW3 4             MAX7347           13 SDA
                                                                                                                             ROW0 2                                                       23 V+
                                            ROW4 5                               12 GND
                                                                                                                             ROW1 3                                                       22 INT
                                            ROW5 6                               11 COL0
                                                                                                                             ROW2 4                                                       21 SCL
                                            ROW6 7                               10 COL1
                                                                                                                             ROW3 5            MAX7349                                    20 SDA
                                            ROW7 8                               9       COL2/PORT2
                                                                                                                      COL3/PORT3 6                                                        19 AD0
                                                                QSOP                                                  COL4/PORT4 7                                                        18 GND
                                                                                                                             ROW4 8                                                       17 SOUNDER
                               TOP VIEW                                                                                      ROW5 9                                                       16 COL0
                                                       SCL       SDA     GND      COL0
                                                                                                                             ROW6 10                                                      15 COL1
                                                       12        11      10       9
                                                                                                                             ROW7 11                                                      14 COL2/PORT2
                                                                                                                      COL6/PORT6 12                                                       13 COL5/PORT5
                                          INT 13                                              8   COL1
                                                                                                                                                     QSOP
                                          V+ 14                                               7   COL2/PORT2
                                                                MAX7347
                                      ROW0 15                                                 6   ROW7
                                      ROW1 16                                   EP*           5   ROW6
                                                       +
                                                                                                                                                                                SOUNDER
                                                                                                                    TOP VIEW
                                                           1     2        3       4
                                                                                                                                      SCL     SDA     AD0           GND                     COL0
                                                       ROW2      ROW3    ROW4     ROW5                                               18       17      16           15           14         13
                                *EP = EXPOSED PADDLE           TQFN-EP                                                      INT 19                                                                 12 COL1
                                                                                                                            V+ 20                                                                  11 COL2/PORT2
                                                                                                                          ALERT 21                                                                 10 COL5/PORT5
                               TOP VIEW
                                                           +                                                                                         MAX7349
                                                                                                                   COL7/PORT7 22                                                                   9   COL6/PORT6
                                             ROW0 1                             20 V+
                                                                                                                          ROW0 23                                                                  8   ROW7
                                             ROW1 2                             19 INT
                                                                                                                                                                                      EP*
                                                                                                                          ROW1 24 +                                                                7   ROW6
                                             ROW2 3                             18 SCL
                                                                                                                                      1       2        3            4           5           6
                                             ROW3 4                             17 SDA
                                                                                                                                      ROW2    ROW3
                                                                                                                                                      COL3/PORT3   COL4/PORT4
                                      COL3/PORT3 5             MAX7348          16 AD0                                                                                          ROW4        ROW5
                                      COL4/PORT4 6                              15 GND
                                             ROW4 7                             14 SOUNDER
                                                                                                                                                   TQFN-EP
                                             ROW5 8                             13 COL0
                                                                                                                   *EP = EXPOSED PADDLE
                                             ROW6 9                             12 COL1
                                             ROW7 10                            11 COL2/PORT2
                                                                QSOP
                          26   ______________________________________________________________________________________


                          2-Wire Interfaced Low-EMI Key Switch
                                         and Sounder Controllers
                                                                                                Package Information
                                                                                                                                                              MAX7347/MAX7348/MAX7349
(The package drawing(s) in this data sheet may not reflect the most current specifications. For the latest package outline information,
go to www.maxim-ic.com/packages.)
                                                                                                                                                   QSOP.EPS
                                                                                           PACKAGE OUTLINE, QSOP .150", .025" LEAD PITCH
                                                                                                                                           1
                                                                                                               21-0055              F          1
                     ______________________________________________________________________________________                                        27


                          2-Wire Interfaced Low-EMI Key Switch
                          and Sounder Controllers
                                                                                                    Package Information (continued)
MAX7347/MAX7348/MAX7349
                          (The package drawing(s) in this data sheet may not reflect the most current specifications. For the latest package outline information,
                          go to www.maxim-ic.com/packages.)
                                                                                                                                                                          24L QFN THIN.EPS
                                                                                                                        PACKAGE OUTLINE,
                                                                                                                        12, 16, 20, 24, 28L THIN QFN, 4x4x0.8mm
                                                                                                                                                                  1
                                                                                                                                        21-0139               E       2
                          28   ______________________________________________________________________________________


                            2-Wire Interfaced Low-EMI Key Switch
                                           and Sounder Controllers
                                                                                 Package Information (continued)
                                                                                                                                                           MAX7347/MAX7348/MAX7349
(The package drawing(s) in this data sheet may not reflect the most current specifications. For the latest package outline information,
go to www.maxim-ic.com/packages.)
                                                                                                         PACKAGE OUTLINE,
                                                                                                         12, 16, 20, 24, 28L THIN QFN, 4x4x0.8mm
                                                                                                                                                   2
                                                                                                                         21-0139               E       2
                                     Revision History
Pages changed at Rev 5: 1, 2, 23, 29
Maxim cannot assume responsibility for use of any circuitry other than circuitry entirely embodied in a Maxim product. No circuit patent licenses are
implied. Maxim reserves the right to change the circuitry and specifications without notice at any time.
Maxim Integrated Products, 120 San Gabriel Drive, Sunnyvale, CA 94086 408-737-7600 ____________________ 29
© 2007 Maxim Integrated Products                                                is a registered trademark of Maxim Integrated Products, Inc.


Mouser Electronics
Authorized Distributor
Click to View Pricing, Inventory, Delivery & Lifecycle Information:
Maxim Integrated:
 MAX7347AEE+ MAX7347AEE+T MAX7347ATE+ MAX7347ATE+T MAX7348AEP+ MAX7348AEP+T
MAX7349AEG+ MAX7349AEG+T MAX7349ATG+ MAX7349ATG+T
