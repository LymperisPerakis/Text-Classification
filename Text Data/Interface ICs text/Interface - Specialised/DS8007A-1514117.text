Rev 0; 4/08
                          KIT
                   ATION
              EVALU    BLE
                AVA ILA
                       Multiprotocol Dual Smart Card Interface
                             General Description                                                                                                                                                                        Features
                                                                                                                                                                                                                                               DS8007A
The DS8007A multiprotocol dual smart card interface is                       ♦ Complete Interface/Control for Two Separate
an automotive grade, low-cost, dual smart card reader                          Smart Card Devices
interface supporting all ISO 7816, EMV™, and GSM11-                          ♦ 8kV (min) ESD Protection on Card Interfaces
11 requirements. Through its 8-bit parallel bus and dedi-
                                                                             ♦ Internal IC Card Supply Voltage Generation
cated address selects (AD3–AD0), the DS8007A can                                 5.0V ±5%, 65mA (max)
easily and directly connect to the nonmultiplexed byte-                          3.0V ±8%, 50mA (max)
wide bus of a Maxim secure microcontroller. Optionally,                          1.8V ±10%, 30mA (max)
the parallel bus can be multiplexed to allow direct
access to the multiplexed bus of an 80C51-compatible                         ♦ Automatic Card Activation, Deactivation, and Data
microcontroller through MOVX memory addressing.                                Communication Controlled by Dedicated Internal
                                                                               Sequencer
One integrated UART is multiplexed among the inter-
                                                                             ♦ Host Interface Through an 8-Bit Parallel Bus (User-
faces to allow high-speed automatic smart card pro-
                                                                               Selectable Multiplexed or Nonmultiplexed Modes)
cessing with each card-possessing, independent,
variable, baud-rate capability. The card interface is con-                   ♦ Chip Select and Three-State Bus Allow Multiple
trolled by internal sequencers that support automatic                          Devices (Card Readers and Memories) on Bus
activation and deactivation sequencing, handling all                         ♦ 8-Character Receive FIFO with Optional
actions required for T = 0, T = 1, and synchronous pro-                        Programmable Depth/Threshold
tocols. Emergency deactivation is also supported in                          ♦ I/O Interface Pin to External ISO 7816 UART
case of supply dropout. A third card is supported
through the auxiliary I/O. The same set of I/O can option-                   ♦ Separate Card Clock Generation (Up to 10MHz)
                                                                               with 2x Frequency Doubling
ally be used as additional serial interface for the UART.
                                                                             ♦ Selectable Card Clock Stop High, Stop Low, or
The DS8007A provides all electrical signals necessary                          Internally Generated 1.25MHz (for Card Power-Down)
to interface with two smart cards. The integrated volt-
age converter ensures full cross-compatibility between                       ♦ EMV-Certified Reference Design and Evaluation
1.8V/3V/5V cards and a 1.8V/3V/5V environment, and                             Kit Available (DS8007-KIT)
allows operation within a 2.7V to 6V supply voltage
range. The standard DS8007 revision is available for                                                                                                           Pin Configuration
nonautomotive applications.
                                                                                                   48 DELAY    47 XTAL1    46 XTAL2                                            41 INTAUX
                                             Applications
                                                                                                                                       45 AD0    44 AD1    43 AD2    42 AD3                 40 INT    39 ALE    38 CS    37 WR
        Banking Applications (Point-of-Sale Terminals,
        Debit/Credit Payment Terminals, PIN Pads,                                              +
                                                                                 RSTOUT 1                                                                                                                                        36 RD
        Automated Teller Machines)
                                                                                  I/OAUX 2                                                                                                                                       35 D7
        Telecommunications                                                           I/OA 3                                                                                                                                      34 D6
        Pay Television                                                               C8A 4                                                                                                                                       33 D5
                                                                                   PRESA 5                                                                                                                                       32 D4
        Access Control
                                                                                     C4A 6                                                                                                                                       31 D3
                                                                                                                                                 DS8007A
                                                                                   GNDA 7                                                                                                                                        30 D2
                           Ordering Information                                    CLKA 8                                                                                                                                        29 D1
                                           SMART                                    VCCA 9                                                                                                                                       28 D0
                                                   PIN-                             RSTA 10                                                                                                                                      27 VDD
      PART            TEMP RANGE           CARDS
                                                   PACKAGE                           I/OB 11                                                                                                                                     26 CPA2
                                         SUPPORTED
                                                                                     C8B 12                                                                                                                                      25 AGND
DS8007A-EAG+ -40°C to +125°C 2 + auxiliary 48 LQFP
                                                                                               13             14          15          16        17        18        19        20           21        22        23       24
+Denotes a lead(Pb)-free/RoHS-compliant device.                                                PRESB
                                                                                                  C4B
                                                                                                GNDB
                                                                                                CLKB
                                                                                                 VCCB
                                                                                                RSTB
                                                                                                 GND
                                                                                                  VUP
                                                                                                CPA1
                                                                                                CPB1
                                                                                                 VDDA
                                                                                                CPB2
                                                                                                                                                     LQFP
EMV is a trademark owned by EMVCo LLC.
                                                                              Typical Operating Circuit appears at end of data sheet.
Note: Some revisions of this device may incorporate deviations from published specifications known as errata. Multiple revisions of any device may be
simultaneously available through various sales channels. For information about device errata, go to: www.maxim-ic.com/errata.
                      ________________________________________________________________ Maxim Integrated Products                                                                                                                           1
For pricing, delivery, and ordering information, please contact Maxim Direct at 1-888-629-4642,
or visit Maxim’s website at www.maxim-ic.com.


          Multiprotocol Dual Smart Card Interface
          ABSOLUTE MAXIMUM RATINGS
DS8007A
          Voltage Range on VDD Relative to Ground ...........-0.5V to +6.5V                    Maximum Junction Temperature .....................................+150°C
          Voltage Range on VDDA Relative to Ground .........-0.5V to +6.5V                     Maximum Power Dissipation (TA = -25°C) .......................900mW
          Voltage Range on Any Pin Relative to Ground                                          Storage Temperature Range .............................-55°C to +150°C
           Pins CPA1, CPA2, CPB1, CPB2, and VUP .........-0.5V to +7.5V                        Soldering Temperature...........................Refer to the IPC/JEDEC
           All Other Pins...........................................-0.5V to (VDD + 0.5V)                                                     J-STD-020 Specification.
          Stresses beyond those listed under “Absolute Maximum Ratings” may cause permanent damage to the device. These are stress ratings only, and functional
          operation of the device at these or any other conditions beyond those indicated in the operational sections of the specifications is not implied. Exposure to
          absolute maximum rating conditions for extended periods may affect device reliability.
          ELECTRICAL CHARACTERISTICS
          (VDD = +3.3V, VDDA = +3.3V, TA = +25°C, unless otherwise noted.) (Note 1)
                       PARAMETER                        SYMBOL                              CONDITIONS                        MIN        TYP       MAX       UNITS
           Digital Supply Voltage                           VDD                                                                2.7                  6.0         V
           Step-Up Converter Supply
                                                           VDDA                                                               VDD                   6.0         V
           Voltage
           Power-Down             Cards Inactive                       f XTAL = 0MHz                                                                0.9
                                                            I PD                                                                                               mA
           VDD Current            Cards Active                         f XTAL = 0MHz, fCLK = 0MHz, VCCx = 5V                                        2.2
           Sleep Mode VDD Current
                                                           I STOP      fCLK = 0MHz, VCCx = 5V                                                       24         mA
           (Cards Active)
                                                                       3x VDD step-up:
           Active VDD Current
                                                            IDD        ICCA + ICCB = 80mA, VDD = 2.7V,                                              325        mA
           5V Cards
                                                                       f XTAL = 20MHz, fCLK = 10MHz
                                                                       2x VDD step-up:
                                                                       ICCA + ICCB = 80mA, f XTAL = 20MHz,                                          225
           Active VDD Current                                          fCLK = 10MHz, VDD = 2.7V
                                                            IDD                                                                                                mA
           3V Cards                                                    No step-up:
                                                                       ICCA + ICCB = 80mA, f XTAL = 20MHz,                                          120
                                                                       fCLK = 10MHz, VDD = 5V
                                                           VRST        Threshold voltage (falling)                             2.1                  2.5         V
           Power-Fail Reset Voltage
                                                           VHYS        Hysteresis                                              50                   170        mV
                                  Reset
                                                          VDRST                                                                          1.25
                                  Threshold
                                                                                                                                                                V
                                                                                                                                                  VDD +
                                  Output Voltage            VDO
                                                                                                                                                   0.3
           Delay Pin
                                                                       VDELAY = 0V                                                        -2                   μA
                                  Output Current            IDO
                                                                       VDELAY = VDD                                                       +2                   mA
                                  Output
                                                           CDO                                                                  1                              nF
                                  Capacitance
           RSTOUT PIN
                                                                                                                              0.8 x               VDD +
           Output High Voltage                          VOHRSTO        I OH = -1mA                                                                              V
                                                                                                                              VDD                  0.3
           Output Low Voltage                            VOLRSTO       I OL = 2mA                                             -0.3                 +0.4         V
           Leakage Current                                   IL        VOL = 0V, VOH = 5V                                      -10                 +10         μA
          2    _______________________________________________________________________________________


                      Multiprotocol Dual Smart Card Interface
ELECTRICAL CHARACTERISTICS (continued)
                                                                                                                     DS8007A
(VDD = +3.3V, VDDA = +3.3V, TA = +25°C, unless otherwise noted.) (Note 1)
          PARAMETER                 SYMBOL                        CONDITIONS       MIN     TYP    MAX    UNITS
Alarm Pulse Width                       tW        CDELAY = 22nF                             10            ms
                                                  External crystal                  4              20
External Clock Frequency              f XTAL                                                              MHz
                                                  External oscillator               0              20
Internal Oscillator                    f INT                                       1.6     2.5    3.7     MHz
                                                  3x step-up                               5.7
Voltage on VUP Pin                     VUP                                                                 V
                                                  2x step-up                               4.1
Voltage Detection of VDDA for 2x,
                                      VDET                                         3.25    3.50   3.60     V
3x Step-Up
Shutdown Temperature                   T SD                                                +150            °C
       Card       Output Low
                                     VOLRST       I OLRST = 1mA                     0             0.3      V
       Inactive   Voltage
       Mode       Output Current     I OLRST      VOLRST = 0V                       0              -1     mA
                  Output Low
                                    VOLRSTL       I OLRST = +200μA                  0             0.3
                  Voltage
                                                                                                           V
                  Output High                                                     VCCx –
RSTx                                VOHRSTH       I OHRST = -200μA                                VCCx
                  Voltage                                                          0.5
Pins Card
                  Rise Time           tRRST       CL = 30pF                                       0.1
     Active                                                                                                μs
     Mode         Fall Time           tFRST       CL = 30pF                                       0.1
                  Shutdown
                                     IRST(SD)                                              -25
                  Current
                                                                                                          mA
                  Current
                                    IRST(LIMIT)                                    -30            +30
                  Limitation
       Card       Output Low
                                     VOLCLK       I OLCLK = 1mA                     0             0.3      V
       Inactive   Voltage
       Mode       Output Current     I OLCLK      VOLCLK = 0V                       0              -1     mA
                  Output Low
                                     VOLCLK       I OLCLK = +200μA                  0             0.3
                  Voltage
                                                                                                           V
                  Output High                                                     VCCx –
CLKx Card                            VOHCLK       I OHCLK = -200μA                                VCCx
                  Voltage                                                          0.5
Pins Active
     Mode         Rise Time           tRCLK       CL = 30pF (Note 2)                               8
                                                                                                           ns
                  Fall Time           tFCLK       CL = 30pF (Note 2)                               8
                  Current
                                    ICLK(LIMIT)                                    -90            +90     mA
                  Limitation
                                                  Idle configuration (1MHz)         1             1.85
       Clock Frequency                 fCLK                                                               MHz
                                                  Operational                       0              10
       Duty Factor                               CL = 30pF                         45             55      %
                      _______________________________________________________________________________________    3


          Multiprotocol Dual Smart Card Interface
          ELECTRICAL CHARACTERISTICS (continued)
DS8007A
          (VDD = +3.3V, VDDA = +3.3V, TA = +25°C, unless otherwise noted.) (Note 1)
                       PARAMETER                  SYMBOL                         CONDITIONS               MIN         TYP    MAX    UNITS
                     Card       Output Low
                                                    VCCx        ICC = 1mA                                   0                0.3     V
                     Inactive   Voltage
                     Mode       Output Current       ICC        VCCx = 0V                                   0                 -1     mA
                                                                ICC(5V) < 65mA                            4.72        5.00   5.25
                                                                ICC(3V) < 50mA                            2.75        3.00   3.22
                                                                ICC(1.8V) < 30mA                          1.62        1.80   1.95
                                Output Low                      5V card, current pulses of 40nC with
                                                    VCCx                                                   4.6               5.4     V
                                Voltage                         I < 200mA, t < 400ns, f < 20MHz
                                                                3V card, current pulses of 24nC with
                                                                                                          2.75               3.25
          VCCx                                                  I < 200mA, t < 400ns, f < 20MHz
          Pins       Card                                       1.8V card, current pulses of 12nC with
                                                                                                          1.62               1.98
                     Active                                     I < 200mA, t < 400ns, f < 20MHz
                     Mode                                       VCCx(5V) = 0 to 5V                                           -65
                                Output Current       ICC        VCCx(3V) = 0 to 3V                                           -50
                                                                VCCx(1.8V) = 0 to 1.8V                                       -30
                                Total Current                                                                                        mA
                                                  ICC(A+B)                                                                   -80
                                (Two Cards)
                                Shutdown
                                                   ICC(SD)                                                            -100
                                Current
                                Slew Rate          VCCSR        Up/down, C < 300nF (Note 3)               0.05        0.16   0.5    V/μs
                                Output Low
                                                   VOLIO        I OLIO = 1mA                                0                0.3     V
                     Card       Voltage
                     Inactive   Output Current      I OLIO      VOLIO = 0V                                  0                 -1     mA
                     Mode       Internal Pullup
                                                  RPULLUP       To VCCx                                     9          14     19     k
                                Resistor
                                Output Low
                                                   VOLIO        I OLIO = 1mA                                0                0.3
                                Voltage
                                                                                                                                     V
                                Output High                     I OHIO  -20μA                           0.8 x VCCx          VCCx
                                                   VOHIO
                                Voltage                         I OHIO  -40μA (3V/5V)                   0.75 x VCCx         VCCx
                                Output
                                                     t OT       CL = 30pF                                                    0.1     μs
              I/Ox              Rise/Fall Time
              Pins              Input Low
                                                    VILIO                                                 -0.3               +0.8
                                Voltage
                     Card                                                                                                            V
                     Active     Input High
                                                    VIHIO                                                  1.5               VCC
                     Mode       Voltage
                                Input Low
                                                    I ILIO      VILIO = 0V                                                   700
                                Current
                                                                                                                                     μA
                                Input High
                                                    I IHIO      VIHIO = VCCx                                                  20
                                Current
                                Input Rise/Fall
                                                      t IT      CL = 30pF                                                    1.2     μs
                                Time
                                Current
                                                  I IO(LIMIT)                                              -25               +25     mA
                                Limitation
          4     _______________________________________________________________________________________


                      Multiprotocol Dual Smart Card Interface
ELECTRICAL CHARACTERISTICS (continued)
                                                                                                                             DS8007A
(VDD = +3.3V, VDDA = +3.3V, TA = +25°C, unless otherwise noted.) (Note 1)
          PARAMETER                   SYMBOL                       CONDITIONS      MIN        TYP       MAX      UNITS
                    Output Low
                                      VOLC48     I OLC48 = 1mA                      0                    0.3      V
        Card        Voltage
        Inactive    Output Current     I OLC48   VOLC48 = 0V                        0                    -1       mA
        Mode
                    Internal Pullup
                                      RPULLUP    Between C4 or C8 and VCCx          6          10        14       k
                    Resistor
                    Output Low
                                      VOLC48     I OLC48 = 1mA                      0                   0.35
                    Voltage
                                                                                                                  V
                    Output High                  I OHC48  -20μA                 0.8 x VCCx             VCCx
                                      VOHC48
                    Voltage                      I OHC48  -40μA (3V/5V)         0.75 x VCCx            VCCx
                    Output
                                        t OT     CL = 30pF                                               0.1      μs
                    Rise/Fall Time
 C4x,               Input Low
                                       VILC48                                      -0.3                 +0.8
 C8x                Voltage
 Pins                                                                                                             V
                    Input High
        Card                           VIHC48                                      1.5                  VCCx
                    Voltage
        Active
        Mode        Input Low
                                       I ILC48   VILIO = 0V                                             850
                    Current
                                                                                                                  μA
                    Input High
                                       I IHC48   VIHIO = VCCx                                            20
                    Current
                    Input Rise/Fall
                                         t IT    CL = 30pF                                               1.2      μs
                    Time
                    Pullup Pulse
                                       tWPU      Active pullup                                200                 ns
                    Width
                    Operating
                                       fMAX      On card contact pins                                    1       MHz
                    Frequency
TIMING
Activation Sequence Duration            tACT     See Figure 9                                           130       μs
Deactivation Sequence Duration          tDE      See Figure 9                                           150       μs
PRESA/PRESB PINS
Input Low Voltage                     VILPRES                                                       0.25 x VDD    V
Input High Voltage                    VIHPRES                                    0.7 x VDD                        V
Input Low Current                     I ILPRES   VILPRES = 0V                                            40       μA
Input High Current                    I IHPRES   VIHPRES = VDD                                           40       μA
I/OAUX PIN
Internal Pullup Resistor              RPULLUP    Between I/OAUX and VDD             9          14        19       k
Output Low Voltage                    VOLAUX     I OLAUX = 1mA                                           0.3      V
Output High Voltage                   VOHAUX     I OHAUX = 40μA (3V/5V)          0.75 x VDD             VDD       V
Output Rise/Fall Time                   t OT     CL = 30pF                                               0.1      μs
                      _______________________________________________________________________________________            5


          Multiprotocol Dual Smart Card Interface
          ELECTRICAL CHARACTERISTICS (continued)
DS8007A
          (VDD = +3.3V, VDDA = +3.3V, TA = +25°C, unless otherwise noted.) (Note 1)
                    PARAMETER                SYMBOL                     CONDITIONS                  MIN      TYP     MAX      UNITS
                                                                                                                     0.3 x
          Input Low Voltage                    VILAUX                                               -0.3                        V
                                                                                                                     VDD
                                                                                                    0.7 x
          Input High Voltage                   VIHAUX                                                                 VDD       V
                                                                                                    VDD
          Input Low Current                    I ILAUX   VILAUX = 0V                                                  700       μA
          Input High Current                   I IHAUX   VIHAUX = VDD                                -20              +20       μA
          Input Rise/Fall Time                   t IT    CL = 30pF                                                    1.2       μs
          INTERRUPT PIN
          Output Low Voltage                   VOLINT    I OH = 2mA                                                   0.3       V
          Input High Leakage Current           ILIHINT                                                                 10       μA
          D7 TO D0, ALL OTHER LOGIC PINS
                                                                                                                     0.2 x
          Output Low Voltage                   VOLD      I OLD = +5mA                                                           V
                                                                                                                     VDD
                                                                                                    0.8 x
          Output High Voltage                  VOHD      I OHD = -5mA                                                 VDD       V
                                                                                                    VDD
          Output Rise/Fall Time                 t OT     CL = 50pF                                                     25       ns
                                                                                                                     0.3 x
          Input Low Voltage                     VILD                                                                            V
                                                                                                                     VDD
                                                                                                    0.7 x
          Input High Voltage                    VIHD                                                                            V
                                                                                                    VDD
          Input Low Current                     I ILD                                                -20              +20       μA
          Input High Current                    I IHD                                                -20              +20       μA
          Load Capacitance                      CLD                                                                    10       pF
          Note 1: Operation guaranteed at -40°C but not tested.
          Note 2: Parameters are guaranteed to meet all ISO 7816, GSM11-11, and EMV 2000 requirements. For the 1.8V card, the maxi-
                  mum rise and fall time is 10ns.
          Note 3: Parameter is guaranteed to meet all ISO 7816, GSM11-11, and EMV 2000 requirements. For the 1.8V card, the minimum
                  slew rate is 0.05V/µs and the maximum slew rate is 0.5V/µs.
          6   _______________________________________________________________________________________


                     Multiprotocol Dual Smart Card Interface
AC ELECTRICAL SPECIFICATIONS—TIMING PARAMETERS FOR MULTIPLEXED
                                                                                                                                               DS8007A
PARALLEL BUS
(VDD = 3.3V, VDDA = 3.3V, TA = +25°C, unless otherwise noted.) (Figure 1)
          PARAMETER                   SYMBOL                                  CONDITIONS               MIN        TYP   MAX        UNITS
XTAL1 Cycle Time                      tCY(XTAL1)                                                        50                            ns
ALE Pulse Width                         tW(ALE)                                                         20                            ns
Address Valid to ALE Low                 tAVLL                                                          10                            ns
ALE Low to RD or WR Low                t(AL-RWL)                                                        10                            ns
                                                            Register URR                               2 x tCY(XTAL1)
RD Pulse Width                          tW(RD)                                                                                        ns
                                                            Other registers                             10
RD Low to Data Read Valid               t(RL-DV)                                                                        50            ns
WR/RD High to ALE High                t(RWH-AH)                                                         10                            ns
WR Pulse Width                          tW(WR)                                                          10                            ns
Data Write Valid to WR Low             t(DV-WL)                                                         10                            ns
                         tW(ALE)
    ALE
                             tAVLL                       t(AL-RWL)
    CS
                                                                 DATA                                         DATA
  D7–D0                              ADDRESS                                               ADDRESS
                                                                (READ)                                       (WRITE)
                                                                               t(RWH-AH)
                                     tW(RD)                                                 t(DV-WL)
     RD                                                                                                                       t(RWH-AH)
                                              t(RL-DV)                                                         tW(WR)
    WR
Figure 1. Multiplexed Parallel Bus Timing
                    _______________________________________________________________________________________                                7


          Multiprotocol Dual Smart Card Interface
          AC ELECTRICAL SPECIFICATIONS—TIMING PARAMETERS FOR NONMULTIPLEXED
DS8007A
          PARALLEL BUS (READ AND WRITE)
          (VDD = 3.3V, VDDA = 3.3V, TA = +25°C, unless otherwise noted.) (See Figure 2.)
                          PARAMETER                      SYMBOL                 CONDITIONS                   MIN   TYP   MAX       UNITS
          RD High to CS Low                                t1                                                10                      ns
          Access Time CS Low to Data Out Valid             t2                                                            50          ns
          CS High to Data Out High Impedance               t3                                                            10          ns
          Data Valid to End of Write                       t4                                                10                      ns
          Data Hold Time                                   t5                                                10                      ns
          RD Low to CS or WR Low                           t6                                                10                      ns
          Address Stable to CS or WR High                  t7                                                10                      ns
          Address to CS Low                                t8                                                10                      ns
                  READ
                    CS
                                              t1                  t2                                    t3
                WR (EN)
               RD (R/W)
                                                    t8
               AD3–AD0                                                        ADDRESS
                 D7–D0                                                       DATA OUT
                WRITE
                                                                                                                               WRITE
                    CS                                                                                                         RELEASE
                                                                                                                               WITH CS
                WR (EN)
                    CS
                                                                                                                               WRITE
                                                                                                                               RELEASE
                                                                                                                               WITH EN
                WR (EN)
                                               t6
               RD (R/W)
                                                                       t7
               AD3–AD0                                                      ADDRESS
                                                                                        t4             t5
                 D7–D0                                                                       DATA IN
          Figure 2. Nonmultiplexed Parallel Bus Timing (Read and Write)
          8   _______________________________________________________________________________________


                    Multiprotocol Dual Smart Card Interface
AC ELECTRICAL SPECIFICATIONS—TIMING PARAMETERS FOR CONSECUTIVE
                                                                                                                                       DS8007A
READ/WRITE TO URR/UTR/TOC
(VDD = 3.3V, VDDA = 3.3V, TA = +25°C, unless otherwise noted.)
            PARAMETER               SYMBOL                    CONDITIONS                     MIN       TYP      MAX       UNITS
SEE FIGURE 3
RD Pulse Width                        tW(RD)                                                  10                            ns
                                                                                           tW(RD) +           tW(RD) +
RD Low to Bit CRED = 1              tRD(URR)                                                                                ns
                                                                                           2tCY(CLK)          3tCY(CLK)
Set Time Bit FE                      t SB(FE)                                                10.5                          ETU
Set Time Bit RBF                     t SB(RBF)                                               10.5                          ETU
SEE FIGURE 4
WR/CS Pulse Width                    tW(WR)      (Note 4)                                     10                            ns
                                                                                           tW(WR) +           tW(WR) +
WR/CS Low to I/Ox Low               tWR(UTR)                                                                                ns
                                                                                           2tCY(CLK)          3tCY(CLK)
SEE FIGURE 5
WR/CS Pulse Width                    tW(WR)                                                   10                            ns
WR/CS High to Bit CRED = 1          tWR(TOC)     (Notes 4 and 5)                            1 / PSC            2 / PSC     ETU
Note 4: Depends on the leading edge of WR or CS (whichever is deasserted first). Reference this specification to the rising edge
        of CS/WR instead of the falling edge.
Note 5: PSC is the programmed prescaler value (31 or 32).
     I/Ox
                         tSB(FE)                   tSB(RBF)
  RBF BIT
   FE BIT
      INT
      RD                                                            tW(RD)
 CRED BIT                                                                     tRD(URR)
Figure 3. Timing Between Two Read Operations in Register URR
                    _______________________________________________________________________________________                        9


          Multiprotocol Dual Smart Card Interface
DS8007A
                  I/Ox
               TBE BIT
                  INT
               WR/CS                          tW(WR)
           CRED BIT                          tWR(UTR)
          Figure 4. Timing Between Two Write Operations in Register UTR
                WR/CS             tW(WR)
            CRED BIT                          tWR(TOC)
          Figure 5. Timing Between Two Write Operations in Register TOC
          10      ______________________________________________________________________________________


               Multiprotocol Dual Smart Card Interface
                                                                                                 Pin Description
                                                                                                                                   DS8007A
PIN   NAME                                                       FUNCTION
                Reset Output. This active-high output is provided for resetting external devices. The RSTOUT pin is driven
 1    RSTOUT    high until the DELAY pin reaches VDRST. Once the DELAY pin reaches VDRST, the RSTOUT pin is tri-stated
                so it can externally be pulled down. The SUPL bit is set for each RSTOUT pulse.
 2    I/OAUX    Auxiliary I/O. This I/O pin allows connection to an auxiliary smart card interface.
                Smart Card A I/O Data Line. This is the I/O data line associated with smart card A. This is also referred to
 3     I/OA
                as the ISO C7 contact.
                Smart Card A Auxiliary I/O. This is an auxiliary I/O associated with smart card A. This is also referred to
 4     C8A
                as the ISO C8 contact. This can be associated with synchronous cards.
 5    PRESA     Smart Card A Presence Contact. This is the active-high presence contact associated with smart card A.
                Smart Card A Auxiliary I/O. This is an auxiliary I/O associated with smart card A. This is also referred to
 6     C4A
                as the ISO C4 contact. This can be associated with synchronous cards.
 7    GNDA      Smart Card A Ground. This must be connected to GND.
                Smart Card A Clock Output. This is the clock output associated with smart card A. This is also referred to
 8    CLKA
                as the ISO C3 contact.
                Smart Card A Supply Voltage. This is the supply voltage output associated with smart card A. This is also
 9     VCCA
                referred to as the ISO C1 contact.
                Smart Card A Reset. This is the reset output associated with smart card A. This is also referred to as the
10     RSTA
                ISO C2 contact.
                Smart Card B I/O Data Line. This is the I/O data line associated with smart card B. This is also referred to
11     I/OB
                as the ISO C7 contact.
                Smart Card B Auxiliary I/O. This is an auxiliary I/O associated with smart card B. This is also referred to
12     C8B
                as the ISO C8 contact. This can be associated with synchronous cards.
13    PRESB     Smart Card B Presence Contact. This is the active-high presence contact associated with smart card B.
                Smart Card B Auxiliary I/O. This is an auxiliary I/O associated with smart card B. This is also referred to
14     C4B
                as the ISO C4 contact. This can be associated with synchronous cards.
15    GNDB      Smart Card B Ground. This must be connected to GND.
                Smart Card B Clock Output. This is the clock output associated with smart card B. This is also referred to
16    CLKB
                as the ISO C3 contact.
                Smart Card B Supply Voltage. This is the supply voltage output associated with smart card B. This is also
17     VCCB
                referred to as the ISO C1 contact.
                Smart Card B Reset. This is the reset output associated with smart card B. This is also referred to as the
18     RSTB
                ISO C2 contact.
19     GND      Ground
20     VUP      Step-Up Converter Connection. Connect a low-ESR capacitor of 220nF between this pin and ground.
               ______________________________________________________________________________________                         11


          Multiprotocol Dual Smart Card Interface
                                                                                               Pin Description (continued)
DS8007A
           PIN           NAME                                                       FUNCTION
               21        CPA1     Step-Up Converter Contact 1. Connect a low-ESR capacitor of 220nF between CPA1 and CPA2.
               22        CPB1     Step-Up Converter Contact 3. Connect a low-ESR capacitor of 220nF between CPB1 and CPB2.
                                  Analog Supply Voltage. Positive analog-supply voltage for the step-up converter; can be higher but not
               23        VDDA
                                  lower than VDD. This pin should be decoupled to AGND with a good quality capacitor.
               24        CPB2     Step-Up Converter Contact 4. Connect a low-ESR capacitor of 220nF between CPB1 and CPB2.
               25        AGND     Analog Ground
               26        CPA2     Step-Up Converter Contact 2. Connect a low-ESR capacitor of 220nF between CPA1 and CPA2.
               27         VDD     Digital Supply Voltage. This pin should be decoupled to GND with a good quality capacitor.
                                  8-Bit Digital I/O. This port functions as the data or address/data communication lines between the host
          28–35          D0–D7
                                  controller and the DS8007A for the nonmultiplexed and multiplexed operating modes, respectively.
                                  Active-Low Parallel Bus Read Strobe Input. In multiplexed mode, this input indicates when the host
               36         RD      processor is reading information from the DS8007A. In nonmultiplexed mode, this pin signals the current
                                  operation is a read (RD = 1) or a write (RD = 0) when CS and WR are low.
                                  Active-Low Parallel Bus Write Strobe Input. In multiplexed mode, this input indicates when the host
               37         WR      processor is writing information to the DS8007A. In nonmultiplexed mode, a low on this pin signals the
                                  bus is engaged in a read or write operation.
               38         CS      Active-Low Chip-Select Input. This input indicates when the DS8007A is active on the parallel bus.
                                  Address Latch Enable Input. This signal monitors the ALE signal when the host processor bus is
               39         ALE
                                  operating in multiplexed mode. Connect this signal to VDD when operating in nonmultiplexed mode.
               40         INT     Active-Low Interrupt. This output indicates an interrupt is active.
               41       INTAUX    Auxiliary Interrupt Input. This pin serves as an auxiliary interrupt.
                                  Register Selection Address Inputs. These pins function as the address input lines for the nonmultiplexed
          42–45        AD3–AD0
                                  configuration and should be connected to ground or VDD in the multiplexed configuration.
                                  Crystal Oscillators. Place a crystal with appropriate load capacitors between these pins if that is the
                        XTAL2,
          46, 47                  desired clock source. XTAL1 also acts as an input if there is an external clock source in place of a
                        XTAL1
                                  crystal.
                                  External Delay Capacitor Connection. Connect a capacitor from this pin to ground to set the power-on
               48        DELAY
                                  reset delay.
          12        ______________________________________________________________________________________


                    Multiprotocol Dual Smart Card Interface
                          Detailed Description                      no edge (activity) is detected on the ALE pin. Once a
                                                                                                                              DS8007A
                                                                    rising edge is detected on the ALE pin, the DS8007A is
The following describes the major functional features of
                                                                    placed into the multiplexed mode of operation. Once in
the device. Use of this document requires the reader
                                                                    the multiplexed mode of operation, a reset/power cycle
have a basic understanding of ISO 7816 terminology.
                                                                    or the deassertion of CS forces the device to the non-
                      Parallel Bus Interface                        multiplexed mode. Connecting the ALE pin to VDD or
                                                                    ground forces the device into nonmultiplexed parallel
The device interfaces to a host computer/processor
                                                                    bus mode. Figure 7 shows that the bus recognition dic-
through a multiplexed or demultiplexed, parallel, 8-bit
                                                                    tates whether the external address lines (AD3–AD0)
data bus (D0–D7). The parallel bus interface monitors
                                                                    can be used directly or whether the external data lines
the ALE signal and automatically detects whether a
                                                                    (D7–D0) must be latched according to the ALE input
multiplexed or nonmultiplexed external bus interface is
                                                                    signal. In the multiplexed mode of operation, a new
intended. The nonmultiplexed external bus interface is
                                                                    address is latched irrespective of the state of CS.
the default configuration and is maintained so long as
                                                              DS8007A
       GNDB                                                                                                     INT
         I/OB                                                                                                   CS
          C4B                                                                                                   INTAUX
          C8B
                                                                                                                I/OAUX
       PRESB
        RSTB                                                                ISO                                 AD0
        CLKB                                                               UART                                 AD1
         VCCB                             ANALOG                                                                AD2
        GNDA                             INTERFACE                                                              AD3
          I/OA                                                                                     DIGITAL      ALE
          C4A                                                                                    INTERFACE      RD
          C8A                                                                                                   WR
       PRESA                                                                                                    D0
        RSTA                                                                                                    D1
        CLKA                                                                                                    D2
         VCCA                                                                                                   D3
                                                                                                                D4
                                                                          TIMEOUT                               D5
      RSTOUT                                                              COUNTER                               D6
       DELAY                POWER-SUPPLY                                                                        D7
         VDD                 SUPERVISOR
         GND
       CPA1                                            CONTROL
       CPA2                                          SEQUENCERS
       CPB1
                               DC-DC                                                  CLOCK                     XTAL1
       CPB2
                             CONVERTER                                              GENERATION
        VDDA                                                                                                    XTAL2
       AGND
         VUP
Figure 6. Block Diagram
                   ______________________________________________________________________________________                13


          Multiprotocol Dual Smart Card Interface
DS8007A
                          CS
                          RD
                          WR
                                                                                                               REGISTERS
                                                          AD3–AD0                       0
                        D7–D0                                   LATCH
                                                                                       1
                                                                            D3–D0
                          ALE
                                               VDD
                           CS                                           CONTROL
                                             LOGIC        RST
                          RST                 OR
          Figure 7. Parallel Bus Interface
                                                     Multiplexed Mode                                             Nomultiplexed Mode
          In the multiplexed mode of operation, the D7–D0 sig-                      In the nonmultiplexed mode of operation, the address is
          nals are multiplexed between address and data. The                        always provided on the AD3–AD0 signals, and the data
          falling edge of the address latch enable (ALE) signal                     is always transacted on the D7–D0 signals. The RD input
          from the host microcontroller latches the address                         signal is used as a read/write (R/W) operation select. The
          (D3–D0), and the RD and WR strobe input signals are                       WR and CS input signals serve as active-low enables,
          used to enable a read or write operation, respectively, if                and must be asserted for the read or write operation to
          the DS8007A is selected (i.e., CS = 0). See the AC tim-                   take place. See the AC timing for the nonmultiplexed
          ing for the multiplexed parallel bus mode found earlier                   parallel bus mode found earlier in this data sheet.
          in this data sheet.
          14   ______________________________________________________________________________________


                    Multiprotocol Dual Smart Card Interface
                                Control Registers                     If the SC3–SC1 bits are configured so that card A is
                                                                                                                                   DS8007A
                                                                      selected, then all reads and writes to address 06h only
Special control registers that the host computer/micro-
                                                                      affect card A. If SC3–SC1 are changed to select card
controller accesses through the parallel bus manage
                                                                      B, then all reads and writes to address 06h only affect
most DS8007A features. Many of the registers,
                                                                      card B, etc.
although only mentioned once in the listing, are dupli-
cated for each card interface. The PDR, GTR, UCR1,                    In addition, some registers have different functions
UCR2, and CCR registers exist separately for each of                  based on whether the register is being read from or writ-
the three card interfaces. The PCR register is provided               ten to. An example of this are the UART Receive
only for card interface A and card interface B.                       (URR)/UART Transmit (UTR) registers located at address
                                                                      0Dh. Although they share the same address, during read
The specific register to be accessed is controlled by
                                                                      operations the receive register is read, and write opera-
the current setting of the SC3–SC1 bits in the Card
                                                                      tions go to a separate transmit register. This selection
Select Register. For example, there are three instances
                                                                      requires no extra configuration by the software.
of the UART Control Register 1 (UCR1) at address 06h.
Table 1. Special Function Register Map
ADDRESS REGISTER
                 R/W              BIT 7    BIT 6     BIT 5    BIT 4      BIT 3   BIT 2      BIT 1    BIT 0    RESET     RIU = 0*
  (HEX)   NAME
     00          CSR       R/W    CSR7     CSR6      CSR5     CSR4       RIU      SC3       SC2       SC1    0011 0000 0011 0uuu
     01          CCR       R/W      —        —       SHL       CST        SC      AC2       AC1       AC0    0000 0000 00uu uuuu
     02          PDR       R/W     PD7      PD6      PD5       PD4       PD3      PD2       PD1       PD0    0000 0000 uuuu uuuu
                                          DISTBE/
     03         UCR2       R/W      —             DISAUX     PDWN        SAN     AUTOC      CKU       PSC    0000 0000 uuuu uuuu
                                            RBF
     05          GTR       R/W    GTR.7    GTR.6    GTR.5     GTR.4     GTR.3    GTR.2      GTR.1    GTR.0 0000 0000 uuuu uuuu
     06         UCR1       R/W     FTE0      FIP      —       PROT        T/R     LCT        SS      CONV 0000 0000 0uuu 00uu
     07          PCR       R/W      —        —        C8       C4        1V8     RSTIN      3V/5V    START 0011 0000 0011 uuuu
     08          TOC       R/W    TOC7     TOC6      TOC5     TOC4       TOC3    TOC2       TOC1     TOC0 0000 0000 0000 0000
     09         TOR1        W     TOL7      TOL6     TOL5     TOL4       TOL3    TOL2       TOL1     TOL0 0000 0000 uuuu uuuu
     0A         TOR2        W     TOL15    TOL14    TOL13    TOL12      TOL11    TOL10      TOL9     TOL8 0000 0000 uuuu uuuu
     0B         TOR3        W     TOL23    TOL22    TOL21    TOL20      TOL19    TOL18     TOL17     TOL16 0000 0000 uuuu uuuu
                                                                                                     TBE/
     0C          MSR        R    CLKSW       FE      BGT      CRED       PRB      PRA      INTAUX            0101 0000 u1u1 uuu0
                                                                                                     RBF
     0C          FCR        W       —      PEC2      PEC1     PEC0       FTE1     FL2        FL1      FL0    0000 0000 0uuu 0uuu
     0D          URR        R      UR7      UR6      UR5      UR4        UR3      UR2       UR1       UR0    0000 0000 0000 0000
     0D          UTR        W      UT7      UT6      UT5       UT4       UT3      UT2       UT1       UT0    0000 0000 0000 0000
                                                                                                     TBE/
     0E          USR        R      TO3      TO2      TO1       EA         PE      OVR       FER              0000 0000 0000 0000
                                                                                                     RBF
     0F          HSR        R       —      PRTLB    PRTLA     SUPL       PRLB    PRLA      INTAUXL    PTL    0001 0000 0uuu xxxu
*u = unchanged, x = always reflects state of external device pin, even when RIU = 0.
Note: Writes to unimplemented bits have no effect. Reads of unimplemented bits return 0.
                    ______________________________________________________________________________________                    15


          Multiprotocol Dual Smart Card Interface
                                                                                                 Card Select Register (CSR)
DS8007A
                                7              6              5              4              3               2              1        0
          Address 00h        CSR7           CSR6            CSR5           CSR4            RIU            SC3            SC2       SC1
                              R-0             R-0            R-1            R-1           RW-0           RW-0            RW-0      RW-0
          R = unrestricted read, W = unrestricted write, -n = value after reset. This register is reset to 00110uuub on RIU = 0.
          Bits 7 to 4: Identification Bits (CSR7 to CSR4). These                  Bits 2 to 0: Select Card Bits (SC3 to SC1). These bits
          bits provide a method for software to identify the device               determine which IC card interface is active as shown
          as follows:                                                             below. Only one bit should be active at any time, and
             0011 = DS8007A revision Ax                                           no card is selected after reset (i.e., SC3–SC1 = 000b).
                                                                                  Other combinations are invalid.
          Bit 3: Reset ISO UART (RIU). When this bit is cleared
          (0), most of the ISO UART registers are reset to their                    000 = No card is selected.
          initial values. This bit must be cleared for at least 10ns                001 = Card A is selected.
          prior to initiating an activation sequence. This bit must                 010 = Card B is selected.
          be set (1) by software before any action on the UART
          can take place.                                                           100 = AUX card interface is selected.
                                                                                  Clock Configuration Register (CCR)
                                7              6              5              4              3               2              1        0
          Address 01h          —              —             SHL             CST             SC            AC2            AC1       AC0
                              R-0             R-0           RW-0           RW-0           RW-0            RW-0           RW-0      RW-0
          R = unrestricted read, W = unrestricted write, -n = value after reset. This register is reset to 00uuuuuub on RIU = 0.
          Bits 7 and 6: Reserved.                                                 I/Ox pin. In synchronous receive mode, the state of the
          Bit 5: Stop High or Low (SHL). This bit determines if                   I/Ox pin can be read from the LSb of the URR.
          the card clock stops in the low or high state when the                  Bits 2 to 0: Alternating Clock Select (AC2 to AC0).
          CST bit is active. It forces the clock to stop in a low                 These bits select the frequency of the clock provided to
          state when SHL = 0 or in a high state when SHL = 1.                     the active card interface and to the UART for the ele-
          Bit 4: Clock Stop (CST). For an asynchronous card,                      mentary time unit (ETU) generation as shown below. All
          this bit allows the clock to the selected card to be                    frequency changes are synchronous so that there are
          stopped. When this bit is set (1), the card clock is                    no spikes or unwanted pulse widths during transitions.
          stopped in the state determined by the SHL bit. When                    fINT is the frequency of the internal oscillator.
          this bit is cleared (0), the card clock operation is                      AC2–AC0
          defined by CCR bits AC2–AC0.                                              000 = fXTAL
          Bit 3: Synchronous Clock (SC). For a synchronous                          001 = fXTAL / 2
          card, the card clock is controlled by software manipu-
          lation of this SC, and the contact CLKx is the copy of                    010 = fXTAL / 4
          the value in this bit. In synchronous transmit mode, a                    011 = fXTAL / 8
          write to the UTR results in the least significant bit (LSb)               1xx = fINT / 2
          of the data written to the UTR being driven out on the
          16   ______________________________________________________________________________________


                      Multiprotocol Dual Smart Card Interface
                                                                  Programmable Divider Register (PDR)
                                                                                                                                     DS8007A
                      7              6              5               4              3               2         1            0
Address 02h         PD7            PD6             PD5            PD4             PD3            PD2       PD1           PD0
                   RW-0            RW-0           RW-0            RW-0           RW-0            RW-0      RW-0         RW-0
R = unrestricted read, W = unrestricted write, -n = value after reset; all bits unaffected by RIU = 0.
Bits 7 to 0: Programmable ETU Divider Register Bits                       • ETU = Prescaler output / (PD7–PD0), when
7 to 0 (PD7 to PD0). These bits, in conjunction with the                    PD7–PD0 = 02h–FFh
defined UART input clock (based upon CKU,                                 • ETU = Prescaler output / 1, when PD7–PD0 = 00h–01h
AC2–AC0) and the prescaler selection (PSC bit), are
used to define the ETU for the UART when interfaced to                    • Prescaler output / 256 is not supported
the associated card interface. The output of the
prescaler block is further divided according to the
PD7–PD0 bits as follows:
                                                                            UART Control Register 2 (UCR2)
                      7              6              5               4              3               2         1            0
Address 03h          —         DISTBE/RBF        DISAUX          PDWN             SAN          AUTOC       CKU           PSC
                     R-0           RW-0           RW-0            RW-0           RW-0           RW-0       RW-0         RW-0
R = unrestricted read, W = unrestricted write, -n = value after reset; all bits unaffected by RIU = 0.
Bit 7: Reserved.                                                         Bit 5: Disable Auxiliary Interrupt (DISAUX). This bit
Bit 6: Disable TBE/RBF Interrupt (DISTBE/RBF). This                      controls whether the external INTAUX pin can generate
bit controls whether the TBE/RBF flag can generate an                    an interrupt on the INT output pin. When this bit is
interrupt on the INT pin. When this bit is cleared to 0,                 cleared to 0, a change on the INTAUX input pin results
an interrupt is signaled on the INT pin in response to                   in assertion of the INT output pin. When DISAUX is set
the TBE/RBF flag getting set. When DISTBE/RBF is set                     to 1, a change on INTAUX does not result in assertion
to 1, interrupts are not generated in response to the                    of the INT output pin. The INTAUXL bit is set by a
TBE/RBF flag. Disabling the TBE/RBF interrupt can                        change on the INTAUX pin independent of the DISAUX
allow faster communication speed with the card, but                      bit state. Since the INTAUX bit is set independent of the
requires that a copy of TBE/RBF in register MSR be                       DISAUX bit, it is advisable to read HSR (thus clearing
polled to not lose priority interrupts that can occur in                 INTAUX) prior to clearing DISAUX to avoid an interrupt
register USR.                                                            on the INT pin. To avoid an interrupt when selecting a
                                                                         different card, the DISAUX bit should be set to 1 in all
                                                                         UCR2 registers.
                     ______________________________________________________________________________________                    17


          Multiprotocol Dual Smart Card Interface
          Bit 4: Power-Down Mode Enable (PDWN). This bit                           Bit 3: Synchronous/Asynchronous Card Select
DS8007A
          controls entry into the power-down mode. Power-down                      (SAN). This bit selects whether a synchronous or asyn-
          mode can only be entered if the SUPL bit has been                        chronous card interface is enabled. When this bit is
          cleared. When PDWN is set to 1, the XTAL1 and XTAL2                      cleared to 0, an asynchronous card interface is expect-
          crystal oscillator is stopped, and basic functions such                  ed. When this bit is set to 1, a synchronous interface is
          as the sequencers are supported by the internal ring                     expected. In synchronous mode, the UART is
          oscillator. The UART is put in a suspended state, and                    bypassed; the SC bit controls the CLK, and I/O is trans-
          the clocks to the UART, the ETU unit, and the timeout                    acted in the LSb of UTR/URR. Card interface AUX can-
          counter are gated off. During the power-down mode, it                    not operate in the true synchronous mode since it does
          is not possible to select a card other than the one cur-                 not have a CLK signal to accompany I/OAUX. However,
          rently selected (advisory to the programmer, selecting                   the SAN bit invokes the same control of I/OAUX through
          another card during power-down mode is not recom-                        UTR/URR as is given for card interfaces A and B.
          mended). There are five ways of exiting the power-                       Bit 2: Auto Convention Disable (AUTOC). This active-
          down mode:                                                               low bit controls whether the decoding convention
            • Insertion of card A or card B (detected by PRLA or                   should automatically be detected during the first
               PRLB).                                                              received character in answer-to-reset (ATR). If AUTOC
            • Withdrawal of card A or card B (detected by PRLA                     = 0, the character decoding convention is automatically
               or PRLB).                                                           detected (while SS = 1) and the UCR1.CONV bit is writ-
                                                                                   ten accordingly by hardware. If AUTOC = 1, the
            • Reassertion of the CS pin to select the DS8007A                      UCR1.CONV bit must be set by software to assign the
              (CS must be deasserted after setting PDWN = 1 for                    character decoding convention. The AUTOC bit must
              this event to exit from power-down).                                 not be changed during a card session.
            • INTAUXL bit is set due to change in INTAUX                           Bit 1: Clock UART Doubler Enable (CKU). This bit
              (INTAUXL bit must be cleared first).                                 enables the effective ETU defined for the UART to last
            • Clearing of PDWN bit by software (if CS pin is                       half the number of clock cycles defined by the
              always tied to 0).                                                   AC2–AC0 and PD7–PD0 configuration (except in the
          Except in the case of a read operation of register HSR,                  case when AC2–AC0 = 000b, where f CLK = f XTAL).
          the INT pin remains asserted in the active-low state.                    When CKU is cleared to 0, the AC2–AC0 defined fCLK
          The host device can read the status registers after the                  is used for ETU timing generation. When CKU is set to
          oscillator warmup time, and the INT signal returns to                    1, a clock frequency of 2 x fCLK is used for ETU gener-
          the high state.                                                          ation.
                                                                                   Bit 0: Prescaler Select (PSC). When PSC = 0, the
                                                                                   prescaler value is 31. When PSC = 1, the prescaler
                                                                                   value is 32.
                                                                                                 Guard Time Register (GTR)
                                7              6               5              4              3               2         1            0
          Address 05h        GTR.7           GTR.6          GTR.5           GTR.4          GTR.3          GTR.2     GTR.1         GTR.0
                              RW-0           RW-0            RW-0           RW-0           RW-0            RW-0      RW-0         RW-0
          R = unrestricted read, W = unrestricted write, -n = value after reset; all bits unaffected by RIU = 0.
          Bits 7 to 0: Guard Time Register Bits 7 to 0 (GTR.7                      transmitting, the DS8007A UART delays these numbers
          to GTR.0). These bits are used for storing the number                    of extra guard time ETU before transmitting a character
          of guard time units (ETU) requested during ATR. When                     written to UTR.
          18   ______________________________________________________________________________________


                     Multiprotocol Dual Smart Card Interface
                                                                            UART Control Register 1 (UCR1)
                                                                                                                                      DS8007A
                     7              6               5              4              3              2               1         0
Address 06h         FTE0           FIP             —             PROT            T/R            LCT             SS       CONV
                    R-0           RW-0             R-0           RW-0           RW-0           RW-0           RW-0       RW-0
R = unrestricted read, W = unrestricted write, -n = value after reset. This register is reset to 0uuu00uub on RIU = 0.
Bit 7: FIFO Threshold Enable 0 (FTE0). When this bit                    Bit 2: Last Character to Transmit (LCT). This bit is
and the FTE1 (FCR.3) bit are set, the programmable                      optionally set by software prior to writing the last char-
FIFO threshold feature is enabled. This bit always                      acter to be transmitted to the UART transmit register
reads 0 for compatibility.                                              (UTR). If LCT is set to 1 prior to writing to UTR, hard-
Bit 6: Force Inverse Parity (FIP). When this bit is con-                ware resets the LCT, T/R, and TBE/RBF bits following a
figured to 0, the correct parity is transmitted with each               successful transmission. Setting this bit to 1 allows
character, and receive characters are checked for the                   automatic change to the reception mode after the last
correct parity. When FIP = 1, an inverse parity bit is                  character is sent. This bit can be set during and before
transmitted with each character and correctly received                  the transmission. This bit cannot be written to when RIU
characters are NAK’d.                                                   = 0 (holding in reset).
Bit 5: Reserved. This bit must be left 0. Setting this bit              Bit 1: Software Convention Setting (SS). This bit
to 1 causes improper device operation.                                  should be set by software prior to ATR to allow automat-
                                                                        ic convention detection. Hardware automatically resets
Bit 4: Protocol Select (PROT). This bit is set to 1 by                  the SS bit at 10.5 ETU after the detection of the start bit
software to select the asynchronous T = 1 protocol and                  of the first character of the ATR.
is cleared to 0 to select the T = 0 protocol.
                                                                        Bit 0: Convention (CONV). This bit defines the charac-
Bit 3: Transmit/Receive (T/R). This bit should be set                   ter decoding convention of the ISO UART. If CONV = 1,
by software to operate the UART in transmit mode.                       the convention is direct. If CONV = 0, the convention is
When this bit is changed from 0 to 1 (UART changed                      inverted. If automatic convention detection is enabled
from receive to transmit mode), hardware sets the                       (AUTOC = 0), hardware detects the character conven-
USR.RBF/TBE bit, indicating an empty transmit buffer.                   tion and configures the CONV bit appropriately at 10.5
The T/R bit is automatically cleared to 0 following suc-                ETU. Otherwise (AUTOC = 1), software must configure
cessful transmission if UCR1.LCT is configured to 1                     the CONV bit.
prior to the transmission. This bit cannot be written to
when RIU = 0 (holding in reset).
                     ______________________________________________________________________________________                     19


          Multiprotocol Dual Smart Card Interface
                                                                                          Power Control Register (PCR)
DS8007A
                               7               6              5              4              3               2              1          0
          Address 07h          —              —              C8             C4             1V8           RSTIN          3V/5V      START
                              R-0             R-0           RW-1           RW-1           RW-0            RW-0           RW-0       RW-0
          R = unrestricted read, W = unrestricted write, -n = value after reset. This register is reset to 0011uuuub on RIU = 0.
          Note: The AUX card interface does not have register PCR. C4 and C8 are external ports that are internally pulled up (10kΩ to VCCx),
          writing a 1 to C4, C8 configures the weak pullup. Reads are made of the pin state to a different physical bit. Writing a 0 to C4, C8
          configures the pulldown. C4 and C8 bits can be written irrespective of the state of the T/R bit.
          Bits 7 and 6: Reserved.                                                 Bit 1: 3V/5V Card Select (3V/5V). This bit determines
          Bit 5: Contact 8 (C8). Writes to this register bit are out-             the VCCx level for the card interface. When this bit is set
          put on the C8 pin of the card interface. Reads of this                  to 1, VCCx is defined as 3V. When this bit is cleared to
          register bit reflect the value on the C8 pin.                           0, VCCx is defined as 5V. When the 1V8 and 3V/5V bits
                                                                                  are set to 1, priority is given to 1V8.
          Bit 4: Contact 4 (C4). Writes to this register bit are out-
          put on the C4 pin of the card interface. Reads of this                  Bit 0: Start (START). This bit controls software activa-
          register bit reflect the value on the C4 pin.                           tion/deactivation of the card interface. When this bit is
                                                                                  written to 1, the activation sequence for the selected
          Bit 3: 1.8V Card Select (1V8). If this bit is set to 1, the             card is performed. When this bit is written to 0, the
          VCCx supplied to the card interface is 1.8V. This bit                   deactivation sequence for the selected card is per-
          overrides the 3V/5V bit.                                                formed. Hardware automatically resets the START bit
          Bit 2: Reset Bit (RSTIN). When a card interface is acti-                for the associated card interface when emergency
          vated, the RSTx pin is driven according to the value                    deactivation occurs. This bit can be written regardless
          contained in this register bit.                                         of the state of the RIU bit.
                                                                           Timeout Configuration Register (TOC)
                               7               6              5              4              3               2              1          0
          Address 08h        TOC7           TOC6            TOC5           TOC4           TOC3           TOC2           TOC1        TOC0
                             RW-0            RW-0           RW-0           RW-0           RW-0            RW-0           RW-0       RW-0
          R = unrestricted read, W = unrestricted write, -n = value after reset. This register is reset to 00000000b on RIU = 0.
          Bits 7 to 0: Timeout Counter Configuration Register                     the Timeout Counter Operation section. These registers
          Bits (TOC7 to TOC0). These register bits determine                      can be written when RIU = 1 before activation and can-
          the counting configuration for the three timeout counter                not be written to when RIU = 0.
          registers. The available configurations are detailed in
          20   ______________________________________________________________________________________


                     Multiprotocol Dual Smart Card Interface
                                                                       Timeout Counter Register 1 (TOR1)
                                                                                                                                     DS8007A
                     7              6               5              4              3              2               1        0
Address 09h        TOL7           TOL6           TOL5            TOL4           TOL3           TOL2             TOL1    TOL0
                    W-0            W-0            W-0            W-0            W-0             W-0             W-0      W-0
R = unrestricted read, W = unrestricted write, -n = value after reset. This register is unchanged on RIU = 0.
Bits 7 to 0: Timeout Counter Register 1 Bits (TOL7 to                   counters. These counters are only used when a card is
TOL0). This register can be configured to operate as an                 supplied an active clock. See the Timeout Counter
8-bit counter or as the lowest 8 bits of a 24-bit counter.              Operation section for details on configurable modes.
TOR1, TOR2, and TOR3 are concatenated to form a 24-
bit ETU counter or a pair of independent 16- and 8-bit
                                                                       Timeout Counter Register 2 (TOR2)
                     7              6               5              4              3              2                1       0
Address 0Ah        TOL15          TOL14          TOL13          TOL12          TOL11          TOL10             TOL9    TOL8
                    W-0            W-0            W-0            W-0            W-0             W-0              W-0     W-0
R = unrestricted read, W = unrestricted write, -n = value after reset. This register is unchanged on RIU = 0.
Bits 7 to 0: Timeout Counter Register 2 Bits (TOL15                     bits of a 24-bit counter. See the Timeout Counter
to TOL8). This register can be configured to operate as                 Operation section for details on configurable modes.
the lower 8 bits of a 16-bit counter or as the middle 8
                                                                       Timeout Counter Register 3 (TOR3)
                     7              6               5              4              3              2                1       0
Address 0Bh        TOL23          TOL22          TOL21          TOL20          TOL19          TOL18             TOL17   TOL16
                    W-0            W-0            W-0            W-0            W-0             W-0              W-0     W-0
R = unrestricted read, W = unrestricted write, -n = value after reset. This register is unchanged on RIU = 0.
Bits 7 to 0: Timeout Counter Register 3 Bits (TOL23                     bits of a 24-bit counter. See the Timeout Counter
to TOL16). This register can be configured to operate                   Operation section for details on configurable modes.
as the high 8 bits of a 16-bit counter or as the high 8
                     ______________________________________________________________________________________                     21


          Multiprotocol Dual Smart Card Interface
                                                                                           Mixed Status Register (MSR)
DS8007A
                                7              6              5              4               3              2              1          0
          Address 0Ch       CLKSW             FE            BGT            CRED            PRB            PRA           INTAUX     TBE/RBF
                              R-0             R-1            R-0            R-1            R-0             R-0            R-0        R-0
          R = unrestricted read, W = unrestricted write, -n = value after reset. This register is reset to u1u1uuu0b on RIU = 0.
          Bit 7: Clock Switch (CLKSW). This status bit indicates                    • 1/PSC (min) ETU and 2/PSC (max) ETU after the
          the clock (fXTAL / n or fINT / 2) being sourced by the                       rising edge of WR (or CS) before writing to TOC
          selected card interface and thus may be used to deter-                  The CRED bit timing applies to asynchronous mode
          mine when a requested clock switch has occurred                         only; this bit is forced to 1 in synchronous mode.
          properly. When CLKSW is set 1, the clock has switched
          from fXTAL / n to fINT / 2; when CLKSW is cleared to 0,                 Bit 3: Presence Card B (PRB). This bit is set to 1 when
          the clock has switched from fINT / 2 to fXTAL / n.                      card B presence is detected and is cleared to 0 when
                                                                                  card B is not present.
          Bit 6: FIFO Empty Status Bit (FE). This bit is set to 1
          when the receive FIFO is empty. This bit is cleared to 0                Bit 2: Presence Card A (PRA). This bit is set to 1 when
          when at least one character remains in the receive FIFO.                card A presence is detected and is cleared to 0 when
                                                                                  card A is not present.
          Bit 5: Block Guard Time Status Bit (BGT). This status
          bit is linked to an ETU counter for the currently selected              Bit 1: INTAUX Bit (INTAUX). This bit reflects the state
          card interface, and is intended for use in verifying that               of the INTAUX pin. This bit is set when the INTAUX pin
          the block guard time is always being met. The counter                   is high and is cleared when the INTAUX pin is low.
          restarts on every start bit and stops only if the terminal              Bit 0: Transmit Buffer Empty/Receive Buffer Full
          count is reached. The terminal count is dependent                       (TBE/RBF). This bit signals special conditions relating
          upon the selected protocol (16 ETU for T = 0 and 22                     to the ISO UART and associated hardware. This bit is
          ETU for T = 1). This bit is cleared to 0 on every start bit.            not set when the last character is transmitted by the
          Bit 4: Control Ready (CRED). This bit signals the host                  UART when LCT = 1.
          device that the DS8007A is ready to handle the next                     This bit is set to 1 when:
          write operation to UTR or TOC or the next read opera-                     • UCR1.T/R is changed from 0 (receive mode) to 1
          tion of URR. When CRED = 0, the DS8007A is still work-                       (transmit mode).
          ing on the previous operation and cannot correctly
          process the new read/write request. When CRED = 1,                       • A character is transmitted by the UART.
          the DS8007A is ready for the next read/write request.                    • The receive FIFO becomes full.
          This “busy” bit allows the DS8007A to meet the timing                   This bit is cleared to 0 when:
          constraints of high-speed host devices. The CRED bit
          remains low:                                                             • The ISO UART is reset by RIU = 0.
            • 3 clock cycles after the rising edge of RD before                    • A character is written to the UART transmit register
              reading URR.                                                            (UTR) in transmit mode.
            • 3 clock cycles after the rising edge of WR (or CS)                   • A character is read from the receive FIFO in
              before writing to UTR.                                                  receive mode.
                                                                                   • UCR1.T/R is changed from 1 (transmit mode) to 0
                                                                                     (receive mode).
          22   ______________________________________________________________________________________


                     Multiprotocol Dual Smart Card Interface
                                                                                    FIFO Control Register (FCR)
                                                                                                                                        DS8007A
                      7              6              5              4               3              2              1          0
Address 0Ch          —             PEC2           PEC1           PEC0            FTE1            FL2            FL1        FL0
                    W-0             W-0            W-0            W-0            W-0             W-0            W-0        W-0
R = unrestricted read, W = unrestricted write, -n = value after reset. This register is reset to 0uuu0uuub on RIU = 0.
Bit 7: Reserved.                                                        if PEC2–PEC0 = 000b, only one parity error needs to be
Bits 6 to 4: Parity Error Count (PEC2 to PEC0). These                   detected for the PE bit to be set; if PEC2–PEC0 = 111b,
bits are used only for the T = 0 protocol to determine the              8 parity errors must be detected, etc. If a character is
number of retransmission attempts that can occur in                     correctly received before the allowed parity error count
transmit mode and the number of parity errors that can                  is reached, the parity counter is reset. For the T = 1
occur before the PE bit is set to 1 to indicate that the par-           protocol, the parity counter is not used. The PE bit is
ity error limit has been reached. In transmit mode, the                 set whenever a parity error is detected for a received
DS8007A attempts to retransmit a character up to                        character.
(PEC2–PEC0) times (when NAK’d by the card) before                       Bit 3: FIFO Threshold Enable 1 (FTE1). When this bit
the PE bit is set. Retransmission attempts are automati-                and the FTE0 (UCR1.7) bit are set, the programmable
cally made at 15 ETU from the previous start bit. If                    FIFO threshold feature is enabled. This bit always reads
PEC2–PEC0 = 000b, no retransmission attempt is made,                    0 for compatibility.
however, the host device can manually rewrite the char-                 Bits 2 to 0: FIFO Length (FL2 to FL0). These bits
acter to UTR (in which case, it is re-sent as early as 13.5             determine the depth of the receive FIFO. The receive
ETU from the previous start bit of the error character).                FIFO has depth equal to (FL2–FL0) + 1 (e.g., FIFO
In receive mode, if (PEC2–PEC0 + 1) parity errors have                  depth = 2 if FL2–FL0 = 001b).
been detected, the USR.PE bit is set to 1. For example,
                     UART Receive Register (URR)/UART Transmit Register (UTR)
                      7              6              5              4               3              2              1          0
Address 0Dh       UR7/UT7        UR6/UT6        UR5/UT5        UR4/UT4         UR3/UT3        UR2/UT2        UR1/UT1     UR0/UT0
                   RW-0            RW-0           RW-0           RW-0           RW-0            RW-0           RW-0       RW-0
R = unrestricted read, W = unrestricted write, -n = value after reset. This register is reset to 00000000b on RIU = 0.
Bits 7 to 0: UART Receive Register (Read                                (inverse convention encoding is handled by the hard-
Operations)/UART Transmit Register (Write                               ware). The UTR register cannot be loaded during trans-
Operations) (UR7/UT7 to UR0/UT0). This register is                      mission. The transmission:
used both as the UART transmit and receive buffer by the                 • Starts at the end of the write operation (rising edge
host microcontroller. Received characters are always                       of WR) if the previous character has been transmit-
read by the host microcontroller in direct convention,                     ted and the extra guard time has been satisfied.
meaning that if the CONV bit is 0, then characters
received using inverse convention are automatically                      • Starts at the end of the extra guard time if that
translated by the hardware. When the receive FIFO is                       guard time has not been satisfied.
enabled, reads of URR always access the oldest avail-                     • Does not start if the transmission of the previous
able received data. For the synchronous mode of opera-                       character is not completed (e.g., during retransmis-
tion, the LSb (URR.0) reflects the state of the selected                     sion attempts or if a transmit parity error occurs).
card I/Ox line.                                                         For the synchronous mode of operation, only the LSb
Writes by the host microcontroller to this register trans-              (UTR.0) of the loaded data is transferred to the I/Ox pin
mit characters to the selected card. The host microcon-                 for the selected card.
troller should write data to UTR in direct convention
                     ______________________________________________________________________________________                        23


          Multiprotocol Dual Smart Card Interface
                                                                                             UART Status Register (USR)
DS8007A
                                7              6              5               4              3              2              1               0
          Address 0Eh         TO3            TO2             TO1             EA             PE            OVR             FER           TBE/RBF
                              R-0             R-0            R-0            R-0             R-0            R-0            R-0             R-0
          R = unrestricted read, W = unrestricted write, -n = value after reset. All register bits are reset to 00000000b on RIU = 0.
          Note: If any of the bits TO3, TO2, TO1, EA, PE, OVR, or FER are set, then a USR read operation clears the bit, causing an interrupt
          less than 2µs after the rising edge of the RD strobe. PE and FER can be set by the same reception.
          Bits 7 to 5: Timeout Counter 3/2/1 Status (TO3 to                       the setting of the PE bit. When the PE bit is set, INT is
          TO1). These bits are set to 1 whenever their respective                 asserted. For protocol T = 0, characters received with
          timeout counter reaches its terminal count. Any of these                the incorrect parity are not stored in the receive FIFO.
          bits causes the INT pin to be asserted.                                 For protocol T = 1, received characters with parity
          Bit 4: Early Answer Detected (EA). This bit is set to 1                 errors are stored to the receive FIFO regardless of the
          if a start bit is detected on the I/O line during the ATR               parity bit. The PE bit is set at 10.5 ETU in reception
          between clock cycles 200–368 when the RSTx pin is                       mode and at 11.5 ETU in transmit mode for T = 0 and T
          low, and during the first 368 clock cycles after the RSTx               = 1 (PE bit is not applicable for transmit for T = 1).
          pin is high. When the EA bit becomes set, INT is assert-                Bit 2: Overrun FIFO (OVR). This status bit is set to 1 if
          ed. If the EA bit is set for a card during ATR, this bit is             the UART receives a new character when the receive
          cleared when switched to another card. During the                       FIFO is full. When a FIFO overrun condition occurs, the
          early answer detection period, a 46-clock-cycles sam-                   new character received is lost and the previous FIFO
          pling period should be used to detect the start bit;                    content remains undisturbed. When the OVR status bit
          there is an undetected period of 32 clock cycles at the                 is set, INT is asserted. The OVR bit is set at 10.5 ETU in
          end for both cases (between clock cycles 200–368                        receive mode for T = 0 and T = 1.
          when the RSTx pin is low, and the first 368 clock cycles                Bit 1: Framing Error (FER). This status bit is set to 1 if
          after the RSTx pin is high).                                            the I/O line is not in the high state at time = 10.25 ETU
          Bit 3: Parity Error (PE). This status bit indicates when                after the start bit. The FER bit is set to 10.5 ETU in
          the transmit or receive parity error count has been                     receive mode for T = 0 and T = 1.
          exceeded. For protocol T = 0, the PEC2–PEC0 bits                        Bit 0: Transmit Buffer Empty/Receive Buffer Full
          define the allowable number of transmit or receive pari-                (TBE/RBF). This is a duplicate of the same status bit
          ty errors. For protocol T = 1, any parity error results in              contained in the Mixed Status Register (MSR).
          24   ______________________________________________________________________________________


                      Multiprotocol Dual Smart Card Interface
                                                                              Hardware Status Register (HSR)
                                                                                                                                                 DS8007A
                      7               6              5               4              3               2              1               0
Address 0Fh          —             PRTLB          PRTLA           SUPL            PRLB            PRLA         INTAUXL            PTL
                     R-0             R-0            R-0             R-1            R-0             R-0            R-0             R-0
R = unrestricted read, W = unrestricted write, -n = value after reset, x = always reflects state of external device pin. This register is
reset to 0uuuxxxub on RIU = 0.
Note: A minimum of 2µs is needed between successive reads of the HSR to allow for hardware updates. In addition, a minimum of
2µs is needed between reads of the HSR and activation of card A, card B, or the AUX card.
Bit 7: Reserved.                                                          Bit 3: Presence Latch B (PRLB). This bit is set to 1
Bit 6: Protection Card Interface B Status Bit                             when a level change has been detected on the PRESB
(PRTLB). This bit is set to 1 when a fault has been                       pin of card interface B. The INT signal is asserted at
detected on card reader interface B. A fault is defined                   logic 0 (active) while this bit is set. This bit returns to 0
as detection of a short-circuit condition on either the                   after any HSR read.
RSTB or VCCB pin as given by DC specs IRST(SD) and                        Bit 2: Presence Latch A (PRLA). This bit is set to 1
ICC(SD). The INT signal is asserted at logic 0 (active)                   when a level change has been detected on the PRESA
while this bit is set. This bit returns to 0 after any HSR                pin of card interface A. The INT signal is asserted at
read, unless the condition persists.                                      logic 0 (active) while this bit is set. This bit returns to 0
Bit 5: Protection Card Interface A Status Bit                             after any HSR read.
(PRTLA). This bit is set to a 1 when a fault has been                     Bit 1: INTAUX Latch (INTAUXL). This bit is set to 1
detected on card reader interface A. A fault is defined                   when a 0 → 1 or a 1 → 0 level change has been detect-
as detection of a short-circuit condition on either the                   ed on the INTAUX pin. This bit remains set, regardless
RSTA or VCCA pin as given by DC specs IRST(SD) and                        of further level changes on the INTAUX pin until cleared
ICC(SD). The INT signal is asserted at logic 0 (active)                   to 0 by any HSR read.
while this bit is set. This bit returns to 0 after any HSR                Bit 0: Protection Thermal Latch (PTL). This bit is set
read, unless the condition persists.                                      to 1 when excessive heating (approximately +150°C or
Bit 4: Supervisor Latch (SUPL). This bit is set to 1                      greater) is detected. The INT signal is asserted at logic
when VDD < VRST or when a reset is caused by exter-                       0 (active) while this bit is set. This bit returns to 0 after
nally driving the DELAY pin < 1.25V. At this time the                     any HSR read, unless the condition persists.
INT signal is asserted at logic 0 (active). This bit returns
to 0 only after an HSR read outside the alarm pulse.
                     ______________________________________________________________________________________                                 25


          Multiprotocol Dual Smart Card Interface
           Card Interface Voltage Regulation
DS8007A
                                                                       Table 2. Step-Up Converter Operation
            and Step-Up Converter Operation
                                                                                           VOLTAGE (V)
          The VDD and VDDA pins supply power to the DS8007A.
                                                                             VDDA           SMART CARD             V UP
          Voltage supervisor circuitry detects the input voltage
          levels and automatically engages a step-up converter if            < 2.4                X                VDDA
          necessary to generate the appropriate voltages to the             2.4–3.5               5                 5.7
          card interfaces according to the control register set-            3.5–5.5               5                 5.7
          tings. The conversion process is transparent to the user
                                                                            5.5–6.0               5                VDDA
          and is usually only noticed by changes in the VUP pin
          voltage, which reflects the operation of the internal             2.4–3.5              3.0                4.1
          charge pump. Table 2 elaborates on the VUP pin.                    > 3.5               3.0               VDDA
          The VDD and VDDA pins must be decoupled externally,               2.4–6.0              1.8               VDDA
          but extra care must be taken to decouple large current
          spikes that can occur on the VDDA pins because of            low. The minimum duration of the RSTOUT pulse (tW
          noise generated by the cards and internal voltage step-      specification) is defined by the capacitor connected to
          up circuitry.                                                the DELAY pin and is typically 1ms per 2nF. The
                      Voltage Supply Supervision                       RSTOUT pin is driven strongly low once the DELAY pin
                                                                       exceeds the VDRST voltage threshold.
          The voltage supervisor circuitry monitors V DD and
          holds the device in reset until VDD is at a satisfactory     The SUPL bit is set on initial power-up and is reset
          level. The DELAY pin is an external indicator of the         again when the RSTOUT alarm pulse occurs. The SUPL
          state of internal power and can also be driven external-     bit may only be cleared by a read of the HSR register.
          ly to hold the device in a reset state. An external capac-   Figure 8 illustrates the sequencing of the various sig-
          itor is usually attached to this pin, defining the time      nals involved.
          constant of a power-on delay for the DS8007A. When           Short-circuit and thermal-protection circuitry prevent
          VDD is below the voltage threshold VRST, the charging        damages done by accidentally shorting the VCCx pins
          path that exists between VDD and DELAY is discon-            or when the ambient temperature is exceeding the
          nected and a strong pulldown is enabled on the DELAY         maximum operating temperature. When the internal
          pin. Once VDD exceeds VRST, the strong pulldown on           temperature is approximately +150°C, the voltage VCCx
          the DELAY pin is released and the pullup to VDD is           and the drivers to the CLKx, RSTx, I/Ox, C4x, and C8x
          enabled, allowing the external DELAY capacitor to be         signals to both card interfaces are turned off. The PTL
          charged.                                                     bit in the HSR is set and an interrupt is generated.
          The RSTOUT alarm pin is released (allowing it to be          When a short is detected on the RSTx pin, the device
          pulled up externally) whenever the DELAY pin voltage         initiates a normal deactivation sequence. A short on
          is less than VDRST, whether caused by VDD < VRST or          I/Ox, C4x, and C8x does not cause deactivation.
          as a result of external hardware pulling the DELAY pin
          26   ______________________________________________________________________________________


                        Multiprotocol Dual Smart Card Interface
                                                                                                                     DS8007A
                      VRST = 2.1V TO 2.5V
               VDD                                                        RESULTING FROM
                                                                          VDD < VRST
                                                                                           DELAY DRIVEN
                                                                                           LOW EXTERNALLY
                      VDRST = ~1.25V
             DELAY
                                                      tW
           RSTOUT
                INT
           SUPL BIT
                                                            SUPL BIT CLEARED BY HSR READ ONLY
Figure 8. Voltage Supervisor
                       ______________________________________________________________________________________   27


          Multiprotocol Dual Smart Card Interface
                                         Activation Sequencing                                           operating conditions (e.g., the card is present and the
DS8007A
                                                                                                         supply voltage is correct). These conditions can be
          An activation sequence can only be requested by a
                                                                                                         ascertained through the HSR, MSR, and CSR bits.
          host device through the parallel bus interface. The host
          can request an activation sequence for a specific card                                         If the microcontroller attempts to write the PCRx.START
          (card A or card B) by setting the START bit of the PCRx                                        bit to 1 without having satisfied the necessary condi-
          register (where x = A or B as determined by the card                                           tions, the card is not activated and the bit does not
          select SCx bits of the CSR). The host software can acti-                                       change. The activation time (from the assertion of the
          vate both cards at the same time, but only one card                                            START bit until the clock output is enabled) is less than
          can be selected to transmit/receive at a given time. The                                       130µs. The activation sequence is detailed in Figure 9.
          activation sequence can only occur given satisfactory
                                       ACTIVATION SEQUENCE                                                                                   DEACTIVATION SEQUENCE
                           1       2         3      4        5            6                                                       1   2        3          4     5           6
            START BIT                                             ACTIVATION NEEDS TO OCCUR IN UNDER 130μs
               RSTIN BIT
                   RSTx
                    VUP
                   VCCx
                                                                                       VCCx NEEDS TO DECREASE TO LESS THAN 0.4V
                   CLKx
                    I/0x                                UNDEFINED                      TS           T0
               C4x, C8x                                                               ACCORDING TO PCRx.C4, PCRx.C8 BITS
                 TIMING    t0      t1       t2     t3        t4           t5                                                  t10     t11     t12         t13   t14         t15
                                            tACT                                                                                                    tDE
            ACTIVATION SEQUENCE                                                                                 DEACTIVATION SEQUENCE
            1. PCRx.START BIT IS SET BY SOFTWARE.                                                               1. PCRx.START BIT IS CLEARED BY SOFTWARE.
               CONDITIONS NEEDED (IN HARDWARE) ARE:                                                             2. THE ACTIVE-LOW RSTx SIGNAL IS ASSERTED BY SOFTWARE.
                  MSR.PRx = 1 (CARD x PRESENT)                                                                  3. THE CLKx SIGNAL IS STOPPED.
                  HSR.PRTLx, SUPL, PRLx, PTL = 0                                                                4. I/Ox, C4x, AND C8x FALL TO 0V.
            2. STEP-UP CONVERTER ACTIVATED (MAY ALREADY BE ON IF ANOTHER CARD WAS ACTIVE).                      5. VCCx IS DISABLED AND FALLS TO 0V WITH A TYPICAL RATE OF 0.17V/μs.
            3. VCCx ENABLED TO 1.8V, 3V, OR 5V AS SELECTED BY PCRx.1V8 AND PCR.3V/5V BITS.                      6. STEP-UP CONVERTER IS DEACTIVATED IF NOT IN USE BY ANOTHER CARD AND
               VCCx RISES FROM 0V TO 1.8V, 3V, OR 5V WITH A CONTROLLED RISE TIME OF 0.17V/μs TYPICAL.              PINS CLKx, RSTx, I/Ox, AND VCCx BECOME LOW IMPEDANCE TO GROUND.
            4. I/Ox IS PULLED HIGH. C4x, C8x ARE ALSO PULLED HIGH IF PCRx.C4 = 1, PCRx.C8 = 1
               (RESPECTIVELY). THESE PINS HAVE INTEGRATED PULLUPS (14kΩ FOR I/Ox AND
               10kΩ FOR C4x AND C8x) TO VCCx.
            5. CLKx OUTPUT IS ENABLED AND RST OUTPUT IS ENABLED.
               (PCRx.RSTIN SHOULD BE "0" FOR ACTIVE-LOW RSTx.)
            6. PCRx.RSTIN WRITTEN TO "1" BY SOFTWARE AFTER USING TOC TO TIME SUFFICIENT
               DURATION OF RSTx PIN ASSERTION.
          Figure 9. Card Activation, Deactivation Sequences
          28      ______________________________________________________________________________________


                       Multiprotocol Dual Smart Card Interface
                   Deactivation Sequencing                  If the VCCx pin was shorted, the sequencer executes a
                                                                                                                       DS8007A
                                                            deactivation sequence in same way as if the START bit
The host device can request a deactivation sequence
                                                            was cleared to 0.
by resetting the START bit to 0 for the desired card
interface. The deactivation (from the deassertion of the                          Interrupt Generation
START bit, step 1 of the deactivation sequence, to
                                                            The INT output pin signals the host device that an event
VCCx decrease to less than 0.4V) is less than 150µs.
                                                            occurred that may require attention. The assertion of
                              Emergency Deactivation        the INT pin is a function of the following sources:
An emergency deactivation occurs if unsatisfactory            • A fault has been detected on card interfaces
operating conditions are detected. An emergency deac-            (A or B).
tivation occurs for all activated cards in response to a
                                                              • VDD has dropped below the acceptable level.
supply-voltage brownout condition (as reported by the
HSR.SUPL bit) or chip overheating (as reported by             • A reset is caused by externally driving the DELAY
HSR.PTL). Emergency deactivation of an individual card           pin to less than 1.25V.
can occur if a short-circuit condition is detected on the     • Excessive heating is detected (i.e., PTL = 1).
associated V CCx or RSTx pin (as reported by
                                                              • A level change has been detected on pin PRESx or
HSR.PRTLx) or in the case of a card takeoff (as reported
                                                                INTAUX for the card interfaces (A, B, or AUX).
by HSR.PRLx). When an emergency deactivation occurs,
hardware automatically forces the associated START            • The parity and/or frame error is detected.
bit(s) to the 0 state. The response of the device to the      • The early answer (EA) bit is set during ATR.
emergency deactivation varies according to the source.
                                                              • The timeout counter(s) reach their terminal
If the RSTx pin is shorted or the device overheats, the         count(s).
sequencer executes a fast emergency deactivation
                                                              • The FIFO full status is reached.
sequence, which ramps down VCCx immediately.
                                                              • The FIFO overrun occurs.
                                                              • The transmit buffer is empty.
                HSR.PRTLA
                 HSR.PRLA
                HSR.PRTLB
                 HSR.PRLB
                 HSR.SUPL
                  HSR.PTL
               HSR.INTAUXL
             UCR2A.DISAUX
             UCR2B.DISAUX
                                                                                            INTERRUPT
           UCR2AUX.DISAUX                                                                  GENERATION
                             SCA, SCB, SCAUX                                              INT OUTPUT PIN
                  USR.TO3
                  USR.TO2
                  USR.TO1
                   USR.EA
                   USR.PE
                  USR.OVR
                  USR.FER
               USR.TBE/RBF
          UCR2A.DISTBE/RBF
          UCR2B.DISTBE/RBF
        UCR2AUX.DISTBE/RBF
                             SCA, SCB, SCAUX
Figure 10. Interrupt Sources
                      ______________________________________________________________________________________     29


          Multiprotocol Dual Smart Card Interface
                        Timeout Counter Operation                           It is possible to stop and start the 16-bit software
DS8007A
                                                                            counter while leaving the 8-bit counter enabled (e.g.,
          The timeout counter assists the host device in timing
                                                                            TOC = 65h ↔ 05h, TOC = E5h ↔ 85h, etc.).
          real-time events associated with the communication pro-
          tocols: the Work Wait Time (WWT), Block Waiting Time              If a compatible software mode command is written to the
          (BWT), etc. The timeout counter registers count ETUs, so          TOC register before the terminal count is reached (e.g.,
          the input clock to the timeout counter is derived from the        write 61h to TOC register while the 65h TOC command is
          output of the programmable divided clock (per card PDR            running or vice versa), the new command is ignored (still
          register). The timeout counter requires the card be pow-          software mode), but the TOC register is updated with the
          ered and have an active clock.                                    new command, and the counter continues to count until
                                                                            the terminal count is reached, the respective timeout
          The timeout counter can operate as a single 24-bit
                                                                            flag(s) is set, and an interrupt is generated.
          counter (TOR3–TOR1) or as separate 16-bit
          (TOR3–TOR2) and 8-bit (TOR1) counters. The timeout                                                         Start-Bit Mode
          counters can be operated in either software mode or               When configured to start-bit mode, counting starts (and
          start bit mode. The software mode is supported for the            restarts for the 16-bit and 24-bit counters) when a
          16-bit and 24-bit counters. The start-bit mode is sup-            START bit is detected on the active card interface I/Ox
          ported for all counter widths (8 bit, 16 bit, and 24 bit).        pin. When the terminal count is reached, the 8-bit
          See Table 3.                                                      autoreload counter begins counting from the previously
                                                                            programmed start value, while a 16-bit counter or 24-bit
                                                  Software Mode             counter stops when terminal count is reached. If the
          In software mode, software configures the counter to a
                                                                            terminal count is reached, the timeout flag is set and an
          starting value (while stopped) and starts the down
                                                                            interrupt is generated. The 8-bit autoreload TOR1 regis-
          counter by writing the configuration value to the TOC
                                                                            ter cannot be modified during a count. The 16-bit and
          register. When the terminal count is reached (0h), the
                                                                            24-bit counter registers can be modified during a count
          counter stops, the timeout flag is set, and an interrupt is
                                                                            without affecting the current count. The new register
          generated. If the software counter does not reach the
                                                                            data is used on the next START bit detection.
          terminal count, it must be stopped before loading a
          new value into the associated TORx counter registers.
          Table 3. Timeout Counter Configurations
               TOC VALUE        TOR3      TOR2             TOR1                                    DESCRIPTION
                  00h                          Stopped                 All counters are stopped.
                                                           Start       Counters 3 and 2 are stopped. Counter 1 continues in start-
                  05h               Stopped
                                                      Bit/Autoreload   bit/autoreload mode for both transmission and reception.
                                                                       Counter 1 is stopped. Counters 3 and 2 form a 16-bit counter
                                                                       operating in software mode. The counter is stopped by writing 00h
                  61h               Software              Stopped
                                                                       to the TOC register, and must be stopped before reloading new
                                                                       values in TOR3 and TOR2 registers.
                                                                       Counters 3 and 2 form a 16-bit counter operating in software mode.
                                                                       Writing 05h to the TOC register before reloading new values in
                                                           Start       TOR2/TOR3 stops the counters. Counter 1 is operated in start-
                  65h               Software
                                                      Bit/Autoreload   bit/autoreload mode. The TOR1 register may not change during the
                                                                       count. The 16-bit counters are stopped by setting TOC = 05h. Both
                                                                       counters are stopped by setting TOC = 00h.
                                                                       Counters 1, 2, and 3 form a 24-bit counter operating in software
                                                                       mode. The counter starts after the command is written to the TOC
                  68h                          Software
                                                                       register, and is stopped by setting TOC = 00h. TOR3, TOR2, TOR1
                                                                       cannot be changed without stopping the counter first.
          30   ______________________________________________________________________________________


              Multiprotocol Dual Smart Card Interface
                                                                                                                                    DS8007A
Table 3. Timeout Counter Configurations (continued)
  TOC VALUE     TOR3        TOR2              TOR1                                   DESCRIPTION
                                                          Counter 1 is stopped. Counters 3 and 2 form a 16-bit counter
                                                          operating in start bit mode for both transmission and reception.
                                                          TOR3 and TOR2 registers can be changed during the count, the
     71h             Start Bit               Stopped
                                                          current count is not affected, and the values are taken into account
                                                          at the next START bit detected on the I/Ox pin. Setting TOC = 00h
                                                          stops the counters.
                                                          Counter 1 is an 8-bit counter in start-bit/autoreload mode for both
                                                          transmission and reception; counters 3 and 2 form a 16-bit counter
                                                          operating in start-bit mode for both transmission and reception. The
                                              Start       TOR1 register is not allowed to change during the count. TOR3,
     75h             Start Bit
                                         Bit/Autoreload   TOR2 registers can be changed during the count, the current count
                                                          is not affected, and the values are taken into account at the next
                                                          START bit detected on the I/Ox pin. Setting TOC = 00h stops the
                                                          counters.
                                                          Counters 1/2/3 form a 24-bit counter operating in start-bit mode in
                                                          both transmission and reception. TOR3, TOR2 and TOR1 registers
     7Ch                         Start Bit                can be changed during the count, the current count is not affected,
                                                          and the value is taken into account at the next START bit detected
                                                          on the I/Ox pin. Setting TOC = 00h stops the counter.
                                               Start
                                                          Counters 3 and 2 are stopped. Counter 1 is operated in start-
                                          Bit/Autostop
                                                          bit/autostop mode in reception and is stopped at the end of the
                                              (RCV);
     85h            Stopped                               12th ETU following the first received START bit detected on the
                                               Start
                                                          I/Ox pin unless the terminal count is reached first. Counter 1
                                         Bit/Autoreload
                                                          operates in start-bit/autoreload mode in transmission.
                                              (XMT)
                                                          Counters 3 and 2 form a 16-bit counter operating in software mode.
                                               Start
                                                          The counters are stopped by setting TOC = 05h before reloading
                                          Bit/Autostop
                                                          new values in TOR3 and TOR2 registers. Counter 1 is operated in
                                              (RCV);
     E5h            Software                              autostop mode in reception and is stopped at the end of the 12th
                                               Start
                                                          ETU following the first received START bit detected on the I/Ox pin
                                         Bit/Autoreload
                                                          unless the terminal count is reached first. Counter 1 is operated in
                                              (XMT)
                                                          start-bit/autoreload mode in transmission.
                                                          Counter 1 is stopped. Counters 3 and 2 form a 16-bit counter. The
                                                          16-bit counter is operated in start-bit/auto-stop mode in reception
                Start Bit/Autostop
                                                          and is stopped at the end of the 12th ETU following the first
     F1h              (RCV);                 Stopped
                                                          received START bit detected on the I/Ox pin unless the terminal
                  Start Bit (XMT)
                                                          count is reached first; and the 16-bit counter is operated in start-bit
                                                          mode in transmission.
                                                          Counter 1 is an 8-bit counter operating in start-bit/autostop mode in
                                                          reception and is stopped at the end of the 12th ETU following the
                                               Start      first received START bit detected on the I/Ox pin unless the
                                          Bit/Autostop    terminal count is reached first; and the 8-bit counter is operated in
                Start Bit/Autostop
                                              (RCV);      start-bit/autoreload mode in transmission. Counters 3 and 2 form a
     F5h              (RCV);
                                               Start      16-bit counter operating in start-bit mode for transmission but
                  Start Bit (XMT)
                                         Bit/Autoreload   operate in start-bit/autostop mode in reception. Counters 3 and 2
                                              (XMT)       are stopped at the end of the 12th ETU following the first received
                                                          START bit detected on the I/Ox pin unless the terminal count is
                                                          reached first; the counters are stopped by setting TOC = 00h.
              ______________________________________________________________________________________                           31


          Multiprotocol Dual Smart Card Interface
                        ISO UART Implementation                                                        Asynchronous Mode
DS8007A
                                                                         The asynchronous mode of operation is the reset
                                               Reset Operation           default mode for all card interfaces and is selected
          The CSR.RIU control bit resets the ISO UART. The               when the synchronous/asynchronous card select bit
          CSR.RIU must be reset prior to any activation. CSR.RIU         (for a given card interface) is configured to logic 0. The
          must be returned to 1 by software before any UART              I/Ox card interface signal is used for asynchronous
          action can take place.                                         half-duplex data communication between the host-con-
                                                                         trolled ISO UART and the external smart card. The host
                                           Synchronous Mode              device can optionally stop the CLKx signal in the high
          The synchronous mode of operation is invoked by set-           or low state while the card is active using the
          ting the synchronous/asynchronous card select bit (for         CCRx.CST and CCRx.SHL register bits.
          a given card interface) to logic 1. In the synchronous
          mode of operation, the associated I/Ox card interface                              ETU Generation and Timing
          data is transferred by the LSb of the UART                     The basic unit of time for asynchronous mode commu-
          transmit/receive registers (UTR and URR). In this mode,        nication on the I/Ox signal is the elementary time unit
          the host device using the CCRx.SC register bit manual-         (ETU). The ETU is defined within the ISO UART as a
          ly controls the CLKx pin for the selected card interface.      function of the fCLK frequency that is configured for the
          Switching to the synchronous mode or vice versa is             card interface (i.e., the same fCLK that can be sourced
          allowed at any time when the card is active. However, it       to the CLKx pin of an associated card interface A or B).
          is the responsibility of the host software/firmware to         In addition to receiving fCLK from the clock generation
          ensure that the current transmission is concluded              block, the ISO UART additionally receives a 2 x fCLK
          before switching. If software configures an active card        frequency if CCRx.AC2–AC0 ≠ 000b. The host device
          for synchronous mode, and then activates another               can select whether fCLK or 2 x fCLK is used for ETU
          card, the I/O pin on the previously active card goes to a      generation by using the clock UART (CKU) select bit.
          high-impedance state with a weak pullup (high). The            When CKU = 0, fCLK is used, while 2 x fCLK is used
          newly selected interface (if configured to synchronous         when CKU = 1. One exception exists when
          mode) takes on UTR.0.                                          CCRx.AC2–AC0 = 000b, in which case, only fCLK is
                                                                         sourced to the UART and the CKU bit setting has no
          The AUX card interface does not have an associated
                                                                         effect on the duration of an ETU.
          CLK signal, so the CCRAUX.SC bit does not control an
          output signal when the synchronous mode of operation           The basic clock that is selected for ETU generation by
          is in effect. The handshake between the host and the           the CKU bit is further prescaled by a factor or 31 or 32.
          auxiliary smart card interface is accomplished through         The prescaler select control (PSC) bit makes this
          the auxiliary interrupt input (INTAUX) and the INT pins.       prescaler selection. When PSC is configured to logic 0,
          The MSR.INTAUX bit reflects the state of the INTAUX pin.       the prescale setting is 31. When PSC is configured to
          If the UCR2.DISAUX bit is cleared to 0, a change on the        logic 1, the prescale setting is 32. The output of the
          INTAUX input pin results in the assertion of INT output        clock prescaler drives an 8-bit autoreload down
          pin. The host software/firmware establishes the commu-         counter. The autoreload value for the downcounter is
          nication protocol and controls when to transmit/receive        configured by the host device through the
          data in response to the interrupt. If the UCR2.DISAUX bit      Programmable Divider Register (PDR). The interval pro-
          is set to 1, the INT pin is not asserted, and the host soft-   vided by this downcounter defines the ETU duration for
          ware/firmware must examine the INTAUX bit in the MSR           the selected card. Figure 11 shows a diagram of ETU
          register and responds accordingly.                             generation. All the asynchronous character
                                                                         transmit/receive operations are defined in terms of ETU
                                                                         (e.g., 10.5 ETU, 10.25 ETU, etc).
          32   ______________________________________________________________________________________


                      Multiprotocol Dual Smart Card Interface
                                                                                                                                         DS8007A
                                   CLOCK                    PDR
                                 PRESCALER                            ETU
                                                                                  1                                     TO3, TO2,
                                 /31: PSC = 0            PD7:PD0 =
                                                                                                                        TO1
                                 /32: PSC = 1            00h TO FFh                            EN     TOC COUNTERS
                                                                                               CLK
                                                            CLR                   0
   fCLK
               0
                                 UCR2x.PSC
                                                                                 SOFTWARE
                                                                                   MODE
   2 x fCLK
               1
                                                      (ALIGNED
                                                   ETU GENERATOR)
                                                                      ETU
              UCR2x.CKU
                                   CLOCK                    PDR                                                         10.5 ETU
                                 PRESCALER                            0.5 ETU                                           TO 15 ETU
                                                                                               EN     FRACTIONAL ETU
                                 /31: PSC = 0            PD7:PD0 =                                      COUNTERS
                                 /32: PSC = 1            00h TO FFh   0.25 ETU                 CLK
                                                   CLR
                     RSTx
                                                GATE
                     START BIT                                                                                          10.25 ETU
                                                                                               EN      FRAME-ERROR-
                                                                                                     DETECTED COUNTER
                                                                                               CLK
Figure 11. ETU Generation
                          Standard Clock Frequencies                        ATR. The ISO 7816-1997(3) specification recommends
                                      and Baud Rates                        in Section 4.3.4 that CLKx frequency switches be
The DS8007A supports I/O communication and CLKx                             made a) immediately after ATR or b) immediately after
frequency generation compliant to the following stan-                       a successful PPS exchange. The transmission parame-
dards: ISO 7816, EMV2000, and GSM11-11. Each of                             ters F and D are respectively the clock-rate conversion
these standards has an allowable CLKx frequency                             and baud-rate adjustment factors. The notations Fd
range and a defined relationship between CLKx fre-                          and Dd are used to represent the ‘d’efault values for
quency and ETU (baud rate) generation that is support-                      these parameters, which are Fd = 372 and Dd = 1.
ed initially and after negotiation.                                         The notation Fi and Di are used to represent the values
For ISO 7816, the relationship between ETU (baud rate)                      ‘i’ndicated by the card within the TA(1) character of
timing and CLKx frequency is as follows:                                    ATR. If TA(1) is not present, then Fi, Di are set to the
                                                                            default Fd, Dd values. The notation Fn and Dn repre-
                 ETU = (F / D) x (1 / fCLKx)                                sent values ‘n’egotiated during a successful PPS
The minimum CLKx frequency is fixed at 1MHz. The                            exchange, which should be in the range Fd-Fi and Dd-
default maximum CLKx frequency is 5MHz, however,                            Di, respectively. During ATR, the default Fd, Dd values
the maximum CLKx frequency can be increased                                 shall apply. If the card comes up in negotiable mode
according to the Fi parameter given by the card during                      (i.e., TA(2) is absent from the ATR), then the Fd, Dd
                      ______________________________________________________________________________________                        33


          Multiprotocol Dual Smart Card Interface
          parameters continue to be used until a successful PPS          used. The TA(1) character of ATR, if present, contains
DS8007A
          exchange is completed. The negotiated Fn, Dn values            the Fi and Di values indicated by the card.
          are then used after a successful PPS exchange. If the          Table 5 demonstrates how the prescaler (PSC) bit and
          card comes up in specific mode (i.e., TA(2) is present         programmable divider register (PDRx) can be config-
          in ATR), then the indicated Fi, Di values apply immedi-        ured to generate the requested F/D ratios. All settings
          ately after successful ATR if bit 5 of the TA(2) charac-       assume that the CKU bit is configured to its reset
          ter is 0. If bit 5 of TA(2) is 1, implicit values should be    default logic 0 state.
          Table 4. Fi, Di Parameter Possibilities
                 TA(1).Fi                  Fi       MAX CLKx (MHz)              Fi =           TA(1).Di              Di
                  0000                     372              4                31 x 12            0000                RFU
                  0001                     372              5                31 x 12            0001                 1
                  0010                     558              6                31 x 18            0010                 2
                  0011                     744              8                31 x 24            0011                 4
                  0100                 1116                 12               31 x 36            0100                 8
                  0101                 1488                 16               31 x 48            0101                 16
                  0110                 1860                 20               31 x 60            0110                 32
                  0111                 RFU                  —                    —              0111                RFU
                  1000                 RFU                  —                    —              1000                RFU
                  1001                     512              5                32 x 16            1001                 12
                  1010                     768             7.5               32 x 24            1010                 20
                  1011                 1024                 10               32 x 32            1011                RFU
                  1100                 1536                 15               32 x 48            1100                RFU
                  1101                 2048                 20               32 x 64            1101                RFU
                  1110                 RFU                 RFU                   —              1110                RFU
                  1111                 RFU                 RFU                   —              1111                RFU
          RFU = Reserved for future use.
          Table 5. PSC, PDR Settings to Support F, D Parameters
                             PSC                                        PDR SETTING FOR Di =
            TA(1).Fi        0 = /31
                            1 = /32    0001       0010           0011     0100         0101      0110       1000          1001
               0000           0            12       6             3        —            —         —           1            —
               0001           0            12       6             3        —            —         —           1            —
               0010           0            18       9             —        —            —         —          —             —
               0011           0            24      12             6         3           —         —           2            —
               0100           0            36      18             9        —            —         —           3            —
               0101           0            48      24             12        6           3         —           4            —
               0110           0            60      30             15       —            —         —           5            3
               1001           1            16       8             4         2           1         —          —             —
               1010           1            24      12             6         3           —         —           2            —
               1011           1            32      16             8         4           2         1          —             —
               1100           1            48      24             12        6           3         —           4            —
               1101           1            64      32             16        8           4         2          —             —
          34    ______________________________________________________________________________________


                    Multiprotocol Dual Smart Card Interface
                               Character Encoding/
                                                                                                                                          DS8007A
                              Decoding Convention                                        TS CHARACTER
                                                                                  (CONVEYS CODING CONVENTION)
The ISO UART is designed to support two possible char-
acter encoding/decoding formats: direct and inverted.
The direct character coding convention transmits and                              DIRECT CONVENTION (BYTE = 3Bh)
receives data LSb first and associates a high logic level
with a bit 1 and a low logic level with a bit 0. The inverse                      1      1     0     1   1   1   0    0      1
character coding convention transmits and receives
data most significant bit first and associates a high logic                      LSb                                  MSb
level with a bit 0 and a low logic level with a bit 1.
The UCR1.CONV bit defines which character conven-                               INVERSE CONVENTION (BYTE = 3Fh)
tion (CONV = 0:inverse; CONV = 1:direct) should be
used by the ISO UART. The UCR1.CONV bit can be                                    0      0     1     1   1   1   1    1      0
configured by the host device software or be config-
ured by hardware if automatic convention detection has                           MSb                                   LSb
been enabled.
                                                               Figure 12. Direct, Inverse Character Coding Conventions
              Automatic Convention Detection
The automatic convention detection relies upon recog-
nition of a predefined pattern in the first character
received (TS character) in ATR for establishing future                                                               PDR.PD[7:0]
character coding convention. To enable automatic con-                                        ISO UART
                                                                                                                     GTR.GTR.[7:0]
vention detection, the UCR1.SS bit must be set to logic                         I/OA                                 UCR1
1 and the UCR2.AUTOC bit should be configured to                               I/OB                                  UCR2
logic 0 prior to ATR. The SS bit is automatically cleared                       I/OAUX                               CSR.RIU
by hardware 10.5 ETU after the character is received. If                        fCLKx                                MSR.FE
automatic convention detection is enabled and an                                2 x fCLKx                            MSR.BGT
unrecognized character is received, the CONV bit is                             START DETECT                         MSR.TBE/RBF
not written. If neither the direct nor inverse character                        ETU                                  USR.EA
are detected, a parity error occurs along with error sig-                                                            USR.PE
nal generation for the T = 0 protocol. The AUTOC bit                                                                 USR.OVR
should not be modified during a card session.                                                                        USR.FER
                          Framing Error Detection                                              URR
The DS8007A monitors the selected card I/Ox signal at                                                                FCR.PEC[2:0]
10.25 ETU following each detected start bit. If the I/Ox                                     FIFO(8)                 FCR.FL[2:0]
signal is not in the high state at this point in time, the
                                                                                               UTR
USR.FER (framing error) bit is set to 1 at 10.5 ETU. The
FER bit is cleared to 0 whenever USR is read.
                                                               Figure 13. ISO UART Signal Interface
                   ______________________________________________________________________________________                            35


          Multiprotocol Dual Smart Card Interface
                                                Block Guard Time                     retransmission is occurring), the character is translated
DS8007A
          The block guard time for the asynchronous serial com-                      according to the character coding convention (CONV
          munication between the smart card reader (DS8007A)                         bit) and moved from the transmit buffer to the serial
          and the ICC is defined as the minimum delay between                        shift register. The TBE/RBF bit returns high so that
          consecutive start bits sent in the opposite direction.                     another character can be loaded into the UTR register.
          The DS8007A implements an internal ETU counter
          specifically to help the host device assess that this min-                                                             Guard Time
          imum block guard time is being met. This internal ETU                      Some smart cards require extra time to handle informa-
          counter is loaded on each start bit with the value 22d or                  tion received from an interface device. To allow this
          16d, dependent upon the protocol selected. For T = 0,                      extra time, the DS8007A implements a Guard Time
          the counter is loaded with the value 16d and for T = 1,                    Register (GTR) per card interface. This register is pro-
          the counter is loaded with the value 22d. If the counter                   grammed with the number of extra ETU that should be
          reaches 0, the MSR.BGT status bit is set and the                           enforced between consecutive start bits transmitted by
          counter stops. If a start bit is detected before the                       the DS8007A (discounting retransmissions at the
          counter reaches 0, the counter is reloaded and the                         request of the ICC). The GTR register defaults to 00h
          BGT status bit is cleared to 0.                                            on reset, indicating that no extra guard time is required
                                                                                     (i.e., 12 ETU must be enforced between transmission of
                                                     Transmit Mode                   consecutive start bits). If the GTR register is pro-
          The ISO UART transmit mode is invoked by setting the                       grammed to FFh, the delay required between consecu-
          associated UCR1.T/R bit to logic 1. When the ISO                           tive start bits is dependent upon the protocol selected
          UART is placed into transmit mode, the TBE/RBF bit is                      (per UCR1.PROT).
          set to 1 to indicate that the transmit buffer is empty.                                            GTR = FFh
          When a character is written to UTR register, the
          TBE/RBF bit is cleared to indicate that the transmit                                              T = 0 protocol: 11.8 ETU
          buffer is no longer empty. If the transmit serial shift reg-                                      T = 1 protocol: 10.8 ETU
          ister is available (which is the case unless character
                                                              BLOCK GUARD TIME (BGT) COUNTER AND STATUS
                                   BGT COUNTER ≠ 0:
                                   - CLEAR BGT BIT
                                   - RESTART BGT COUNTER                       BGT COUNTER = 0 (STOPPED):
                                   (e.g., 16 ETU FOR T = 0)                           SET BGT BIT
            BGT BIT
               I/Ox
          Figure 14. Block Guard Time ETU Counter Operation
          36   ______________________________________________________________________________________


                     Multiprotocol Dual Smart Card Interface
                             Last Character to Transmit            (CRED) bit should be polled to assess data readiness
                                                                                                                                       DS8007A
The ISO UART implements a special control input that               when reading from register URR at high frequencies.
allows an automatic switch from transmit mode
(UCR1.T/R = 1) to receive mode (UCR1.T/R = 0) upon                                                            Parity Check
successful character transmission. The last character              The T = 1 protocol selection checks receive parity. For
to transmit (UCR1.LCT) bit must be set to 1 by host                T = 1, the parity error count bits (PEC2–PEC0) have no
software prior to writing the last character for transmis-         function and the USR.PE bit are set on the first parity
sion to UTR. Upon successful transmission of the char-             error.
acter, the UCR1.T/R bit and the LCT bit are cleared by             The T = 0 protocol selection also checks receive parity,
hardware. When the LCT bit is used, the TBE/RBF bit is             but allows setting of the USR.PE parity error bit to be
not set at the end of the transmission.                            based upon detection of 1–8 parity errors. The
                                                                   PEC2–PEC0 bits define the number of consecutive par-
                                          Receive Mode             ity errors that should be detected before setting
The ISO UART receive mode is in effect if the associat-            USR.PE.
ed UCR1.T/R bit is 0. When the ISO UART is changed
to receive mode, the MSR.FE bit is set to 1 to indicate            The ISO UART implements a special control input that
that the receive FIFO is empty. When at least one                  allows testing for inverse parity. If the UCR1.FIP bit is
unread receive character exists in the FIFO, the FE bit            configured to 0 during receive mode, the ISO UART
is cleared. When the FIFO, with depth defined by                   tests for correct parity on each received character. If
FL2–FL0, is full, the TBE/RBF bit is set to 1 to indicate          UCR1.FIP is configured to 1, inverse parity is expected.
that the receive buffer is full. Once a character is read          This control can be useful in testing that the ICC prop-
from a full FIFO, the RBF/TBE bit is cleared to indicate           erly detects error signals generated by the DS8007A
that the FIFO is no longer full. The controller ready              and retransmits requested characters.
                                                      LAST CHARACTER TO TRANSMIT
                                                                                                        TBE REMAINS 0, LCT AND
                                                           LCT BIT WRITTEN TO 1 BY                    T/R BITS ARE BOTH CLEARED
                                                          SOFTWARE, THEN LOAD UTR.                        TO 0 BY HARDWARE.
            I/O                LAST CHARACTER     P                                  LAST CHARACTER             P
    TBE/RBF BIT
        LCT BIT
        T/R BIT
Figure 15. Last Character to Transmit
                    ______________________________________________________________________________________                        37


          Multiprotocol Dual Smart Card Interface
                                        Error-Signal Generation                            received with incorrect parity, the USR.PE bit is set to
DS8007A
          The T = 1 protocol does not support error-signal gener-                          1. If the parity error counter has not reached terminal
          ation. When configured to receive using the T = 0 pro-                           count, it is reset to the originally programmed value
          tocol (UCR1.PROT = 0), the DS8007A supports error-                               upon reception of a character having the correct pari-
          signal generation in response to parity. The parity error                        ty. Once the USR.PE bit signals a parity count error,
          count bits (PEC2–PEC0) of the FIFO control register                              the software must re-establish any nonzero
          (FCR) determine the number of allowed repetitions in                             PEC2–PEC0 setting.
          reception, and therefore the number of times that an
          error signal is generated in response to a received                                                                          Receive FIFO
          character with incorrect parity before the USR.PE bit                            The DS8007A implements an enhanced receive FIFO. If
          becomes set.                                                                     the FIFO threshold-enable bits FTE0 and FTE1 are set
                                                                                           to 0, the FIFO functions as a standard FIFO that is con-
          When receiving a character, the DS8007A verifies                                 figurable to a depth of 1 to 8 characters. The T = 0 and
          even parity for the combination of the received 8-bit                            T = 1 protocols allow the FIFO depth to be determined
          character and parity bit. If incorrect parity is deter-                          by the FCR.FL2–FCR.FL0 bits. When configurable, the
          mined and consecutive parity error counter has not                               FIFO depth is equal to (FL2–FL0) + 1 (e.g., FL2–FL0 =
          reached terminal count (000b), the DS8007A gener-                                001b configures the FIFO depth to 2). The RBF/TBE
          ates an error signal on the I/Ox line starting at 10.5                           and FE status bits report the full and empty FIFO condi-
          ETU and lasting for 1.0 ETU. The parity error counter is                         tions, respectively. If the receive FIFO is full (at a maxi-
          initialized through the PEC2–PEC0 bits. Configuring                              mum depth of 8), the FIFO Overrun (OVR) bit is set to 1,
          the PEC2–PEC0 bits to 000b means that no repetition                              the new character received is lost, and the previous
          in reception is allowed and that an error signal genera-                         FIFO contents remain undisturbed.
          tion occurs in response to a character received with
          incorrect parity. Configuring PEC2–PEC0 bits to 001b                             The received characters are read from the URR. When
          means one repetition in reception is allowed and that                            the receive FIFO is enabled, reads of the URR always
          the DS8007A generates an error signal only once per                              access the oldest available received data. The FIFO is
          character receive attempt. When the consecutive pari-                            initialized every time the receive mode is invoked (i.e.,
          ty error counter reaches 000b and a character is                                 T/R bit is cleared to 0).
                                                       ERROR-SIGNAL GENERATION (T = 0 PROTOCOL ONLY)
                                                                                    IF (INCORRECT PARITY AND PEC ≠ 000b)           IF (CORRECT PARITY AND PE = 0)
                                                                                    HARDWARE ERROR SIGNAL IS GENERATED             RESET PARITY ERROR COUNTER TO
                                                                                    BETWEEN 10.5 ETU AND 11.5 ETU                  ORIGINAL PEC2–PEC0
                                                     PARITY BIT DOES NOT CHECK      AND DECREMENT PARITY COUNTER.                  PROGRAMMED VALUE.
                                             CHARACTER N                   P                                     CHARACTER N (RETRANSMIT)         P
               ETU TIME =>   0   1   2   3   4   5      6    7     8   9       10     11     12   13   14   15
          Figure 16. Receive Mode—Error Signal Generation
          38    ______________________________________________________________________________________


                   Multiprotocol Dual Smart Card Interface
For the T = 0 protocol, only received characters without
                                                                                                                             DS8007A
                                                              Table 6. Early Answer Detection
parity errors are stored in the receive FIFO. When
UCR1.FIP = 1 during T = 0 reception, only those char-               WHEN START BIT             EA BIT     CHARACTER
acters with incorrect parity are stored to the receive               IS ASSERTED              STATUS       RECEIVED
FIFO since the DS8007A is checking for inverse parity.         Between 0 and 200 clock
For the T = 1 protocol, the receive character is stored                                          0             No
                                                               cycles when RSTx = low
to the FIFO no matter whether the parity checks cor-
rectly or not.                                                 Between 200 and 368 clock
                                                                                                 1             Yes
                                                               cycles when RSTx = low
If the FIFO threshold enable bits FTE0 and FTE1 are set
to 1, the FIFO implements a programmable threshold             Between 368 and 400 clock
                                                                                                 0             Yes
for the assertion of the RBF/TBE bits and the interrupt        cycles when RSTx = low
line. In this mode, the internal FIFO length is forced to 8    Within the first 368 clock
bytes, and FL[2:0] (the programmable FIFO length bits)                                           1             Yes
                                                               cycles after RSTx = high
determines the threshold value.
                                                               Between 368 and 400 clock
Characters are accumulated in the FIFO without setting                                           0             Yes
                                                               cycles after RSTx = high
the RBF/TBE bits until the FIFO depth is greater than
the threshold value. As long as the used depth is
greater than the FL[2:0] value, the RBF/TBE bits (USR                                       Early Answer (EA)
and MSR) are set and the interrupt pin is asserted.           If a start bit is detected on the I/O line during the ATR
Reading the FIFO to a level less than or equal to the         between clock cycles 200–368 when the RSTx pin is
threshold value resets the RBF/TBE bit and deasserts          low and during the first 368 clock cycles after the RSTx
the interrupt line.                                           is high, it is recognized as an early answer (EA), and
Writing a zero or eight into the FL bits while the pro-       the EA bit is set in the USR.EA register. When the EA bit
grammable threshold mode is enabled causes the                is set, INT is asserted.
FIFO to behave as it does in nonprogrammable thresh-          During the early answer detection period, 46 clock
old mode.                                                     cycles sampling periods should be used to detect the
If the programmable FIFO depth is at its maximum (8           start bit and there is an undetected (uncertainty) period
characters), the RBF/TBE bit is set when the eighth           of 32 clock cycles at the end for both cases (between
character is received and written into the FIFO. If anoth-    clock cycles 200–368 when the RSTx pin is low, and
er character is received while the FIFO is full, the over-    the first 368 clock cycles after RSTx is high). Table 6
flow (OVR) status is set, and the new character               summarizes the status of the early answer bit. The
overwrites the previously received character.                 answer on the I/O line begins between 400 and 40,000
                                                              clock cycles after the rising edge of the RSTx signal.
If the programmable FIFO depth is set to zero, the
receipt of a single character sets RBF/TBE. Receiving                     Development and Technical
another character in this state sets the OVR bit and
overwrites the character.
                                                                                            Support
                                                              The DS8007 evaluation kit (EV kit) is available to assist in
The FIFO empty status bit (FE) operates as before. The
                                                              the development of designs using the DS8007/DS8007A
programmable threshold feature functions the same in
                                                              multiprotocol smart card interface. The EV kit can be
T = 0 and T = 1 modes.
                                                              purchased directly from Maxim.
                                                              For technical support, go to https://support.maxim-
                                                              ic.com/micro.
                   ______________________________________________________________________________________              39


                                                                                                                                                                                                                                                                                                                                DS8007A
40
                                                                                                                  C1
                                                                                                        VCCO                                                  VBAT      V50        VCCO                                                            C2       DVDD
                                                                                                                0.1μF
                                                                                                                                                                                                                                                  10μF
                                                                                                                                                   U2         54       13        12
                                                                                                                                                                                                                                                    C3
                                                                                                        32                                                     VBAT     VCC       VCC0                11                                          0.1μF                                                                  AVDD
                                                                                                                                              74 CE1                                          P0.0
                                                                                                         VCC             22                   72 CE1N                                         P0.1    9
                                                                                                                      CE
                                                                                                                         24                                                                   P0.2    7                                                            27                         23
                                                                                                                      OE                                                                                                                                                VDD              VDDA
                                                                                                                         29                   10                                              P0.3    5                                                                                       21                  C5            C6
                                                                                                          U1          WE                            R/W                                                                                                                                  CPA1
                                                                                                   CY62148BLL-70SXC                                                                           P0.4    1                                                             1                                   C4        10μF          0.1μF
                                                                                                                                                                                                                                                                        RSTOUT
                                                                                         13                              12                   37                                              P0.5    79                                                           40                                   0.22μF
                                                                                              D0                   A0                               A0                                                                                                                  INT
                                                                                         14                              11                   35                                              P0.6    77                                                           39                          26
                                                                                              D1                   A1                               A1                                                                                                                  ALE               CPA2
                                                                                         15                              10                   33                                              P0.7    75                                                           45                          22                                                             CARD SOCKET
                                                                                              D2                   A2                               A2                                                                                                                  AD0               CPB1
                                                                                         17                              9                    30                                                                                                                   44            U3                                                            VDD                 J1
                                                                                              D3                   A3                               A3                                                                                                                  AD1                             C7
                                                                                         18                              8                    28                                              P1.0    15                                                           43                                   0.22μF                                              CCM01-2065LFT
                                                                                              D4                   A4                               A4                                                                                                                  AD2
                                                                                         19                              7                    26                                              P1.1    17                                                           42          DS8007A         24                                                          C8
                                                                                              D5                   A5                               A5                                                                                                                  AD3               CPB2                                                                 C8
                                                                                         20                              6                    24                                              P1.2    19                                                           36                          20                                                          C7
                                                                                              D6                   A6                               A6                DS5002FP                                                                                          RD                 VUP                                                                 C7
                                                                                         21                              5                    20                                              P1.3    21                                                           37                                   C8                                                 C6
                                                                                              D7                   A7                               A7                                                                                                                  WR                                                                                     C6
                                                                                                                         27                    6                                              P1.4    25                                                           28                                   0.22μF                                             C5
                                                                                                                   A8                               A8                                                                                                                  D0                                                                                     C5
                                                                                                                         26                    4                                              P1.5    27                                                           29                                                                                      C4
                                                                                                                   A9                               A9                                                                                                                  D1                                                                                     C4
                                                                                                                         23                   76                                              P1.6    29                                                           30                                                                                      C3
                                                                                                                  A10                               A10                                                                                                                 D2                                                                                     C3
                                                                                                                         25                   80                                              P1.7    31                                                           31                              4                                                       C2
                                                                                                                  A11                               A11                                                                                                                 D3                  C8A                                                                C2
                                                                                                                         4                    18                                                                                                                   32                              3                                                       C1
                                                                                                                  A12                               A12                                                                                                                 D4                  I/0A                                                               C1
                                                                                                                         28                    8                                              P2.0    49                                                           33                              7
                                                                                                                  A13                               A13                                                                                                                 D5                GNDA
                                                                                                                         3                    16                                              P2.1    50                                                           34                              6                                                       S2
                                                                                                                  A14                               A14                                                                                                                 D6                  C4A                                                               S2
                                                                                                                         31                   63                                              P2.2    51                                                           35                              8                                                       S1
                                                                                                                  A15                               CE3/A15                                                                                                             D7                CLKA                                                                S1
                                                                                                                         2                     2                                              P2.3    56                                                           38                              10
                                                                                                                  A16                               CE2/A16                                                                                                             CS                 RSTA                                          R2
                                                                                                                         1                                                                    P2.4    58                                                            2                              9
                                                                                                                  A17                                                                                                                                                   I/OAUX            VCCA                                          10kΩ
                                                                                                                         30                   62 CE4                                          P2.5    60                                                           41                              5
                                                                                                                  A18                                                                                                                                                   INTAUX           PRESA
                                                                                                         GND                                                                                          64                                                           47
                                                                                                                                                                                              P2.6                                                                      XTAL1
                                                                                                           16                                 78                                                      66                                                                                           12                                                           SAM SOCKET
                                                                                                                                                    PE1                                       P2.7                                        Y1                                               C8B
                                                                                                                                               3    PE2                                                                              14.7456MHz                                                    11                                                      C7   C7
                                                                                                                                                                                                                                                                                           I/OB
                                                                                                                                              22    PE3                                   P3.0/RXD    36                                                           46                              15                                                      C6   C6
                                                                                                                                                                                                                                                                        XTAL2             GNDB
                                                                                                                                              23    PE4                                   P3.1/TXD    38                                                                                           14                                                      C5   C5
                                                                                                                                                                                                                        C9                   C10                                           C4B
                                                                                                                                                                                          P3.2/INT0   39                                                           48                              16                                                      C3   C3
                                                                                                                                                                                                                      22pF                  22pF                        DELAY             CLKB
                                                                                                                                              55    D0                                    P3.3/INT1   40                                                                                           18                                                      C2   C2
                                                                                                                                                                                                                                                                                          RSTB
                                                                                                                                              57    D1                                      P3.4/T0   41                                                                                           17                                                      C1   C1
                                                                                                                                                                                                                                                                                          VCCB
                                                                                                                                              59    D2                                      P3.5/TI   44                                                                                           13
                                                                                                                                                                                                                                                                                         PRESB
                                                                                                                                              61    D3                                         P3.6   45                      SW1                                                                                C11        C12                                     J2
                                                                                                                                                                                                                                              R3                                                   25
                                                                                                                                              65                                                      46                     DELAY                                 19                    AGND                    0.1μF      0.1μF                              CCM03-3001LFT
                                                                                                                                                    D4                                         P3.7                                          10kΩ                       GND                                                                          VDD
                                                                                                                                              67                                                                  1                     2
                                                                                                                                                    D5                                                                                                                                                                                       R4
                                                                                                                                              69                                               RST    34                                                                                                                                             1
                                                                                                                                                    D6                                                     RST                                        C14                                                                                   10kΩ
                                                                                                                                              71    D7                                        VRST    42                                                                                                                                1          2 2
                                                                                                                                                                                                                                                    0.1μF                                                                                                JU9
                                                                                                                                                                                                PF    43          3                     4
                                                                                                                         C13                                                                          53                                                                                                                                             3
                                                                                                                                                                                               SDI         SDI
                                                                                                                         22pF
                                                                                                                                              48 XTAL1
                                                                                                                                                                                                      32
                                                                                                                                                                                             PROG          PROG
                                                                                                                                         Y2                                                   ALE 70
                                                                                                                                14.7456 MHz                                                  NC68 68
                                                                                                                         C15
                                                                                                                                                                                             NC73 73
                                                                                                                         22pF
                                                                                                                                              47
                                                                                                                                                    XTAL2                                    MSEL 14
                                                                                                                                                                        GND
                                                                                                                                                                          52
______________________________________________________________________________________
                                                                                                                                                                                                                                                                                                                                                                                                           Multiprotocol Dual Smart Card Interface
                                                                                                                                                                                                                                                                                                                                                                               Typical Operating Circuit


                        Multiprotocol Dual Smart Card Interface
                                                                                                               Package Information
                                                                                                                                                               DS8007A
For the latest package outline information and land patterns, go to www.maxim-ic.com/packages. Note that a “+”, “#”, or “-” in the
package code indicates RoHS status only. Package drawings may show a different suffix character, but the drawing pertains to the
package regardless of RoHS status.
               PACKAGE TYPE                                        PACKAGE CODE                                        DOCUMENT NO.
                    48 LQFP                                              C48L+1                                              21-0054
EMVCo approval of the interface module (IFM) contained in this Terminal shall mean only that the IFM has been tested in accordance and for sufficient
conformance with the EMV Specifications, Version 3.1.1, as of the date of testing. EMVCo approval is not in any way an endorsement or warranty regarding
the completeness of the approval process or the functionality, quality or performance of any particular product or service. EMVCo does not warrant any
products or services provided by third parties, including, but not limited to, the producer or provider of the IFM and EMVCo approval does not under any
circumstances include or imply any product warranties from EMVCo, including, without limitation, any implied warranties of merchantability, fitness for pur-
pose, or noninfringement, all of which are expressly disclaimed by EMVCo. All rights and remedies regarding products and services which have received
EMVCo approval shall be provided by the party providing such products or services, and not by EMVCo and EMVCo accepts no liability whatsoever in
connection therewith.
Maxim cannot assume responsibility for use of any circuitry other than circuitry entirely embodied in a Maxim product. No circuit patent licenses are
implied. Maxim reserves the right to change the circuitry and specifications without notice at any time.
Maxim Integrated Products, 120 San Gabriel Drive, Sunnyvale, CA 94086 408-737-7600 ____________________ 41
© 2008 Maxim Integrated Products                                            Maxim is a registered trademark of Maxim Integrated Products, Inc.


Mouser Electronics
Authorized Distributor
Click to View Pricing, Inventory, Delivery & Lifecycle Information:
Maxim Integrated:
 DS8007A-EAG+T DS8007-ENG+ DS8007A-EAG+
