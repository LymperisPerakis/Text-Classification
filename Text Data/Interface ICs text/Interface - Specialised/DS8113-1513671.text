19-5216; Rev 3; 4/10
                     KIT
              ATION
         EVALU    BLE
           AVA ILA
                                                                                   Smart Card Interface
                             General Description                                                                                   Features
                                                                                                                                                        DS8113
The DS8113 smart card interface is a low-cost, analog                        ♦ Analog Interface and Level Shifting for IC Card
front-end for a smart card reader, designed for all ISO                        Communication
7816, EMV™, and GSM11-11 applications. The DS8113
supports 5V, 3V, and 1.8V smart cards. The DS8113                            ♦ 8kV (min) ESD (IEC) Protection on Card Interface
provides options for low active- and stop-mode power                         ♦ Ultra-Low Stop-Mode Current, Less Than 10nA
consumption, with as little as 10nA stop-mode current.
                                                                               Typical
The DS8113 is designed to interface between a system
microcontroller and the smart card interface, providing                      ♦ Internal IC Card Supply-Voltage Generation:
all power supply, ESD protection, and level shifting                              5.0V ±5%, 80mA (max)
required for IC card applications.                                                3.0V ±8%, 65mA (max)
An EMV Level 1 library (written for the MAXQ2000                                  1.8V ±10%, 30mA (max)
microcontroller) and hardware reference design is                            ♦ Automatic Card Activation and Deactivation
available. Contact Maxim technical support at                                  Controlled by Dedicated Internal Sequencer
https://support.maxim-ic.com/micro regarding
                                                                             ♦ I/O Lines from Host Directly Level Shifted for
requirements for other microcontroller platforms. An
evaluation kit, DS8113-KIT, is available to aid in proto-                      Smart Card Communication
typing and evaluation.                                                       ♦ Flexible Card Clock Generation, Supporting
                                                                               External Crystal Frequency Divided by 1, 2, 4, or 8
                                             Applications
                                                                             ♦ High-Current, Short-Circuit and High-Temperature
        Consumer Set-Top Boxes
                                                                               Protection
        Access Control
                                                                             ♦ Low Active-Mode Current
        Banking Applications
        POS Terminals
                                                                                                                 Pin Configuration
        Debit/Credit Payment Terminals
        PIN Pads
                                                                                       TOP VIEW
        Automated Teller Machines
        Telecommunications
                                                                                    CLKDIV1 1                                      28 AUX2IN
        Pay/Premium Television                                                      CLKDIV2 2                                      27 AUX1IN
                                                                                      5V/3V 3                                      26 I/OIN
                           Ordering Information                                       PGND 4                                       25 XTAL2
                                                                                        CP2 5                                      24 XTAL1
       PART              TEMP RANGE               PIN-PACKAGE
                                                                                      VDDA 6                 DS8113                23 OFF
 DS8113-RNG+             -40°C to +85°C           28 SO
                                                                                        CP1 7                                      22 GND
 DS8113-JNG+             -40°C to +85°C           28 TSSOP
                                                                                        VUP 8                                      21 VDD
Note: Contact the factory for availability of other variants and                       PRES 9                                      20 RSTIN
package options.
                                                                                       PRES 10                                     19 CMDVCC
+Denotes a lead(Pb)-free/RoHS-compliant package.
                                                                                         I/O 11                                    18 1_8V
                                                                                       AUX2 12                                     17 VCC
                                                                                       AUX1 13                                     16 RST
Selector Guide appears at end of data sheet.
                                                                                      CGND 14                                      15 CLK
                                                                                                          SO/TSSOP
EMV is a trademark owned by EMVCo LLC.
Note: Some revisions of this device may incorporate deviations from published specifications known as errata. Multiple revisions of any device may be
simultaneously available through various sales channels. For information about device errata, go to: www.maxim-ic.com/errata.
                       ________________________________________________________________ Maxim Integrated Products                                  1
For pricing, delivery, and ordering information, please contact Maxim Direct at 1-888-629-4642,
or visit Maxim’s website at www.maxim-ic.com.


         Smart Card Interface
         ABSOLUTE MAXIMUM RATINGS
DS8113
         Voltage Range on VDD Relative to GND...............-0.5V to +6.5V                   Maximum Junction Temperature .....................................+125°C
         Voltage Range on VDDA Relative to PGND ..........-0.5V to +6.5V                     Maximum Power Dissipation (TA = -25°C to +85°C) .......700mW
         Voltage Range on CP1, CP2, and VUP                                                  Storage Temperature Range .............................-55°C to +150°C
           Relative to PGND...............................................-0.5V to +7.5V     Lead Temperature (soldering, 10s) .................................+300°C
         Voltage Range on All Other Pins                                                     Soldering Temperature (reflow) .......................................+260°C
           Relative to GND......................................-0.5V to (VDD + 0.5V)
         Stresses beyond those listed under “Absolute Maximum Ratings” may cause permanent damage to the device. These are stress ratings only, and functional
         operation of the device at these or any other conditions beyond those indicated in the operational sections of the specifications is not implied. Exposure to
         absolute maximum rating conditions for extended periods may affect device reliability.
         RECOMMENDED DC OPERATING CONDITIONS
         (VDD = +3.3V, VDDA = +5.0V, TA = +25°C, unless otherwise noted.) (Note 1)
                           PARAMETER                                SYMBOL                        CONDITIONS                      MIN       TYP       MAX       UNITS
          POWER SUPPLY
          Digital Supply Voltage                                       VDD                                                        2.7                  6.0         V
          Card Voltage-Generator Supply Voltage                       VDDA           VDDA > VDD                                   5.0                  6.0         V
                                                                       VTH2          Threshold voltage (falling)                 2.35       2.45      2.60         V
          Reset Voltage Thresholds
                                                                      VHYS2          Hysteresis                                  50.0       100        150        mV
          CURRENT CONSUMPTION
          Active VDD Current 5V Cards                                                ICC = 80mA, f XTAL = 20MHz,
                                                                     IDD_50V                                                               80.75     85.00        mA
          (Including 80mA Draw from 5V Card)                                         fCLK = 10MHz, VDDA = 5.0V
          Active VDD Current 5V Cards                                                ICC = 80mA, fXTAL = 20MHz,
                                                                      IDD_IC                                                                0.75      5.00        mA
          (Current Consumed by DS8113 Only)                                          fCLK = 10MHz, VDDA = 5.0V (Note 2)
          Active VDD Current 3V Cards                                                ICC = 65mA, f XTAL = 20MHz,
                                                                     IDD_30V                                                               65.75     70.00        mA
          (Including 65mA Draw from 3V Card)                                         fCLK = 10MHz, VDDA = 5.0V
          Active VDD Current 3V Cards                                                ICC = 65mA, fXTAL = 20MHz,
                                                                      IDD_IC                                                                0.75      5.00        mA
          (Current Consumed by DS8113 Only)                                          fCLK = 10MHz, VDDA = 5.0V (Note 2)
          Active VDD Current 1.8V Cards                                              ICC = 30mA, f XTAL = 20MHz,
                                                                     IDD_18V                                                               30.75     35.00        mA
          (Including 30mA Draw from 1.8V Card)                                       fCLK = 10MHz, VDDA = 5.0V
          Active VDD Current 1.8V Cards                                              ICC = 30mA, fXTAL = 20MHz,
                                                                      IDD_IC                                                                0.75      5.00        mA
          (Current Consumed by DS8113 Only)                                          fCLK = 10MHz, VDDA = 5.0V (Note 2)
                                                                                     Card inactive, active-high PRES,
          Inactive-Mode Current                                         IDD                                                                 50.0       200        μA
                                                                                     DS8113 not in stop mode
                                                                                     DS8113 in ultra-low-power stop
          Stop-Mode Current                                         IDD_STOP         mode (CMDVCC, 5V/3V, and 1_8V                          0.01      2.00        μA
                                                                                     set to logic 1) (Note 3)
         2    _______________________________________________________________________________________


                                                                           Smart Card Interface
RECOMMENDED DC OPERATING CONDITIONS (continued)
                                                                                                                           DS8113
(VDD = +3.3V, VDDA = +5.0V, TA = +25°C, unless otherwise noted.) (Note 1)
              PARAMETER                       SYMBOL                     CONDITIONS      MIN     TYP    MAX     UNITS
CLOCK SOURCE
Crystal Frequency                               f XTAL       External crystal             0              20     MHz
                                                f XTAL1                                   0              20     MHz
                                                                                                        0.3 x
                                              VIL_XTAL1      Low-level input on XTAL1    -0.3
XTAL1 Operating Conditions                                                                               VDD
                                                                                                                  V
                                                                                         0.7 x          VDD +
                                              VIH_XTAL1      High-level input on XTAL1
                                                                                          VDD            0.3
                                               CXTAL1,
External Capacitance for Crystal                                                                         15      pF
                                               CXTAL2
Internal Oscillator                              f INT                                           2.7            MHz
SHUTDOWN TEMPERATURE
Shutdown Temperature                             T SD                                            +150            °C
RST PIN
                        Output Low Voltage    VOL_RST1       I OL_RST = 1mA               0              0.3      V
Card-Inactive Mode
                        Output Current         I OL_RST1     VO_LRST = 0V                 0              -1      mA
                        Output Low Voltage    VOL_RST2       I OL_RST = 200μA             0              0.3      V
                        Output High                                                      VCC -
                                              VOH_RST2       I OH_RST = -200μA                          VCC       V
                        Voltage                                                           0.5
                        Rise Time               tR_RST       CL = 30pF                                   0.1     μs
Card-Active Mode        Fall Time               tF_RST       CL = 30pF                                   0.1     μs
                        Shutdown Current
                                               IRST(SD)                                          -20             mA
                        Threshold
                        Current Limitation    IRST(LIMIT)                                -20            +20      mA
                        RSTIN to RST Delay   tD(RSTIN-RST)                                               2       μs
CLK PIN
                        Output Low Voltage    VOL_CLK1       I OLCLK = 1mA                0              0.3      V
Card-Inactive Mode
                        Output Current         I OL_CLK1     VOLCLK = 0V                  0              -1      mA
                        Output Low Voltage    VOL_CLK2       I OLCLK = 200μA              0              0.3      V
                        Output High                                                      VCC -
                                              VOH_CLK2       I OHCLK = -200μA                           VCC       V
                        Voltage                                                           0.5
                        Rise Time               tR_CLK       CL = 30pF (Note 4)                          8       ns
Card-Active Mode        Fall Time               tF_CLK       CL = 30pF (Note 4)                          8       ns
                        Current Limitation    ICLK(LIMIT)                                -70            +70      mA
                        Clock Frequency          fCLK        Operational                  0              10     MHz
                        Duty Factor                         CL = 30pF                    45             55      %
                        Slew Rate                 SR         CL = 30pF                    0.2                   V/ns
VCC PIN
                        Output Low Voltage       VCC1        ICC = 1mA                    0              0.3      V
Card-Inactive Mode
                        Output Current           ICC1        VCC = 0V                     0              -1      mA
                      _______________________________________________________________________________________          3


         Smart Card Interface
         RECOMMENDED DC OPERATING CONDITIONS (continued)
DS8113
         (VDD = +3.3V, VDDA = +5.0V, TA = +25°C, unless otherwise noted.) (Note 1)
                       PARAMETER                      SYMBOL                    CONDITIONS               MIN    TYP      MAX    UNITS
                                                                    65mA < ICC(5V) < 80mA                4.55   5.00     5.25
                                                                    ICC(5V) < 65mA                       4.75   5.00     5.25
                                                                    ICC(3V) < 65mA                       2.78   3.00     3.22
                                                                    ICC(1.8V) < 30mA                     1.65   1.80     1.95
                                                                    5V card; current pulses of 40nC
                                                                    with I < 200mA, t < 400ns,           4.6             5.4
                               Output Low Voltage       VCC2        f < 20MHz                                                     V
                                                                    3V card; current pulses of 24nC
                                                                    with I < 200mA, t < 400ns,           2.75            3.25
         Card-Active Mode                                           f < 20MHz
                                                                    1.8V card; current pulses of 12nC
                                                                    with I < 200mA, t < 400ns,           1.62            1.98
                                                                    f < 20MHz
                                                                    VCC(5V) = 0 to 5V                                    -80
                               Output Current            ICC2       VCC(3V) = 0 to 3V                                    -65     mA
                                                                    VCC(1.8V) = 0 to 1.8V                                -30
                               Shutdown Current
                                                       ICC(SD)                                                   120             mA
                               Threshold
                               Slew Rate               VCCSR        Up/down; C < 300nF (Note 5)          0.05   0.16     0.25   V/μs
         DATA LINES (I/O AND I/OIN)
         I/O  I/OIN Falling Edge Delay               tD(IO-IOIN)                                                        200     ns
         Pullup Pulse Active Time                        t PU                                                            100     ns
         Maximum Frequency                             f IOMAX                                                            1     MHz
         Input Capacitance                                CI                                                             10      pF
         I/O, AUX1, AUX2 PINS
                               Output Low Voltage      VOL_IO1      I OL_IO = 1mA                         0              0.3      V
                               Output Current          I OL_IO1     VOL_IO = 0V                           0               -1     mA
         Card-Inactive Mode
                               Internal Pullup
                                                       RPU_IO       To VCC                                9         11   19      k
                               Resistor
                               Output Low Voltage      VOL_IO2      I OL_IO = 1mA                         0              0.3      V
                               Output High                          I OH_IO = < -20μA                   0.8 x VCC        VCC
                                                      VOH_IO2                                                                     V
                               Voltage                              I OH_IO = < -40μA (3V/5V)           0.75 x VCC       VCC
                               Output Rise/Fall
                                                         t OT       CL = 30pF                                            0.1     μs
                               Time
                               Input Low Voltage        VIL_IO                                           -0.3            +0.8
                                                                                                                                  V
         Card-Active Mode      Input High Voltage       VIH_IO                                           1.5             VCC
                               Input Low Current        I IL_IO     VIL_IO = 0V                                          600     μA
                               Input High Current       I IH_IO     VIH_IO = VCC                                         20      μA
                               Input Rise/Fall Time       t IT                                                           1.2     μs
                               Current Limitation     I IO(LIMIT)   CL = 30pF                            -15             +15     mA
                               Current When
                                                         I PU       CL = 80pF, V OH = 0.9 x VDD           -1                     mA
                               Pullup Active
         4   _______________________________________________________________________________________


                                                                          Smart Card Interface
RECOMMENDED DC OPERATING CONDITIONS (continued)
                                                                                                                         DS8113
(VDD = +3.3V, VDDA = +5.0V, TA = +25°C, unless otherwise noted.) (Note 1)
              PARAMETER                      SYMBOL                    CONDITIONS        MIN     TYP   MAX     UNITS
I/OIN, AUX1IN, AUX2IN PINS
Output Low Voltage                             VOL        I OL = 1mA                      0             0.3      V
                                                                                        0.9 x          VDD +
                                                          No Load
                                                                                         VDD            0.1
Output High Voltage                            VOH                                                               V
                                                                                        0.75 x         VDD +
                                                          I OH < -40μA
                                                                                         VDD            0.1
Output Rise/Fall Time                           t OT      CL = 30pF, 10% to 90%                         0.1     μs
                                                                                                       0.3 x
Input Low Voltage                               VIL                                      -0.3                    V
                                                                                                        VDD
                                                                                        0.7 x          VDD +
Input High Voltage                              VIH                                                              V
                                                                                         VDD            0.3
Input Low Current                              I IL_IO    VIL = 0V                                     700      μA
Input High Current                            I IH_IO     VIH = VDD                                     10      μA
Input Rise/Fall Time                            t IT      VIL to VIH                                    1.2     μs
Integrated Pullup Resistor                     RPU        Pullup to VDD                   9      11     13      k
Current When Pullup Active                      I PU      CL = 30pF, V OH = 0.9 x VDD     -1                    mA
CONTROL PINS (CLKDIV1, CLKDIV2, CMDVCC, RSTIN, 5V/3V, 1_8V)
                                                                                                       0.3 x
Input Low Voltage                               VIL                                      -0.3                    V
                                                                                                        VDD
                                                                                        0.7 x          VDD +
Input High Voltage                              VIH                                                              V
                                                                                         VDD            0.3
Input Low Current                              I IL_IO    0 < VIL < VDD                                 5       μA
Input High Current                            I IH_IO     0 < VIH < VDD                                 5       μA
INTERRUPT OUTPUT PIN (OFF)
Output Low Voltage                             VOL        I OL = 2mA                      0             0.3      V
                                                                                        0.75 x
Output High Voltage                            VOH        I OH = -15μA                                           V
                                                                                         VDD
Integrated Pullup Resistor                     RPU        Pullup to VDD                  16      20     24      k
PRES, PRES PINS
                                                                                                       0.3 x
Input Low Voltage                            VIL_PRES                                                            V
                                                                                                        VDD
                                                                                        0.7 x
Input High Voltage                           VIH_PRES                                                            V
                                                                                         VDD
Input Low Current                            I IL_PRES    VIL_PRES = 0V                                 40      μA
Input High Current                           I IH_PRES    VIH_PRES = VDD                                40      μA
                     _______________________________________________________________________________________         5


         Smart Card Interface
         RECOMMENDED DC OPERATING CONDITIONS (continued)
DS8113
         (VDD = +3.3V, VDDA = +5.0V, TA = +25°C, unless otherwise noted.) (Note 1)
                       PARAMETER                      SYMBOL                 CONDITIONS              MIN     TYP     MAX     UNITS
         TIMING
         Activation Time                                tACT                                          50              220      μs
         Deactivation Time                             tDEACT                                         50      80      100      μs
         CLK to Card Start     Window Start              t3                                           50              130
                                                                                                                               μs
         Time                  Window End                t5                                          140              220
         PRES/PRES Debounce Time                     tDEBOUNCE                                        5        8      11      ms
         Note 1: Operation guaranteed at -40°C and +85°C but not tested.
         Note 2: IDD_IC measures the amount of current used by the DS8113 to provide the smart card current minus the load.
         Note 3: Stop mode is enabled by setting CMDVCC, 5V/3V, and 1_8V to a logic-high.
         Note 4: Parameters are guaranteed to meet all ISO 7816, GSM11-11, and EMV 2000 requirements. For the 1.8V card, the maximum
                 rise and fall time is 10ns.
         Note 5: Parameter is guaranteed to meet all ISO 7816, GSM11-11, and EMV 2000 requirements. For the 1.8V card, the minimum
                 slew rate is 0.05V/µs and the maximum slew rate is 0.5V/µs.
         6   _______________________________________________________________________________________


                                                                   Smart Card Interface
                                                                                                Pin Description
                                                                                                                                DS8113
 PIN      NAME                                                         FUNCTION
         CLKDIV1,   Clock Divider. Determines the divided-down input clock frequency (presented at XTAL1 or from a
 1, 2
         CLKDIV2    crystal at XTAL1 and XTAL2) on the CLK output pin. Dividers of 1, 2, 4, and 8 are available.
                    5V/3V Selection Pin. Allows selection of 5V or 3V for communication with an IC card. Logic-high
  3       5V/3V     selects 5V operation; logic-low selects 3V operation. The 1_8V pin overrides the setting on this pin if
                    active. See Table 3 for a complete description of choosing card voltages.
  4       PGND      Analog Ground
 5, 7    CP2, CP1   Step-Up Converter Contact. Unused for the DS8113.
  6       VDDA      Charge Pump Supply. Must be equal to or higher than VDD. For the DS8113 this must be at least 5.0V.
  8        VUP      Charge Pump Output. Unused for the DS8113.
                    Card Presence Indicator. Active-low card presence inputs. When the presence indicator becomes
  9       PRES
                    active, a debounce timeout begins. After 8ms (typ) the OFF signal becomes active.
                    Card Presence Indicator. Active-high card presence inputs. When the presence indicator becomes
 10       PRES
                    active, a debounce timeout begins. After 8ms (typ) the OFF signal becomes active.
 11        I/O      Smart Card Data-Line Output. Card data communication line, contact C7.
          AUX2,     Smart Card Auxiliary Line (C4, C8) Output. Data line connected to card reader contacts C4 (AUX1)
12, 13
          AUX1      and C8 (AUX2).
 14       CGND      Smart Card Ground
 15        CLK      Smart Card Clock. Card clock, contact C3.
 16        RST      Smart Card Reset. Card reset output from contact C2.
                    Smart Card Supply Voltage. Decouple to CGND (card ground) with 2 x 100nF or 100 + 220nF
 17        VCC
                    capacitors (ESR < 100m).
                    1.8V Operation Selection. Active-high selection for 1.8V smart card communication. An active-high
 18       1_8V
                    signal on this pin overrides any setting on the 5V/3V pin.
 19      CMDVCC     Activation Sequence Initiate. Active-low input from host.
 20       RSTIN     Card Reset Input. Reset input from the host.
 21        VDD      Supply Voltage
 22       GND       Digital Ground
 23        OFF      Status Output. Active-low interrupt output to the host. Use a 20k integrated pullup resistor to VDD.
                    Crystal/Clock Input. Connect an input from an external clock to XTAL1 or connect a crystal across
         XTAL1,
24, 25              XTAL1 and XTAL2. For the low idle-mode current variant, an external clock must be driven on
         XTAL2
                    XTAL1.
 26       I/OIN     I/O Input. Host-to-interface chip data I/O line.
         AUX1IN,
27, 28              C4/C8 Input. Host-to-interface I/O line for auxiliary connections to C4 and C8.
         AUX2IN
             _______________________________________________________________________________________                        7


         Smart Card Interface
                                       Detailed Description                      battery-powered devices such as laptops and PDAs,
DS8113
                                                                                 consuming only 10nA in stop mode. See Figure 1 for a
         The DS8113 is an analog front-end for communicating
                                                                                 functional diagram.
         with 1.8V, 3V, and 5V smart cards. It is a dual input-
         voltage device, requiring one supply to match that of a                                                    Power Supply
         host microcontroller and a separate +5V supply for
                                                                                 The DS8113 is a dual-supply device. The supply pins
         generating correct smart card supply voltages. The
                                                                                 for the device are VDD, GND, VDDA, and PGND. VDD
         DS8113 translates all communication lines to the cor-
                                                                                 should be in the range of 2.7V to 6.0V, and is the sup-
         rect voltage level and provides power for smart card
                                                                                 ply for signals that interface with the host controller. It
         operation. It is a low-power device, consuming very lit-
                                                                                 should, therefore, be the same supply as used by the
         tle current in active-mode operation (during a smart
                                                                                 host controller. All smart card contacts remain inactive
         card communication session), and is suitable for use in
                                                                                 during power-on or power-off. The internal circuits are
                                                                                 kept in the reset state until VDD reaches VTH2 + VHYS2
                                                                                 and for the duration of the internal power-on reset
                                                                          VDDA   pulse, tW. A deactivation sequence is executed when
                                                                          PGND   VDD falls below VTH2.
                VDD             POWER-SUPPLY    CARD VOLTAGE
                                                                          CP1
                GND              SUPERVISOR      GENERATOR
                                                                          CP2    An internal regulator generates the 1.8V, 3V, or 5V card
                                                                          VUP    supply voltage (VCC). The regulator should be supplied
               XTAL1                                                             separately by VDDA and PGND. VDDA should be con-
               XTAL2               CLOCK        TEMPERATURE                      nected to a minimum 5.0V supply in order to provide
             CLKDIV1             GENERATION       MONITOR
             CLKDIV2
                                                                                 the correct supply voltage for 5V smart cards.
                1_8V                                                                                      Voltage Supervisor
               5V/3V
             CMDVCC
                                                                          VCC    The voltage supervisor monitors the V DD supply. A
                                          CONTROL                         CGND   220µs reset pulse (tW) is used internally to keep the
               RSTIN
                                         SEQUENCER                        RST
                PRES
                                                                          CLK
                                                                                 device inactive during power-on or power-off of the
                PRES                                                             VDD supply. See Figure 2.
                 OFF
                I/OIN                                                     I/O
                                                                                 The DS8113 card interface remains inactive no matter
              AUX1IN                   I/O TRANSCEIVER                    AUX1   the levels on the command lines until duration tW after
              AUX2IN                                                      AUX2   VDD has reached a level higher than VTH2 + VHYS2.
                                                                                 When VDD falls below VTH2, the DS8113 executes a
                                                                                 card deactivation sequence if its card interface is
                                          DS8113
                                                                                 active.
         Figure 1. Functional Diagram
                                                                                                                          VTH2 + VHYS2
                                                                                                                          VTH2
                                VDD
                              ALARM
                   (INTERNAL SIGNAL)
                                                                  tW                        tW
                                                               POWER ON               SUPPLY DROPOUT                     POWER OFF
         Figure 2. Voltage Supervisor Behavior
         8   _______________________________________________________________________________________


                                                                 Smart Card Interface
                                Clock Circuitry                                             I/O Transceivers
                                                                                                                              DS8113
The card clock signal (CLK) is derived from a clock sig-     The three data lines I/O, AUX1, and AUX2 are identical.
nal input to XTAL1 or from a crystal operating at up to      This section describes the characteristics of I/O and
20MHz connected between XTAL1 and XTAL2. The                 I/OIN but also applies to AUX1, AUX1IN, AUX2, and
output clock frequency of CLK is selectable through          AUX2IN.
inputs CLKDIV1 and CLKDIV2. The CLK signal fre-              I/O and I/OIN are pulled high with an 11kΩ resistor (I/O
quency can be fXTAL, fXTAL/2, fXTAL/4, or fXTAL/8. See       to VCC and I/OIN to VDD) in the inactive state. The first
Table 1 for the frequency generated on the CLK signal        side of the transceiver to receive a falling edge
given the inputs to CLKDIV1 and CLKDIV2.                     becomes the master. When a falling edge is detected
Note that CLKDIV1 and CLKDIV2 must not be changed            (and the master is decided), the detection of falling
simultaneously; a delay of 10ns minimum between              edges on the line of the other side is disabled; that side
changes is needed. The minimum duration of any state         then becomes a slave. After a time delay tD(EDGE), an n
of CLK is eight periods of XTAL1.                            transistor on the slave side is turned on, thus transmit-
The frequency change is synchronous: during a transi-        ting the logic 0 present on the master side.
tion of the clock divider, no pulse is shorter than 45% of   When the master side asserts a logic 1, a p transistor
the smallest period, and the first and last clock pulses     on the slave side is activated during the time delay tPU
about the instant of change have the correct width.          and then both sides return to their inactive (pulled up)
When changing the frequency dynamically, the change          states. This active pullup provides fast low-to-high tran-
is effective for only eight periods of XTAL1 after the       sitions. After the duration of tPU, the output voltage
command.                                                     depends only on the internal pullup resistor and the
The fXTAL duty factor depends on the input signal on         load current. Current to and from the card I/O lines is
XTAL1. To reach a 45% to 55% duty factor on CLK,             limited internally to 15mA. The maximum frequency on
XTAL1 should have a 48% to 52% duty factor with tran-        these lines is 1MHz.
sition times less than 5% of the period.                                                        Inactive Mode
With a crystal, the duty factor on CLK can be 45% to         The DS8113 powers up with the card interface in the
55% depending on the circuit layout and on the crystal       inactive mode. Minimal circuitry is active while waiting
characteristics and frequency. In other cases, the duty      for the host to initiate a smart card session.
factor on CLK is guaranteed between 45% and 55% of
the clock period.                                              • All card contacts are inactive (approximately 200Ω
                                                                   to GND).
If the crystal oscillator is used or if the clock pulse on
XTAL1 is permanent, the clock pulse is applied to the          • Pins I/OIN, AUX1IN, and AUX2IN are in the high-
card as shown in the activation sequences in Figures 3             impedance state (11kΩ pullup resistor to VDD).
and 4. If the signal applied to XTAL1 is controlled by         • Voltage generators are stopped.
the host microcontroller, the clock pulse is applied to        • XTAL oscillator is running (if included in the device).
the card when it is sent by the system microcontroller
(after completion of the activation sequence).                 • Voltage supervisor is active.
                                                               • The internal oscillator is running at its low frequency.
Table 1. Clock Frequency Selection                                                   Activation Sequence
     CLKDIV1            CLKDIV2               fCLK           After power-on and the reset delay, the host microcon-
         0                  0                fXTAL/8         troller can monitor card presence with signals OFF and
         0                  1                fXTAL/4
                                                             CMDVCC, as shown in Table 2.
         1                  1                fXTAL/2
                                                             Table 2. Card Presence Indication
         1                  0                 fXTAL
                                                                    OFF               CMDVCC               STATUS
                                                                    High                 High         Card present.
                                                                     Low                 High         Card not present.
                   _______________________________________________________________________________________                9


         Smart Card Interface
         If the card is in the reader (if PRES is active), the host          2) Set CMDVCC low.
DS8113
         microcontroller can begin an activation sequence (start            3) Set RSTIN low between t3 and t5; CLK will now start.
         a card session) by pulling CMDVCC low. The following
         events form an activation sequence (Figure 3):                     4) RST stays low until t5, then RST becomes the copy
                                                                               of RSTIN.
            1) CMDVCC is pulled low.
                                                                            5) RSTIN has no further effect on CLK after t5.
           2) The internal oscillator changes to high frequency (t0).
                                                                         If the applied clock is not needed, set CMDVCC low
           3) The voltage generator is started (between t0 and t1).      with RSTIN low. In this case, CLK starts at t3 (minimum
           4) VCC rises from 0 to 5V, 3V, or 1.8V with a con-            200ns after the transition on I/O, see Figure 4); after t5,
              trolled slope (t2 = t1 + 1.5 × T). T is 64 times the       RSTIN can be set high to obtain an answer to request
              internal oscillator period (approximately 25µs).           (ATR) from an inserted smart card. Do not perform acti-
           5) I/O, AUX1, and AUX2 are enabled (t3 = t1 + 4T)             vation with RSTIN held permanently high.
              (they were previously pulled low).                                                              Active Mode
           6) The CLK signal is applied to the C3 contact (t4).          When the activation sequence is completed, the
           7) RST is enabled (t5 = t1 + 7T).                             DS8113 card interface is in active mode. The host
         To apply the clock to the card interface:                       microcontroller and the smart card exchange data on
                                                                         the I/O lines.
           1) Set RSTIN high.
                 CMDVCC
                     VCC
                      I/O                                                                                     ATR
                     CLK
                    RSTIN
                     RST
                    I/OIN
                                       t0 t1    t2       t3       t4    t5 = tACT
         Figure 3. Activation Sequence Using RSTIN and CMDVCC
         10   ______________________________________________________________________________________


                                                                             Smart Card Interface
                                                                                                                  DS8113
         CMDVCC
            VCC
              I/O                                                                          ATR
             CLK
                                                         200ns
           RSTIN
             RST
            I/OIN
                                t0 t1   t2   t3 t4               t5 = tACT
Figure 4. Activation Sequence at t3
         CMDVCC
             RST
             CLK
              I/O
             VCC
                                t10          t12          t13       t14         t15
                                                   tDE
Figure 5. Deactivation Sequence
                    ______________________________________________________________________________________   11


         Smart Card Interface
                            Deactivation Sequence                                                     Fault Detection
DS8113
         When a session is completed, the host microcontroller          The following fault conditions are monitored:
         sets the CMDVCC line high to execute an automatic                • Short-circuit or high current on VCC
         deactivation sequence and returns the card interface to
         the inactive mode (Figure 5).                                    • Removal of a card during a transaction
           1) RST goes low (t10).                                         • VDD dropping
           2) CLK is held low (t12 = t10 + 0.5 × T) where T is 64         • Card voltage generator operating out of the speci-
              times the period of the internal oscillator (approxi-         fied values (VDDA too low or current consumption
              mately 25µs).                                                 too high)
           3) I/O, AUX1, and AUX2 are pulled low (t13 = t10 + T).          • Overheating
           4) VCC starts to fall (t14 = t10 + 1.5 × T).                 There are two different cases (Figure 6):
           5) When VCC reaches its inactive state, the deactiva-           • CMDVCC High Outside a Card Session. Output
              tion sequence is complete (at tDE).                            OFF is low if a card is not in the card reader and
                                                                             high if a card is in the reader. The VDD supply is
           6) All card contacts become low impedance to GND;                 monitored—a decrease in input voltage generates
              I/OIN, AUX1IN, and AUX2IN remain at VDD (pulled                an internal power-on reset pulse but does not
              up through an 11kΩ resistor).                                  affect the OFF signal. Short-circuit and tempera-
           7) The internal oscillator returns to its lower frequency.        ture detection is disabled because the card is not
                                                                             powered up.
                                          VCC Generator
                                                                           • CMDVCC Low Within a Card Session. Output
         The V CC generator has a capacity to supply up to                   OFF goes low when a fault condition is detected,
         80mA continuously at 5V, 65mA at 3V, and 30mA at                    and an emergency deactivation is performed auto-
         1.8V. An internal overload detector triggers at approxi-            matically (Figure 7). When the system controller
         mately 120mA. Current samples to the detector are fil-              resets CMDVCC to high, it may sense the OFF
         tered. This allows spurious current pulses (with a                  level again after completing the deactivation
         duration of a few µs) up to 200mA to be drawn without               sequence. This distinguishes between a card
         causing deactivation. The average current must stay                 extraction and a hardware problem (OFF goes high
         below the specified maximum current value. To main-                 again if a card is present). Depending on the con-
         tain VCC voltage accuracy, a 100nF capacitor (with an               nector’s card-present switch (normally closed or
         ESR < 100mΩ) should be connected to CGND and                        normally open) and the mechanical characteristics
         placed near the DS8113’s VCC pin, and a 100nF or                    of the switch, bouncing can occur on the PRES sig-
         220nF capacitor (220nF is the best choice) with the                 nals at card insertion or withdrawal.
         same ESR should be connected to CGND and placed
         near the smart card reader’s C1 contact.                       The DS8113 has a debounce feature with an 8ms typi-
                                                                        cal duration (Figure 6). When a card is inserted, output
                                                                        OFF goes high after the debounce time delay. When
                                                                        the card is extracted, an automatic deactivation
                                                                        sequence of the card is performed on the first true/false
                                                                        transition on PRES and output OFF goes low.
         12   ______________________________________________________________________________________


                                                                        Smart Card Interface
                                                                                                                 DS8113
           PRES
            OFF
        CMDVCC
                      DEBOUNCE                                          DEBOUNCE
            VCC
                                            DEACTIVATION CAUSED                      DEACTIVATION CAUSED
                                           BY CARDS WITHDRAWAL                         BY SHORT CIRCUIT
Figure 6. Behavior of PRES, OFF, CMDVCC, and VCC
           OFF
          PRES
           RST
           CLK
           I/O
          VCC
                             t10               t12         t13    t14          t15
                                                     tDE
Figure 7. Emergency Deactivation Sequence (Card Extraction)
                   ______________________________________________________________________________________   13


         Smart Card Interface
                Stop Mode (Low-Power Mode)                          pins to a logic-low. An internal 220µs (typ) power-up
DS8113
                                                                    delay and the 8ms PRES debounce delay are in effect
         A low-power state, stop mode, can be entered by forc-
                                                                    and OFF is asserted to allow the internal circuitry to sta-
         ing the CMDVCC, 5V/3V, and 1_8V input pins to a
                                                                    bilize. This prevents smart card access from occurring
         logic-high state. Stop mode can only be entered when
                                                                    after leaving the stop mode. Figure 8 shows the control
         the smart card interface is inactive. In stop mode all
                                                                    sequence for entering and exiting stop mode. Note that
         internal analog circuits are disabled. The OFF pin fol-
                                                                    an in-progress deactivation sequence always finishes
         lows the status of the PRES pin. To exit stop mode,
                                                                    before the DS8113 enters low-power stop mode.
         change the state of one or more of the three control
                            DEACTIVATE INTERFACE
                  CMDVCC
                     1_8V                                ACTIVATE     DEACTIVATE
                                                        STOP MODE     STOP MODE
                    5V/3V
                                                                     220μs DELAY
                                                                                         8ms DEBOUNCE
                STOP MODE
                                                                                    OFF ASSERTED TO
                                                                                    WAIT FOR DELAY
                      OFF
                                      OFF FOLLOWS
                                    PRES IN STOP MODE
                     PRES
                     VCC
         Figure 8. Stop-Mode Sequence
         14   ______________________________________________________________________________________


                                                                    Smart Card Interface
                 Smart Card Power Select                        logic-low state. Care must be exercised when switching
                                                                                                                          DS8113
                                                                from one VCC power selection to the other. If both 1_8V
The DS8113 supports three smart card VCC voltages:
                                                                and 5V/3V are high with CMDVCC high at the same
1.8V, 3V, and 5V. The power select is controlled by the
                                                                time, the DS8113 enters stop mode. To avoid acciden-
1_8V and 5V/3V signals as shown in Table 3. The 1_8V
                                                                tal entry into stop mode, the state of 1_8V and 5V/3V
signal has priority over 5V/3V. When 1_8V is asserted
                                                                must not be changed simultaneously. A minimum delay
high, 1.8V is applied to VCC when the smart card is
                                                                of 100ns should be observed between changing the
active. When 1_8V is deasserted, 5V/3V dictates VCC
                                                                states of 1_8V and 5V/3V. See Figure 9 for the recom-
power range. VCC is 5V if 5V/3V is asserted to a logic-
                                                                mended sequence of changing the VCC range.
high state, and V CC is 3V if 5V/3V is pulled to a
Table 3. VCC Select and Operation Mode
       1_8V                5V/3V          CMDVCC          VCC SELECT (V)             CARD INTERFACE STATUS
         0                   0                   0                 3                          Activated
         0                   0                   1                 3                          Inactivated
         0                   1                   0                 5                          Activated
         0                   1                   1                 5                          Inactivated
         1                   0                   0                1.8                         Activated
         1                   0                   1                1.8                         Inactivated
         1                   1                   0                1.8                    Reserved (Activated)
         1                   1                   1                1.8                Not Applicable—Stop Mode
        VCC SELECT          1.8V            3V             5V              3V          1.8V          STOP MODE
          CMDVCC
              1_8V
             5V/3V
Figure 9. Smart Card Power Select
                     ______________________________________________________________________________________         15


         Smart Card Interface
                        Applications Information                                                         Selector Guide
DS8113
         Performance can be affected by the layout of the appli-
                                                                                      LOW STOP- LOW ACTIVE- PIN-
         cation. For example, an additional cross-capacitance of        PART
                                                                                     MODE POWER MODE POWER PACKAGE
         1pF between card reader contacts C2 (RST) and C3
         (CLK) or C2 (RST) and C7 (I/O) can cause contact C2       DS8113-RNG+             Yes                Yes         28 SO
         to be polluted with high-frequency noise from C3 (or      DS8113-JNG+             Yes                Yes         28 TSSOP
         C7). In this case, include a 100pF capacitor between      Note: Contact the factory for availability of other variants and
         contacts C2 and CGND.                                     package options.
         Application recommendations include the following:        +Denotes a lead(Pb)-free/RoHS-compliant package.
          • Ensure there is ample ground area around the
              DS8113 and the connector; place the DS8113
              very near to the connector; decouple the VDD and                               Package Information
              VDDA lines separately. These lines are best posi-    For the latest package outline information and land patterns,
              tioned under the connector, connected in a star on   go to www.maxim-ic.com/packages. Note that a “+”, “#”, or
              the main trace.                                      “-” in the package code indicates RoHS status only. Package
                                                                   drawings may show a different suffix character, but the drawing
          • The DS8113 and the host microcontroller must use       pertains to the package regardless of RoHS status.
              the same VDD supply. Pins CLKDIV1, CLKDIV2,
              RSTIN, PRES, AUX1IN, I/OIN, AUX2IN, 5V/3V,            PACKAGE TYPE           PACKAGE CODE             DOCUMENT NO.
              1_8V, CMDVCC, and OFF are referenced to VDD;           28 SO (300 mils)            W28+6                 21-0042
              if pin XTAL1 is to be driven by an external clock,        28 TSSOP                 U28+2                 21-0066
              also reference this pin to VDD.
          • Trace C3 (CLK) should be placed as far as possi-
              ble from the other traces.
          • The trace connecting CGND to C5 (GND) should
            be straight (the two capacitors on C1 (VCC)
            should be connected to this ground trace).
          • Avoid ground loops among CGND, PGND, and
            GND.
         With all these layout precautions, noise should be kept
         to an acceptable level and jitter on C3 (CLK) should be
         less than 100ps. Reference layouts, designs, and an
         evaluation kit are available on request.
         16   ______________________________________________________________________________________


                                                                                      Smart Card Interface
                                                                                                                        Revision History
                                                                                                                                                               DS8113
 REVISION       REVISION                                                                                                                     PAGES
                                                                           DESCRIPTION
 NUMBER          DATE                                                                                                                       CHANGED
      0             1/08       Initial release                                                                                                   —
                               In the Recommended DC Operating Conditions table, changed I/OIN, AUX1IN/AUX2IN
                                                                                                                                                  5
      1             2/08       specs to reference VDD rather than VCC and corrected IOH to μA.
                               In the Pin Description, removed references to active low from the PRES description.                                7
                               In the Recommended DC Operating Conditions table, clarified specifications of VTH2,
      2             5/08                                                                                                                        2–5
                               f INT, VCCSR, and IIL_IO.
                               Added the TSSOP package (see the Ordering Information, Pin Configuration, Selector
      3             4/10       Guide, and Package Information sections); added the lead temperature and updated                               1, 2, 16
                               the soldering temperature in the Absolute Maximum Ratings.
EMVCo approval of the interface module (IFM) contained in this Terminal shall mean only that the IFM has been tested in accordance and for sufficient
conformance with the EMV Specifications, Version 3.1.1, as of the date of testing. EMVCo approval is not in any way an endorsement or warranty regarding
the completeness of the approval process or the functionality, quality or performance of any particular product or service. EMVCo does not warrant any
products or services provided by third parties, including, but not limited to, the producer or provider of the IFM and EMVCo approval does not under any
circumstances include or imply any product warranties from EMVCo, including, without limitation, any implied warranties of merchantability, fitness for pur-
pose, or noninfringement, all of which are expressly disclaimed by EMVCo. All rights and remedies regarding products and services which have received
EMVCo approval shall be provided by the party providing such products or services, and not by EMVCo and EMVCo accepts no liability whatsoever in
connection therewith.
Maxim cannot assume responsibility for use of any circuitry other than circuitry entirely embodied in a Maxim product. No circuit patent licenses are
implied. Maxim reserves the right to change the circuitry and specifications without notice at any time.
Maxim Integrated Products, 120 San Gabriel Drive, Sunnyvale, CA 94086 408-737-7600 ____________________ 17
© 2010 Maxim Integrated Products                                            Maxim is a registered trademark of Maxim Integrated Products, Inc.


Mouser Electronics
Authorized Distributor
Click to View Pricing, Inventory, Delivery & Lifecycle Information:
Maxim Integrated:
 DS8113-JNG+ DS8113-JNG+T&R DS8113-RNG+ DS8113-RNG+T&R
