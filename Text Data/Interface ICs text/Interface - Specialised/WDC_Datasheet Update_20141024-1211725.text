     October 24, 2014
                      W65C51N
Asynchrones Communications
   Interface Adapter (ACIA)


WDC reserves the right to make changes at any time without notice in order to improve
design and supply the best possible product. Information contained herein is provided
gratuitously and without liability, to any user. Reasonable efforts have been made to
verify the accuracy of the information but no guarantee whatsoever is given as to the
accuracy or as to its applicability to particular uses. In every instance, it must be the
responsibility of the user to determine the suitability of the products for each application.
WDC products are not authorized for use as critical components in life support devices
or systems. Nothing contained herein shall be construed as a recommendation to use
any product in violation of existing patents or other rights of third parties. The sale of
any WDC product is subject to all WDC Terms and Conditions of Sales and Sales
Policies, copies of which are available upon request.
Copyright ©1981-2014 by The Western Design Center, Inc. All rights reserved,
including the right of reproduction, in whole, or in part, in any form.
                                                                                            2


INTRODUCTION
The WDC CMOS W65C51N Asynchronous Communications Interface Adapter (ACIA) provides an easily
implemented, program controlled interface between 8-bit microprocessor based systems and serial
communication data sets and modems.
The ACIA has an internal baud rate generator. This feature eliminates the need for multiple component
support circuits, a crystal being the only other part required. The Transmitter baud rate can be selected
under program control to be either 1 of 15 different rates from 50 to 19,200 baud, or at 1/16 times an
external clock rate. The Receiver baud rate may be selected under program control to be either the
Transmitter rate or at 1/16 times the external clock rate. The ACIA has programmable word lengths of 5,
6, 7 or 8 bits; even, odd or no parity (Mark Parity only for Transmitter); 1, 1½ or 2 bit stops.
The ACIA is designed for maximum-programmed control from the microprocessor (MPU) to simplify
hardware implementation. Three separate registers permit the MPU to easily select the W65C51N
operating modes and data checking parameters and determine operational status.
The Command Register controls parity, receiver echo mode, transmitter interrupt control, the state of the
RTSB line, receiver interrupt control and the state of the DTRB line.
The Control Register controls the number of stop bits, word length, and receiver clock source and baud
rate.
The Status Register indicates the states of the IRQB, DSRB, and DCDB lines, Transmitter and Receiver
Data Registers and Overrun, Framing and Parity Error conditions.
The Transmitter and Receiver Data Registers are used for temporary data storage by the ACIA Transmit
and Receive circuits.
FEATURES
        Low power CMOS N-well silicon gate technology
        Full duplex operation with buffered receiver and transmitter
        Data set/modem control functions
        Internal baud rate generator with 15 programmable baud rates (50 to 19,200)
        Program-selectable internally or externally controlled receiver rate
        Programmable word lengths, number of stop bits and parity bit generation and detection
        Programmable interrupt control
        Program reset
        Program-selectable serial echo mode
        Two chip selects
        5.0 VDC ± 5% supply requirements
        28 pin plastic DIP package
        28 pin PLCC package
        32 pin QFP package
        Full TTL compatibility
        Compatible with 65xx and 68xx microprocessors
                                                                                                        3


PACKAGE PIN OUT DIAGRAMS
                                                                     RESB
                                                                     CS1B
                                                                     CS0
                                                                     VSS
                                                                     RWB
  VSS       1               28      RWB
                                                                     PHI2
                                                                     IRQB
  CS0       2               27      PHI2                              4
 CS1B       3               26      IRQB
                                                                      3
                                                                      2
                                                                      1
                                                                     28
                                                                     27
                                                                     26
 RESB       4               25      D7                  RxC     5                 25   D7
  RxC       5               24      D6                  XTLI    6                 24   D6
                  W65C51N
  XTLI      6               23      D5                 XTL0     7                 23   D5
 XLT0       7               22      D4                 RTSB     8    W65C51S      22   D4
 RTSB       8               21      D3                 CTSB     9                 21   D3
 CTSB       9               20      D2                  TxD     10                20   D2
  TxD       10              19      D1                 DTRB     11                19   D1
 DTRB       11              18      D0
                                                                     12
                                                                     13
                                                                     14
                                                                     15
                                                                     16
                                                                     17
  RxD       12                      DSRB
                                                                     18
                            17
  RS0       13              16      DCDB                              RxD
                                                                      RS0
                                                                      RS1
  RS1       14              15      VDD                               VDD
                                                                     DCDB
                                                                     DSRB
                                                                       D0
    Figure 1a 28 Pin PDIP Pin out                           Figure 1b 28 Pin PLCC Pin Out
                                                               (For new designs use QFP)
                                             RESB
                                             CS1B
                                             CS0
                                             VSS
                                             VSS
                                             RWB
                                             PHI2
                                             IRQB
                                             32
                                             31
                                             30
                                             29
                                             28
                                             27
                                             26
                                             25
                                                           24   NC
                                  RxC    1                 23   D7
                                  XTLI   2                 22   D6
                                 XTL0    3                 21   D5
                                 RTSB    4   W65C51N       20   D4
                                 CTSB    5                 19   D3
                                  TxD    6                 18   D2
                                 DTRB    7                 17   D1
                                   NC    8    9
                                             10
                                             11
                                             12
                                             13
                                             14
                                             15
                                             16
                                              RxD
                                              RS0
                                              RS1
                                              VDD
                                              VDD
                                             DCDB
                                             DSRB
                                               D0
                                     Figure 1c 32 Pin LQFP Pin Out
W65C51S6T Package Types:
The current production tested parts are provided in a PDIP28, PLCC28, and QFP32
packages. The PLCC28 package is only available in very limited quantities due to
packaging obsolescence from our supplier.
                                                                                            4


ACIA INTERNAL ORGANIZATION
                                                             TRANSMIT
                                                             CONTROL
                                                                      CTSB
                                            TRANSMITER       TRANSMIT
               DATA BUS
      D0-D7    BUFFER
                                I           DATA             SHIFT    TxD
                                N           REGISTER         REGISTER
                                T
                                E
       IRQB   INTERRUPT         R           STATUS                    DCDB
              LOGIC             N           REGISTER
                                A                                     DSRB
                                L                                     RxC
                                                            BAUD RATE
        RWB                     D           CONTROL
                                                            GENERATOR
                                                                      XTLI
                                            REGISTER
         CS0                    A                                     XTLO
                                T
                I/O
       CS1B     CONTROL
                                A
                                            COMMAND
                                                                      DTRB
         RS0                    B           REGISTER                  RTSB
                                U
         RS1                    S
                                            RECEIVER        RECEIVE
        PHI2   TIMING &                     DATA            SHIFT     RxD
               CONTROL                      REGISTER        REGISTER
       RESB
                                                             RECEIVE
                                                             CONTROL
                        Figure 2 ACIA Internal Organization
                                                                           5


FUNCTIONAL DESCRIPTION
A block diagram of the ACIA is presented in Figure 3 followed by a description of each functional element
of the device.
DATA BUS BUFFERS
The Data Bus Buffer interfaces the system data lines to the internal data bus. The Data Bus Buffer is bi-
directional. When the RWB line is high and the chip is selected, the Data Bus Buffer passes the data
from the system data lines to the ACIA internal data bus. When the RWB line is low and the chip is
selected, the Data Bus Buffer writes the data from the internal data bus to the system data bus.
INTERRUPT LOGIC
The Interrupt Logic will cause the IRQB line to the microprocessor to go low when conditions are met that
require the attention of the microprocessor. The conditions which can cause an interrupt will set bit 7 and
the appropriate bit of bits 3 through 6 in the Status Register, if enabled. Bits 5 and 6 correspond to the
Data Carrier Detect (DCDB) logic and the Data Set Ready (DSRB) logic. Bits 3 and 4 correspond to the
Receiver Data Register full and the Transmitter Data Register empty conditions. These conditions can
cause an interrupt request if enabled by the Command Register.
I/O CONTROL
The I/O Control Logic controls the selection of internal registers in preparation for a data transfer on the
internal data bus and the direction of the transfer to or from the register. The registers are selected by the
Register Select (RS1, RS0) and Read/Write (RWB) lines as described later in Table 1.
TIMING AND CONTROL
The Timing and Control logic controls the timing of data transfers on the internal data bus and the
registers, the Data Bus Buffer and the microprocessor data bus and hardware reset features.
Timing is controlled by the system PHI2 clock input. The chip will perform data transfers to or from the
microcomputer data bus during the PHI2 high period when selected.
The Timing and Control Logic will initialize all registers when the Reset (RESB) line goes low. See the
individual register description for the state of the registers following a hardware reset.
TRANSMITTER AND RECEIVER DATA REGISTERS
These registers are used as temporary data storage for the ACIA Transmit and Receive Circuits. Both
the Transmitter and Receiver are selected by a Register Select 0 (RS0) and Register Select 1 (RS1) low
condition. The Read/Write (RWB) line determines which actually uses the internal data bus; the
Transmitter Data Register is write only and the Receiver Data Register is read only.
Bit 0 is the first bit to be transmitted from the Transmitter Data Register (least significant bit first). The
higher order bits follow in order. Unused bits in this register are “don’t care”.
The Receiver Data Register holds the first received data bit in bit 0 (least significant bit first). Unused
high-order bits are “0”. Parity bits are not contained in the Receiver Data Register. They are stripped off
after being used for parity checking.
                                                                                                             6


STATUS REGISTER
The Status Register indicates the state of interrupt conditions and other non-interrupt status lines. The
interrupt conditions are the Data Set Ready, Data Carrier Detect, Transmitter Data Register Empty and
Receiver Data Register Full as reported in bits 6 through 3, respectively. If any of these bits are set the
interrupt (IRQ) indicator (bit 7) is also set. Overrun, Framing Error and Parity Error are also reported (bits
2 through 0 respectively).
     7       6         5        4       3       2        1  0
   IRQ     DSRB     DCDB      TDRE    RDRF    OVRN      FE PE
       Bit 7      Interrupt (IRQ)
         0        No Interrupt
         1        Interrupt has occurred
       Bit 6      Data Set Ready (DSRB)
         0        DSR low (ready)
         1        DSR high (not ready)
       Bit 5      Data Carrier Detect (DCDB)
         0        DCD low (detected)
         1        DCD high (not detected)
       Bit 4      Transmitter Data Register Empty*
         0        Not Empty
         1        Empty
       Bit 3      Receiver Data Register Full
         0        Not full
         1        Full
       Bit 2      Overrun*
         0        No overrun
         1        Overrun has occurred
       Bit 1      Framing Error*
         0        No framing error
         1        Framing error detected
       Bit 0      Parity Error*
         0        No parity error
         1        Parity error detected
   *No interrupt occurrs for these conditions
   Reset Initialization
   7    6    5  4      3   2    1     0
   0    -    -  1      0   0    0     0   Hardware reset
   -    -    -   -     -   0     -    -   Program reset
Note:
The W65C51N has an operation issue concerning TDRE. This bit is not being reset after loading the
Transmitter Data Register. Polling the TDRE bit of the status register will never show the TDR as Empty.
Due to this issue, the W65C51N is not suggested as a direct replacement for older 6551 devices if the
firmware uses this bit. It is recommended to using IRQ handling or software timeout for transmission as a
workaround for this issue.
                                                                                                             7


STATUS REGISTER BIT DESCRIPTION
Parity error (Bit 0) Framing Error (Bit 1) and Overrun (Bit 2)
None of these bits causes a processor interrupt to occur but, they are normally checked at the time the
Receiver Data Register is read so that the validity of the data can be verified. These bits are self-clearing
(i.e., they are automatically cleared after a read of the Receiver Data Register).
Receiver Data Register Full (Bit 3)
This bit goes to a 1 when the ACIA transfers data from the Receiver Shift Register to the Receiver Data
Register and goes to a 0 (is cleared) when the processor reads the Receiver Data Register.
Transmitter Data Register Empty (Bit 4)
This bit goes to a 1 when the ACIA transfers data from the Transmitter Data Register to the Transmitter
Shift Register and goes to a 0 (is cleared) when the processor writes new data onto the Transmitter Data
Register.
Note: The above text describes normal operation. The latest W65C51N part, there is an issue with Bit 4
not going to a 1. WDC does not recommend polling Bit 4 for transmission with the W65C51N part.
Data Carrier Detect (Bit 5) and Data Set Ready (Bit 6)
These bits reflect the levels of the DCDB and DSRB inputs to the ACIA. A 0 indicates a low level (true
condition) and a 1 indicates a high level (false). Whenever either of these inputs change state, an
immediate processor interrupt (IRQ) occurs, unless bit 1 of the Command Register (IRD) is set to a 1 to
disable IRQB. When the interrupt occurs, the status bits indicate the levels of the inputs immediately after
the change of state occurred. Subsequent level changes will not affect the status bits until the Status
Register is interrogated by the processor. At that time, another interrupt will immediately occur and the
status bits reflect the new input levels. These bits are not automatically cleared (or reset) by an internal
operation.
Interrupt (Bit 7)
This bit goes to a 1 whenever an interrupt condition occurs and goes to a 0 (is cleared) when the Status
Register is read.
                                                                                                            8


CONTROL REGISTER
The Control Register selects the desired baud rate, frequency source, word length and the number of
stop bits.
    7        6       5       4       3      2       1     0
                WL                            SBR
   SB
          WL1     WL0      RCS      SBR    SBR    SBR   SBR
    N
                                     3      2       1     0
  Bit 7                Stop Bit Number (SBN)
           0           1 Stop bit
           1           2 Stop bits
           1           1 ½ Stop bits
                       For WL = 5 and no parity
           1           1 Stop bit
                       For WL = 8 and parity
   Bits 6-5       Word Length (WL)
     6       5    No. Bits
     0       0       8
     0       1       7
     1       0       6
     1       1       5
  Bit 4            Receiver Clock Source
                   (RCS)
         0         External receiver clock
         1         Baud rate
  Bit 3-0       Selected Baud Rate
                (SBR)
    3     2       1         0      Baud
    0     0       0         0      16x
    0     0       0         1      50
    0     0       1         0      75
    0     0       1         1      109.92
    0     1       0         0      134.58
    0     1       0         1      150
    0     1       1         0      300
    0     1       1         1      600
    1     0       0         0      1200
    1     0       0         1      1800
    1     0       1         0      2400
    1     0       1         1      3600
    1     1       0         0      4800
    1     1       0         1      7200
    1     1       1         0      9600
    1     1       1         1      19,200
Reset Initialization
  7    6   5   4   3   2   1   0
  0    0   0   0   0   0   0   0    Hardware reset (RESB)
  -    -   -   -   -   -   -   -    Program reset
                                                                                                  9


CONTROL REGISTER BIT DESCRIPTION
Selected Baud Rate (Bits 0, 1, 2, 3)
These bits select the Transmitter baud rate, which can be at 1/16 an external clock rate or one of 15 other
rates controlled by the internal baud rate generator.
If the Receiver clock uses the same baud rate at the transmitter, then RxC becomes an output and can
be used to slave other circuits to the ACIA. Figure 3 shows the Transmitter and Receiver layout.
                                  RECEIVER
                                                                  RxD
                                   SHIFT REGISTER
                                     CLOCK              SYNC
                                     DIVIDER            LOGIC
                                     (16)
                                                                  RxC
                  CONTROL
                  REGISTER
                  BIT 4
                                     CLOCK
  XTLI        BAUD RATE              DIVIDER
  XTLO        GENERATOR              (16)
               BITS 0-3 IN
               CONTROL          TRANSMITTER
               REGISTER                                            TxD
                                SHIFT REGISTER
                                 Figure 3 Transmitter/Receiver Clock Circuits
Receiver Clock Source (Bit 4)
This bit controls the clock source to the Receiver. A 0 causes the Receiver to operate at a baud rate of
1/16 an external clock. A 1 causes the Receiver to operate at the same baud rate as is selected for the
transmitter.
Word Length (Bits 5, 6)
These bits determine the word length to be used (5, 6, 7 or 8 bits).
Stop Bit Number (Bit 7)
This bit determines the number of stop bits used. A 0 always indicates one stop bit. A 1 indicates 1½
stop bits if the word length is 5 with no parity selected 1 stop bit if the word length is 8 with parity selected
and 2 stop bits in all other configurations.
                                                                                                               10


COMMAND REGISTER
The Command Register controls specific modes and functions
     7         6       5       4      3       2      1      0
         PMC                              TIC
                      PME     REM                   IRD    DTR
   PMC1      PMC0                   TIC1     TIC0
   Bits 7-6              Parity Mode Control (PMC)
      7           6
      0           0      Receiver Odd parity checked
      0           1      Receiver Even parity checked
      1           0      Receiver Parity check disabled
      1           1      Receiver Parity check disabled
    Bit 5     Parity Mode Enabled (PME)
      0       Parity mode disabled
              Parity check and parity transmission disabled
      1       Parity mode enabled and Mark parity bit always transmitted
              (See Errata, pg. 33)
    Bit 4     Receiver Echo Mode (REM)
      0       Receiver normal mode
      1       Receiver echo mode bits 2 and 3
              Must be zero for receiver echo
              mode, RTS will be low
    Bits 3-2      Transmitter Interrupt Control (TIC)
    3      2
                  RTSB = High, transmit interrupt
    0      0      disabled
                  RTSB = Low, transmit interrupt
    0      1      enabled
                  RTSB = Low, transmit interrupt
    1      0      disabled
                  RTSB = Low, transmit interrupt
    1      1      disabled
                  Transmit break on TxD
    Bit 1     Receiver Interrupt Request Disabled
              (IRD)
      0       IRQB enabled
      1       IRQB disabled
    Bit 0     Data Terminal Ready (DTR)
      0       Data terminal not ready (DTRB
              high)
      1       Data terminal ready (DTRB low)
Reset Initialization
 7    6    5     4   3    2    1    0
 0    0    0     0   0    0    0    0    Hardware reset (RESB)
 -     -   -     0   0    0    0    0    Program reset
                                                                         11


COMMAND REGISTER BIT DESCRIPTION
Data Terminal Ready (Bit 0)
This bit enables all selected interrupts and controls the state of the Data Terminal Ready (DTRB) line. A
0 indicates the microcomputer system is not ready by setting the DTRB line high. A 1 indicates the
microcomputer system is ready by setting the DTRB line low.
Receiver Interrupt Control (Bit 1)
This bit disables the Receiver from generating an interrupt when set to a 1. The Receiver interrupt is
enabled when this bit is set to a 0 and Bit 0 is set to a 1.
Transmitter Interrupt Control (Bits 2, 3)
These bits control the state of the Ready to Send (RTSB) line and the Transmitter interrupt.
Receiver Echo Mode (Bit 4)
A 1 enables the Receiver Echo Mode and a 0 enables the Receiver Echo Mode. When bit 4 is a 1 bits 2
and 3 must be 0. In the Receiver Echo Mode, the Transmitter returns each transmission received by the
Receiver delayed by one-half bit time.
Parity Mode Enable (Bit 5)
This bit enables parity bit generation and checking. A 0 disables parity bit generation by the Transmitter
and parity bit checking by the Receiver. A 1 bit enables generation and checking of parity bits.
Parity Mode Control (Bits 6, 7)
These bits determine the type of parity generated by the Transmitter (W65C51N device currently will only
generate a MARK parity bit) and the type of parity check done by the Receiver (even, odd or no check).
                                                                                                       12


INTERFACE SIGNALS
Figure 4 shows the ACIA interface signals associated with the microprocessor and the modem.
                            TRANSMIT         CTSB
               DATA BUS     CONTROL
  D0-D7
               BUFFERS
                            TRANSMIT
                            DATA &           TxD
    IRQB       INTERRUPT    SHIFT
               LOGIC        REGISTERS
                             STATUS           DCDB
    RWB
                             REGISTER
                                              DSRB
    CS0
               I/O
    CS1B       CONTROL
                                              RxC
    RS0                     BAUD RATE
                            GENERATOR        XTLI
    RS1                                      XTLO
                            CONTROL
     Ø2        TIMING &     REGISTER
               CONTROL
   RESB
               LOGIC                         DTRB
                            COMMAND
                            REGISTER         RTSB
    VCC                     RECEIVE
                            DATA &           RxD
                            SHIFT
    VSS                     REGISTERS
                             RECEIVE
                             CONTROL
                                      Figure 4 ACIA Interface Diagram
MICROPROCESSOR INTERFACE
Reset (RESB)
During System initialization a low on the RESB input causes a hardware reset to occur. Upon reset, the
Command Register and the Control Register are cleared (all bits set to 0). The Status Register is cleared
with the exception of the indications of Data Set Ready and Data Carrier Detect, which are externally
controlled by the DSRB and DCDB lines, and the transmitter Empty bit, which is set. RESB must be held
low for one PHI2 clock cycle for a reset to occur.
Input Clock (PHI2)
The input clock is the system PHI2 clock and clocks all data transfers between the system
microprocessor and the ACIA.
Read/Write (RWB)
The RWB input, generated by the microprocessor controls the direction of data transfers. A high on the
RWB pin allows the processor to read the data supplied by the ACIA, a low allows a write to the ACIA.
                                                                                                       13


Interrupt Request (IRQB)
The IRQB pin is an interrupt output from the interrupt control logic. It is an open drain output, permitting
several devices to be connected to the common IRQB microprocessor input. Normally a high level, IRQB
goes low when an interrupt occurs.
Data Bus (D0-D7)
The eight data line (D0-D7) pins transfer data between the processor and the ACIA. These lines are bi-
directional and are normally high-impedance except during Read cycles when the ACIA is selected.
Chip Selects (CS0, CS1B)
The two chip select inputs are normally connected to the processor address lines either directly or
through decoders. The ACIA is selected when CS0 is high and CS1B is low. When the ACIA is selected,
the internal registers are addressed in accordance with the register select lines (RS0, RS1).
Register Selects (RS0, RS1)
The two register select lines are normally connected to the processor address lines to allow the processor
to select the various ACIA internal registers. Table 1 shows the internal register select coding.
                                Register Operation
   RS1     RS0          RWB = Low            RWB = High
     L       L     Write Transmit         Read Receiver
                   Data Register          Data Register
     L       H     Programmed             Read Status
                   Reset (Data is         Register
                   “Don’t Care”)
    H        L     Write Command          Read Command
                   Register               Register
    H        H     Write Control          Read Control
                   Register               Register
                    Table 1 ACIA Register Selection
Only the Command and Control registers can both be read and written. The programmed Reset operation does not
cause any data transfer, but is used to clear bits 4 through 0 in the Command Register and bit 2 in the Status
Register. The Control Register is unchanged by a programmed Reset. It should be noted that the programmed
Reset is slightly different from the hardware Reset (RESB); refer to the register description.
                                                                                                            14


ACIA/MODEM INTERFACE
Crystal Pins (XTLI, XTLO)
These pins are normally directly connected to the external crystal (1.8432 MHz) to derive the various
baud rates. Alternatively, an externally generated clock can drive the XTLI pin, in which case the XTLO
pin must float. XTLI is the input pin for the transmit clock.
Transmit Data (TxD)
The TxD output line transfers serial non-return-to-zero (NRZ) data to the modem. The least significant bit
(LSB) of the Transmit Data Register is the first data bit transmitted and the rate of data transmission is
determined by the baud rate selected or under control of an external clock. This selection is made by
programming the Control Register.
Receive Data (RxD)
The RxD input line transfers serial NRZ data into the ACIA from the modem, LSB first. The receiver data
rate is either the programmed baud rate or under the control of an externally generated receiver clock.
The selection is made by programming the Control Register.
Receive Clock (RxC)
The RxC is a bi-directional pin which is either the receiver 16x clock input or the receiver 16x clock output.
The latter mode results if the internal baud rate generator is selected for receiver data clocking.
Request to Send (RTSB)
The RTSB output pin controls the modem from the processor. The state of the RTSB pin is determined
by the contents of the Command Register.
Clear to Send (CTSB)
The CTSB input pin controls the transmitter operation.          The enable state is with CTSB low.        The
transmitter is automatically disabled if CTSB is high.
Data Terminal Ready (DTRB)
This output pin indicates the status of the ACIA to the modem. A low on DTRB indicates the ACIA is
enabled, a high indicates it is disabled. The processor controls this pin via bit 0 of the Command
Register.
Data Set Ready (DSRB)
The DSRB input pin indicates to the ACIA the status of the modem. A low indicates the “ready” state and
a high, “not-ready”
Data Carrier Detect (DCDB)
The DCDB input pin indicates to the ACIA the status of the carrier-detect output of the modem. A low
indicates that the modem carrier signal is present and a high that it is not.
                                                                                                           15


TRANSMITTER AND RECEIVER OPERATION
Continuous Data Transmit
In the normal operating mode, the interrupt request output (IRQB) signals when the ACIA is ready to
accept the next data word to be transmitted. This interrupt occurs at the beginning of the Start Bit. When
the processor reads the Status Register of the ACIA, the interrupt is cleared.
The processor must then identify that the Transmit Data Register is ready to be loaded and must then
load it with the next data word. This must occur before the end of the Stop Bit, otherwise a continuous
“MARK” will be transmitted.               Figure 5 shows the Continuous Data Transmit timing relationship.
                     CHAR # n                    CHAR # n+1                  CHAR # n+2                  CHAR # n+3
     TxD   Start B    B     B   P Stop Start B    B     B   P Stop Start B    B     B   P Stop Start B    B     B   P Stop
                   0    1     N                0    1     N                0    1     N                0    1     N
    IRQB
      PROCESSOR INTERRUPT                                            PROCESSOR MUST
      (TRANSMIT DATA                                                 LOAD NEW DATA IN THIS
      REGISTER EMPTY)                                                TIME INTERVAL;
                                    PROCESSOR READS                  OTHERWISE,
                                    STATUS REGISTER,                 CONTINUOUS “MARK” IS
                                    CAUSES IRQB TO CLEAR.            TRANSMITTED
                                             Figure 5 Continuous Data Transmit
Continuous Data Receive
Similar to the Continuous Data Transmit case, the normal operation of this mode is to assert IRQB when
the ACIA has received a full data word. This occurs at about the 9/16 point through the Stop Bit. The
processor must read the Status Register and read the data word before the next interrupt, otherwise the
Overrun condition occurs. Figure 6 shows the continuous Data Receive Timing Relationship.
                     CHAR # n                    CHAR # n+1                  CHAR # n+2                  CHAR # n+3
     RxD   Start B    B     B   P Stop Start B    B     B   P Stop Start B    B    B    P Stop Start B    B     B   P Stop
                   0    1     N                0    1     N                0    1    N                 0    1     N
    IRQB
        PROCESSOR INTERRUPT
        OCCURS ABOUT 9/16                                            PROCESSOR MUST
        INTO LAST STOP BIT.                                          READ RECEIVER DATA IN
        PARITY, OVERRUN AND                                          THIS TIME INTERVAL;
        FRAMING ERROR ALSO          PROCESSOR READS                  OTHERWISE, OVERRUN
        UPDATED                     STATUS REGISTER,                 OCCURS
                                    CAUSES IRQB TO CLEAR.
                                             Figure 6 Continuous Data Receive
                                                                                                                           16


Transmit Data Register Not Loaded by Processor
If the processor is unable to load the Transmit Data Register in the allocated time, then the TxD line goes
to the “MARK” condition until the data is loaded. IRQB interrupts continue to occur at the same rate as
previously, yet no data is transmitted. When the processor finally loads new data, a Start Bit immediately
occurs, the data word transmission is started and another interrupt is initiated, signaling for the next data
word. Figure 7 shows the timing relationship for this mode of operation.
                           CHAR # n                   CONTINUOUS “MARK”                   CHAR # n+1                       CHAR # n+2
       TxD  Stop Start B    B       B     P   Stop                              Start B    B       B     P  Stop Start B    B     B
                         0    1       N                                                 0    1       N                   0    1     N
                                                       CHARACTER
                                                          TIME
       IRQB
                            PROCESSOR DOES
    PROCESSOR               NOT LOAD NEW
    INTERRUPT               DATA IN TIME                INTERRUPTS
    FOR DATA                                            CONTINUE AT                        WHEN PROCESSOR FINALLY
    REGISTER                                            CHARACTER RATE,                    LOADS NEW DATA, TRANSMISSION
    EMPTY                                               EVEN THOUGH                        STARTS IMMEDIATELY AND
                 PROCESSOR                              NO DATA IS                         INTERRUPT OCCURS, INDICATING
                 READS                                  TRANSMITTED                        TRANSMIT DATA REGISTER EMPTY
                 STATUS
                 REGISTER
                                Figure 7 Transmit Data Register Not Loaded by Processor
Effect of CTSB on Transmitter
CTSB is the Clear-to-Send signal generated by the modem. It is normally low (true state) but may go
high in the event of some modem problems. When this occurs, the TxD line goes to the “MARK”
condition after the entire last character (including parity and stop bit) have been transmitted. Bit 4 in the
Status Register indicates that the Transmitter Data Register is not empty and IRQB is not asserted.
CTSB is transmit control line only, and has not effect on the ACIA Receiver Operation. Figure 8 shows
the timing relationship for this mode of operation.
            CHAR # n                            CHAR # n+1                                                  CONTINUOUS “MARK”
       TxD   B          B     P Stop Start B     B        B    P Stop Start B    B B           B   P   Stop
               1          N                  0     1        N                 0   1 2            N
      IRQB                                                                                                                       IRQB IS NOT ASSERTED
                                                                                                                                 AGAIN UNTIL CTSB
                                                                                          NOT CLEAR-TO-SEND                      GOES LOW
      CTSB                      CLEAR-TO-SEND
                                                                                CTSB GOES HIGH INDICATING MODEM
                                                                                IS NOT READY TO RECEIVE DATA, TxD
                                                                                GOES TO “MARK” CONDITION AFTER
                                                                                COMPLETE CHARACTER IS
                                                                                TRANSMITTED
                                                   Figure 8 Effect of CTS on Transmitter
                                                                                                                                                    17


Effect of Overrun on Receiver
If the processor does not read the Receiver Data Register in the allocated time, then, when the following
interrupt occurs, the new data word is not transferred to the Receiver Data Register, but the Overrun
status bit is set. Thus, the Data Register will contain the last valid data word received and all following
data is lost. Figure 9 shows the timing relationship for this mode.
                           CHAR # n                          CHAR # n+1                           CHAR # n+2                           CHAR # n+3
      RxD   Stop Start B    B       B    P   Stop Start B      B         B     P   Stop Start B    B          B     P  Stop Start B     B     B
                         0    1       N                    0     1         N                    0    1          N                   0     1     N
     IRQB
                                                                                                         RECEIVER DATA REGISTER
                                                                   PROCESSOR                             NOT UPDATED, BECAUSE
                                                                   DOES NOT                              PROCESSOR DID NOT READ
          PROCESSOR INTERRUPT                                      READ DATA
          FOR RECEIVER DATA                                                                              PREVIOUS DATA, OVERRUN
                                            PROCESSOR              REGISTER                              BIT SET IN STATUS REGISTER
          REGISTER FULL
                                            READS STATUS
                                            REGISTER
     IRQB
                                                                                                   OVERRUN BIT SET IN
                                                      PROCESSOR
                                                                                                   STATUS REGISTER
                                                      DOES NOT
                                                      READ STATUS
                                                      REGISTER
                                                 Figure 9 Effect of Overrun on Receiver
Echo Mode Timing
In Echo Mode, the TxD line re-transmits the data on the RxD line, delayed by ½ of the bit time, as shown
in Figure 10.
                                RxD      Stop Start B      B          B      P   Stop Start B     B          B      P  Stop Start B
                                                       0     1          N                     0     1          N                     0
                                TxD     P   Stop Start B      B          B     P    Stop Start B0    B          B     P   Stop Start B0
                                                          0     1          N                           1          N
                                                         ½ DATA BIT DELAY
                                                          Figure 10 Echo Mode Timing
                                                                                                                                                  18


Effect of CTSB on Echo Mode Operation
In Echo Mode, the Receiver operation is unaffected by CTSB, however, the Transmitter is affected when
CTSB goes high, ie., the TxD line immediately goes to a continuous “Mark” condition. In this case,
however, the Status Register indicates that the Receiver Data Register is full in response to an IRQB, so
the processor has no way of knowing that the Transmitter has ceased to echo. See Figure 12 for the
timing relationship of this mode.
                           CHAR # n                          CHAR # n+1                       CHAR # n+2                    CHAR # n+3
     RxD   Stop Start B      B      B      P  Stop Start B     B         B   P Stop Start B    B     B   P   Stop Start B    B     B
                        0      1      N                    0     1         N                0    1     N                  0    1     N
    IRQB
                                                                                      NOT-CLEAR-TO-SEND
    CTSB
                                                                                    CONTINUOUS “MARK” UNTIL CTSB GOES LOW
          P   Stop Start B      B      B     P   Stop Start B     B   B
     TxD                   0      1      N                    0     1   2
                                                   CTSB GOES TO
                                                   “FALSE” CONDITION
                                                       NORMAL
                                                       RECEIVER DATA
                                                       REGISTER FULL
                                                       INTERRUPTS
                                                 Figure 11 Effect of CTSB on Echo Mode
                                                                                                                                       19


Overrun in Echo Mode
If Overrun occurs in Echo Mode, the Receiver is affected the same way as a normal overrun in Receive
Mode. For the retransmitted data, when overrun occurs, the TxD line goes to the “MARK” condition until
the first Start Bit after the Receiver Data Register is read by the processor. Figure 12 shows the timing
relationship for this mode.
                            CHAR # n                                                                  CHAR # x                            CHAR # x+1
                                                                             B
      RxD   Stop Start B      B        B      P   Stop Start B     B
                                                                              N    P   Stop Start B     B       B      P   Stop Start B    B     B   P
                         0      1        N                     0    1                               0    1        N                     0   1     N
     IRQB
           P   Stop Start B      B        B     P                                                                                  Start B   B     B   P
      TxD                   0      1        N                                                                                             0   1     N
                            PROCESSOR DOES                                                                                      TxD DATA
  PROCESSOR                 NOT READ                                                  PROCESSOR FINALLY
  INTERRUPT FOR             RECEIVER DATA
                                                                                                                                RESUMES
                                                                                      READS RECEIVER
  RECEIVER DATA             REGISTER
                                                                                      DATA REGISTER,
  REGISTER FULL                                                                       LAST VALID
                                                                                      CHARACTER (#n)
                  PROCESSOR                 OVERRUN OCCURS
                                                                                                                          PROCESSOR
                  READS STATUS              TxD GOES TO
                                                                                                                          INTERRUPT FOR
                  REGISTER                  “MARK”
                                                                                                                          CHAR#x IN
                                            CONDITION
                                                                                                                          RECEIVER DATA
                                                                                                                          REGISTER
                                                       Figure 12 Overrun in Echo Mode
Framing Error
Framing Error is caused by the absence of Stop Bit(s) on received data. A Framing Error is indicated by
the setting of bit 1 in the Status Register at the same time the Receiver Data Register Full bit is set, also
in the Status Register. In response to IRQB, generated by RDRF, the Status Register can also be
checked for the Framing Error. Subsequent data words are tested for Framing Error separately, so the
status bit will always reflect the last data word received. See Figure 13 for Framing Error timing
relationship.
                          RxD                   B                                          B    B    B    B       Stop Stop Start B
                                                  6   P   Stop Stop Start B    B     B
                                                                                             3    4    5    6
                                                                                                              P                      0
                          (EXPECTED)                        1    2          0    1     2                            1    2
                          RxD                   B                                          B    B    B    B       Stop Stop Start B
                                                  6   P   Stop Stop Start B    B     B
                                                                                             3    4    5    6
                                                                                                              P          2           0
                          (ACTUAL)                          1    2          0    1     2                            1
                                     IRQB
                                                                                                    MISSING
                                                                                                                      PROCESSOR
                                                                                                    STOP BIT
                                                                                                                      INTERRUPT,
                                 NOTES: 1. FRAMING ERROR DOES NOT
                                                                                                                      FRAMING
                                           INHIBIT RECEIVER OPERATION
                                                                                                                      ERROR
                                                                                                                      BIT SET
                                        2. IF NEXT DATA WORD IS OK,
                                           FRAMING ERROR IS CLEARED
                                                                 Figure 13 Framing Error
                                                                                                                                                         20


Effect of DCDB on Receiver
DCDB is a modem output indicating the status of the carrier-frequency-detection circuit of the modem.
This line goes high for a loss of carrier. Normally, when this occurs, the modem will stop transmitting data
some time later. The ACIA asserts IRQB whenever DCDB changes state and indicates this condition via
bit 5 in the Status Register.
Once such a change of state occurs, subsequent transitions will not cause interrupts or changes in the
Status Register until the first interrupt is serviced. When the Status Register is read by the processor, the
ACIA automatically checks the level of the DCDB line, and if it has changed, another IRQB occurs (see
Figure 14).
                                                                       CONTINUOUS “MARK”
        RxD  B   B   B    B    P  Stop Start B     B B                                               P   Stop Start B  B   B   P Stop
               0   1  2     N                 0     1   2                                                            0  1    N
                                                    MODEM                                  MODEM
                                                    DELAY                                  DELAY
       DCDB
        IRQB
                                                                                                                          PROCESSOR
                                                                                                                          INTERRUPT
                              NORMAL                         AS LONG AS                                 NO INTERRUPT
                                                                                                                          FOR
                              PROCESSOR                      DCDB IS HIGH,                              WILL OCCUR
                                                                                                                          RECEIVER
                              INTERRUPT                      NO FURTHER                                 HERE, SINCE
                                                                                     PROCESSOR                            DATA
                                                             INTERRUPTS                                 RECEIVER IS
                                          PROCESSOR                                  INTERRUPT
                                                             FOR RECEIVER                               NOT ENABLED
                                          INTERRUPT                                  FOR DCDB
                                                             WILL OCCUR                                 UNTIL FIRST
                                          FOR DCDB                                   GOING LOW
                                                                                                        START BIT
                                          GOING HIGH
                                                                                                        DETECTED
                                         Figure 14 Effect of DCDB on Receiver
Timing with 1½ Stop Bits
It is possible to select 1½ Stop Bits, but this occurs only for 5-bit data words with no parity bit. In this
case, the IRQB asserted for Receiver Data Register Full occurs halfway through the trailing half-Stop Bit.
Figure 15 shows the timing relationship for this mode.
                                             CHAR # n                             CHAR # n+1
                                                                 1 1/2                              1 1/2
                            RxD     Start B0   B
                                                 1
                                                    B
                                                      2
                                                        B    B          Start B   B    B    B   B
                                                                                                  4 Stop
                                                          3    4 Stop           0   1    2    3
                           IRQB
                                                            PROCESSOR INTERRUPT
                                                            OCCURS HALFWAY
                                                            THROUGH THE ½ STOP
                                                            BIT
                                          Figure 15 Timing with 1½ Stop Bits
                                                                                                                                      21


Transmit Continuous “BREAK”
This mode is selected via the ACIA Command Register and causes the Transmitter to send continuous
“BREAK” characters, beginning with the next character transmitted. At least one full “BREAK” character
will be transmitted, even if the processor quickly reprograms the Command Register transmit mode.
Later, when the Command Register is programmed back to normal transmit mode, an immediate Stop Bit
will be generated and transmission will resume. Figure 16 shows the timing relationship for this mode.
Note:
If, while operating in the Transmit Continuous “BREAK” mode, the CTSB should go to a high, the TxD will
be overridden by the CTSB and will go to continuous “MARK” at the beginning of the next character
transmitted after the CTSB goes high.
         TxD     Stop Start B     B         B     P   Stop Start B     B         B   P  Stop            Stop Start B         B    P   Stop Start B      B
                              0     1         N                    0     1         N                                 0         N                   0      1
        IRQB
                                                                  PERIOD
                                                                  DURING WHICH
                                                                  PROCESSOR
                                                                  SELECTS
                                                                  CONTINUOUS                       POINT AT
                NORMAL                                            “BREAK” MODE                     WHICH             PROCESSOR
                INTERRUPT                                                                          PROCESSOR         INTERRUPT TO
                                                                                                   SELECTS           LOAD TRANSMIT
                                                                                                   NORMAL            DATA
                                                                                                   TRANSMIT
                                                                                                   MODE
                                               Figure 16 Transmit Continuous “BREAK”
Receive Continuous “BREAK”
In the event the modem transmits continuous “BREAK” characters, the ACIA will terminate receiving.
Reception will resume only after a Stop Bit is encountered by the ACIA. Figure 17 shows the timing
relationship for continuous “BREAK” characters.
                                                             CONTINUOUS “BREAK”
          RxD       B          B      P Stop Start B     B          B      P Stop               Stop Start B    B         B     P  Stop Start B     B
                      1          N                   0     1          N                                      0    1         N                   0     1
           IRQB
                                                                                       NO
                                                                                       MORE
                                                                                       INTERRUPTS
                                                                                                      NO INTERRUPT
                                                                  PROCESSOR INTERRUPT                                      NORMAL
                                                                                                      SINCE
                                    PROCESSOR                     WITH BREAK AND                                           RECEIVER
                                                                                                      RECEIVER
                                    INTERRUPT FOR                 FRAMING ERROR SET.                                       INTERRUPT
                                                                                                      DISABLED UNTIL
                                    RECEIVER DATA                 EVEN PARITY CHECK WILL              FIRST STOP BIT
                                    REGISTER FULL                 ALSO GIVE A PARITY
                                                                  ERROR BECAUSE ALL
                                                                  ZEROS (CONTINUOUS
                                                                  BREAK) REPRESENT
                                                                  EVEN PARITY.
                                               Figure 17 Receive Continuous “BREAK”
                                                                                                                                                            22


STATUS REGISTER OPERATION
Because of the special functions of the various status bits, there is a suggested sequence for checking
them. When an interrupt occurs, the ACIA should be interrogated as follows:
1. Read Status Register
This operation automatically clears Bit 7 (IRQB). Subsequent transitions on DSRB and DCDB will cause
another interrupt.
2. Check IRQB (Bit 7) in the data read from the Status Register.
If not set, the interrupt source is not the ACIA.
3. Check DCDB and DSRB
These must be compared to their previous levels, which must have been saved by the processor. If they
are both 0 (modem “on-line”) and they are unchanged then the remaining bits must be checked.
4. Check RDRF (Bit 3)
Check for Receiver Data Register Full.
5. Check Parity, Overrun and Framing Error (Bits 0-2) if the Receiver Data Register is full.
6. If none of the above conditions exist, then CTSB must have gone to the false (high) state.
PROGRAM RESET OPERATION
A program reset occurs when the processor performs a write operation to the ACIA with RS0 low and
RS1 high. The program reset operates somewhat different from the hardware reset (RESB pin) and is
described as follows:
1. Internal registers are not completely cleared. Check register formats for the effect of a program reset
on internal registers
2. The DTRB line goes high immediately.
3 Receiver and transmitter interrupts are disabled immediately. If IRQB is low when the reset occurs, it
stays low until serviced, unless interrupt was caused by DCDB or DSRB transition.
4. DCDB and DSRB interrupts are disabled immediately. If IRQB is low and was caused by DCDB or
DSRB, then it goes high, also DCDB and DSRB status bits subsequently will follow the input lines,
although no interrupt will occur.
5. Overrun cleared, if set.
MISCELLANEOUS
1. If Echo Mode is selected, RTSB goes low.
2. If Bit 0 of Command Register is 0 (disabled) then:
    a) All interrupts are disabled including those caused by DCDB and DSRB transitions.
    b) Transmitter is disabled immediately.
    c) Receiver is disabled, but a character currently being received will be completed first.
3. Odd parity occurs when the sum of all the 1 bits in the data word (including the parity bit) is odd.
4. In the receive mode, the received parity bit does not go into the Receiver Data Register, but generates
parity error or no parity error for the Status Register.
5. Transmitter and Receiver may be in full operation simultaneously. This is “full-duplex” mode.
6. If the RxD line inadvertently goes low and then high right after a Stop Bit, the ACIA does not interpret
this as a Start Bit, but samples the line again halfway into the bit to determine if it is a true Start Bit or a
false one. For false Start Bit detection, the ACIA does not begin to receive data, instead, only a true Start
Bit initiates receiver operation.
                                                                                                              23


7. Precautions to consider with the crystal oscillator circuit:
    a) The external crystal should be a “series” mode crystal.
    b) The XTLI input may be used as an external clock input. The unused pin (XTLO) must be floating
    and may not be used for any other function.
8. DCDB and DSRB transitions, although causing immediate processor interrupts, have no effect on
transmitter operation. Data will continue to be sent, unless the processor forces transmitter to turn off.
Since these are high-impedance inputs, they must not be permitted to float (un-connected). If unused,
they must be terminated either to GND or VCC.
GENERATION OF NON-STANDARD BAUD RATES
Divisors
The internal counter/divider circuit selects the appropriate divisor for the crystal frequency by means of
bits 0-3 of the ACIA Control Register, as shown in Table 2.
Generating Other Baud Rates
By using a different crystal, other baud rates may be generated. These can be determined by:
                      Crystal Frequency
    Baud Rate =
                           Divisor
Furthermore, it is possible to drive the ACIA with an off-chip oscillator to achieve other baud rates. In this
case, XTLI (Pin 6) must be the clock input and XTLO (pin 7) must be a no-connect.
                                                                                                           24


                              Table 2 Divisor Selection
  Control                                                                       Baud Rate
  Register   Divisor Selected                  Baud Rate
                                                                            Generated With a
    Bits      for the Internal              Generated With
                                                                                Crystal of
                  Counter                 1.8432MHz Crystal
3  2   1   0                                                                  Frequency (F)
0  0   0   0 No Divisor Selected     16 x External Clock at Pin RxC   16 x External Clock at Pin RxC
                                              1.8432x 106                            F
0  0   0   1       36,864                                     =50
                                                 36,864                          36,864
                                              1.8432x 106                            F
0  0   1   0       24,576                                     =75
                                                 24,576                          24,576
                                              1.8432x 106                            F
0  0   1   1       16,769                                     =109.92
                                                 16,769                          16,769
                                              1.8432x 106                            F
0   1 0    0       13,704                                     =134.51
                                                 13,704                          13,704
                                              1.8432x 106                            F
0   1 0    1       12,288                                    =150
                                                 12,288                          12,288
                                              1.8432x 106                            F
0  1   1   0        6,144                                    =300
                                                  6,144                           6,144
                                              1.8432x 106                            F
0   1 1    1        3,072                                    =600
                                                  3,072                           3,072
                                              1.8432x 106                            F
1  0   0   0        1,536                                    =1,200
                                                  1,536                           1,536
                                              1.8432x 106                            F
1  0   0   1        1,024                                    =1,800
                                                  1,024                           1,024
                                              1.8432x 106                            F
1  0   1   0         768                                     =2,400
                                                   768                              768
                                              1.8432x 106                            F
1  0   1   1         512                                     =3,600
                                                   512                              512
                                              1.8432x 106                            F
1  1   0   0         384                                     =4,800
                                                   384                              384
                                              1.8432x 106                            F
1  1   0   1         256                                     =7,200
                                                   256                              256
                                              1.8432x 106                            F
1  1   1   0         192                                     =9,600
                                                   192                              192
                                              1.8432x 106 =19,200                    F
1  1   1   1          96
                                                    96                               96
                                                                                                     25


DIAGNOSTIC LOOP-BACK OPERATING MODES
  A simplified block diagram for a system incorporating an ACIA is shown in Figure 18.
  It may be desirable to include in the system a facility for “loop-back” testing, of which there are two
  kinds.
  1.     Local Loop-Back
        Loop-back from the point of view of the processor. In this case, the Modem and Data Link must
        be effectively disconnected and the ACIA transmitter connected back to its own receiver, so that
        the processor can perform diagnostic checks on the system, excluding the actual data channel.
  2.    Remote Loop-back
        Loop-back from the point of view of the Data Link and Modem. In this case, the processor, itself,
        is disconnected and all received data is immediately retransmitted, so the system on the other
        end of the Data Link may operate independent of the local system.
  The ACIA does not contain automatic loop-back operating modes, but they may be implemented with
  the addition of a small amount of external circuitry. Figure 19 indicates the necessary logic to be used
  with the ACIA. The LBB line is the positive-true signal to enable local loop-back operation.
  Essentially, LLB = high does the following:
  1. Disables outputs TxD, DTRB and RTSB (to Modem)
  2. Disables inputs RxD, DCDB, CTSB, DSRB (from Modem)
  3. Connects transmitter outputs to respective receiver inputs (i,e., TxD to RxD, DTRB to DCDB, RTSB
  to CTSB).
  LLB may be tied to a peripheral control pin (from a W65C21 or W65C22S, for example) to provide
  processor control of local loop-back operation. In this way, the processor can easily perform local
  loop-back diagnostic testing.
  Remote loop-back does not require this circuitry, so LLB must be set low. However, the processor
  must select the following:
  1. Control Register bit 4 must be 1, so that the transmitter clock equals the receiver clock.
  2. Command Register bit 4 must be 1 to select Echo Mode.
  3. Command Register bits 3 and 2 must be 1 and 0, respectively to disable IRQB interrupt to
  transmitter.
  4. Command Register bit 1 must be 0 to disable IRQB interrupt for receiver.
  In this way, the system re-transmits received data without any effect on the local system.
                                                                                                        26


               MICRO-
             PROCESSOR
                       PROGRAM           SYSTEM                 I/O               W65C51S
                         ROM              RAM                 CONTROL                ACIA
                                                                I/O
                                                                                   MODEM
                                                                          TO DATA LINK
                                Figure 18 Simplified System Diagram
                                                W65C51S
                       RTSB DTRB TxD                            RxD DCDB CTSB DSRB
 LLB                                          SEL         1Y
                                                          2Y
                                              STB         3Y
                                                          4Y
                                                 74157
                                                                                                     RxD
                                              1B          1A
                                                                                                   DCDB
                                              2B          2A
                                                                                                   CTSB
                                              3B          3A
                                                                                                   DSRB
                                              4B          4A
                                                                                                          MODEM
                                                                                                      TxD
     SEL     1Y
                                                                                                   DTRB
             2Y
                                                                                                   RTSB
     STB     3Y
             4Y
       74157                                   Notes: 1. HIGH ON LLB SELECTS LOCAL LOOP-BACK MODE
+5   1B      1A                                       2. HIGH ON 74157 SELECT INPUT GATES “B” INPUTS TO
                                                         “Y” OUTPUTS; LOW GATES “A” TO “Y”.
     2B      2A
     3B      3A
     4B      4A
                               Figure 19 Loop-Back Circuit Schematic
                                                                                                              27


                 XTLI                                                         XTLI
                              Pin 6                                                  Pin 6
                                                                   FROM
                                                                 EXTERNAL
                                                                  CLOCK
                                      W65C51N                                                 W65C51N
                                                                OSCILLATOR
                        1MΩ
                                                                  OPEN
             XTLO                                                CIRCUIT     XTLO
                              Pin 7                           (NO CONNECT)           Pin 7
          30pF
                    INTERNAL CLOCK                                           EXTERNAL CLOCK
Figure 20a Clock Generation (Internal Clock Option)    Figure 20b Clock Generation (External Clock Option)
     *Pin Numbers for PDIP and PLCC only*                    *Pin Numbers for PDIP and PLCC only*
CRYSTAL AND CLOCK OPTIONS FOR XTLI/XTLO
   The W65C51N has an internal baud rate generator that drives asynchronous communications.
   XTLI and XTLO are the crystal input/output pins that are using for providing the clock system to the
   baud rate generator. Figure 20 shows two setup options for the baud rate generator clock. The
   Internal Clock setup (Figure 20a) is for a crystal with 1Mohm resistor and 30pF capacitor to drive the
   ACIA’s internal oscillator circuit. The external clock setup (Figure 20b) is for using an external clock
   oscillator output hooked to XTLI and XTLO is not connected.
                                                                                                             28


READ TIMING DIAGRAM
Timing diagrams for transmit with external clock, receive with external clock and IRQB generation are
shown in Figures 21, 22 and 23 respectively. The corresponding timing characteristics are listed in Table
3.
                                      Table 2 Transmit/Receive Characteristics
                                                              1 MHz            2 MHz
                              Characteristic   Symbol                                          Unit
                                                           Min     Max     Min      Max
                            Transmit/Receive    tCCY                                           nS
                                                          400*       -     400*      -
                            Clock Rate
                            Transmit/Receive     tCH                                           nS
                                                          175        -     175       -
                            Clock High Time
                            Transmit/Receive      tCL                                          nS
                                                          175        -     175       -
                            Clock Low Time
                            XTLI to TxD
                            Propagation          tDD        -      500       -      500        nS
                            Delay
                            RTS Propagation     tDLY                                           nS
                                                            -      500       -      500
                            Delay
                            IRQB Propagation     tIRQ                                          nS
                                                            -      500       -      500
                            Delay (Clear)
                            Notes:
                            1. (tR, tF = 10 to 30 nS)
                            *The baud rate with external clocking is: Baud Rate =       1
                                                                                     16 x tCCY
Test and Crystal Specifications
    1. Temperature stability ± 0.01% (-40° C to +85° C)
    2. Characteristics at 25° C ± 2° C
       a. Frequency (MHz)                      1.8432
       b. Frequency tolerance (± %) 0.02
       c. Resonance mode                       Series
       d. Equivalent resistance (ohm) 400 max.
       e. Drive level (mW)                     2
       f. Shunt capacitance (pF)               7 max.
       g. Oscillation mode                     Fundamental
                                                                                                      29


                                       tCCY
XTLI
(TRANSMIT                        tCH
CLOCK INPUT)
                                                  tCL
                                       tDD
          TxD
                   NOTE: TxD RATE IS 1/16 TxC RATE
             Figure 21 Transmit Timing with External Clock
                                 tCCY
                                           tCH
  RxC
  (INPUT)
                             tCL
                  NOTE: RxD RATE IS 1/16 RxC RATE
                Figure 22 Receive External Clock Timing
                    PHI2
                                                     tDLY
            DTRB, RTSB
                 IRQB                                tIRQ
               (CLEAR)
                   Figure 23 Interrupt and Output Timing
                                                           30


                                             Table 3 AC Characteristics
                                                                            2 MHz         4 MHz
                      Parameter                       Symbol                                       Units
                                                                       Min      Max  Min       Max
        PHI2 Cycle Time                                  tCYC          500        -  250         -  nS
        PHI2 Pulse Width                                   tC          200        -  100         -  nS
        Address Set-Up Time                               tAC           60        -   30         -  nS
        Address Hold Time                                tCAH           0         -   0          -  nS
        RWB Set-Up Time                                   tWC           60        -   30         -  nS
        RWB Hold Time                                    tCWH           0         -   0          -  nS
        Data Bus Set-Up time                             tDCW           60        -   35         -  nS
        Data Bus Hold Time                                tHW           10        -   5          -  nS
        Read Access Time (Valid Data)                    tCDR            -       150   -        50  nS
        Read Hold Time                                    tHR           10        -   10         -  nS
        Bus Active Time (Invalid Data)                   tCDA           20        -   10         -  nS
         Notes:
         1. VCC = 5.0V ± 5%
         2. TA = TL to TH
         3. tR and tF = 10 to 30 nSs.
                                   tR                             tCYC
                                                   tC                   tF                               VIH
              PHI2                                                                                       VIL
                                 tACW                                   tCAH
                                                                                                         VIH
CS0, CS1B, RS0 RS1
                                                                                                         VIL
                                  tWCW
             RWB                                                          tCWH                           VIH
                                                                                                         VIL
                                                             tDCW          tHW
                                                                                                          VIH
        DATA BUS
                                                                                                          VIL
                                          Figure 24 Write Timing Diagram
                                                                                         VIH
                            RWB                                                          VIL
                                           tWCR        tCDR              tHR
                                                  tCDA
                       DATABUS
                                       Figure 25 Read Timing Characteristics
                                                                                                              31


ABSOLUTE MAXIMUM RATINGS*                                                 OPERATING CONDITIONS
                                                                          Parameter     Symbo              Value
   Parameter          Symbo              Value             Unit                             l
                          l
                                                                        Supply Voltage    VCC            5V ± 5%
Supply Voltage         VCC           -0.3 to +7.0V         Vdc
                                                                        Operating          TA
Input Voltage           VIN        -0.3 to VCC +0.3        Vdc          Temp.                           0 to +70°C
                                                                           Commercial                -40°C to +85°C
Output Voltage         VOUT       -0.3 to VCC +0.3V        Vdc             Industrial
Operating                TA                                 °C
Temp.                                   0 to +70
   Commercial                          -40 to +85
   Industrial
Storage Temp.          T STG          -55 to +150           °C
* NOTE: Stresses above those listed may cause permanent damage to the device. This is a stress rating only and functional
operation of the device at these or any other conditions above those indicated in other sections of this document is not implied.
Exposure to absolute maximum rating conditions for extended periods may affect device reliability.
DC CHARACTERISTICS
(VCC = 5.0V + 5%, VSS = 0, TA = TL to TH, unless otherwise noted)
                                                                                                                          Test
                     Parameter                        Symbol      Min           Typ    Max         Unit
                                                                                                                      Conditions
    Input High Voltage                                VIH         2.0           --     VCC         V
    Input Low Voltage                                 VIL         -0.3          --     +0.8        V
    Input Leakage Current
       CS0, CS1B, CTSB, DCDB, DSRB,                                                                                VIN = 0V to VCC
                                                      IIN         --            +1     ±2.5        µA
    PHI2,                                                                                                          VCC = 5.25V
       RESB, RS0, RS1, RWB, RxD
                                                                                                                   VIN = 0.4V to
    Leakage Current (Three State Off)
                                                      ITSI        --            +2     ±10         µA              2.4V
       D0-D7
                                                                                                                   VCC = 5.25V
    Output High Voltage                                                                                            VCC = 4.75V
                                                      VOH         2.4           --     --          V
       D0-D7, DTRB, RTSB, RxC, TxD                                                                                 ILOAD = -100 µA
    Output Low Voltage
                                                                                                                   VCC = 4.75V
       D0-D7, DTRB , IRQB, RTSB, RxC,                 VOL         --            --     0.4         V
                                                                                                                   ILOAD = 1.6 mA
    TxD,
    Output High Current (Sourcing)
                                                      IOH         -200          -400   --          µA              VOH = 2.4V
       D0-D7, DTRB, RTSB, RxC, TxD
    Output Low Current (Sinking)
       D0-D7, DTRB , IRQB, RTSB, RxC,                 IOL         1.6           --     --          mA              VOL = 0.4V
    TxD,
    Output Leakage Current (off state): IRQB          IOFF        --                   10          µA              VOUT = 5.0V
    Power Dissipation                                 PD          --            7      10          mW/MHz
                                                                                                                   VCC = 5.0V
    Input Capacitance
                                                      CCLK        --                   20          pF              VIN = 0V
       All except PHI2
                                                      CIN         --                   10          pF              f = 2 MHz
       PHI2                                                                                                                ○
                                                                                                                   TA = 25 C
    Output Capacitance                                COUT        --                   10          pF
    Notes:
    1. All units are direct current (dc) except for capacitance.
    2. Negative sign indicates outward current flow, positive indicates inward flow.
                                                                ○
    3. Typical values are shown for VCC = 5.0V and TA = 25 C
                                                                                                                                   32


                                              (.550)
       PIN NO.1                               (.530)
        IDENT.
                                              (.160)
                                              (.140)
                   (1.470)                                 (.610)
                   (1.440)                                 (.590)
                                                                  (.015)
                                                                  (.008)
                 (.065)                                    (.700)
                 (.045)                                    (.600)
                 (.023)
(.085)                     .032 REF. (.110) (.150) (.060)
                 (.015)              (.090)
(.065)                                      (.125) (.020)
               Figure 26 - 28 Pin Plastic Dip Package Dimensions
                  Figure 27 - 28 Pin PLCC Package Dimensions
                                                                         33


                  Figure 28 - 32 Pin Low-Profile Quad Flat Pack (LQFP) Package Dimensions
W65C51N6TXG-14 Errata Sheet for Silicon Lot Code: A6A749.1
The information below describes the current known function discrepancy current
W65C51N6T (Lot Code A6A749.1) devices found by WDC. Please contact WDC with
any other errors found.
Transmitter Parity
The transmitter of this part functions differently than previous 6551/65C51 devices. For
all Parity Mode Control (PMC) settings (Bits 7, 6 of the Command Register), the
transmitter will transmit a MARK (1) for Parity (When enabled with Bit 5 of the
Command Register set to “1”). Previous versions would transmit Even, Odd, Mark or
Space parity depending on the PMC bits.
Baud Rate Generator Feedback Resistor
The W65C51N needs to have a 1Mohm resistor between XTLI and XTLO (see Figure
20A). This was not needed on the W65C51S and some older chips.
Transmitter Data Register Empty
The W65C51N will not properly set Bit 4 of the Status Register to indicate the
Transmitter Data Register is empty. Determining when to send the next byte would
need to be done by using the transmit interrupt or having a software delay loop based
on the baud rate used.
                                                                                          34


ORDERING INFORMATION
                                    Example: W65C51N6TPG-14
           Description                                                                   W65C
           W65C = standard product
           Product Identification Number                                                  51N
           Foundry Process
            6T = 0.6u TSMC Process                                                         6T
           Package
           P = Plastic Dual-In-Line, 28 pins                                                 P
           PL = Plastic Lead Chip Carrier, 28 pins
           Q = Quad Flat Pack, 32 pins
           RoHS/Green Compliance
           G = RoHS/Green Compliant (Wafer and Packaging)                                    G
           Speed Designator
           -14 = 14MHz                                                                     -14
 ___________________________________________________________________
To receive general sales or technical support on standard product or information about our module library
licenses, contact us at:
                                  The Western Design Center, Inc.
                                         2166 East Brown Road
                                       Mesa, Arizona 85213 USA
                          Phone: 480-962-4545 Fax: 480-835-6442
                              e-mail: Info@WesternDesignCenter.com
                                   www.WesternDesignCenter.com
                                          www.WDC65xx.com
   ____________________________________________________________________
WARNING: MOS CIRCUITS ARE SUBJECT TO DAMAGE FROM STATIC ELECTRICAL CHARGE
BUILDUPS. Industry established recommendations for handling MOS circuits include:
1.     Ship and store product in conductive shipping tubes or conductive foam plastic. Never ship or store
       product in non-conductive plastic containers or non-conductive plastic foam material.
2.     Handle MOS parts only at conductive workstations.
3.     Ground all assembly and repair tools.
                                                                                                          35


Mouser Electronics
Authorized Distributor
Click to View Pricing, Inventory, Delivery & Lifecycle Information:
Western Design Center (WDC):
 W65C51N6TPG-14 W65C51N6TPLG-14
