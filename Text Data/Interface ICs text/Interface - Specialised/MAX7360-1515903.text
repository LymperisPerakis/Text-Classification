                                                                                                       EVALUATION KIT AVAILABLE
Click here for production status of specific part numbers.
MAX7360                                                  I2C-Interfaced Key-Switch Controller and LED
                                                           Driver/GPIOs with Integrated ESD Protection
General Description                                                Features
The MAX7360 I2C-interfaced peripheral provides                     ●● Integrated ESD Protection
microprocessors with management of up to 64 key                       • ±8kV IEC 61000-4-2 Contact Discharge
switches, with an additional eight LED drivers/GPIOs                  • ±15kV IEC 61000-4-2 Air-Gap Discharge
that feature constant-current, PWM intensity control, and          ●● +14V Tolerant, Open-Drain I/O Ports Capable of
rotary switch control options.                                        Constant-Current LED Drive
The key-switch drivers interface with metallic or resistive        ●● Rotary Switch-Capable Input Pair (PORT6, PORT7)
switches with on-resistances up to 5kΩ. Key inputs are             ●● 256-Step PWM Individual LED Intensity Control
monitored statically, not dynamically, to ensure low-              ●● Individual LED Blink Rates and Common LED
EMI operation. The MAX7360 features autosleep and                     Fade In/Out Rates from 256ms to 4096ms
autowake modes to further minimize the power consumption
                                                                   ●● FIFO Queues Up to 16 Debounced Key Events
of the device. The autosleep feature puts the device in a
low-power state (1µA, typ) after a sleep timeout period.           ●● User-Configurable Key Debounce (9ms to 40ms)
The autowake feature configures the MAX7360 to return              ●● Keyscan Uses Static Matrix Monitoring for Low
to normal operating mode from sleep upon a keypress.                  EMI Operation
                                                                   ●● +1.62V to +3.6V Operation
The key controller debounces and maintains a FIFO of
keypress and release events (including autorepeat, if              ●● Monitors Up to 64 Keys
enabled). An interrupt (INTK) output can be configured to          ●● Key-Switch Interrupt (INTK) on Each Debounced
alert keypresses, as they occur, or at maximum rate.                  Event/FIFO Level, or End of Definable Time Period
There are eight open-drain I/O ports, which can be used            ●● Port Interrupt (INTI) for Input Ports for Special-Key
to drive LEDs. The maximum constant-current level for                 Functions
each open-drain port is 20mA. The intensity of the LED             ●● 400kbps, +5.5V Tolerant 2-Wire Serial Interface
on each open-drain port can be individually adjusted                  with Selectable Bus Timeout
through a 256-step PWM control. An input port pair                 ●● Four I2C Address Choices
(PORT6, PORT7) can be configured to accept 2-bit gray
code inputs from a rotary switch. In addition, if not used         Ordering Information
for key-switch control, up to six column pins can be used
                                                                         PART            TEMP RANGE          PIN-PACKAGE
as general-purpose open-drain outputs (GPOs) for LED
                                                                    MAX7360ETL+          -40°C to +85°C      40 TQFN-EP*
drive or logic control.
                                                                    MAX7360EWX+          -40°C to +85°C      36 WLP
The MAX7360 is offered in a 40-pin (5mm x 5mm) thin
                                                                   +Denotes a lead(Pb)-free/RoHS-compliant package.
QFN package with an exposed pad, and a small 36-bump               *EP = Exposed pad.
wafer level package (WLP) for cell phones, pocket PCs,
and other portable consumer electronic applications. The
                                                                   Simplified Block Diagram
MAX7360 operates over the -40°C to +85°C extended
temperature range.                                                                         +1.8V
                                                                                                                     +14V
                                                                                                            ROTARY
Applications                                                                 TO
                                                                             µC
                                                                                  SCL                       SWITCH
                                                                                  SDA              PORT7
●●  Cell Phones                                                                   INTI             PORT6
●●  PDAs                                                                          INTK
●●  Handheld Games                                                                     MAX7360
                                                                                                   PORT0
●●  Portable Consumer Electronics
                                                                                  AD0            ROW_(8x)
●●  Printers
●●  Instrumentation                                                                               COL_(8x)
                                                                                                                 8x8
19-4566; Rev 3; 7/19


MAX7360                                                                             I2C-Interfaced Key-Switch Controller and LED
                                                                                      Driver/GPIOs with Integrated ESD Protection
Absolute Maximum Ratings
VCC to GND.............................................................-0.3V to +4V                   Storage Temperature Range............................. -65°C to +150°C
COL0–COL7, ROW0–ROW7 to GND......................-0.3V to +4V                                         ESD Protection
SDA, SCL, AD0, INTI, INTK to GND........................-0.3V to +6V                                      Human Body Model (RD = 1.5kΩ, CS = 100pF)
PORT0–PORT7 to GND........................................-0.3V to +16V                                   All Pins..............................................................................±2kV
All Other Pins to GND............................... -0.3V to (VCC + 0.3V)                            IEC 61000-4-2 (RD = 330Ω, CS = 150pF)
DC Current on PORT0–PORT7, COL2–COL7...................25mA                                               Contact Discharge
GND Current.......................................................................80mA                    ROW0–ROW7, COL0–COL7, PORT0–PORT7 to GND.....±8kV
Continuous Power Dissipation (TA = +70°C)                                                                 Air-Gap Discharge
    TQFN (derate 22.2mW/NC above +70°C).................1777mW                                            ROW0–ROW7, COL0–COL7, PORT0–PORT7 to GND....±15kV
    WLP (derate 21.7mW/NC above +70°C)...................1739mW                                       Lead Temperature (TQFN only; soldering, 10s)............... +300°C
Operating Temperature Range............................ -40°C to +85°C                                Soldering Temperature (reflow)........................................ +260°C
Junction Temperature.......................................................+150°C
Stresses beyond those listed under “Absolute Maximum Ratings” may cause permanent damage to the device. These are stress ratings only, and functional operation of the device at these
or any other conditions beyond those indicated in the operational sections of the specifications is not implied. Exposure to absolute maximum rating conditions for extended periods may affect
device reliability.
Package Thermal Characteristics (Note 1)
TQFN                                                                                                  WLP
    Junction-to-Ambient Thermal Resistance (θJA)...........45°C/W                                         Junction-to-Ambient Thermal Resistance (θJA)WLP..... 46°C/W
    Junction-to-Case Thermal Resistance (θJC)..................2°C/W
Note 1: Package thermal resistances were obtained using the method described in JEDEC specification JESD51-7, using a four-layer
             board. For detailed information on package thermal considerations, refer to www.maximintegrated.com/thermal-tutorial.
Electrical Characteristics
(VCC = +1.62V to +3.6V, TA = -40°C to +85°C, unless otherwise noted. Typical values are at VCC = +3.3V, TA = +25°C.) (Notes 2, 3)
                   PARAMETER                          SYMBOL                                   CONDITIONS                                       MIN            TYP           MAX            UNITS
 Operating Supply Voltage                                VCC                                                                                    1.62            3.3            3.6              V
 External Supply Voltage
                                                       VPORT_                                                                                                                  14               V
 PORT0–PORT7
                                                                        All key switches open, oscillator running,
                                                                        COL2–COL7 configured as key switches,                                                   34             50
 Operating Supply Current                                 ICC           VPORT_ = VCC                                                                                                           µA
                                                                                                                                                               34 +
                                                                        N keys pressed
                                                                                                                                                             20 x N
 Sleep-Mode Supply Current                                ISL                                                                                                   1.3             3              µA
 Key-Switch Source Current                               IKEY                                                                                                   20             35              µA
 Key-Switch Source Voltage                              VKEY                                                                                                   0.43            0.5              V
 Key-Switch Resistance                                  RKEY            (Note 4)                                                                                                5              kΩ
 Startup Time from Shutdown                            tSTART                                                                                                    2             2.4             ms
 Output Low Voltage
                                                          VOL           ISINK = 10mA                                                                                           0.5              V
 COL2–COL7
 Oscillator Frequency                                                   TA = +25°C, VCC = +2.61V                                                125            128            131
                                                         fOSC                                                                                                                                 kHz
 (PWM Clock)                                                            TA = TMIN to TMAX, VCC ≤ 3.6V                                           102                           164
 Oscillator Frequency Variation                         ΔfOSC           TA = +25°C                                                                -7                          +14              %
 Key-Scan Frequency                                      fKEY           Derived from oscillator clock                                                           64                            kHz
www.maximintegrated.com                                                                                                                                                 Maxim Integrated │ 2


MAX7360                                                I2C-Interfaced Key-Switch Controller and LED
                                                         Driver/GPIOs with Integrated ESD Protection
Electrical Characteristics (continued)
(VCC = +1.62V to +3.6V, TA = -40°C to +85°C, unless otherwise noted. Typical values are at VCC = +3.3V, TA = +25°C.) (Notes 2, 3)
           PARAMETER                SYMBOL                    CONDITIONS                       MIN      TYP     MAX      UNITS
 GPIO SPECIFICATIONS
 Input High Voltage                                                                           0.7 x
                                        VIH                                                                                 V
 PORT0–PORT7                                                                                   VCC
 Input Low Voltage                                                                                              0.3 x
                                        VIL                                                                                 V
 PORT0–PORT7                                                                                                    VCC
 Input Leakage Current                         VIN ≤ VCC                                      -0.25            +0.25
                                        IIN                                                                                 µA
 PORT0–PORT7                                   VCC < VIN                                        -1               +5
 Output Low Voltage
                                       VOL     ISINK < 20mA                                                      0.6        V
 PORT0–PORT7
 Input Capacitance
                                                                                                         20                 pF
 PORT0–PORT7
 10mA Port Sinking Current                     VCC = +1.62V to +3.6V, TA = +25°C               8.55            11.52
                                                                                                                           mA
 PORT0–PORT7                                   VCC = +3.3V, VOL = +1V                          8.67    9.76    10.51
 20mA Port Sinking Current                     VCC = +1.62V to +3.6V, TA = +25°C              19.40            21.33
                                                                                                                           mA
 PORT0–PORT7                                   VCC = +3.3V, VOL = +1V                         19.55      20    20.69
                                               VCC = +3.3V, VOL = +1V, TA = +25°C, 20mA
 Port Sink Current Variation                                                                           ±1.5     ±2.4        %
                                               output mode
 Output Logic-Low Voltage
                                               ISINK = 10mA                                                      0.6        V
 INTI, INTK
 PWM Frequency                        fPWM     Derived from oscillator clock                            500                 Hz
 SERIAL-INTERFACE SPECIFICATIONS
 Input High Voltage                                                                           0.7 x
                                        VIH                                                                                 V
 SDA, SCL, AD0                                                                                 VCC
 Input Low Voltage                                                                                              0.3 x
                                        VIL                                                                                 V
 SDA, SCL, AD0                                                                                                  VCC
 Input Leakage Current                         VIN ≤ VCC                                      -0.25            +0.25
                                        IIN                                                                                 µA
 SDA, SCL, AD0                                 VIN > VCC                                       -0.5             +0.5
 Output Low Voltage
                                       VOL     ISINK = 6mA                                                       0.6        V
 SDA
 Input Capacitance
                                        CIN                                                              10                 pF
 SDA, SCL, AD0
 I2C TIMING SPECIFICATIONS
 SCL Serial-Clock Frequency            fSCL    Bus timeout disabled                              0              400        kHz
 Bus Free Time Between a STOP
                                       tBUF                                                     1.3                         µs
 and START Condition
 Hold Time (Repeated) START
                                    tHD, STA                                                    0.6                         µs
 Condition
 Repeated START Condition
                                    tSU, STA                                                    0.6                         µs
 Setup Time
 STOP Condition Setup Time          tSU, STO                                                    0.6                         µs
www.maximintegrated.com                                                                                      Maxim Integrated │ 3


MAX7360                                                    I2C-Interfaced Key-Switch Controller and LED
                                                            Driver/GPIOs with Integrated ESD Protection
Electrical Characteristics (continued)
(VCC = +1.62V to +3.6V, TA = -40°C to +85°C, unless otherwise noted. Typical values are at VCC = +3.3V, TA = +25°C.) (Notes 2, 3)
            PARAMETER                  SYMBOL                    CONDITIONS                       MIN       TYP     MAX       UNITS
 Data Hold Time                        tHD, DAT   (Note 5)                                                           0.9         µs
 Data Setup Time                       tSU, DAT                                                   100                            ns
 SCL Clock Low Period                    tLOW                                                      1.3                           µs
 SCL Clock High Period                   tHIGH                                                     0.7                           µs
 Rise Time of Both SDA and SCL                                                                              20 +
                                           tR     (Notes 4, 6)                                                       300         ns
 Signals, Receiving                                                                                        0.1Cb
 Fall Time of Both SDA and SCL                                                                              20 +
                                           tF     (Notes 4, 6)                                                       300         ns
 Signals, Receiving                                                                                        0.1Cb
 Fall Time of SDA Signal,                                                                                   20 +
                                         tF, TX   (Notes 4, 7)                                                       250         ns
 Transmitting                                                                                              0.1Cb
 Pulse Width of Spike Suppressed          tSP     (Notes 4, 8)                                               50                  ns
 Capacitive Load for Each Bus Line         Cb     (Note 4)                                                           400         pF
Note  2: All parameters are tested at TA = +25°C. Specifications over temperature are guaranteed by design.
Note  3: All digital inputs at VCC or GND.
Note  4: Guaranteed by design.
Note  5: A master device must provide a hold time of at least 300ns for the SDA signal (referred to VIL of the SCL signal) to bridge
         the undefined region of SCL’s falling edge.
Note 6: Cb = total capacitance of one bus line in pF. tR and tF measured between +0.3VCC and +0.7VCC.
Note 7: ISINK ≤ 6mA.
Note 8: Input filters on the SDA, SCL, and AD0 inputs suppress noise spikes less than 50ns.
www.maximintegrated.com                                                                                          Maxim Integrated │ 4


MAX7360                                                                                                                                                            I2C-Interfaced Key-Switch Controller and LED
                                                                                                                                                                    Driver/GPIOs with Integrated ESD Protection
Typical Operating Characteristics
(VCC = +2.5V, TA = +25°C, unless otherwise noted.)
                                         GPO OUTPUT LOW VOLTAGE                                                                                                  GPO OUTPUT LOW VOLTAGE                                                                                          GPO OUTPUT LOW VOLTAGE
                                       vs. SINK CURRENT (COL2–COL7)                                                                                            vs. SINK CURRENT (COL2–COL7)                                                                                    vs. SINK CURRENT (COL2–COL7)
                          250                                                                                                                    250                                                                                                               250
                                                                                               MAX7360 toc01                                                                                                      MAX7360 toc02                                                                                                           MAX7360 toc03
                                      VCC = 2.4V                                                                                                             VCC = 3.0V                                                                                                      VCC = 3.6V
                                                              TA = +85°C                                                                                                               TA = +85°C
                          200                                                                                                                    200                                                                                                               200                                   TA = +85°C
OUTPUT VOLTAGE (mV)                                                                                            OUTPUT VOLTAGE (mV)                                                                                                 OUTPUT VOLTAGE (mV)
                          150                         TA = +25°C                                                                                 150                           TA = +25°C                                                                          150                         TA = +25°C
                          100                                                                                                                    100                                                                                                               100
                                                                                TA = -40°C
                           50                                                                                                                     50                                                 TA = -40°C                                                     50                                                       TA = -40°C
                           0                                                                                                                       0                                                                                                                 0
                                 0               5            10                15           20                                                         0                5             10           15         20                                                        0              5                10                 15         20
                                                     SINK CURRENT (mA)                                                                                                       SINK CURRENT (mA)                                                                                              SINK CURRENT (mA)
                                                 SUPPLY CURRENT                                                                                                KEY-SWITCH SOURCE CURRENT                                                                                       SHUTDOWN SUPPLY CURRENT
                                                vs. SUPPLY VOLTAGE                                                                                                 vs. SUPPLY VOLTAGE                                                                                             vs. SUPPLY VOLTAGE
                           45                                                                                                                    18.4                                                                                                              3.0
                                                                                             MAX7360 toc04                                                                                                        MAX7360 toc05                                                                                                           MAX7360 toc06
                                  AUTOSLEEP = OFF                                                                                                           VCOL0 = O
                                                                                                                                                 18.3
                                                                                                                 KEY-SWITCH SOURCE CURRENT (A)                                                                                       SHUTDOWN SUPPLY CURRENT (A)
                           40                                                                                                                                                TA = -40NC, +85°C                                                                     2.5
                                                                  TA = +85°C                                                                     18.2                                                                                                                                                          TA = -40°C
SUPPLY CURRENT (A)
                                                                                                                                                 18.1
                           35                                                                                                                                                                                                                                      2.0
                                                                                                                                                 18.0                                               TA = +25°C
                           30              TA = +25°C                                                                                            17.9 TA = +85°C                                                                                                   1.5                  TA = +25°C
                                                                                                                                                 17.8
                                                                                                                                                                                    TA = -40°C
                           25                                                                                                                                                                                                                                      1.0
                                                                                                                                                 17.7
                                                                      TA = -40°C
                                                                                                                                                 17.6                                                                                                                                                                 TA = +85°C
                           20                                                                                                                                                                                                                                      0.5
                                                                                                                                                 17.5            TA = -40°C, +25°C
                           15                                                                                                                    17.4                                                                                                                0
                                1.6        2.0          2.4         2.8              3.2   3.6                                                          1.6        2.0           2.42.8     3.2                3.6                                                       1.6      2.0              2.4          2.8          3.2       3.6
                                                 SUPPLY VOLTAGE (V)                                                                                                      SUPPLY VOLTAGE (V)                                                                                              SUPPLY VOLTAGE (V)
                                  CONSTANT-CURRENT GPIO OUTPUT                                                                                            CONSTANT-CURRENT GPIO OUTPUT                                                                                     CONSTANT-CURRENT GPIO OUTPUT
                                 SINK CURRENT vs. OUTPUT VOLTAGE                                                                                         SINK CURRENT vs. OUTPUT VOLTAGE                                                                                  SINK CURRENT vs. OUTPUT VOLTAGE
                           25                                                                                                                      25                                                                                                               25
                                                                                              MAX7360 toc07                                                                                                        MAX7360 toc08                                                                                                          MAX7360 toc09
                                      VCC = 2.4V                                                                                                              VCC = 3.0V                                                                                                     VCC = 3.6V
                           20                                                                                                                      20                                                                                                               20
                                                     TA = -40°C                                                                                                               TA = -40°C                                                                                                     TA = -40°C
      SINK CURRENT (mA)                                                                                                   SINK CURRENT (mA)                                                                                                SINK CURRENT (mA)
                           15               TA = +25°C                                                                                             15                TA = +25°C                                                                                     15              TA = +25°C
                                          TA = +85°C                                                                                                               TA = +85°C                                                                                                     TA = +85°C
                           10                                                                                                                      10                                                                                                               10
                            5                                                                                                                       5                                                                                                                5
                            0                                                                                                                       0                                                                                                                0
                                 0        0.5         1.0     1.5         2.0        2.5   3.0                                                           0        0.5         1.0      1.5    2.0        2.5   3.0                                                       0       0.5         1.0         1.5          2.0        2.5   3.0
                                                 OUTPUT VOLTAGE (V)                                                                                                      OUTPUT VOLTAGE (V)                                                                                             OUTPUT VOLTAGE (V)
www.maximintegrated.com                                                                                                                                                                                                                                                                                  Maxim Integrated │ 5


MAX7360                                                              I2C-Interfaced Key-Switch Controller and LED
                                                                      Driver/GPIOs with Integrated ESD Protection
Pin Configurations
                                  TOP VIEW           N.C.   I.C.   AD0    N.C.   VCC   GND    INTI   INTK   SCL    SDA
                                                     30 29 28 27 26 25 24 23 22 21
                                      PORT0 31                                                                            20 N.C.
                                      PORT1 32                                                                            19 COL7
                                      PORT2 33                                                                            18 COL6
                                      PORT3 34                                                                            17 COL5
                                       GND 35                                                                             16 COL4
                                                                               MAX7360
                                      PORT4 36                                                                            15 GND
                                      PORT5 37                                                                            14 COL3
                                      PORT6 38                                                                            13 COL2
                                      PORT7 39                                                            EP*             12 COL1
                                           N.C. 40     +                                                                  11 COL0
                                                      1      2      3      4      5     6      7      8      9     10
                                                     ROW0   ROW1   ROW2   ROW3   GND   ROW4   ROW5   ROW6   ROW7
                                                                                                                   N.C.
                                                                                 TQFN
                                              *EP = EXPOSED PAD, CONNECT EP TO GROUND.
                             TOP VIEW
                          BUMP IN BOTTOM                                       MAX7360
                                           ROW0        PORT6              PORT4             PORT3            PORT1          PORT0
                                            A1              A2              A3                A4                  A5          A6
                                           ROW1        PORT7              PORT5               GND            PORT2           AD0
                                            B1              B2              B3                B4                  B5          B6
                                           ROW3           GND             ROW2                I.C.               N.C.        VCC
                                            C1              C2              C3                C4                 C5           C6
                                           ROW4        ROW5               COL2                INTK               GND         INTI
                                            D1              D2              D3                D4                 D5           D6
                                           ROW6        COL0                GND              COL5              COL7           SCL
                                            E1              E2              E3                E4                  E5          E6
                                           ROW7        COL1               COL3              COL4              COL6           SDA
                                            F1              F2              F3                F4                  F5          F6
                                                                          WLP
                                                                     (2.6mm x 2.6mm)
www.maximintegrated.com                                                                                                             Maxim Integrated │ 6


MAX7360                                          I2C-Interfaced Key-Switch Controller and LED
                                                  Driver/GPIOs with Integrated ESD Protection
Pin Description
             PIN
                         NAME                                            FUNCTION
   TQFN            WLP
      1             A6   ROW0    Row Input from Key Matrix. Leave ROW0 unconnected or connect to GND if unused.
      2             B6   ROW1    Row Input from Key Matrix. Leave ROW1 unconnected or connect to GND if unused.
      3             C4   ROW2    Row Input from Key Matrix. Leave ROW2 unconnected or connect to GND if unused.
      4             C6   ROW3    Row Input from Key Matrix. Leave ROW3 unconnected or connect to GND if unused.
   5, 15,        B4, C5,
                          GND    Ground
   25, 35         D2, E4
      6             D6   ROW4    Row Input from Key Matrix. Leave ROW4 unconnected or connect to GND if unused.
      7             D5   ROW5    Row Input from Key Matrix. Leave ROW5 unconnected or connect to GND if unused.
      8             E6   ROW6    Row Input from Key Matrix. Leave ROW6 unconnected or connect to GND if unused.
      9             D4   ROW7    Row Input from Key Matrix. Leave ROW7 unconnected or connect to GND if unused.
 10, 20, 27,
                    C2     N.C.  No Connection. Not internally connected. Leave unconnected.
   30, 40
     11             F6    COL0   Column Output to Key Matrix. Leave COL0 unconnected if unused.
     12             E5    COL1   Column Output to Key Matrix. Leave COL1 unconnected if unused.
                                 Column Output to Key Matrix. Leave COL2 unconnected if unused. COL2 can be
     13             F5    COL2
                                 configured as a GPO (see Table 9 in the Register Tables section).
                                 Column Output to Key Matrix. Leave COL3 unconnected if unused. COL3 can be
     14             F4    COL3
                                 configured as a GPO (see Table 9 in the Register Tables section).
                                 Column Output to Key Matrix. Leave COL4 unconnected if unused. COL4 can be
     16             F3    COL4
                                 configured as a GPO (see Table 9 in the Register Tables section).
                                 Column Output to Key Matrix. Leave COL5 unconnected if unused. COL5 can be
     17             E3    COL5
                                 configured as a GPO (see Table 9 in the Register Tables section).
                                 Column Output to Key Matrix. Leave COL6 unconnected if unused. COL6 can be
     18             F2    COL6
                                 configured as a GPO (see Table 9 in the Register Tables section).
                                 Column Output to Key Matrix. Leave COL7 unconnected if unused. COL7 can be
     19             F1    COL7
                                 configured as a GPO (see Table 9 in the Register Tables section).
     21             E2     SDA   I2C-Compatible, Serial-Data I/O
     22             E1     SCL   I2C-Compatible, Serial-Clock Input
     23             D3    INTK   Active-Low Key-Switch Interrupt Output. INTK is open drain and requires a pullup resistor.
     24             D1     INTI  Active-Low GPI Interrupt Output. INTI is open drain and requires a pullup resistor.
     26             C1     VCC   Positive Supply Voltage. Bypass VCC to GND with a 0.1µF or higher ceramic capacitor.
     28             B1     AD0   Address Input. AD0 selects up to four device slave addresses (Table 3).
     29             A1      I.C. Internally Connected. Connect to GND for normal operation.
                                 GPIO Port. Open-drain I/O rated at +14V. PORT0 can be configured as a constant-current
     31             B2   PORT0
                                 output.
                                 GPIO Port. Open-drain I/O rated at +14V. PORT1 can be configured as a constant-current
     32             A2   PORT1
                                 output.
                                 GPIO Port. Open-drain I/O rated at +14V. PORT2 can be configured as a constant-current
     33             B3   PORT2
                                 output.
                                 GPIO Port. Open-drain I/O rated at +14V. PORT3 can be configured as a constant-current
     34             A3   PORT3
                                 output.
www.maximintegrated.com                                                                                 Maxim Integrated │ 7


MAX7360                                        I2C-Interfaced Key-Switch Controller and LED
                                                 Driver/GPIOs with Integrated ESD Protection
Pin Description (continued)
            PIN
                        NAME                                        FUNCTION
   TQFN           WLP
                              GPIO Port. Open-drain I/O rated at +14V. PORT4 can be configured as a constant-current
     36             A4  PORT4
                              output.
                              GPIO Port. Open-drain I/O rated at +14V. PORT5 can be configured as a constant-current
     37             C3  PORT5
                              output.
                              GPIO Port. Open-drain I/O rated at +14V. PORT6 can be configured as a constant-current
     38             A5  PORT6
                              output, or a rotary switch input.
                              GPIO Port. Open-drain I/O rated at +14V. PORT7 can be configured as a constant-current
     39             B5  PORT7
                              output, or a rotary switch input.
                              Exposed Pad (TQFN only). EP is internally connected to GND. Connect EP to a ground
     —              —    EP
                              plane to increase thermal performance.
www.maximintegrated.com                                                                          Maxim Integrated │ 8


MAX7360                                               I2C-Interfaced Key-Switch Controller and LED
                                                        Driver/GPIOs with Integrated ESD Protection
Functional Block Diagram
                                                                                              PORT0
                                                                                              PORT1
                                                                LED ENABLE    PORT GPIO       PORT2
                                                         PWM                     AND          PORT3
                                                                GPIO ENABLE
                                                         GPIO                 CONSTANT-       PORT4
                                                        LOGIC    GPIO INPUT    CURRENT        PORT5
                      MAX7360                                                 LED DRIVE
                                                                                              PORT6
                                                                                              PORT7
                                                       ROTARY
                                                                                              COL0
                                                                                              COL1
                                                              COLUMN ENABLE                   COL2*
                                  128kHz                                       CURRENT        COL3*
                                OSCILLATOR                      GPO ENABLE     SOURCE
                                                                                              COL4*
                                                                               COLUMN
                                                              CURRENT DETECT                  COL5*
                                                                                DRIVES
                                                                                              COL6*
        INTI
                                                                                              COL7*
       INTK                                              KEY
                                   CONTROL
        SDA                       REGISTERS             SCAN
                                                                                              ROW0
        SCL         I2 C              FIFO
                                                                                              ROW1
        AD0     INTERFACE
                                                                                              ROW2
                                                                                OPEN-         ROW3
                                                                ROW ENABLE      DRAIN         ROW4
                                                                                 ROW
                                                                                DRIVES        ROW5
                   BUS
                                      POR                                                     ROW6
                 TIMEOUT
                                                                                              ROW7
              *GPO
Detailed Description                                          To prevent overloading the microprocessor with too many
The MAX7360 is a microprocessor peripheral low-noise          interrupts, interrupt requests are issued on a programmable
key-switch controller that monitors up to 64 key switches     number of FIFO entries, and/or after a set period of time
with optional autorepeat, and key events that are presented   (Table 10). The key-switch status is checked by reading
in a 16-byte FIFO. The MAX7360 also features eight            the key-switch FIFO. A 1-byte read access returns both
open-drain GPIOs configured for digital I/O or constant-      the next key event in the FIFO (if there is one) and the
current output for LED applications up to +14V.               FIFO status. INTK functions as an open-drain general-
                                                              purpose output (GPO) capable of driving an LED if key-
The MAX7360 features an automatic sleep mode and              switch interrupts are not required.
automatic wakeup that further reduce supply current
consumption. The MAX7360 can be configured to enter           Up to six of the key-switch outputs function as open-
sleep mode after a programmable time following a key          drain GPOs capable of driving additional LEDs when the
event. The FIFO content is maintained and can be read         application requires fewer keys to be scanned. For
in sleep mode. The MAX7360 does not enter autosleep           each key-switch output used as a GPO, the number of
when a key is held down. The autowake feature takes the       monitored key switches reduces by eight.
MAX7360 out of sleep mode following a keypress event.         Initial Power-Up
Enable/disable autosleep and autowake through the             On power-up, all control registers are set to power-up
configuration register (Table 8).                             values and the MAX7360 is in sleep mode (Table 1).
www.maximintegrated.com                                                                                 Maxim Integrated │ 9


MAX7360                                          I2C-Interfaced Key-Switch Controller and LED
                                                  Driver/GPIOs with Integrated ESD Protection
Table 1. Register Address Map and Power-Up Condition
 ADDRESS
                READ/   POWER-UP         REGISTER
   CODE                                                                           DESCRIPTION
               WRITE    VALUE (hex)      FUNCTION
   (hex)
   0x00       Read only    0x3F          Keys FIFO       Read FIFO key-scan data out
                                                         Power-down, key-release enable, autowakeup, and I2C
   0x01          R/W       0x0A        Configuration
                                                         timeout enable
   0x02          R/W       0xFF          Debounce        Key debounce time settling and GPO enable
   0x03          R/W       0x00           Interrupt      Key-switch interrupt INTK frequency setting
   0x04          R/W       0xFE             GPO          COL2–COL7 and INTK GPO control
   0x05          R/W       0x00          Key repeat      Delay and frequency for key repeat
   0x06          R/W       0x07             Sleep        Idle time to autosleep
                                        GPIO global
   0x40          R/W       0x00                          Rotary switch, GPIO standby, GPIO reset, fade
                                        configuration
   0x41          R/W       0x00         GPIO control     PORT0–PORT7 input/output control
   0x42          R/W       0x00       GPIO debounce      PORT0–PORT7 debounce time setting
                                      GPIO constant-
   0x43          R/W       0xC0                          PORT0–PORT7 constant-current output setting
                                       current setting
   0x44          R/W       0x00      GPIO output mode    PORT0–PORT7 output mode control
   0x45          R/W       0x00       Common PWM         Common PWM duty-cycle setting
                                       Rotary switch
   0x46          R/W       0x00                          Rotary switch interrupt frequency and debounce time setting
                                        configuration
   0x48       Read only    0x00       I2C timeout flag   I2C timeout since last POR
   0x49       Read only    0xFF      GPIO input register PORT0–PORT7 input values
   0x4A       Read only    0x00     Rotary switch count  Switch cycles since last read
   0x50          R/W       0x00        PORT0 PWM         PORT0 individual duty-cycle setting
   0x51          R/W       0x00        PORT1 PWM         PORT1 individual duty-cycle setting
   0x52          R/W       0x00        PORT2 PWM         PORT2 individual duty-cycle setting
   0x53          R/W       0x00        PORT3 PWM         PORT3 individual duty-cycle setting
   0x54          R/W       0x00        PORT4 PWM         PORT4 individual duty-cycle setting
   0x55          R/W       0x00        PORT5 PWM         PORT5 individual duty-cycle setting
   0x56          R/W       0x00        PORT6 PWM         PORT6 individual duty-cycle setting
   0x57          R/W       0x00        PORT7 PWM         PORT7 individual duty-cycle setting
   0x58          R/W       0x00     PORT0 configuration  PORT0 interrupt, PWM mode control and blink period setting
   0x59          R/W       0x00     PORT1 configuration  PORT1 interrupt, PWM mode control and blink period setting
   0x5A          R/W       0x00     PORT2 configuration  PORT2 interrupt, PWM mode control and blink period setting
   0x5B          R/W       0x00     PORT3 configuration  PORT3 interrupt, PWM mode control and blink period setting
   0x5C          R/W       0x00     PORT4 configuration  PORT4 interrupt, PWM mode control and blink period setting
   0x5D          R/W       0x00     PORT5 configuration  PORT5 interrupt, PWM mode control and blink period setting
   0x5E          R/W       0x00     PORT6 configuration  PORT6 interrupt, PWM mode control and blink period setting
   0x5F          R/W       0x00     PORT7 configuration  PORT7 interrupt, PWM mode control and blink period setting
www.maximintegrated.com                                                                            Maxim Integrated │ 10


MAX7360                                                   I2C-Interfaced Key-Switch Controller and LED
                                                            Driver/GPIOs with Integrated ESD Protection
Table 2. Key-Switch Mapping
     PIN        COL0            COL1          COL2*           COL3*        COL4*          COL5*         COL6*          COL7*
   ROW0         KEY 0           KEY 8         KEY 16         KEY 24        KEY 32         KEY 40        KEY 48        KEY 56
   ROW1         KEY 1           KEY 9         KEY 17         KEY 25        KEY 33         KEY 41        KEY 49        KEY 57
   ROW2         KEY 2          KEY 10         KEY 18         KEY 26        KEY 34         KEY 42        KEY 50        KEY 58
   ROW3         KEY 3          KEY 11         KEY 19         KEY 27        KEY 35         KEY 43        KEY 51        KEY 59
   ROW4         KEY 4          KEY 12         KEY 20         KEY 28        KEY 36         KEY 44        KEY 52        KEY 60
   ROW5         KEY 5          KEY 13         KEY 21         KEY 29        KEY 37         KEY 45        KEY 53        KEY 61
   ROW6         KEY 6          KEY 14         KEY 22         KEY 30        KEY 38         KEY 46        KEY 54        KEY 62
   ROW7         KEY 7          KEY 15         KEY 23         KEY 31        KEY 39         KEY 47        KEY 55        KEY 63
*These columns can be configured as GPOs.
Key-Scan Controller                                                 determines how INTK is deasserted. Write to bit D7 to
Key inputs are scanned statically, not dynamically, to              put the MAX7360 into sleep mode or operating mode.
ensure low-EMI operation. As inputs only toggle in                  Autosleep and autowake, when enabled, also change the
response to switch changes, the key matrix can be routed            status of D7 (see Table 8 in the Register Tables section).
closer to sensitive circuit nodes.                                  Debounce Register (0x02)
The key-scan controller debounces and maintains a FIFO              The debounce register sets the time for each debounce
of keypress and release events (including autorepeated              cycle, as well as setting whether the GPO ports are
keypresses, if autorepeat is enabled). Table 2 shows the            enabled or disabled. Bits D0–D4 set the debounce time
key-switch order. The user-programmable key-switch                  in increments of 1ms starting at 9ms and ending at 40ms
debounce time, and autosleep timer, is derived from the             (see Table 9 in the Register Tables section). Bits D5, D6,
64kHz clock, which in turn is derived from the 128kHz               and D7 set which of the GPO ports is enabled. Note the
oscillator. Time delay for autorepeat and key-switch                GPO ports are enabled only in the combinations shown in
interrupt is based on the key-switch debounce time.                 Table 9, from all disabled to all enabled.
Keys FIFO Register (0x00)                                           Key-Switch Interrupt Register (0x03)
The keys FIFO register contains the information pertaining          The interrupt register contains information related to the
to the status of the keys FIFO, as well as the key events           settings of the interrupt request function, as well as the
that have been debounced (see Table 7 in the Register               status of the INTK output, which can also be configured
Tables section). Bits D0–D5 denote which of the 64 keys             as a GPO. If bits D0–D7 are set to 0x00, the INTK output
have been debounced and the keys are numbered as in                 is configured as a GPO that is controlled by bit D1 in the
Table 2.                                                            port register. There are two types of interrupts, the FIFO-
D7 indicates if there is more data in the FIFO, except              based interrupt and time-based interrupt. Set bits D0–D4
when D5:D0 indicate key 63 or key 62. When D5:D0                    to assert interrupts at the end of the selected number of
indicate key 63 or key 62, the host should read one more            debounce cycles following a key event (see Table 10 in
time to determine whether there is more data in the FIFO.           the Register Tables section). This number ranges from
Use key 62 and key 63 for rarely used keys. D6 indicates            1–31 debounce cycles. Setting bits D7, D6, and D5 set
if it is a keypress or release event, except when D5:D0             the FIFO-based interrupt when there are 2–14 key events
indicate key 63 or key 62.                                          stored in the FIFO. Both interrupts can be configured
                                                                    simultaneously and INTK asserts depending on which
Reading the key-scan FIFO clears the interrupt INTK
                                                                    condition is met first. INTK deasserts depending on the
depending on the setting of bit D5 in the configuration
                                                                    status of bit D5 in the configuration register.
register (0x01).
                                                                    Ports Register (0x04)
Configuration Register (0x01)
                                                                    The ports register sets the values of PORT2–PORT7 and
The configuration register controls the I2C bus timeout feature,
                                                                    the INTK port, when configured, as open-drain GPOs.
enables key-release detection, enables autowake, and
www.maximintegrated.com                                                                                     Maxim Integrated │ 11


MAX7360                                                       I2C-Interfaced Key-Switch Controller and LED
                                                               Driver/GPIOs with Integrated ESD Protection
The settings in this register are ignored for ports not configured   Autowake
as GPOs, and a read from this register returns the values            Keypresses initiate autowake and the MAX7360 goes into
stored in the register (see Table 11 in the Register Tables          operating mode. Keypresses that autowake the MAX7360
section).                                                            are not lost. When a key is pressed while the MAX7360 is
Autorepeat Register (0x05)                                           in sleep mode, all analog circuitry, including switch-matrix
                                                                     current sources, turn on in 2ms. The initial key needs to
The MAX7360 autorepeat feature notifies the host that at
                                                                     be pressed for 2ms plus the debounce time to be stored
least one key has been pressed for a continuous period.
                                                                     in the FIFO. Write a 0 to D1 in the configuration register
The autorepeat register enables or disables this feature,
                                                                     (0x01) to disable autowakeup.
sets the time delay after the last key event before the key
repeat code (0x7E) is entered into the FIFO, and sets                GPIOs
the frequency at which the key-repeat code is entered                The MAX7360 has eight GPIO ports with LED control
into the FIFO thereafter. Bit D7 specifies whether the               functions. The ports can be used as logic inputs, logic outputs,
autorepeat function is enabled with 0 denoting autorepeat            or constant-current PWM LED drivers. In addition, PORT7
disabled, and 1 denoting autorepeat enabled. Bits D0–                and PORT6 can function as a rotary switch input pair.
D3 specify the autorepeat delay in terms of debounce                 When in PWM mode, the ports are set up to start their
cycles ranging from 8–128 debounce cycles (see Table                 PWM cycle in 45N phase increments. This prevents large
12 in the Register Tables section). Bits D4, D5, and D6              current spikes on the LED supply voltage when driving
specify the autorepeat rate or frequency ranging from                multiple LEDs.
4–32 debounce cycles.
                                                                     GPIO Global Configuration Register (0x40)
When autorepeat is enabled, holding the key pressed
results in a key-repeat event that is denoted by 0x7E. The           The GPIO global configuration register controls the main
key being pressed does not show up again in the FIFO.                settings for the eight GPIOs (see Table 14 in the Register
                                                                     Tables section).
Only one autorepeat code is entered into the FIFO,
regardless of the number of keys pressed. The autorepeat             Bit D7 enables PORT[7:6] as inputs for a rotary switch. Bit
code continues to be entered in the FIFO at the frequency            D5 enables interrupt generation for I2C timeouts. D4 is the
set by bits D[4:6] until another key event is recorded.              main enable/shutdown bit for the GPIOs. D3 functions as a
Following the key-release event, if any keys are still               software reset for the GPIO registers (0x40 to 0x5F). Bits
pressed, the MAX7360 restarts the autorepeat sequence.               D[2:0] set the fade in/out time for the GPIOs configured
                                                                     as constant-current sinks.
Autosleep Register (0x06)
                                                                     GPIO Control Register (0x41)
Autosleep puts the MAX7360 in sleep mode to draw minimal
current. When enabled, the MAX7360 enters sleep mode                 The GPIO control register configures each port as either
if no keys are pressed for the autosleep time (see Table             an input or an output (see Table 15 in the Register
13 in the Register Tables section).                                  Tables section). All GPIOs allow individual configurations,
                                                                     and power up as inputs. Enabling rotary switch mode
Key-Switch Sleep Mode                                                automatically sets D7 and D6 as inputs. The ports
In sleep mode, the MAX7360 draws minimal current.                    consume additional current if their inputs are left undriven.
Switch-matrix current sources are turned off and pulled up
                                                                     GPIO Debounce Configuration Register (0x42)
to VCC. When autosleep is enabled, key-switch inactivity
for a period longer than the autosleep time puts the part            The GPIO debounce configuration register sets the
into sleep mode (FIFO data is maintained). Writing a 1 to            amount of time a GPIO must be held for the MAX7360
D7 in the configuration register, or a keypress, can take the        to register a logic transition (see Table 16 in the Register
MAX7360 out of sleep mode. Bit D7 in the configuration               Tables section). The GPIO debounce setting is independent
register gives the sleep-mode status and can be read any             of the key-switch debounce setting. Five bits (D[4:0]) set
time. The FIFO data is maintained while in sleep mode.               32 possible debounce times from 9ms up to 40ms.
www.maximintegrated.com                                                                                       Maxim Integrated │ 12


MAX7360                                               I2C-Interfaced Key-Switch Controller and LED
                                                        Driver/GPIOs with Integrated ESD Protection
GPIO Constant-Current Setting Register (0x43)                 Rotary Switch Count Register (0x4A) (Read Only)
The GPIO constant-current setting register sets the global    The MAX7360 keeps a count of the rotary switch rotations
constant-current amount (see Table 17 in the Register         in two’s compliment format (see Table 23 in the Register
Tables section). Bits D1 and D0 set the global current        Tables section). The register values wrap around as the
values from 5mA up to 20mA.                                   count value switches from a positive to a negative value
                                                              and back again. The count resets to zero after an I2C read
GPIO Output Mode Register (0x44)                              to this register.
The GPIO output mode register sets an output as either
a constant-current or non-constant-current output for         PORT0–PORT7 Individual PWM Ratio Registers
PORT[7:0] (see Table 18 in the Register Tables section).      (0x50 to 0x57)
Outputs are configured as constant-current outputs by         Each port has an individual PWM ratio register (0x50
default to prevent accidental loading of an LED across        to 0x57, see Table 24 in the Register Tables section).
an unregulated output. The constant-current circuits          Use values 0x00 to 0xFE in these registers to configure
automatically turn off when not in use to reduce current      the number of cycles out of 256 the output sinks current
consumption.                                                  (LED is on), from 0 cycles to 254 cycles. Use 0xFF to
                                                              have an output continuously sink current (always on). For
Common PWM Register (0x45)                                    applications requiring multiple ports to have the same
The common PWM register stores the common constant-           intensity, program a particular port’s configuration
current output PWM duty cycle (see Table 19 in the            register (0x58 to 0x5F) to use the common PWM register
Register Tables section). The values stored in this register  (0x45). New PWM settings take place at the beginning of
translate over to a PWM duty cycle in the same manner         a PWM cycle, to allow changes from common intensity to
as the individual PWM registers (0x50 to 0x57). Ports can     individual intensity with no interruption in the PWM cycle.
use their own individual PWM value, or the common PWM         PORT0–PORT7 Configuration Registers
value. Write to this register to change the duty cycle of     (0x58 to 0x5F)
several ports at once.                                        Registers 0x58 to 0x5F set individual configurations for
Rotary Switch Configuration Register (0x46)                   each port (see Table 25 in the Register Tables section).
The rotary switch configuration register stores rotary        Bits D7 and D6 determine the interrupt settings for the
switch settings for PORT7 and PORT6 (see Table 20             inputs. Interrupts can assert upon detection of a logic
                                                              transition, a rising edge, or not at all. D5 sets the port’s
in the Register Tables section). D7 determines whether
                                                              PWM setting to either the common or individual PWM
switch counts or a time delay will trigger an interrupt
                                                              setting. Bits D[4:2] enable and set the ports’ individual blink
if enabled. D[6:4] set the count or time amount to wait
                                                              period from 0 to 4096ms. Bits D1 and D0 set a port’s blink
before sending an interrupt. Bits D[3:0] set the debounce
                                                              duty cycle.
cycle time for the rotary switch inputs. Debounce time
ranges from 0 to 15ms.                                        Fading
I2C Timeout Flag Register (0x48) (Read Only)                  Set the fade cycle time in the GPIO global configuration
                                                              register (0x40) to a non-zero value to enable fade in/out
The I2C timeout flag register contains a single bit (D0),
                                                              (see Table 14 in the Register Tables section). Fade in
which indicates if an I2C timeout has occurred (see Table
                                                              increases an LED’s PWM intensity in 16 even steps from
21 in the Register Tables section). Read this register to     zero to its stored value. Fade out decreases an LED’s
clear an I2C timeout initiated interrupt.                     PWM intensity in 16 even steps from its current value to
GPIO Input Register (0x49) (Read Only)                        zero. Fading occurs automatically in any of the following
The GPIO input register contains the input data for all of    scenarios:
the GPIOs (see Table 22 in the Register Tables section).      1)   Change the common PWM register value from any
Ports configured as outputs are read as high. There is             value to zero to cause all ports using the common
one debounce period delay prior to detecting a transi-             PWM register settings to fade out. No ports using
tion on the input port. This prevents a false interrupt            individual PWM settings are affected.
from occurring when changing a port from an output to         2)   Change the common PWM register value to any
an input. The GPIO input register reports the state of             value from zero to cause all ports using the common
all input ports regardless of any interrupt mask settings.         PWM register settings to fade in. No ports using
Ports configured as an input have a 2µA internal pullup to         individual PWM settings are affected.
VCC for PORT[5:0] and a 10µA internal pullup to VCC for
PORT[7:6].
www.maximintegrated.com                                                                               Maxim Integrated │ 13


MAX7360                                                          I2C-Interfaced Key-Switch Controller and LED
                                                                  Driver/GPIOs with Integrated ESD Protection
3)   Put the part out of shutdown to cause all ports to                        GPIO Port Interrupts (INTI)
     fade in. Changing an individual PWM intensity during                      Three possible sources generate INTI: I2C timeout,
     fade in automatically cancels that port’s fade and                        GPIOs configured as inputs, and the rotary switch
     immediately output at its newly programmed intensity.                     (registers 0x48, 0x49, and 0x4A). Read the respective
4)   Put the part into shutdown to cause all ports to fade                     data/status registers for each type of interrupt to clear INTI.
     out. Changing an individual PWM intensity during                          Set register 0x46 for rotary switch-based interrupts. Set
     fade out automatically cancels that port’s fade and                       registers 0x58 to 0x5F for individual GPI-based interrupts.
     immediately turns off.                                                    If multiple sources generate the interrupt, all the related
Blink                                                                          status registers must be read to clear INTI.
Each port has its own blink control settings through registers                 Rotary Switch
0x58 to 0x5F (see Table 25 in the Register Tables                              The MAX7360 can accept a 2-bit rotary switch inputs on
section). The blink period ranges from 0 (blink disabled)                      PORT6 and PORT7. Rotation of the switch in a clockwise
to 4.096s. Settable blink duty cycles range from 6.25%                         direction increments the count. Enable rotary switch
to 50%. All blink periods start at the same PWM cycle for                      mode from the GPIO global configuration register (0x40).
synchronized blinking between multiple ports.                                  Several settings for PORT6 and PORT7 occur during
When the blink setting is changed, the internal controller                     rotary switch mode:
waits until the current blink period finishes before applying
                                                                               1)   Each port has a 10µA pullup to VCC.
the change. As a result, the change in blink period may
not always be instantaneous.                                                   2)   Register 0x46 sets the debounce time.
                                                                               3)   A debounced rising edge on PORT6 while PORT7 is
                                                                                    high decreases the count.
                                                                               4)   A debounced rising edge on PORT6 while PORT7 is
              PORT7                                                                 low increases the count.
                                                                               For more details, see Figure 1.
                                              INCREMENT
              PORT6
                                                                               Serial Interface
                                                                               Figure 2 shows the 2-wire serial interface timing details.
              PORT7                                                            Serial Addressing
                                              DECREMENT                        The MAX7360 operates as a slave that sends and
              PORT6                                                            receives data through an I2C-compatible 2-wire interface.
                                                                               The interface uses a serial-data line (SDA) and a serial-
                     ROTARY SWITCH                                             clock line (SCL) to achieve bidirectional communication
                        DEBOUNCE
Figure 1. Rotary Switch Input Signal Timing
                                                                                        tR
                                                                                                              tF
               SDA
                                                                                                              tF, TX
                                                                                                                            tBUF
                                              tSU, DAT              tSU, STA            tHD, STA
                                    tLOW                                                               tSU, STO
                                                        tHD, DAT
               SCL                          tHIGH
                   tHD, STA
                                         tR          tF
                            START                                             REPEATED                                STOP         START
                          CONDITION                                        START CONDITION                          CONDITION    CONDITION
Figure 2. 2-Wire Serial Interface Timing Details
www.maximintegrated.com                                                                                                           Maxim Integrated │ 14


MAX7360                                                  I2C-Interfaced Key-Switch Controller and LED
                                                           Driver/GPIOs with Integrated ESD Protection
between master(s) and slave(s). A master (typically a                Bit Transfer
microcontroller) initiates all data transfers to and from the        One data bit is transferred during each clock pulse
MAX7360 and generates the SCL clock that synchronizes                (Figure 4). The data on SDA must remain stable while
the data transfer.                                                   SCL is high.
The MAX7360’s SDA line operates as both an input and
an open-drain output. A pullup resistor, typically 4.7kΩ,
                                                                     Acknowledge
is required on SDA. The MAX7360’s SCL line operates                  The acknowledge bit is a clocked 9th bit (Figure 5), which
only as an input. A pullup resistor is required on SCL if            the recipient uses to handshake receipt of each byte of
there are multiple masters on the 2-wire interface, or if            data. Thus, each byte transferred effectively requires 9
the master in a single-master system has an open-drain               bits. The master generates the 9th clock pulse, and the
SCL output.                                                          recipient pulls down SDA during the acknowledge clock
                                                                     pulse; therefore, the SDA line is stable low during the high
Each transmission consists of a START (S) condition
                                                                     period of the clock pulse. When the master is transmitting
(Figure 3) sent by a master, followed by the MAX7360
                                                                     to the MAX7360, the MAX7360 generates the acknowledge
7-bit slave address plus R/W bit, a register address byte,
                                                                     bit because the MAX7360 is the recipient. When the
one or more data bytes, and finally, a STOP (P) condition.
                                                                     MAX7360 is transmitting to the master, the master
START and STOP Conditions                                            generates the acknowledge bit because the master is the
Both SCL and SDA remain high when the interface is not               recipient.
busy. A master signals the beginning of a transmission               Table 3. 2-Wire Interface Address Map
with a START condition by transitioning SDA from high
to low while SCL is high. When the master has finished                                         DEVICE ADDRESS
                                                                       PIN AD0
communicating with the slave, it issues a STOP condition                          A7    A6    A5    A4     A3    A2     A1    A0
by transitioning SDA from low to high while SCL is high.                 GND       0     1    1      1     0      0     0    R/W
The bus is then free for another transmission.                           VCC       0     1     1     1      0     1      0   R/W
                                                                         SDA       0     1    1      1     1      0     0    R/W
                                                                         SCL       0     1    1      1     1      1     0    R/W
              SDA
              SCL
                         S                                                                                     P
                       START                                                                                  STOP
                     CONDITION                                                                             CONDITION
Figure 3. START and STOP Conditions
                    SDA
                    SCL
                                    DATA LINE STABLE;   CHANGE OF DATA
                                      DATA VALID          ALLOWED
Figure 4. Bit Transfer
www.maximintegrated.com                                                                                      Maxim Integrated │ 15


MAX7360                                                          I2C-Interfaced Key-Switch Controller and LED
                                                                    Driver/GPIOs with Integrated ESD Protection
                                         START                                                  CLOCK PULSE FOR
                                       CONDITION                                                   ACKNOWLEDGE
                                   SCL                     1               2                       8                 9
                                   SDA
                                    BY
                          TRANSMITTER
                                   SDA
                                    BY
                              RECEIVER
                                            S
Figure 5. Acknowledge
                  SDA           0             1          1        1           A3          A2          A1        R/W           ACK
                             MSB                                                                     LSB
                  SCL
Figure 6. Slave Address
                                 COMMAND BYTE IS STORED ON RECEIPT OF
                                                ACKNOWLEDGE CONDITION         D7   D6   D5   D4   D3    D2   D1    D0
                                       ACKNOWLEDGE FROM MAX7360
                          S                 SLAVE ADDRESS           0    A                COMMAND BYTE                   A     P
                                                          R/W                         ACKNOWLEDGE FROM MAX7360
Figure 7. Command Byte Received
                                                                ACKNOWLEDGE FROM MAX7360                   ACKNOWLEDGE FROM MAX7360
                                                        D7   D6 D5    D4   D3  D2   D1  D0       D7    D6  D5   D4    D3   D2   D1  D0
                      ACKNOWLEDGE FROM MAX7360
         S            SLAVE ADDRESS             0   A             COMMAND BYTE               A                   DATA BYTE                A   P
                                         R/W                                                                     1 BYTE
                                                                                                                                 AUTOINCREMENT
                                                                                                                              COMMAND BYTE ADDRESS
Figure 8. Command and Single Data Byte Received
Slave Addresses                                                                 signals, care must be taken to ensure that AD0 transitions
The MAX7360 has a 7-bit long slave address (Figure 6).                          no sooner than the signals on SDA and SCL.
The bit following a 7-bit slave address is the R/W bit,                         The MAX7360 monitors the bus continuously, waiting for
which is low for a write command and high for a read                            a START condition, followed by its slave address. When
command.                                                                        the MAX7360 recognizes its slave address, it acknowl-
The first 4 bits (MSBs) of the MAX7360 slave address are                        edges and is then ready for continued communication.
always 0111. Slave address bits A3, A2, and A1 corre-                           Bus Timeout
spond, by the matrix in Table 3, to the states of the device
                                                                                The MAX7360 features a 20ms minimum bus timeout
address input AD0, and A0 corresponds to the R/W bit.
                                                                                on the 2-wire serial interface, largely to prevent the
The AD0 input can be connected to any of four signals
                                                                                MAX7360 from holding the SDA I/O low during a read
(GND, VCC, SDA, or SCL), giving four possible slave
                                                                                transaction should the SCL lock up for any reason before
address pairs and allowing up to four MAX7360 devices
                                                                                a serial transaction is completed. Bus timeout operates
to share the bus. Because SDA and SCL are dynamic
                                                                                by causing the MAX7360 to internally terminate a serial
www.maximintegrated.com                                                                                                            Maxim Integrated │ 16


MAX7360                                                      I2C-Interfaced Key-Switch Controller and LED
                                                               Driver/GPIOs with Integrated ESD Protection
                                                             ACKNOWLEDGE FROM MAX7360              ACKNOWLEDGE FROM MAX7360
                                                    D7  D6 D5   D4  D3   D2   D1  D0      D7  D6 D5   D4    D3    D2   D1  D0
                       ACKNOWLEDGE FROM MAX7360
          S           SLAVE ADDRESS           0  A         COMMAND BYTE                 A               DATA BYTE                A   P
                                       R/W                                                             N BYTES
                                                                                                                        AUTOINCREMENT
                                                                                                                     COMMAND BYTE ADDRESS
Figure 9. N Data Bytes Received
Table 4. Autoincrement Rules                                              is read using the same rules as for a write (Table 4). Thus,
                                                                          a read is initiated by first configuring the MAX7360’s com-
       REGISTER              ADDRESS           AUTOINCREMENT              mand byte by performing a write (Figure 7). The master can
       FUNCTION             CODE (hex)          ADDRESS (hex)             now read n consecutive bytes from the MAX7360, with the
  Keys FIFO                     0x00                0x00                  first data byte being read from the register addressed by
  Autoshutdown                  0x06                0x00                  the initialized command byte. When performing read-after-
  All other key switch     0x01 to 0x05          Addr + 0x01              write verification, remember to reset the command byte’s
  All other GPIO           0x40 to 0x5F          Addr + 0x01              address, because the stored command byte address is gen-
                                                                          erally autoincremented after the write (Figure 9, Table 4).
transaction, either read or write, if SCL low exceeds 20ms.               Operation with Multiple Masters
After a bus timeout, the MAX7360 waits for a valid START
                                                                          When the MAX7360 is operated on a 2-wire interface
condition before responding to a consecutive transmis-
                                                                          with multiple masters, a master reading the MAX7360
sion. This feature can be enabled or disabled under user
                                                                          uses a repeated start between the write that sets the
control by writing to the configuration register (Table 8 in
                                                                          MAX7360’s address pointer, and the read(s) that takes
the Register Tables section).
                                                                          the data from the location(s). This is because it is
Message Format for Writing                                                possible for master 2 to take over the bus after master
the Key-Scan Controller                                                   1 has set up the MAX7360’s address pointer, but before
A write to the MAX7360 comprises the transmission of                      master 1 has read the data. If master 2 subsequently
the slave address with the R/W bit set to zero, followed                  resets the MAX7360’s address pointer, master 1’s read
by at least 1 byte of information. The first byte of informa-             can be from an unexpected location.
tion is the command byte. The command byte determines                     Command Address Autoincrementing
which register of the MAX7360 is to be written by the next
                                                                          Address autoincrementing allows the MAX7360 to be
byte, if received. If a STOP condition is detected after the
                                                                          configured with fewer transmissions by minimizing the
command byte is received, the MAX7360 takes no further
                                                                          number of times the command address needs to be sent.
action (Figure 7) beyond storing the command byte.
                                                                          The command address stored in the MAX7360 generally
Any bytes received after the command byte are data                        increments after each data byte is written or read (Table 4).
bytes. The first data byte goes into the internal register of             Autoincrement only works when doing a multiburst read
the MAX7360 selected by the command byte (Figure 8).                      or write.
If multiple data bytes are transmitted before a STOP condition
is detected, these bytes are generally stored in subsequent               Applications Information
MAX7360 internal registers, because the command byte                      Reset from I2C
address generally autoincrements (Table 4).                               After a catastrophic event such as ESD discharge or
Message Format for Reading                                                microcontroller reset, use bit D7 of the configuration register
the Key-Scan Controller                                                   (0x01) as a software reset for the key-switch state (the
The MAX7360 is read using the internally stored com-                      key-switch register values and FIFO remain unaffected).
mand byte as an address pointer, the same way the stored                  Use bit D4 of the GPIO global configuration register
command byte is used as an address pointer for a write.                   (0x40) as a software reset for the GPIOs.
The pointer generally autoincrements after each data byte
www.maximintegrated.com                                                                                                   Maxim Integrated │ 17


MAX7360                                                  I2C-Interfaced Key-Switch Controller and LED
                                                          Driver/GPIOs with Integrated ESD Protection
                    REGULAR KEYPRESS
                                                                             EXAMPLES OF VALID THREE-KEY COMBINATIONS
                          EVENT
                                        GHOST-KEY
                                        EVENT
                                                                           KEY-SWITCH MATRIX            KEY-SWITCH MATRIX
                  KEY-SWITCH MATRIX
Figure 10. Ghost-Key Phenomenon                                 Figure 11. Valid Three-Key Combinations
Ghost-Key Elimination                                           Switch On-Resistance
Ghost keys are a phenomenon inherent with key-switch            The MAX7360 is designed to be insensitive to resistance,
matrices. When three switches located at the corners of         either in the key switches, or the switch routing to and
a matrix rectangle are pressed simultaneously, the switch       from the appropriate COL_ and ROW_ up to 4kΩ (max).
that is located at the last corner of the rectangle (the ghost  These controllers are therefore compatible with low-cost
key) also appears to be pressed. This occurs because            membrane and conductive carbon switches.
the potentials at the two sides of the ghost-key switch are     Hot Insertion
identical due to the other three connections—the switch is
                                                                The INTI, INTK, SCL, and AD0 inputs and SDA remain
electrically shorted by the combination of the other three
                                                                high impedance with up to +3.6V asserted on them when
switches (Figure 10). Because the key appears to be
                                                                the MAX7360 powers down (VCC = 0). I/O ports (PORT0–
pressed electrically, it is impossible to detect which of the   PORT7) remain high impedance with up to +14V asserted
four keys is the ghost key.                                     on them when not powered. Use the MAX7360 in hot-
The MAX7360 employs a proprietary scheme that detects           swap applications.
any three-key combination that generates a fourth ghost
key, and does not report the third key that causes a            Staggered PWM
ghost-key event. This means that although ghost keys            The LED’s on-time in each PWM cycle are phase
are never reported, many combinations of three keys             delayed 45N into eight evenly spaced start positions.
are effectively ignored when pressed at the same time.          Optimize phasing when using fewer than eight ports as
Applications requiring three-key combinations (such as          constant-current outputs by allocating the ports with the
<Ctrl><Alt><Del>) must ensure that the three keys are           most appropriate start positions. For example, if using
                                                                four constant-current outputs, choose PORT0, PORT2,
not wired in positions that define the vertices of a rect-
                                                                PORT4, and PORT6 because their PWM start positions
angle (Figure 11). There is no limit on the number of keys
                                                                are evenly spaced. In general, choose the ports that
that can be pressed simultaneously as long as the keys
                                                                spread the PWM start positions as evenly as possible.
do not generate ghost-key events and FIFO is not full.          This optimally spreads out the current demand from the
Low-EMI Operation                                               ports’ load supply.
The MAX7360 uses two techniques to minimize EMI radi-           INTK/INTI
ating from the key-switch wiring. First, the voltage across     There are two interrupt outputs, INTK and INTI. Each
the switch matrix never exceeds +0.55V if not in sleep          interrupt operates independently from the other. See
mode, independent of supply voltage VCC. This reduces           the Key-Switch Interrupt Register (0x03) and the GPIO
the voltage swing at any node when a switch is pressed          Port Interrupts (INTI) sections for additional information
to +0.55V maximum. Second, the keys are not dynamically         regarding these two interrupts.
scanned, which would cause the key-switch wiring to
continuously radiate interference. Instead, the keys are        Power-Supply Considerations
monitored for current draw (only occurs when pressed),          The MAX7360 operates with a +1.62V to +3.6V power-
and debounce circuitry only operates when one or more           supply voltage. Bypass the power supply to GND with a
keys are actually pressed.                                      0.1µF or higher ceramic capacitor as close as possible to
                                                                the device.
www.maximintegrated.com                                                                                      Maxim Integrated │ 18


MAX7360                                             I2C-Interfaced Key-Switch Controller and LED
                                                      Driver/GPIOs with Integrated ESD Protection
ESD Protection                                                Table 5. ESD Test Levels
All of the MAX7360 pins meet the 2kV Human Body Model
                                                                       1A—CONTACT
ESD tolerances. Key-switch inputs and GPIOs meet IEC                    DISCHARGE
                                                                                                 1B—AIR-GAP DISCHARGE
61000-4-2 ESD protection. The IEC test stresses consist
of 10 consecutive ESD discharges per polarity, at the                             TEST                       TEST VOLTAGE
                                                                  LEVEL                           LEVEL
maximum specified level and below (per IEC 61000-4-2).                        VOLTAGE (kV)                         (kV)
Test criteria include:                                               1               2               1               2
1)   The powered device does not latch up during the                 2               4               2               4
     ESD discharge event.                                            3               6               3               8
2)   The device subsequently passes the final test used              4               8               4              10
     for prescreening.                                               X           Special             X           Special
Table 5 and Table 6 are from the IEC 61000-4-2: Edition       X = Open level. The level has to be specified in the dedicated
                                                              equipment specification. If higher voltages than those shown
1.1 1999-05: Electromagnetic compatibility (EMC) Testing      are specified, special test equipment could be needed.
and measurement techniques—Electrostatic discharge
immunity test.
Table 6. ESD Waveform Parameters
                               FIRST PEAK OF
                INDICATED                               RISE TIME (tr) WITH       CURRENT (±30%)               CURRENT
                                  CURRENT
   LEVEL          VOLTGE                               DISCHARGE SWITCH                 AT 30ns             (±30%) AT 60ns
                              DISCHARGE ±10%
                    (kV)                                        (ns)                       (A)                    (A)
                                     (A)
       1              2               7.5                     0.7 to 1                       4                     2
       2              4               15                      0.7 to 1                       8                     4
       3              6              22.5                     0.7 to 1                      12                     6
       4              8               30                      0.7 to 1                      16                     8
www.maximintegrated.com                                                                                  Maxim Integrated │ 19


MAX7360                                                  I2C-Interfaced Key-Switch Controller and LED
                                                          Driver/GPIOs with Integrated ESD Protection
Register Tables
Table 7. Keys FIFO Register Format (0x00)
                                                                      KEYS FIFO REGISTER DATA
               SPECIAL FUNCTION
                                                     D7       D6    D5      D4      D3      D2     D1         D0
 The key number indicated by D5:D0 is a key
 event. D7 is always for a key press of key 62 and
 key 63. When D7 is 0, the key read is the last    FIFO      Key
 data in the FIFO. When D7 is 1, there is more     empty   release  X        X       X      X       X          X
 data in the FIFO. When D6 is 1, key data read      flag     flag
 from FIFO is a key release. When D6 is 0, key
 data read from FIFO is a key press.
 FIFO is empty.                                       0        0    1        1       1      1       1          1
 FIFO is overflow. Continue to read data in FIFO      0        1    1        1       1      1       1          1
 Key 63 is pressed. Read one more time to
                                                      1        0    1        1       1      1       1          1
 determine whether there is more data in FIFO.
 Key 63 is released. Read one more time to
                                                      1        1    1        1       1      1       1          1
 determine whether there is more data in FIFO.
 Key repeat. Indicates the last data in FIFO.         0        0    1        1       1      1       1          0
 Key repeat. Indicates more data in FIFO.             0        1    1        1       1      1       1          0
 Key 62 is pressed. Read one more time to
                                                      1        0    1        1       1      1       1          0
 determine whether there is more data in FIFO.
 Key 62 is released. Read one more time to
                                                      1        1    1        1       1      1       1          0
 determine whether there is more data in FIFO.
www.maximintegrated.com                                                                        Maxim Integrated │ 20


MAX7360                                                      I2C-Interfaced Key-Switch Controller and LED
                                                              Driver/GPIOs with Integrated ESD Protection
Table 8. Configuration Register Format (0x01)
  REGISTER                                                                                                                       DEFAULT
               DESCRIPTION           VALUE                                         FUNCTION
     BIT                                                                                                                          VALUE
                                        X         Key-switch operating mode. Key switches always remain active
                                   (when 0x40     when constant-current PWM is enabled (bit 4 of register 0x40 is high)
                                     D4 = 1)      regardless of autosleep, autowakeup, or an I2C write to this bit.
                                         0        Key-switch sleep
     D7              Sleep         (when 0x40     mode. The entire chip       When constant-current PWM is disabled                   0
                                     D4 = 0)      is shut down.               (bit 4 of register 0x40 is low), I2C write,
                                                                              autosleep, and autowakeup all can change
                                         1                                    this bit. This bit can be read back by I2C any
                                                  Key-switch operating
                                   (when 0x40                                 time for current status.
                                                  mode
                                     D4 = 0)
     D6           Reserved               0        —                                                                                   0
                                         0        INTK cleared when FIFO is empty
     D5            Interrupt                      INTK cleared after host read. In this mode, I2C should read the FIFO                0
                                         1
                                                  until interrupt condition is removed or further INT may be lost.
     D4           Reserved               0        —                                                                                   0
                 Key-release             0        Disable key releases
     D3                                                                                                                               1
                    enable               1        Enable key releases
     D2           Reserved               0        —                                                                                   0
                 Autowakeup              0        Disable keypress wakeup
     D1                                                                                                                               1
                    enable               1        Enable keypress wakeup
                   Timeout               0        I2C timeout enabled
     D0                                                                                                                               0
                    disable              1        I2C timeout disabled
Table 9. Debounce Register Format (0x02)
                                                                                         REGISTER DATA
           REGISTER DESCRIPTION                          D7        D6         D5           D4         D3          D2       D1          D0
                                                            PORTS ENABLE                                 DEBOUNCE TIME
 Debounce time is 9ms                                    X          X           X           0          0           0        0           0
 Debounce time is 10ms                                   X          X           X           0          0           0        0           1
 Debounce time is 11ms                                   X          X           X           0          0           0        1           0
 Debounce time is 12ms                                   X          X           X           0          0           0        1           1
                                                                     .
                                                                     .
                                                                     .
 Debounce time is 37ms                                   X          X           X           1          1           1        0           0
 Debounce time is 38ms                                   X          X           X           1          1           1        0           1
 Debounce time is 39ms                                   X          X           X           1          1           1        1           0
 Debounce time is 40ms                                   X          X           X           1          1           1        1           1
 GPO ports disabled (full key-scan functionality)        0          0           0           X          X          X         X           X
 GPO port 7 enabled                                      0          0           1           X          X          X         X           X
 GPO ports 7 and 6 enabled                               0          1           0           X          X          X         X           X
www.maximintegrated.com                                                                                                Maxim Integrated │ 21


MAX7360                                         I2C-Interfaced Key-Switch Controller and LED
                                                 Driver/GPIOs with Integrated ESD Protection
Table 9. Debounce Register Format (0x02) (continued)
                                                                  REGISTER DATA
            REGISTER DESCRIPTION            D7        D6      D5   D4      D3        D2        D1         D0
                                               PORTS ENABLE                   DEBOUNCE TIME
 GPO ports 7, 6, and 5 enabled               0         1       1    X      X         X          X          X
 GPO ports 7, 6, 5, and 4 enabled            1         0       0    X      X         X          X          X
 GPO ports 7, 6, 5, 4, and 3 enabled         1         0       1    X      X         X          X          X
 GPO ports 7, 6, 5, 4, 3, and 2 enabled      1         1       X    X      X         X          X          X
 Power-up default setting                    1         1       1    1       1        1          1           1
Table 10. Key-Switch Interrupt Register Format (0x03)
                                                                 REGISTER DATA
           REGISTER DESCRIPTION            D7        D6       D5   D4     D3        D2         D1         D0
                                             FIFO-BASED INTK                TIME-BASED INTK
 INTK used as GPO                           0         0        0    0      0         0          0          0
 FIFO-based INTK disabled                   0         0        0                Not all zero
 INTK asserts every debounce cycle          0         0        0    0      0         0          0          1
 INTK asserts every 2 debounce cycles       0         0        0    0      0         0          1          0
                                                        .
                                                        .
                                                        .
 INTK asserts every 29 debounce cycles      0         0        0    1      1         1          0          1
 INTK asserts every 30 debounce cycles      0         0        0    1      1         1          1          0
 INTK asserts every 31 debounce cycles      0         0        0    1      1         1          1          1
 Time-based INTK disabled                        Not all zero       0      0         0          0          0
 INTK asserts when FIFO has 4 key events    0         0        1    0      0         0          0          0
 INTK asserts when FIFO has 6 key events    0         1        0    0      0         0          0          0
 INTK asserts when FIFO has 8 key events    0         1        1    0      0         0          0          0
                                                        .
                                                        .
                                                        .
 INTK asserts when FIFO has 14 key events   1         1        1    0      0         0          0          0
 Both time-based and FIFO-based interrupts
                                                 Not all zero                   Not all zero
 active
 Power-up default setting                   0         0        0    0      0         0          0          0
www.maximintegrated.com                                                                    Maxim Integrated │ 22


MAX7360                                           I2C-Interfaced Key-Switch Controller and LED
                                                   Driver/GPIOs with Integrated ESD Protection
Table 11. Ports Register Format (0x04)
 REGISTER                                                                                   DEFAULT
               DESCRIPTION      VALUE                                FUNCTION
    BIT                                                                                      VALUE
                                  0   Clear port 7 low
    D7         PORT 7 Control                                                                   1
                                  1   Set port 7 high (high impedance)
                                  0   Clear port 6 low
    D6         PORT 6 Control                                                                   1
                                  1   Set port 6 high (high impedance)
                                  0   Clear port 5 low
    D5         PORT 5 Control                                                                   1
                                  1   Set port 5 high (high impedance)
                                  0   Clear port 4 low
    D4         PORT 4 Control                                                                   1
                                  1   Set port 4 high (high impedance)
                                  0   Clear port 3 low
    D3         PORT 3 Control                                                                   1
                                  1   Set port 3 high (high impedance)
                                  0   Clear port 2 low
    D2         PORT 2 Control                                                                   1
                                  1   Set port 2 high (high impedance)
                                  0   Clear port INTK low
    D1        INTK Port Control                                                                 1
                                  1   Set port INTK high (high impedance)
    D0            Reserved        0   —                                                         0
www.maximintegrated.com                                                          Maxim Integrated │ 23


MAX7360                                             I2C-Interfaced Key-Switch Controller and LED
                                                      Driver/GPIOs with Integrated ESD Protection
Table 12. Autorepeat Register Format (0x05)
                                                                      REGISTER DATA
          REGISTER DESCRIPTION                   D7      D6     D5      D4      D3     D2      D1         D0
                                               ENABLE     AUTOREPEAT RATE           AUTOREPEAT DELAY
 Autorepeat is disabled                           0      X      X       X       X       X       X          X
 Autorepeat is enabled                            1       AUTOREPEAT RATE           AUTOREPEAT DELAY
 Key-switch autorepeat delay is 8 debounce
                                                  1      X      X       X       0       0       0          0
 cycles
 Key-switch autorepeat delay is 16 debounce
                                                  1      X      X       X       0       0       0          1
 cycles
 Key-switch autorepeat delay is 24 debounce
                                                  1      X      X       X       0       0       1          0
 cycles
                                                           .
                                                           .
                                                           .
 Key-switch autorepeat delay is 112 debounce
                                                  1      X      X       X       1       1       0          1
 cycles
 Key-switch autorepeat delay is 120 debounce
                                                  1      X      X       X       1       1       1          0
 cycles
 Key-switch autorepeat delay is 128 debounce
                                                  1      X      X       X       1       1       1          1
 cycles
 Key-switch autorepeat frequency is 4 debounce
                                                  1      0       0      0       X       X       X          X
 cycles
 Key-switch autorepeat frequency is 8 debounce
                                                  1      0       0      1       X       X       X          X
 cycles
 Key-switch autorepeat frequency is 12
                                                  1      0       1      0       X       X       X          X
 debounce cycles
                                                           .
                                                           .
                                                           .
 Key-switch autorepeat frequency is 32
                                                  1      1       1      1       X       X       X          X
 debounce cycles
 Power-up default setting                         0      0       0      0       0       0       0          0
www.maximintegrated.com                                                                    Maxim Integrated │ 24


MAX7360                                         I2C-Interfaced Key-Switch Controller and LED
                                                  Driver/GPIOs with Integrated ESD Protection
Table 13. Autosleep Register Format (0x06)
                    REGISTER                                             REGISTER DATA
                                                        RESERVED                            AUTOSHUTDOWN TIME
           AUTOSLEEP REGISTER
                                           D7          D6        D5         D4         D3          D2        D1          D0
 No Autosleep                               0           0         0         0           0           0         0           0
 Autosleep for (ms)
 8192                                       0           0         0         0           0           0         0           1
 4096                                       0           0         0         0           0           0         1           0
 2048                                       0           0         0         0           0           0         1           1
 1024                                       0           0         0         0           0           1         0           0
 512                                        0           0         0         0           0           1         0           1
 256                                        0           0         0         0           0           1         1           0
 256                                        0           0         0         0           0           1         1           1
 Power-up default settings                  0           0         0         0           0           1         1           1
Table 14. GPIO Global Configuration Register (0x40)
  REGISTER                                                                                                         DEFAULT
                DESCRIPTION      VALUE                              FUNCTION
     BIT                                                                                                            VALUE
                PORT6/PORT7        0   PORT6/PORT7 operate as GPIOs
      D7                                                                                                                0
                  rotary switch    1   PORT6/PORT7 operate as a rotary switch input
      D6            Reserved       0   —                                                                                0
                                   0   Disabled
                   I2C timeout
      D5                               INTI is asserted when I2C bus times out. INTI is deasserted when a               0
                interrupt enable   1
                                       read is performed on the I2C timeout flag register (0x48).
                                       PWM, constant-current circuits, and GPIs are shut down. GPO
                                       values depend on their setting. Register 0x41 to 0x5F values are
                                   0
                                       stored and cannot be changed. The entire part is shut down if the
      D4          GPIO enable          key switches are in sleep mode (D7 of register 0x01).                            0
                                       Normal GPIO operation. PWM, constant-current circuits, and GPIOs
                                   1
                                       are enabled regardless of key-switch sleep mode state (see Table 8).
                                   0   Normal operation
      D3           GPIO reset          Return all GPIO registers (registers 0x40 to 0x5F) to their POR                  0
                                   1   value. This bit is momentary and resets itself to 0 after the write
                                       cycle.
                                  000  No fading
                                       PWM intensity ramps up (down) between the common PWM value
                                       and 0% duty cycle in 16 steps over the following time period:
                   Fade in/out            D[2:0] = 001 = 256ms
    D[2:0]                                D[2:0] = 010 = 512ms                                                        000
                       time       XXX
                                          D[2:0] = 011 = 1024ms
                                          D[2:0] = 100 = 2048ms
                                          D[2:0] = 101 = 4096ms
                                          D[2:0] = 110/111 = Undefined
www.maximintegrated.com                                                                                  Maxim Integrated │ 25


MAX7360                                     I2C-Interfaced Key-Switch Controller and LED
                                              Driver/GPIOs with Integrated ESD Protection
Table 15. GPIO Control Register (0x41)
 REGISTER                                                                                    DEFAULT
               DESCRIPTION   VALUE                        FUNCTION
    BIT                                                                                       VALUE
                               0   Port is an input
     D7            PORT7                                                                          0
                               1   Port is an output
                               0   Port is an input
     D6            PORT6                                                                          0
                               1   Port is an output
                               0   Port is an input
     D5            PORT5                                                                          0
                               1   Port is an output
                               0   Port is an input
     D4            PORT4                                                                          0
                               1   Port is an output
                               0   Port is an input
     D3            PORT3                                                                          0
                               1   Port is an output
                               0   Port is an input
     D2            PORT2                                                                          0
                               1   Port is an output
                               0   Port is an input
     D1            PORT1                                                                          0
                               1   Port is an output
                               0   Port is an input
     D0            PORT0                                                                          0
                               1   Port is an output
Table 16. GPIO Debounce Configuration Register (0x42)
                                                            REGISTER DATA
        REGISTER DESCRIPTION       D7           D6     D5    D4       D3      D2       D1         D0
                                           RESERVED                      DEBOUNCE TIME
 Power-up default setting
                                    0            0      0     0        0       0        0           0
 debounce time is 9ms
 Debounce time is 10ms              0            0      0     0        0       0        0           1
 Debounce time is 11ms              0            0      0     0        0       0        1           0
 Debounce time is 12ms              0            0      0     0        0       0        1           1
                                                     .
                                                     .
                                                     .
 Debounce time is 37ms              0            0      0     1        1       1        0           0
 Debounce time is 38ms              0            0      0     1        1       1        0           1
 Debounce time is 39ms              0            0      0     1        1       1        1           0
 Debounce time is 40ms              0            0      0     1        1       1        1           1
www.maximintegrated.com                                                            Maxim Integrated │ 26


MAX7360                                          I2C-Interfaced Key-Switch Controller and LED
                                                  Driver/GPIOs with Integrated ESD Protection
Table 17. GPIO Constant-Current Setting Register (0x43)
 REGISTER                                                                                            DEFAULT
                 DESCRIPTION     VALUE                              FUNCTION
     BIT                                                                                              VALUE
    D[7:6]         Reserved        11  Set always as 11                                                  11
    D[5:2]         Reserved       0000 —                                                               0000
                                   00  Constant current is 5mA
                   Constant-       01  Constant current is 6.67mA
    D[1:0]                                                                                               00
                 current setting   10  Constant current is 10mA
                                   11  Constant current is 20mA
Table 18. GPIO Output Mode Register (0x44)
 REGISTER                                                                                            DEFAULT
                 DESCRIPTION     VALUE                              FUNCTION
     BIT                                                                                              VALUE
                                    0  Port is a constant-current open-drain output
      D7             PORT7                                                                                0
                                    1  Port is a non-constant-current open-drain output
                                    0  Port is a constant-current open-drain output
      D6             PORT6                                                                                0
                                    1  Port is a non-constant-current open-drain output
                                    0  Port is a constant-current open-drain output
      D5             PORT5                                                                                0
                                    1  Port is a non-constant-current open-drain output
                                    0  Port is a constant-current open-drain output
      D4             PORT4                                                                                0
                                    1  Port is a non-constant-current open-drain output
                                    0  Port is a constant-current open-drain output
      D3             PORT3                                                                                0
                                    1  Port is a non-constant-current open-drain output
                                    0  Port is a constant-current open-drain output
      D2             PORT2                                                                                0
                                    1  Port is a non-constant-current open-drain output
                                    0  Port is a constant-current open-drain output
      D1             PORT1                                                                                0
                                    1  Port is a non-constant-current open-drain output
                                    0  Port is a constant-current open-drain output
      D0             PORT0                                                                                0
                                    1  Port is a non-constant-current open-drain output
Table 19. Common PWM Register (0x45)
                                                                       REGISTER DATA
          REGISTER DESCRIPTION          D7         D6         D5         D4         D3  D2     D1         D0
                                                                       COMMON PWM
 Power-up default setting (common PWM
                                         0          0          0          0          0   0      0           0
 ratio is 0/256)
 Common PWM ratio is 1/256               0          0          0          0          0   0      0           1
 Common PWM ratio is 2/256               0          0          0          0          0   0      1           0
 Common PWM ratio is 3/256               0          0          0          0          0   0      1           1
                                                        .
                                                        .
                                                        .
www.maximintegrated.com                                                                    Maxim Integrated │ 27


MAX7360                                                  I2C-Interfaced Key-Switch Controller and LED
                                                          Driver/GPIOs with Integrated ESD Protection
Table 19. Common PWM Register (0x45) (continued)
                                                                          REGISTER DATA
         REGISTER DESCRIPTION                    D7        D6       D5      D4      D3       D2       D1         D0
                                                                           COMMON PWM
 Common PWM ratio is 252/256                      1         1        1       1       1        1        0          0
 Common PWM ratio is 253/256                      1         1        1       1       1        1        0          1
 Common PWM ratio is 254/256                      1         1        1       1       1        1        1          0
 Common PWM ratio is 256/256
                                                  1         1        1       1       1        1        1          1
 (100% duty cycle)
Table 20. Rotary Switch Configuration Register (0x46)
                                                                            REGISTER DATA
                                                      D7      D6       D5      D4      D3      D2      D1        D0
           REGISTER DESCRIPTION
                                                     INT
                                                                 COUNTS/CYCLES            DEBOUNCE CYCLE TIME
                                                    TYPE
 No debounce time                                     X       X        X       X        0       0       0         0
 Debounce time is 1ms                                 X       X        X       X        0       0       0         1
 Debounce time is 2ms                                 X       X        X       X        0       0       1         0
 Debounce time is 3ms                                 X       X        X       X        0       0       1         1
                                                               .
                                                               .
                                                               .
 Debounce time is 15ms                                X       X        X       X        1       1       1         1
 No interrupt generated by rotary switch              X        0        0       0      X        X       X         X
 INTI asserted when rotary switch count = ±1           0       0        0       1      X        X       X         X
 INTI asserted when rotary switch count = ±2           0       0        1       0      X        X       X         X
 INTI asserted when rotary switch count = ±3           0       0        1       1      X        X       X         X
                                                               .
                                                               .
                                                               .
 INTI asserted when rotary switch count = ±7           0       1        1       1      X        X       X         X
 INTI asserted 25ms after first debounced event        1       0        0       1      X        X       X         X
 INTI asserted 50ms after first debounced event        1       0        1       0      X        X       X         X
 INTI asserted 75ms after first debounced event        1       0        1       1      X        X       X         X
                                                               .
                                                               .
                                                               .
 INTI asserted 175ms after first debounced event       1       1        1       1      X        X       X         X
 Power-up default setting                              0       0        0       0       0       0       0         0
www.maximintegrated.com                                                                           Maxim Integrated │ 28


MAX7360                                                I2C-Interfaced Key-Switch Controller and LED
                                                        Driver/GPIOs with Integrated ESD Protection
Table 21. I2C Timeout Flag Register (0x48) (Read Only)
 REGISTER                                                                                                             DEFAULT
                DESCRIPTION         VALUE                                   FUNCTION
     BIT                                                                                                               VALUE
   D[7:1]          Reserved        0000000   —                                                                        0000000
                                       0     No I C timeout has occurred since last read or POR
                                                  2
      D0        I2C timeout flag             I2C timeout has occurred since last read or POR. This bit is reset to         0
                                       1     zero when a read is performed on this register. I2C timeouts must be
                                             enabled for this function to work (see Table 8).
Table 22. GPIO Input Register (0x49) (Read Only)
 REGISTER                                                                                                             DEFAULT
                DESCRIPTION        VALUE                                    FUNCTION
     BIT                                                                                                               VALUE
                                       0     Port is input low
      D7            PORT7                                                                                                  1
                                       1     Port is input high
                                       0     Port is input low
      D6            PORT6                                                                                                  1
                                       1     Port is input high
                                       0     Port is input low
      D5            PORT5                                                                                                  1
                                       1     Port is input high
                                       0     Port is input low
      D4            PORT4                                                                                                  1
                                       1     Port is input high
                                       0     Port is input low
      D3            PORT3                                                                                                  1
                                       1     Port is input high
                                       0     Port is input low
      D2            PORT2                                                                                                  1
                                       1     Port is input high
                                       0     Port is input low
      D1            PORT1                                                                                                  1
                                       1     Port is input high
                                       0     Port is input low
      D0            PORT0                                                                                                  1
                                       1     Port is input high
Table 23. Rotary Switch Count Register (0x4A) (Read Only)
                                                                                 REGISTER DATA
          REGISTER DESCRIPTION                      D7         D6        D5        D4         D3       D2          D1       D0
                                                                                  CYCLE COUNT
 Cycle count in two’s complement (see the
 Rotary Switch Configuration Register (0x46)        X          X          X        X          X         X          X         X
 section)
www.maximintegrated.com                                                                                     Maxim Integrated │ 29


MAX7360                                               I2C-Interfaced Key-Switch Controller and LED
                                                         Driver/GPIOs with Integrated ESD Protection
Table 24. PORT0–PORT7 Individual PWM Ratio Registers (0x50 to 0x57)
                                                                                 REGISTER DATA
           REGISTER DESCRIPTION                    D7         D6        D5          D4        D3        D2       D1         D0
                                                                                    PORT PWM
 Power-up default setting (port PWM ratio is
                                                    0          0         0           0         0         0        0          0
 0/256)
 PORT PWM ratio is 1/256                            0          0         0           0         0         0        0          1
 PORT PWM ratio is 2/256                            0          0         0           0         0         0        1          0
 PORT PWM ratio is 3/256                            0          0         0           0         0         0        1          1
                                                                .
                                                                .
                                                                .
 PORT PWM ratio is 252/256                          1          1         1           1         1         1        0          0
 PORT PWM ratio is 253/256                          1          1         1           1         1         1        0          1
 PORT PWM ratio is 254/256                          1          1         1           1         1         1        1          0
 PORT PWM ratio is 256/256 (100% duty cycle)        1          1         1           1         1         1        1          1
Table 25. PORT0–PORT7 Configuration Registers (0x58 to 0x5F)
 REGISTER                                                                                                             DEFAULT
               DESCRIPTION        VALUE                                     FUNCTION
     BIT                                                                                                               VALUE
                                      0      Interrupt is not masked
     D7        Interrupt mask                Interrupt is masked. PORT7 interrupt mask is ignored when the                 0
                                      1
                                             device is configured for rotary switch input.
                                             Rising edge-triggered
                                      0
                 Edge/level                  interrupts                   Interrupts only occur when the GPIO port
     D6                                                                                                                    0
                    detect                   Rising or falling edge-      is configured as an input
                                     1
                                             triggered interrupts
                                     0       Port uses individual PWM intensity register to set the PWM ratio
     D5        Common PWM                                                                                                  0
                                     1       Port uses common PWM intensity register to set the PWM ratio
                                    000      Port does not blink
                                    001      Port blink period is 256ms
                                    010      Port blink period is 512ms
    D[4:2]       Blink period       011      Port blink period is 1024ms                                                 000
                                    100      Port blink period is 2048ms
                                    101      Port blink period is 4096ms
                                  110/111    Undefined
                                     00      LED is on for 50% of the blink period
                                     01      LED is on for 25% of the blink period
    D[1:0]      Blink-on time                                                                                             00
                                     10      LED is on for 12.5% of the blink period
                                     11      LED is on for 6.25% of the blink period
www.maximintegrated.com                                                                                     Maxim Integrated │ 30


MAX7360                                               I2C-Interfaced Key-Switch Controller and LED
                                                       Driver/GPIOs with Integrated ESD Protection
Typical Application Circuit
                                                             +3.3V
                        +14V +14V +1.8V
                                        VCC             COL7
                                                        COL6
                                        PORT0           COL5
                                                                                  KEY 0       KEY 8    KEY 16 KEY 24   KEY 32   KEY 40
                                        PORT1           COL4
                                              MAX7360
                                        PORT2           COL3
                                                                                  KEY 1       KEY 9    KEY 17 KEY 25   KEY 33   KEY 41
                                        PORT3           COL2
     +3.3V
                                        PORT4           COL1
                                                                                  KEY 2     KEY 10     KEY 18 KEY 26   KEY 34   KEY 42
                                        PORT5           COL0
                                        PORT6          ROW7                       KEY 3      KEY 11    KEY 19 KEY 27   KEY 35   KEY 43
                                        PORT7          ROW6
                                                                                  KEY 4     KEY 12     KEY 20 KEY 28   KEY 36   KEY 44
                                                       ROW5
      VCC
          SDA                           SDA            ROW4
                                                                                  KEY 5     KEY 13     KEY 21 KEY 29   KEY 37   KEY 45
          SCL                           SCL            ROW3
      µC
          INTI                          INTI           ROW2
                                                                                  KEY 6     KEY 14     KEY 22 KEY 30   KEY 38   KEY 46
         INTK                           INTK           ROW1
     GND
                                        AD0            ROW0                       KEY 7      KEY 15    KEY 23 KEY 31   KEY 39   KEY 47
                                               GND
Chip Information                                                   Package Information
PROCESS: BiCMOS                                                    For the latest package outline information and land patterns
                                                                   (footprints), go to www.maximintegrated.com/packages. Note
                                                                   that a “+”, “#”, or “-” in the package code indicates RoHS status
                                                                   only. Package drawings may show a different suffix character, but
                                                                   the drawing pertains to the package regardless of RoHS status.
                                                                     PACKAGE TYPE              PACKAGE CODE          DOCUMENT NO.
                                                                        40 TQFN-EP                   T4055+1             21-0140
                                                                           36 WLP                   W362A2+1             21-0301
www.maximintegrated.com                                                                                           Maxim Integrated │ 31


MAX7360                                                                  I2C-Interfaced Key-Switch Controller and LED
                                                                           Driver/GPIOs with Integrated ESD Protection
Revision History
 REVISION          REVISION                                                                                                                         PAGES
                                                                             DESCRIPTION
  NUMBER              DATE                                                                                                                        CHANGED
        0              4/09       Initial release                                                                                                        —
                                  Updated Absolute Maximum Ratings and Notes 7 and 8 (now Notes 6 and 7) in
        1              8/10                                                                                                                          2, 3, 4
                                  Electrical Characteristics
                                  Added the Package Thermal Characteristics section; updated the DfOSC min and
        2              1/13                                                                                                                              2
                                  max values in the Electrical Characteristics
        3              7/19       Updated Blink section                                                                                                 13
For pricing, delivery, and ordering information, please visit Maxim Integrated’s online storefront at https://www.maximintegrated.com/en/storefront/storefront.html.
Maxim Integrated cannot assume responsibility for use of any circuitry other than circuitry entirely embodied in a Maxim Integrated product. No circuit patent licenses
are implied. Maxim Integrated reserves the right to change the circuitry and specifications without notice at any time. The parametric values (min and max limits)
shown in the Electrical Characteristics table are guaranteed. Other parametric values quoted in this data sheet are provided for guidance.
Maxim Integrated and the Maxim Integrated logo are trademarks of Maxim Integrated Products, Inc.                 © 2019 Maxim Integrated Products, Inc. │ 32


Mouser Electronics
Authorized Distributor
Click to View Pricing, Inventory, Delivery & Lifecycle Information:
Maxim Integrated:
 MAX7360ETL+ MAX7360ETL+T MAX7360EWX+T
