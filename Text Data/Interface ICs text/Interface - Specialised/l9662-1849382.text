                                                                                                                       L9662
            Octal squib driver and quad Manchester/PSI5 encoded sensor
                                                                         interface ASIC for safety application
                                                                                                      Datasheet - production data
                                                                              ÔÇ∑ Support PSI5 (Parity) protocol for satellite
                                                                                  sensors (reference PSI5 technical specification
                                                                                  V 1.2 /14.06.07)
                                                                              ÔÇ∑ Support for Sync pulse and minibus for satellites
                                              '!0'03
                                                                              ÔÇ∑ Supports for variable bit rate detection
                   LQFP64 (10x10x1.4mm)                                       ÔÇ∑ Independent current limit and fault timer
                                                                                  shutdown protection for each satellite output
                                                                              ÔÇ∑ Short to ground and short to battery detection
Features                                                                          and reporting for each satellite channel
ÔÇ∑ 8 deployment drivers with SPI selectable firing                             ÔÇ∑ 2 independent SPI interfaces
     current and times                                                        ÔÇ∑ 5.5 MHz SPI interface
ÔÇ∑ Capability to deploy the squib with 1.2 A                                   ÔÇ∑ Satellite message error detection
     (min)/2 ms, 1.75 A (min)/1.0 ms and 1.75 A
     (min)/0.65 ms between VRES of 7 V to 37 V                                ÔÇ∑ Hall effect sensor support on satellite channels
                                                                                  3 and 4.
ÔÇ∑ Capability to deploy the squib with 1.5 A
     (min)/2 ms between VRES of 7 V to 25 V                                   ÔÇ∑ Low voltage internal reset
ÔÇ∑ Firing capability to deploy all channels                                    ÔÇ∑ 2 kV ESD capability on all pins
     simultaneously                                                           ÔÇ∑ Package: LQFP64
ÔÇ∑ Independently controlled high-side and low-                                 ÔÇ∑ Technology: ST Proprietary BCD5
     side MOS for diagnosis
ÔÇ∑ Analog output available for resistance                                      Description
     measurement
                                                                              The device is intended to deploy up to 8 squibs
ÔÇ∑ Squib short to ground, short to battery and
                                                                              and to interface up to 4 satellites. 2 satellite
     MOS diagnostic available on SPI register
                                                                              interfaces can be used to interface Hall sensors.
ÔÇ∑ Capability to deploy the squib the low side                                 Squib drivers are sized to deploy 1.2 A minimum
     MOS is shorted to ground                                                 for 2 ms, 1.75 A minimum for 1 ms and 1.75 A
ÔÇ∑ 4 Fire enable inputs                                                        minimum for 0.65 ms during load dump along with
                                                                              1.5 A minimum for 2 ms for VRES voltages less
ÔÇ∑ Interface with 4 satellite sensors
                                                                              than 25 V.
ÔÇ∑ Programmable independent current trip points
     for each satellite channel                                               Full diagnostic capabilities of the squib interface
                                                                              are provided. Satellite interfaces support
ÔÇ∑ Support Manchester 1 or 2 protocol for satellite                            Manchester 1, 2 and PSI5 decoding with variable
     sensors                                                                  bit rate.
                                                               Table 1. Device summary
            Order code                      Amb. temp range, ÔÇ∞C                       Package                     Packing
               L9662                                                                                                Tray
                                                          -40 to +85                  LQFP64
              L9662TR                                                                                           Tape & Reel
September 2015                                                     DocID028325 Rev 1                                             1/80
This is information on a product in full production.                                                                        www.st.com


Contents                                                                                                                        L9662
Contents
1        Block diagram and pin description . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7
         1.1    Block diagram . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7
         1.2    Pin description . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 8
2        Electrical specifications . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10
         2.1   Absolute maximum ratings . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10
         2.2   Absolute maximum degraded operating ratings . . . . . . . . . . . . . . . . . . . . 11
         2.3    Operating ratings . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12
         2.4    Electrical characteristics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12
                2.4.1    General . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12
                2.4.2    Electrical characteristics - Squib deployment drivers and diagnostics . . 14
                2.4.3    Electrical characteristics - Satellite interface . . . . . . . . . . . . . . . . . . . . . 19
                2.4.4    SPI timing . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24
3        Functional description . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26
         3.1    Overview . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26
         3.2    General functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26
                3.2.1    Power on reset (POR) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26
                3.2.2    RESETB . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26
                3.2.3    Reference resistor . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 27
                3.2.4    Loss of ground . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 27
                3.2.5    VRESx capacitance . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 27
                3.2.6    Supply voltages . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 27
                3.2.7    Ground connections . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 27
         3.3    Serial peripheral interface (SPI) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28
                3.3.1    SPI pin descriptions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28
         3.4    Squib drivers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29
                3.4.1    Firing . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29
                3.4.2    Firing current measurement . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 33
                3.4.3    Fire enable (FEN) function description . . . . . . . . . . . . . . . . . . . . . . . . . 33
                3.4.4    Squib diagnostics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34
                3.4.5    SPI register definition for squib functions . . . . . . . . . . . . . . . . . . . . . . . 39
                3.4.6    Satellite sensor interface . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 55
2/80                                    DocID028325 Rev 1


L9662                                                                                               Contents
            3.4.7  SPI register definition for satellite functions . . . . . . . . . . . . . . . . . . . . . . 65
4     Package information . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 77
      4.1   LQFP64 (10x10x1.4 mm) package information . . . . . . . . . . . . . . . . . . . . 77
5     Revision history . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 79
                                DocID028325 Rev 1                                                            3/80
                                                                                                                  3


List of tables                                                                                                                             L9662
List of tables
Table 1.     Device summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1
Table 2.     Pin description . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 8
Table 3.     Absolute maximum ratings . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10
Table 4.     Absolute maximum degraded operating ratings . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11
Table 5.     Operating ratings . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12
Table 6.     General - DC electrical characteristics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12
Table 7.     Squib deployment drivers and diagnostics - DC electrical characteristics . . . . . . . . . . . . . 14
Table 8.     Satellite interface - DC electrical characteristics. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19
Table 9.     SPI timing - DC electrical characteristics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24
Table 10.    Features that are accessed/controlled for each of the SPIs . . . . . . . . . . . . . . . . . . . . . . . . 28
Table 11.    SPI1 MOSI/MISO response . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 33
Table 12.    How faults shall be interpreted . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 36
Table 13.    High side safing diagnostics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38
Table 14.    Voltage measurement diagnostics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38
Table 15.    MISO responses to various events . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 39
Table 16.    Command description summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 40
Table 17.    Configuration mode 1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 41
Table 18.    Configuration mode 2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 42
Table 19.    Deployment mode 1 bit definition . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 43
Table 20.    Deployment mode 2 bit definition . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 44
Table 21.    Diagnostic selection . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 47
Table 22.    Diagnostic mode LS FET selection. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 47
Table 23.    Diagnostic mode HS FET selection . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 47
Table 24.    Diagnostic mode HSS selection . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 48
Table 25.    Diagnostic mode VRESx selection . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 48
Table 26.    Channel selection . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 49
Table 27.    MOSI diagnostic mode 2 bit definition . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 50
Table 28.    DEPLOY_STATUSx flag and the DEPLOY_SUCCESSx flag conditions. . . . . . . . . . . . . . 51
Table 29.    MOSI monitor mode 2 Bit definition . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 52
Table 30.    Current measurement channel selections . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 52
Table 31.    MOSI monitor mode 3 bit definition. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 53
Table 32.    MOSI monitor mode 3 bit definition. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 55
Table 33.    MCR and CCR settings based on the interfacing to a sensor or satellite . . . . . . . . . . . . . . 64
Table 34.    SPI register definition . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 65
Table 35.    Commands/positions sent out on MOSI along with responses. . . . . . . . . . . . . . . . . . . . . . 66
Table 36.    MOSI MCR bit definition . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 67
Table 37.    Sync pulse high time selections . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 68
Table 38.    Configuration of the IF3/V3 pin . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 68
Table 39.    MOSI CCR bit definition . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 69
Table 40.    MISO responses with D14=0 (Data register selection). . . . . . . . . . . . . . . . . . . . . . . . . . . . 70
Table 41.    Protocol A/B mode configuration . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 72
Table 42.    PSI5 ‚Äì parity protocol (Set in MCR D13:D10). . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 72
Table 43.    Default speed . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 73
Table 44.    On/off condition for satellite and decoder . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 73
Table 45.    Current range supported. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 73
Table 46.    CCR D14 definition . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 74
Table 47.    First response from the ASIC over SPI2e. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 76
Table 48.    LQFP64 (10x10x1.4 mm) package mechanical data . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 78
4/80                                               DocID028325 Rev 1


L9662                                                                                                                List of tables
Table 49. Document revision history. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 79
                                          DocID028325 Rev 1                                                                          5/80
                                                                                                                                          5


List of figures                                                                                                                             L9662
List of figures
Figure 1.    Block diagram . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7
Figure 2.    MOS settling time and turn-on time 2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19
Figure 3.    Sync pulse diagram . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 23
Figure 4.    SPI timing diagram . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25
Figure 5.    MISO Loading for Disable Time Measurement. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25
Figure 6.    POR timing . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26
Figure 7.    Deployment drivers diagram . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30
Figure 8.    Driver activation timing diagram . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 32
Figure 9.    Squib diagnostics block diagram . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 35
Figure 10.   Transmission in asynchronous mode . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 56
Figure 11.   Synchronization pulse timing (single device) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 57
Figure 12.   Synchronization pulse timing (mini bus) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 57
Figure 13.   High voltage mode communication. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 58
Figure 14.   Manchester-1/2 decoding diagram . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 58
Figure 15.   Example of Manchester decoding using satellite protocol . . . . . . . . . . . . . . . . . . . . . . . . . 60
Figure 16.   Satellite protocol-A . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 61
Figure 17.   Generic satellite protocol . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 61
Figure 18.   PSI5 ‚Äì parity satellite protocol . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 62
Figure 19.   Data buffer / data transfer diagram . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 63
Figure 20.   Satellite SPI transfer during normal operation diagram . . . . . . . . . . . . . . . . . . . . . . . . . . . 66
Figure 21.   Combination errors diagram . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 76
Figure 22.   LQFP64 (10x10x1.4 mm) package outline . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 77
6/80                                                DocID028325 Rev 1


L9662                                                                  Block diagram and pin description
1     Block diagram and pin description
1.1   Block diagram
                                                 Figure 1. Block diagram
                                                                                    95(6
                                                                                     95(6
                                             &6B'
                                                                                     95(6    &YUHVB
                                             6&/.
                                                            63,                   95(6
                                             026,
                                             0,62    6TXLE'HSOR\PHQW               95(6
                                                                                     95(6
                                             )(1         'LDJQRVWLFV               95(6    &YUHVB
                                             )(1
                                                                                    95(6
                                             )(1
                                             )(1                                   64+
                                          96',$*                                    64/
                                                                                    *1'
                                         ¬ó)
                                                                                    64+
                      .»ç
      7R$'&                                $287
                                                                                    64/
               ¬ó)                       $*1'                                    *1'
                                              9''                                   64+
                              ¬ó)          *1'   3LQ
                                                                                    64/
                                             *1'   3LQ
                                                                                    *1'
                                             *1'   3LQ               'HSOR\PHQW
                                                                         'ULYHUV   64+
                                           5(6(7                        'LDJQRVWLFV 64/
                                                                                    *1'
                                           7(67
                                             &6B6                                   64+
                                          6&/.B6            63,
                                          026,B6           6DWHOOLWH                64/
                                          0,62B6                                    *1'
                                        ,1,76<1&
                                                                                    64+
                                           96<1&
                                                                                    64/
                             ¬ó)       ¬ó)                                      *1'
                                                                                    64+
                                           96$76
                                         ¬ó)                                      64/
                                                                                    *1'
                                              ,&+
                                                                                    64+
                                              ,&+
       &,&+                                                 6HQVRU
                                              ,&+                                  64/
             &,&+                                          ,QWHUIDFH               *1'
                       &,&+                  ,&+
                                  &,&+                                                    9''
                                            ,)9                                             5,5()
                                            ,)9
                                                                                    ,5()
                                                                                                       *$3*36
                                             DocID028325 Rev 1                                               7/80
                                                                                                                   79


Block diagram and pin description                                                L9662
1.2        Pin description
                                     Table 2. Pin description
  Pin Number    Pin name                        Description       I/O type Reset state
       1          MISO    SPI Data Out                             Output     Hi-Z
       2        MISO_S    Satellite SPI Data Out                   Output     Hi-Z
       3          FEN1    Fire Enable for Channels 0 and 1          Input   Pulldown
       4          FEN2    Fire Enable for Channels 2 and 3          Input   Pulldown
       5        RESETB    Reset pin                                 Input    Pullup
       6          GND     Ground (Analog & Digital)                   -         -
       7          VDD     VDD Supply Voltage                        Input       -
       8          FEN3    Fire Enable for Channels 4 and 5          Input   Pulldown
       9          FEN4    Fire Enable for Channels 6 and 7          Input   Pulldown
       10      INITSYNC   Initiate Sync Pulse                       Input   Pulldown
       11         CS_S    SPI Chip Select for Satellite Interface   Input    Pullup
       12         CS_D    SPI Chip Select for Deployment Driver     Input    Pullup
       13         MOSI    SPI Data In                               Input     Hi-Z
       14       MOSI_S    Satellite SPI Data In
       15       SCLK_S    Satellite SPI Clock                                 Hi-Z
       16         SCLK    SPI Clock                                 Input     Hi-Z
       17         GND4    Power Ground for Loop Channel 4             -         -
       18         SQL4    Low Side Driver Output for Channel 4     Output   Pulldown
       19         SQH4    High Side Driver Output for Channel 4    Output     Hi-Z
       20        VRES4    Reserve Voltage for Loop Channel 4        Input       -
       21        VRES5    Reserve Voltage for Loop Channel 5        Input       -
       22         SQH5    High Side Driver Output for Channel 5    Output     Hi-Z
       23         SQL5    Low Side Driver Output for Channel 5     Output   Pulldown
       24         GND5    Power Ground for Loop Channel 5             -         -
       25         GND6    Power Ground for Loop Channel 6             -         -
       26         SQL6    Low Side Driver Output for Channel 6     Output   Pulldown
       27         SQH6    High Side Driver Output for Channel 6    Output     Hi-Z
       28        VRES6    Reserve Voltage for Loop Channel 6        Input       -
       29        VRES7    Reserve Voltage for Loop Channel 7        Input       -
       30         SQH7    High Side Driver Output for Channel 7    Output     Hi-Z
       31         SQL7    Low Side Driver Output for Channel 7     Output   Pulldown
       32         GND7    Power Ground for Loop Channel 7             -         -
       33         TEST    Test pin                                  Input   Pulldown
8/80                                     DocID028325 Rev 1


L9662                                                        Block diagram and pin description
                         Table 2. Pin description (continued)
  Pin Number Pin name                       Description                  I/O type  Reset state
       34    VSDIAG   Supply for Deployment Driver Diagnostics             Input        -
       35       NC    No Connect                                             -          -
                      Current Feedback for channel 3 Raw Or Raw Data
       36     IF3/V3                                                      Output      Hi-Z
                      output For Channel 3
                      Current Feedback for channel 2 Raw Or Data output
       37     IF2/V2                                                      Output      Hi-Z
                      For Channel 2
       38      GND    Ground (Analog & Digital)                              -          -
       39      ICH3   Current Sense Output for Channel 3                  Output      Hi-Z
       40      ICH2   Current Sense Output for Channel 2                  Output      Hi-Z
       41      ICH1   Current Sense Output for Channel 1                  Output      Hi-Z
       42      ICH0   Current Sense Output for Channel 0                  Output      Hi-Z
       43     VSYNC   Supply for Satellite Sync Pulse                      Input        -
       44     VSATS   Supply Voltage for Satellite Interface               Input        -
       45      GND    Ground (Analog & Digital)                              -          -
       46      IREF   External Current Reference Resistor                 Output        -
       47     AGND    Ground Reference for AOUT                              -          -
       48     AOUT    Analog Output for Loop Diagnostics                  Output      Hi-Z
       49      GND3   Power Ground for Loop Channel 3                        -          -
       50      SQL3   Low Side Driver Output for Channel 3                Output    Pulldown
       51      SQH3   High Side Driver Output for Channel 3               Output      Hi-Z
       52     VRES3   Reserve Voltage for Loop Channel 3                   Input        -
       53     VRES2   Reserve Voltage for Loop Channel 2                   Input        -
       54      SQH2   High Side Driver Output for Channel 2               Output      Hi-Z
       55      SQL2   Low Side Driver Output for Channel 2                Output    Pulldown
       56      GND2   Power Ground for Loop Channel 2                        -          -
       57      GND1   Power Ground for Loop Channel 1                        -          -
       58      SQL1   Low Side Driver Output for Channel 1                Output    Pulldown
       59      SQH1   High Side Driver Output for Channel 1               Output      Hi-Z
       60     VRES1   Reserve Voltage for Loop Channel 1                   Input        -
       61     VRES0   Reserve Voltage for Loop Channel 0                   Input        -
       62      SQH0   High Side Driver Output for Channel 0               Output      Hi-Z
       63      SQL0   Low Side Driver Output for Channel 0                Output    Pulldown
       64      GND0   Power Ground for Loop Channel 0                        -          -
                                    DocID028325 Rev 1                                      9/80
                                                                                                79


Electrical specifications                                                                          L9662
2              Electrical specifications
2.1            Absolute maximum ratings
               The following maximum ratings are continuous absolute ratings; exceeding any one of these
               values may cause permanent damage to the integrated circuit.
                                      Table 3. Absolute maximum ratings
     Symbol                                 Parameter                             Value          Unit
        VDD       Supply voltage                                              - 0.3 to 5.5         V
     VSDIAG       Supply voltage for squib diagnostics                         - 0.3 to 40         V
      VSATS       Satellite supply voltage                                     - 0.3 to 40         V
      VSYNC       Sync supply voltage                                          - 0.3 to 40         V
                  VRES voltage (VRES0, VRES1, VRES2, VRES3, VRES4,
     VRESx                                                                     - 0.3 to 40         V
                  VRES5, VRES6, VRES7)
                  Squib high side drivers (SQH0, SQH1, SQH2, SQH3, SQH4,
      SQHx                                                                     - 0.6 to 40         V
                  SQH5, SQH6, SQH7)
                  Squib low side drivers (SQL0, SQL1, SQL2, SQL3, SQL4,
      SQLx                                                                     - 0.3 to 40         V
                  SQL5, SQL6, SQL7)
       ICHx       Satellite outputs (ICH0, ICH1, ICH2, ICH3)                     -1 to 40          V
      TEST        Test pin                                                     -0.3 to 40          V
                  Discrete input voltage (RESETB, DEPEN, CS_D, CS_S,
         VI       SCLK, SCLK_S, MOSI, MOSI_S, MISO, MISO_S, FEN1,             - 0.3 to 5.5         V
                  FEN2, FEN3, FEN4, INITSYNC, IREF)
                  Discrete output voltage (MISO, MISO_S, AOUT, IF2V2,
         VO                                                                   - 0.3 to 5.5         V
                  IF3V3)
      AGND        Analog output reference                                      -0.3 to 5.5         V
                  Ground (GND, GND0, GND1, GND2, GND3, GND4, GND5,
       GND                                                                     -0.3 to 5.5         V
                  GND6, GND7)
         Tj       Maximum steady-state junction temperature                        150            ¬∞C
       Tamb       Ambient temperature                                           -40 to 95         ¬∞C
        Tstg      Storage temperature                                          -65 to 150         ¬∞C
     Rth j amb    Thermal resistance-junction-to-ambient                            46          ¬∞C/W
 The following maximum ratings are up to 48 hours; exceeding any one of these values for longer than a
 total time of 48 hours may cause permanent damage to the integrated circuit.
        VDD       Supply voltage                                              - 0.3 to 6.0         V
                  Discrete input voltage (RESETB, DEPEN, CS_D, CS_S,
         VI       SCLK, SCLK_S, MOSI, MOSI_S, MISO, MISO_S, FEN1,             - 0.3 to 6.0         V
                  FEN2, FEN3, FEN4, INITSYNC, IREF)
                  Discrete output voltage (MISO, MISO_S, AOUT, IF2V2,
         VO                                                                   - 0.3 to 6.0         V
                  IF3V3)
10/80                                           DocID028325 Rev 1


L9662                                                                                Electrical specifications
                                       Table 3. Absolute maximum ratings
   Symbol                                   Parameter                                 Value            Unit
    AGND          Analog output reference                                          -0.3 to 6.0           V
                   Ground (GND, GND0, GND1, GND2, GND3, GND4, GND5,
      GND                                                                          -0.3 to 6.0           V
                   GND6, GND7)
        Tj         Maximum steady-state junction temperature                           150              ¬∞C
      Tamb        Ambient temperature                                               -40 to 95           ¬∞C
       Tstg        Storage temperature                                             -65 to 150           ¬∞C
    Rth j amb     Thermal resistance junction-to-ambient                                46            ¬∞C/W
2.2           Absolute maximum degraded operating ratings
              Under the following deviations to the ratings indicated in Section 2.3 the device performance
              will be degraded and not meet the electrical characteristics outlined in Section 2.4. At
              minimum the SPI and diagnostics will function but not meet specified electrical parameters.
                           Table 4. Absolute maximum degraded operating ratings
   Symbol                                   Parameter                                 Value            Unit
      VDD          Supply voltage                                                   4.5 to 5.5           V
    VSDIAG         Supply voltage for squib diagnostics                              7 to 40             V
     VSATS         Satellite supply voltage                                          7 to 14             V
    VSYNC          Sync supply voltage                                      (VSATS+ 5.5 V) to 40         V
                   VRES voltage (VRES0, VRES1, VRES2, VRES3, VRES4,
      VRES                                                                           7 to 40             V
                   VRES5, VRES6, VRES7)
                   Discrete input voltage (RESETB, DEPEN, CS_D, CS_S,
        VI         SCLK, SCLK_S, MOSI, MOSI_S, MISO, MISO_S, FEN1,            - 0.3 to (VDD +0.3)        V
                   FEN2, FEN3, FEN4, INITSYNC)
        Tj         Junction temperature                                            -40 to 150           ¬∞C
Note:         The above is provided for informational purposes only and will result in degraded operation.
              Under the above conditions the SPI will be functional as well as diagnostics, though the
              electrical performance may not conform to the parameters outlined in Section 2.4. Firing
              requirements as indicated in Section 2.4 may not be met with the conditions above.
                                                 DocID028325 Rev 1                                         11/80
                                                                                                                 79


Electrical specifications                                                                                                  L9662
2.3            Operating ratings
                                               Table 5. Operating ratings
    Symbol                                    Parameter                                          Value                   Unit
       VDD          Supply voltage                                                            4.9 to 5.1                   V
     VSDIAG         Supply voltage for squib diagnostics                                        7 to 37                    V
      VSATS         Satellite supply voltage                                                    7 to 14                    V
                                                             Continuous                  (VSATS + 6) to 25
      VSYNC         Sync supply voltage (1))                                                                               V
                                                             pulse ‚â§500 ms               (VSATS + 6) to 40
                    VRES voltage (VRES0, VRES1, VRES2, VRES3, VRES4,
      VRESx                                                                                     7 to 37                    V
                    VRES5, VRES6, VRES7)
                    Discrete input voltage (RESETB, DEPEN, CS_D, CS_S,
        VI          SCLK, SCLK_S, MOSI, MOSI_S, MISO, MISO_S, FEN1,                     - 0.3 to (VDD +0.3)                V
                    FEN2, FEN3, FEN4, INITSYNC, IREF)
       Tamb        Ambient temperature                                                         -40 to 95                  ¬∞C
    RTh j-amb       Thermal resistance junction-to-ambient                                         46                   ¬∞C/W
1. For PSI5 the maximum operating voltage is 16.5V as called out in the PSI5 technical specification (V 1.2 /14.06.07).
   Depending on the sync supply voltage the sync pulse can be as high as 8 V above idle. To ensure the maximum operating
   voltage of 16.5 V is not exceeded then the VSATS voltage should be limited to 8.5 V.
2.4            Electrical characteristics
2.4.1          General
               4.9 V ‚â§ VDD ÔÇ£ 5.1 V; 7 V ‚â§ VRESX ‚â§ 37 V; 7 V ‚â§ VSDIAG ‚â§ 37 V; (VSATS + 6.5 V) ‚â§ VSYNC ‚â§
               25 V; 5 V ‚â§ VSATS ‚â§ 14 V; FEN1 = FEN2 = FEN3 = FEN4 = VDD; R_REF = 10 kŒ©, ¬±1%,
               100 PPM; -40 ¬∞C ‚â§ TA ‚â§ +95 ¬∞C; unless other specified.
                                 Table 6. General - DC electrical characteristics
  Symbol                 Parameter                         Test condition                     Min.       Typ.     Max.       Unit
               Internal oscillator             Tested with 10K, 1%, 100ppm Iref
    Osc                                                                                       4.75         -      5.25       MHz
               frequency                       resistor
               Internal voltage reset VDD
   VRST1       after de-glitch time (tpor)     VDD level for device to report reset             4.0        -       4.5        V
               See Figure 6                    condition -deployment drivers are
                                               disabled
               Internal voltage reset VDD Guaranteed by design
   VRST2                                                                                        2.1        -       3.0
               with no de-glitch time See
    tPOR       POR De-glitch timer             Timer for VRST1                                   5         -        25        Œºs
                                               No squib diagnostics. No deployment.
                                                                                                 -         -        15
                                               Satellite channels disabled.
     IDD       Input current VDD               Resistance measurement                                                        mA
                                               diagnostics with no fault condition               -         -        17
                                               present. Satellite channels disabled.
12/80                                               DocID028325 Rev 1


L9662                                                                            Electrical specifications
                       Table 6. General - DC electrical characteristics (continued)
   Symbol             Parameter                       Test condition            Min.    Typ.  Max.   Unit
                                         Resistance measurement
                                         diagnostics running with no fault
                                         condition present. Satellite channels   -        -     17
                                         enabled with
                                         I_ICHx=10mA and no sync pulse.
                                         Resistance measurement
                                         diagnostics running with no fault
                                         condition present. Satellite channels   -        -     17
                                         enabled with
                                         I_ICHx = 50 mA and no sync pulse.
                                         Resistance measurement
                                         diagnostics running with no fault
                                         condition present. Satellite channels
      IDD   Input current VDD                                                    -        -     17    mA
                                         enabled with
                                         I_ICHx = 50 mA and sync pulse at high
                                         voltage level.
                                         Short to -0.3 V on SQHx. Satellite
                                                                                 -        -     15
                                         channels disabled.
                                         Short to -0.3 V on SQLx. Satellite
                                                                                 -        -     15
                                         channels disabled.
                                         Deployment. Satellite channels
                                                                                 -        -     15
                                         disabled.
                                         Short to GND on SQL; VRCM active
                                         Satellite channels enabled with I_ICHx
                                                                                 -        -     35
                                         = 50 mA and sync pulse at
                                         high voltage level.
   RIREF_H                               -                                       -        -   60.0    kÔÅó
            Resistance threshold IREF
   RIREF_L                               -                                      2.0       -           kÔÅó
 VIH_RESETB                              -                                       -        -    2.0     V
            Input voltage threshold
 VIL_RESETB                              -                                      0.8       -            V
            RESETB
  VHYS_RST                               -                                      100       -    300    mV
            Input voltage threshold
   VIH_TEST                              Guaranteed by design                    -       3.2           V
            TEST
   ITESTPD  Input pull-down current TEST -                                      1.0       -    2.5    mA
                                         AOUT short to ground during squib
 IAOUT_SHRT AOUT pin current limit                                               -        -     20    mA
                                         resistance diagnostics
            Input pull-up current
  IRESETPU                               RESETB = VIH to GND                    -10       -    -50    ŒºA
            RESETB
            Current consumption          Satellite channels enabled
    IVSATS                                                                       -        -      5    mA
            VSATS                        ICH0-3 = 0 A
                                         Satellite channels enabled
    IVSYNC  VSYNC supply current                                                 -        -      5    mA
                                         ICH0-3 = 0 A
                                              DocID028325 Rev 1                                      13/80
                                                                                                           79


Electrical specifications                                                                              L9662
                        Table 6. General - DC electrical characteristics (continued)
  Symbol               Parameter                      Test condition           Min.      Typ.     Max.  Unit
              Quiescent current for       Current per pin during HSS test
     IRESx                                                                        -        -       10    ŒºA
              VRESx during HSS test       excluding selected channel
       VIH    Input voltage threshold     Input Logic = 1                         -        -      2.0     V
              (MOSI, MOSI_S, SCLK,
       VIL    SCLK_S, CS_S, CS_D)         Input Logic = 0                       0.8        -        -     V
    VHYST     Input hysteresis            -                                     100        -      300   mV
              Input leakage current       VIN = VDD                               -        -        1    ŒºA
     ILKGD    MOSI, MOSI_S, SCLK,
              SCLK_S                      VIN = 0 to VIH                         -1        -        -    ŒºA
              Input pull-up current CS_S,
    IPU_CS                                VIN = VIH to GND                      -10        -      -50    ŒºA
              CS_D
              Input pull-down current
     IPD_IS                               VIN = VIL to VDD                       10        -       50    ŒºA
              INITSYNC
                                                                               VDD‚Äì
      VOH     Output voltage MISO,        IOH = -800 ŒºA                                    -        -     V
                                                                                0.8
              MISO_S
      VOL                                 IOL = 1.6 mA                            -        -      0.4     V
              Tri-state current MISO,     MISO = VDD                              -        -        1    ŒºA
      IHI_Z
              MISO_S,                     MISO = 0 V                             -1        -        -    ŒºA
2.4.2         Electrical characteristics - Squib deployment drivers and diagnostics
              4.9 V ÔÇ£ VDD ÔÇ£ 5. 1V; 7 V ÔÇ£ VRESX ÔÇ£ 37 V; 7 V ÔÇ£ VSDIAG ÔÇ£ 37 V; (VSATS + 6.5 V) ÔÇ£ VSYNC ÔÇ£ 25 V;
              7 V ÔÇ£ VSATS ÔÇ£ 14 V; FEN1 = FEN2 = FEN3 = FEN4 = VDD; R_REF = 10 kŒ©, ¬±1%, 100 PPM;
              CVRES0_3‚â• 68 nF; CVRES4_7 ‚â• 68 nF; -40 ¬∞C ÔÇ£ TA ÔÇ£ +95 ¬∞C; unless other specified.
                Table 7. Squib deployment drivers and diagnostics - DC electrical characteristics
    Symbol                Parameter                 Test condition        Min.      Typ.     Max.      Unit
 General
                                             VSDIAG = VDD = 0,
    ILKGSQH     Leakage current SQH                                         -         -       50       ŒºA
                                             VRES = 37 V, VSQH = 0 V
                                             VSDIAG = 18 V; VDD = 5 V;
   ILKGVRES     Bias current VRESX           VRES = 37 V; SQH shorted       -         -       10       ŒºA
                                             to SQL
                                             VSDIAG = VDD = 0,
    ILKGSQL     Leakage current SQL                                        -10        -       10       ŒºA
                                             VSQL = 18 V
        IPD     Pulldown current SQL         VSQL = 1.5 V to 20 V          3.3        -       4.1      mA
      VBIAS     Diagnostics Bias voltage     Nominal 3.6 V                -5%    VDD*0.72    +5%        V
 Short to battery/ground Diagnostics - Rsqb from 0 Œ© to Open
                Maximum Diagnostics Bias     Short to battery or ground
     ISVRCM                                                                 5         -       20       mA
                Current limit                test active VSQH = 0 V
14/80                                          DocID028325 Rev 1


L9662                                                                         Electrical specifications
                Table 7. Squib deployment drivers and diagnostics - DC electrical characteristics
    Symbol               Parameter                 Test condition       Min.   Typ.     Max.     Unit
                                            Vbatt = 6.5V see Figure 9   1.92     -      3.42      kŒ©
               Short to Battery Resistance
      RSTB                                  Vbatt = 16V see Figure 9    8.61     -     13.98      kŒ©
               Threshold
                                            Vbatt = 20V see Figure 9    11.42    -     18.42      kŒ©
               Short to battery current
       ISTB                                 -                            0.9     -      1.40     mA
               threshold
      RSTG     Short to Ground Threshold    -                            1.2     -       1.8      kŒ©
               Short to ground current
       ISTG                                 -                             2      -       3.3     mA
               threshold
                                            From/CS ÔÇ≠ until Transistor
                                            Test Results are Valid,
                                            Output voltage change 0V to
 tDIAGTIMEOUT Diagnostic Delay Time         3.5 V                         -      -      1500      Œºs
                                            CSQHx= 0.12 ŒºF
                                            CSQLx= 0.12 ŒºF
 High side safing diagnostics
               Diagnostic current into
   ISRC_HSS    selected VRESx pin during    Normal conditions            710     -       950      ŒºA
               test
                                            All 8 VRESx pins tied
     IHSS_8    Current during diagnostic                                 710     -      1020      ŒºA
                                            together
               Normal resistance range
                                            All 8 VRESx pins tied
 RHSSNORM_th when running high side                                      1.4     -       2.5      kŒ©
                                            together
               safing diagnostics
               Normal voltage range
  VHSSNORM_r between VSDIAG and             All 8 VRESx pins tied
                                                                         1.0     -       2.5       V
       ange    VRESx pin) when running      together
               high side safing diagnostics
               Short voltage threshold
                                            All 8 VRESx pins tied
 VHSSSHORT_th between VSDIAG and                                         0.5     -       1.0       V
                                            together
               VRESx pin)
               Open voltage threshold
                                            All 8 VRESx pins tied
 VHSSOPEN_th between VSDIAG and                                          2.5     -       4.0       V
                                            together
               VRESx pin)
                                            From/CS ‚Üë until transistor
                                            test results are valid,
 tDIAGTIMEOUT Diagnostic delay time                                       -      -       500      Œºs
                                            CSQHx= 0.12 ŒºF
                                            CSQLx= 0.12 ŒºF
 Voltage measurement diagnostics (VRESx)
               Max diagnostic current into
      IRESx                                 Normal conditions             -      -        50      ŒºA
               VRESx pin
               Low voltage threshold for
 VVRESXLO_th                                -                            5.0     -         7       V
               VRESx pin
                                              DocID028325 Rev 1                                    15/80
                                                                                                         79


Electrical specifications                                                                                L9662
                Table 7. Squib deployment drivers and diagnostics - DC electrical characteristics
     Symbol              Parameter                          Test condition           Min.  Typ.   Max.   Unit
               High voltage threshold for
  VVRESXHI_th                                        -                               13.7    -    18.0    V
               VRESx pin
                                                     From/CS ‚Üë until transistor
 tDIAGTIMEOUT Diagnostic delay time                                                     -    -     100    Œºs
                                                     test results are valid.
 MOS diagnostics
                                                     Normal conditions
      I_MOS    MOS test max current                                                     -    -   ISDIAG  mA
                                                     guaranteed by design
                                                     Time is measured from the
               LS/HS MOS turn off under
    tSHUTOFF                                         valid LS/ HS MOS current >         -    -       4    Œºs
               fault condition
                                                     100mA to the LS/HS turn off
   tFETtimeout FET timeout                           Normal conditions                  -    -     100    Œºs
 High Squib resistance diagnostics
               High load resistance
     RSQHIZ                                          -                               1.07    -     2.1   kÔÅó
               threshold
               High resistance current
        IHR                                          -                                     ISTG          mA
               threshold
                                                     From/CS ‚Üë until Transistor
 tDIAGTIMEOUT MOS diagnostic delay time              test results are valid, CSQHx=     -    -     300    Œºs
                                                     0.12 ŒºF CSQLx = 0.12 ŒºF
 Squib resistance diagnostics
                                                     High saturation voltage;                     VDD-
        VOH                                                                             -    -            V
                                                     IAOUT = -500 ŒºA                              0.2V
               Output voltage AOUT
                                                     Low Saturation Voltage;
        VOL                                                                             -    -     0.2    V
                                                     IAOUT = +500 ŒºA
                                                     AOUT = VDD                         -    -       1   ŒºA
         IZ    Tri-State Current AOUT
                                                     AOUT = 0 V                        -1    -       -   ŒºA
  RSQB RANGE Load Resistance Range                   -                                3.5    -    10.0    Œ©
               Resistance measurement                                               VAOUT-      VAOUT+
                                                     0 ÔÅó ÔÇ£ RSQB < 3.5 ÔÅó                      -            V
               analog output tolerance                                              0.095V      0.095V
      VAOUT    VAOUT =
                        1- + ÔÉ¶ 0.08 R SQBÔÉ∂                                          VAOUT¬∑      VAOUT¬∑
               VDD ÔÉó -----         ÔÉó --------------- 3.5 ÔÅó ÔÇ£ RSQB ÔÇ£ 10 ÔÅó                     -            V
                        10 ÔÉ®               ÔÅó ÔÉ∏                                      0.95V        1.05V
               Resistance measurement                VDD = 5.0 V; VSDIAG = 7.0 V
       ISRC                                                                           38     -      42   mA
               current source                        to 37 V
               Resistance measurement
       ISINK                                         -                                45     -      57   mA
               current sink
      ISLEW    Rmeas current di/dt                   30% - 70% of ISRC                 2     -      11  mA-Œºs
               Voltage threshold on squib
      Vcmpr                                          -                               2.65    -    3.25    V
               pin to shutdown ISRC
16/80                                                  DocID028325 Rev 1


L9662                                                                             Electrical specifications
                Table 7. Squib deployment drivers and diagnostics - DC electrical characteristics
    Symbol               Parameter                   Test condition         Min.   Typ.     Max.     Unit
               Time after voltage threshold
               crossed for squib pin to
   tisrcshtdwn                                Guaranteed by design            -      -       30       Œºs
               shutdown
               IISRC
               Voltage threshold on squib
   VLSDrsqb                                   -                              0.8     -       2.2      V
               pin to shutdown ISRC
                                              Wait time before AOUT
     tR_WAIT   Rmeas wait time 6              voltage is stable for ADC       -      -       300      Œºs
                                              reading
 FENx Input pins
    tFENfilter Minimum pulse width            -                              12      -       16       Œºs
      IFENPD   Internal pull-down current     VIN = VIL to VDD               20      -       50       ŒºA
    VFENLO     Input low voltage threshold    -                              0.8     -                V
     VFENHI    Input high voltage threshold   -                               -      -       2.0      V
  TFENLATCH    FEN Latch timer                -                               0      -       512      ms
               FEN latch timer
      tFLACC                                  -                            - 20%     -       20       %
               accuracy
 Deployment drivers
 TRESOLUTION Diagnostic timing / resolution Guaranteed by design,           22.5    25      27.5      Œºs
                                              IHS ‚â• IMEAS,
               Diagnostic timing              0s ‚â§ TMEASURE_TIME ‚â§ 3.7 ms
  TACCURACY                                                                   -      -        2      LSB
               accuracy                       CSQUIB _HI = 0.12 ŒºF
                                              CSQUIB _LO = 0.12 ŒºF
               High side driver current limit                              IHSX x          IHSX x
       IMEAS                                  Guaranteed by design                   -                A
               detect threshold                                             0.90            0.99
               HS or LS breakdown
  Vbreakdown                                  Voltage across driver = 40 V    -      -       50       ŒºA
               voltage
                                              High side MOS +
               Total high and low side MOS
  RDSonTOTAL                                  low side MOS D9:D8=‚Äù11‚Äù;        -      -       2.0      Œ©
               on resistance
                                              VRES = 7 V; I = 1.6A @95 ¬∞C
   RDSonHS     High side MOS on resistance D9:D8=‚Äù11‚Äù; VRES = 7 V;            -     0.3      0.8      Œ©
    RDSonLS    Low side MOS on resistance IVRES = 1.6 A;                      -     0.6      1.2      Œ©
                                                DocID028325 Rev 1                                      17/80
                                                                                                             79


Electrical specifications                                                                      L9662
                  Table 7. Squib deployment drivers and diagnostics - DC electrical characteristics
    Symbol                Parameter                  Test condition        Min. Typ.  Max.     Unit
                                             Configuration mode 1 bits
                                             D9:D8=‚Äù00‚Äù SQHx shorted
     IHS_12A                                                               1.21   -   1.47       A
                                             to ground;
                                             VRES = 7 to 37 V
                                             Configuration Mode 1 bits
                High side deployment current D9:D8=‚Äù01‚Äù SQHx shorted
     IHS_15A                                 to ground;                    1.51   -   1.85       A
                limit
                                             VRES = 7 to 25 V
                                             Configuration Mode 1 bits
                                             D9:D8=‚Äù11‚Äù SQHx shorted
    IHS_175A                                 to ground;                    1.76   -   2.14       A
                                             VRES = 7 to 37 V
                Low side MOS shutdown
       tILIM                                 Vsqblo=18 V                    90    -    110      Œºs
                under short to battery
        ILS     Low side MOS current limit                                 2.2    -    4.0       A
                                             Time from fire command
                                             CS_D rising edge to where
                                             firing current remains within
      tsettle   Firing current settling time specified limits                -    -    150      Œºs
                                             CSQUIB _HI = 0 to 0.12 ŒºF
                                             CSQUIB _LO = 0 to 0.12 ŒºF
                                             VRES = 7 to 37 V@ IHS_12A
                                             VRES = 7 to 25 V@ IHS_15A
  tDEPLOY-2ms                                For IHS_12A and IHS_15A       2.15   -    2.5      ms
                                             Firing Measured from CS_D
                                             rising edge
                                             VRES = 7 to 37 V
                Deployment time              For IHS_175A Firing
  tDEPLOY-1ms                                                              1.15   -   1.40      ms
                                             Measured from CS_D rising
                                             edge
                                             VRES = 7 to 37 V
 tDEPLOY-0.65ms                              For IHS_175A Firing current   0.65   -   0.85      ms
                                             Measured from CS_D rising
                                             edge
18/80                                          DocID028325 Rev 1


L9662                                                                               Electrical specifications
                                          Figure 2. MOS settling time and turn-on time 2
                                    ,3($.
                               ,),1$/
                                   ,),1$/
                               ,),1$/
                                                          WVHWWOH
                                                  ,2+                                                 *$3*36
2.4.3          Electrical characteristics - Satellite interface
               4.9 V ‚â§ VDD ‚â§ 5.1 V; 7 V ÔÇ£ VRESX ‚â§ 37V; 7 V ‚â§ VSDIAG ‚â§ 37 V; (VSATS + 6.5V) ‚â§ VSYNC ‚â§ 25
               V; 5 V ‚â§ VSATS ‚â§ 14 V; FEN1 = FEN2 = FEN3 = FEN4 = VDD; R_REF = 10 kŒ©, ¬±1%, 100
               PPM; -40 ¬∞C ‚â§ TA ‚â§ +95 ¬∞C; unless other specified.
                                  Table 8. Satellite interface - DC electrical characteristics
     Symbol             Parameter                      Test condition         Min.    Typ.     Max.    Unit
                Current limit per channel
 IICHx_IDLELim during communication           High side short to -0.3 V        -75      -      -150     mA
                voltage level
                Current limit per channel
   IICHx_HVLim                                High side short to -0.3 V       -100      -      -280     mA
                during sync voltage level
                VSATS supply current          All channels with High side
   IVSATS_max                                                                   -       -        10     mA
                excluding ICHx current        short to -0.3V
                VSATS supply current
                with one channel in
    IVSATSLIM1                                High side short to -0.3 V         -       -       -40     mA
                current limit during Sync
                Pulse
                VSYNC supply current per
   IVSYNCLIM1   channel with channel in       High side short to -0.3 V        100      -       375     mA
                current limit
                                              ICHx short to battery
                                              V(ICHX)-VSATS > 50 mV
                Short to battery current
 IICHx_SB_OFF                                 50 mV is the maximum              -       -         5     mA
                when driver is OFF.
                                              threshold to switch OFF driver,
                                              TYP is 30 mV
                Max short to battery
  IICHx_SB_ON                                 Guaranteed by design              -       -       25      mA
                current when driver is ON.
                                              VSATS =18 V
 IICHxVSATS_LK VSATS leakage current per
                                              Vcc = VSYNC = 0 V                 -       -        -1     mA
        OFF     channel
                                              measured @ VSATS
                                                    DocID028325 Rev 1                                     19/80
                                                                                                                  79


Electrical specifications                                                                              L9662
                         Table 8. Satellite interface - DC electrical characteristics (continued)
    Symbol              Parameter                    Test condition              Min.    Typ.  Max.    Unit
                                           VSYNC = 25 V
 IICHxVSYNC_LK VSYNC leakage
                                           Vcc = VSATS = 0 V                        -      -     -1    mA
       OFF     current per channel
                                           measured @ VSYNC
                                           VSATS = 18 V measured @ pin
               Output Leakage              under test
   IOUTLEAK                                                                         -      -      1    ŒºA
               Current ICHX                VSYNC = 25 V
                                           Analog interface OFF
                                           I = -150 mA; VSATS = 7 V to 14V
                                                                                    -      -     3.0    V
                                           guaranteed by design
               High side voltage drop
     Vhdp      (VSATS-VICHX) Per           I = -70 mA; VSATS = 7 V to 14 V          -      -     1.5    V
               Channel                     I = -50 mA; VSATS = 7 V to 14 V          -      -     1.0    V
                                           I = -25 mA; VSATS = 7 V to 14 V          -      -     0.5    V
                                           Iout = -5 0 mA                         460      -    540    ŒºA
       IFr     IF/Iout CH3 & CH4
                                           Iout = -5 mA                            46      -     54    ŒºA
                                           SPI channel configuration bit
                                                                                 35.10     -   42.90   mA
                                           <2:0>=111
                                           bit <2:0>=110                         28.80     -   34.20   mA
                                           bit <2:0>=101                         24.85     -   29.15   mA
               Low to high transition      bit <2:0>=100                         20.25     -   24.75   mA
        Itr
               current threshold
                                           bit <2:0>=011                         17.10     -   20.90   mA
                                           bit <2:0>=010                         14.85     -   18.15   mA
                                           bit <2:0>=001                          8.0      -    11.0   mA
                                           bit <2:0>=000                          1.0      -     4.0   mA
               IF/Vx CH3 & CH4 clamp       Rext = 33.0k, 1%;                     0.95*         1.05*
    VCLAMP                                                                                 -            V
               voltage                     CHx is shorted to GND                  Vdd           Vdd
                                           Sink current = Ithr at the output
               Current Threshold           (ICHX).
      Ihyst                                                                     0.05*Itr   -  0.15*Itr mA
               hysteresis                  Ihyst = trip point high ‚Äì trip point
                                           low
                                           Manchester Protocol Excluding
                                           Osc tolerance; bit<8:7>= 00,         11.7%         23.5%
               De-glitch filter as a
      Mdf                                  01, 10, 11. bit Time = the             *bit-    -    *bit-   Œºs
               function of protocol speed
                                           smallest bit time allowed in the      Time          Time
                                           selected range.
20/80                                            DocID028325 Rev 1


L9662                                                                              Electrical specifications
                      Table 8. Satellite interface - DC electrical characteristics (continued)
   Symbol           Parameter                     Test condition            Min.    Typ.     Max.     Unit
                                        Channel configurations bit<8:7>
                                        = 00 Test at frq. = 52.33 kHz      13.32      -     52.33     kHz
                                        Test at frq. =13.32 kHz
            Minimum frequency           bit<8:7> =01Test at frq =110.74
                                                                           26.32      -     110.74    kHz
            operating range (Incoming   kHz Test at frq. = 26.32 kHz
            messages fall within this
     Bitr                               bit<8:7> =10
            operating range is
                                        Test at frq =164.20 kHz            43.50      -     164.20    kHz
            guaranteed to be
                                        Test at frq = 43.50 kHz
            accepted by the IC)
                                        bit<8:7>=11
                                        Test at frq. = 250.63 kHz          62.66      -     250.63    kHz
                                        Test at frq. = 62.66 kHz
                                        Channel configurations bit<8:7>
                                        = 00
                                                                           11.99      -     59.14     kHz
                                        Test at frq. > 59.14 kHz
                                        Test at frq. <11.99 kHz
            Maximum frequency           bit<8:7> =01
            operating range (Incoming   Test at frq > 128.37 kHz           23.57      -     128.37    kHz
            messages fall outside this  Test at frq < 23.57 kHz
     Bitr
            operating range is          bit<8:7> =10
            guaranteed to be rejected
                                        Test at frq >194.93 kHz            38.71      -     194.93    kHz
            by the IC)
                                        Test at frq < 38.71 kHz
                                        bit<8:7>=11
                                        Test at frq > 309.6 kHz            55.37      -     309.6     kHz
                                        Test at frq < 55.37 kHz
                                        CRC disabled:
                                        The idle bit time is based on the
                                        bit time calculated using the
                                        start bits based on the last edge
                                        of previous message to 1st
                                        rising edge (start bit) of new
                                                                          1.5*Tbit    -        -
                                        message If an error is detected
     Idle   Idle time                   then the device shall default to                               Œºs
                                        1.5 times the maximum
                                        frequency (minimum bit time).
                                        No idle time required after
                                        enabling channel
                                                                          1.5*Tbit
                                        CRC enabled:                                  -        -
                                                                           +4Œºs
                                        Test with 10K 1% Iref resistor
                                        check response from changing
  Tdl & Tdh IFx/Vx delay                between the following current        -       1         -       Œºs
                                        levels. High = 0 to 15 mA,
                                        Low = 66 to 15 0mA
                                        ICHX outputs with a 500 Œºs
            IFx/Vx delay time
  Tdl - Tdh                             symmetrical pulse in and 500us       -        -       0.3      Œºs
            differential
                                        out.
                                              DocID028325 Rev 1                                        21/80
                                                                                                             79


Electrical specifications                                                                            L9662
                           Table 8. Satellite interface - DC electrical characteristics (continued)
     Symbol               Parameter                     Test condition          Min.    Typ.   Max.  Unit
                 Output fault filter for short
    tFlt _BATT                                 V(ICHX)-VSATS>50mV                 12       -     16   Œºs
                 to battery
                 Output fault filter for short
     tFlt _GND                                 I_sensor>I_lim                    300       -    360   Œºs
                 to ground
 Receive Mode
                 Output voltage on pin         IICHx= [0‚Ä¶50mA];
       VICHx                                                                   VSAT-1      -   VSAT   V
                 ICHx (x = 1‚Ä¶4)                7V ÔÇ£ VSATS ÔÇ£ 14V
 SYNC Mode and High Voltage mode
                 Output voltage during
                                               7V ÔÇ£ VSATS ÔÇ£ 14V (VSATS+6V) ÔÇ£    VICHx          VICHx
    VICHx_HV     High Voltage Mode and                                                     -          V
                                               VSYNC ÔÇ£ 25V IICHx = 50mA          +4             +8
                 SYNC Mode High time
                 Regulator Drop Out
    VREG_DO                                    IICHx = 50mA                        -       -    2.5   V
                 voltage
                 Delay time from rising        Measured from INITSYNC pin
    tSYNCDLY     edge of INITSYNC pin to       rising edge to 5% of VHV          2.7       -    6.6   Œºs
                 sync pulse voltage active     All Channels
  tSYNC_high1    SYNC pulse high time          -                                -7%       20   + 7%   Œºs
                                               MCR D9:D8=‚Äù00‚Äù
                                               Measured from INITSYNC pin
                 Total delay time from         rising edge to 90% of sync
  tSYNC_dlyhigh1 INITSYNC to sync pulse        pulse falling edge (V ICHx_HV -  20.3       -     28   Œºs
                 falling edge                  V ICHx idle)
                                               All Channels using default slew
                                               rate
  tSYNC_high2    SYNC pulse high time          -                                -7%       30   + 7%   Œºs
                 SYNC pulse high time
  tSYNC_high3    data ‚Äú0‚Äù pulse width (High -                                   -7%       40   + 7%   Œºs
                 voltage mode)
                 SYNC pulse high time
  tSYNC_high4    data ‚Äú1‚Äù pulse width (High -                                   -7%       80   + 7%   Œºs
                 voltage mode)
                                               MCR bit D2=0                     -7%       62   + 7%   Œºs
                                                                                      tSYNC_hi
 tRECV_disable Receiver disable time                                                     ghx
                                               MCR bit D2=1                     -7%            + 7%   Œºs
                                                                                        typ +
                                                                                        20Œºs
                 High Voltage rise slew rate MCR bit D3=0                        0.9       -     2
   triseslewrate                                                                                     V/Œºs
                 for ICHx                      MCR bit D3=1                     0.43       -    1.5
                 High Voltage fall slew rate MCR bit D3=0                        0.9       -     2
   tfallslewrate                                                                                     V/Œºs
                 for ICHx                      MCR bit D3=1                     0.43       -    1.5
22/80                                               DocID028325 Rev 1


L9662                                                                                                          Electrical specifications
                        Table 8. Satellite interface - DC electrical characteristics (continued)
   Symbol              Parameter                            Test condition                           Min.       Typ.          Max.       Unit
              HV current limit active
  tHVILIMDLY                                   Guaranteed by design                                     -         -             12        Œºs
              time following tSYNC_highx
              Capacitance on satellite
    CICHX                                      ICHx pin to CICHX ÔÇ£ 70nH;                               10         -             47        nF
              output for stability (per pin)
INITSYNC input
              Input low voltage
 VINITSYNCLO                                   -                                                        0         -             0.8        V
              threshold
              Input high voltage                                                                                              1.0 x
 VINITSYNCHI                                   -                                                       2.0        -                        V
              threshold                                                                                                       VDD
              Input pulldown
     IISPD                                     VIN = VIL to VDD                                        10         -             50        ÔÅ≠A
              current INITSYNC
 TINITSYNCFLT Minimum pulse width             -                                                        1.7        -             2.1       ÔÅ≠s
                                                      Figure 3. Sync pulse diagram
                                  ,1,76<1&
                                                                W,1,76<1&)/7
                         ,1,76<1&,QSXW0DVNLQJ
                                                                                         W5(&9BGLVDEOH
                            5HFHLYHUB',6$%/(
                                                                              W6<1&BKLJK
                                                                                                                W+9,/,0'/<
                                                                       W6<1&BGO\KLJK
                                                           W6<1&'/<
                                             9,&+[B+9
                                                                                                           
                              9B,&+[
                                                                           
                                             9,&+[B,'/(
                                                  ,,&+[B,'/(/LP                       ,,&+[B+9/LP                        ,,&+[B,'/(/LP
                                                                                                                                       *$3*36
                                                      DocID028325 Rev 1                                                                    23/80
                                                                                                                                                   79


Electrical specifications                                                                                               L9662
2.4.4          SPI timing
               All SPI timing is performed with a 150 pF load on MISO unless otherwise noted
               4.9V ÔÇ£ VDD ÔÇ£ 5.1V; 7V ÔÇ£ VRESX ÔÇ£ 37V; 7V ÔÇ£ VSDIAG ÔÇ£ 37V; (VSATS + 6V) ÔÇ£ VSYNC ÔÇ£ 25V; 5V
               ÔÇ£ VSATS ÔÇ£ 14V; FEN1 = FEN2 = FEN3 = FEN4 = VDD; R_REF = 10KÔÅó, ¬±1%, 100PPM; -
               40¬∞C ÔÇ£ TA ÔÇ£ +95¬∞C; unless other specified.
                  .
                                      Table 9. SPI timing - DC electrical characteristics
   No.       Symbol                            Parameter                              Min.       Typ.       Max.        Unit
    -            fop      Transfer frequency                                           dc          -         5.50       MHz
    1           tSCK      SCLK, SCLK_S period                                         181          -           -         ns
    2          tLEAD      Enable lead time                                             65          -           -         ns
    3           tLAG      Enable lag time                                              50          -           -         ns
    4        tSCLKHS      SCLK, SCLK_S high time                                       65          -           -         ns
    5        tSCLKLS      SCLK, SCLK_S low time                                        65          -           -         ns
    6           tSUS      MOSI, MOSI_S input setup time                                20          -           -         ns
    7            tHS      MOSI, MOSI_S input hold time                                 20          -           -         ns
    8               tA    MISO, MISO_S access time                                      -          -          60         ns
    9         tDIS (1)    MISO, MISO_S disable time                                     -          -         100         ns
   10            tVS      MISO, MISO_S output valid time                                -          -          60         ns
                      (1)
   11         tHO         MISO, MISO_S output hold time                                 0          -           -         ns
   12            tRO      Rise Time (design information)                                -          -          30         ns
   13            tFO      Fall Time (design information)                                -          -          30         ns
   14           tCSN      CS_D, CS_S negated time                                     640          -           -         ns
                          Time between CS rising edge and first transition
                          of SCLK must be higher than tCLKN. It happens
   15          tCLKN                                                                  500          -           -         ns
                          when multiple L9662 are connected to the same
                          SCLK and MOSI but with different chip select.
1. Parameters tDIS and tHO shall be measured with no additional capacitive load beyond the normal test fixture capacitance
   on the MISO pin. Additional capacitance during the disable time test erroneously extends the measured output disable
   time, and minimum capacitance on MISO is the worst case for output hold time.
24/80                                               DocID028325 Rev 1


L9662                                                                                        Electrical specifications
                                    Figure 4. SPI timing diagram
                                                                                             W/$*
              &6B[                                                                                    W &61
                              W/($'     W6&/.+6                                 I23
                                                                                                      W&/.1
      6&/.6&/.B6                                     W 6&/./6
                                                                                                         W',6
                                                    W96                     W+2
                      W$
      0,620,62B6                 06%287                    '$7$              /6%287             '21 7
                                                                                                     &$5(
                                                                                   W52W )2
                         W686                W+6
      026,026,B6               06%,1                     '$7$               /6%,1
                                                                                                              *$3*36
                Figure 5. MISO Loading for Disable Time Measurement
                          9''                 9
                                                                9
                                                                                                0,62
                                 N
                   0,62                                          9
                                                 9
                                 N                                    W',6
                                              &6
                                                                                                              *$3*36
                                    DocID028325 Rev 1                                                             25/80
                                                                                                                          79


Functional description                                                                                L9662
3           Functional description
3.1         Overview
            The device is an integrated circuit to be used in air bag systems. Its main functions include
            deployment of air bags and switched-power sources to satellite sensors. The device
            supports 8 deployment loops and 4 satellite-sensor interfaces.
3.2         General functions
3.2.1       Power on reset (POR)
            The ASIC has a power on reset (POR) circuit, which monitors VDD voltage. When VDD
            voltage falls below VRST1 for longer than or equal to tPOR, all outputs are disabled and all
            internal registers are reset to their default condition. A second reset level, VRST2, also
            monitors VDD but uses no filter time and will disable all outputs and all internal registers are
            reset to their default condition when VDD falls below the reset threshold.
                                           Figure 6. POR timing
                       7325 0LQ
                                                                       7325 0LQd7d7325 0D[
    9''0,1
    9567
    9567
  ,17(51$/
   5(6(7
                                              7325 0LQ d 7d7325 0D[
                                                                                                   *$3*36
3.2.2       RESETB
            The RESETB pin is active low. The effects of RESETB are similar to those of a POR event,
            except during a deployment. When a deployment is in-progress, the ASIC will ignore the
            RESETB signal.
            However, it shall shut itself down as soon as it detects a POR condition. When the
            deployment is completed and RESETB signal is asserted, the device disables its outputs
            and reset its internal registers to their default states.
           A de-glitch timer is provided for the RESETB pin. The timer protects this pin against
            spurious glitches. The ASIC neglects RESETB signal if it is asserted for shorter than
            tGLITCH. RESETB has an internal pull-up in case of an open circuit.
26/80                                        DocID028325 Rev 1


L9662                                                                         Functional description
3.2.3 Reference resistor
      IREF pin shall be connected to VDD supply through a resistor, RIREF. When the device
      detects the resistor on IREF pin is larger than RIREF_H or smaller than RIREF_L, it goes
      into a reset condition. All outputs are disabled and all internal registers are reset to their
      default conditions.
3.2.4 Loss of ground
      GND
      When the GND pin is disconnected from PC-board ground, the ASIC goes in reset
      condition. All outputs are disabled and all internal registers are reset to their default
      conditions.
      GND0-GND7
      A loss of power-ground (GND0 ‚Äì GND7) pin/s disables the respective low side driver/s on
      SQLx. However, the high side driver of the respective channel will still be able to be turned
      on. Thus under the scenario where the low side is shorted to ground the device will be able
      to provide the programmed firing current for the specified time.
      An open GNDx connection on any channel has no affect on the other channels. An open
      GNDx condition will be detected using the low side MOS diagnostics.
      AGND
      The AGND pin is a reference for AOUT pin. When AGND loses its connection, the voltage
      on AOUT pin is pulled up to VDD voltage. The rest of functionality and parametric is not
      affected by a loss of AGND condition.
3.2.5 VRESx capacitance
      To ensure all diagnostics function properly a typical capacitor of equal to or greater than
      68nF is required for every 4 VRESx pins and located close to the supply pins. Thus a
      capacitor will be placed close to the VRES0, 1,2, and 3 pins and a second capacitor will be
      close to the VRES4, 5,6, and 7 pins.
3.2.6 Supply voltages
      The primary current sources for the different functions of the ASIC are as follows:
      ÔÇ∑     VRESx - Firing currents along with HSS and HS FET diagnostic currents
      ÔÇ∑     VSDIAG - Squib resistance and HSS diagnostics
      ÔÇ∑     VSATS - Voltage and current necessary for satellite operation excluding period during
            sync pulse
      ÔÇ∑     VSYNC - Sync pulse voltage
      ÔÇ∑     VDD will be used for all internal functions as well as short to battery/ground and high
            squib resistance diagnostics.
3.2.7 Ground connections
      The GND pins (6, 38, and 45) are all common internal to the ASIC. A ground plane is
      needed to directly connect the GND pins together so that low impedance is maintained
      between the two pins. This ground plane needs to be isolated from the high current ground
      for the squib drivers to prevent voltage shifts.
                                       DocID028325 Rev 1                                           27/80
                                                                                                         79


Functional description                                                                                L9662
3.3         Serial peripheral interface (SPI)
            The device contains 2 serial peripheral interfaces for control of the satellite and squib
            functions. The 2 SPI interfaces are completely independent from each other and can be
            accessed simultaneously. The following table shows the distribution of features that are
            accessed/controlled for each of the SPIs
              .
                       Table 10. Features that are accessed/controlled for each of the SPIs
                Type                    Function                    Pin names         Features accessed
                                                                 SCLK             All Squib Diagnostics
                                                                 MISO             Squib related status
             SPI1        Squib diagnostic & deployment SPI                        information Squib Arming
                                                                 MOSI             and Firing Software Reset
                                                                 CS_D             Component ID & Revision
                                                                                  Satellite Channel
                                                                 SCLK_S
                                                                                  Diagnostics
                                                                 MISO_S
             SPI2        Satellite SPI                                            Satellite Communication
                                                                 MOSI_S           Data
                                                                 CS_S             Channel Configuration
            The software reset accessed over SPI1 will not only reset squib functions but all the satellite
            functions. The device has a counter to verify the number of clocks in SCLK and SCLK_S.
            L9662 computes SPI error length flag by counting the number of SCLK/SCLK_S rising
            edges occurring when CS_D/CS_S is active. If the number of clocks in SCLK is not equal to
            16 clocks while CS_D is asserted, it ignores the SPI message and sends a SPI fault
            response. If the number of clocks in SCLK_S is not equal to 80 clocks while CS_S is
            asserted it ignores the entire SPI message and a fault will be reported in the SR frame. The
            MISO output on SPI1 shall hold the 16th bit‚Äôs state for SCLK rising edges greater than 16
            when CS_D is active, similarly the MISO output on SPI2 shall hold the 80th bit‚Äôs state for
            SCLK_S rising edges greater than 80 when CS_S is active.
3.3.1       SPI pin descriptions
            Chip select (CS_D, CS_S)
            Chip-select inputs select the device for serial transfers. CS_D or CS_S can be asserted at
            any given time and are active low. Both CS_D and CS_S inputs can be selected
            simultaneously. When chip-select is asserted, the respective MISO/MISO_S pin is released
            from tri-state mode, and all status information is latched into the SPI shift register. While
            chip-select is asserted, register data is shifted into MOSI/MOSI_S pin and shifted out of
            MISO/MISO_S pin on each subsequent SCLK/ SCLK_S. When chip-select is negated,
            MISO/MISO_S pin is tri-stated. To allow sufficient time to reload the registers chip-select pin
            shall remain negated for at least tCSN. The chip-select inputs have current sinks which pull
            these pins to the negated state when there is an open circuit condition. These pins have
            TTL level compatible input voltages allowing proper operation with microprocessors using a
            3.3 to 5.0 volt supply.
            Serial clock (SCLK, SCLK_S)
            SCLK/SCLK_S input is the clock signal input for synchronization of serial data transfer. This
            pin has TTL level compatible input voltages allowing proper operation with microprocessors
28/80                                        DocID028325 Rev 1


L9662                                                                          Functional description
      using a 3.3 to 5.0 volt supply. When chip select is asserted, both the SPI master and this
      device shall latch input data on the rising edge of SCLK/SCLK_S. The ASIC shifts data out
      on the falling edge of SCLK/SCLK_S.
      Serial data output (MISO, MISO_S)
      MISO/MISO_S output pins shall be in a tri-state condition when chip select is negated.
      When chip select is asserted, the MSB is the first bit of the word/byte transmitted on
      MISO/MISO_S and the LSB is the last bit of the word/byte transmitted. This pin supplies a
      rail to rail output, so if interfaced to a microprocessor that is using a lower VDD supply, the
      appropriate microprocessor input pin shall not sink more than IOH(min) and shall not clamp
      the MISO/MISO_S output voltage to less than VOH(min) while MISO/MISO_S pin is in a
      logic ‚Äú1‚Äù state.
      Serial data input (MOSI, MOSI_S)
      MOSI/MOSI_S inputs take data from the master processor while chip select is asserted.
      The MSB shall be the first bit of each word/byte received on MOSI/MOSI_S and the LSB
      shall be the last bit of each word/byte received.
      This pin has TTL level compatible input voltages allowing proper operation with
      microprocessors using a 3.3 to 5.0 volt supply.
3.4   Squib drivers
3.4.1 Firing
      The on-chip deployment drivers are designed to deliver 1.2 A (min) for 2 ms (min) and
      1.75 A (min) for 1 ms (min) with VRESx voltages between 7 V and 37 V. In addition the
      device can provide 1.5 A minimum for 2 ms for VRESx voltages between 7 V and 25 V. The
      firing condition is selectable via the SPI. At the end of a deployment, a deploy success flag
      is asserted and can be read using the appropriate SPI command. Each VRESx and GNDx
      connection is used to accommodate 8 loops that can be deployed simultaneously.
      Upon receiving a valid deployment condition, the respective SQHx and SQLx drivers are
      turned on. The only other activation of the SQHx and SQLx drivers is momentarily during a
      MOS diagnostic. Otherwise, SQHx and SQLx are inactive under any normal, fault, or
      transient conditions. Upon a successful deployment of the respective SQHx and SQLx
      drivers, a deploy command success flag is asserted via SPI. Refer to Figure 8 for the valid
      conditions and the deploy success flag timing.
                                         DocID028325 Rev 1                                       29/80
                                                                                                       79


Functional description                                                                                     L9662
                                 Figure 7. Deployment drivers diagram
                                                    *1' 9''      )(1 )(1 )(1      )(1
                         026,
                                                         /RJLF                                 0,62
                         &6B'
                         95(6                                                                 95(6
                                       +6GULYHU                                +6GULYHU
                          64+                                                                 64+
                                        GLDJQRVWLF                           GLDJQRVWLF
                          64/                                                                 64/
                                       /6GULYHU                               /6GULYHU
                          *1'                                                                 *1'
                         95(6                                                                 95(6
                                       +6GULYHU                                +6GULYHU
                           64+                                                                64+
                                        GLDJQRVWLF                           GLDJQRVWLF
                           64/                                                                64/
                                       /6GULYHU                               /6GULYHU
                          *1'                                                                 *1'
                          95(6                                                                95(6
                                       +6GULYHU                                +6GULYHU
                          64+                                                                 64+
                                        GLDJQRVWLF                           GLDJQRVWLF
                          64/                                                                 64/
                                       /6GULYHU                               /6GULYHU
                           *1'                                                                *1'
                          95(6                                                                95(6
                                       +6GULYHU                               +6GULYHU
                           64+                                                                64+
                                        GLDJQRVWLF                           GLDJQRVWLF
                           64/                                                                64/
                                       /6GULYHU                               /6GULYHU
                           *1'                                                                *1'
                                                         $QDORJVTXLE
                                                          
                         ,5()                                                                  $287
                                                         UHVLVWDQFH
                                                         PHDVXUHPHQW
                       96',$*
                                                             $*1'
                                                                                                       *$3*36
30/80                                DocID028325 Rev 1


L9662                                                                         Functional description
      The ASIC shall be protected against inadvertent turn on of the firing drivers unless the
      appropriate conditions are present. Non-typical conditions shall not cause driver activation.
      This includes the case where VRESx and/or VSDIAG pins are connected to a supply up to
      40V and VDD is between 0V and VDD min. Under these conditions the device shall ensure
      that driver activation will not occur. No flow of current shall be allowed through the SQHx
      and SQLx pins.
      Driver activation
      The firing of a squib driver requires the appropriate FEN function to be active and two
      separate sixteen bit writes to be made over the SPI1. The FEN function is defined as the
      result of the FENx pin OR‚Äôd with the internal FENx latch. The FENx pin going high initiates
      the FEN function. With the FEN 1 function being active and the appropriate Arm and Fire
      commands sent then Squib_1 & 2 drivers would be activated. With the FEN 2 function being
      active and the appropriate Arm and Fire commands sent then Squib_3 & 4 drivers would be
      activated.
      With the FEN 3 function being active and the appropriate Arm and Fire commands sent then
      Squib_5 & 6 drivers would be activated. With the FEN 4 function being active and the
      appropriate Arm and Fire commands sent then Squib_7 & 8 drivers would be activated.
      The first write is to ARM the drivers in preparation of receiving the fire command. The Arm
      command will stop on all channels any diagnostics that are active. Any combination of
      squibs can be armed. The second write is to actually activate the desired driver pairs. If
      there is a parity mismatch the data bits will be ignored and the squib drivers will not have
      their status changed, and the two write sequence must then be started again. If there is a
      mismatch in channels selected then only those channels selected in both the Arm and Fire
      commands will be activated.
      During the first write, when the drivers are armed, all diagnostic functions are cleared. The
      FIRE command must follow the ARM command along with the FEN function active in order
      for driver activation. If a command is between the ARM and FIRE command then the
      sequence must be restarted. An error response shall be received for the Fire command if
      the ARM/FIRE sequence is not followed.
      The ARM/FIRE commands and FEN function are independent from each other. The device
      shall begin the tDEPLOY timer once a valid ARM/FIRE sequence has been received. If a valid
      ARM/FIRE command has been sent and the FEN function is inactive then the drivers will
      not be activated but the tDEPLOY timer shall start. If the FEN function becomes active before
      tDEPLOY has expired then the drivers will become active for the full tDEPLOY time. If the FEN
      does not become active before tDEPLOY has expired then the sequence would need to be
      restarted. A diagram illustrating this is shown in Figure 8
                                       DocID028325 Rev 1                                        31/80
                                                                                                      79


Functional description                                                                                   L9662
                                      Figure 8. Driver activation timing diagram
                                                        7LPH
                                                       7'(3/2<
                   63,&RPPDQGV              $      )                       $    $       )
                   )(1)XQFWLRQ
                                                                7'(3/2<                       7'(3/2<
                   'ULYHU$FWLYH
                                                                                              7'(3/2<
                 '(3/2<B67$786
                        )ODJ
                 '(3/2<B68&&(66
                          )ODJ
                                     $ $UP&RPPDQG 'HSO R\PHQW0 RGH
                                     ) )LUH&RP PDQG 'HSO R\PHQW 0RGH                           *$3*36
            Only the channels selected in the ARM and, directly following, the FIRE command will be
            able to be activated.
            By reading the appropriate registers a status of the deployment is provided. If a valid
           Arm/Fire sequence has been provided the status flag will become active. This flag shall
            remain active for as long as the TDEPLOY timer is counting. Depending on the state of the
            FEN function the DEPLOY_STATUS flag will be active a minimum of TDEPLOY and a
            maximum of 2 x TDEPLOY. If driver activation did occur (both a valid Arm/Fire sequence
            and the appropriate FEN function active within the appropriate time) then the
            DEPLOY_SUCCESS flag will be active. This flag will be active until cleared by software. If a
            valid Arm/Fire sequence did occur but the FEN function was never activated within the
            TDEPLOY time then the DEPLOY_SUCCESS flag will remain ‚Äò0‚Äô.
            During driver activation the respective high side (SQHx) and low side (SQLx) drivers will
            turn on for tDEPLOY.
            Device driver activation will not occur or, if firing is in process, will terminate under the
            following conditions:
            ÔÇ∑     Power On Reset (POR)
            ÔÇ∑     IREF resistance is larger than RIREF_H or smaller than RIREF_L
            ÔÇ∑     Loss of ground condition on GND pin
            The following conditions are ignored when driver activation is in-progress:
            ÔÇ∑     RESETB
            ÔÇ∑     Valid soft reset sequences
            ÔÇ∑     SPI1 commands except as noted below Response for ignored commands will be
                  0xD009
            ÔÇ∑     FEN function
32/80                                           DocID028325 Rev 1


L9662                                                                          Functional description
                                    Table 11. SPI1 MOSI/MISO response
              SPI1 MOSI                SPI1 MISO                           Response
       Configuration
                                 SPI fault response    MOSI register mode messages shall be ignored
       Commands
                                                       Execute for channels not in deployment; no effect
       Deployment Commands Command mode
                                                       to deploying channel
                                                       MOSI diagnostic mode messages shall be
       Diagnostic Commands       SPI fault response
                                                       ignored
       Monitor Commands          Status response       Execute for all channels
Note: SPI MISO sent in the next SPI transmission.
      The device can only deploy a channel when the FEN function is active. Once the drivers are
      active the device shall keep the drivers on for the required duration regardless of the FEN
      state. Once completed, a status bit will be set to indicate firing is complete.
3.4.2 Firing current measurement
      All channels have a 7 bit current measurement register that is used to measure the amount
      of time the current is above IMEAS during firing. The maximum measurement for each
      channel is 3.175 ms nominal based on a bit weight of 25 ms. The current measurement
      register shall not increment outside the deployment time. The current measurement will
      begin incrementing once the current has exceeded 95% of the nominal target value. The
      count will continue to increment from the stored value until either a clear command has
      been issued for that channel or all ‚Äò1‚Äôs are present in the corresponding channel
      measurement register. If all ‚Äò1‚Äôs are present for a channel‚Äôs measurement register and
      another firing sequence has been issued the register shall remain all ‚Äò1‚Äôs. Only if a clear
      command has been issued will that particular register be reset to all ‚Äò0‚Äôs. All other channels
      shall keep the stored measurement count. During firing the current measurement register
      cannot be cleared. After a clear command has been issued for a channel then the channel is
      ready to count if the current exceeds the specified level. After a POR or software reset the
      device shall reset all 8 measurement registers to all ‚Äò0‚Äôs.
      A ‚Äúreal-time‚Äù current measurement status of all the channels is available. If a current limit
      status request is sent then the device shall report in the next SPI transfer whether the
      current is above or below IMEAS for each of the channels. The current status results can be
      read at any time and shall correctly report whether current is flowing. The content of the
      internal current status register is captured on the falling edge of chip select during the SPI
      response. The internal status register is updated at a nominal sample time of 25 Œºs and is
      independent of SPI transfers.
      For this circuit there is continuously being performed compensation of the comparator to
      remove offset errors, which is independent from SPI commands. Compensation is
      performed every 12.8 Œºs based on the internal clock.
3.4.3 Fire enable (FEN) function description
      The Fire Enable (FEN) function is the result of the FENx input OR‚Äôd with the internal FEN
      latch. If the FEN latch is not enabled and the FENx pin is low then activation of the FET
      drivers are disabled except as indicated during the MOS test. All internal diagnostic
                                        DocID028325 Rev 1                                          33/80
                                                                                                         79


Functional description                                                                                L9662
            functions, and results, will be available through the serial interface. This pin must be pulled
            high to initiate the FEN latch function (if programmed) and enable firing of the FET drivers.
            The FEN function will be considered active when the pin is active (‚Äò1‚Äô or high) for more than
            12 microseconds. Tolerance range for the filter to be used will be 12 to 16 Œºs.
            When the FENx input is active, ‚Äò1‚Äô, the FEN function will be active. When the FENx input
            state transitions from ‚Äò1‚Äô to ‚Äò0‚Äô, the programmable latching function will hold the FEN
            function active until the timeout of the FEN timer. The programmable latch and hold
            function will be capable of delays of 0ms, 128ms, 256ms, and 512ms. There are 4
            independent timers with the timer for FEN1 associated with channels 1 & 2, timer for FEN2
            associated with channels 3 & 4, timer for FEN3 associated with channels 5 & 6, and the
            timer for FEN4 associated with channels 7 & 8. The timer is reset to the programmed
            time when the FENx pin transitions from ‚Äò0‚Äô to ‚Äò1‚Äô. The programmable counter delay will
            be set through a SPI command.
3.4.4       Squib diagnostics
            Overview
            The ASIC is able to perform the following diagnostics
            ÔÇ∑    Short to battery and ground on both SQHx and SQLx pins with or without a squib
            ÔÇ∑    Loop to loop diagnostics
            ÔÇ∑    Squib resistance measurement
            ÔÇ∑    Squib High resistance
            ÔÇ∑    High Side Safing FET diagnostics
            ÔÇ∑    VRESx voltage status
            ÔÇ∑    High and Low side FET diagnostics
            Below is a block diagram showing the components involved in the squib diagnostics.
34/80                                       DocID028325 Rev 1


L9662                                                                                                                                                 Functional description
                                                    Figure 9. Squib diagnostics block diagram
                                                                                                                                                             +LJKVLGH6DILQJ GLDJQRVWLF
                          96',$*                                                                                     (                                                            +66RSHQ
                                                                                                                                                                      FRPS
                                     5+66
                                                                                                                                                                                  +66VKRUW
                                                                                                                                                                      &/.B+66
                                                                                       ,65&
                                                                                                                                                 '         9ROWDJHPHDVXUHPHQWGLDJQRVWLF
         95(6[             95(6                                                                                    6HO
 Q                                                                                                                                                      9WKB+
                                                                                                                                                                      FRPS        95(6[+,
                                                (
                                                           6HO                                6HO
                                                                         )
                                                                                                                                             6HO
                                                                                                                           &
                                                                                                                                                                      FRPS        95(6[/2
                                                                                                                                                           9WKB/
                 64+[              64+
                                                                                                    $         6HO                        6TXLEUHVLVWDQFHGLDJQRVWLF
                                                                                                                          6HO
        Q                                         ,65&B+66
        5VTXLE                                                                                                                         &DO       *DLQ                    $287
                                                                                                                           &
                 64/[              64/
        Q
                                                                                                                                  6KRUWWR%DWWHU\*URXQG +LJKVTXLEUHVLVWDQFHGLDJQRVWLFV
                    6HO               6HO                                                                                 6HO
                                                      *                      6HO   %                    6HO
                                                                                                                                                             PLUURU
                     ,3'                  ,3'                                                                                                                                   95&0EORFN
                                                                                                                                6*6%/+65
                                                                 ,6,1.
         *1'[              *1'
                                                                                                                                                                                                9ROW
                                                          *1'
                                                                                                                                6%
                                                                                                                                                             PLUURU
                                                                                                                                                                                             *$3*36
                   Short to battery/ground and loop to loop diagnostics
                   The leakage diagnostic includes a short to battery, a short to ground and a short between
                   loop tests. The test will be run for each SQHx and SQLx pin so that shorts can be detected
                   regardless of the resistance between the squib pins.
                   Normal short to battery/ground diagnostics.
                   For the test the internal VRCM is switched on and connected to the selected pin (SQHx or
                   SQLx). The IPD bit will be selected to be OFF which will deactivate the pulldown current on
                   all the channels. During the test if no leakage is present the voltage on the selected SQHx
                   or SQLx pin will be equal to VBIAS and no current is sunk or sourced by VRCM. If a leakage
                   to ground or battery, the VRCM will sink or source a current less than ISVRCM trying to
                   keep VBIAS. Two current comparators, ISTB and ISTG, will detect the abnormal current
                   flow.
                   Loop to loop diagnostics
                   For this test the same procedure is followed except the pulldown current (IPD) is selected to
                   be ON which will deactivate the pulldown current only on the channel under test with all
                   other channel pulldown currents active. If a short to ground fault is active, assuming it was
                   not active during normal short to battery/ground diagnostics, then that particular channel
                   has a short to another squib loop. To detect loop to loop shorts between ASICs in the
                   system the Stop diagnostics command with IPD enabled needs to be sent to the other
                   ASICs before running the loop to loop diagnostics on the channel to be monitored. If the
                   channel being monitored has a short to ground fault active, assuming it was not active
                                                                                   DocID028325 Rev 1                                                                                            35/80
                                                                                                                                                                                                           79


Functional description                                                                                                   L9662
            during normal short to battery/ground diagnostics, then that particular channel has a short to
            another squib loop in the system.
            The following table indicates how faults would be interpreted.
                                         Table 12. How faults shall be interpreted
                                                                                                    Channel leakage
                   Fault condition for              Channel leakage diagnostics
                                                                                              diagnostics results with IPD
                         channel(1)                      results with IPD ON
                                                                                                           OFF
                         No Shorts                              No Fault                                 No Fault
                      Short to battery                         STB Fault                                STB Fault
                    Loop to loop short                         STG Fault                                 No Fault
                      Short to ground                          STG Fault                                STG Fault
            1. Condition where 2 open channels have the SQHx pins shorted will not be detected. If one squib is open
                 and the other has a normal squib connection then the fault will be indicated on the channel that is open.
                Assumes both pins are tested
            Once the command is issued the state of the comparators shall be captured on the next
            falling edge of CS_D. The results are valid after TSHORTDIAG time, which is mainly
            dependent on the external capacitors on the squib lines.
            Squib resistance measurement
            During a resistance measurement, both ISRC and ISINK are switched on and connected to
            the selected SQHx and SQLx channel. A differential voltage is created between the SQHx
            and SQLx pin based in the ISRC current and resistance between the pins. The analog
            output pin, AOUT, will provide the resistance-measurement voltage based on the scaling
            factor indicated in the electrical parameters section. The tri-state output, AOUT, will be
            connected to an ADC input of a microprocessor. When not running squib resistance
            diagnostics the AOUT pin will be high impedance.
            To increase accuracy of the squib resistance measurements the offset of the internal
            amplifier can be provided on the AOUT pin. This is done by setting the appropriate
            calibration bit, waiting the required time, and reading the converted AOUT voltage
            connected to the microprocessor ADC. In test mode, Aout pin can be used as digital/analog
            output for testing deployment and diagnostics comparators and thresholds. Test mode is
            reserved for supplier use only.
            The normal measurement method for squib resistance is to take a single ended analog
            output measurement for a channel (VAOUT with AMC bit=0) and use the tolerances and
            equation shown in the parametric table. The device is also capable of improving the
            tolerance at resistances below 3.5 Ohms by removing the offset of the differential
            comparator. This method involves taking the single ended analog output results for a
            channel (VAOUT with AMC bit=0) and subtracting the internal comparator offset
            measurement of VAOUT_CAL (VAOUT with AMC bit=1). The summary of the equation for this
            is as follows:
                                               AOUT_CAL = (VAOUT ‚Äì VAOUT_CAL)/VDD
                                                  AOUT_CAL typical = 0.08 x RSQUIB
36/80                                             DocID028325 Rev 1


L9662                                                                         Functional description
      High squib resistance diagnostics
      During a high squib resistance diagnostic, VRCM and ISINK are switched ON and
      connected to SQHx and SQLx on the selected channel. Current flowing on SQHx will be
      measured and compared to IHR threshold to identify if resistance is above or below
      RSQHZ. The results shall be reported in the next SPI message. Once the command is
      issued the state of the squib resistance shall be valid after THSR captured on the next
      falling edge of CS_D. The voltage source for this test will be VBIAS which is based on the
      VDD supply.
      High and low side FET diagnostics
      Prior to either the HS or LS FET diagnostics being run it is required to have the VRCM
      switched ON. Running the leakage diagnostics with the appropriate delay time prior to either
      the HS or LS FET diagnostics will precondition the squib pin to the appropriate voltage level.
      When the FET diagnostic command is issued the flags will initially be cleared. Once this is
      complete there is a check to determine if the VRCM is not active or some leakage is
      present. If either of these conditions are present then the MOS will not be turned ON, the
      test will be aborted and the Fault Present (FP) bit will be set. The FEN function must be
      inactive for the channel under test in order to be able to run the test. The test will not start if
      FEN function is active on the channel under test and will result in the FP bit to be set.
      If no leakage is present and FEN function is inactive, the MOS (High side or Low Side) is
      turned ON.
      The device shall monitor the current sink or sourced by VRCM. If the MOS is working
      properly, this current will exceed ISTB (HS test) or ISTG (LS test) and the device shall turn
      off the driver under test within the specified time TSHUTOFF. If the current does not exceed
      ISTB or ISTG then the test will be terminated and the MOS will be switched off by the ASIC
      within TFETTIMEOUT. During the TFETTIMEOUT period the FET Timeout bit will be set
      (FT=1) and will be cleared at the expiration of the timer.
      The results must be compared with the leakage diagnostic results to distinguish between a
      real leakage/short versus a FET fault. For high side FET diagnostics if no faults were
      indicated in the preceding leakage diagnostics then a normal result would be STB = 1;
      STG = 0 (with FT = 0; FP = 0). If the returned results for the high side FET test is not
      STB = 1; STG = 0 (with FT = 0; FP = 0) then either the FET is not functional, a short
      occurred during the test, or there is a missing VRESx connection for that channel. For low
      side FET diagnostics if no faults were indicated in the preceding leakage diagnostics then a
      normal result would be STB = 0; STG = 1 (with FT = 0; FP = 0). If the returned results for the
      low side FET test is not STB = 0; STG = 1 (with FT = 0; FP = 0) then either the FET is not
      functional, a short occurred during the test, or there is a missing GNDx connection for that
      channel.
      On the next falling edge of CS_D, comparator results are latched and reported in the MISO
      response. The results will remain latched until the next test is initiated (diagnostic write
      command). If the test is in progress then a bit is used in the response to indicate the test
      completion. If the FET under test is working properly then the results shall indicate a ‚ÄúShort
      to Ground‚Äù for LS test and ‚ÄúShort to Battery‚Äù for HS test.
      For all conditions the current on SQHx/SQLx will never exceed ISVRCM. On the squib lines
      there will be higher transient currents due to the presence of the filter capacitor.
                                       DocID028325 Rev 1                                           37/80
                                                                                                          79


Functional description                                                                              L9662
            High side safing diagnostics
            When the command is received the ASIC will activate IHSS on the selected VRESx. The
            diagnostics will measure the difference between VSDIAG and VRESx. The internal
            comparator will detect open, short or normal condition based on the differential voltage
            between VSDIAG and VRESx.
            The results shall be reported in the next SPI message using bits HSS1 and HSS0 as
            indicated in the following table. Once the command is issued the voltages shall be captured
            on the next falling edge of CS_D.
                                       Table 13. High side safing diagnostics
                                                                        Diagnostic Mode HSS Selection
                                  Condition
                                                                          HSS1                 HSS0
             (VSDIAG-VRESx) < VHSSSHORT_th                                  0                     0
             VHSSSHORT_th < (VSDIAG-VRESx) < VHSSOPEN_th                    0                     1
             VHSSOPEN_th < (VSDIAG-VRESx)                                   1                     1
            Voltage measurement diagnostics (VRESx)
            When the command is received the ASIC will activate a comparator for the selected
            channel. A 2 bit indication of the state of the VRESx pins shall be reported as indicated
            below. The results shall be reported in the next SPI message. Once the command is issued
            the voltages shall be captured on the next falling edge of CS_D.
                                    Table 14. Voltage measurement diagnostics
                                                                                Diagnostic mode 3
                                    Condition                                    VRESx selection
                                                                             VR1                VR0
             VRESx < VVRESXLO_th                                              0                   0
             VVRESXLO_th < VRESx < VVRESXHI_th                                0                   1
             VVRESXHI_th < VRESx                                              1                   1
            Loss of ground
            When any of the power grounds (GND0 ‚Äì 7) are lost, no deployment can occur on the
            respective deployment channels because the low side driver will be inactive. The high side
            driver for the respective channel can still be activated.
           A loss of ground condition on one or several channels will not affect the operation of the
            remaining channels. When a loss of ground condition occurs, the source of the low side
            MOS will be floating. In this case, no current will flow through the low side driver.
            This condition will be detected as a fault by a low side MOS diagnostic. No additional faults
            will be reported from any other diagnostic due to this condition.
38/80                                        DocID028325 Rev 1


L9662                                                                       Functional description
3.4.5 SPI register definition for squib functions
      The SPI provides access to read/write to the registers internal to the device. All commands
      and responses sent to/from the ASIC on SPI1 shall use set D13 as required for odd parity
      on the 16 bit word. The responses to the commands are sent in the next valid CS_D.
      The table below summarizes the MISO register mode response of various events and MOSI
      messages. After POR event, RESETB negated, and loss of GND, the device sends 0x0000
      in MISO for the first SPI transmission.
      The MISO response shown here is the one received in the next valid SPI transmission after
      each event or MOSI write.
                               Table 15. MISO responses to various events
                           Event/MOSI message                              MISO response
       MOSI Parity error or message error during a deployment     0xD000
       MOSI transmission - Incorrect number of clocks/bits        0xD003
       Incorrect firing sequence received (Firing Command without
                                                                  0xD005
       a valid Arm Command)
       Error due to message not allowed during deployment         0xD009
       POR                                                        0x0000
       RESETB                                                     0x0000
       LOSS OF GND                                                0x0000
       RIREF out of range                                         0x0000
       MOSI Write Soft Reset: $AA                                 0x1X02
       MOSI Write Soft Reset: $55 (after $AA)                     0x2003
Note: X in software reset response should be interpreted as follows: D11=1;D10=0;D9:D8=CL bits
      The SPI fault responses (0xD000 or 0xD003) indicate a fault in the last MOSI transmission.
      The device uses the parity bit to determine the integrity of the MOSI command transmission.
      Squib SPI commands
      The following modes are supported by the squib ASIC using SPI1.
      ÔÇ∑     Configuration mode
      ÔÇ∑     Deployment mode
      ÔÇ∑     Diagnostic mode
      ÔÇ∑     Monitor mode
      The table below is a summary of the modes and the functions that are achieved by sending
      the particular MOSI command. The following sections will provide a full description of bit
      settings for each mode. All commands and responses use D13 to achieve odd parity.
                                        DocID028325 Rev 1                                     39/80
                                                                                                    79


Functional description                                                                                L9662
                                 Table 16. Command description summary
                                                                           Mode bits
  Command/mode                    Description
                                                         D15 D14 D13 D12 D11 D10 D09 D08 D07 - D00
 Configuration commands
                      Current limit programming and
 Config. Mode 1                                           0    0   P    -     -    0     -     -       -
                      software reset
 Config. Mode 2       FEN latch time Programming          0    0   P    -     -    1     -     -       -
 Deployment commands
 Deployment Mode 1 Arming Command                         0    1   P   1      1    0     0    1        -
 Deployment Mode 2 Firing Command                         0    1   P   0      0    0     0    0        -
 Diagnostic commands
 Diagnostic Mode 1    Disable Diagnostic                  1    0   P   -      0    0     0     -       -
                      Short to battery & ground
 Diagnostic Mode 2    diagnostics Short between loop      1    0   P    -     0    0     1     -       -
                      diagnostics
 Diagnostic Mode 3    VRESx voltage diagnostics           1    0   P   -      0    1     0     -       -
 Diagnostic Mode 4    High Side Safing diagnostics        1    0   P   -      0    1     1     -       -
 Diagnostic Mode 5    Squib Resistance Diagnostics        1    0   P   -      1    0     0     -       -
 Diagnostic Mode 6    High Squib Resistance Diagnostics   1    0   P   -      1    0     1     -       -
 Diagnostic Mode 7    LS driver diagnostics               1    0   P   -      1    1     0     -       -
 Diagnostic Mode 8    HS driver diagnostics               1    0   P   -      1    1     1     -       -
 Monitor commands
 Monitor Mode 1       Deployment status                   1    1   P    -     0    0     -     -       -
                      Channel current limit measurement
 Monitor Mode 2                                           1    1   P    -     0    1     -     -       -
                      information
                      FENx function status and active
 Monitor Mode 3                                           1    1   P    -     1    0     -     -       -
                      current limit status
 Monitor Mode 4       Revision and device ID              1    1   P   -      1    1     -     -       -
 P = Parity bit ‚Äì all commands and responses will use this bit to achieve odd parity
             Both the satellite and squib circuits can be reset over when sending the appropriate
             configuration commands via SPI1.
             Configuration commands
             Configuration mode 1
             Configuration mode 1 main functions are as follows:
             ÔÇ∑     Set Deployment current for all channels. All channels will be either set to 1.2 A/2 ms,
                   1.5 A/2 ms (Maximum VRESx Voltage limited to 25 V) 1.75 A/1 ms or 1.75 A/0.65 ms
             ÔÇ∑     Perform a software reset
             The SPI message definition for MOSI commands and MISO responses in this mode are
             defined below.
40/80                                           DocID028325 Rev 1


L9662                                                                                 Functional description
  MSB                                                                                                      LSB
  D15   D14     D13  D12    D11     D10      D9    D8     D7      D6    D5      D4     D3     D2    D1      D0
MOSI Command for Configuration Mode 1
   0     0       P   R/W    SWR       0     CL Set bits              Software Reset Sequence bits
MISO Response for Configuration Mode 1 (Except for Soft Reset/D11=1 and appropriate pattern)
   0     0       P   R/W    SWR       0     CL Set bits    0       0     0       0      0      0     1       0
                                          Table 17. Configuration mode 1
                                        MOSI command                                   MISO response
               bit
                        State                                       Description
              D15         0                                                  See above
                                  Mode bits
              D14         0                                                  See above
              D13                 Odd Parity ‚Äì Includes all 16 bits          Odd Parity ‚Äì Includes all 16 bits
                                  Read (default) - When D12=‚Äô0‚Äô bits D11
                          0
                                  to D0 are ignored
              D12                                                            R/W bit
                                  Write ‚Äì Allows Soft reset and
                          1
                                  deployment programming
                                  Sets Deployment Condition for ALL
                          0       channels - When D11=‚Äô0‚Äô bits D7 to D0
              D11                 are ignored                                See above
                                  Soft Reset Sequence (deployment circuit
                          1
                                  only) ‚Äì bits D8 and D9 are ignored
              D10         0                                                  See above
               D9                 Sets Deployment Conditions                 Internal Stored Value CL bits
                                  00 = 1.2A/2ms (Default)
                          -       01 = 1.5A/2ms
               D8                                                            -
                                  10 = 1.75A/0.65ms
                                  11 = 1.75A/1ms
           D7 ‚Äì D2        -                                                  See above
               D1         -       Software Reset-sequence                    see above
               D0         -                                                  See above
          Bit [D9:D8]          Bits used to set the firing current/time for all channels. The default state
                               is ‚Äò00‚Äô (1.2A/2ms min.)
          Bits [D7:D0]         The soft reset for the ASIC, which includes deployment
                               driver/diagnostics and satellite functions, is achieved by writing 0xAA
                               and 0x55 within two subsequent 16-bit SPI transmissions. If the
                               sequence is broken, the processor will be required to re-transmit the
                               sequence. The device will not reset if the sequence is not completed
                               within two subsequent 16- bit SPI transmissions. When soft reset
                               command is received, the device reset its deployment driver‚Äôs internal
                               logic and timer, satellite internal logic including all internal registers. The
                               effects of a soft reset is the same as a of POR event, except MISO
                               response.
                               Bit D0 used to report the soft reset sequence status. If valid soft reset
                                            DocID028325 Rev 1                                              41/80
                                                                                                                 79


Functional description                                                                                      L9662
                                  sequences are received, bit D0 is set to ‚Äò1.‚Äô Otherwise, bit D0 is set to
                                  ‚Äò0.‚Äô When ASIC receives valid soft reset sequences, it will send a MISO
                                  register mode response containing 0x2003 in the next SPI
                                  transmission.
            Configuration mode 2
            Configuration mode 2 main function is as follows:
            ÔÇ∑     Set the latch time for FENx input
            The SPI message definition for MOSI commands and MISO responses in this mode are
            defined below.
 MSB                                                                                                         LSB
 D15   D14    D13    D12     D11    D10      D9     D8     D7      D6     D5     D4     D3      D2     D1     D0
 MOSI Command for Configuration Mode 2
   0    0      P     R/W      0      1       Latch bits     0       0      0      0       0      0      0      0
 MISO Response for Configuration Mode 2
   0    0      P     R/W      0      1       Latch bits     0       0      0      0       0      0      0      0
                                              Table 18. Configuration mode 2
                                            MOSI command                                  MISO response
                Bit
                            State                                       Description
               D15            0         Mode bits                                See above
               D14            0                                                  See above
               D13                      Odd Parity ‚Äì Includes all 16 bits        Odd Parity ‚Äì Includes all 16 bits
                                        Read (default) - When D12=‚Äô0‚Äô bits D11
                              0                                                  R/W bit
               D12                      to D0 are ignored
                              1         Write ‚Äì FEN latch programming
               D11            0
               D10            1
                D9      00 = 0ms
                        01 = 128ms                                               Internal Stored Value FEN latch
                                        FEN latch time
                D8      10 = 256ms                                               bits
                        11 = 512ms
             D7 ‚Äì D0          0                                                  See above
            Bits [D9:D8]               Bits are used to set the period of the FEN latch timer. The device has
                                       4 independent timers. A valid FENx input will start the pulse stretch
                                       timer. These bits will set the timer duration. These values default to
                                       ‚Äò00‚Äô after a POR event.
            Deployment commands
            The deployment mode is used to activate the drivers. Two consecutive commands are
            required to activate the drivers. Any combination of channels can be fired as long as the
            prerequisite conditions are met as indicated in the previous section.
42/80                                          DocID028325 Rev 1


L9662                                                                                Functional description
           The SPI message definition for MOSI commands and MISO responses in Deployment
           Mode are defined below.
 MSB                                                                                                    LSB
  D15   D14   D13    D12    D11   D10     D9     D8      D7      D6    D5       D4    D3     D2     D1   D0
MOSI Command for Deployment Mode 1
   0     1      P     1      1     0       0      1                     Arming Channel Select
MISO Response for Deployment Mode 1
   0     1      P     1      1     0       0      1                         Armed Channels
MOSI Command for Deployment Mode 2
   0     1      P     0      0     0       0      0                      Firing Channel Select
MISO Response for Deployment Mode 2
   0     1      P     0      0     0       0      0     Channels activated or channels waiting for FEN input
                                  Table 19. Deployment mode 1 bit definition
                                   MOSI command                                    MISO response
              Bit
                       State                                      Description
              D15        0                                            See above
                               Mode bits
              D14        1                                            See above
              D13              Odd Parity ‚Äì Includes all 16 bits      Odd Parity ‚Äì Includes all 16 bits
            D12 ‚Äì D8           Arm pattern                            See above
                         0     Channel 7 Idle (default)
              D7                                                      Internal Deploy Status
                         1     Arm Channel 7
                         0     Channel 6 Idle (default)
              D6                                                      Internal Deploy Status
                         1     Arm Channel 6
                         0     Channel 5 Idle (default)
              D5                                                      Internal Deploy Status
                         1     Arm Channel 7
                         0     Channel 4 Idle (default)
              D4                                                      Internal Deploy Status
                         1     Arm Channel 4
                         0     Channel 3 Idle (default)
              D3                                                      Internal Deploy Status
                         1     Arm Channel 3
                         0     Channel 2 Idle (default)
              D2                                                      Internal Deploy Status
                         1     Arm Channel 2
                         0     Channel 1 Idle (default)
              D1                                                      Internal Deploy Status
                         1     Arm Channel 1
                         0     Channel 0 Idle (default)
              D0                                                      Internal Deploy Status
                         1     Arm Channel 0
                                          DocID028325 Rev 1                                             43/80
                                                                                                              79


Functional description                                                                                    L9662
                                     Table 20. Deployment mode 2 bit definition
                                      MOSI command                                  MISO response
                 Bit
                         State                                      Description
                D15         0     Mode bits                             See above
                D14         1                                           See above
                D13               Odd Parity ‚Äì Includes all 16 bits     Odd Parity ‚Äì Includes all 16 bits
             D12 ‚Äì D8             Arm pattern                           See above
                            0     Channel 7 Idle (default)
                 D7                                                     Internal Deploy Status
                            1     Arm Channel 7
                            0     Channel 6 Idle (default)
                 D6                                                     Internal Deploy Status
                            1     Arm Channel 6
                            0     Channel 5 Idle (default)
                 D5                                                     Internal Deploy Status
                            1     Arm Channel 7
                            0     Channel 4 Idle (default)
                 D4                                                     Internal Deploy Status
                            1     Arm Channel 4
                            0     Channel 3 Idle (default)
                 D3                                                     Internal Deploy Status
                            1     Arm Channel 3
                            0     Channel 2 Idle (default)
                 D2                                                     Internal Deploy Status
                            1     Arm Channel 2
                            0     Channel 1 Idle (default)
                 D1                                                     Internal Deploy Status
                            1     Arm Channel 1
                            0     Channel 0 Idle (default)
                 D0                                                     Internal Deploy Status
                            1     Arm Channel 0
            The Deploy Status becomes ‚Äò1‚Äô when there is a valid fire sequence. Once active it will
            become ‚Äò0‚Äô when the time out has expired waiting FEN activation or when squib driver has
            turned off for fire completion. The same information is available when receiving a response
            from Monitor Mode 1.
            For the drivers to be fire capable the command mode 1 (Arming) must be sent followed by
            command mode 2 (Firing). With this sequence valid and FEN active then firing will begin. A
            break in the sequence will require the process to be restarted. All other bit patterns for D12-
            D8 shall be ignored.
            To begin a deployment 2 consecutive commands need to be sent along with the FEN active
            (external or internal latch). An example of a firing sequence for channel 0 would be as
            follows
            FENx active or inactive
            TX ‚Äì 0x5901 ‚Äì ARM Channel 0
            RX ‚Äì Based on previous command
44/80                                        DocID028325 Rev 1


L9662                                                                       Functional description
      TX ‚Äì 0x5901 ‚Äì ARM Channel 0
      RX ‚Äì 0x5901
      TX ‚Äì 0x5901 ‚Äì ARM Channel 0
      RX ‚Äì 0x5901
      TX ‚Äì 0x6001 ‚Äì Firing on Channel 0 is started on if FEN is active
      RX ‚Äì 0x5901
      TX ‚Äì 0x6001 ‚Äì Command ignored ‚Äì sequence is not allowed
      RX ‚Äì 0x6001
      TX ‚Äì 0x6001 ‚Äì Command ignored
      RX ‚Äì 0xD005
      Alternatively, if the sequence is broken the response shall be as in the following example
      FENx active
      TX ‚Äì 0x5901 ‚Äì ARM Channel 0
      RX ‚Äì Based on previous command
      TX ‚Äì 0x2000 ‚Äì Read of Register Mode 1
      RX ‚Äì 0x5901
      TX ‚Äì 0x6001 ‚Äì Command ignored ‚Äì sequence is not allowed
      RX ‚Äì contents of register
      TX ‚Äì 0x6001 ‚Äì Command ignored ‚Äì sequence is not allowed
      RX ‚Äì 0xD005
      If, for example, channel 0 and 1 bits are set in the Arm command and channel 0 and 7 bits
      are set in the fire command then the result will be the drivers on channel 0 will be activated
      (assuming FEN function is active) and there will be no effect on channel 7.
      During a deployment, any commands directed to the channel that are in deployment are
      ignored and the response shall be 0xD009.
      Diagnostic commands
      Diagnostic Mode 1
      Diagnostic mode main functions are as follows:
      ÔÇ∑      Normal Squib Resistance Diagnostics
      ÔÇ∑      High Squib Resistance Diagnostics
      ÔÇ∑      Squib short to battery/ground diagnostics
      ÔÇ∑      Loop to loop diagnostics
      ÔÇ∑      High side safing diagnostics
      ÔÇ∑      VRESx measurement
      ÔÇ∑      LS and HS FET Test
      The SPI message definition for MOSI commands and MISO responses in Diagnostic Mode
      are defined below.
                                       DocID028325 Rev 1                                        45/80
                                                                                                      79


Functional description                                                                               L9662
            Write commands definition
 MSB                                                                                                  LSB
  D15  D14   D13    D12   D11      D10     D9      D8   D7    D6  D5     D4       D3    D2     D1      D0
 MOSI Command for Diagnostic Mode Execution
   1     0     P     1   Diag. Selection bits       0    0     0   0  IPD_DIS AMC       Channel Selection
 MISO Response for Diagnostic Mode, Stop Diagnostic Selection (MOSI D11:D9=000)
   1     0     P     1      0        0      0       0    0     0   0  IPD_DIS      0            000
 MISO Response for Short to Battery/Ground Selection (MOSI D11:D9=001)
   1     0     P     1      0        0      1     STB  STG     0 SQP IPD_DIS       0    Channel Selection
 MISO Response for Diagnostic Mode, Vresx Selection (MOSI D11:D9=010)
   1     0     P     1      0        1      0     VR1  VR0     0   0  IPD_DIS      0    Channel Selection
 MISO Response for Diagnostic Mode, High Side Safing Selection (MOSI D11:D9=011)
   1     0     P     1      0        1      1    HSS1 HSS0     0   0  IPD_DIS      0    Channel Selection
 MISO Response for Diagnostic Mode, Squib Resistance Selection (MOSI D11:D9=100)
   1     0     P     1      1        0      0       0    0     0   0  IPD_DIS AMC       Channel Selection
 MISO Response for Diagnostic Mode, High Squib Resistance Selection (MOSI D11:D9=101)
   1     0     P     1      1        0      1     HSR    0     0   0  IPD_DIS      0    Channel Selection
 MISO Response for Diagnostic Mode, Low Side FET Test Selection (MOSI D11:D9=110)
   1     0     P     1      1        1      0     STB  STG    FP  FT  IPD_DIS      0    Channel Selection
 MISO Response for Diagnostic Mode, High Side FET Test Selection (MOSI D11:D9=111)
   1     0     P     1      1        1      1     STB  STG    FP  FT  IPD_DIS      0    Channel Selection
            Read commands definition
 MSB                                                                                                   LSB
  D15  D14   D13    D12  D11     D10     D9     D8     D7    D6  D5      D4          D3   D2     D1     D0
 MOSI Command for Diagnostic Mode, READ command
   1    0      P     0     0       0      0      1      1     1   1       0           0          000
 MISO Response for Diagnostic Mode, READ command
                                                                                               Channel
                          Diag. Selection
   1    0      P     0                           X     X     X    X    IPD_DIS       X        Selection
                         bits internal state
                                                                                            Internal State
            Bits D13                   Parity bit. Command and response will use odd parity
            Bits D12                   R/W
                                       1 = Write (execute command)
                                       0= Read
            For bits D11:D09 the following table shall be used for diagnostic selection.
46/80                                         DocID028325 Rev 1


L9662                                                                              Functional description
                                        Table 21. Diagnostic selection
                                                      Bits                 Current        Comparator or
                 Diagnostic
                                                                      source active          amplifier
                                            D11       D10      D9
       Stop Diagnostic                        0        0        0            NO                  NO
                                                                                              Y (Comp
       Short to Battery/Ground                0        0        1        Y (VMRC)
                                                                                            ISTB/ISTG)
       VRESx Diagnostic                       0        1        0             N          Y (Comp VRESx)
       High Side Safing Diagnostics           0        1        1         Y (IHSS)        Y (Comp HSS)
       Squib Resistance Diagnostics           1        0        0     Y (ISRC/ISINK)          Y (Ampli)
      High Squib Resistance
                                              1        0        1        Y (VMRC)         Y (Comp IHR)
      Diagnostics
                                                                                              Y (Comp
       LS FET test                            1        1        0        Y (VMRC)
                                                                                            ISTB/ISTG)
                                                                                              Y (Comp
       HS FET test                            1        1        1        Y (VMRC)
                                                                                            ISTB/ISTG)
      STB/STG bit Definition with MOSI D11:D9=001 (Leakage Test)
           STB bit Bit used for indicating leakage to battery.
                0 = No leakage to battery
                1 = Short to battery / HS Driver test pass
           STG bit Bit used for indicating leakage to ground.
                0 = No leakage to battery
                1 = Short to ground / LS Driver test pass
      STB/STG bit Definition with MOSI D11:D9=110 (LS FET)
      STB, STG bits see table below
                                Table 22. Diagnostic mode LS FET selection
                                    Condition                                      STB             STG
                  Test in Process (FT=1); Fault (FP=1); or LS
                                                                                    0               0
                       FET/GNDx open fault (FP=0,FT=0)
                       Short to battery occurred during test                        1               0
        Test Pass if leakage diagnostics did not indicate a short to GND            0               1
      STB/STG bit definition with MOSI D11:D9=111 (HS FET)
      STB, STG bits see table below
                               Table 23. Diagnostic mode HS FET selection
                                           Condition                                        STB      STG
      Test in Process (FT=1); Fault (FP=1); or HS FET/VRESx open fault (FP=0,FT=0)            0         0
              Test Pass if leakage diagnostics did not indicate a short to battery            1         0
                              Short to ground occurred during test                            0         1
                                         DocID028325 Rev 1                                              47/80
                                                                                                              79


Functional description                                                                               L9662
            STB/STG bit definition with MOSI D11:D9=011 (High side safing)
            HSS1:HSS0 bits, see table below
                                    Table 24. Diagnostic mode HSS selection
                                      Condition                                   HSS1           HSS0
                          (VSDIAG-VRESx) < VHSSSHORT_th                             0              0
                    VHSSSHORT_th < (VSDIAG-VRESx) < VHSSOPEN_th                     0              1
                           VHSSOPEN_th < (VSDIAG-VRESx)                             1              1
            STB/STG bit definition with MOSI D11:D9=010 (VRESx supply voltage)
            VR1:VR0 bits, see table below
                                  Table 25. Diagnostic mode VRESx selection
                                      Condition                                   VR1             VR0
                                 VRESx < VVRESXLO_th                                0              0
                          VVRESXLO_th < VRESx < VVRESXHI_th                         0              1
                                 VVRESXHI_th < VRESx                                1              1
            STB/STG bit definition with MOSI D11:D9=101 (High squib resistance)
            HSR bit            Bit used for indicating leakage to ground.
                                           0 = Squib Resistance below RSQHIZ
                                           1 = Squib Resistance above RSQHIZ
            Bits D6            Fault present prior to running LS FET or HS FET test (diagnostics
                               aborted)
                                           0 = Normal
                                           1 = Test not run - Fault present (FEN in incorrect state, short
                                                to battery or ground)
            Bits D5            Bit definition based on diagnostic selection.
                                           FT bit Read Only - Used for LS FET or HS FET diagnostics
                                                  and is the status of the FET timer
                                                        0 = FET timer not active
                                                        1 = FET timer active
                                           SQP bit: Squib Pin to be tested during short to
                                                     battery/ground diagnostics
                                                        0 = SQBLx pin test
                                                        1 = SQBHx pin test
            Bits D4            Used to disable IPD on all channels
                                           0 = IPD active as indicated;
                                              ‚Äì Active for all channels except the one under test when
                                                running Short to Battery/Ground and short between loops
                                                Diagnostics and LS/HS FET test
                                              ‚Äì Active for all channels when running Stop Diagnostic,
48/80                                      DocID028325 Rev 1


L9662                                                                           Functional description
                                                resistance Diagnostics, High Squib Resistance
                                                Diagnostics, HSS Diagnostic and VRESx Diagnostics
                                          1 = IPD disabled on all channels
          Bits D3              Bit used for resistance measurement amplifier calibration. Only valid
                               when squib resistance diagnostics is selected, otherwise this bit will be
                               ignored and a 0 will be reported in the response
                                          0 = No calibration (Normal squib resistance measurements)
                                          1 = Calibration
          For bits D2:D0       The following table shall be used for channel selection.
                                           Table 26. Channel selection
                  Channel                 Bit D2                  Bit D1                    Bit D0
                      0                       0                      0                        0
                      1                       0                      0                        1
                      2                       0                      1                        0
                      3                       0                      1                        1
                      4                       1                      0                        0
                      5                       1                      0                        1
                      6                       1                      1                        0
                      7                       1                      1                        1
Note:     Except for short to battery /ground diagnostics and loop to loop test the state of IPD (D4) will
          not affect the test
          Monitor commands
          Monitor Mode 1
          Monitor mode main information:
          ÔÇ∑    Deployment status
          The SPI message definition for MOSI commands and MISO responses in Monitor Mode 1
          are defined below.
 MSB                                                                                                LSB
 D15  D14   D13    D12     D11    D10      D9          D8      D7   D6    D5   D4    D3    D2    D1  D0
MOSI Command for Monitor Mode 1
  1     1    P       0      0      0        0          DS          Channel Selection Status Request
MISO Response for Monitor Mode 1
  1     1    P       0      0      0        0          DS                    Channel Status
                                          DocID028325 Rev 1                                         49/80
                                                                                                           79


Functional description                                                                               L9662
                                  Table 27. MOSI diagnostic mode 2 bit definition
                                     MOSI Command                               MISO Response
              Bit
                     State                                   Description
             D15       1   Mode bits                               See above for state
             D14       1                                           See above for state
             D13           Odd Parity ‚Äì Includes all 16 bits       Odd Parity ‚Äì Includes all 16 bits
             D12       0                                           See above for state
             D11       0   Monitor Mode selection bits             See above for state
             D10       0   Monitor Mode selection bits             See above for state
             D9        0                                           See above for state
                       0   Report Deploy Success Flag (default)
             D8                                                    Internal state of report setting
                       1   Report Deploy Status
                           Keep Deploy Success Flag Channel 7      Deploy Information for channel based on
                       0
             D7            (default)                               bit D8 Will Either be DEPLOY_STATUS7
                       1   Clear Deploy Success Flag Channel 7     or DEPLOY_SUCCESS7
                           Keep Deploy Success Flag Channel 6      Deploy Information for channel based on
                       0
             D6            (default)                               bit D8 Will Either be DEPLOY_STATUS6
                       1   Clear Deploy Success Flag Channel 6     or DEPLOY_SUCCESS6
                           Keep Deploy Success Flag Channel 5      Deploy Information for channel based on
                       0
             D5            (default)                               bit D8 Will Either be DEPLOY_STATUS5
                       1   Clear Deploy Success Flag Channel 5     or DEPLOY_SUCCESS5
                           Keep Deploy Success Flag Channel 4      Deploy Information for channel based on
                       0
             D4            (default)                               bit D8 Will Either be DEPLOY_STATUS4
                       1   Clear Deploy Success Flag Channel 4     or DEPLOY_SUCCESS4
                           Keep Deploy Success Flag Channel 3      Deploy Information for channel based on
                       0
             D3            (default)                               bit D8 Will Either be DEPLOY_STATUS3
                       1   Clear Deploy Success Flag Channel 3     orDEPLOY_SUCCESS3
                           Keep Deploy Success Flag Channel 2      Deploy Information for channel based on
                       0
             D2            (default)                               bit D8 Will Either be DEPLOY_STATUS2
                       1   Clear Deploy Success Flag Channel 2     or DEPLOY_SUCCESS62
                           Keep Deploy Success Flag Channel 1      Deploy Information for channel based on
                       0
             D1            (default)                               bit D8Will Either be DEPLOY_STATUS1
                       1   Clear Deploy Success Flag Channel 1     or DEPLOY_SUCCESS1
                           Keep Deploy Success Flag Channel 0      Deploy Information for channel based on
                       0
             D0            (default)                               bit D8 Will Either be DEPLOY_STATUS0
                       1   Clear Deploy Success Flag Channel 0     or DEPLOY_SUCCESS0
            The DEPLOY_SUCCESSx flag indicates if the corresponding channel‚Äôs drivers were
            activated and that the activation period has completed. This bit is set when the activation
            period has expired. The DEPLOY_SUCCESSx flag will be ‚Äò1‚Äô until it is cleared by writing a
            ‚Äò1‚Äô to the appropriate channel(s) (bits D7-D0).
            The DEPLOY_STATUSx bit will become ‚Äò1‚Äô when there is a valid Arm and Fire sequence for
            the corresponding channel. The DEPLOY_STATUSx bit transitioning from a ‚Äò0‚Äô to a ‚Äò1‚Äô does
            not depend on the state of the FEN function. It will become ‚Äò0‚Äô when time out has expired.
50/80                                        DocID028325 Rev 1


L9662                                                                                Functional description
          Depending on the state of FEN the DEPLOY_STATUSx flag could be ‚Äò1‚Äô for a minimum of 1x
          tDEPLOY and a maximum of up to 2 x tDEPLOY (see Figure 8). The Deployment status is
          captured on the falling edge of CS_D.
          Bit D8 is used to select the meaning of bit D7 through bit D0 in the status response
          message. When this bit is set to ‚Äò1,‚Äô bits D7 through D0 in the status response message will
          report the state of the DEPLOY_STATUSx flag.
          When this bit is ‚Äò0,‚Äô bit D7 through bit D0 in the status response message will report the
          DEPLOY_SUCCESSx flag. The following table 16 shows the conditions for the
          DEPLOY_STATUSx flag and the DEPLOY_SUCCESSx flag.
              Table 28. DEPLOY_STATUSx flag and the DEPLOY_SUCCESSx flag conditions
            DEPLOY_STATUSx flag          DEPLOY_SUCCESSx flag                       Description
                                                                     No Deployment in process or has been
                       0                             0               initiated since POR or since last Clear of
                                                                     Success flag
                       0                             1               Deployment has successfully completed
                       1                             0               Deployment in process
                       1                             1               Deployment terminated / LSD shutdown
          Once the Deploy Success Flag is set, it will inhibit the subsequent deployment command
          until a SPI command to clear this deployment success flag is received. Bits D7 through bit
          D0 are used to clear/keep the deploy success flag. When these bits are set to ‚Äò1,‚Äô the flag
          can be cleared. Otherwise, the state of these flags is not affected. The Success flag must
          be cleared to allow re-activation of the drivers
          Monitor mode 2
          Monitor mode main information:
          ÔÇ∑     Current limit measurement of channels
          The SPI message definition for MOSI commands and MISO responses in Monitor Mode 2
          are defined below.
 MSB                                                                                                      LSB
 D15  D14   D13    D12     D11      D10    D9      D8     D7    D6     D5     D4     D3     D2      D1     D0
MOSI Command for Monitor Mode 2
                                               Current
  1     1     P    CLR       0       1       Measurement         0      0      0      0      0       0      0
                                            Channel Select
MISO Response for Monitor Mode 2
                                               Current
  1     1     P      0       0       1       Measurement                  Current Measurement Data
                                               Channel
                                           DocID028325 Rev 1                                              51/80
                                                                                                                79


Functional description                                                                                     L9662
                                    Table 29. MOSI monitor mode 2 Bit definition
                                       MOSI command                                  MISO response
               Bit
                       State                                      Description
               D15       1                     Mode Bits                            See above for state
               D14       1                                                          See above for state
               D13                 Odd Parity ‚Äì Includes all 16 bits         Odd Parity ‚Äì Includes all 16 bits
                         0            Keep timer measurements                       See above for state
               D12            Clear ‚Äúcurrent measurement time‚Äù stored
                         1                      on the                              See above for state
                                register of channel selected by D9:D7
               D11       0           Monitor Mode selection bits                    See above for state
               D10       1    Monitor Mode selection bits                See above for state
                D9
                              Channel selected for current
                D8            measurement                                Internal Stored channel selections bits
                              See Table 30
                D7
                                                                         Current measurement of selected
              D6:D0      0    -
                                                                         channel
            Bits [D9:D7].             Used when sending the MOSI command to select the channel to be
                                      measured. The MISO response shall echo the MOSI command.
                                Table 30. Current measurement channel selections
                        Channel                       Bit D9                 Bit D08               Bit D07
                            0                            0                      0                      0
                            1                            0                      0                      1
                            2                            0                      1                      0
                            3                            0                      1                      1
                            4                            1                      0                      0
                            5                            1                      0                      1
                            6                            1                      1                      0
                            7                            1                      1                      1
            Bits [D6:D0].             Current measurement data of selected squib channel. Bit weight is
                                      nominally 25 Œºs for a total measurement time 3.175 ms.
            Monitor mode 3
            Monitor mode main information:
            ÔÇ∑     Status of FENx Function - FENx pin OR‚Äôd with Internal FENx latch
            ÔÇ∑     Status of current for each channel
            The SPI message definition for MOSI commands and MISO responses in Monitor Mode 3
            are defined below.
52/80                                         DocID028325 Rev 1


L9662                                                                                Functional description
 MSB                                                                                                     LSB
 D15  D14   D13   D12   D11     D10      D9      D8    D7     D6    D5      D4    D3     D2       D1      D0
MOSI Command for Monitor Mode 3
  1     1    P     0      1      0     CFS        0     0      0     0       0     0      0        0       0
MISO Response for Monitor Mode 3
                                                POR
  1     1    P     0      1      0     CFS            CF7 CF6      CF5     CF4   CF3     CF2     CF1     CF0
                                               STAT
                                 Table 31. MOSI monitor mode 3 bit definition
                                   MOSI command                                  MISO response
             Bit
                    State                                       Description
             D15      1                                              See above for state
                            Mode Bits
             D14      1                                              See above for state
             D13            Odd Parity ‚Äì Includes all 16 bits        Odd Parity ‚Äì Includes all 16 bits
             D12      0                                              See above for state
             D11      1                                              See above for state
             D10      0                                              See above for state
                           Status Type                              0 = current measurement status reported
             D09           0 = Current limit status                 in bit D7:D0
                           1 = FEN function status                  1 = FEN function status reported in D7:D0
             D08      0                                              POR status
                                                                     Current measurement status of channels
            D7:D0     0
                                                                    or FEN status as indicated below
          Bit [D10] POR status
                            0= Reset occurred. Bit cleared when read
                            1= Normal
          With Bit D9 = 1
                            Bit D7:D4     ‚Äò0000‚Äô
                            Bit D3:       0 = FEN4 input or FEN4 latch timer inactive
                                          1 = FEN4 input or FEN4 latch timer active
                            Bit D2        0 = FEN3 input or FEN3 latch timer inactive
                                          1 = FEN3 input or FEN3 latch timer active
                            Bit D1:       0 = FEN2 input or FEN2 latch timer inactive
                                          1 = FEN2 input or FEN2 latch timer active
                            Bit D0:       0 = FEN1 input or FEN1 latch timer inactive
                                           DocID028325 Rev 1                                              53/80
                                                                                                                79


Functional description                                                                                 L9662
                                           1 = FEN1 input or FEN1 latch timer active
Note:       The FEN status is the result of the state of the FEN input pin OR‚Äôd with the FEN latch timer.
            The FEN latch timer will remain inactive until a transition of ‚Äò1‚Äô to ‚Äò0‚Äô on the FEN input
            (assuming the pin was high for a minimum of 16Œºs). At that time the FEN latch timer will be
            active and keep the internal FEN signal active based on the programmed time (0ms, 128ms,
            256ms or 512ms) for that particular FEN function.
            With Bit D9 = 2
                              Bit D7:   0 = Current through channel 7 is below IMEAS
                                        1 = Current through channel 7 is above IMEAS
                              Bit D6:   0 = Current through channel 6 is below IMEAS
                                        1 = Current through channel 6 is above IMEAS
                              Bit D5:   0 = Current through channel 5 is below IMEAS
                                        1 = Current through channel 5 is above IMEAS
                              Bit D4:   0 = Current through channel 4 is below IMEAS
                                        1 = Current through channel 4 is above IMEAS
                              Bit D3:   0 = Current through channel 3 is below IMEAS
                                        1 = Current through channel 3 is above IMEAS
                              Bit D2:   0 = Current through channel 2 is below IMEAS
                                        1 = Current through channel 2 is above IMEAS
                              Bit D1:   0 = Current through channel 1 is below IMEAS
                                        1 = Current through channel 1 is above IMEAS
                              Bit D0:   0 = Current through channel 0 is below IMEAS
                                        1 = Current through channel 0 is above IMEAS
Note:       current status for channel is captured on the falling edge of chip select
            Monitor mode 4
            Monitor mode main information:
            ÔÇ∑      Revision
            ÔÇ∑      Device ID
            The SPI message definition for MOSI commands and MISO responses in Monitor Mode 4
            are defined below
              .
 MSB                                                                                                    LSB
  D15  D14      D13   D12    D11    D10     D9     D8      D7   D6     D5     D4      D3     D2   D1     D0
 MOSI Command for Monitor Mode 4
   1     1       P     0      1       1      0      0       0    0      0      0       0      0    0      0
 MISO Response for Monitor Mode 4
   1     1       P     0      1       1     ID3    ID2    ID1   ID0    R5     R4      R3     R2   R1     R0
54/80                                       DocID028325 Rev 1


L9662                                                                            Functional description
                              Table 32. MOSI monitor mode 3 bit definition
                              MOSI command                                 MISO response
          Bit
                 State                                     Description
       D15         1                                        See above for state
                         Mode Bits
       D14         1                                        See above for state
       D13               Odd Parity ‚Äì Includes all 16 bits  Odd Parity ‚Äì Includes all 16 bits
       D12         0                                        See above for state
       D11         1     Mode selection                     See above for state
       D10         1     Mode selection                     See above for state
       D9-D6                                                ‚Äò0001‚Äô shall be device L9662
                                                            Revision Information:
                                                            Upper 3 bits will reflect full pass
       D5:D0       0                                        Lower 3 bits will reflect metal/minor change
                                                            First pass device will be indicated as ‚Äú001
                                                            000‚Äù
3.4.6 Satellite sensor interface
      The device provides four currents limited to I_Lim each through outputs ICH1, ICH2, ICH3
      and ICH4. The voltage at these four channels is supplied by the VSATS input. Channels 1,
      2, 3 and 4 serve as switched power sources to remote mounted satellite sensors. The
      device will monitor the current flow from its output pin and ‚Äúdemodulate‚Äù the current to be
      decoded using Manchester protocol. Decoded satellite message is communicated to an
      external microprocessor via SPI2. Both the satellite and squib circuits can be reset over
      when sending the appropriate configuration commands via SPI1 (16 bit SPI).
      For operation using a sync pulse a capacitor between 10 nF to 47 nF is required to be within
      70 nH of the respective ASIC pin for signal stability.
      In case of loss of VCC all outputs will remain off.
      Satellite operation modes
      Each receiver channel provides different modes of operation that can be programmed by
      SPI command.
      Receive mode (asynchronous data transfer)
      In Receive Mode the sensor interface operates in asynchronous mode. The specified data
      messages from each channel will be continuously received every tasync. (Design Information
      only).
      The Sensor Interface supplies satellites and receives current modulated data. In this mode,
      the channels are supplied via pin VSATS. A voltage ÔÇ≥ VICHxmin+Vhdp_max(I=75mA@105¬∞C) at
      this input pin is required to provide the regulated voltage of VICHxmin at the satellite outputs
      [ICH0]...[ICH3].
                                        DocID028325 Rev 1                                             55/80
                                                                                                            79


Functional description                                                                                 L9662
                                       Figure 10. Transmission in asynchronous mode
                                9 ,&+[
                                                                     W$6<1&
                              , ,&+[
                                                            '$7$)5$0(             '$7$)5$0(
                           , 6$7BLGOH
                                                                                                      *$3*36
            High voltage mode and satellite SYNC mode
            In High Voltage Mode and SYNC Mode the ICHx outputs are regulated to a higher output
            voltage (VICHx_HV) than in Receive mode. In this case, the channel power supply is taken
            from a separate input pin (VSYNC). Both modes are activated and deactivated by the same
            SPI command. The start of the SYNC impulse is arbitrary and is created by a signal from the
            ŒºC using the INITSYNC input pin. The Sync pulse shall be initiated for all satellites based on
            the rising edge of the INITSYNC input after a tSYNCDLY delay. The duration of the sync pulse
            shall be based on the programmed sync pulse high time based on [D9:D8] in the MCR. If
            the sync timing register has not been written the default pulse high time shall be tSYNC_high1.
            The absence of an INITSYNC input rising edge does not prevent processing of incoming
            messages when in HV or SYNC mode.
            For Sync mode the valid sync time selections would be tSYNC_high1 and tSYNC_high2. For
            High Voltage Mode the valid sync time selections would be tSYNC_high3 and tSYNC_high4. The
            time selections of tSYNC_high3 and tSYNC_high4 cannot be used in normal operation because
            the time duration will be longer than the receive disable time, resulting in improper
            communication with the satellites. For HV mode (used only in the manufacturing or supplier
            facility) if there is a short to battery flag is set then the message must be ignored.
           At the start of a sync pulse there is a short period before the actual start of the sync pulse for
            a channel where the current is limited to 20mA typical. This low current limit will start after
            the tINITSYNCFLT time and last for 200 ns. The satellite current requirements in conjunction
            with the capacitance on the pins should be verified so that the minimum satellite voltage can
            be maintained.
            SYNC mode
            During the receiver disable time a sync pulse cannot be initiated and any change on the
            INITSYNC pin will be ignored by the ASIC.The satellite SYNC mode is used to generate
            automatic sync pulses for synchronous data transmission. In this mode, the output operates
            in Receive Mode, but is periodically switched to a higher output voltage VICHx_HV. Thus, the
            receiver decoder blocks are deactivated for the duration of the Sync pulse. To avoid
            disturbance in the data flow during re-settling of the output voltage to the receive-mode
            level, the receiver decoder block is deactivated for time tRECV_disable.
56/80                                           DocID028325 Rev 1


L9662                                                                                Functional description
      The receiver disable time, tRECV_disable, is started from the rising edge of the INITSYNC
      input. When operating in sync mode the valid sync time selections would be tSYNC_high1 and
      tSYNC_high2.
      In synchronous communication mode it is possible to communicate with a maximum of two
      (2) satellites on one channel. This is done using a simple form of time division multiplexing
      where each device transmit its data during a known time slot.
      The figure below shows examples for 1 or 2 satellites on a channel.
                        Figure 11. Synchronization pulse timing (single device)
                                                        W6<1&BSHULRGB
                          9 ,&+[
                                          W6\QFB'/<
                                               W6\QF
                                         5HFHLYHU
                                        LVGLVDEOHG
                        , ,&+[                         5HFHLYHULVHQDEOHG
                                        W5(&9BGLVDEOH
                                                      '$7$)5$0(
                      ,1,76<1&
                                                                                                      *$3*36
                             Figure 12. Synchronization pulse timing (mini bus)
                                                        W6<1&BSHULRGB
                          9 ,&+[
                                          W6\QFB'/<
                                               W6\QF
                                         5HFHLYHU
                                        LVGLVDEOHG
                        , ,&+[                         5HFHLYHULVHQDEOHG
                                        W5(&9BGLVDEOH
                                                                     WGO\
                                                      '$7$)5$0(          '$7$)5$0(
                      ,1,76<1&
                                                                                                  *$3*36
                                         DocID028325 Rev 1                                               57/80
                                                                                                                  79


Functional description                                                                                                                      L9662
            High voltage mode
            The High Voltage Mode is based on the SYNC Mode and will be used to communicate with
            the external satellites via voltage modulation. When in this mode the valid sync time
            selections would be tSYNC_high3 and tSYNC_high4.
            During the High Voltage Mode it is necessary to disable the receiver of the sensor interface
            until a complete data frame is sent. After sending a data frame the receiver must be enabled
            again to receive the expected answer from the satellites. The microcontroller will control the
            enabling and disabling of the receiver along with Sync pulse high time (tSYNC_highx) the
            over SPI2 for each bit of the data frame.
                                                Figure 13. High voltage mode communication
                                ,1,76<1&
                                                         W6<1&BKLJK
                                                  WLE                WLE   W6<1&BKLJK         WLE         W6<1&BKLJK
                                     9 +9
                                     9 ,&+[
                                                                                         
                           'DWD5HFHLYHG
                           )URP6DWHOOLWH
                                                                                                                                          *$3*36
            Satellite message decoding
            The device is configurable for decoding of satellite messages based on either Manchester-1
            or Manchester-2 decoding. Each of the four satellite channels has a Manchester decoder
            that can be enabled or disabled through the CCR register.
            For Manchester-1 decoding a logic 0 is defined as a signal transition from 1 to 0 at 50%
            Duty cycle, logic 1 is defined as a signal transition from 0 to 1 at 50% Duty cycle. For
            Manchester-2 decoding a logic 0 is defined as a signal transition from 0 to 1 at 50% Duty
            cycle, logic 1 is defined as a signal transition from 1 to 0 at 50% Duty cycle. An example of
            Manchester-1 and Manchester-2 decoding is given below.
                                                Figure 14. Manchester-1/2 decoding diagram
                                           0DQFKHV WHU                                                               0DQFKHVW HU
                              6WDUW%L WV                                                                  6WDUW%LWV
             , ,&+[                                                                   , ,&+[     /RJLF          /RJLF   /RJLF /RJLF
                      /RJLF           /RJLF       /RJLF      /RJLF
                                                                                                                                           *$3*36
58/80                                                         DocID028325 Rev 1


L9662                                                                            Functional description
      The device is capable of different bit rates, which can be programmed via SPI2 based on
      the operating frequency of the satellite bus. For the first message and all subsequent
      messages the ASIC uses the Start Bits‚Äô time to decode the rest of the bits in the message. In
      case the measured bit rate obtained using the 2 Start bits doesn‚Äôt fall within the range
      selected by the SPI as defined the device declares a bit time error and waits for idle. The
      idle time between messages is 1.5 times the measured start bits time of the previous
      message unless a message error is detected. If an error is detected then the device shall
      default to 1.5 times the maximum frequency (minimum bit time). The initial idle time (after a
      POR or reset) is 0 bit times.
      The decoder uses a counter to track the high to low and low to high transitions at the bit
      center. Figure 15 is an example that illustrates how the ASIC performs the decoding.
      A transition is considered a bit center only when an edge is detected 75% to 125% of the
      reference bit time after de-glitch filter. The de-glitch filter can modify bit time if the noise on is
      not symmetric on each transition. When a single edge occurs below 75% of the reference bit
      time it is considered to be a bit edge but it is ignored. When the decoder detects a second
      edge below 75% of the reference bit time the device declares a bit time error via SPI, revert
      to the minimum bit time of the selected range, and wait for idle. When a valid bit center is
      detected the counter will reset and start counting again until another edge is detected. If the
      message is not complete and no edge is detected in the range of 75% to 125% of measured
      bit time, the device declares a bit time error via SPI, revert to the minimum bit time of the
      selected range, and wait for idle. The idle time is defined as 150% of the minimum bit time of
      the selected protocol speed range. If there is no bit transition detected for that period of time
      and the correct number of bits was received, the message is considered complete. Bit time
      error and too many bits faults are stored directly into the data register once they are
      selected without the need to wait till an idle time. Since a bit time error is reported directly
      once it is detected before Idle time, too few bits error may never be reported since bit time
      error is detected first.
      Bit time errors and too many bits errors will cause the decoder to revert to the minimum bit
      time of the selected range, and discard the message. In case of a message containing
      multiple errors only one error code is reported per message, errors detected in the decoding
      phase have the following reporting priority; bit time errors, too many bits errors then
      communication errors (CRC/Parity).
                                       DocID028325 Rev 1                                               59/80
                                                                                                             79


Functional description                                                                                                                      L9662
                            Figure 15. Example of Manchester decoding using satellite protocol
                                                                                                                     ,06!RU
                                         V\QF     V\QF            '        '                   '                    V\QF 
                                                                                                                        1
                        ,)9
                                         V\QF  V\QF              '         '                   '        ,06!RU     V\QF 
                6DWWHOLWH&XUUHQW                                                                                     1
                      /HYHO
                                                          V\QF        '       '                                ,06!RU
                                            V\QF                                               '        '                   V\QF 
                                                                                                                          1
                       ),/7B'$7$
                                                                                                                        1
                                                                          1      1     1     1
                                                        1             1           1         1         1
                                                               1      1                1     1
                   %LWB7LPHB&RXQWHU!
                     WR%LW&HQWHU
                           $OO7UDQVLWLRQV
               %LW&HQWHU7UDQVLWLRQV
               $OO7UDQVLWLRQVDIWHU
                           ,06B'HWHFW
                                                                                                                              
                     %LWB&RXQW!
               %LWB7LPHB5HJLVWHU!                        1           1          1           1               1         
                                                                                                                                            *$3*36
            Communication protocols
            In order to support the various satellite sensors, the device supports two different
            communication standards (MS and PSI5 Mode). The Manchester standard consists of two
            protocols (CRC / Even Parity), while the PSI5 standard consists of one protocol (Even
            Parity) for a total of three communication protocols. The three protocols which are described
            in this section are: 1) Protocol A - CRC. 2) Protocol B Generic ‚Äì Parity: to support Bosch
            PAS3 and PAS4 sensors. 3) Protocol C: PSI5 ‚Äì Parity: support for various sensors. Bit D3 of
            the MCR configures the device for either MS or PSI5 communication standard. Bits D10 to
            D13 in the MCR register are used to configure the specific device channel (Ch. 0,1,2,3) to
            use any of these specified protocols.
            This version of the device supports the following PSI5 Operational Modes.
            PSI5-A8P-250/1L
            PSI5-A10P-250/1L
            PSI5-P10P-250/1L
            PSI5-P10P-500/2L
60/80                                                         DocID028325 Rev 1


L9662                                                                        Functional description
      Protocol A
      The data received from satellite receiver block has to be decoded in the digital block. The
      data is received LSB first. The protocol format is defined below for the 4 different message
      lengths.
                                         Figure 16. Satellite protocol-A
               0DQFKHVWHU
               ELW0HVVDJH
               6WDUWELWV &5&           69          'DWD
                                                                          
               ELW0HVVDJH
               6WDUWELWV &5&           69          'DWD
                                                                  
               ELW0HVVDJH
               6WDUWELWV &5&           'DWD
                                                                 
               ELW0HVVDJH
               6WDUWELWV &5&           'DWD
                                                           
                                                                                             *$3*36
      The default for the device is to perform CRC decoding on all messages. The device has the
      option not to perform the CRC decoding and pass the satellite message, excluding the 2
      start bits, over the MISO. CRC decoding can be disabled/enabled by writing to the
      appropriate bit in the CCR register.
      For the CRC mode the error detection code used for processing the message is based on
      the polynomial x3 + x1 + x0. If the device is in CRC mode it will process all incoming
      messages and report an error via SPI2 in case of a CRC mismatch. The CRC is performed
      after a complete message is received and, in case of CRC error, the device sets a fault code
      in the SR word.
      The message data sent over SPI2 is MSB first.
      Protocol B: generic variable length protocol
      The data received from satellite receiver block has to be decoded in the digital block. The
      data is received LSB first. The protocol format is defined below for the 4 different message
      lengths.
                                      Figure 17. Generic satellite protocol
                      0DQF KHVWHU
                      EL W0HVVDJH
                      6WDUWELWV 69          'DWD                                     3
                                                                         
                      EL W0HVVDJH
                      6WDUWELWV 69          'DWD                            3
                                                                  
                      EL W0HVVDJH
                      6WDUWELWV 'DWD                                    3
                                                               
                      EL W0HVVDJH
                      6WDUWELWV 'DWD                             3
                                                          
                                                                                             *$3*36
                                         DocID028325 Rev 1                                      61/80
                                                                                                         79


Functional description                                                                                 L9662
            The ASIC shall supports a Satellite Protocol-B, which is based on Bosch sensors
            PAS3/PAS4 protocols. The default for the device is to perform parity decoding on all
            messages. The device has the option not to perform the CRC decoding and pass the
            satellite message, excluding the 2 start bits, over the MISO. Parity decoding can be
            disabled/enabled by writing to the appropriate bit in the CCR register.
            For the parity mode the error detection code used for processing the message is even. If the
            device is in CRC mode it will process all incoming messages and report an error via SPI2 in
            case of a parity mismatch. The parity check is performed after a complete message is
            received and, in case of an error, the device sets a fault code in the SR word.
            The message data sent over SPI2 is MSB first.
            Protocol C: PSI5 mode - parity protocol
            The data received from satellite receiver block has to be decoded in the digital block. The
            data received from the satellite is LSB first followed by the Parity bit. The protocol format is
            defined below for the 4 different message lengths.
                                        Figure 18. PSI5 ‚Äì parity satellite protocol
                        36,3DULW\
                        ELW0HVVDJH
                        6WDUWELWV 'DWD                                                      3
                                                                             
                        ELW0HVVDJH
                        6WDUWELWV 'DWD                                              3
                                                                         
                        ELW0HVVDJH
                        6WDUWELWV 'DWD                                         3
                                                                      
                        ELW0HVVDJH
                        6WDUWELWV 'DWD                               3
                                                               
                                                                                                      *$3*36
            When the PSI5 parity protocol is selected, the ASIC performs a parity check then passes the
            satellite message, excluding the 2 start bits and parity bit over the MISO on SPI2. For parity
            protocol, the error detection code used for processing the message is even. The parity
            check is performed and in case of an error, the device sets a fault code in the SR word.
            When commanded, the message data excluding the start bits and parity bit is sent
            over SPI2 MSB first.
62/80                                        DocID028325 Rev 1


L9662                                                                                                   Functional description
      DATA buffer/DATA transfer
      The IC includes 4 internal DATA registers; one for each output channel, each one is 16 bits
      and one deep.
                                      Figure 19. Data buffer / data transfer diagram
              63,7UDQVIHU                                  VWDJH√Ñ5HJLVWHU¬≥                                     0DQFKHVWHU6DW
              %XIIHU                                        )RU6DW'DWD
                                                                                                                    'HFRGHU
                       7UDQVIHU'DWDLID¬≥UHDGUHJLVWHU¬¥                     7UDQVIHU'DWDLIDYDOLGIUDPHRI
                       &RPPDQGIRUWKHFKDQQHOLV                             6DW'DWDLVUHFHLYHG
                       UHFHLYHGYLD63,                                      'DWDLQUHJLVWHUZLOOEHRYHUZULWWHQ
                       1RWH7UDQVIHU
                       GDWDDWIDOOLQJHGJHRI&6
                       RIIROORZLQJ63,WUDQVIHU
                                                                                                                               *$3*36
      Once the data is transferred to the SPI transfer buffer the satellite data register is cleared.
      If there is no incoming satellite message before the next SPI data read a register empty flag
      will be indicated assuming no other fault conditions exist.
      Current sensor description
      Each output channel senses the current drawn by the remote satellite sensor. The circuit
      modulates the load current into logic voltage levels for post processing by a Manchester
      decoder. Each channel has an internal comparator with a programmable currents trip points
      selectable through the appropriate setting in the CCR Register for each of the 4 satellite
      channels. For determining the appropriate current threshold setting the total current, idle
      plus signal, must be taken into account. The current sense comparator also provides
      hysteresis, which can be enabled through appropriate setting in the CCR Register. Each
      comparator output have a de-glitch filter as a function of the protocol speed.
      Satellite short conditions
      Each channel has a short circuit protection by independent current limit. When a short to
      ground occurs the output becomes current limited to 150 mA maximum when the voltage is
      at idle and 280 mA maximum during the sync pulse for a total period of tFlt _GND. After time
      tFlt _GND the output will shut off and a leakage to ground fault shall be reported in the SR
      word. The output will remain off until re-enabled via SPI and if the short is not present then
      the outputs shall return to normal operation. All channels that do not have a short condition
      shall not be affected.
      When the output is shorted to battery, an internal comparator senses the output voltage
      level then turns off an internal series transistor to provide blocking diode for the current
      going through the output channel. The output will be OFF only when fault condition is
      present. As soon as the fault disappears, the interface will become ON again. A leakage to
      battery fault will be set and reported in the SR word after it has been present for tFlt _BATT.
      Once read it shall be cleared and if the condition is still present the flag will be set. The
      comparators have 20 to 50 mV input offset to prevent turning off the output under an open
      circuit condition.
                                                   DocID028325 Rev 1                                                              63/80
                                                                                                                                           79


Functional description                                                                                      L9662
             IFx/Vx output configuration
             The IFx/Vx pins are high impedance by writing to D7 and D6 of the MCR and setting the bits
             to 0. When the pins are enabled and if the pin is shorted to ground then the device can
             source up to 100mA from VDD.
             Analog output
             Channels 2 and 3 of the device can by used to provide an analog feed back current as a
             1/100th ratio of the sense current in this mode internal data register and decoder are
             bypassed. This will allow the IF2/V2 and IF3/V3 pins to be connected to a resistor to ground
             and provide an analog voltage equivalent to the sense current to be read by an A/D port.
             These two pins have an internal clamp as protection. This feature is available for Channels
             2 and 3.
             Digital output
             Channels 2 and 3 can be configured as a logic level output with the level reflecting if the
             current is above or below the selected internal current threshold. See Table 33 for MCR and
             CCR bit settings for this mode. The output voltage has a reversed polarity to the satellite
             current such that when the current drawn by the satellite is below the current detection
             threshold, the IFx/Vx signal level transitions into a high state, on the other hand if the current
             drawn by the satellite exceeds the current detection threshold, IFx/Vx signal transitions into
             a low state.
             Channel 2 and 3 mode selection
             These channels can be configured to decode satellite messages or Hall Effect sensors and
             provide results through the SPI and/or the IFx/Vx pins. The following Table 33 shows the
             settings for the MCR and CCR based on the interfacing to a sensor or satellite.
        Table 33. MCR and CCR settings based on the interfacing to a sensor or satellite
    Register settings          Functions active                            Information available
 MCR MCR           CCR
                              Channel                                SPI
 D7/D6 D5/D4      D5:D4                    Decoder                                               IFx/Vx pin
                               (ICHx)                         DATA register
  Bits   Bits      Bits
   0       0        00     OFF (ICHx HiZ)    OFF                   Empty                         OFF (HiZ)
   0       1        00     OFF (ICHx HiZ)    OFF                   Empty                         OFF (HiZ)
   1       0        00     OFF (ICHx HiZ)    OFF                   Empty                           ON (1)
   1       1        00     OFF (ICHx HiZ)    OFF                   Empty                            VDD
   0       0        01           ON          OFF                   Empty                         OFF (HiZ)
                                                      Data will reflect if ICHx current
                                                     is above/below threshold setting
                                                                     (1)
   0       1        01           ON          OFF                                                 OFF (HiZ)
                                                           D0 = 0 (above thres.)
                                                           D0 = 1 (below thres.)
                                                                                              Analog Output
   1       0        01           ON          OFF                   Empty
                                                                                                (I_Sat/100)
64/80                                        DocID028325 Rev 1


L9662                                                                                                  Functional description
   Table 33. MCR and CCR settings based on the interfacing to a sensor or satellite (continued)
    Register settings              Functions active                                  Information available
  MCR MCR             CCR
                                  Channel                                       SPI
 D7/D6 D5/D4         D5:D4                        Decoder                                                         IFx/Vx pin
                                   (ICHx)                                DATA register
  Bits    Bits        Bits
                                                               Data will reflect if ICHx current
                                                              is above/below threshold setting
                                                                                 (1)
   1        1          01            ON             OFF                                                        Digital Output
                                                                     D0 = 0 (above thres.)
                                                                     D0 = 1 (below thres.)
   0        0          10            ON               ON                  Satellite Data                          OFF (HiZ)
   0        1          10            ON               ON                  Satellite Data                          OFF (HiZ)
                                                                                                              Analog Output
   1        0          10            ON               ON                      Empty
                                                                                                                 (I_Sat/100)
   1        1          10            ON               ON                  Satellite Data                       Digital Output
   0        0          11            ON             OFF                       Empty                               OFF (HiZ)
   0        1          11            ON             OFF                       Empty                               OFF (HiZ)
                                                                                                              Analog Output
   1        0          11            ON             OFF                       Empty
                                                                                                                 (I_Sat/100)
   1        1          11            ON             OFF                       Empty                            Digital Output
1. IFx/Vx Pin is set as Analog Output (I_Sat/100) but since ICHx is off (HiZ) the IFx/Vx output will look like it is HiZ
3.4.7           SPI register definition for satellite functions
               The SPI provides access to read/write to the registers internal to the device. All commands
                sent to the ASIC shall use set D15 as required for odd parity on the 16 bit word. The total
                message length when CS_S is active is 80 bits. The response to the command is sent in the
                next valid CS_S.
                                                   Table 34. SPI register definition
                      Registers for satellite communication                                     Description
                 Module Configuration Register            MCR              Global configuration for all channels
                                                                           Used to configure individual channels and
                                                          CCR1
                                                                           receive
                                                          CCR2
                 Channel Configuration Registers                           satellite information
                                                          CCR3
                                                                           Internal pointer incremented to each channel
                                                          CCR4
                                                                           register
                                                                           Status of channels
                 Status Register                          SR               Channel leakage to ground/battery/open faults
                                                                           Message faults (Start bits, Other)
               The following diagram shows the satellite SPI transfer during normal operation. The satellite
                data is uploaded based on CS_S going active. All the register data for the channels will be
                loaded at the same time.
                                                     DocID028325 Rev 1                                                        65/80
                                                                                                                                    79


Functional description                                                                                                      L9662
                          Figure 20. Satellite SPI transfer during normal operation diagram
                                         6DWHOO LWH 'DWD/RDGH G2Q)DOO LQJ (GJH RI &6B6
                                           'DWD%DVHGR Q/DV W026,ELW0 HVVDJH
                                   &6B6
                                   6&/.                   FONV                 FONV               FONV
                                   026,                  0VJ 1                 0VJ 1              0VJ 1
                                                        5HVS'DWD              5HVS'DWD             5HVS'DWD
                                   0,62                      1                      1                   1
               &6B6
                                                    1RZ DLWWLPHUHTXLUH G FRQWLQXRXV63 ,&ORF NV
               6&/.              ELWV              ELWV              ELWV            ELWV          ELWV
               026,           :RUG 1               :RUG 1            :RUG 1           :RUG 1         :RUG 1
                                                                     0HVVDJH1
                             :RUG 1            :RUG 1           :RUG 1          :RUG 1       :RUG 1
               0,62            5HVSRQVH              5HVSRQVH            5HVSRQVH            5HVSRQVH         5HVSRQVH
                                                                                                                           *$3*36
            Based on the above format the micro must send the commands in a specific order. The
            following table represents the allowable commands/positions sent out on MOSI along with
            responses.
                     Table 35. Commands/positions sent out on MOSI along with responses
                      Word position                                Allowable MOSI                    Commands MISO reponses
                          Word (N,1)                                      MCR                                 MCR(1) or SR
                          Word (N,2)                                      CCR1                               CCR1 or Data
                          Word (N,3)                                      CCR2                               CCR2 or Data
                          Word (N,4)                                      CCR3                               CCR3 or Data
                          Word (N,5)                                      CCR4                               CCR4 or Data
            1.   Only allowed if Words 2-5 are CCRs.
            When the device is set to report the MCR in the MISO response it must be done only when
            reporting all CCRs. If Data is reported with the MCR in the MISO response then the data
            status information is lost. When the MCR is in MISO word 1 then there is no indicator
            whether a response in words 2 to 5 are CCR or Data.
            If the SR is returned in the MISO response with a CCR then the status information for that
            word will not change until the next SR with Data. The SR bits will indicate which words are
            CCR and Data.
66/80                                                 DocID028325 Rev 1


L9662                                                                               Functional description
           The MOSI input takes data from the master microprocessor while CS_S is asserted. The
           MSB is the first bit of each word received on MOSI and the LSB is the last bit of each word
           received on MOSI. This pin has TTL level compatible input voltages allowing proper
           operation with microprocessors using a 3.3 to 5.0 volt supply.
           When data is transmitted for any of the first 4 words on MISO then the SR will be the 5th
           word. This is required to identify good vs. bad data since, depending on the data mode, all
           16 bits from a satellite can be data.
           Satellite module configuration register (MCR)
           This register defines the global configuration to the satellite module.
           The MCR will be the 1st word in the message of the MOSI transfer. The micro MUST never
           write the MCR in the wrong position because it will be recognized by the ASIC as a CCR.
           The SPI message definition for MOSI commands and MISO responses for the MCR are
           defined below.
Command/
                                                   MOSI Bit Definition
   Mode
          D15 D14 D13      D12    D11   D10   D09   D08   D07     D06     D05    D04    D03 D02 D01      D00
 MOSI Command
   MCR      0    0   CH4P CH3P CH2P CH1P SPL1 SPL0 IV4EN IV3EN IV4SEL IV3SEL SW RD                 0     odd
 MISO Response
   MCR      0    0   CH4P CH3P CH2P CH1P SPL        SPL IV4EN IV3EN IV4SEL IV3SEL SW RD            0     odd
                                  Table 36. MOSI MCR bit definition
                   MOSI Command MS ‚Äì Mode‚ÄòD3‚Äô=0                     MOSI Command PSI5 ‚Äì Mode‚ÄòD3‚Äô=1
   Bit
            State                                          Description
   D15        0
   D14        0       Register Selection (SR/MCR)
              0       CH3 Protocol A Mode (default)             Not valid
   D13
              1       CH3 Protocol B Mode                       PSI5 Parity
              0       CH2 Protocol A Mode (default)             Not valid
   D12
              1       CH2 Protocol B Mode                       PSI5 Parity
              0       CH1 Protocol A Mode (default)             Not valid
   D11
              1       CH1 Protocol B Mode                       PSI5 Parity
              0       CH0 Protocol A Mode (default)             Not valid
   D10
              1       CH0 Protocol B Mode                       PSI5 Parity
   D9         0
                      Sync Pulse length                         Sync Pulse length
   D8         0
              0       Disable IF3/V3 pin (default)              Disable IF3/V3 pin (default) Enable IF3/V3 pin
   D7
              1       Enable IF3/V3 pin
   D6         0       Disable IF2/V2 pin (default)              Disable IF3/V3 pin (default) Enable IF3/V3 pin
   D5                 IF3/V3 Output Selection                   IF3/V3 Output Selection
                                            DocID028325 Rev 1                                            67/80
                                                                                                               79


Functional description                                                                                            L9662
                            Table 36. MOSI MCR bit definition (continued)
                   MOSI Command MS ‚Äì Mode‚ÄòD3‚Äô=0                           MOSI Command PSI5 ‚Äì Mode‚ÄòD3‚Äô=1
    Bit
             State                                             Description
    D4                 IF2/V2 Output Selection                       IF2/V2 Output Selection
               0       MS Mode (Prot a\Prot B) Default
    D3                                                               MS Mode (Prot a\Prot B) Default PSI5 Mode
               1       PSI5 Mode
    D2                 Receiver Disable Time Selection               Receiver Disable Time Selection
    D1         X
    D0                 Odd Parity ‚Äì Includes all 16 bits             Odd Parity ‚Äì Includes all 16 bits
            The following describes the bit usage for both MS & PSI5 Satellite Modes:
            Bit [D15]                     If during the previous received request a SPI communication
                                          error occurred or invalid message was received, the device shall
                                          set bit D15 indicating that the whole data frame of 80 bit is not
                                          valid.
            Bits [D13:D10]                These bits are used to configure the output channels for either
                                          CRC or Parity sensor protocols.
                                          When in MS Mode the default configuration is the protocol A.
                                          For PSI5 mode these bits must be set to 1's.
            Bits [D09:D08]                Sync Pulse high time
                                      Table 37. Sync pulse high time selections
                  SPL1                SPL0                                       Description
                    0                    0             20Œºs (default)
                    0                    1             30Œºs
                    1                    0             40Œºs
                    1                    1             80Œºs
            Bit [D7:D5]                   These bits control the configuration of the IF3/V3 pin.
                                       Table 38. Configuration of the IF3/V3 pin
                   D7/D6                 D5/D4                                    Description
                      0                     0            IFx/Vx pin is HiZ
                      0                     1            IFx/Vx pin is HiZ
                                                         IFx/Vx pin will source an analog current that is 1/100 of
                      1                     0
                                                         the sensor current
                                                         IFx/Vx pin will be a digital output indicating if the current is
                      1                     1            above or below the selected threshold. When a channel
                                                         (ICHx) is off this pin will be high (~VDD).
68/80                                         DocID028325 Rev 1


L9662                                                                                 Functional description
             Bit [D3]                  Satellite Communication Protocol Selection
                                       0 = MS Protocol
                                       1 = PSI5 Protocol
             Bit [D2].                 Receiver disable time selection
                                       0 = Receiver disable time is 62ÔÅ≠s typical
                                       1 = Receiver disable time is (Tsynchighx time + 20ÔÅ≠s)
             Channel configuration registers (CCR1, CCR2, CCR3, CCR4)
             The SPI message definition for MOSI commands and MISO responses for the CCR/Data
             are defined below.
Command/
                                                     MOSI Bit Definition
Mode from
  Master
             D15 D14 D13 D12          D11    D10  D09    D08    D07 D06 D05 D04 D03 D02 D01 D00
 MOSI Command
CCR          odd    RS   R/W MAN CRC PC1 PC0             SYNC BT1 BT0 EN1 EN0 IHYS               I_Threshold
 MISO Response (CCR)
CCR
                                                                                          IHY
(D14=1 in    odd      1  R/W MAN CRC PC1 PC0             SYNC BT1 BT0 EN1 EN0                    I_Threshold
                                                                                           S
MOSI)
 MISO Response (Data)
CCR
(D14=1 in                                     See Table 40 for MISO Responses
MOSI)
                                     Table 39. MOSI CCR bit definition
                           MS Mode                  PSI5 Mode (1)          MS / PSI5 Mode     MS / PSI5 Mode
                                                                        MISO Response for     MISO Response
 Bit    State           MOSI Command              MOSI Command
                                                                              CCR Mode         for Data Mode
                                                          Description
                 Odd Parity ‚Äì Includes all 16                          Odd Parity ‚Äì Includes
 D15                                             Same as MS Mode
                 bits                                                  all 16 bits
          0      Register Selection:
 D14                                             Same as MS Mode       1= CCR response
          1      CCR (1) / DATA (0)                                                             See Table 40
          0      Read                            Same as MS Mode       R/W
 D13             WRITE (only valid if CCR
          1
                 request)
                                              DocID028325 Rev 1                                          69/80
                                                                                                               79


Functional description                                                                                 L9662
                              Table 39. MOSI CCR bit definition (continued)
                           MS Mode                   PSI5 Mode (1)         MS / PSI5 Mode    MS / PSI5 Mode
                                                                         MISO Response for   MISO Response
  Bit   State           MOSI Command                MOSI Command
                                                                              CCR Mode        for Data Mode
                                                           Description
          0     Manchester 2                      Not Used             Manchester Selection
 D12                                                                   PSI5 mode ‚Äì don‚Äôt
          1     Manchester 1                                           care
                Checksum calculation enabled
          0     (default) ‚Äì Target is to use      Not Used
                checksum calculated by ASIC                            Checksum calculation
 D11                                                                   Status PSI5 mode ‚Äì
                Checksum calculation                                   don‚Äôt care
          1     disabled Note: Checksum for
                MS only not PSI5
          1
 D10
          0     MS Message Length See             PSI5 Message
                                                                       Data length Status
          1     Table 40                          Length See Table 40
  D9
          0
          0     Sync pulse disabled (default)                                                  See Table 40
  D8                                              Same as MS Mode      Sync pulse Status
          1     Sync pulse enabled
  D7
                Bit time selection                Same as MS Mode      Bit time selection
  D6
  D5                                                                   Satellite/Decoder
                Satellite/Decoder Control         Same as MS Mode
  D4                                                                   Control
                Current Trip Point Hysteresis
          0
                Disabled (default)                                     Current Trip Point
  D3                                              Same as MS Mode
                Current Trip Point Hysteresis                          Hysteresis Status
          1
                Enabled
  D2
                                                                       Current Trip Point
  D1            Current Trip Point threshold      Same as MS Mode
                                                                       threshold
  D0
1. MISO Response shown in Table 40.
                   Table 40. MISO responses with D14=0 (Data register selection)
MOSI Bit Setting                                        MISO Bit Definition
 D11 D10 D09 D15 D14 D13 D12 D11 D10 D09 D08 D07 D06 D05 D04 D03 D02 D01 D00
                             MISO Data Response in MS Mode: MERAS Protocol
  0    0      0   odd    D9    D8     D7     D6   D5   D4    D3    D2    D1     D0   SV2 SV1 SV0     0    0
  0    0      1   odd    D7    D6     D5     D4   D3   D2    D1    D0   SV2 SV1 SV0       0    0     0    0
70/80                                           DocID028325 Rev 1


L9662                                                                            Functional description
            Table 40. MISO responses with D14=0 (Data register selection) (continued)
MOSI Bit Setting                                   MISO Bit Definition
 D11 D10 D09 D15 D14 D13 D12 D11 D10 D09 D08 D07 D06 D05 D04 D03 D02 D01 D00
  0   1      0    odd    D9  D8    D7    D6   D5   D4    D3   D2    D1    D0          0   0    0     0
  0   1      1    odd    D7  D6    D5    D4   D3   D2    D1   D0     0     0    0     0   0    0     0
  1   0      0     D9    D8  D7    D6    D5   D4   D3    D2   D1    D0   SV2 SV1 SV0 CRC2 CRC1 CRC0
  1   0      1     0     D7  D6    D5    D4   D3   D2    D1   D0   SV2 SV1 SV0 CRC2 CRC1 CRC0        0
  1   1      0     0     D9  D8    D7    D6   D5   D4    D3   D2    D1    D0 CRC2 CRC1 CRC0    0     0
  1   1      1     0     D7  D6    D5    D4   D3   D2    D1   D0 CRC2 CRC1 CRC0       0   0    0     0
                            MISO Data Response in MS Mode: Generic Protocol
  0   0      0    odd    D9  D8    D7    D6   D5   D4    D3   D2    D1    D0   SV2 SV1 SV0     0     0
  0   0      1    odd    D7  D6    D5    D4   D3   D2    D1   D0   SV2 SV1 SV0        0   0    0     0
  0   1      0    odd    D9  D8    D7    D6   D5   D4    D3   D2    D1    D0    0     0   0    0     0
  0   1      1    odd    D7  D6    D5    D4   D3   D2    D1   D0     0     0    0     0   0    0     0
  1   0      0     P     D9  D8    D7    D6   D5   D4    D3   D2    D1    D0   SV2 SV1 SV0     0     0
  1   0      1     P     D7  D6    D5    D4   D3   D2    D1   D0   SV2 SV1 SV0        0   0    0     0
  1   1      0     P     D9  D8    D7    D6   D5   D4    D3   D2    D1    D0    0     0   0    0     0
  1   1      1     P     D7  D6    D5    D4   D3   D2    D1   D0     0     0    0     0   0    0     0
                            MISO Data Response in PSI5 Mode: Parity Protocol
  X   0      0    odd D12 D11 D10        D9   D8   D7    D6   D5    D4    D3   D2    D1  D0    0     0
  X   0      1    odd D10    D9    D8    D7   D6   D5    D4   D3    D2    D1   D0    0   0     0     0
  X   1      0    odd    D9  D8    D7    D6   D5   D4    D3   D2    D1    D0    0     0   0    0     0
  X   1      1    odd    D7  D6    D5    D4   D3   D2    D1   D0     0     0    0     0   0    0     0
                                 MISO Data Response in Raw Data Mode
  0   X      X    odd     0   0     0     0    0    0     0    0     0     0    0     0   0    0    Data
  1   X      X     0     0    0     0     0    0    0     0    0     0     0    0     0   0    0    Data
                                MISO Data Response in Hall Effect Mode
  0   X      X    odd     0   0     0     0    0    0     0    0     0     0    0     0   0    0     0
  1   X      X     0      0   0     0     0    0    0     0    0     0     0    0     0   0    0     0
Note:        With CHxSF2:CHxSF0 = '000', '001, or '101'
             When transferring data if the CRC check is disabled on the ASIC then there is no parity bit
             and the CRC bits will be present along with the data bits on the MISO line.
             The following describes the bit usage for the CCR command
             Bits [D11].         Used to enable/disable checksum calculations in MS satellite
                                 mode (D11 is ignored in PSI5).
                                            DocID028325 Rev 1                                      71/80
                                                                                                         79


Functional description                                                                                         L9662
                                   0 = Checksum performed by ASIC
                                   1 = Checksum calculation disabled
            Bits [D10:D09].        These bits are used to configure the number of bits in the MS and PSI5
                                   Modes.
                                   MS Mode: For these bits to execute on any given channel, the channel
                                   has to be configured for generic protocol B / protocol A through bits
                                   <D13:D10> in the MCR register. If the checksum calculation is disabled
                                   the ASIC does not perform a parity check on the incoming message and
                                   will be included in the data field.
                               Table 41. Protocol A/B mode configuration
                                Protocol-A Mode                                    Protocol -B Mode
                             (Set in MCR ‚Äì D13:D10)                             (Set in MCR ‚Äì D13:D10)
  D10    D09                                                           Message
                                         Data Report Length                               Data Report Length
                    Message                                             Length
                     Length
                                        D11=0           D11=1                            D11=0            D11=1
                                        13 bits                                          13 bits
    0      0         18 bits                            16 bits         16 bits                           14 bits)
                                       (default)                                        (default)
    0      1         16 bits            11 bits         14 bits         14 bits          11 bits          12 bits
    1      0         15 bits            10 bits         13 bits         13 bits          10 bits          11 bits
    1      1         13 bits             8 bits         11 bits         11 bits           8 bits           9 bits
                                    PSI5 Mode: For these bits to execute on any given channel, the
                                    channel has to be configured for PSI5 - Parity protocol through bits
                                    <D13:D10> in the MCR register. In PSI5 mode, the checksum
                                    calculation is always done by the ASIC, thus, bit D11 is ignored and
                                    parity bits are not included in the MISO response.
                               Table 42. PSI5 ‚Äì parity protocol (Set in MCR D13:D10)
                   D10                  D09                Message Length                      Data Report
                    0                     0                     16 bits                      13 bits (default)
                    0                     1                     14 bits                           11 bits
                    1                     0                     13 bits                           10 bits
                    1                     1                     11 bits                            8 bits
            Bits [D7:D6].          These bits shall configure speed selection for any of the satellite
                                   channels. Upon power up or reset the protocol configuration shall
                                   initialize to the default speed as shown in the table below.
72/80                                            DocID028325 Rev 1


L9662                                                                         Functional description
                                        Table 43. Default speed
                                              Guaranteed frequency operating range
            D7       D6
                                                                (kHz)
             0       0                                62.66 to 238.66 (default)
             0       1                                     43.50 to 158.97
             1       0                                     26.32 to 106.04
             1       1                                      13.3 to 51.25
      Bits [D5:D4].    These bits are used to enable the satellite channels and the internal
                       decoders to be commanded on or off according to the following table.
                       If both the satellite and decoder are to be enabled then the channel
                       needs to be enabled first and in a following command the decoder
                       would be enabled. This is to prevent erroneous/spurious data to be
                       read.
                     Table 44. On/off condition for satellite and decoder
                               Definition              SPI DATA Register (For appropriate wordx)
        D5       D4
                      Satellite           Decoder              ICH0/ICH1                  ICH2/ICH3
          0       0 OFF (default)       OFF (default)            Empty
                                                        Data will reflect if ICHx
                                                        current is above/below
          0       1      ON                OFF            threshold setting (1)
                                                         D0 = 0 (above thres.)           See Table 33
                                                         D0 = 1 (below thres.)
          1       0      ON                 ON                  Sat. Data
          1       1      ON                 OFF                  Empty
      Bit D3           All incoming satellite signals are processed through deglitch filter before
                       reaching the decoder. D3 enables a hysteresis around the current
                       threshold for added noise immunity.
      Bits [D2:D0]     These bits program the threshold for the current demodulation affecting
                       each individual channel. The current ranges supported are showed in
                       table below.
                                Table 45. Current range supported
                                                                    Current Threshold (mA)
              D2            D1                 D0
                                                                              min/max
               0             0                  0                         1.0/4.0(default)
               0             0                  1                              8.0/11.0
               0             1                  0                            14.85/18.15
                                    DocID028325 Rev 1                                              73/80
                                                                                                         79


Functional description                                                                                     L9662
                                            Table 45. Current range supported
                                                                              Current Threshold (mA)
                   D2                  D1                 D0
                                                                                      min/max
                     0                  1                  1                         17.10/20.90
                     1                  0                  0                         20.25/24.75
                     1                  0                  1                         24.85/29.15
                     1                  1                  0                         28.80/34.20
                     1                  1                  1                         35.10/42.90
            Status registers (SR)
            The definition for the Status Register is valid for all four protocols.
            The SR will always be the 1st word in the message of the MOSI frame
            The message faults and data/channel information are indicated using 3 bits per channel
            (SF2, SF1 and SF0). These bits represent the actual highest priority state of the ICHx-
            receiver, i.e. any change in a state will overwrite the previous value with the highest priority
            fault being reported if more than one fault exists.
 Command/
 Mode from                                            MOSI Bit Definition
   Master
            D15   D14   D13 D12    D11     D10  D09   D08   D07     D06   D05    D04    D03    D02  D01       D00
 MOSI Command
              0    1     0     0     0      0    0     0      0       0    0      0      0      0     0       odd
 MISO Response
             SPI        CH4 CH4 CH4 CH3 CH3           CH3  CH2S CH2S CH2S CH1S          CH1    CH1 POR
     SR            1                                                                                          odd
            ERR         SF2 SF1 SF0 SF2 SF1           SF0    SF2    SF1   SF0    SF2    SF1    SF0 STAT
            The following describes the bit usage
            Bit [D15]             If during the previous received request a SPI communication error
                                  occurred or invalid message was received, the device shall set bit D15
                                  and this means that the whole data frame of 80 bit is not valid.
            Bits [D13:D02]        Fault Codes Definition Supporting Satellite Interface, Hall Effect, and
                                  raw data modes
                                               Table 46. CCR D14 definition
              Priority   CHxSF2      CHxSF1      CHxSF0                        Description
              CCR D14=0
                 7           0            0         0     Good Data from satellite on word ‚Äòx‚Äô
                                                          Two or more good data received from satellite, i.e.
                 6           0            0         1
                                                          there are some data lost.
74/80                                          DocID028325 Rev 1


L9662                                                                             Functional description
                                  Table 46. CCR D14 definition (continued)
        Priority    CHxSF2     CHxSF1     CHxSF0                          Description
            5           0          1         0     Register empty. No data received from satellite
                                                   Not valid data received i.e.
                                                   ‚Äì Start bit time outside valid range
                                                   ‚Äì Frame length
            4           0          1         1
                                                   ‚Äì Bit time error
                                                   ‚Äì CRC/Parity error on sat received message (in this
                                                      case there should be ‚Äúregister empty‚Äù)
                                                   Leakage to Supply Voltage at ICHx port and Not Good
            3           1          0         0
                                                   Data (data lost or register empty or not valid data)
            2           1          0         1     Leakage to Supply at ICHx port & Good Data
                                                   Leakage to ground at ICHx port; (Over current
                                                   detected switched OFF ICHx analog port, it can be still
            1           1          1         0     OFF if micro never wrote on CCR.D5:D4 to switch ON
                                                   port)
       CCR D14=1
                                                   CCR report is present on word ‚Äòx‚Äô: Channel status is
           NA           1          1         1
                                                   the response selected with bit D14 on CCR command
      Codes are prioritized with the highest being 1 and the lowest being 7.
      Error code 011 is an ‚Äúor-ed‚Äùcombination of the following errors:
      ÔÇ∑     Start bit error outside of selected operating range
      ÔÇ∑     Data length error or stop bit error
      ÔÇ∑     CRC/Parity Error of received Satellite Message
      ÔÇ∑     Bit time error outside 75% 125% of start bit
      If in Hall Effect mode the status register under normal conditions will report a Register
      Empty (CHxSF2:CHxSF0='010'). If a fault is on the channel then either a Leakage to supply
      and no good data (CHxSF2:CHxSF0='101') or Leakage to ground (CHxSF2:CHxSF0='110')
      would be present.
      If in Raw data mode the status resister under normal conditions will report Register Empty
      (CHxSF2:CHxSF0='010').
      ÔÇ∑     If decoder is on then satellite data will be present (See Table 40 under protocol A or
            Protocol B)
      ÔÇ∑     If decoder is off then D0 will contain data
      If a fault is on the channel then either a Leakage to supply and no good data (CHxSF2:
      CHxSF0='101') or Leakage to ground (CHxSF2:CHxSF0='110') would be present.
      Bit [D00]                  POR status
                                 0 = Reset occurred. Bit cleared when read
                                 1 = Normal
                                        DocID028325 Rev 1                                               75/80
                                                                                                              79


Functional description                                                                             L9662
                                       Figure 21. Combination errors diagram
              &6
               63,
               5HTXHVW
               5HVSRQVH
                                                            6563,7UDQVIHU(UURU 
                                                               &RPSOHWHIUDPHQRWYDOLG
                                                                                                 *$3*36
            This error is an‚Äùor-ed‚Äù combination of the following errors:
            ÔÇ∑     Parity
            ÔÇ∑     Length
            If a SPI error is detected by the ASIC the response shall be a SR followed by all Data
            Words.
            Following a POR the first response from the ASIC over SPI2 shall be as follows:
                                 Table 47. First response from the ASIC over SPI2e
                         Word Position                         Register Type                   Data
                             Word 1                                   SR                      $5248
                             Word 2                                  Data                     $8000
                             Word 3                                  Data                     $8000
                             Word 4                                  Data                     $8000
                             Word 5                                  Data                     $8000
76/80                                       DocID028325 Rev 1


L9662                                                                                  Package information
4       Package information
        In order to meet environmental requirements, ST offers these devices in different grades of
        ECOPACK¬Æ packages, depending on their level of environmental compliance. ECOPACK¬Æ
        specifications, grade definitions and product status are available at: www.st.com.
        ECOPACK¬Æ is an ST trademark.
4.1     LQFP64 (10x10x1.4 mm) package information
                                Figure 22. LQFP64 (10x10x1.4 mm) package outline
                                                                                                       6($7,1*
                                                                                                        3/$1(
                                                                                                            &
                                                                                                        $
                                                                                                       $
        3,1                                                                                     $
        ,'(17,),&$7,21                           
                                                                                        FFF   &
                                                             
                   
                                                                                              E
                                                                '   '   '
              H
                  
                                                             
                                                                              $
                                                                                               F
                                       (
                                       (
                                        (                            /
                                                                          /
                                                                                         PP
                                                                                       *$*(3/$1(
        *$3*36
                                                                                   .
                                                                                                        B+B:
                                            DocID028325 Rev 1                                               77/80
                                                                                                                       79


Package information                                                                                   L9662
                           Table 48. LQFP64 (10x10x1.4 mm) package mechanical data
                                                                  Dimensions
                Ref                        Millimeters                                   Inches(1)
                                Min.            Typ.         Max.             Min.         Typ.     Max.
                 A                -                -          1.60              -            -     0.0630
                A1              0.05               -          0.15          0.0020           -     0.0059
                A2             1.350            1.40          1.45          0.0531        0.0551   0.0571
                 b              0.17            0.22          0.27          0.0067        0.0087   0.0106
                 c              0.09               -          0.20          0.0035           -     0.0079
                 D             11.80            12.00        12.20          0.4646        0.4724   0.4803
                D1              9.80            10.00        10.20          0.3858        0.3937   0.4016
                D3                -              7.50           -               -         0.2953      -
                 E             11.80            12.00        12.20          0.4646        0.4724   0.4803
                E1              9.80            10.00        10.20          0.3858        0.3937   0.4016
                E3                -              7.50           -               -         0.2953      -
                 e                -              0.50           -               -         0.0197      -
                 L              0.45            0.60          0.75          0.0177        0.0236   0.0295
                L1                -              1.00           -               -         0.0394      -
                 K                                      0¬∞ (min.), 3.5¬∞ (typ.) 7¬∞ (max.)
                ccc               -                -          0.08              -            -     0.0031
           1. Values in inches are converted from mm and rounded to 4 decimal digits.
78/80                                           DocID028325 Rev 1


L9662                                                          Revision history
5     Revision history
                           Table 49. Document revision history
           Date    Revision                          Changes
       08-Sep-2015    1      Initial release.
                              DocID028325 Rev 1                           79/80
                                                                                79


                                                                                                                                     L9662
                                           IMPORTANT NOTICE ‚Äì PLEASE READ CAREFULLY
STMicroelectronics NV and its subsidiaries (‚ÄúST‚Äù) reserve the right to make changes, corrections, enhancements, modifications, and
improvements to ST products and/or to this document at any time without notice. Purchasers should obtain the latest relevant information on
ST products before placing orders. ST products are sold pursuant to ST‚Äôs terms and conditions of sale in place at the time of order
acknowledgement.
Purchasers are solely responsible for the choice, selection, and use of ST products and ST assumes no liability for application assistance or
the design of Purchasers‚Äô products.
No license, express or implied, to any intellectual property right is granted by ST herein.
Resale of ST products with provisions different from the information set forth herein shall void any warranty granted by ST for such product.
ST and the ST logo are trademarks of ST. All other product or service names are the property of their respective owners.
Information in this document supersedes and replaces information previously supplied in any prior versions of this document.
                                                ¬© 2015 STMicroelectronics ‚Äì All rights reserved
80/80                                                      DocID028325 Rev 1


Mouser Electronics
Authorized Distributor
Click to View Pricing, Inventory, Delivery & Lifecycle Information:
STMicroelectronics:
 L9662 L9662TR
